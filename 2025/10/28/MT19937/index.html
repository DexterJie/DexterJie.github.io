<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录MT19937学习过程">
<meta property="og:type" content="article">
<meta property="og:title" content="MT19937">
<meta property="og:url" content="https://dexterjie.github.io/2025/10/28/MT19937/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录MT19937学习过程">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-10-28T13:17:21.000Z">
<meta property="article:modified_time" content="2025-10-28T13:18:26.396Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dexterjie.github.io/2025/10/28/MT19937/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2025/10/28/MT19937/","path":"2025/10/28/MT19937/","title":"MT19937"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>MT19937 | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#MT19937"><span class="nav-number">1.</span> <span class="nav-text">MT19937</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.</span> <span class="nav-text">代码实现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E5%85%A8%E5%88%86%E6%9E%90"><span class="nav-number">3.</span> <span class="nav-text">安全分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%86%E5%90%91-extract-number-%E5%87%BD%E6%95%B0"><span class="nav-number">3.1.</span> <span class="nav-text">逆向 extract_number 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%84%E6%B5%8B%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="nav-number">3.2.</span> <span class="nav-text">预测随机数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%86%E5%90%91-twist-%E5%87%BD%E6%95%B0"><span class="nav-number">3.3.</span> <span class="nav-text">逆向 twist 函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%86%E5%90%91-init-%E5%87%BD%E6%95%B0"><span class="nav-number">3.4.</span> <span class="nav-text">逆向 init 函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B5%9B%E9%A2%98"><span class="nav-number">4.</span> <span class="nav-text">赛题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2020-%E7%BD%91%E9%BC%8E%E6%9D%AF%E7%99%BD%E8%99%8E%E7%BB%84%E2%80%94%E2%80%94random"><span class="nav-number">4.1.</span> <span class="nav-text">2020 网鼎杯白虎组——random</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2020-VN-%E6%8B%9B%E6%96%B0%E8%B5%9B%E2%80%94%E2%80%94Backtrace"><span class="nav-number">4.2.</span> <span class="nav-text">2020 VN 招新赛——Backtrace</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ExtendMT19937Predictor"><span class="nav-number">5.</span> <span class="nav-text">ExtendMT19937Predictor</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#gf2bv"><span class="nav-number">6.</span> <span class="nav-text">gf2bv</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Python-random%E6%A8%A1%E5%9D%97%E5%88%86%E6%9E%90"><span class="nav-number">7.</span> <span class="nav-text">Python random模块分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0xGame%E2%80%94%E2%80%94MT19937"><span class="nav-number">7.1.</span> <span class="nav-text">0xGame——MT19937</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%9E%90"><span class="nav-number">7.2.</span> <span class="nav-text">分析</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">8.</span> <span class="nav-text">Reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2025/10/28/MT19937/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="MT19937 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          MT19937
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-10-28 21:17:21 / 修改时间：21:18:26" itemprop="dateCreated datePublished" datetime="2025-10-28T21:17:21+08:00">2025-10-28</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2025/10/28/MT19937/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2025/10/28/MT19937/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>34 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录MT19937学习过程</p>
<span id="more"></span>

<h1 id="MT19937"><a href="#MT19937" class="headerlink" title="MT19937"></a>MT19937</h1><p>MT19937 即梅森旋转算法（Mersenne twister）由松本眞（日语：松本真）和西村拓士在 1997 年开发，基于二进制有限域 $\mathbb{F}_2$上的矩阵线性递归，可以快速产生高质量的伪随机数。</p>
<p>该算法的周期为 $2^{19937}-1$，故名为MT19937。该算法具有以下优点：</p>
<ol>
<li>周期非常长，为 $2^{19937}-1$</li>
<li>在 $1 \le k \le 623$ 都满足 $k$ - 分布</li>
<li>能比硬件实现的方法更快产生随机数</li>
</ol>
<ul>
<li>$k$ - 分布：一个周期为 $P$ 的 $w$ 位整数的伪随机序列 $x_i$ ，如果下列成立则称其 $v$ - 比特精度的 $k$ - 分布成立。</li>
</ul>
<p>​		令 $\mathrm{trunc_v(x)}$ 表示由 $x$ 的前 $v$ 位形成的数，并考虑 $P$ 中 $k$ 个 $v$ 位向量。<br>$$<br>(\mathrm{trunc_v(x_i)},\mathrm{trunc_v(x_{i+1})},…,\mathrm{trunc_v(x_{v+k-1})})(0 \le i &lt; P)<br>$$<br>​		然后，$2^{kv}$ 个组合中每一个都在一个周期内出现次数相同（全 0 组合出现次数较少除外）。</p>
<h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><p>MT19937 算法可以分为3部分</p>
<ol>
<li>初始化：通过种子（就是常称为的<code>seed</code>）产生一个长度为624的状态数组（这里记为<code>state</code>），而种子可以由用户给定，也可以将时间戳之类的东西作为种子。</li>
<li>旋转状态：将状态数组中的每个元素进行线性变换，生成新的状态数组。这个过程是通过对当前状态数组中的每个元素进行位运算和异或运算来实现的。旋转的目的是为了增加随机数的均匀性和不可预测性。</li>
<li>提取伪随机数 ：这一步会从状态数组中依次提取一个整数，并对其进行位运算和异或运算，生成的数即为输出的伪随机数。当所有数组全被遍历过之后，就会对状态数组再次进行一次旋转，重新生成新的状态数组。（将提取出的整数记为<code>output</code>）</li>
</ol>
<p>其中 32 位的 MT19937 Python 代码实现为：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MT19937</span>:</span><br><span class="line">    <span class="comment"># 初始化</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        self.mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        self.mt[<span class="number">0</span>] = seed</span><br><span class="line">        self.mti = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            self.mt[i] = _int32(<span class="number">1812433253</span> * (self.mt[i - <span class="number">1</span>] ^ self.mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">		</span><br><span class="line">    <span class="comment"># 提取伪随机数</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.mti == <span class="number">0</span>:</span><br><span class="line">            self.twist()</span><br><span class="line">        y = self.mt[self.mti]</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        self.mti = (self.mti + <span class="number">1</span>) % <span class="number">624</span></span><br><span class="line">        <span class="keyword">return</span> _int32(y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 旋转状态</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">twist</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">624</span>):</span><br><span class="line">            y = _int32((self.mt[i] &amp; <span class="number">0x80000000</span>) + (self.mt[(i + <span class="number">1</span>) % <span class="number">624</span>] &amp; <span class="number">0x7fffffff</span>))</span><br><span class="line">            self.mt[i] = (y &gt;&gt; <span class="number">1</span>) ^ self.mt[(i + <span class="number">397</span>) % <span class="number">624</span>]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> y % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">                self.mt[i] = self.mt[i] ^ <span class="number">0x9908b0df</span></span><br></pre></td></tr></table></figure>

<p>举个例子：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">114514</span> 对应的状态序列(前四个)为: [<span class="number">114514</span>, <span class="number">3276889435</span>, <span class="number">1198910394</span>, <span class="number">2731152330</span>]</span><br></pre></td></tr></table></figure>

<p>可以发现状态序列的第一个值就是<code>seed</code>，当我们调用<code>extract_number()</code>的时候，状态序列会先做一次<code>twist</code>，以<code>seed = 114514</code>为例，<code>twist</code>之后的状态序列为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1300186559</span>, <span class="number">2421719561</span>, <span class="number">1949913479</span>, <span class="number">4078121321</span>]</span><br></pre></td></tr></table></figure>

<p>再根据这个状态序列提取出伪随机数</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">114514</span> 产生的输出序列(前四个)为: [<span class="number">2953888979</span>, <span class="number">3549084027</span>, <span class="number">2904140651</span>, <span class="number">3722666743</span>]</span><br></pre></td></tr></table></figure>

<h1 id="安全分析"><a href="#安全分析" class="headerlink" title="安全分析"></a>安全分析</h1><h2 id="逆向-extract-number-函数"><a href="#逆向-extract-number-函数" class="headerlink" title="逆向 extract_number 函数"></a>逆向 extract_number 函数</h2><p>分析可见文末xenny师傅的博客，代码实现：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right_mask</span>(<span class="params">res, shift, mask=<span class="number">0xffffffff</span>, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left_mask</span>(<span class="params">res, shift, mask=<span class="number">0xffffffff</span>, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">y</span>):</span><br><span class="line">    y = inverse_right_mask(y,<span class="number">18</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    y = inverse_right_mask(y,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br></pre></td></tr></table></figure>

<p>验证一下<code>recover(output) == state</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(recover(<span class="number">2953888979</span>))</span><br><span class="line"><span class="built_in">print</span>(recover(<span class="number">3549084027</span>))</span><br><span class="line"><span class="built_in">print</span>(recover(<span class="number">2904140651</span>))</span><br><span class="line"><span class="built_in">print</span>(recover(<span class="number">3722666743</span>))</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1300186559</span><br><span class="line">2421719561</span><br><span class="line">1949913479</span><br><span class="line">4078121321</span><br></pre></td></tr></table></figure>

<p>与<code>twist</code>之后的状态对上了</p>
<h2 id="预测随机数"><a href="#预测随机数" class="headerlink" title="预测随机数"></a>预测随机数</h2><p>当我们能够逆向 extract_number 中的数据时，这也意味着我们能够提取得到 state 中的原始数据，同时可以发现后续的随机数完全依赖于上一轮的 state，所以如果我们能够得到某一轮的全部 state 数据，便可以向后调用 twist 来预测随机数。</p>
<h2 id="逆向-twist-函数"><a href="#逆向-twist-函数" class="headerlink" title="逆向 twist 函数"></a>逆向 twist 函数</h2><p>分析可见文末xenny师傅的博客，代码实现（用的是badmonkey师傅的）：</p>
<p>我们拿3个状态序列进行验证</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">backtrace</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res    </span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line">state1 = [<span class="number">114514</span>, <span class="number">3276889435</span>, <span class="number">1198910394</span>, <span class="number">2731152330</span>, <span class="number">1221055980</span>, <span class="number">2110667654</span>, <span class="number">2498345801</span>, <span class="number">2558461854</span>, <span class="number">712277140</span>, <span class="number">4004272749</span>, <span class="number">1197902704</span>, <span class="number">2284551328</span>, <span class="number">3209223670</span>, <span class="number">2016617809</span>, <span class="number">2421524638</span>, <span class="number">1142841755</span>, <span class="number">3312315346</span>, <span class="number">1447551622</span>, <span class="number">2823265877</span>, <span class="number">3227453286</span>, <span class="number">2419455981</span>, <span class="number">1652734048</span>, <span class="number">3370493787</span>, <span class="number">3700497871</span>, <span class="number">2395401620</span>, <span class="number">2428174919</span>, <span class="number">1507971667</span>, <span class="number">2816728181</span>, <span class="number">1763879439</span>, <span class="number">2517669283</span>, <span class="number">402993571</span>, <span class="number">1628557422</span>, <span class="number">1536926443</span>, <span class="number">2600239219</span>, <span class="number">1970415031</span>, <span class="number">1009862385</span>, <span class="number">3137271353</span>, <span class="number">3623467116</span>, <span class="number">3091344113</span>, <span class="number">3418094854</span>, <span class="number">45449249</span>, <span class="number">2685679150</span>, <span class="number">69921670</span>, <span class="number">2510529033</span>, <span class="number">2912145795</span>, <span class="number">3170283794</span>, <span class="number">696609662</span>, <span class="number">3768309477</span>, <span class="number">3955678958</span>, <span class="number">2268973234</span>, <span class="number">680943010</span>, <span class="number">1658626845</span>, <span class="number">1511675456</span>, <span class="number">1817432282</span>, <span class="number">2983434653</span>, <span class="number">2903159538</span>, <span class="number">596314344</span>, <span class="number">2348198849</span>, <span class="number">814882601</span>, <span class="number">2188524648</span>, <span class="number">4165767182</span>, <span class="number">1537657438</span>, <span class="number">129216185</span>, <span class="number">91484220</span>, <span class="number">334619628</span>, <span class="number">484194397</span>, <span class="number">60228083</span>, <span class="number">3426996258</span>, <span class="number">2114569801</span>, <span class="number">3236938413</span>, <span class="number">680062188</span>, <span class="number">1329841507</span>, <span class="number">1208766962</span>, <span class="number">3327942696</span>, <span class="number">1997927489</span>, <span class="number">1763679627</span>, <span class="number">3951952318</span>, <span class="number">3055539422</span>, <span class="number">2239543066</span>, <span class="number">2312639687</span>, <span class="number">2998968073</span>, <span class="number">2556994216</span>, <span class="number">1257973604</span>, <span class="number">2901317676</span>, <span class="number">2060757114</span>, <span class="number">3278719964</span>, <span class="number">3201451601</span>, <span class="number">3235719702</span>, <span class="number">1968822177</span>, <span class="number">3325473401</span>, <span class="number">3530404988</span>, <span class="number">1046031734</span>, <span class="number">1488786922</span>, <span class="number">4039207188</span>, <span class="number">288146801</span>, <span class="number">3463077620</span>, <span class="number">696952531</span>, <span class="number">717208736</span>, <span class="number">569838466</span>, <span class="number">3291356333</span>, <span class="number">1145859850</span>, <span class="number">2262938300</span>, <span class="number">182793052</span>, <span class="number">745373619</span>, <span class="number">577711367</span>, <span class="number">1143374636</span>, <span class="number">295687723</span>, <span class="number">2094629474</span>, <span class="number">4249644155</span>, <span class="number">1820001221</span>, <span class="number">1810391234</span>, <span class="number">3620440158</span>, <span class="number">97620513</span>, <span class="number">1573474422</span>, <span class="number">599617125</span>, <span class="number">445881164</span>, <span class="number">3379294576</span>, <span class="number">1509019092</span>, <span class="number">1616917119</span>, <span class="number">174807597</span>, <span class="number">47687993</span>, <span class="number">892617974</span>, <span class="number">2705382280</span>, <span class="number">2363062253</span>, <span class="number">243546311</span>, <span class="number">4261275136</span>, <span class="number">2740476589</span>, <span class="number">153906826</span>, <span class="number">2742384370</span>, <span class="number">3666763057</span>, <span class="number">241731388</span>, <span class="number">2722133807</span>, <span class="number">3245414981</span>, <span class="number">412668963</span>, <span class="number">247950677</span>, <span class="number">1736679440</span>, <span class="number">3557703741</span>, <span class="number">867337983</span>, <span class="number">883341861</span>, <span class="number">2993176100</span>, <span class="number">3882670986</span>, <span class="number">1546514074</span>, <span class="number">3708622517</span>, <span class="number">2655738973</span>, <span class="number">1656965387</span>, <span class="number">2959616899</span>, <span class="number">4108858231</span>, <span class="number">995189079</span>, <span class="number">1368651495</span>, <span class="number">650870611</span>, <span class="number">3031541589</span>, <span class="number">2751829226</span>, <span class="number">2772166688</span>, <span class="number">4039821315</span>, <span class="number">4245219482</span>, <span class="number">2167186936</span>, <span class="number">3712370238</span>, <span class="number">2415614894</span>, <span class="number">1676556154</span>, <span class="number">1359591206</span>, <span class="number">2716475907</span>, <span class="number">2274948102</span>, <span class="number">3054135862</span>, <span class="number">1012775719</span>, <span class="number">2352199175</span>, <span class="number">317881758</span>, <span class="number">1446452732</span>, <span class="number">280377976</span>, <span class="number">1450658304</span>, <span class="number">1706146830</span>, <span class="number">3039574421</span>, <span class="number">1818593342</span>, <span class="number">1739683975</span>, <span class="number">3056485259</span>, <span class="number">1193539259</span>, <span class="number">2270159377</span>, <span class="number">1426414895</span>, <span class="number">1581081047</span>, <span class="number">4235010080</span>, <span class="number">2721409410</span>, <span class="number">1997021236</span>, <span class="number">2363757214</span>, <span class="number">4130657346</span>, <span class="number">2721417052</span>, <span class="number">2209486</span>, <span class="number">4290993663</span>, <span class="number">1464070438</span>, <span class="number">3589080094</span>, <span class="number">2525046061</span>, <span class="number">1445122888</span>, <span class="number">835612043</span>, <span class="number">3252525974</span>, <span class="number">834936713</span>, <span class="number">1073726158</span>, <span class="number">1523194376</span>, <span class="number">2078938960</span>, <span class="number">4178349241</span>, <span class="number">1247350823</span>, <span class="number">2010232260</span>, <span class="number">2489721984</span>, <span class="number">224655890</span>, <span class="number">935545827</span>, <span class="number">1524526169</span>, <span class="number">4163098499</span>, <span class="number">4176971340</span>, <span class="number">2964407544</span>, <span class="number">4004512112</span>, <span class="number">3931905582</span>, <span class="number">2444819857</span>, <span class="number">1890891472</span>, <span class="number">1490614855</span>, <span class="number">2339648625</span>, <span class="number">672087347</span>, <span class="number">640184564</span>, <span class="number">3105039642</span>, <span class="number">1729067855</span>, <span class="number">960128158</span>, <span class="number">1010057519</span>, <span class="number">1405673317</span>, <span class="number">3649611599</span>, <span class="number">2542120408</span>, <span class="number">180175327</span>, <span class="number">1711559897</span>, <span class="number">50663959</span>, <span class="number">441414387</span>, <span class="number">2390844864</span>, <span class="number">416282732</span>, <span class="number">1894961023</span>, <span class="number">1430801306</span>, <span class="number">3409496076</span>, <span class="number">1558181329</span>, <span class="number">4153953271</span>, <span class="number">862424108</span>, <span class="number">387045957</span>, <span class="number">3149728547</span>, <span class="number">1987120624</span>, <span class="number">1218935297</span>, <span class="number">2690458349</span>, <span class="number">3841568825</span>, <span class="number">1063752145</span>, <span class="number">2577162597</span>, <span class="number">1755549076</span>, <span class="number">2321455547</span>, <span class="number">2007345136</span>, <span class="number">517094409</span>, <span class="number">458326402</span>, <span class="number">3355749184</span>, <span class="number">1548971366</span>, <span class="number">2219264411</span>, <span class="number">3853642582</span>, <span class="number">561337987</span>, <span class="number">2687253930</span>, <span class="number">1846230084</span>, <span class="number">798143798</span>, <span class="number">72705356</span>, <span class="number">1039836155</span>, <span class="number">4118873607</span>, <span class="number">3258680469</span>, <span class="number">1669961264</span>, <span class="number">2919201624</span>, <span class="number">3057964422</span>, <span class="number">1174921753</span>, <span class="number">667094142</span>, <span class="number">2434096317</span>, <span class="number">3376992099</span>, <span class="number">2354328041</span>, <span class="number">3982194113</span>, <span class="number">2808629397</span>, <span class="number">2334028703</span>, <span class="number">2486018814</span>, <span class="number">2803772026</span>, <span class="number">3706255975</span>, <span class="number">3735441028</span>, <span class="number">4048829268</span>, <span class="number">2640181605</span>, <span class="number">2791081398</span>, <span class="number">3187283224</span>, <span class="number">1420508759</span>, <span class="number">138780420</span>, <span class="number">2393694635</span>, <span class="number">1184332229</span>, <span class="number">3997757293</span>, <span class="number">4276770176</span>, <span class="number">2496387274</span>, <span class="number">417828868</span>, <span class="number">1602877105</span>, <span class="number">2235729038</span>, <span class="number">3691067483</span>, <span class="number">503993304</span>, <span class="number">3420040537</span>, <span class="number">2686226340</span>, <span class="number">1773044641</span>, <span class="number">799706948</span>, <span class="number">2949769977</span>, <span class="number">91162925</span>, <span class="number">3438458088</span>, <span class="number">3573556447</span>, <span class="number">4006365173</span>, <span class="number">1221921592</span>, <span class="number">429780904</span>, <span class="number">237532788</span>, <span class="number">1787220209</span>, <span class="number">596697054</span>, <span class="number">1460150725</span>, <span class="number">1285764996</span>, <span class="number">901649834</span>, <span class="number">1027376964</span>, <span class="number">4028678919</span>, <span class="number">1248204232</span>, <span class="number">1617832578</span>, <span class="number">1842078181</span>, <span class="number">3398378539</span>, <span class="number">1642769664</span>, <span class="number">1597164446</span>, <span class="number">1666936309</span>, <span class="number">311817855</span>, <span class="number">3884791895</span>, <span class="number">3894947425</span>, <span class="number">3042623464</span>, <span class="number">350745233</span>, <span class="number">776555893</span>, <span class="number">4153552234</span>, <span class="number">1893211311</span>, <span class="number">1566470121</span>, <span class="number">1333612492</span>, <span class="number">381694502</span>, <span class="number">1001660484</span>, <span class="number">2234589211</span>, <span class="number">1128139813</span>, <span class="number">1089867645</span>, <span class="number">197228854</span>, <span class="number">1168947609</span>, <span class="number">530551364</span>, <span class="number">2400655905</span>, <span class="number">1276054557</span>, <span class="number">875480155</span>, <span class="number">1610951735</span>, <span class="number">2754435231</span>, <span class="number">2996501571</span>, <span class="number">3119206392</span>, <span class="number">4017707254</span>, <span class="number">908998398</span>, <span class="number">3298533772</span>, <span class="number">2579842498</span>, <span class="number">627590680</span>, <span class="number">2588836049</span>, <span class="number">1840168857</span>, <span class="number">664924243</span>, <span class="number">3804577051</span>, <span class="number">3509253077</span>, <span class="number">1967766220</span>, <span class="number">1386834240</span>, <span class="number">2465288453</span>, <span class="number">1220720676</span>, <span class="number">2388751611</span>, <span class="number">2463852704</span>, <span class="number">2415721294</span>, <span class="number">543085153</span>, <span class="number">816179883</span>, <span class="number">2327321054</span>, <span class="number">3313299764</span>, <span class="number">2481101596</span>, <span class="number">2201764416</span>, <span class="number">2919855989</span>, <span class="number">854315615</span>, <span class="number">523753448</span>, <span class="number">4209727478</span>, <span class="number">3030307352</span>, <span class="number">4157525938</span>, <span class="number">3415518022</span>, <span class="number">2888990891</span>, <span class="number">3345364256</span>, <span class="number">2511844163</span>, <span class="number">3006169882</span>, <span class="number">1261015534</span>, <span class="number">3087563714</span>, <span class="number">2278724664</span>, <span class="number">3439167067</span>, <span class="number">1498618418</span>, <span class="number">4063470234</span>, <span class="number">781322457</span>, <span class="number">1346936858</span>, <span class="number">1326620453</span>, <span class="number">3011448499</span>, <span class="number">3805578837</span>, <span class="number">773261167</span>, <span class="number">2316916557</span>, <span class="number">3269573294</span>, <span class="number">3333438661</span>, <span class="number">3849843107</span>, <span class="number">3556832678</span>, <span class="number">2069444768</span>, <span class="number">3790111245</span>, <span class="number">79089423</span>, <span class="number">2924984693</span>, <span class="number">18734206</span>, <span class="number">2604232002</span>, <span class="number">4125055949</span>, <span class="number">4091705300</span>, <span class="number">1700550754</span>, <span class="number">2540755871</span>, <span class="number">1649978242</span>, <span class="number">895076161</span>, <span class="number">4141115192</span>, <span class="number">3282587355</span>, <span class="number">2340467917</span>, <span class="number">808656449</span>, <span class="number">2669853244</span>, <span class="number">2651892238</span>, <span class="number">4259808341</span>, <span class="number">4169350536</span>, <span class="number">2592320626</span>, <span class="number">1682635212</span>, <span class="number">31343742</span>, <span class="number">3066721620</span>, <span class="number">4093989517</span>, <span class="number">1227461030</span>, <span class="number">2347358084</span>, <span class="number">3292708736</span>, <span class="number">2808589138</span>, <span class="number">4123289652</span>, <span class="number">532909656</span>, <span class="number">867975774</span>, <span class="number">2707193533</span>, <span class="number">881539587</span>, <span class="number">386826200</span>, <span class="number">2047543778</span>, <span class="number">400188218</span>, <span class="number">1993945486</span>, <span class="number">3458143768</span>, <span class="number">4090834261</span>, <span class="number">3451382429</span>, <span class="number">2825920518</span>, <span class="number">91932485</span>, <span class="number">1828162795</span>, <span class="number">175756293</span>, <span class="number">1017795757</span>, <span class="number">1665072886</span>, <span class="number">185452585</span>, <span class="number">2175593188</span>, <span class="number">657966198</span>, <span class="number">2019404359</span>, <span class="number">3439175000</span>, <span class="number">2265772450</span>, <span class="number">1355412956</span>, <span class="number">3914090222</span>, <span class="number">3381121599</span>, <span class="number">1102843755</span>, <span class="number">3075985554</span>, <span class="number">3358743185</span>, <span class="number">5496668</span>, <span class="number">4012072207</span>, <span class="number">3776127872</span>, <span class="number">1193484148</span>, <span class="number">350488559</span>, <span class="number">1371474450</span>, <span class="number">3343394375</span>, <span class="number">4157439645</span>, <span class="number">3676800032</span>, <span class="number">4249018010</span>, <span class="number">1454421289</span>, <span class="number">2562843285</span>, <span class="number">3974248033</span>, <span class="number">1493690489</span>, <span class="number">1456402728</span>, <span class="number">3805485054</span>, <span class="number">3641302435</span>, <span class="number">2011107827</span>, <span class="number">1094359118</span>, <span class="number">2513002496</span>, <span class="number">1424094368</span>, <span class="number">91663964</span>, <span class="number">1067845668</span>, <span class="number">1608023053</span>, <span class="number">522149526</span>, <span class="number">4011366665</span>, <span class="number">3856710862</span>, <span class="number">2622436286</span>, <span class="number">3356690186</span>, <span class="number">461674860</span>, <span class="number">2472498556</span>, <span class="number">2815371927</span>, <span class="number">412650411</span>, <span class="number">1285201754</span>, <span class="number">3083178955</span>, <span class="number">327737650</span>, <span class="number">904043680</span>, <span class="number">1352232199</span>, <span class="number">1795832646</span>, <span class="number">1202938860</span>, <span class="number">29049707</span>, <span class="number">3789741602</span>, <span class="number">2252885489</span>, <span class="number">1373818316</span>, <span class="number">3409504463</span>, <span class="number">261949035</span>, <span class="number">2186267943</span>, <span class="number">1447542410</span>, <span class="number">1226019273</span>, <span class="number">2855570907</span>, <span class="number">3012827537</span>, <span class="number">3525493748</span>, <span class="number">307724649</span>, <span class="number">3869655396</span>, <span class="number">912846491</span>, <span class="number">2303989792</span>, <span class="number">805681508</span>, <span class="number">1144302191</span>, <span class="number">687742306</span>, <span class="number">1336478631</span>, <span class="number">1048014972</span>, <span class="number">4088774379</span>, <span class="number">2184608648</span>, <span class="number">543267187</span>, <span class="number">3083147105</span>, <span class="number">1643853586</span>, <span class="number">2652563331</span>, <span class="number">2265473258</span>, <span class="number">1216505230</span>, <span class="number">2125765234</span>, <span class="number">1628273767</span>, <span class="number">4037979207</span>, <span class="number">3572915422</span>, <span class="number">2733632060</span>, <span class="number">1018468994</span>, <span class="number">2877196631</span>, <span class="number">4257066391</span>, <span class="number">3435508083</span>, <span class="number">2953048896</span>, <span class="number">227233051</span>, <span class="number">1677058233</span>, <span class="number">3393987243</span>, <span class="number">1630377564</span>, <span class="number">352262598</span>, <span class="number">165290804</span>, <span class="number">2253568411</span>, <span class="number">3810860149</span>, <span class="number">152658599</span>, <span class="number">1398820093</span>, <span class="number">3642047879</span>, <span class="number">1642654512</span>, <span class="number">1629029746</span>, <span class="number">1559147389</span>, <span class="number">2694721035</span>, <span class="number">323615917</span>, <span class="number">421807970</span>, <span class="number">2704383436</span>, <span class="number">1588101737</span>, <span class="number">4145880364</span>, <span class="number">3009653936</span>, <span class="number">4003227232</span>, <span class="number">1731486262</span>, <span class="number">2746953947</span>, <span class="number">2817353926</span>, <span class="number">3675732862</span>, <span class="number">996892540</span>, <span class="number">3554282008</span>, <span class="number">4012601812</span>, <span class="number">1827732225</span>, <span class="number">3462793519</span>, <span class="number">3646827660</span>, <span class="number">3018399132</span>, <span class="number">858013576</span>, <span class="number">2953108187</span>, <span class="number">2465692369</span>, <span class="number">3424871028</span>, <span class="number">1592298025</span>, <span class="number">2328226815</span>, <span class="number">3679158793</span>, <span class="number">3014109739</span>, <span class="number">2387940711</span>, <span class="number">3787948052</span>, <span class="number">199416399</span>, <span class="number">1669163624</span>, <span class="number">2471243435</span>, <span class="number">1957026796</span>, <span class="number">3348929473</span>, <span class="number">2859616203</span>, <span class="number">704636303</span>, <span class="number">515381934</span>, <span class="number">3349915370</span>, <span class="number">2137689394</span>, <span class="number">2868839013</span>, <span class="number">1941312490</span>, <span class="number">3337330943</span>, <span class="number">1258381749</span>, <span class="number">4039172686</span>, <span class="number">3780083628</span>, <span class="number">3246066007</span>, <span class="number">3738477681</span>, <span class="number">1292100936</span>, <span class="number">2302445852</span>, <span class="number">4061473062</span>, <span class="number">2439056106</span>, <span class="number">1987540954</span>, <span class="number">1464041146</span>, <span class="number">3884979483</span>, <span class="number">717892813</span>, <span class="number">3378013239</span>, <span class="number">1793810139</span>, <span class="number">3029669978</span>, <span class="number">3544298769</span>, <span class="number">240194676</span>, <span class="number">2300258335</span>, <span class="number">4109982413</span>, <span class="number">2073760675</span>, <span class="number">2736681800</span>, <span class="number">96213137</span>, <span class="number">3293727893</span>, <span class="number">3750657935</span>, <span class="number">38682782</span>, <span class="number">902172345</span>, <span class="number">2819871329</span>, <span class="number">1881013876</span>, <span class="number">2587165583</span>, <span class="number">3400261128</span>, <span class="number">2783936447</span>, <span class="number">3708062970</span>, <span class="number">2299257255</span>, <span class="number">888427908</span>, <span class="number">2898617216</span>, <span class="number">1554962103</span>, <span class="number">3369868860</span>, <span class="number">1925228618</span>]</span><br><span class="line">state2 = [<span class="number">1300186559</span>, <span class="number">2421719561</span>, <span class="number">1949913479</span>, <span class="number">4078121321</span>, <span class="number">1556067905</span>, <span class="number">2787486266</span>, <span class="number">3136021751</span>, <span class="number">2526179473</span>, <span class="number">635316516</span>, <span class="number">1400921081</span>, <span class="number">2604074092</span>, <span class="number">3249849589</span>, <span class="number">418817570</span>, <span class="number">4037671367</span>, <span class="number">1636052064</span>, <span class="number">1190923301</span>, <span class="number">1795011901</span>, <span class="number">1004604065</span>, <span class="number">2485834046</span>, <span class="number">2554059407</span>, <span class="number">4205349812</span>, <span class="number">2033769714</span>, <span class="number">1344771434</span>, <span class="number">2997296894</span>, <span class="number">3465985956</span>, <span class="number">3326352296</span>, <span class="number">732242008</span>, <span class="number">3641892827</span>, <span class="number">2232321494</span>, <span class="number">2936087020</span>, <span class="number">659720973</span>, <span class="number">3256635428</span>, <span class="number">1516889854</span>, <span class="number">275025745</span>, <span class="number">1252522298</span>, <span class="number">738716613</span>, <span class="number">1854282611</span>, <span class="number">2849909068</span>, <span class="number">1873029766</span>, <span class="number">3841467490</span>, <span class="number">1932846561</span>, <span class="number">1226358250</span>, <span class="number">309693247</span>, <span class="number">3908476008</span>, <span class="number">640086734</span>, <span class="number">2554269927</span>, <span class="number">776579599</span>, <span class="number">623549099</span>, <span class="number">2865930935</span>, <span class="number">2647457006</span>, <span class="number">3923439162</span>, <span class="number">2589653938</span>, <span class="number">4263228156</span>, <span class="number">2175968077</span>, <span class="number">3114665078</span>, <span class="number">2966857716</span>, <span class="number">3687905867</span>, <span class="number">3584407716</span>, <span class="number">1350964262</span>, <span class="number">3144576576</span>, <span class="number">2585664434</span>, <span class="number">1106699171</span>, <span class="number">4294649476</span>, <span class="number">1598571743</span>, <span class="number">262622820</span>, <span class="number">1948321351</span>, <span class="number">2133196904</span>, <span class="number">2965545683</span>, <span class="number">1538016887</span>, <span class="number">2370677717</span>, <span class="number">3379970973</span>, <span class="number">1698476215</span>, <span class="number">3068612628</span>, <span class="number">3059990111</span>, <span class="number">2834419782</span>, <span class="number">174131451</span>, <span class="number">81237602</span>, <span class="number">1570833691</span>, <span class="number">855385013</span>, <span class="number">629687189</span>, <span class="number">3497747178</span>, <span class="number">2909705400</span>, <span class="number">234083706</span>, <span class="number">3996451137</span>, <span class="number">2256113529</span>, <span class="number">3740866652</span>, <span class="number">754190929</span>, <span class="number">1415694532</span>, <span class="number">2845509841</span>, <span class="number">1557415582</span>, <span class="number">263584700</span>, <span class="number">1196732851</span>, <span class="number">2144589670</span>, <span class="number">3492122892</span>, <span class="number">3336040792</span>, <span class="number">1267052103</span>, <span class="number">1153242012</span>, <span class="number">3687017742</span>, <span class="number">3028465890</span>, <span class="number">3765041826</span>, <span class="number">1429694420</span>, <span class="number">207685735</span>, <span class="number">621445853</span>, <span class="number">1001078733</span>, <span class="number">4029776482</span>, <span class="number">2207308451</span>, <span class="number">3637149781</span>, <span class="number">2445699193</span>, <span class="number">1717643549</span>, <span class="number">99715333</span>, <span class="number">1875996224</span>, <span class="number">4078855341</span>, <span class="number">1632478108</span>, <span class="number">3064035217</span>, <span class="number">4277957453</span>, <span class="number">2793636656</span>, <span class="number">1285128089</span>, <span class="number">519945857</span>, <span class="number">4257622747</span>, <span class="number">108626880</span>, <span class="number">2643608209</span>, <span class="number">1478625354</span>, <span class="number">2714800475</span>, <span class="number">3209154779</span>, <span class="number">3461373767</span>, <span class="number">475185495</span>, <span class="number">3866746233</span>, <span class="number">755900923</span>, <span class="number">1597052688</span>, <span class="number">3129601545</span>, <span class="number">1156397627</span>, <span class="number">1236520637</span>, <span class="number">3637483477</span>, <span class="number">4255049420</span>, <span class="number">4186829475</span>, <span class="number">3525445277</span>, <span class="number">3559844454</span>, <span class="number">2323762937</span>, <span class="number">2674304649</span>, <span class="number">2425582000</span>, <span class="number">1729074666</span>, <span class="number">3840833400</span>, <span class="number">255337334</span>, <span class="number">2306998122</span>, <span class="number">3760562284</span>, <span class="number">3214023193</span>, <span class="number">1681796735</span>, <span class="number">2726868737</span>, <span class="number">2471053332</span>, <span class="number">576847545</span>, <span class="number">212486172</span>, <span class="number">2776688956</span>, <span class="number">1376680046</span>, <span class="number">2417496621</span>, <span class="number">664940746</span>, <span class="number">3440907204</span>, <span class="number">3759195409</span>, <span class="number">2866815171</span>, <span class="number">334464239</span>, <span class="number">1512549318</span>, <span class="number">2900822999</span>, <span class="number">938855962</span>, <span class="number">155214947</span>, <span class="number">1179600720</span>, <span class="number">4203750227</span>, <span class="number">406827382</span>, <span class="number">3093284839</span>, <span class="number">3117211601</span>, <span class="number">4277910643</span>, <span class="number">3715507772</span>, <span class="number">4244058080</span>, <span class="number">1906019989</span>, <span class="number">834157361</span>, <span class="number">1959550693</span>, <span class="number">2070462915</span>, <span class="number">4167615495</span>, <span class="number">3580586588</span>, <span class="number">2910502587</span>, <span class="number">633302829</span>, <span class="number">3155725275</span>, <span class="number">2885701252</span>, <span class="number">1390776238</span>, <span class="number">1336072448</span>, <span class="number">2277211533</span>, <span class="number">3649278738</span>, <span class="number">3244227318</span>, <span class="number">1497403877</span>, <span class="number">346260150</span>, <span class="number">537921553</span>, <span class="number">1898931284</span>, <span class="number">3248599655</span>, <span class="number">9549388</span>, <span class="number">3240838422</span>, <span class="number">1617356876</span>, <span class="number">3033105076</span>, <span class="number">1469833125</span>, <span class="number">1833251366</span>, <span class="number">1302310200</span>, <span class="number">1567649018</span>, <span class="number">2703353874</span>, <span class="number">2820880867</span>, <span class="number">2101338820</span>, <span class="number">3488744901</span>, <span class="number">3371096956</span>, <span class="number">2333677421</span>, <span class="number">2030638284</span>, <span class="number">4231341832</span>, <span class="number">623744218</span>, <span class="number">62998731</span>, <span class="number">377142964</span>, <span class="number">2567877238</span>, <span class="number">157115091</span>, <span class="number">3432663029</span>, <span class="number">516411923</span>, <span class="number">3746104257</span>, <span class="number">3029262382</span>, <span class="number">4144983612</span>, <span class="number">718920930</span>, <span class="number">2137472368</span>, <span class="number">3995969875</span>, <span class="number">22191306</span>, <span class="number">587299604</span>, <span class="number">2893966416</span>, <span class="number">954886694</span>, <span class="number">1542349911</span>, <span class="number">2226905610</span>, <span class="number">3551625002</span>, <span class="number">1742430322</span>, <span class="number">3049580047</span>, <span class="number">2203982768</span>, <span class="number">1373086797</span>, <span class="number">84701271</span>, <span class="number">883292103</span>, <span class="number">1044238777</span>, <span class="number">3987404393</span>, <span class="number">2558862587</span>, <span class="number">3668343376</span>, <span class="number">1883466927</span>, <span class="number">118471874</span>, <span class="number">2368742991</span>, <span class="number">2230861581</span>, <span class="number">4255371362</span>, <span class="number">1026482141</span>, <span class="number">4238089190</span>, <span class="number">910805600</span>, <span class="number">2955445406</span>, <span class="number">4128402492</span>, <span class="number">1636016038</span>, <span class="number">199240025</span>, <span class="number">2576715508</span>, <span class="number">2729508907</span>, <span class="number">3113427334</span>, <span class="number">3515695411</span>, <span class="number">697275134</span>, <span class="number">1592213241</span>, <span class="number">650556938</span>, <span class="number">1460949881</span>, <span class="number">1452687381</span>, <span class="number">3571707272</span>, <span class="number">21728317</span>, <span class="number">3933195906</span>, <span class="number">1497792261</span>, <span class="number">3179672900</span>, <span class="number">2469055517</span>, <span class="number">1996259687</span>, <span class="number">2147557561</span>, <span class="number">776253687</span>, <span class="number">2947771633</span>, <span class="number">51276949</span>, <span class="number">1106943490</span>, <span class="number">529158532</span>, <span class="number">1232459148</span>, <span class="number">3767864653</span>, <span class="number">4193248866</span>, <span class="number">1980029040</span>, <span class="number">4096763963</span>, <span class="number">1855050522</span>, <span class="number">3992461752</span>, <span class="number">67386296</span>, <span class="number">72924865</span>, <span class="number">798909476</span>, <span class="number">3335728822</span>, <span class="number">4206054289</span>, <span class="number">2544054857</span>, <span class="number">1667887907</span>, <span class="number">1378309729</span>, <span class="number">1281770162</span>, <span class="number">3575329374</span>, <span class="number">4245849552</span>, <span class="number">2952094038</span>, <span class="number">2996286928</span>, <span class="number">410126790</span>, <span class="number">4206969828</span>, <span class="number">2761503777</span>, <span class="number">2528901287</span>, <span class="number">2820990151</span>, <span class="number">1663252720</span>, <span class="number">2904344065</span>, <span class="number">1777485667</span>, <span class="number">2985519918</span>, <span class="number">438855416</span>, <span class="number">3107569577</span>, <span class="number">3102582982</span>, <span class="number">579210656</span>, <span class="number">1199443918</span>, <span class="number">744644631</span>, <span class="number">2224067273</span>, <span class="number">3041421326</span>, <span class="number">2639888889</span>, <span class="number">2719913303</span>, <span class="number">1383736203</span>, <span class="number">4136425977</span>, <span class="number">4049632659</span>, <span class="number">2219904116</span>, <span class="number">3290661668</span>, <span class="number">55911461</span>, <span class="number">2982732145</span>, <span class="number">1427678280</span>, <span class="number">2486171684</span>, <span class="number">4060070147</span>, <span class="number">3958147001</span>, <span class="number">666062800</span>, <span class="number">4230097260</span>, <span class="number">1661187194</span>, <span class="number">3500373021</span>, <span class="number">2841159872</span>, <span class="number">2079971952</span>, <span class="number">2912997657</span>, <span class="number">3037904646</span>, <span class="number">552222278</span>, <span class="number">2155205598</span>, <span class="number">4294855488</span>, <span class="number">487843692</span>, <span class="number">667268740</span>, <span class="number">316258955</span>, <span class="number">3479900121</span>, <span class="number">2398066069</span>, <span class="number">2945753278</span>, <span class="number">2951463761</span>, <span class="number">384896999</span>, <span class="number">3988155630</span>, <span class="number">3702629259</span>, <span class="number">3932234193</span>, <span class="number">506289301</span>, <span class="number">2329038390</span>, <span class="number">303678920</span>, <span class="number">2359413558</span>, <span class="number">905473219</span>, <span class="number">2847916415</span>, <span class="number">3681831997</span>, <span class="number">2517853307</span>, <span class="number">1579173658</span>, <span class="number">2016648517</span>, <span class="number">2017581019</span>, <span class="number">1684247979</span>, <span class="number">416246455</span>, <span class="number">1940797414</span>, <span class="number">3317137329</span>, <span class="number">1290781266</span>, <span class="number">3128029007</span>, <span class="number">3027217218</span>, <span class="number">3088307075</span>, <span class="number">472780280</span>, <span class="number">341029782</span>, <span class="number">2233083149</span>, <span class="number">2719157618</span>, <span class="number">3403421884</span>, <span class="number">485028403</span>, <span class="number">2166629083</span>, <span class="number">3223966716</span>, <span class="number">3929204218</span>, <span class="number">871811346</span>, <span class="number">3859110804</span>, <span class="number">27977352</span>, <span class="number">3196881632</span>, <span class="number">3500147208</span>, <span class="number">3709308235</span>, <span class="number">1610859781</span>, <span class="number">2627287153</span>, <span class="number">2622475485</span>, <span class="number">3090956832</span>, <span class="number">2569260935</span>, <span class="number">1303323714</span>, <span class="number">141702884</span>, <span class="number">1692603307</span>, <span class="number">2414583702</span>, <span class="number">995587729</span>, <span class="number">1454876010</span>, <span class="number">3695609364</span>, <span class="number">1665146544</span>, <span class="number">1004788480</span>, <span class="number">1399640714</span>, <span class="number">3278661166</span>, <span class="number">914140034</span>, <span class="number">4181864942</span>, <span class="number">4083616466</span>, <span class="number">1049705221</span>, <span class="number">2231768074</span>, <span class="number">53846692</span>, <span class="number">2735269409</span>, <span class="number">98568996</span>, <span class="number">4174156476</span>, <span class="number">3271751579</span>, <span class="number">767032814</span>, <span class="number">1907512322</span>, <span class="number">3836629202</span>, <span class="number">3012155077</span>, <span class="number">3808959363</span>, <span class="number">3038707035</span>, <span class="number">870533060</span>, <span class="number">3405425588</span>, <span class="number">2879844340</span>, <span class="number">3249658057</span>, <span class="number">1109764943</span>, <span class="number">4155087663</span>, <span class="number">1149550786</span>, <span class="number">1960546198</span>, <span class="number">2743135655</span>, <span class="number">1394762725</span>, <span class="number">3150541068</span>, <span class="number">797388640</span>, <span class="number">2904007579</span>, <span class="number">3728560164</span>, <span class="number">2919768056</span>, <span class="number">1176015572</span>, <span class="number">1618339851</span>, <span class="number">2865551759</span>, <span class="number">2471469348</span>, <span class="number">1513122248</span>, <span class="number">789586864</span>, <span class="number">926785261</span>, <span class="number">3743483758</span>, <span class="number">2730280881</span>, <span class="number">1397117346</span>, <span class="number">3105476103</span>, <span class="number">2224869954</span>, <span class="number">669368783</span>, <span class="number">92333757</span>, <span class="number">160110497</span>, <span class="number">2667685326</span>, <span class="number">3152132079</span>, <span class="number">4181184877</span>, <span class="number">4144535807</span>, <span class="number">2674627794</span>, <span class="number">511704981</span>, <span class="number">2192336048</span>, <span class="number">402333241</span>, <span class="number">452555907</span>, <span class="number">3725649539</span>, <span class="number">3965158398</span>, <span class="number">2524148862</span>, <span class="number">728233367</span>, <span class="number">3878317488</span>, <span class="number">1087097858</span>, <span class="number">1325720955</span>, <span class="number">258491891</span>, <span class="number">1638929441</span>, <span class="number">1011115613</span>, <span class="number">2074943258</span>, <span class="number">3337952652</span>, <span class="number">2874511404</span>, <span class="number">47406470</span>, <span class="number">1829658648</span>, <span class="number">4055958212</span>, <span class="number">1093330768</span>, <span class="number">4068729548</span>, <span class="number">1876369001</span>, <span class="number">2758112042</span>, <span class="number">4148650082</span>, <span class="number">1465787789</span>, <span class="number">4263988424</span>, <span class="number">698011250</span>, <span class="number">114035271</span>, <span class="number">4187865975</span>, <span class="number">3473368061</span>, <span class="number">2031122238</span>, <span class="number">3618772779</span>, <span class="number">3333981102</span>, <span class="number">4098977072</span>, <span class="number">3626167181</span>, <span class="number">3814766442</span>, <span class="number">2342767603</span>, <span class="number">9173415</span>, <span class="number">3590203971</span>, <span class="number">525480076</span>, <span class="number">3457328088</span>, <span class="number">2953808481</span>, <span class="number">3756708641</span>, <span class="number">2057293555</span>, <span class="number">609281070</span>, <span class="number">2749080332</span>, <span class="number">2899318592</span>, <span class="number">3908060767</span>, <span class="number">2463134799</span>, <span class="number">1903517467</span>, <span class="number">2602646233</span>, <span class="number">718881095</span>, <span class="number">2718640575</span>, <span class="number">3311870910</span>, <span class="number">542617946</span>, <span class="number">2432599960</span>, <span class="number">2787616795</span>, <span class="number">3346827401</span>, <span class="number">2897024136</span>, <span class="number">3914476968</span>, <span class="number">1543956234</span>, <span class="number">3209321257</span>, <span class="number">1004628629</span>, <span class="number">2014256058</span>, <span class="number">3850957743</span>, <span class="number">930176483</span>, <span class="number">577949415</span>, <span class="number">2602510855</span>, <span class="number">3465312733</span>, <span class="number">2783357399</span>, <span class="number">1796687566</span>, <span class="number">3966849315</span>, <span class="number">3604383511</span>, <span class="number">656950527</span>, <span class="number">1397705992</span>, <span class="number">96916189</span>, <span class="number">4240496328</span>, <span class="number">4182970841</span>, <span class="number">1031370161</span>, <span class="number">564867701</span>, <span class="number">2384732535</span>, <span class="number">1318650696</span>, <span class="number">1110024024</span>, <span class="number">1727310331</span>, <span class="number">270526533</span>, <span class="number">2661854250</span>, <span class="number">938001632</span>, <span class="number">639495412</span>, <span class="number">2155709267</span>, <span class="number">795444252</span>, <span class="number">1975762716</span>, <span class="number">2140837083</span>, <span class="number">3804411178</span>, <span class="number">1125054437</span>, <span class="number">2173962251</span>, <span class="number">3034418893</span>, <span class="number">1935436357</span>, <span class="number">2316469247</span>, <span class="number">1633988600</span>, <span class="number">1502251001</span>, <span class="number">2226599618</span>, <span class="number">128135400</span>, <span class="number">3496085807</span>, <span class="number">2114099592</span>, <span class="number">2339117660</span>, <span class="number">278496609</span>, <span class="number">1484151983</span>, <span class="number">4205714595</span>, <span class="number">376588239</span>, <span class="number">4027940519</span>, <span class="number">2634005002</span>, <span class="number">1467975340</span>, <span class="number">1862606465</span>, <span class="number">1103494920</span>, <span class="number">1908207914</span>, <span class="number">2117154890</span>, <span class="number">1263248719</span>, <span class="number">1315033707</span>, <span class="number">1587320866</span>, <span class="number">3380941188</span>, <span class="number">1503082138</span>, <span class="number">2325433031</span>, <span class="number">421207349</span>, <span class="number">476759617</span>, <span class="number">876813245</span>, <span class="number">1859034271</span>, <span class="number">1445696462</span>, <span class="number">598175996</span>, <span class="number">470772924</span>, <span class="number">1336574261</span>, <span class="number">326712384</span>, <span class="number">390455047</span>, <span class="number">1541678691</span>, <span class="number">1367099981</span>, <span class="number">1541819952</span>, <span class="number">133468482</span>, <span class="number">3893666886</span>, <span class="number">1628726082</span>, <span class="number">3386070854</span>, <span class="number">960462772</span>, <span class="number">1955574645</span>, <span class="number">3403042969</span>, <span class="number">1306173238</span>, <span class="number">1316041060</span>, <span class="number">2058354524</span>, <span class="number">281933592</span>, <span class="number">4228952478</span>, <span class="number">3936585735</span>, <span class="number">2984747857</span>, <span class="number">927550830</span>, <span class="number">736401545</span>, <span class="number">205813061</span>, <span class="number">1469474622</span>, <span class="number">3750483616</span>, <span class="number">4233091001</span>, <span class="number">4043476191</span>, <span class="number">4188274906</span>, <span class="number">1294280408</span>, <span class="number">1046712562</span>, <span class="number">2227633163</span>, <span class="number">2367029717</span>, <span class="number">1201238090</span>, <span class="number">52286645</span>, <span class="number">1877754015</span>, <span class="number">210240525</span>, <span class="number">2342093159</span>, <span class="number">3923921476</span>, <span class="number">4159004844</span>, <span class="number">2940553097</span>, <span class="number">870468206</span>, <span class="number">398035220</span>, <span class="number">230840525</span>, <span class="number">3866008332</span>, <span class="number">152500296</span>, <span class="number">3574519790</span>, <span class="number">3240325126</span>, <span class="number">3710664432</span>, <span class="number">2315738871</span>, <span class="number">2166761733</span>]</span><br><span class="line">state3 = [<span class="number">337831377</span>, <span class="number">3760306872</span>, <span class="number">59362890</span>, <span class="number">4072104155</span>, <span class="number">3957213089</span>, <span class="number">125809983</span>, <span class="number">4294342009</span>, <span class="number">593313936</span>, <span class="number">1416023537</span>, <span class="number">3188872435</span>, <span class="number">450545958</span>, <span class="number">4184190538</span>, <span class="number">2461993976</span>, <span class="number">3124280708</span>, <span class="number">298867001</span>, <span class="number">1841803912</span>, <span class="number">3336412864</span>, <span class="number">4257018800</span>, <span class="number">2442239322</span>, <span class="number">160418380</span>, <span class="number">3743187934</span>, <span class="number">2066852176</span>, <span class="number">2728066675</span>, <span class="number">1221357746</span>, <span class="number">3459624527</span>, <span class="number">2347745288</span>, <span class="number">462012618</span>, <span class="number">77582399</span>, <span class="number">938834173</span>, <span class="number">1617767638</span>, <span class="number">2990639414</span>, <span class="number">923048631</span>, <span class="number">3190478023</span>, <span class="number">309224048</span>, <span class="number">1344946771</span>, <span class="number">217545431</span>, <span class="number">1202275588</span>, <span class="number">3469466436</span>, <span class="number">3068182643</span>, <span class="number">3346465760</span>, <span class="number">554481736</span>, <span class="number">2579063521</span>, <span class="number">2876959738</span>, <span class="number">3908226696</span>, <span class="number">1814096321</span>, <span class="number">958725415</span>, <span class="number">351693144</span>, <span class="number">2451447313</span>, <span class="number">3427408583</span>, <span class="number">1662413092</span>, <span class="number">1473513818</span>, <span class="number">2703048701</span>, <span class="number">897999495</span>, <span class="number">3399513669</span>, <span class="number">1930208877</span>, <span class="number">332046410</span>, <span class="number">706285648</span>, <span class="number">659025768</span>, <span class="number">316633811</span>, <span class="number">750721528</span>, <span class="number">3317147475</span>, <span class="number">1146129496</span>, <span class="number">811175740</span>, <span class="number">2894477086</span>, <span class="number">2714463866</span>, <span class="number">1386045484</span>, <span class="number">1890116466</span>, <span class="number">3052696756</span>, <span class="number">1831700473</span>, <span class="number">2456063864</span>, <span class="number">1341365166</span>, <span class="number">3962882152</span>, <span class="number">2506574461</span>, <span class="number">2858394859</span>, <span class="number">4121098960</span>, <span class="number">78102902</span>, <span class="number">1313206565</span>, <span class="number">1332855544</span>, <span class="number">4074563115</span>, <span class="number">4287604318</span>, <span class="number">2416953842</span>, <span class="number">2997389197</span>, <span class="number">1982913522</span>, <span class="number">961855497</span>, <span class="number">3839838173</span>, <span class="number">3489221712</span>, <span class="number">4291743265</span>, <span class="number">2459370555</span>, <span class="number">2692251799</span>, <span class="number">3084220351</span>, <span class="number">1699232551</span>, <span class="number">1165370688</span>, <span class="number">205663400</span>, <span class="number">3232783264</span>, <span class="number">1343910076</span>, <span class="number">3400454033</span>, <span class="number">3207709384</span>, <span class="number">724829034</span>, <span class="number">3944073096</span>, <span class="number">1078129325</span>, <span class="number">1026760019</span>, <span class="number">1324012047</span>, <span class="number">2760547939</span>, <span class="number">2833663657</span>, <span class="number">2129098133</span>, <span class="number">840005756</span>, <span class="number">2101776491</span>, <span class="number">57281017</span>, <span class="number">3354825559</span>, <span class="number">2292378633</span>, <span class="number">2607212572</span>, <span class="number">145345140</span>, <span class="number">1741748408</span>, <span class="number">3506951322</span>, <span class="number">1899171711</span>, <span class="number">1683694868</span>, <span class="number">1492784706</span>, <span class="number">34409573</span>, <span class="number">673941294</span>, <span class="number">2075181236</span>, <span class="number">3133637426</span>, <span class="number">2932391053</span>, <span class="number">2514752954</span>, <span class="number">4226174369</span>, <span class="number">736167612</span>, <span class="number">1399279546</span>, <span class="number">4076262803</span>, <span class="number">238270973</span>, <span class="number">174614188</span>, <span class="number">3051826826</span>, <span class="number">4294494425</span>, <span class="number">3550204622</span>, <span class="number">1859164963</span>, <span class="number">2070341028</span>, <span class="number">3354490737</span>, <span class="number">1275763143</span>, <span class="number">1547031792</span>, <span class="number">4191315847</span>, <span class="number">1032456132</span>, <span class="number">203251246</span>, <span class="number">3501559446</span>, <span class="number">76736094</span>, <span class="number">2236938174</span>, <span class="number">3301924603</span>, <span class="number">3047020438</span>, <span class="number">1627726879</span>, <span class="number">3911730343</span>, <span class="number">271459315</span>, <span class="number">1284471105</span>, <span class="number">32904422</span>, <span class="number">3265428913</span>, <span class="number">386246079</span>, <span class="number">443065237</span>, <span class="number">1128832260</span>, <span class="number">2130335053</span>, <span class="number">330223348</span>, <span class="number">3658147697</span>, <span class="number">552209423</span>, <span class="number">2985062377</span>, <span class="number">3624186776</span>, <span class="number">889190796</span>, <span class="number">3698163174</span>, <span class="number">1385910914</span>, <span class="number">3664877884</span>, <span class="number">122977780</span>, <span class="number">3410395463</span>, <span class="number">2607957781</span>, <span class="number">804290402</span>, <span class="number">925640068</span>, <span class="number">4108377399</span>, <span class="number">4175325856</span>, <span class="number">2646502150</span>, <span class="number">2536342544</span>, <span class="number">3396488353</span>, <span class="number">4078387474</span>, <span class="number">1225967058</span>, <span class="number">3552215870</span>, <span class="number">2222818940</span>, <span class="number">2491271538</span>, <span class="number">1095104581</span>, <span class="number">848748980</span>, <span class="number">1991059149</span>, <span class="number">3241361449</span>, <span class="number">1798658251</span>, <span class="number">2294012221</span>, <span class="number">2495388527</span>, <span class="number">3280115229</span>, <span class="number">2956970851</span>, <span class="number">1276641631</span>, <span class="number">1930312053</span>, <span class="number">227689488</span>, <span class="number">1860473839</span>, <span class="number">178031482</span>, <span class="number">178861634</span>, <span class="number">248901267</span>, <span class="number">3691057428</span>, <span class="number">2536011213</span>, <span class="number">435256083</span>, <span class="number">997485696</span>, <span class="number">3244120427</span>, <span class="number">688494172</span>, <span class="number">1635411101</span>, <span class="number">2553854471</span>, <span class="number">763803574</span>, <span class="number">2233502396</span>, <span class="number">1933555036</span>, <span class="number">1828018847</span>, <span class="number">472836273</span>, <span class="number">2250989199</span>, <span class="number">1260267889</span>, <span class="number">3736851715</span>, <span class="number">3500790714</span>, <span class="number">3672333787</span>, <span class="number">1026928728</span>, <span class="number">3013950035</span>, <span class="number">2355287986</span>, <span class="number">4197034488</span>, <span class="number">206689494</span>, <span class="number">3114790242</span>, <span class="number">1298863784</span>, <span class="number">4159579782</span>, <span class="number">522833504</span>, <span class="number">2306597629</span>, <span class="number">1977414386</span>, <span class="number">3748777973</span>, <span class="number">3823100258</span>, <span class="number">4073429308</span>, <span class="number">2546476553</span>, <span class="number">2710484832</span>, <span class="number">4067077299</span>, <span class="number">1765402671</span>, <span class="number">1753484445</span>, <span class="number">2171202876</span>, <span class="number">1345044114</span>, <span class="number">4128727602</span>, <span class="number">959836377</span>, <span class="number">1597723259</span>, <span class="number">425531207</span>, <span class="number">1727335858</span>, <span class="number">1238082721</span>, <span class="number">3303626165</span>, <span class="number">3595535880</span>, <span class="number">1401536379</span>, <span class="number">2650373104</span>, <span class="number">3853038079</span>, <span class="number">3935873860</span>, <span class="number">2035156383</span>, <span class="number">1139025837</span>, <span class="number">2012966442</span>, <span class="number">1791676089</span>, <span class="number">335929457</span>, <span class="number">1073462793</span>, <span class="number">3743943031</span>, <span class="number">2918379369</span>, <span class="number">402426682</span>, <span class="number">2239226270</span>, <span class="number">3526278147</span>, <span class="number">2553315314</span>, <span class="number">4004113526</span>, <span class="number">2333946758</span>, <span class="number">3888508205</span>, <span class="number">1323874545</span>, <span class="number">3697978374</span>, <span class="number">2782901608</span>, <span class="number">1472461767</span>, <span class="number">2026514647</span>, <span class="number">1235617095</span>, <span class="number">4186128093</span>, <span class="number">3108253152</span>, <span class="number">2764030776</span>, <span class="number">3427279950</span>, <span class="number">3311591352</span>, <span class="number">1171459606</span>, <span class="number">1878263136</span>, <span class="number">822180563</span>, <span class="number">3137532746</span>, <span class="number">1441430008</span>, <span class="number">366351494</span>, <span class="number">976867394</span>, <span class="number">575230101</span>, <span class="number">3922321694</span>, <span class="number">2539500410</span>, <span class="number">3239283121</span>, <span class="number">3265616158</span>, <span class="number">2539451527</span>, <span class="number">887903114</span>, <span class="number">103973079</span>, <span class="number">3141461435</span>, <span class="number">329923827</span>, <span class="number">1762809300</span>, <span class="number">3770627069</span>, <span class="number">2628505480</span>, <span class="number">2581154531</span>, <span class="number">2734534654</span>, <span class="number">2028910088</span>, <span class="number">482089857</span>, <span class="number">501374119</span>, <span class="number">2718042304</span>, <span class="number">4107107839</span>, <span class="number">3631446273</span>, <span class="number">801885152</span>, <span class="number">2849255091</span>, <span class="number">1441056678</span>, <span class="number">1845163714</span>, <span class="number">3225961004</span>, <span class="number">1771839376</span>, <span class="number">2771096153</span>, <span class="number">1202436561</span>, <span class="number">2058321401</span>, <span class="number">2248506088</span>, <span class="number">2602179626</span>, <span class="number">90687947</span>, <span class="number">2379336298</span>, <span class="number">2648641459</span>, <span class="number">1244997366</span>, <span class="number">563364080</span>, <span class="number">3713607067</span>, <span class="number">1868547893</span>, <span class="number">2759947550</span>, <span class="number">3770474411</span>, <span class="number">2473196616</span>, <span class="number">1846240266</span>, <span class="number">3140425132</span>, <span class="number">241747993</span>, <span class="number">2140690186</span>, <span class="number">2531863216</span>, <span class="number">3482987262</span>, <span class="number">1740260048</span>, <span class="number">513789228</span>, <span class="number">2763028364</span>, <span class="number">3608765193</span>, <span class="number">812549667</span>, <span class="number">569615166</span>, <span class="number">3978493425</span>, <span class="number">3185000138</span>, <span class="number">428468546</span>, <span class="number">3748183126</span>, <span class="number">1436268907</span>, <span class="number">3671719256</span>, <span class="number">1359728335</span>, <span class="number">643282304</span>, <span class="number">2634755912</span>, <span class="number">2990881665</span>, <span class="number">1569927513</span>, <span class="number">1258417793</span>, <span class="number">779838133</span>, <span class="number">3091482122</span>, <span class="number">923849554</span>, <span class="number">1517955660</span>, <span class="number">1206196056</span>, <span class="number">2499178028</span>, <span class="number">2398124225</span>, <span class="number">4132377736</span>, <span class="number">1506783129</span>, <span class="number">2606546041</span>, <span class="number">868187487</span>, <span class="number">238297485</span>, <span class="number">2576296432</span>, <span class="number">1470862774</span>, <span class="number">887574146</span>, <span class="number">3194469562</span>, <span class="number">2313580941</span>, <span class="number">1176715276</span>, <span class="number">3350230697</span>, <span class="number">2832982334</span>, <span class="number">1491340186</span>, <span class="number">3680606184</span>, <span class="number">1227829028</span>, <span class="number">1686507424</span>, <span class="number">4031612227</span>, <span class="number">2637445746</span>, <span class="number">2258598492</span>, <span class="number">567301979</span>, <span class="number">4134404567</span>, <span class="number">2021532407</span>, <span class="number">3138129723</span>, <span class="number">3909043899</span>, <span class="number">1441157462</span>, <span class="number">3224040206</span>, <span class="number">1182171781</span>, <span class="number">2530331160</span>, <span class="number">405653356</span>, <span class="number">395826566</span>, <span class="number">1903419003</span>, <span class="number">656393156</span>, <span class="number">1968137342</span>, <span class="number">4083114285</span>, <span class="number">450673286</span>, <span class="number">2915922622</span>, <span class="number">1332395778</span>, <span class="number">4089966713</span>, <span class="number">652365539</span>, <span class="number">2423837830</span>, <span class="number">2815647714</span>, <span class="number">1447295499</span>, <span class="number">4050389209</span>, <span class="number">4133738290</span>, <span class="number">3108289522</span>, <span class="number">355641545</span>, <span class="number">3588063618</span>, <span class="number">4128507391</span>, <span class="number">194939392</span>, <span class="number">533281573</span>, <span class="number">3949177151</span>, <span class="number">3056250389</span>, <span class="number">1420923599</span>, <span class="number">2848539995</span>, <span class="number">4044435398</span>, <span class="number">794592559</span>, <span class="number">3830322675</span>, <span class="number">1055272753</span>, <span class="number">1902871942</span>, <span class="number">1822883351</span>, <span class="number">1633610581</span>, <span class="number">3531451138</span>, <span class="number">1987430036</span>, <span class="number">4224122745</span>, <span class="number">4245407037</span>, <span class="number">1929390953</span>, <span class="number">1566514378</span>, <span class="number">2234144592</span>, <span class="number">1640711809</span>, <span class="number">2332368616</span>, <span class="number">4096015527</span>, <span class="number">2965585865</span>, <span class="number">3071979672</span>, <span class="number">2298120697</span>, <span class="number">1142006456</span>, <span class="number">1995601221</span>, <span class="number">447661486</span>, <span class="number">35009537</span>, <span class="number">1299601851</span>, <span class="number">446471565</span>, <span class="number">3916500291</span>, <span class="number">1583382928</span>, <span class="number">1288769207</span>, <span class="number">3503745776</span>, <span class="number">1131867660</span>, <span class="number">3744006493</span>, <span class="number">505100019</span>, <span class="number">3634817073</span>, <span class="number">1361692403</span>, <span class="number">3285655003</span>, <span class="number">740222701</span>, <span class="number">218621582</span>, <span class="number">1800589985</span>, <span class="number">3642694710</span>, <span class="number">1106175256</span>, <span class="number">1761742751</span>, <span class="number">3259128002</span>, <span class="number">3110582502</span>, <span class="number">3974428973</span>, <span class="number">2210006883</span>, <span class="number">1279351646</span>, <span class="number">158643247</span>, <span class="number">140381615</span>, <span class="number">1967140674</span>, <span class="number">1424975778</span>, <span class="number">1274970715</span>, <span class="number">3569558826</span>, <span class="number">289542225</span>, <span class="number">3230683710</span>, <span class="number">30765499</span>, <span class="number">1068376531</span>, <span class="number">538764833</span>, <span class="number">2283156057</span>, <span class="number">1543052596</span>, <span class="number">3209356676</span>, <span class="number">619193361</span>, <span class="number">1822038303</span>, <span class="number">3375635657</span>, <span class="number">2143683587</span>, <span class="number">1331624480</span>, <span class="number">2277835966</span>, <span class="number">1064049714</span>, <span class="number">3307918688</span>, <span class="number">160862062</span>, <span class="number">1848465129</span>, <span class="number">3403840272</span>, <span class="number">2929218242</span>, <span class="number">1898691151</span>, <span class="number">3467757366</span>, <span class="number">914375776</span>, <span class="number">2642912325</span>, <span class="number">3208195614</span>, <span class="number">799447449</span>, <span class="number">2111892169</span>, <span class="number">58899083</span>, <span class="number">1556138726</span>, <span class="number">3448208768</span>, <span class="number">4088905416</span>, <span class="number">3132319799</span>, <span class="number">2829754927</span>, <span class="number">2819889685</span>, <span class="number">1830490990</span>, <span class="number">1965047196</span>, <span class="number">749922104</span>, <span class="number">2935731601</span>, <span class="number">2504591125</span>, <span class="number">1303137754</span>, <span class="number">2783928754</span>, <span class="number">3417804360</span>, <span class="number">3981736206</span>, <span class="number">558067500</span>, <span class="number">2077583107</span>, <span class="number">3163835657</span>, <span class="number">3870381312</span>, <span class="number">3587075267</span>, <span class="number">1016167026</span>, <span class="number">61052831</span>, <span class="number">1251249842</span>, <span class="number">64737627</span>, <span class="number">3399671739</span>, <span class="number">3452527843</span>, <span class="number">3467986652</span>, <span class="number">3164218557</span>, <span class="number">2607916672</span>, <span class="number">706978141</span>, <span class="number">3037489420</span>, <span class="number">36868946</span>, <span class="number">2627585178</span>, <span class="number">2639236667</span>, <span class="number">3674739078</span>, <span class="number">2487186754</span>, <span class="number">1008248996</span>, <span class="number">2474769499</span>, <span class="number">4184323757</span>, <span class="number">2243506114</span>, <span class="number">953379406</span>, <span class="number">1521521075</span>, <span class="number">906925234</span>, <span class="number">3544626262</span>, <span class="number">4037701350</span>, <span class="number">4070527063</span>, <span class="number">2102027871</span>, <span class="number">3697968971</span>, <span class="number">3076792445</span>, <span class="number">1670764295</span>, <span class="number">2628091153</span>, <span class="number">1320664531</span>, <span class="number">2105117262</span>, <span class="number">3593787350</span>, <span class="number">1361450764</span>, <span class="number">1754584760</span>, <span class="number">1829002324</span>, <span class="number">3880840554</span>, <span class="number">1367698403</span>, <span class="number">3966283916</span>, <span class="number">1807575332</span>, <span class="number">1785423811</span>, <span class="number">3143325329</span>, <span class="number">3687311748</span>, <span class="number">1155053960</span>, <span class="number">1855464818</span>, <span class="number">700817365</span>, <span class="number">1965035130</span>, <span class="number">171591699</span>, <span class="number">4160461965</span>, <span class="number">145817270</span>, <span class="number">518733595</span>, <span class="number">1368366985</span>, <span class="number">66021152</span>, <span class="number">919053651</span>, <span class="number">4222235796</span>, <span class="number">961552934</span>, <span class="number">1184688356</span>, <span class="number">2223960202</span>, <span class="number">2976540287</span>, <span class="number">505549385</span>, <span class="number">472565009</span>, <span class="number">1988556990</span>, <span class="number">1523734271</span>, <span class="number">545051883</span>, <span class="number">110736975</span>, <span class="number">1051479410</span>, <span class="number">3369104656</span>, <span class="number">4078941366</span>, <span class="number">625015765</span>, <span class="number">2734907353</span>, <span class="number">4122303529</span>, <span class="number">1841692090</span>, <span class="number">3956706776</span>, <span class="number">391567100</span>, <span class="number">1386978903</span>, <span class="number">985677973</span>, <span class="number">3955756325</span>, <span class="number">1376387353</span>, <span class="number">2573149192</span>, <span class="number">3031535139</span>, <span class="number">1313192832</span>, <span class="number">4189597286</span>, <span class="number">1149408738</span>, <span class="number">2568973037</span>, <span class="number">2160406879</span>, <span class="number">3319124927</span>, <span class="number">4222387677</span>, <span class="number">3683038940</span>, <span class="number">3002192162</span>, <span class="number">1638932831</span>, <span class="number">3227099627</span>, <span class="number">2327577018</span>, <span class="number">518828443</span>, <span class="number">2755512130</span>, <span class="number">1939114081</span>, <span class="number">2321932643</span>, <span class="number">2749778731</span>, <span class="number">3740325888</span>, <span class="number">942627464</span>, <span class="number">2271311285</span>, <span class="number">2337514986</span>, <span class="number">92470105</span>, <span class="number">1559065490</span>, <span class="number">3152377701</span>, <span class="number">2863547418</span>, <span class="number">285244940</span>, <span class="number">841281031</span>, <span class="number">2086531716</span>, <span class="number">3075247197</span>, <span class="number">207955220</span>, <span class="number">4041829509</span>, <span class="number">3376758938</span>, <span class="number">2320033199</span>, <span class="number">687320196</span>, <span class="number">628757765</span>]</span><br><span class="line"></span><br><span class="line">recover_state1 = backtrace(state2)</span><br><span class="line">recover_state2 = backtrace(state3)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(recover_state1)</span><br><span class="line"><span class="built_in">print</span>(recover_state2)</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[1642261423, 3276889435, 1198910394, 2731152330, 1221055980, 2110667654, 2498345801, 2558461854, 712277140, 4004272749, 1197902704, 2284551328, 3209223670, 2016617809, 2421524638, 1142841755, 3312315346, 1447551622, 2823265877, 3227453286, 2419455981, 1652734048, 3370493787, 3700497871, 2395401620, 2428174919, 1507971667, 2816728181, 1763879439, 2517669283, 402993571, 1628557422, 1536926443, 2600239219, 1970415031, 1009862385, 3137271353, 3623467116, 3091344113, 3418094854, 45449249, 2685679150, 69921670, 2510529033, 2912145795, 3170283794, 696609662, 3768309477, 3955678958, 2268973234, 680943010, 1658626845, 1511675456, 1817432282, 2983434653, 2903159538, 596314344, 2348198849, 814882601, 2188524648, 4165767182, 1537657438, 129216185, 91484220, 334619628, 484194397, 60228083, 3426996258, 2114569801, 3236938413, 680062188, 1329841507, 1208766962, 3327942696, 1997927489, 1763679627, 3951952318, 3055539422, 2239543066, 2312639687, 2998968073, 2556994216, 1257973604, 2901317676, 2060757114, 3278719964, 3201451601, 3235719702, 1968822177, 3325473401, 3530404988, 1046031734, 1488786922, 4039207188, 288146801, 3463077620, 696952531, 717208736, 569838466, 3291356333, 1145859850, 2262938300, 182793052, 745373619, 577711367, 1143374636, 295687723, 2094629474, 4249644155, 1820001221, 1810391234, 3620440158, 97620513, 1573474422, 599617125, 445881164, 3379294576, 1509019092, 1616917119, 174807597, 47687993, 892617974, 2705382280, 2363062253, 243546311, 4261275136, 2740476589, 153906826, 2742384370, 3666763057, 241731388, 2722133807, 3245414981, 412668963, 247950677, 1736679440, 3557703741, 867337983, 883341861, 2993176100, 3882670986, 1546514074, 3708622517, 2655738973, 1656965387, 2959616899, 4108858231, 995189079, 1368651495, 650870611, 3031541589, 2751829226, 2772166688, 4039821315, 4245219482, 2167186936, 3712370238, 2415614894, 1676556154, 1359591206, 2716475907, 2274948102, 3054135862, 1012775719, 2352199175, 317881758, 1446452732, 280377976, 1450658304, 1706146830, 3039574421, 1818593342, 1739683975, 3056485259, 1193539259, 2270159377, 1426414895, 1581081047, 4235010080, 2721409410, 1997021236, 2363757214, 4130657346, 2721417052, 2209486, 4290993663, 1464070438, 3589080094, 2525046061, 1445122888, 835612043, 3252525974, 834936713, 1073726158, 1523194376, 2078938960, 4178349241, 1247350823, 2010232260, 2489721984, 224655890, 935545827, 1524526169, 4163098499, 4176971340, 2964407544, 4004512112, 3931905582, 2444819857, 1890891472, 1490614855, 2339648625, 672087347, 640184564, 3105039642, 1729067855, 960128158, 1010057519, 1405673317, 3649611599, 2542120408, 180175327, 1711559897, 50663959, 441414387, 2390844864, 416282732, 1894961023, 1430801306, 3409496076, 1558181329, 4153953271, 862424108, 387045957, 3149728547, 1987120624, 1218935297, 2690458349, 3841568825, 1063752145, 2577162597, 1755549076, 2321455547, 2007345136, 517094409, 458326402, 3355749184, 1548971366, 2219264411, 3853642582, 561337987, 2687253930, 1846230084, 798143798, 72705356, 1039836155, 4118873607, 3258680469, 1669961264, 2919201624, 3057964422, 1174921753, 667094142, 2434096317, 3376992099, 2354328041, 3982194113, 2808629397, 2334028703, 2486018814, 2803772026, 3706255975, 3735441028, 4048829268, 2640181605, 2791081398, 3187283224, 1420508759, 138780420, 2393694635, 1184332229, 3997757293, 4276770176, 2496387274, 417828868, 1602877105, 2235729038, 3691067483, 503993304, 3420040537, 2686226340, 1773044641, 799706948, 2949769977, 91162925, 3438458088, 3573556447, 4006365173, 1221921592, 429780904, 237532788, 1787220209, 596697054, 1460150725, 1285764996, 901649834, 1027376964, 4028678919, 1248204232, 1617832578, 1842078181, 3398378539, 1642769664, 1597164446, 1666936309, 311817855, 3884791895, 3894947425, 3042623464, 350745233, 776555893, 4153552234, 1893211311, 1566470121, 1333612492, 381694502, 1001660484, 2234589211, 1128139813, 1089867645, 197228854, 1168947609, 530551364, 2400655905, 1276054557, 875480155, 1610951735, 2754435231, 2996501571, 3119206392, 4017707254, 908998398, 3298533772, 2579842498, 627590680, 2588836049, 1840168857, 664924243, 3804577051, 3509253077, 1967766220, 1386834240, 2465288453, 1220720676, 2388751611, 2463852704, 2415721294, 543085153, 816179883, 2327321054, 3313299764, 2481101596, 2201764416, 2919855989, 854315615, 523753448, 4209727478, 3030307352, 4157525938, 3415518022, 2888990891, 3345364256, 2511844163, 3006169882, 1261015534, 3087563714, 2278724664, 3439167067, 1498618418, 4063470234, 781322457, 1346936858, 1326620453, 3011448499, 3805578837, 773261167, 2316916557, 3269573294, 3333438661, 3849843107, 3556832678, 2069444768, 3790111245, 79089423, 2924984693, 18734206, 2604232002, 4125055949, 4091705300, 1700550754, 2540755871, 1649978242, 895076161, 4141115192, 3282587355, 2340467917, 808656449, 2669853244, 2651892238, 4259808341, 4169350536, 2592320626, 1682635212, 31343742, 3066721620, 4093989517, 1227461030, 2347358084, 3292708736, 2808589138, 4123289652, 532909656, 867975774, 2707193533, 881539587, 386826200, 2047543778, 400188218, 1993945486, 3458143768, 4090834261, 3451382429, 2825920518, 91932485, 1828162795, 175756293, 1017795757, 1665072886, 185452585, 2175593188, 657966198, 2019404359, 3439175000, 2265772450, 1355412956, 3914090222, 3381121599, 1102843755, 3075985554, 3358743185, 5496668, 4012072207, 3776127872, 1193484148, 350488559, 1371474450, 3343394375, 4157439645, 3676800032, 4249018010, 1454421289, 2562843285, 3974248033, 1493690489, 1456402728, 3805485054, 3641302435, 2011107827, 1094359118, 2513002496, 1424094368, 91663964, 1067845668, 1608023053, 522149526, 4011366665, 3856710862, 2622436286, 3356690186, 461674860, 2472498556, 2815371927, 412650411, 1285201754, 3083178955, 327737650, 904043680, 1352232199, 1795832646, 1202938860, 29049707, 3789741602, 2252885489, 1373818316, 3409504463, 261949035, 2186267943, 1447542410, 1226019273, 2855570907, 3012827537, 3525493748, 307724649, 3869655396, 912846491, 2303989792, 805681508, 1144302191, 687742306, 1336478631, 1048014972, 4088774379, 2184608648, 543267187, 3083147105, 1643853586, 2652563331, 2265473258, 1216505230, 2125765234, 1628273767, 4037979207, 3572915422, 2733632060, 1018468994, 2877196631, 4257066391, 3435508083, 2953048896, 227233051, 1677058233, 3393987243, 1630377564, 352262598, 165290804, 2253568411, 3810860149, 152658599, 1398820093, 3642047879, 1642654512, 1629029746, 1559147389, 2694721035, 323615917, 421807970, 2704383436, 1588101737, 4145880364, 3009653936, 4003227232, 1731486262, 2746953947, 2817353926, 3675732862, 996892540, 3554282008, 4012601812, 1827732225, 3462793519, 3646827660, 3018399132, 858013576, 2953108187, 2465692369, 3424871028, 1592298025, 2328226815, 3679158793, 3014109739, 2387940711, 3787948052, 199416399, 1669163624, 2471243435, 1957026796, 3348929473, 2859616203, 704636303, 515381934, 3349915370, 2137689394, 2868839013, 1941312490, 3337330943, 1258381749, 4039172686, 3780083628, 3246066007, 3738477681, 1292100936, 2302445852, 4061473062, 2439056106, 1987540954, 1464041146, 3884979483, 717892813, 3378013239, 1793810139, 3029669978, 3544298769, 240194676, 2300258335, 4109982413, 2073760675, 2736681800, 96213137, 3293727893, 3750657935, 38682782, 902172345, 2819871329, 1881013876, 2587165583, 3400261128, 2783936447, 3708062970, 2299257255, 888427908, 2898617216, 1554962103, 3369868860, 1925228618]</span><br><span class="line">[1300186559, 2421719561, 1949913479, 4078121321, 1556067905, 2787486266, 3136021751, 2526179473, 635316516, 1400921081, 2604074092, 3249849589, 418817570, 4037671367, 1636052064, 1190923301, 1795011901, 1004604065, 2485834046, 2554059407, 4205349812, 2033769714, 1344771434, 2997296894, 3465985956, 3326352296, 732242008, 3641892827, 2232321494, 2936087020, 659720973, 3256635428, 1516889854, 275025745, 1252522298, 738716613, 1854282611, 2849909068, 1873029766, 3841467490, 1932846561, 1226358250, 309693247, 3908476008, 640086734, 2554269927, 776579599, 623549099, 2865930935, 2647457006, 3923439162, 2589653938, 4263228156, 2175968077, 3114665078, 2966857716, 3687905867, 3584407716, 1350964262, 3144576576, 2585664434, 1106699171, 4294649476, 1598571743, 262622820, 1948321351, 2133196904, 2965545683, 1538016887, 2370677717, 3379970973, 1698476215, 3068612628, 3059990111, 2834419782, 174131451, 81237602, 1570833691, 855385013, 629687189, 3497747178, 2909705400, 234083706, 3996451137, 2256113529, 3740866652, 754190929, 1415694532, 2845509841, 1557415582, 263584700, 1196732851, 2144589670, 3492122892, 3336040792, 1267052103, 1153242012, 3687017742, 3028465890, 3765041826, 1429694420, 207685735, 621445853, 1001078733, 4029776482, 2207308451, 3637149781, 2445699193, 1717643549, 99715333, 1875996224, 4078855341, 1632478108, 3064035217, 4277957453, 2793636656, 1285128089, 519945857, 4257622747, 108626880, 2643608209, 1478625354, 2714800475, 3209154779, 3461373767, 475185495, 3866746233, 755900923, 1597052688, 3129601545, 1156397627, 1236520637, 3637483477, 4255049420, 4186829475, 3525445277, 3559844454, 2323762937, 2674304649, 2425582000, 1729074666, 3840833400, 255337334, 2306998122, 3760562284, 3214023193, 1681796735, 2726868737, 2471053332, 576847545, 212486172, 2776688956, 1376680046, 2417496621, 664940746, 3440907204, 3759195409, 2866815171, 334464239, 1512549318, 2900822999, 938855962, 155214947, 1179600720, 4203750227, 406827382, 3093284839, 3117211601, 4277910643, 3715507772, 4244058080, 1906019989, 834157361, 1959550693, 2070462915, 4167615495, 3580586588, 2910502587, 633302829, 3155725275, 2885701252, 1390776238, 1336072448, 2277211533, 3649278738, 3244227318, 1497403877, 346260150, 537921553, 1898931284, 3248599655, 9549388, 3240838422, 1617356876, 3033105076, 1469833125, 1833251366, 1302310200, 1567649018, 2703353874, 2820880867, 2101338820, 3488744901, 3371096956, 2333677421, 2030638284, 4231341832, 623744218, 62998731, 377142964, 2567877238, 157115091, 3432663029, 516411923, 3746104257, 3029262382, 4144983612, 718920930, 2137472368, 3995969875, 22191306, 587299604, 2893966416, 954886694, 1542349911, 2226905610, 3551625002, 1742430322, 3049580047, 2203982768, 1373086797, 84701271, 883292103, 1044238777, 3987404393, 2558862587, 3668343376, 1883466927, 118471874, 2368742991, 2230861581, 4255371362, 1026482141, 4238089190, 910805600, 2955445406, 4128402492, 1636016038, 199240025, 2576715508, 2729508907, 3113427334, 3515695411, 697275134, 1592213241, 650556938, 1460949881, 1452687381, 3571707272, 21728317, 3933195906, 1497792261, 3179672900, 2469055517, 1996259687, 2147557561, 776253687, 2947771633, 51276949, 1106943490, 529158532, 1232459148, 3767864653, 4193248866, 1980029040, 4096763963, 1855050522, 3992461752, 67386296, 72924865, 798909476, 3335728822, 4206054289, 2544054857, 1667887907, 1378309729, 1281770162, 3575329374, 4245849552, 2952094038, 2996286928, 410126790, 4206969828, 2761503777, 2528901287, 2820990151, 1663252720, 2904344065, 1777485667, 2985519918, 438855416, 3107569577, 3102582982, 579210656, 1199443918, 744644631, 2224067273, 3041421326, 2639888889, 2719913303, 1383736203, 4136425977, 4049632659, 2219904116, 3290661668, 55911461, 2982732145, 1427678280, 2486171684, 4060070147, 3958147001, 666062800, 4230097260, 1661187194, 3500373021, 2841159872, 2079971952, 2912997657, 3037904646, 552222278, 2155205598, 4294855488, 487843692, 667268740, 316258955, 3479900121, 2398066069, 2945753278, 2951463761, 384896999, 3988155630, 3702629259, 3932234193, 506289301, 2329038390, 303678920, 2359413558, 905473219, 2847916415, 3681831997, 2517853307, 1579173658, 2016648517, 2017581019, 1684247979, 416246455, 1940797414, 3317137329, 1290781266, 3128029007, 3027217218, 3088307075, 472780280, 341029782, 2233083149, 2719157618, 3403421884, 485028403, 2166629083, 3223966716, 3929204218, 871811346, 3859110804, 27977352, 3196881632, 3500147208, 3709308235, 1610859781, 2627287153, 2622475485, 3090956832, 2569260935, 1303323714, 141702884, 1692603307, 2414583702, 995587729, 1454876010, 3695609364, 1665146544, 1004788480, 1399640714, 3278661166, 914140034, 4181864942, 4083616466, 1049705221, 2231768074, 53846692, 2735269409, 98568996, 4174156476, 3271751579, 767032814, 1907512322, 3836629202, 3012155077, 3808959363, 3038707035, 870533060, 3405425588, 2879844340, 3249658057, 1109764943, 4155087663, 1149550786, 1960546198, 2743135655, 1394762725, 3150541068, 797388640, 2904007579, 3728560164, 2919768056, 1176015572, 1618339851, 2865551759, 2471469348, 1513122248, 789586864, 926785261, 3743483758, 2730280881, 1397117346, 3105476103, 2224869954, 669368783, 92333757, 160110497, 2667685326, 3152132079, 4181184877, 4144535807, 2674627794, 511704981, 2192336048, 402333241, 452555907, 3725649539, 3965158398, 2524148862, 728233367, 3878317488, 1087097858, 1325720955, 258491891, 1638929441, 1011115613, 2074943258, 3337952652, 2874511404, 47406470, 1829658648, 4055958212, 1093330768, 4068729548, 1876369001, 2758112042, 4148650082, 1465787789, 4263988424, 698011250, 114035271, 4187865975, 3473368061, 2031122238, 3618772779, 3333981102, 4098977072, 3626167181, 3814766442, 2342767603, 9173415, 3590203971, 525480076, 3457328088, 2953808481, 3756708641, 2057293555, 609281070, 2749080332, 2899318592, 3908060767, 2463134799, 1903517467, 2602646233, 718881095, 2718640575, 3311870910, 542617946, 2432599960, 2787616795, 3346827401, 2897024136, 3914476968, 1543956234, 3209321257, 1004628629, 2014256058, 3850957743, 930176483, 577949415, 2602510855, 3465312733, 2783357399, 1796687566, 3966849315, 3604383511, 656950527, 1397705992, 96916189, 4240496328, 4182970841, 1031370161, 564867701, 2384732535, 1318650696, 1110024024, 1727310331, 270526533, 2661854250, 938001632, 639495412, 2155709267, 795444252, 1975762716, 2140837083, 3804411178, 1125054437, 2173962251, 3034418893, 1935436357, 2316469247, 1633988600, 1502251001, 2226599618, 128135400, 3496085807, 2114099592, 2339117660, 278496609, 1484151983, 4205714595, 376588239, 4027940519, 2634005002, 1467975340, 1862606465, 1103494920, 1908207914, 2117154890, 1263248719, 1315033707, 1587320866, 3380941188, 1503082138, 2325433031, 421207349, 476759617, 876813245, 1859034271, 1445696462, 598175996, 470772924, 1336574261, 326712384, 390455047, 1541678691, 1367099981, 1541819952, 133468482, 3893666886, 1628726082, 3386070854, 960462772, 1955574645, 3403042969, 1306173238, 1316041060, 2058354524, 281933592, 4228952478, 3936585735, 2984747857, 927550830, 736401545, 205813061, 1469474622, 3750483616, 4233091001, 4043476191, 4188274906, 1294280408, 1046712562, 2227633163, 2367029717, 1201238090, 52286645, 1877754015, 210240525, 2342093159, 3923921476, 4159004844, 2940553097, 870468206, 398035220, 230840525, 3866008332, 152500296, 3574519790, 3240325126, 3710664432, 2315738871, 2166761733]</span><br></pre></td></tr></table></figure>

<p>从运行结果会发现，除了无法恢复<code>seed</code>，其他的状态是完全可以恢复的</p>
<h2 id="逆向-init-函数"><a href="#逆向-init-函数" class="headerlink" title="逆向 init 函数"></a>逆向 init 函数</h2><p>分析可见文末xenny师傅博客，代码实现：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">    mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">    mt[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">        mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">    <span class="keyword">return</span> mt</span><br><span class="line"></span><br><span class="line">seed = <span class="number">3989032602</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">res,shift</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>//shift):</span><br><span class="line">        res = tmp^res&gt;&gt;shift</span><br><span class="line">    <span class="keyword">return</span> _int32(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">last</span>):</span><br><span class="line">    n = <span class="number">1</span>&lt;&lt;<span class="number">32</span></span><br><span class="line">    inv = invert(<span class="number">1812433253</span>,n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        last = ((last-i)*inv)%n</span><br><span class="line">        last = invert_right(last,<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> last</span><br><span class="line"></span><br><span class="line">state = init(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(recover(state[-<span class="number">1</span>]) == seed)</span><br></pre></td></tr></table></figure>

<p>这里的<code>state = init(seed)</code>，其实索引为0的那个值就是<code>seed</code>，根本不需要调用<code>recover</code></p>
<p>于是我用上面通过逆向<code>twist</code>的<code>state</code>进行验证</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">    mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">    mt[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">        mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">    <span class="keyword">return</span> mt</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">invert_right</span>(<span class="params">res,shift</span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>//shift):</span><br><span class="line">        res = tmp^res&gt;&gt;shift</span><br><span class="line">    <span class="keyword">return</span> _int32(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">last</span>):</span><br><span class="line">    n = <span class="number">1</span>&lt;&lt;<span class="number">32</span></span><br><span class="line">    inv = invert(<span class="number">1812433253</span>,n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">623</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        last = ((last-i)*inv)%n</span><br><span class="line">        last = invert_right(last,<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> last</span><br><span class="line"></span><br><span class="line">state = [<span class="number">1642261423</span>, <span class="number">3276889435</span>, <span class="number">1198910394</span>, <span class="number">2731152330</span>, <span class="number">1221055980</span>, <span class="number">2110667654</span>, <span class="number">2498345801</span>, <span class="number">2558461854</span>, <span class="number">712277140</span>, <span class="number">4004272749</span>, <span class="number">1197902704</span>, <span class="number">2284551328</span>, <span class="number">3209223670</span>, <span class="number">2016617809</span>, <span class="number">2421524638</span>, <span class="number">1142841755</span>, <span class="number">3312315346</span>, <span class="number">1447551622</span>, <span class="number">2823265877</span>, <span class="number">3227453286</span>, <span class="number">2419455981</span>, <span class="number">1652734048</span>, <span class="number">3370493787</span>, <span class="number">3700497871</span>, <span class="number">2395401620</span>, <span class="number">2428174919</span>, <span class="number">1507971667</span>, <span class="number">2816728181</span>, <span class="number">1763879439</span>, <span class="number">2517669283</span>, <span class="number">402993571</span>, <span class="number">1628557422</span>, <span class="number">1536926443</span>, <span class="number">2600239219</span>, <span class="number">1970415031</span>, <span class="number">1009862385</span>, <span class="number">3137271353</span>, <span class="number">3623467116</span>, <span class="number">3091344113</span>, <span class="number">3418094854</span>, <span class="number">45449249</span>, <span class="number">2685679150</span>, <span class="number">69921670</span>, <span class="number">2510529033</span>, <span class="number">2912145795</span>, <span class="number">3170283794</span>, <span class="number">696609662</span>, <span class="number">3768309477</span>, <span class="number">3955678958</span>, <span class="number">2268973234</span>, <span class="number">680943010</span>, <span class="number">1658626845</span>, <span class="number">1511675456</span>, <span class="number">1817432282</span>, <span class="number">2983434653</span>, <span class="number">2903159538</span>, <span class="number">596314344</span>, <span class="number">2348198849</span>, <span class="number">814882601</span>, <span class="number">2188524648</span>, <span class="number">4165767182</span>, <span class="number">1537657438</span>, <span class="number">129216185</span>, <span class="number">91484220</span>, <span class="number">334619628</span>, <span class="number">484194397</span>, <span class="number">60228083</span>, <span class="number">3426996258</span>, <span class="number">2114569801</span>, <span class="number">3236938413</span>, <span class="number">680062188</span>, <span class="number">1329841507</span>, <span class="number">1208766962</span>, <span class="number">3327942696</span>, <span class="number">1997927489</span>, <span class="number">1763679627</span>, <span class="number">3951952318</span>, <span class="number">3055539422</span>, <span class="number">2239543066</span>, <span class="number">2312639687</span>, <span class="number">2998968073</span>, <span class="number">2556994216</span>, <span class="number">1257973604</span>, <span class="number">2901317676</span>, <span class="number">2060757114</span>, <span class="number">3278719964</span>, <span class="number">3201451601</span>, <span class="number">3235719702</span>, <span class="number">1968822177</span>, <span class="number">3325473401</span>, <span class="number">3530404988</span>, <span class="number">1046031734</span>, <span class="number">1488786922</span>, <span class="number">4039207188</span>, <span class="number">288146801</span>, <span class="number">3463077620</span>, <span class="number">696952531</span>, <span class="number">717208736</span>, <span class="number">569838466</span>, <span class="number">3291356333</span>, <span class="number">1145859850</span>, <span class="number">2262938300</span>, <span class="number">182793052</span>, <span class="number">745373619</span>, <span class="number">577711367</span>, <span class="number">1143374636</span>, <span class="number">295687723</span>, <span class="number">2094629474</span>, <span class="number">4249644155</span>, <span class="number">1820001221</span>, <span class="number">1810391234</span>, <span class="number">3620440158</span>, <span class="number">97620513</span>, <span class="number">1573474422</span>, <span class="number">599617125</span>, <span class="number">445881164</span>, <span class="number">3379294576</span>, <span class="number">1509019092</span>, <span class="number">1616917119</span>, <span class="number">174807597</span>, <span class="number">47687993</span>, <span class="number">892617974</span>, <span class="number">2705382280</span>, <span class="number">2363062253</span>, <span class="number">243546311</span>, <span class="number">4261275136</span>, <span class="number">2740476589</span>, <span class="number">153906826</span>, <span class="number">2742384370</span>, <span class="number">3666763057</span>, <span class="number">241731388</span>, <span class="number">2722133807</span>, <span class="number">3245414981</span>, <span class="number">412668963</span>, <span class="number">247950677</span>, <span class="number">1736679440</span>, <span class="number">3557703741</span>, <span class="number">867337983</span>, <span class="number">883341861</span>, <span class="number">2993176100</span>, <span class="number">3882670986</span>, <span class="number">1546514074</span>, <span class="number">3708622517</span>, <span class="number">2655738973</span>, <span class="number">1656965387</span>, <span class="number">2959616899</span>, <span class="number">4108858231</span>, <span class="number">995189079</span>, <span class="number">1368651495</span>, <span class="number">650870611</span>, <span class="number">3031541589</span>, <span class="number">2751829226</span>, <span class="number">2772166688</span>, <span class="number">4039821315</span>, <span class="number">4245219482</span>, <span class="number">2167186936</span>, <span class="number">3712370238</span>, <span class="number">2415614894</span>, <span class="number">1676556154</span>, <span class="number">1359591206</span>, <span class="number">2716475907</span>, <span class="number">2274948102</span>, <span class="number">3054135862</span>, <span class="number">1012775719</span>, <span class="number">2352199175</span>, <span class="number">317881758</span>, <span class="number">1446452732</span>, <span class="number">280377976</span>, <span class="number">1450658304</span>, <span class="number">1706146830</span>, <span class="number">3039574421</span>, <span class="number">1818593342</span>, <span class="number">1739683975</span>, <span class="number">3056485259</span>, <span class="number">1193539259</span>, <span class="number">2270159377</span>, <span class="number">1426414895</span>, <span class="number">1581081047</span>, <span class="number">4235010080</span>, <span class="number">2721409410</span>, <span class="number">1997021236</span>, <span class="number">2363757214</span>, <span class="number">4130657346</span>, <span class="number">2721417052</span>, <span class="number">2209486</span>, <span class="number">4290993663</span>, <span class="number">1464070438</span>, <span class="number">3589080094</span>, <span class="number">2525046061</span>, <span class="number">1445122888</span>, <span class="number">835612043</span>, <span class="number">3252525974</span>, <span class="number">834936713</span>, <span class="number">1073726158</span>, <span class="number">1523194376</span>, <span class="number">2078938960</span>, <span class="number">4178349241</span>, <span class="number">1247350823</span>, <span class="number">2010232260</span>, <span class="number">2489721984</span>, <span class="number">224655890</span>, <span class="number">935545827</span>, <span class="number">1524526169</span>, <span class="number">4163098499</span>, <span class="number">4176971340</span>, <span class="number">2964407544</span>, <span class="number">4004512112</span>, <span class="number">3931905582</span>, <span class="number">2444819857</span>, <span class="number">1890891472</span>, <span class="number">1490614855</span>, <span class="number">2339648625</span>, <span class="number">672087347</span>, <span class="number">640184564</span>, <span class="number">3105039642</span>, <span class="number">1729067855</span>, <span class="number">960128158</span>, <span class="number">1010057519</span>, <span class="number">1405673317</span>, <span class="number">3649611599</span>, <span class="number">2542120408</span>, <span class="number">180175327</span>, <span class="number">1711559897</span>, <span class="number">50663959</span>, <span class="number">441414387</span>, <span class="number">2390844864</span>, <span class="number">416282732</span>, <span class="number">1894961023</span>, <span class="number">1430801306</span>, <span class="number">3409496076</span>, <span class="number">1558181329</span>, <span class="number">4153953271</span>, <span class="number">862424108</span>, <span class="number">387045957</span>, <span class="number">3149728547</span>, <span class="number">1987120624</span>, <span class="number">1218935297</span>, <span class="number">2690458349</span>, <span class="number">3841568825</span>, <span class="number">1063752145</span>, <span class="number">2577162597</span>, <span class="number">1755549076</span>, <span class="number">2321455547</span>, <span class="number">2007345136</span>, <span class="number">517094409</span>, <span class="number">458326402</span>, <span class="number">3355749184</span>, <span class="number">1548971366</span>, <span class="number">2219264411</span>, <span class="number">3853642582</span>, <span class="number">561337987</span>, <span class="number">2687253930</span>, <span class="number">1846230084</span>, <span class="number">798143798</span>, <span class="number">72705356</span>, <span class="number">1039836155</span>, <span class="number">4118873607</span>, <span class="number">3258680469</span>, <span class="number">1669961264</span>, <span class="number">2919201624</span>, <span class="number">3057964422</span>, <span class="number">1174921753</span>, <span class="number">667094142</span>, <span class="number">2434096317</span>, <span class="number">3376992099</span>, <span class="number">2354328041</span>, <span class="number">3982194113</span>, <span class="number">2808629397</span>, <span class="number">2334028703</span>, <span class="number">2486018814</span>, <span class="number">2803772026</span>, <span class="number">3706255975</span>, <span class="number">3735441028</span>, <span class="number">4048829268</span>, <span class="number">2640181605</span>, <span class="number">2791081398</span>, <span class="number">3187283224</span>, <span class="number">1420508759</span>, <span class="number">138780420</span>, <span class="number">2393694635</span>, <span class="number">1184332229</span>, <span class="number">3997757293</span>, <span class="number">4276770176</span>, <span class="number">2496387274</span>, <span class="number">417828868</span>, <span class="number">1602877105</span>, <span class="number">2235729038</span>, <span class="number">3691067483</span>, <span class="number">503993304</span>, <span class="number">3420040537</span>, <span class="number">2686226340</span>, <span class="number">1773044641</span>, <span class="number">799706948</span>, <span class="number">2949769977</span>, <span class="number">91162925</span>, <span class="number">3438458088</span>, <span class="number">3573556447</span>, <span class="number">4006365173</span>, <span class="number">1221921592</span>, <span class="number">429780904</span>, <span class="number">237532788</span>, <span class="number">1787220209</span>, <span class="number">596697054</span>, <span class="number">1460150725</span>, <span class="number">1285764996</span>, <span class="number">901649834</span>, <span class="number">1027376964</span>, <span class="number">4028678919</span>, <span class="number">1248204232</span>, <span class="number">1617832578</span>, <span class="number">1842078181</span>, <span class="number">3398378539</span>, <span class="number">1642769664</span>, <span class="number">1597164446</span>, <span class="number">1666936309</span>, <span class="number">311817855</span>, <span class="number">3884791895</span>, <span class="number">3894947425</span>, <span class="number">3042623464</span>, <span class="number">350745233</span>, <span class="number">776555893</span>, <span class="number">4153552234</span>, <span class="number">1893211311</span>, <span class="number">1566470121</span>, <span class="number">1333612492</span>, <span class="number">381694502</span>, <span class="number">1001660484</span>, <span class="number">2234589211</span>, <span class="number">1128139813</span>, <span class="number">1089867645</span>, <span class="number">197228854</span>, <span class="number">1168947609</span>, <span class="number">530551364</span>, <span class="number">2400655905</span>, <span class="number">1276054557</span>, <span class="number">875480155</span>, <span class="number">1610951735</span>, <span class="number">2754435231</span>, <span class="number">2996501571</span>, <span class="number">3119206392</span>, <span class="number">4017707254</span>, <span class="number">908998398</span>, <span class="number">3298533772</span>, <span class="number">2579842498</span>, <span class="number">627590680</span>, <span class="number">2588836049</span>, <span class="number">1840168857</span>, <span class="number">664924243</span>, <span class="number">3804577051</span>, <span class="number">3509253077</span>, <span class="number">1967766220</span>, <span class="number">1386834240</span>, <span class="number">2465288453</span>, <span class="number">1220720676</span>, <span class="number">2388751611</span>, <span class="number">2463852704</span>, <span class="number">2415721294</span>, <span class="number">543085153</span>, <span class="number">816179883</span>, <span class="number">2327321054</span>, <span class="number">3313299764</span>, <span class="number">2481101596</span>, <span class="number">2201764416</span>, <span class="number">2919855989</span>, <span class="number">854315615</span>, <span class="number">523753448</span>, <span class="number">4209727478</span>, <span class="number">3030307352</span>, <span class="number">4157525938</span>, <span class="number">3415518022</span>, <span class="number">2888990891</span>, <span class="number">3345364256</span>, <span class="number">2511844163</span>, <span class="number">3006169882</span>, <span class="number">1261015534</span>, <span class="number">3087563714</span>, <span class="number">2278724664</span>, <span class="number">3439167067</span>, <span class="number">1498618418</span>, <span class="number">4063470234</span>, <span class="number">781322457</span>, <span class="number">1346936858</span>, <span class="number">1326620453</span>, <span class="number">3011448499</span>, <span class="number">3805578837</span>, <span class="number">773261167</span>, <span class="number">2316916557</span>, <span class="number">3269573294</span>, <span class="number">3333438661</span>, <span class="number">3849843107</span>, <span class="number">3556832678</span>, <span class="number">2069444768</span>, <span class="number">3790111245</span>, <span class="number">79089423</span>, <span class="number">2924984693</span>, <span class="number">18734206</span>, <span class="number">2604232002</span>, <span class="number">4125055949</span>, <span class="number">4091705300</span>, <span class="number">1700550754</span>, <span class="number">2540755871</span>, <span class="number">1649978242</span>, <span class="number">895076161</span>, <span class="number">4141115192</span>, <span class="number">3282587355</span>, <span class="number">2340467917</span>, <span class="number">808656449</span>, <span class="number">2669853244</span>, <span class="number">2651892238</span>, <span class="number">4259808341</span>, <span class="number">4169350536</span>, <span class="number">2592320626</span>, <span class="number">1682635212</span>, <span class="number">31343742</span>, <span class="number">3066721620</span>, <span class="number">4093989517</span>, <span class="number">1227461030</span>, <span class="number">2347358084</span>, <span class="number">3292708736</span>, <span class="number">2808589138</span>, <span class="number">4123289652</span>, <span class="number">532909656</span>, <span class="number">867975774</span>, <span class="number">2707193533</span>, <span class="number">881539587</span>, <span class="number">386826200</span>, <span class="number">2047543778</span>, <span class="number">400188218</span>, <span class="number">1993945486</span>, <span class="number">3458143768</span>, <span class="number">4090834261</span>, <span class="number">3451382429</span>, <span class="number">2825920518</span>, <span class="number">91932485</span>, <span class="number">1828162795</span>, <span class="number">175756293</span>, <span class="number">1017795757</span>, <span class="number">1665072886</span>, <span class="number">185452585</span>, <span class="number">2175593188</span>, <span class="number">657966198</span>, <span class="number">2019404359</span>, <span class="number">3439175000</span>, <span class="number">2265772450</span>, <span class="number">1355412956</span>, <span class="number">3914090222</span>, <span class="number">3381121599</span>, <span class="number">1102843755</span>, <span class="number">3075985554</span>, <span class="number">3358743185</span>, <span class="number">5496668</span>, <span class="number">4012072207</span>, <span class="number">3776127872</span>, <span class="number">1193484148</span>, <span class="number">350488559</span>, <span class="number">1371474450</span>, <span class="number">3343394375</span>, <span class="number">4157439645</span>, <span class="number">3676800032</span>, <span class="number">4249018010</span>, <span class="number">1454421289</span>, <span class="number">2562843285</span>, <span class="number">3974248033</span>, <span class="number">1493690489</span>, <span class="number">1456402728</span>, <span class="number">3805485054</span>, <span class="number">3641302435</span>, <span class="number">2011107827</span>, <span class="number">1094359118</span>, <span class="number">2513002496</span>, <span class="number">1424094368</span>, <span class="number">91663964</span>, <span class="number">1067845668</span>, <span class="number">1608023053</span>, <span class="number">522149526</span>, <span class="number">4011366665</span>, <span class="number">3856710862</span>, <span class="number">2622436286</span>, <span class="number">3356690186</span>, <span class="number">461674860</span>, <span class="number">2472498556</span>, <span class="number">2815371927</span>, <span class="number">412650411</span>, <span class="number">1285201754</span>, <span class="number">3083178955</span>, <span class="number">327737650</span>, <span class="number">904043680</span>, <span class="number">1352232199</span>, <span class="number">1795832646</span>, <span class="number">1202938860</span>, <span class="number">29049707</span>, <span class="number">3789741602</span>, <span class="number">2252885489</span>, <span class="number">1373818316</span>, <span class="number">3409504463</span>, <span class="number">261949035</span>, <span class="number">2186267943</span>, <span class="number">1447542410</span>, <span class="number">1226019273</span>, <span class="number">2855570907</span>, <span class="number">3012827537</span>, <span class="number">3525493748</span>, <span class="number">307724649</span>, <span class="number">3869655396</span>, <span class="number">912846491</span>, <span class="number">2303989792</span>, <span class="number">805681508</span>, <span class="number">1144302191</span>, <span class="number">687742306</span>, <span class="number">1336478631</span>, <span class="number">1048014972</span>, <span class="number">4088774379</span>, <span class="number">2184608648</span>, <span class="number">543267187</span>, <span class="number">3083147105</span>, <span class="number">1643853586</span>, <span class="number">2652563331</span>, <span class="number">2265473258</span>, <span class="number">1216505230</span>, <span class="number">2125765234</span>, <span class="number">1628273767</span>, <span class="number">4037979207</span>, <span class="number">3572915422</span>, <span class="number">2733632060</span>, <span class="number">1018468994</span>, <span class="number">2877196631</span>, <span class="number">4257066391</span>, <span class="number">3435508083</span>, <span class="number">2953048896</span>, <span class="number">227233051</span>, <span class="number">1677058233</span>, <span class="number">3393987243</span>, <span class="number">1630377564</span>, <span class="number">352262598</span>, <span class="number">165290804</span>, <span class="number">2253568411</span>, <span class="number">3810860149</span>, <span class="number">152658599</span>, <span class="number">1398820093</span>, <span class="number">3642047879</span>, <span class="number">1642654512</span>, <span class="number">1629029746</span>, <span class="number">1559147389</span>, <span class="number">2694721035</span>, <span class="number">323615917</span>, <span class="number">421807970</span>, <span class="number">2704383436</span>, <span class="number">1588101737</span>, <span class="number">4145880364</span>, <span class="number">3009653936</span>, <span class="number">4003227232</span>, <span class="number">1731486262</span>, <span class="number">2746953947</span>, <span class="number">2817353926</span>, <span class="number">3675732862</span>, <span class="number">996892540</span>, <span class="number">3554282008</span>, <span class="number">4012601812</span>, <span class="number">1827732225</span>, <span class="number">3462793519</span>, <span class="number">3646827660</span>, <span class="number">3018399132</span>, <span class="number">858013576</span>, <span class="number">2953108187</span>, <span class="number">2465692369</span>, <span class="number">3424871028</span>, <span class="number">1592298025</span>, <span class="number">2328226815</span>, <span class="number">3679158793</span>, <span class="number">3014109739</span>, <span class="number">2387940711</span>, <span class="number">3787948052</span>, <span class="number">199416399</span>, <span class="number">1669163624</span>, <span class="number">2471243435</span>, <span class="number">1957026796</span>, <span class="number">3348929473</span>, <span class="number">2859616203</span>, <span class="number">704636303</span>, <span class="number">515381934</span>, <span class="number">3349915370</span>, <span class="number">2137689394</span>, <span class="number">2868839013</span>, <span class="number">1941312490</span>, <span class="number">3337330943</span>, <span class="number">1258381749</span>, <span class="number">4039172686</span>, <span class="number">3780083628</span>, <span class="number">3246066007</span>, <span class="number">3738477681</span>, <span class="number">1292100936</span>, <span class="number">2302445852</span>, <span class="number">4061473062</span>, <span class="number">2439056106</span>, <span class="number">1987540954</span>, <span class="number">1464041146</span>, <span class="number">3884979483</span>, <span class="number">717892813</span>, <span class="number">3378013239</span>, <span class="number">1793810139</span>, <span class="number">3029669978</span>, <span class="number">3544298769</span>, <span class="number">240194676</span>, <span class="number">2300258335</span>, <span class="number">4109982413</span>, <span class="number">2073760675</span>, <span class="number">2736681800</span>, <span class="number">96213137</span>, <span class="number">3293727893</span>, <span class="number">3750657935</span>, <span class="number">38682782</span>, <span class="number">902172345</span>, <span class="number">2819871329</span>, <span class="number">1881013876</span>, <span class="number">2587165583</span>, <span class="number">3400261128</span>, <span class="number">2783936447</span>, <span class="number">3708062970</span>, <span class="number">2299257255</span>, <span class="number">888427908</span>, <span class="number">2898617216</span>, <span class="number">1554962103</span>, <span class="number">3369868860</span>, <span class="number">1925228618</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(recover(state[-<span class="number">1</span>]))</span><br><span class="line"><span class="comment"># 114514</span></span><br></pre></td></tr></table></figure>

<h1 id="赛题"><a href="#赛题" class="headerlink" title="赛题"></a>赛题</h1><h2 id="2020-网鼎杯白虎组——random"><a href="#2020-网鼎杯白虎组——random" class="headerlink" title="2020 网鼎杯白虎组——random"></a>2020 网鼎杯白虎组——random</h2><p>这题的本质是给出700个<code>random.getrandbits(32)</code>，要求预测第701个<code>getrandbits(32)</code>，那么思路就是用给出的700个值利用逆向<code>extract_number</code>得到<code>state</code>，再往后预测随机数</p>
<p>我们可以自行测试</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right_mask</span>(<span class="params">res, shift, mask=<span class="number">0xffffffff</span>, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left_mask</span>(<span class="params">res, shift, mask=<span class="number">0xffffffff</span>, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">y</span>):</span><br><span class="line">    y = inverse_right_mask(y,<span class="number">18</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    y = inverse_right_mask(y,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">outputs = [<span class="number">3856320579</span>, <span class="number">582346195</span>, <span class="number">3618983146</span>, <span class="number">2042063976</span>, <span class="number">1184168896</span>, <span class="number">396290811</span>, <span class="number">172396203</span>, <span class="number">1865207412</span>, <span class="number">3513099586</span>, <span class="number">2068572360</span>, <span class="number">1068542070</span>, <span class="number">2748673688</span>, <span class="number">3223623448</span>, <span class="number">3405563534</span>, <span class="number">3988198879</span>, <span class="number">2760302757</span>, <span class="number">682475183</span>, <span class="number">664583410</span>, <span class="number">3748223341</span>, <span class="number">430704012</span>, <span class="number">3625001104</span>, <span class="number">3357182041</span>, <span class="number">2074997633</span>, <span class="number">4220987130</span>, <span class="number">3071322516</span>, <span class="number">3699451070</span>, <span class="number">3668390600</span>, <span class="number">2308851921</span>, <span class="number">3722345414</span>, <span class="number">640871845</span>, <span class="number">4040807500</span>, <span class="number">68505531</span>, <span class="number">2722397716</span>, <span class="number">152975230</span>, <span class="number">3396499459</span>, <span class="number">611884180</span>, <span class="number">2780014634</span>, <span class="number">1762213421</span>, <span class="number">3727058429</span>, <span class="number">3279075094</span>, <span class="number">2020811567</span>, <span class="number">1955079559</span>, <span class="number">1982049705</span>, <span class="number">618514519</span>, <span class="number">782628428</span>, <span class="number">2231787577</span>, <span class="number">3958418339</span>, <span class="number">3619191692</span>, <span class="number">3262044252</span>, <span class="number">3239486806</span>, <span class="number">2091920859</span>, <span class="number">1649794832</span>, <span class="number">2049988981</span>, <span class="number">3950537809</span>, <span class="number">3494642440</span>, <span class="number">2373203533</span>, <span class="number">3908938509</span>, <span class="number">4260665545</span>, <span class="number">3992436207</span>, <span class="number">55233433</span>, <span class="number">3678164019</span>, <span class="number">3382125549</span>, <span class="number">1031050744</span>, <span class="number">475668950</span>, <span class="number">2712640527</span>, <span class="number">3262072084</span>, <span class="number">270947538</span>, <span class="number">747369005</span>, <span class="number">2449233680</span>, <span class="number">168550240</span>, <span class="number">3472526026</span>, <span class="number">4236638624</span>, <span class="number">2353167392</span>, <span class="number">338773947</span>, <span class="number">3102391394</span>, <span class="number">4106050694</span>, <span class="number">2101907501</span>, <span class="number">1511485944</span>, <span class="number">2540533755</span>, <span class="number">291407666</span>, <span class="number">1388779576</span>, <span class="number">1581113430</span>, <span class="number">1005505294</span>, <span class="number">3737919939</span>, <span class="number">2574230177</span>, <span class="number">1506489003</span>, <span class="number">791427607</span>, <span class="number">3039232414</span>, <span class="number">4290205147</span>, <span class="number">334372227</span>, <span class="number">4192207263</span>, <span class="number">11583436</span>, <span class="number">1091806965</span>, <span class="number">959404673</span>, <span class="number">1550692802</span>, <span class="number">743550782</span>, <span class="number">3015066354</span>, <span class="number">1843787256</span>, <span class="number">1089162969</span>, <span class="number">3282721857</span>, <span class="number">3947303971</span>, <span class="number">1447391170</span>, <span class="number">3549321293</span>, <span class="number">3883434277</span>, <span class="number">3156541810</span>, <span class="number">457481521</span>, <span class="number">998989161</span>, <span class="number">353007883</span>, <span class="number">2154611512</span>, <span class="number">3500086770</span>, <span class="number">291601413</span>, <span class="number">809079524</span>, <span class="number">4096216221</span>, <span class="number">1972316626</span>, <span class="number">3392166890</span>, <span class="number">826467439</span>, <span class="number">2251471337</span>, <span class="number">3810124886</span>, <span class="number">1174971249</span>, <span class="number">3448439560</span>, <span class="number">622493039</span>, <span class="number">2661871054</span>, <span class="number">514732941</span>, <span class="number">1285876333</span>, <span class="number">1325623476</span>, <span class="number">942537583</span>, <span class="number">474391642</span>, <span class="number">3222347875</span>, <span class="number">3598063610</span>, <span class="number">1390260164</span>, <span class="number">1368857781</span>, <span class="number">1586104057</span>, <span class="number">4169375007</span>, <span class="number">560089657</span>, <span class="number">3871863081</span>, <span class="number">3664033451</span>, <span class="number">360130987</span>, <span class="number">1338114992</span>, <span class="number">1386653770</span>, <span class="number">141908613</span>, <span class="number">1087817361</span>, <span class="number">2578440356</span>, <span class="number">4238690391</span>, <span class="number">2491333789</span>, <span class="number">1313554240</span>, <span class="number">2659158617</span>, <span class="number">2026626952</span>, <span class="number">3758863748</span>, <span class="number">31333958</span>, <span class="number">1515192303</span>, <span class="number">1980512149</span>, <span class="number">1523102569</span>, <span class="number">1015648738</span>, <span class="number">402013118</span>, <span class="number">668083749</span>, <span class="number">1613274796</span>, <span class="number">3266155997</span>, <span class="number">1388893607</span>, <span class="number">2234359768</span>, <span class="number">3039773093</span>, <span class="number">1754072774</span>, <span class="number">1255047196</span>, <span class="number">3008000059</span>, <span class="number">2814267560</span>, <span class="number">4087098288</span>, <span class="number">3612111948</span>, <span class="number">2783546052</span>, <span class="number">2422793522</span>, <span class="number">2054512708</span>, <span class="number">2157246187</span>, <span class="number">3896113834</span>, <span class="number">3091314347</span>, <span class="number">4066054956</span>, <span class="number">697611949</span>, <span class="number">4293436184</span>, <span class="number">4178028304</span>, <span class="number">1232448137</span>, <span class="number">462706657</span>, <span class="number">2546090314</span>, <span class="number">2580413378</span>, <span class="number">2991884731</span>, <span class="number">3477559744</span>, <span class="number">819828518</span>, <span class="number">2378581444</span>, <span class="number">261974330</span>, <span class="number">48554242</span>, <span class="number">1125904908</span>, <span class="number">743303927</span>, <span class="number">283943396</span>, <span class="number">2239687403</span>, <span class="number">3397561838</span>, <span class="number">1936983918</span>, <span class="number">813124442</span>, <span class="number">1372261461</span>, <span class="number">2675158527</span>, <span class="number">2811298655</span>, <span class="number">3600392264</span>, <span class="number">3081073716</span>, <span class="number">3285423961</span>, <span class="number">2470299114</span>, <span class="number">35562143</span>, <span class="number">2374487620</span>, <span class="number">523196833</span>, <span class="number">837053452</span>, <span class="number">442383295</span>, <span class="number">1642526474</span>, <span class="number">633356203</span>, <span class="number">934212664</span>, <span class="number">2541169652</span>, <span class="number">2218324371</span>, <span class="number">2293743808</span>, <span class="number">533650099</span>, <span class="number">3922760511</span>, <span class="number">2796518408</span>, <span class="number">1233841965</span>, <span class="number">1331867338</span>, <span class="number">911224321</span>, <span class="number">1878236230</span>, <span class="number">3997425837</span>, <span class="number">263502568</span>, <span class="number">2427147217</span>, <span class="number">377222419</span>, <span class="number">980472509</span>, <span class="number">3718192901</span>, <span class="number">4207766</span>, <span class="number">1900019200</span>, <span class="number">2494403882</span>, <span class="number">2608467619</span>, <span class="number">2531637576</span>, <span class="number">3316511918</span>, <span class="number">3064471002</span>, <span class="number">2357840013</span>, <span class="number">1494395355</span>, <span class="number">2760712913</span>, <span class="number">1301257467</span>, <span class="number">3639957765</span>, <span class="number">266103064</span>, <span class="number">4195520357</span>, <span class="number">606353778</span>, <span class="number">625335058</span>, <span class="number">245993933</span>, <span class="number">210040927</span>, <span class="number">1719447395</span>, <span class="number">4182661980</span>, <span class="number">2096278341</span>, <span class="number">2308071160</span>, <span class="number">3916671207</span>, <span class="number">3875154215</span>, <span class="number">3042399609</span>, <span class="number">1892589882</span>, <span class="number">2055655644</span>, <span class="number">4162222987</span>, <span class="number">2619931041</span>, <span class="number">2862794713</span>, <span class="number">2660510520</span>, <span class="number">3979077509</span>, <span class="number">830949746</span>, <span class="number">1046088983</span>, <span class="number">752539852</span>, <span class="number">2079596180</span>, <span class="number">707323337</span>, <span class="number">4181110498</span>, <span class="number">3320112802</span>, <span class="number">2675358193</span>, <span class="number">2013709407</span>, <span class="number">797600224</span>, <span class="number">3977215055</span>, <span class="number">1660380026</span>, <span class="number">2330229635</span>, <span class="number">3780677230</span>, <span class="number">1765339288</span>, <span class="number">50797844</span>, <span class="number">1326458332</span>, <span class="number">2704700279</span>, <span class="number">3388388140</span>, <span class="number">2949009302</span>, <span class="number">2652386153</span>, <span class="number">4070023754</span>, <span class="number">663847171</span>, <span class="number">2530173162</span>, <span class="number">1787912129</span>, <span class="number">2133212070</span>, <span class="number">585187560</span>, <span class="number">3412976489</span>, <span class="number">1109974365</span>, <span class="number">1388102174</span>, <span class="number">3763930833</span>, <span class="number">603205256</span>, <span class="number">790728101</span>, <span class="number">285097555</span>, <span class="number">1986002544</span>, <span class="number">4136614930</span>, <span class="number">2730768819</span>, <span class="number">1422358203</span>, <span class="number">4207378229</span>, <span class="number">1305416929</span>, <span class="number">3253570173</span>, <span class="number">614096292</span>, <span class="number">4006108012</span>, <span class="number">3997549750</span>, <span class="number">2963994445</span>, <span class="number">390402033</span>, <span class="number">148705559</span>, <span class="number">2400665295</span>, <span class="number">1629175351</span>, <span class="number">3175584699</span>, <span class="number">531068763</span>, <span class="number">3547563920</span>, <span class="number">951205529</span>, <span class="number">3951721422</span>, <span class="number">2045335509</span>, <span class="number">2061079714</span>, <span class="number">1020389523</span>, <span class="number">1398264757</span>, <span class="number">388342296</span>, <span class="number">1113940071</span>, <span class="number">2884073722</span>, <span class="number">3909877149</span>, <span class="number">1554456027</span>, <span class="number">4166045208</span>, <span class="number">3292049984</span>, <span class="number">2047607647</span>, <span class="number">2406249956</span>, <span class="number">1165134100</span>, <span class="number">1492019858</span>, <span class="number">438786476</span>, <span class="number">2455620417</span>, <span class="number">1045115687</span>, <span class="number">2298575790</span>, <span class="number">2641273358</span>, <span class="number">3428151066</span>, <span class="number">1771684405</span>, <span class="number">1469667266</span>, <span class="number">245779746</span>, <span class="number">3780673506</span>, <span class="number">159637867</span>, <span class="number">1974818756</span>, <span class="number">1417299436</span>, <span class="number">1757616882</span>, <span class="number">2931609965</span>, <span class="number">272261657</span>, <span class="number">2992310526</span>, <span class="number">1640699729</span>, <span class="number">1550869638</span>, <span class="number">2831720525</span>, <span class="number">3188206484</span>, <span class="number">2147244773</span>, <span class="number">2702236061</span>, <span class="number">2845925972</span>, <span class="number">2472472340</span>, <span class="number">1950271077</span>, <span class="number">1073077867</span>, <span class="number">2669473456</span>, <span class="number">1017796207</span>, <span class="number">3398740200</span>, <span class="number">149898285</span>, <span class="number">969790886</span>, <span class="number">3976683028</span>, <span class="number">4100426487</span>, <span class="number">236528673</span>, <span class="number">2275913926</span>, <span class="number">70804541</span>, <span class="number">1015988608</span>, <span class="number">2288793751</span>, <span class="number">1516397338</span>, <span class="number">36466183</span>, <span class="number">1810140379</span>, <span class="number">35027792</span>, <span class="number">3515304008</span>, <span class="number">3369816002</span>, <span class="number">4218943237</span>, <span class="number">1292859807</span>, <span class="number">2868585129</span>, <span class="number">1344314860</span>, <span class="number">2966363405</span>, <span class="number">1270384480</span>, <span class="number">3430972215</span>, <span class="number">2905554740</span>, <span class="number">2834517081</span>, <span class="number">2277787053</span>, <span class="number">3369281826</span>, <span class="number">2330136701</span>, <span class="number">2811934643</span>, <span class="number">437795454</span>, <span class="number">790307084</span>, <span class="number">3938433156</span>, <span class="number">2696231004</span>, <span class="number">2864065004</span>, <span class="number">2071195617</span>, <span class="number">3450944719</span>, <span class="number">2593258395</span>, <span class="number">4156266153</span>, <span class="number">2933408715</span>, <span class="number">314356055</span>, <span class="number">3838824165</span>, <span class="number">2208826112</span>, <span class="number">673615301</span>, <span class="number">451826871</span>, <span class="number">2653901210</span>, <span class="number">1091115010</span>, <span class="number">3494549155</span>, <span class="number">2126719717</span>, <span class="number">492550938</span>, <span class="number">2486431133</span>, <span class="number">673318550</span>, <span class="number">1873965526</span>, <span class="number">2615574806</span>, <span class="number">3022521670</span>, <span class="number">3153122841</span>, <span class="number">316109818</span>, <span class="number">1358644343</span>, <span class="number">371632675</span>, <span class="number">3079378052</span>, <span class="number">3394493516</span>, <span class="number">1042427109</span>, <span class="number">4083513993</span>, <span class="number">2879031841</span>, <span class="number">1188720143</span>, <span class="number">3764965656</span>, <span class="number">2934659446</span>, <span class="number">3645520948</span>, <span class="number">3761388578</span>, <span class="number">1399281780</span>, <span class="number">1467393315</span>, <span class="number">2748507851</span>, <span class="number">3916290285</span>, <span class="number">162638517</span>, <span class="number">3503680397</span>, <span class="number">1202087557</span>, <span class="number">1797301343</span>, <span class="number">4038743012</span>, <span class="number">498411215</span>, <span class="number">1906945487</span>, <span class="number">1269012684</span>, <span class="number">616165911</span>, <span class="number">2689362140</span>, <span class="number">2954293400</span>, <span class="number">2749974859</span>, <span class="number">372077473</span>, <span class="number">526599366</span>, <span class="number">2719433559</span>, <span class="number">445270887</span>, <span class="number">1787930323</span>, <span class="number">414594410</span>, <span class="number">1531788692</span>, <span class="number">655371094</span>, <span class="number">1134528247</span>, <span class="number">922864801</span>, <span class="number">577427318</span>, <span class="number">2476882905</span>, <span class="number">3762554878</span>, <span class="number">1263109260</span>, <span class="number">889201305</span>, <span class="number">3756246995</span>, <span class="number">3505662458</span>, <span class="number">1792412776</span>, <span class="number">3096524063</span>, <span class="number">4010213023</span>, <span class="number">1822791406</span>, <span class="number">498896760</span>, <span class="number">2895851116</span>, <span class="number">194376912</span>, <span class="number">3834164906</span>, <span class="number">921981686</span>, <span class="number">195822201</span>, <span class="number">486251241</span>, <span class="number">3027841388</span>, <span class="number">177205766</span>, <span class="number">2237855353</span>, <span class="number">2426431616</span>, <span class="number">1243779662</span>, <span class="number">3596629671</span>, <span class="number">3198684268</span>, <span class="number">383794333</span>, <span class="number">4088735022</span>, <span class="number">84096876</span>, <span class="number">2597108436</span>, <span class="number">943661592</span>, <span class="number">3010249765</span>, <span class="number">651609816</span>, <span class="number">2028864217</span>, <span class="number">88066893</span>, <span class="number">416774877</span>, <span class="number">3406354028</span>, <span class="number">1131222595</span>, <span class="number">3257056160</span>, <span class="number">2047423822</span>, <span class="number">466652966</span>, <span class="number">540014760</span>, <span class="number">3575349728</span>, <span class="number">97598377</span>, <span class="number">3860944863</span>, <span class="number">3358078401</span>, <span class="number">2576759735</span>, <span class="number">3026694340</span>, <span class="number">1542421979</span>, <span class="number">1208350673</span>, <span class="number">730717774</span>, <span class="number">1548179769</span>, <span class="number">3866316925</span>, <span class="number">1524301730</span>, <span class="number">177925641</span>, <span class="number">4040163095</span>, <span class="number">3647937899</span>, <span class="number">1566223024</span>, <span class="number">851510626</span>, <span class="number">3763176296</span>, <span class="number">3748357246</span>, <span class="number">3163985940</span>, <span class="number">1188874855</span>, <span class="number">3744613224</span>, <span class="number">2298060224</span>, <span class="number">3290018347</span>, <span class="number">3524287701</span>, <span class="number">546532864</span>, <span class="number">2202356429</span>, <span class="number">4090704033</span>, <span class="number">153373528</span>, <span class="number">3624854156</span>, <span class="number">3619995514</span>, <span class="number">971161525</span>, <span class="number">1651704710</span>, <span class="number">3184983159</span>, <span class="number">3904044857</span>, <span class="number">2631074289</span>, <span class="number">2994477708</span>, <span class="number">466922481</span>, <span class="number">1185754575</span>, <span class="number">2236625463</span>, <span class="number">2574503930</span>, <span class="number">2271362108</span>, <span class="number">2352028513</span>, <span class="number">2348762614</span>, <span class="number">185909629</span>, <span class="number">2681195010</span>, <span class="number">1957314281</span>, <span class="number">1664135627</span>, <span class="number">1653223437</span>, <span class="number">1007998044</span>, <span class="number">2059226119</span>, <span class="number">107468870</span>, <span class="number">349013320</span>, <span class="number">3069230899</span>, <span class="number">573256156</span>, <span class="number">3065294197</span>, <span class="number">2888682091</span>, <span class="number">4188263099</span>, <span class="number">3052015975</span>, <span class="number">3252740424</span>, <span class="number">3819272656</span>, <span class="number">4036891979</span>, <span class="number">251329729</span>, <span class="number">3274617160</span>, <span class="number">2479410099</span>, <span class="number">2524686476</span>, <span class="number">1381270898</span>, <span class="number">3911980232</span>, <span class="number">3575282849</span>, <span class="number">3279515129</span>, <span class="number">4266855886</span>, <span class="number">1665575754</span>, <span class="number">1479237476</span>, <span class="number">2990196390</span>, <span class="number">3190994678</span>, <span class="number">3006848624</span>, <span class="number">2519770216</span>, <span class="number">3136161554</span>, <span class="number">511739068</span>, <span class="number">1786433701</span>, <span class="number">1713816087</span>, <span class="number">1641600232</span>, <span class="number">2961791165</span>, <span class="number">4243634468</span>, <span class="number">3458215124</span>, <span class="number">2879399149</span>, <span class="number">2899139587</span>, <span class="number">3344687724</span>, <span class="number">1344768212</span>, <span class="number">1987847167</span>, <span class="number">1317563177</span>, <span class="number">2998618925</span>, <span class="number">600607120</span>, <span class="number">580705122</span>, <span class="number">2796148254</span>, <span class="number">3695708628</span>, <span class="number">203562398</span>, <span class="number">3020286723</span>, <span class="number">4105783504</span>, <span class="number">4212275211</span>, <span class="number">497705671</span>, <span class="number">2158484700</span>, <span class="number">986009433</span>, <span class="number">4041195051</span>, <span class="number">3569002127</span>, <span class="number">862242677</span>, <span class="number">1369976294</span>, <span class="number">4138172444</span>, <span class="number">315810932</span>, <span class="number">3741340107</span>, <span class="number">1042036777</span>, <span class="number">3727198761</span>, <span class="number">347247004</span>, <span class="number">3928525886</span>, <span class="number">3727331951</span>, <span class="number">4157809556</span>, <span class="number">1897317622</span>, <span class="number">3338188695</span>, <span class="number">3742860698</span>, <span class="number">268219460</span>, <span class="number">459374679</span>, <span class="number">1641077364</span>, <span class="number">891407958</span>, <span class="number">2714939388</span>, <span class="number">3564273440</span>, <span class="number">3690128793</span>, <span class="number">1750444640</span>, <span class="number">3290494688</span>, <span class="number">3759527045</span>, <span class="number">3705846216</span>, <span class="number">663551340</span>, <span class="number">3669286435</span>, <span class="number">63793922</span>, <span class="number">2552809954</span>, <span class="number">912695183</span>, <span class="number">6040685</span>, <span class="number">3485374653</span>, <span class="number">3703861882</span>, <span class="number">2703476363</span>, <span class="number">2988768795</span>, <span class="number">2308363444</span>, <span class="number">1140391792</span>, <span class="number">1961672168</span>, <span class="number">594823203</span>, <span class="number">1106597270</span>, <span class="number">1875618248</span>, <span class="number">2319530228</span>, <span class="number">1049439924</span>, <span class="number">2061432103</span>, <span class="number">1692840785</span>, <span class="number">1079740283</span>, <span class="number">2352424790</span>, <span class="number">3403787086</span>, <span class="number">47324887</span>, <span class="number">1832435850</span>, <span class="number">1613238108</span>, <span class="number">1448314858</span>, <span class="number">1459605180</span>, <span class="number">2364440437</span>, <span class="number">3247443276</span>, <span class="number">1262170458</span>, <span class="number">492220272</span>, <span class="number">3683373765</span>, <span class="number">3679148921</span>, <span class="number">866864270</span>, <span class="number">2477814155</span>, <span class="number">2065864431</span>, <span class="number">4188808041</span>, <span class="number">1198808728</span>, <span class="number">2933465169</span>, <span class="number">261694304</span>, <span class="number">2229917088</span>, <span class="number">3493329678</span>, <span class="number">673544611</span>, <span class="number">224852180</span>, <span class="number">4229537516</span>, <span class="number">3676005877</span>, <span class="number">2594310223</span>, <span class="number">3955303385</span>, <span class="number">2694125916</span>, <span class="number">639404191</span>, <span class="number">2427452820</span>, <span class="number">2829149388</span>, <span class="number">2566455212</span>, <span class="number">2946677059</span>, <span class="number">228963779</span>, <span class="number">1917238465</span>, <span class="number">2381366147</span>, <span class="number">1916689453</span>, <span class="number">39849223</span>, <span class="number">2324519978</span>, <span class="number">3422879216</span>, <span class="number">2715013754</span>, <span class="number">4278642992</span>, <span class="number">700303459</span>, <span class="number">3354052905</span>, <span class="number">4061459792</span>, <span class="number">1428274751</span>, <span class="number">2146294147</span>, <span class="number">3905217098</span>, <span class="number">1617406780</span>, <span class="number">408601626</span>, <span class="number">3776149665</span>, <span class="number">4131141161</span>, <span class="number">581113184</span>, <span class="number">3051175634</span>, <span class="number">3839200652</span>, <span class="number">516810624</span>, <span class="number">1935938682</span>, <span class="number">3289303720</span>, <span class="number">1155849673</span>]</span><br><span class="line">x = <span class="number">4126744556</span></span><br><span class="line">state = [recover(outputs[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line">RNG = random.Random()</span><br><span class="line">RNG.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>))	<span class="comment"># 这里的0表示的是索引</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">700</span>):</span><br><span class="line">    RNG.getrandbits(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">recover_x = RNG.getrandbits(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(recover_x == x)</span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<h2 id="2020-VN-招新赛——Backtrace"><a href="#2020-VN-招新赛——Backtrace" class="headerlink" title="2020 VN 招新赛——Backtrace"></a>2020 VN 招新赛——Backtrace</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(random.getrandbits(<span class="number">32</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        f.write(<span class="built_in">str</span>(random.getrandbits(<span class="number">32</span>)) + <span class="string">&quot;n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>给出后面4~1003这1000个随机数要求恢复第0，1，2，3个随机数。</p>
<p>我们知道生成新的<code>state[i]</code>只与原来的<code>state[i],state[i+1],state[i+397]</code>有关</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">624 625 626 627</span><br><span class="line"> 0   1   2   3</span><br><span class="line"> 1   2   3	 4</span><br><span class="line">397 398 399 400</span><br></pre></td></tr></table></figure>

<p>如上，假如我们要恢复<code>state[3]</code>，就需要知道<code>state[4],state[400],state[627]</code>，这些值我们都有。所以可以恢复<code>state[3]</code>，再恢复<code>state[2],state[1],state[0]</code></p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_right_mask</span>(<span class="params">res, shift, mask=<span class="number">0xffffffff</span>, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &gt;&gt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inverse_left_mask</span>(<span class="params">res, shift, mask=<span class="number">0xffffffff</span>, bits=<span class="number">32</span></span>):</span><br><span class="line">    tmp = res</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(bits // shift):</span><br><span class="line">        tmp = res ^ tmp &lt;&lt; shift &amp; mask</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">y</span>):</span><br><span class="line">    y = inverse_right_mask(y,<span class="number">18</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">15</span>,<span class="number">4022730752</span>)</span><br><span class="line">    y = inverse_left_mask(y,<span class="number">7</span>,<span class="number">2636928640</span>)</span><br><span class="line">    y = inverse_right_mask(y,<span class="number">11</span>)</span><br><span class="line">    <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backtrace</span>(<span class="params">cur</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    state = cur</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        tmp = state[i+<span class="number">624</span>]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        <span class="comment"># recover highest bit</span></span><br><span class="line">        res = tmp&amp;high</span><br><span class="line">        <span class="comment"># recover other 31 bits,when i =0,it just use the method again it so beautiful!!!!</span></span><br><span class="line">        tmp = state[i-<span class="number">1</span>+<span class="number">624</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br><span class="line">        <span class="comment"># recover Y,tmp = Y</span></span><br><span class="line">        <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">            tmp ^= mask</span><br><span class="line">            tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">            tmp |= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tmp &lt;&lt;=<span class="number">1</span></span><br><span class="line">        res |= (tmp)&amp;low</span><br><span class="line">        state[i] = res    </span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line">outputs = [<span class="number">1804671209</span>, <span class="number">2922063510</span>, <span class="number">982379708</span>, <span class="number">2464792029</span>, <span class="number">2279859639</span>, <span class="number">4192963638</span>, <span class="number">452357623</span>, <span class="number">4132693504</span>, <span class="number">1670542619</span>, <span class="number">2862253188</span>, <span class="number">438444339</span>, <span class="number">2079581686</span>, <span class="number">1366572261</span>, <span class="number">3590214900</span>, <span class="number">2319202187</span>, <span class="number">931063565</span>, <span class="number">2346715284</span>, <span class="number">1213698793</span>, <span class="number">131046035</span>, <span class="number">2055116434</span>, <span class="number">2020298725</span>, <span class="number">1367424316</span>, <span class="number">2241749902</span>, <span class="number">297076859</span>, <span class="number">2365196575</span>, <span class="number">3277854092</span>, <span class="number">1879357622</span>, <span class="number">1797510832</span>, <span class="number">3530412999</span>, <span class="number">1563276058</span>, <span class="number">297778141</span>, <span class="number">633291943</span>, <span class="number">2012139813</span>, <span class="number">1713908450</span>, <span class="number">179565811</span>, <span class="number">3768228415</span>, <span class="number">3621459563</span>, <span class="number">641786681</span>, <span class="number">4311896</span>, <span class="number">3789346845</span>, <span class="number">2627264570</span>, <span class="number">3107085356</span>, <span class="number">1466667492</span>, <span class="number">1297394685</span>, <span class="number">51245732</span>, <span class="number">4269055538</span>, <span class="number">1681463096</span>, <span class="number">2449172061</span>, <span class="number">3986761220</span>, <span class="number">4239108714</span>, <span class="number">1786470635</span>, <span class="number">1195565318</span>, <span class="number">1494228645</span>, <span class="number">2331017985</span>, <span class="number">4280559218</span>, <span class="number">3370269929</span>, <span class="number">3637069883</span>, <span class="number">2669762830</span>, <span class="number">2530922211</span>, <span class="number">3766805033</span>, <span class="number">1947934816</span>, <span class="number">784834577</span>, <span class="number">506178037</span>, <span class="number">2277430206</span>, <span class="number">2102460806</span>, <span class="number">3791496810</span>, <span class="number">1481793757</span>, <span class="number">649412979</span>, <span class="number">1886729484</span>, <span class="number">1196818092</span>, <span class="number">112603133</span>, <span class="number">2149292951</span>, <span class="number">14248690</span>, <span class="number">2418042093</span>, <span class="number">18681599</span>, <span class="number">3666467881</span>, <span class="number">4097621725</span>, <span class="number">2300591192</span>, <span class="number">970351245</span>, <span class="number">2351169329</span>, <span class="number">74344968</span>, <span class="number">424638826</span>, <span class="number">256514923</span>, <span class="number">3110590321</span>, <span class="number">261313939</span>, <span class="number">765554639</span>, <span class="number">2603908959</span>, <span class="number">1722030051</span>, <span class="number">4100196523</span>, <span class="number">15614906</span>, <span class="number">1128199392</span>, <span class="number">3858664581</span>, <span class="number">3957413342</span>, <span class="number">1690096984</span>, <span class="number">3804922505</span>, <span class="number">3035847650</span>, <span class="number">967122609</span>, <span class="number">339595431</span>, <span class="number">3666291525</span>, <span class="number">3348490553</span>, <span class="number">2797300559</span>, <span class="number">793352202</span>, <span class="number">1322582353</span>, <span class="number">1618309162</span>, <span class="number">3192842490</span>, <span class="number">1166436135</span>, <span class="number">250408731</span>, <span class="number">2257445542</span>, <span class="number">20450594</span>, <span class="number">1801793086</span>, <span class="number">183031318</span>, <span class="number">2617979445</span>, <span class="number">578014449</span>, <span class="number">1341923011</span>, <span class="number">3730690997</span>, <span class="number">482392182</span>, <span class="number">2207491223</span>, <span class="number">3683140597</span>, <span class="number">4278507384</span>, <span class="number">4004660414</span>, <span class="number">3050973569</span>, <span class="number">2749567532</span>, <span class="number">1753608470</span>, <span class="number">3191366926</span>, <span class="number">3275447454</span>, <span class="number">431251176</span>, <span class="number">3513077796</span>, <span class="number">3021445304</span>, <span class="number">2150780435</span>, <span class="number">1011516397</span>, <span class="number">4126768105</span>, <span class="number">3956170349</span>, <span class="number">3053379608</span>, <span class="number">4017545930</span>, <span class="number">1849695707</span>, <span class="number">106947830</span>, <span class="number">4041980616</span>, <span class="number">29134296</span>, <span class="number">2844330679</span>, <span class="number">3358520004</span>, <span class="number">2120680048</span>, <span class="number">857645488</span>, <span class="number">3571836532</span>, <span class="number">3610004372</span>, <span class="number">1641667223</span>, <span class="number">1406368469</span>, <span class="number">1160310536</span>, <span class="number">2256091502</span>, <span class="number">1200902294</span>, <span class="number">4054039541</span>, <span class="number">3639946217</span>, <span class="number">3786291139</span>, <span class="number">1352751210</span>, <span class="number">2977986351</span>, <span class="number">1910599729</span>, <span class="number">209471044</span>, <span class="number">2232574666</span>, <span class="number">3616274023</span>, <span class="number">3376363234</span>, <span class="number">1903952569</span>, <span class="number">3552966887</span>, <span class="number">3593859495</span>, <span class="number">2717534809</span>, <span class="number">42959387</span>, <span class="number">187698299</span>, <span class="number">3883809630</span>, <span class="number">856731268</span>, <span class="number">3910747061</span>, <span class="number">907775227</span>, <span class="number">2928927204</span>, <span class="number">4081693478</span>, <span class="number">3955495837</span>, <span class="number">2142003593</span>, <span class="number">3746756893</span>, <span class="number">249265437</span>, <span class="number">2495197443</span>, <span class="number">941182492</span>, <span class="number">3703605091</span>, <span class="number">2681355671</span>, <span class="number">723911707</span>, <span class="number">3470840379</span>, <span class="number">1434547184</span>, <span class="number">529161886</span>, <span class="number">2636831176</span>, <span class="number">2822486818</span>, <span class="number">3471189015</span>, <span class="number">1513478010</span>, <span class="number">3356287845</span>, <span class="number">1869706704</span>, <span class="number">679091668</span>, <span class="number">2383482353</span>, <span class="number">2143693501</span>, <span class="number">199815085</span>, <span class="number">4236474935</span>, <span class="number">144033792</span>, <span class="number">833985848</span>, <span class="number">4290347454</span>, <span class="number">3517268693</span>, <span class="number">4230402381</span>, <span class="number">2985005670</span>, <span class="number">2550569910</span>, <span class="number">444595279</span>, <span class="number">4207941159</span>, <span class="number">3449400944</span>, <span class="number">3393809088</span>, <span class="number">2840774178</span>, <span class="number">2782199449</span>, <span class="number">3924359065</span>, <span class="number">558423647</span>, <span class="number">925255465</span>, <span class="number">4101077039</span>, <span class="number">4075577051</span>, <span class="number">2425366506</span>, <span class="number">2785054252</span>, <span class="number">178902415</span>, <span class="number">2392449510</span>, <span class="number">3621528509</span>, <span class="number">3238774753</span>, <span class="number">964426270</span>, <span class="number">2865540864</span>, <span class="number">234875917</span>, <span class="number">1580908594</span>, <span class="number">2105493500</span>, <span class="number">1684686652</span>, <span class="number">2327670241</span>, <span class="number">310526764</span>, <span class="number">2009697107</span>, <span class="number">3955577194</span>, <span class="number">1654978722</span>, <span class="number">382085028</span>, <span class="number">1280304430</span>, <span class="number">4217869423</span>, <span class="number">2239567035</span>, <span class="number">698475741</span>, <span class="number">2758310735</span>, <span class="number">4207600994</span>, <span class="number">1547108566</span>, <span class="number">397184543</span>, <span class="number">4136031884</span>, <span class="number">2537911943</span>, <span class="number">302343125</span>, <span class="number">841434537</span>, <span class="number">12311784</span>, <span class="number">3061367072</span>, <span class="number">1336001590</span>, <span class="number">1364007977</span>, <span class="number">3600115935</span>, <span class="number">3479786959</span>, <span class="number">3463921743</span>, <span class="number">2923213199</span>, <span class="number">1852358558</span>, <span class="number">4107068894</span>, <span class="number">3320404724</span>, <span class="number">1941634133</span>, <span class="number">3964964656</span>, <span class="number">615840392</span>, <span class="number">3853790685</span>, <span class="number">2259407865</span>, <span class="number">1341169078</span>, <span class="number">98341588</span>, <span class="number">2575314704</span>, <span class="number">435137897</span>, <span class="number">3558750888</span>, <span class="number">210904882</span>, <span class="number">3279251760</span>, <span class="number">1977481875</span>, <span class="number">3750538206</span>, <span class="number">2951076292</span>, <span class="number">3259540110</span>, <span class="number">1037829634</span>, <span class="number">1019064060</span>, <span class="number">1624487857</span>, <span class="number">3557157064</span>, <span class="number">453278517</span>, <span class="number">1997203275</span>, <span class="number">3526376259</span>, <span class="number">1648439207</span>, <span class="number">3508442145</span>, <span class="number">519537525</span>, <span class="number">1608487942</span>, <span class="number">1861353689</span>, <span class="number">2159984795</span>, <span class="number">523981662</span>, <span class="number">385641968</span>, <span class="number">1092941911</span>, <span class="number">3455149514</span>, <span class="number">3519379501</span>, <span class="number">1531854086</span>, <span class="number">2523777950</span>, <span class="number">2097885523</span>, <span class="number">4186683569</span>, <span class="number">3998881974</span>, <span class="number">1070109105</span>, <span class="number">843613269</span>, <span class="number">2477944313</span>, <span class="number">1353211789</span>, <span class="number">3584381026</span>, <span class="number">970904128</span>, <span class="number">2511689463</span>, <span class="number">2039884234</span>, <span class="number">3361343641</span>, <span class="number">1546075085</span>, <span class="number">2684250257</span>, <span class="number">2063901071</span>, <span class="number">687437087</span>, <span class="number">4286773169</span>, <span class="number">440356712</span>, <span class="number">725842843</span>, <span class="number">3865626108</span>, <span class="number">2472843267</span>, <span class="number">1452486843</span>, <span class="number">3427178195</span>, <span class="number">3892564172</span>, <span class="number">2433729005</span>, <span class="number">1957819593</span>, <span class="number">3340106040</span>, <span class="number">1860833850</span>, <span class="number">3593441485</span>, <span class="number">3116897241</span>, <span class="number">3827153355</span>, <span class="number">4273093885</span>, <span class="number">3520772876</span>, <span class="number">1981630614</span>, <span class="number">3896362499</span>, <span class="number">2173708978</span>, <span class="number">4161270666</span>, <span class="number">3414069041</span>, <span class="number">2299636418</span>, <span class="number">3467917329</span>, <span class="number">4196143926</span>, <span class="number">1724129788</span>, <span class="number">4084657553</span>, <span class="number">126994973</span>, <span class="number">3335896948</span>, <span class="number">25789124</span>, <span class="number">2666223946</span>, <span class="number">1948458478</span>, <span class="number">2352250823</span>, <span class="number">3983356639</span>, <span class="number">3584817808</span>, <span class="number">1978974039</span>, <span class="number">1999870993</span>, <span class="number">3076066566</span>, <span class="number">677925554</span>, <span class="number">935423362</span>, <span class="number">3673655441</span>, <span class="number">3186635480</span>, <span class="number">3818566611</span>, <span class="number">4183049188</span>, <span class="number">2746805953</span>, <span class="number">2095957033</span>, <span class="number">2682147580</span>, <span class="number">869189034</span>, <span class="number">2779097594</span>, <span class="number">3608428095</span>, <span class="number">3513611157</span>, <span class="number">755774505</span>, <span class="number">3808579345</span>, <span class="number">3693318911</span>, <span class="number">1839166699</span>, <span class="number">490814908</span>, <span class="number">3143472566</span>, <span class="number">3812486276</span>, <span class="number">2273855376</span>, <span class="number">3822549578</span>, <span class="number">2998813123</span>, <span class="number">486999089</span>, <span class="number">2485672763</span>, <span class="number">576709591</span>, <span class="number">2428238981</span>, <span class="number">2165688575</span>, <span class="number">62919364</span>, <span class="number">1372202352</span>, <span class="number">2188973499</span>, <span class="number">3160921780</span>, <span class="number">250246630</span>, <span class="number">1092998590</span>, <span class="number">1448896904</span>, <span class="number">2553019271</span>, <span class="number">819544935</span>, <span class="number">836137214</span>, <span class="number">3141978292</span>, <span class="number">642366793</span>, <span class="number">547934351</span>, <span class="number">1425622018</span>, <span class="number">132772933</span>, <span class="number">325392879</span>, <span class="number">1505743917</span>, <span class="number">3513406682</span>, <span class="number">3147243677</span>, <span class="number">2436174815</span>, <span class="number">2211221215</span>, <span class="number">2589011325</span>, <span class="number">3155697488</span>, <span class="number">3230919533</span>, <span class="number">3872590594</span>, <span class="number">519917897</span>, <span class="number">1897289742</span>, <span class="number">1742132001</span>, <span class="number">358501373</span>, <span class="number">2013561845</span>, <span class="number">1552541463</span>, <span class="number">3040550447</span>, <span class="number">2168305800</span>, <span class="number">3556728906</span>, <span class="number">2281430717</span>, <span class="number">2967589499</span>, <span class="number">3224106771</span>, <span class="number">3545160301</span>, <span class="number">4292207714</span>, <span class="number">39759152</span>, <span class="number">2551106886</span>, <span class="number">2035978838</span>, <span class="number">458767025</span>, <span class="number">4120756128</span>, <span class="number">4238783027</span>, <span class="number">30128300</span>, <span class="number">2324881505</span>, <span class="number">3206294273</span>, <span class="number">4243159219</span>, <span class="number">1539976766</span>, <span class="number">2594977046</span>, <span class="number">106193658</span>, <span class="number">3006838718</span>, <span class="number">711591954</span>, <span class="number">1631205080</span>, <span class="number">2055422509</span>, <span class="number">3220791016</span>, <span class="number">2211454015</span>, <span class="number">1684293308</span>, <span class="number">4097039749</span>, <span class="number">1950827819</span>, <span class="number">596270726</span>, <span class="number">3949026618</span>, <span class="number">889300608</span>, <span class="number">1474069298</span>, <span class="number">3689944987</span>, <span class="number">517015298</span>, <span class="number">1929617999</span>, <span class="number">2440031896</span>, <span class="number">2709812101</span>, <span class="number">1992955924</span>, <span class="number">4274956952</span>, <span class="number">2444627438</span>, <span class="number">1959460115</span>, <span class="number">582069911</span>, <span class="number">2419904717</span>, <span class="number">3222968174</span>, <span class="number">3399960494</span>, <span class="number">3144995592</span>, <span class="number">3407724325</span>, <span class="number">2444014512</span>, <span class="number">3959150538</span>, <span class="number">4285851741</span>, <span class="number">4079378961</span>, <span class="number">832382130</span>, <span class="number">904017537</span>, <span class="number">229548363</span>, <span class="number">93000443</span>, <span class="number">2440031554</span>, <span class="number">2400145592</span>, <span class="number">3894768702</span>, <span class="number">3306376113</span>, <span class="number">2064753071</span>, <span class="number">2520029593</span>, <span class="number">2289772340</span>, <span class="number">1863760194</span>, <span class="number">759985554</span>, <span class="number">2440361346</span>, <span class="number">2646486175</span>, <span class="number">3828340148</span>, <span class="number">3690476425</span>, <span class="number">3952521366</span>, <span class="number">1818853914</span>, <span class="number">3741487901</span>, <span class="number">1939261261</span>, <span class="number">2522131855</span>, <span class="number">4263166822</span>, <span class="number">389813606</span>, <span class="number">733497630</span>, <span class="number">3364518596</span>, <span class="number">1731487900</span>, <span class="number">3471982991</span>, <span class="number">774566785</span>, <span class="number">3061220186</span>, <span class="number">1670746657</span>, <span class="number">3364896019</span>, <span class="number">257688296</span>, <span class="number">2212175202</span>, <span class="number">2200932587</span>, <span class="number">458338439</span>, <span class="number">3070098357</span>, <span class="number">2769742051</span>, <span class="number">3731458422</span>, <span class="number">3112982787</span>, <span class="number">2370551593</span>, <span class="number">1357388415</span>, <span class="number">689717848</span>, <span class="number">2474014809</span>, <span class="number">2090597022</span>, <span class="number">1733516418</span>, <span class="number">2303805959</span>, <span class="number">133232025</span>, <span class="number">3047633045</span>, <span class="number">1517049212</span>, <span class="number">4283541802</span>, <span class="number">1001889723</span>, <span class="number">2375959444</span>, <span class="number">4243450364</span>, <span class="number">4168200824</span>, <span class="number">3231795488</span>, <span class="number">2650394352</span>, <span class="number">1574410332</span>, <span class="number">86126802</span>, <span class="number">3758445831</span>, <span class="number">2340719748</span>, <span class="number">4115977672</span>, <span class="number">3798145365</span>, <span class="number">77324638</span>, <span class="number">2643593782</span>, <span class="number">634790561</span>, <span class="number">3358486700</span>, <span class="number">4140032295</span>, <span class="number">3513246850</span>, <span class="number">261272711</span>, <span class="number">2220124969</span>, <span class="number">2897469143</span>, <span class="number">4198241230</span>, <span class="number">2456337431</span>, <span class="number">1981544167</span>, <span class="number">1249742357</span>, <span class="number">106387114</span>, <span class="number">2060633623</span>, <span class="number">3173024725</span>, <span class="number">1489283527</span>, <span class="number">510143932</span>, <span class="number">1243349100</span>, <span class="number">2298772697</span>, <span class="number">3898067472</span>, <span class="number">466814336</span>, <span class="number">2098853148</span>, <span class="number">83390745</span>, <span class="number">343787359</span>, <span class="number">2538403891</span>, <span class="number">1409671714</span>, <span class="number">1444158150</span>, <span class="number">3335793145</span>, <span class="number">4226110080</span>, <span class="number">2968674376</span>, <span class="number">4156094751</span>, <span class="number">3856849035</span>, <span class="number">2710375881</span>, <span class="number">1822021241</span>, <span class="number">2472348939</span>, <span class="number">27109603</span>, <span class="number">901956173</span>, <span class="number">1606776692</span>, <span class="number">3109594349</span>, <span class="number">1160160161</span>, <span class="number">4079063811</span>, <span class="number">3773912133</span>, <span class="number">2585704643</span>, <span class="number">3232895223</span>, <span class="number">2121801358</span>, <span class="number">1026952079</span>, <span class="number">583614097</span>, <span class="number">3824579802</span>, <span class="number">1380685627</span>, <span class="number">3652460459</span>, <span class="number">2028089458</span>, <span class="number">3175057906</span>, <span class="number">4068861409</span>, <span class="number">2515606890</span>, <span class="number">1200775571</span>, <span class="number">3314622745</span>, <span class="number">2289228806</span>, <span class="number">2646556019</span>, <span class="number">3687287145</span>, <span class="number">49195901</span>, <span class="number">1798788309</span>, <span class="number">591957085</span>, <span class="number">3929804275</span>, <span class="number">1689134041</span>, <span class="number">2396654796</span>, <span class="number">1126677730</span>, <span class="number">3880693177</span>, <span class="number">2706798188</span>, <span class="number">2926253562</span>, <span class="number">675988773</span>, <span class="number">3092145194</span>, <span class="number">1110289401</span>, <span class="number">2781751897</span>, <span class="number">2460708698</span>, <span class="number">2300555350</span>, <span class="number">3105548417</span>, <span class="number">2687966933</span>, <span class="number">1944880991</span>, <span class="number">1946066440</span>, <span class="number">323729559</span>, <span class="number">198758259</span>, <span class="number">846089862</span>, <span class="number">2055735049</span>, <span class="number">986255431</span>, <span class="number">3903265597</span>, <span class="number">2578706952</span>, <span class="number">326562597</span>, <span class="number">3041585079</span>, <span class="number">945078860</span>, <span class="number">1313161403</span>, <span class="number">410061813</span>, <span class="number">1875226375</span>, <span class="number">4212298012</span>, <span class="number">12181578</span>, <span class="number">1436289796</span>, <span class="number">2646424052</span>, <span class="number">783968191</span>, <span class="number">2296237075</span>, <span class="number">2514394580</span>, <span class="number">4048299958</span>, <span class="number">301817307</span>, <span class="number">4184456419</span>, <span class="number">1942975051</span>, <span class="number">2919339051</span>, <span class="number">3501922263</span>, <span class="number">4162022536</span>, <span class="number">3630366026</span>, <span class="number">3721271779</span>, <span class="number">1913934486</span>, <span class="number">2336935816</span>, <span class="number">2577035298</span>, <span class="number">2970413319</span>, <span class="number">2019488980</span>, <span class="number">2714459625</span>, <span class="number">1142206555</span>, <span class="number">2536005590</span>, <span class="number">206897342</span>, <span class="number">3510979210</span>, <span class="number">3796491959</span>, <span class="number">1776313757</span>, <span class="number">782863260</span>, <span class="number">2012142818</span>, <span class="number">3436192835</span>, <span class="number">2898073146</span>, <span class="number">3130308109</span>, <span class="number">4274710928</span>, <span class="number">1969954984</span>, <span class="number">1290470001</span>, <span class="number">2126172027</span>, <span class="number">3079056575</span>, <span class="number">1662723122</span>, <span class="number">3834154279</span>, <span class="number">1509844752</span>, <span class="number">1879507382</span>, <span class="number">243461236</span>, <span class="number">3263993681</span>, <span class="number">527941040</span>, <span class="number">2960667151</span>, <span class="number">437845417</span>, <span class="number">925496821</span>, <span class="number">1532313974</span>, <span class="number">1649607266</span>, <span class="number">421206050</span>, <span class="number">2648509518</span>, <span class="number">3766566857</span>, <span class="number">3537376560</span>, <span class="number">4056193064</span>, <span class="number">1077967822</span>, <span class="number">1307860259</span>, <span class="number">2569990067</span>, <span class="number">1896535739</span>, <span class="number">495691568</span>, <span class="number">2491860991</span>, <span class="number">1884037256</span>, <span class="number">3658585973</span>, <span class="number">2004809564</span>, <span class="number">1201319320</span>, <span class="number">698236773</span>, <span class="number">3179165673</span>, <span class="number">3128142447</span>, <span class="number">2969734009</span>, <span class="number">1938769280</span>, <span class="number">3816534949</span>, <span class="number">3967462278</span>, <span class="number">314256685</span>, <span class="number">3401644041</span>, <span class="number">141163388</span>, <span class="number">2139836122</span>, <span class="number">2186165576</span>, <span class="number">880507946</span>, <span class="number">1075680415</span>, <span class="number">590095951</span>, <span class="number">781161014</span>, <span class="number">1885882245</span>, <span class="number">1415340529</span>, <span class="number">676870166</span>, <span class="number">3098324703</span>, <span class="number">1603740967</span>, <span class="number">933186052</span>, <span class="number">2188444967</span>, <span class="number">1380155075</span>, <span class="number">325075865</span>, <span class="number">1826119902</span>, <span class="number">657002558</span>, <span class="number">2251435414</span>, <span class="number">1638195740</span>, <span class="number">339678650</span>, <span class="number">3669082568</span>, <span class="number">1796805010</span>, <span class="number">2141050149</span>, <span class="number">654717883</span>, <span class="number">4003791182</span>, <span class="number">1664663632</span>, <span class="number">1791829182</span>, <span class="number">259621495</span>, <span class="number">1501507869</span>, <span class="number">426821083</span>, <span class="number">4011249694</span>, <span class="number">2287808720</span>, <span class="number">1030313919</span>, <span class="number">1534049880</span>, <span class="number">3370703691</span>, <span class="number">2893327247</span>, <span class="number">3884350708</span>, <span class="number">252032180</span>, <span class="number">3517235610</span>, <span class="number">3106783933</span>, <span class="number">980527030</span>, <span class="number">3504106133</span>, <span class="number">2084789728</span>, <span class="number">3793438714</span>, <span class="number">995575458</span>, <span class="number">2288315137</span>, <span class="number">4111859009</span>, <span class="number">3921864816</span>, <span class="number">3721487765</span>, <span class="number">2793219118</span>, <span class="number">746638554</span>, <span class="number">1549812168</span>, <span class="number">2700267409</span>, <span class="number">1853734662</span>, <span class="number">1748279701</span>, <span class="number">3892771410</span>, <span class="number">4288430018</span>, <span class="number">3686995103</span>, <span class="number">3434770368</span>, <span class="number">3367913996</span>, <span class="number">1168390523</span>, <span class="number">725767781</span>, <span class="number">3092288760</span>, <span class="number">2591847798</span>, <span class="number">903957053</span>, <span class="number">2504294653</span>, <span class="number">347477166</span>, <span class="number">1017481488</span>, <span class="number">2470321729</span>, <span class="number">3672335375</span>, <span class="number">533737623</span>, <span class="number">1610987374</span>, <span class="number">2765681913</span>, <span class="number">208872518</span>, <span class="number">1965977476</span>, <span class="number">2620202455</span>, <span class="number">883316392</span>, <span class="number">3699766142</span>, <span class="number">2994493820</span>, <span class="number">1812755424</span>, <span class="number">2735350105</span>, <span class="number">3950705917</span>, <span class="number">1476668479</span>, <span class="number">1493462761</span>, <span class="number">2815529253</span>, <span class="number">806646294</span>, <span class="number">3645423519</span>, <span class="number">2013669614</span>, <span class="number">3129486607</span>, <span class="number">3144614215</span>, <span class="number">288595162</span>, <span class="number">3817835069</span>, <span class="number">267874362</span>, <span class="number">3043915018</span>, <span class="number">503418590</span>, <span class="number">4121632504</span>, <span class="number">3180856289</span>, <span class="number">4032347928</span>, <span class="number">3291631906</span>, <span class="number">1562033533</span>, <span class="number">442863943</span>, <span class="number">3466166285</span>, <span class="number">278810154</span>, <span class="number">1494382527</span>, <span class="number">3574923557</span>, <span class="number">1998156211</span>, <span class="number">3601671137</span>, <span class="number">3487174754</span>, <span class="number">279104055</span>, <span class="number">1252510103</span>, <span class="number">3487132312</span>, <span class="number">1621100800</span>, <span class="number">25161472</span>, <span class="number">2561260209</span>, <span class="number">965612285</span>, <span class="number">1832250248</span>, <span class="number">52415796</span>, <span class="number">3154169940</span>, <span class="number">2243747062</span>, <span class="number">254479611</span>, <span class="number">677387201</span>, <span class="number">1358172452</span>, <span class="number">3921571652</span>, <span class="number">618761969</span>, <span class="number">363666210</span>, <span class="number">3162780940</span>, <span class="number">3666074031</span>, <span class="number">1665264787</span>, <span class="number">1503573736</span>, <span class="number">911086726</span>, <span class="number">2321382060</span>, <span class="number">2488029747</span>, <span class="number">3937816868</span>, <span class="number">1422278816</span>, <span class="number">360698969</span>, <span class="number">2905431783</span>, <span class="number">1651373133</span>, <span class="number">1002394393</span>, <span class="number">2463677024</span>, <span class="number">3847067039</span>, <span class="number">4109151996</span>, <span class="number">3692875187</span>, <span class="number">3957213415</span>, <span class="number">337774859</span>, <span class="number">1627457381</span>, <span class="number">2352921901</span>, <span class="number">1179122457</span>, <span class="number">792596339</span>, <span class="number">2058169995</span>, <span class="number">98826108</span>, <span class="number">184541385</span>, <span class="number">573041636</span>, <span class="number">1718503267</span>, <span class="number">2373979624</span>, <span class="number">1539423106</span>, <span class="number">2133802553</span>, <span class="number">2718932930</span>, <span class="number">2899602984</span>, <span class="number">1708749378</span>, <span class="number">1493281076</span>, <span class="number">3826992689</span>, <span class="number">3187379881</span>, <span class="number">2712719707</span>, <span class="number">1836233390</span>, <span class="number">1513079935</span>, <span class="number">2948529391</span>, <span class="number">1284828221</span>, <span class="number">1934418973</span>, <span class="number">2112847098</span>, <span class="number">4006425883</span>, <span class="number">1052931751</span>, <span class="number">758501987</span>, <span class="number">3223983720</span>, <span class="number">3073673083</span>, <span class="number">836081105</span>, <span class="number">1472754488</span>, <span class="number">2487029702</span>, <span class="number">1801093799</span>, <span class="number">928502313</span>, <span class="number">2759231771</span>, <span class="number">289737457</span>, <span class="number">1206688708</span>, <span class="number">3140526342</span>, <span class="number">104209388</span>, <span class="number">1361386155</span>, <span class="number">3960807502</span>, <span class="number">482386571</span>, <span class="number">459903450</span>, <span class="number">2680652306</span>, <span class="number">2508629297</span>, <span class="number">286409773</span>, <span class="number">3483104433</span>, <span class="number">3871176786</span>, <span class="number">729736313</span>, <span class="number">2712461087</span>, <span class="number">4246130450</span>, <span class="number">3293470502</span>, <span class="number">1864992810</span>, <span class="number">3993063846</span>, <span class="number">1448244981</span>, <span class="number">3620828636</span>, <span class="number">1054531830</span>, <span class="number">1459388713</span>, <span class="number">858014894</span>, <span class="number">4183748064</span>, <span class="number">1582214994</span>, <span class="number">3953275394</span>, <span class="number">727377185</span>, <span class="number">3491687643</span>, <span class="number">2796129215</span>, <span class="number">3668426666</span>, <span class="number">3557506333</span>, <span class="number">3144306538</span>, <span class="number">4281464076</span>, <span class="number">3011495069</span>, <span class="number">2962568386</span>, <span class="number">4184263382</span>, <span class="number">1508606659</span>, <span class="number">205231019</span>, <span class="number">3386764677</span>, <span class="number">127956607</span>, <span class="number">1929240858</span>, <span class="number">2548967515</span>, <span class="number">3414626647</span>, <span class="number">2679328453</span>, <span class="number">4115330272</span>, <span class="number">2138199538</span>, <span class="number">528646513</span>, <span class="number">930913501</span>, <span class="number">2289236352</span>, <span class="number">1450362023</span>, <span class="number">3715782672</span>, <span class="number">1564424064</span>, <span class="number">1483557512</span>, <span class="number">1925447364</span>, <span class="number">4033938968</span>, <span class="number">948886720</span>, <span class="number">1934701201</span>, <span class="number">3443512270</span>, <span class="number">3764216731</span>, <span class="number">1916644786</span>, <span class="number">1384731002</span>, <span class="number">1287076013</span>, <span class="number">2018652058</span>, <span class="number">2958813289</span>, <span class="number">2447620542</span>, <span class="number">3796146048</span>, <span class="number">1622854988</span>, <span class="number">686433039</span>, <span class="number">253693283</span>, <span class="number">2111793939</span>, <span class="number">2306433090</span>, <span class="number">4080191525</span>, <span class="number">2224402081</span>, <span class="number">59703913</span>, <span class="number">3958459307</span>, <span class="number">200336724</span>, <span class="number">1145854569</span>, <span class="number">3663609709</span>, <span class="number">2415681691</span>, <span class="number">2296226043</span>, <span class="number">392158285</span>, <span class="number">188412176</span>, <span class="number">1602068724</span>, <span class="number">3672007681</span>, <span class="number">3351358685</span>, <span class="number">77226497</span>, <span class="number">2761914402</span>, <span class="number">4182346783</span>, <span class="number">1761752133</span>, <span class="number">3379796480</span>, <span class="number">1432182970</span>, <span class="number">2888348707</span>, <span class="number">1802155620</span>, <span class="number">616220107</span>, <span class="number">3016445592</span>, <span class="number">3865489237</span>, <span class="number">2995611525</span>, <span class="number">2625430625</span>, <span class="number">2137676831</span>, <span class="number">3606331449</span>, <span class="number">1226821679</span>, <span class="number">2631807346</span>, <span class="number">2059447310</span>, <span class="number">230230491</span>, <span class="number">170274047</span>, <span class="number">2996095768</span>, <span class="number">430212978</span>, <span class="number">2288854251</span>, <span class="number">848196586</span>, <span class="number">3756171416</span>, <span class="number">3810330367</span>, <span class="number">2274580015</span>, <span class="number">535135238</span>, <span class="number">2912469751</span>, <span class="number">1239590861</span>, <span class="number">59737234</span>, <span class="number">1876188585</span>, <span class="number">1963377303</span>, <span class="number">934928269</span>, <span class="number">1508581017</span>, <span class="number">716112306</span>, <span class="number">1249284798</span>, <span class="number">2477368019</span>, <span class="number">1268762080</span>, <span class="number">3319914811</span>, <span class="number">471096890</span>, <span class="number">2932800245</span>, <span class="number">1107822578</span>, <span class="number">1924574171</span>, <span class="number">2720637936</span>, <span class="number">2154900827</span>, <span class="number">3462641388</span>, <span class="number">3566142421</span>]</span><br><span class="line">state = [recover(outputs[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(outputs))]</span><br><span class="line"><span class="comment"># 这里是索引4 - 1003的状态序列，我们需要知道索引0～3的状态序列</span></span><br><span class="line">state = backtrace([<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>] + state)[:<span class="number">624</span>]</span><br><span class="line">RNG = random.Random()</span><br><span class="line">RNG.setstate((<span class="number">3</span>,<span class="built_in">tuple</span>(state + [<span class="number">0</span>]),<span class="literal">None</span>))</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="built_in">print</span>(RNG.getrandbits(<span class="number">32</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>进行修改的部分为<code>backtrace</code>中的</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    tmp = state[i+<span class="number">624</span>]^state[(i+<span class="number">397</span>)%<span class="number">624</span>]</span><br><span class="line">		...</span><br><span class="line">    ...</span><br><span class="line">    tmp = state[i-<span class="number">1</span>+<span class="number">624</span>]^state[(i+<span class="number">396</span>)%<span class="number">624</span>]</span><br></pre></td></tr></table></figure>

<p>其余地方没变</p>
<h1 id="ExtendMT19937Predictor"><a href="#ExtendMT19937Predictor" class="headerlink" title="ExtendMT19937Predictor"></a>ExtendMT19937Predictor</h1><p>项目url见文末</p>
<p>通过输入 32×624 位生成的数字来预测和回溯 MT19937 线性同余生成器。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install extend_mt19937_predictor</span><br></pre></td></tr></table></figure>

<p>只要我们有了32 * 624个输出，便可以用如下方法进行预测和回溯</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"></span><br><span class="line">predictor = ExtendMT19937Predictor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    predictor.setrandbits(random.getrandbits(<span class="number">32</span>), <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">    <span class="keyword">assert</span> predictor.predict_getrandbits(<span class="number">32</span>) == random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">assert</span> predictor.predict_getrandbits(<span class="number">64</span>) == random.getrandbits(<span class="number">64</span>)</span><br><span class="line">    <span class="keyword">assert</span> predictor.predict_getrandbits(<span class="number">128</span>) == random.getrandbits(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">assert</span> predictor.predict_getrandbits(<span class="number">256</span>) == random.getrandbits(<span class="number">256</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"></span><br><span class="line">numbers = [random.getrandbits(<span class="number">64</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>)]</span><br><span class="line"></span><br><span class="line">predictor = ExtendMT19937Predictor()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">78</span>):</span><br><span class="line">    predictor.setrandbits(random.getrandbits(<span class="number">256</span>), <span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">_ = [predictor.backtrack_getrandbits(<span class="number">256</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">78</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> numbers[::-<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">assert</span> x == predictor.backtrack_getrandbits(<span class="number">64</span>)</span><br></pre></td></tr></table></figure>

<h1 id="gf2bv"><a href="#gf2bv" class="headerlink" title="gf2bv"></a>gf2bv</h1><p>项目地址见文末</p>
<p>ExtendMT19937Predictor这个工具要求提交的随机数必须是32bit的倍数，并且需要连续的随机数。如果题目提供的值不满足上述要求，我们可以用gf2bv这个工具</p>
<p>最最最极限的情况就是给出19968个<code>getrandbits(1)</code>的值，可以看我2025强网杯的ezran和Blurred</p>
<p>不过这个工具用于预测随机数会比较方便，如果是要回溯的话，结合ExtendMT19937Predictor可能会比较不错</p>
<h1 id="Python-random模块分析"><a href="#Python-random模块分析" class="headerlink" title="Python random模块分析"></a>Python random模块分析</h1><p>从20250xGame——Week4——MT19937这题入手</p>
<h2 id="0xGame——MT19937"><a href="#0xGame——MT19937" class="headerlink" title="0xGame——MT19937"></a>0xGame——MT19937</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">seed = random.randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">32</span> - <span class="number">1</span>)</span><br><span class="line">RNG = random.Random(seed)</span><br><span class="line"></span><br><span class="line">MENU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">MT19937 Seed Challenge</span></span><br><span class="line"><span class="string">======================</span></span><br><span class="line"><span class="string">[G]et random number</span></span><br><span class="line"><span class="string">[C]heck seed</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        inputs = <span class="built_in">input</span>(<span class="string">&quot;&gt;&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> inputs.strip().upper() == <span class="string">&quot;G&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(RNG.getrandbits(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">elif</span> inputs.strip().upper() == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">            guess = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess the seed: &quot;</span>))</span><br><span class="line">            <span class="keyword">if</span> guess == seed:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Correct! Here is your flag: <span class="subst">&#123;flag.decode()&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Incorrect seed. Exiting...&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Invalid option. Please choose G or C.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to the MT19937 Seed Challenge!&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;A random seed has been generated. You can get random numbers or try to guess the seed.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(MENU)</span><br><span class="line">    challenge()</span><br></pre></td></tr></table></figure>

<ul>
<li><p>题目随机生成一个32bit以内的值作为<code>seed</code></p>
</li>
<li><p>通过<code>seed</code>生成一个新的随机数生成器<code>RNG</code></p>
</li>
<li><p>可以获得若干个<code>getrandbits(2)</code>的值</p>
</li>
<li><p>要求恢复<code>seed</code></p>
</li>
</ul>
<p>其实思路蛮清晰的，通过<code>19968 // 2</code>个<code>getrandbits(2)</code>的值结合gf2bv恢复随机数的状态序列，然后求<code>seed</code>。我们需要注意的是，Python中random模块的<code>random.seed(seed)</code>调用之后，并不是简单的把<code>seed</code>当作状态序列的第一个值去生成整个状态序列（这是模块与MT19937的区别）</p>
<p>那首要目的就是知道一下首先对<code>seed</code>做了什么处理，经过多次拷打AI，在python中调用<code>random.seed(seed)</code>会执行一个叫<code>init_by_array</code>的函数产生一个state再去生成随机数：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">init_by_array</span>(<span class="params">init_key, key_length</span>):</span><br><span class="line">    N = <span class="number">624</span></span><br><span class="line">    state = [<span class="number">0</span>] * N</span><br><span class="line">    <span class="comment"># init_genrand(19650218)</span></span><br><span class="line">    state[<span class="number">0</span>] = <span class="number">19650218</span> &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, N):</span><br><span class="line">        state[i] = (<span class="number">1812433253</span> * (state[i-<span class="number">1</span>] ^ (state[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>)) + i) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="comment"># 混合 init_key</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    k = N <span class="keyword">if</span> N &gt; key_length <span class="keyword">else</span> key_length</span><br><span class="line">    <span class="keyword">while</span> k:</span><br><span class="line">        state[i] = (state[i] ^ ((state[i-<span class="number">1</span>] ^ (state[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>)) * <span class="number">1664525</span>)) + init_key[j] + j</span><br><span class="line">        state[i] &amp;= <span class="number">0xFFFFFFFF</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= N:</span><br><span class="line">            state[<span class="number">0</span>] = state[N-<span class="number">1</span>]</span><br><span class="line">            i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> j &gt;= key_length:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        k -= <span class="number">1</span></span><br><span class="line">    <span class="comment"># 第二次循环</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(N-<span class="number">1</span>):</span><br><span class="line">        state[i] = (state[i] ^ ((state[i-<span class="number">1</span>] ^ (state[i-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>)) * <span class="number">1566083941</span>)) - i</span><br><span class="line">        state[i] &amp;= <span class="number">0xFFFFFFFF</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= N:</span><br><span class="line">            state[<span class="number">0</span>] = state[N-<span class="number">1</span>]</span><br><span class="line">            i = <span class="number">1</span></span><br><span class="line">    state[<span class="number">0</span>] = <span class="number">0x80000000</span>  <span class="comment"># 2147483648</span></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟</span></span><br><span class="line">seed = <span class="number">114514</span></span><br><span class="line">state = init_by_array([seed], <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Simulated state[:4]:&quot;</span>, state[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Python</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">114514</span>)</span><br><span class="line">right_state = random.getstate()[<span class="number">1</span>][:-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Python state[:4]:&quot;</span>, right_state[:<span class="number">4</span>])</span><br></pre></td></tr></table></figure>

<p>经过验证是没有问题的，那接下来的问题就是如何通过<code>state</code>回推<code>seed</code>，又经过多次拷打AI，给出了求解脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">find_seed_by_z3</span>(<span class="params">mt_state</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mt_state: list of 624 python integers (each 0..2**32-1) - the internal state you have</span></span><br><span class="line"><span class="string">    returns: list of solutions (could be empty). We&#x27;ll search iteratively for multiple solutions.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(mt_state) != <span class="number">624</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;mt_state must be length 624&quot;</span>)</span><br><span class="line">    seed = BitVec(<span class="string">&#x27;seed&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">    solver = Solver()</span><br><span class="line">    computed = init_by_array_bv(seed)</span><br><span class="line">    <span class="comment"># add constraints: computed[i] == mt_state[i]</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        solver.add(computed[i] == BitVecVal(mt_state[i] &amp; <span class="number">0xffffffff</span>, <span class="number">32</span>))</span><br><span class="line">    sols = []</span><br><span class="line">    <span class="comment"># get up to some number (say up to 4) solutions (there may be 0, 1 or multiple)</span></span><br><span class="line">    <span class="keyword">while</span> solver.check() == sat <span class="keyword">and</span> <span class="built_in">len</span>(sols) &lt; <span class="number">4</span>:</span><br><span class="line">        m = solver.model()</span><br><span class="line">        s_val = m[seed].as_long()</span><br><span class="line">        sols.append(s_val)</span><br><span class="line">        <span class="comment"># block this solution to search for another</span></span><br><span class="line">        solver.add(seed != BitVecVal(s_val, <span class="number">32</span>))</span><br><span class="line">    <span class="keyword">return</span> sols</span><br></pre></td></tr></table></figure>

<p>那么现在进行<code>19968 // 2</code>次交互，并用gf2bv获得<code>state</code>，再回推<code>seed</code>就可以拿到flag了</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> BitVec, BitVecVal, Solver, LShR, sat</span><br><span class="line"><span class="keyword">from</span> gf2bv <span class="keyword">import</span> LinearSystem</span><br><span class="line"><span class="keyword">from</span> gf2bv.crypto.mt <span class="keyword">import</span> MT19937</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_by_array_bv</span>(<span class="params">seed_bv</span>):</span><br><span class="line">    N = <span class="number">624</span></span><br><span class="line">    state = [BitVecVal(<span class="number">0</span>, <span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">    state[<span class="number">0</span>] = BitVecVal(<span class="number">19650218</span>, <span class="number">32</span>)</span><br><span class="line">    <span class="comment"># first loop</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, N):</span><br><span class="line">        prev = state[i-<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># state[i] = (1812433253 * (state[i-1] ^ (state[i-1] &gt;&gt; 30)) + i) &amp; 0xffffffff</span></span><br><span class="line">        temp = prev ^ LShR(prev, <span class="number">30</span>)</span><br><span class="line">        state[i] = (BitVecVal(<span class="number">1812433253</span>, <span class="number">32</span>) * temp) + BitVecVal(i, <span class="number">32</span>)</span><br><span class="line">    <span class="comment"># second (mixing) phase with init_key = [seed], key_length = 1</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    key_length = <span class="number">1</span></span><br><span class="line">    k = N <span class="keyword">if</span> N &gt; key_length <span class="keyword">else</span> key_length  <span class="comment"># here k = 624</span></span><br><span class="line">    <span class="comment"># note: use seed_bv for init_key[j] (always seed_bv because key_length==1)</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        prev = state[i-<span class="number">1</span>]</span><br><span class="line">        temp = prev ^ LShR(prev, <span class="number">30</span>)</span><br><span class="line">        <span class="comment"># multiplication by 1664525</span></span><br><span class="line">        mul = BitVecVal(<span class="number">1664525</span>, <span class="number">32</span>) * temp</span><br><span class="line">        <span class="comment"># state[i] = (state[i] ^ mul) + seed + j</span></span><br><span class="line">        state[i] = (state[i] ^ mul) + seed_bv + BitVecVal(j, <span class="number">32</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= N:</span><br><span class="line">            state[<span class="number">0</span>] = state[N-<span class="number">1</span>]</span><br><span class="line">            i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> j &gt;= key_length:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">    <span class="comment"># third loop</span></span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(N-<span class="number">1</span>):</span><br><span class="line">        prev = state[i-<span class="number">1</span>]</span><br><span class="line">        temp = prev ^ LShR(prev, <span class="number">30</span>)</span><br><span class="line">        mul = BitVecVal(<span class="number">1566083941</span>, <span class="number">32</span>) * temp</span><br><span class="line">        state[i] = (state[i] ^ mul) - BitVecVal(i, <span class="number">32</span>)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= N:</span><br><span class="line">            state[<span class="number">0</span>] = state[N-<span class="number">1</span>]</span><br><span class="line">            i = <span class="number">1</span></span><br><span class="line">    state[<span class="number">0</span>] = BitVecVal(<span class="number">0x80000000</span>, <span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_seed_by_z3</span>(<span class="params">mt_state</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mt_state: list of 624 python integers (each 0..2**32-1) - the internal state you have</span></span><br><span class="line"><span class="string">    returns: list of solutions (could be empty). We&#x27;ll search iteratively for multiple solutions.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(mt_state) != <span class="number">624</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;mt_state must be length 624&quot;</span>)</span><br><span class="line">    seed = BitVec(<span class="string">&#x27;seed&#x27;</span>, <span class="number">32</span>)</span><br><span class="line">    solver = Solver()</span><br><span class="line">    computed = init_by_array_bv(seed)</span><br><span class="line">    <span class="comment"># add constraints: computed[i] == mt_state[i]</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        solver.add(computed[i] == BitVecVal(mt_state[i] &amp; <span class="number">0xffffffff</span>, <span class="number">32</span>))</span><br><span class="line">    sols = []</span><br><span class="line">    <span class="comment"># get up to some number (say up to 4) solutions (there may be 0, 1 or multiple)</span></span><br><span class="line">    <span class="keyword">while</span> solver.check() == sat <span class="keyword">and</span> <span class="built_in">len</span>(sols) &lt; <span class="number">4</span>:</span><br><span class="line">        m = solver.model()</span><br><span class="line">        s_val = m[seed].as_long()</span><br><span class="line">        sols.append(s_val)</span><br><span class="line">        <span class="comment"># block this solution to search for another</span></span><br><span class="line">        solver.add(seed != BitVecVal(s_val, <span class="number">32</span>))</span><br><span class="line">    <span class="keyword">return</span> sols</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mt19937</span>(<span class="params">out</span>):</span><br><span class="line">    lin = LinearSystem([<span class="number">32</span>] * <span class="number">624</span>)</span><br><span class="line">    mt = lin.gens()</span><br><span class="line"></span><br><span class="line">    rng = MT19937(mt)</span><br><span class="line">    zeros = []</span><br><span class="line">    <span class="keyword">for</span> o <span class="keyword">in</span> out:</span><br><span class="line">        zeros.append(rng.getrandbits(<span class="number">2</span>) ^ <span class="built_in">int</span>(o))</span><br><span class="line">    zeros.append(mt[<span class="number">0</span>] ^ <span class="built_in">int</span>(<span class="number">0x80000000</span>))</span><br><span class="line">    sol = lin.solve_one(zeros)</span><br><span class="line">    rng = MT19937(sol)</span><br><span class="line">    pyrand = rng.to_python_random()</span><br><span class="line">    <span class="keyword">return</span> pyrand</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">sh = remote(<span class="string">&quot;nc1.ctfplus.cn&quot;</span>,<span class="number">14170</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;[C]heck seed&quot;</span>)</span><br><span class="line">bits = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19968</span> // <span class="number">2</span>):</span><br><span class="line">    sh.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;G&#x27;</span>)</span><br><span class="line">    bits.append(<span class="built_in">int</span>(sh.recvline().strip().decode()))</span><br><span class="line"></span><br><span class="line">RNG = mt19937(bits)</span><br><span class="line">mt_state = RNG.getstate()[<span class="number">1</span>][:-<span class="number">1</span>]</span><br><span class="line">seed = find_seed_by_z3(mt_state)[<span class="number">0</span>]</span><br><span class="line">sh.sendlineafter(<span class="string">b&#x27;&gt;&gt;&#x27;</span>,<span class="string">b&#x27;C&#x27;</span>)</span><br><span class="line">sh.sendlineafter(<span class="string">b&quot;Guess the seed:&quot;</span>,<span class="built_in">str</span>(seed).encode())</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>Python的random模块底层是调用的<code>cpython/Modules/_randommodule.c</code> </p>
<p><a target="_blank" rel="noopener" href="https://github.com/python/cpython/blob/3.13/Modules/_randommodule.c">https://github.com/python/cpython/blob/3.13/Modules/_randommodule.c</a></p>
<p>定位到关键的两个函数<code>init_genrand()</code>，<code>init_by_array()</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* initializes mt[N] with a seed */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">init_genrand</span><span class="params">(RandomObject *self, <span class="type">uint32_t</span> s)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> mti;</span><br><span class="line">    <span class="type">uint32_t</span> *mt;</span><br><span class="line"></span><br><span class="line">    mt = self-&gt;state;</span><br><span class="line">    mt[<span class="number">0</span>]= s;</span><br><span class="line">    <span class="keyword">for</span> (mti=<span class="number">1</span>; mti&lt;N; mti++) &#123;</span><br><span class="line">        mt[mti] =</span><br><span class="line">        (<span class="number">1812433253U</span> * (mt[mti<span class="number">-1</span>] ^ (mt[mti<span class="number">-1</span>] &gt;&gt; <span class="number">30</span>)) + mti);</span><br><span class="line">        <span class="comment">/* See Knuth TAOCP Vol2. 3rd Ed. P.106 for multiplier. */</span></span><br><span class="line">        <span class="comment">/* In the previous versions, MSBs of the seed affect   */</span></span><br><span class="line">        <span class="comment">/* only MSBs of the array mt[].                                */</span></span><br><span class="line">        <span class="comment">/* 2002/01/09 modified by Makoto Matsumoto                     */</span></span><br><span class="line">    &#125;</span><br><span class="line">    self-&gt;index = mti;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* initialize by an array with array-length */</span></span><br><span class="line"><span class="comment">/* init_key is the array for initializing keys */</span></span><br><span class="line"><span class="comment">/* key_length is its length */</span></span><br><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">init_by_array</span><span class="params">(RandomObject *self, <span class="type">uint32_t</span> init_key[], <span class="type">size_t</span> key_length)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">size_t</span> i, j, k;       <span class="comment">/* was signed in the original code. RDH 12/16/2002 */</span></span><br><span class="line">    <span class="type">uint32_t</span> *mt;</span><br><span class="line"></span><br><span class="line">    mt = self-&gt;state;</span><br><span class="line">    init_genrand(self, <span class="number">19650218U</span>);</span><br><span class="line">    i=<span class="number">1</span>; j=<span class="number">0</span>;</span><br><span class="line">    k = (N&gt;key_length ? N : key_length);</span><br><span class="line">    <span class="keyword">for</span> (; k; k--) &#123;</span><br><span class="line">        mt[i] = (mt[i] ^ ((mt[i<span class="number">-1</span>] ^ (mt[i<span class="number">-1</span>] &gt;&gt; <span class="number">30</span>)) * <span class="number">1664525U</span>))</span><br><span class="line">                 + init_key[j] + (<span class="type">uint32_t</span>)j; <span class="comment">/* non linear */</span></span><br><span class="line">        i++; j++;</span><br><span class="line">        <span class="keyword">if</span> (i&gt;=N) &#123; mt[<span class="number">0</span>] = mt[N<span class="number">-1</span>]; i=<span class="number">1</span>; &#125;</span><br><span class="line">        <span class="keyword">if</span> (j&gt;=key_length) j=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (k=N<span class="number">-1</span>; k; k--) &#123;</span><br><span class="line">        mt[i] = (mt[i] ^ ((mt[i<span class="number">-1</span>] ^ (mt[i<span class="number">-1</span>] &gt;&gt; <span class="number">30</span>)) * <span class="number">1566083941U</span>))</span><br><span class="line">                 - (<span class="type">uint32_t</span>)i; <span class="comment">/* non linear */</span></span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span> (i&gt;=N) &#123; mt[<span class="number">0</span>] = mt[N<span class="number">-1</span>]; i=<span class="number">1</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mt[<span class="number">0</span>] = <span class="number">0x80000000</span>U; <span class="comment">/* MSB is 1; assuring non-zero initial array */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>init_genrand</code>和MT19937的<code>__init__</code>一样，<code>init_by_array</code>的python实现如上</p>
<p>关于<code>init_by_array</code>的逆向，可以看文末sean师傅的博客</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_re_init_by_array_part</span>(<span class="params">index, mt, multiplier</span>):</span><br><span class="line">    <span class="keyword">return</span> _int32((mt[index]+index) ^ (mt[index-<span class="number">1</span>] ^ mt[index-<span class="number">1</span>] &gt;&gt; <span class="number">30</span>) * multiplier)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_init_genrand</span>(<span class="params">seed,mt</span>):</span><br><span class="line">    mt[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">        mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">re_init_by_array</span>(<span class="params">mt=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> mt <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        seed = random.randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">32</span>-<span class="number">1</span>)</span><br><span class="line">        RNG = random.Random(seed)</span><br><span class="line">        _, mt, _ = RNG.getstate()</span><br><span class="line"> </span><br><span class="line">    tmp = [_re_init_by_array_part(i, mt[:-<span class="number">1</span>], <span class="number">1566083941</span>) <span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">622</span>,<span class="number">623</span>]]</span><br><span class="line"> </span><br><span class="line">    original_mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">    _init_genrand(<span class="number">19650218</span>, original_mt)</span><br><span class="line"> </span><br><span class="line">    predict_seed = _int32(tmp[-<span class="number">1</span>] - _int32((tmp[-<span class="number">2</span>] ^ (tmp[-<span class="number">2</span>] &gt;&gt; <span class="number">30</span>)) * <span class="number">1664525</span> ^ original_mt[-<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;seed&quot;</span> <span class="keyword">in</span> <span class="built_in">locals</span>():</span><br><span class="line">        <span class="built_in">print</span>(predict_seed, seed)</span><br><span class="line">        <span class="built_in">print</span>(predict_seed == seed % <span class="number">2</span>**<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> predict_seed</span><br></pre></td></tr></table></figure>

<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a target="_blank" rel="noopener" href="https://xenny.wiki/posts/crypto/PRNG/MT19937.html">MT19937分析 | Xenny 的博客</a></p>
<p><a target="_blank" rel="noopener" href="https://seandictionary.top/mt19937/">MT19937 - SeanDictionary | 折腾日记</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/205861">浅析MT19937伪随机数生成算法</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/NonupleBroken/ExtendMT19937Predictor">https://github.com/NonupleBroken/ExtendMT19937Predictor</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/maple3142/gf2bv">https://github.com/maple3142/gf2bv</a></p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2025/10/28/MT19937/" title="MT19937">https://dexterjie.github.io/2025/10/28/MT19937/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"># 学习笔记</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/10/20/2025%E5%BC%BA%E7%BD%91%E6%9D%AF/" rel="prev" title="2025强网杯">
                  <i class="fa fa-chevron-left"></i> 2025强网杯
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">318k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">19:16</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2025/10/28/MT19937/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
