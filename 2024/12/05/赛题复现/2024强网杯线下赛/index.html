<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录2024S8强网杯线下赛Crypto部分题解和RealWorld部分题目信息，还有自我感受">
<meta property="og:type" content="article">
<meta property="og:title" content="2024强网杯线下赛">
<meta property="og:url" content="https://dexterjie.github.io/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录2024S8强网杯线下赛Crypto部分题解和RealWorld部分题目信息，还有自我感受">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/1.JPG">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/2.JPG">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/3.JPG">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/4.JPG">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/5.JPG">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/5.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/6.JPG">
<meta property="article:published_time" content="2024-12-05T11:09:30.000Z">
<meta property="article:modified_time" content="2024-12-06T16:19:52.394Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/1.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/","path":"2024/12/05/赛题复现/2024强网杯线下赛/","title":"2024强网杯线下赛"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024强网杯线下赛 | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%AF%94%E8%B5%9B%E8%AE%B0%E5%BD%95"><span class="nav-number">1.</span> <span class="nav-text">比赛记录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Jeopardy"><span class="nav-number">1.1.</span> <span class="nav-text">Jeopardy</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Shopping"><span class="nav-number">1.1.1.</span> <span class="nav-text">Shopping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bl0ck"><span class="nav-number">1.1.2.</span> <span class="nav-text">bl0ck</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fak1"><span class="nav-number">1.1.3.</span> <span class="nav-text">fak1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#f2ke%E2%80%94%E2%80%94unsolved"><span class="nav-number">1.1.4.</span> <span class="nav-text">f2ke——unsolved</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Signin%E2%80%94%E2%80%94unsolved"><span class="nav-number">1.1.5.</span> <span class="nav-text">Signin——unsolved</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b1ock%E2%80%94%E2%80%94unsolved"><span class="nav-number">1.1.6.</span> <span class="nav-text">b1ock——unsolved</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#st%E2%80%94%E2%80%94unsolved"><span class="nav-number">1.1.7.</span> <span class="nav-text">st——unsolved</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RW"><span class="nav-number">1.2.</span> <span class="nav-text">RW</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#FXPDF"><span class="nav-number">1.2.1.</span> <span class="nav-text">FXPDF</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DataEase"><span class="nav-number">1.2.2.</span> <span class="nav-text">DataEase</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gnac"><span class="nav-number">1.2.3.</span> <span class="nav-text">gnac</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ire"><span class="nav-number">1.2.4.</span> <span class="nav-text">ire</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ltp"><span class="nav-number">1.2.5.</span> <span class="nav-text">ltp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OML"><span class="nav-number">1.2.6.</span> <span class="nav-text">OML</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OPDD"><span class="nav-number">1.2.7.</span> <span class="nav-text">OPDD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rac"><span class="nav-number">1.2.8.</span> <span class="nav-text">rac</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ts"><span class="nav-number">1.2.9.</span> <span class="nav-text">ts++</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ubp"><span class="nav-number">1.2.10.</span> <span class="nav-text">Ubp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WPNet"><span class="nav-number">1.2.11.</span> <span class="nav-text">WPNet</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Thinking"><span class="nav-number">2.</span> <span class="nav-text">Thinking</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024强网杯线下赛 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024强网杯线下赛
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-12-05 19:09:30" itemprop="dateCreated datePublished" datetime="2024-12-05T19:09:30+08:00">2024-12-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-12-07 00:19:52" itemprop="dateModified" datetime="2024-12-07T00:19:52+08:00">2024-12-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>37 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录2024S8强网杯线下赛Crypto部分题解和RealWorld部分题目信息，还有自我感受</p>
<span id="more"></span>

<p>比赛分为两个部分，一个是Jeopardy(就是平时的解题赛)，另外一个是RW(RealWorld，和实战没什么区别，看了下题目基本都是现场挖洞，第一天拿分的基本都是长亭和DAS)</p>
<h1 id="比赛记录"><a href="#比赛记录" class="headerlink" title="比赛记录"></a>比赛记录</h1><h2 id="Jeopardy"><a href="#Jeopardy" class="headerlink" title="Jeopardy"></a>Jeopardy</h2><p>解题部分就只记录密码，因为别的我也不会啊(楽)</p>
<h3 id="Shopping"><a href="#Shopping" class="headerlink" title="Shopping"></a>Shopping</h3><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">next_prime</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(x):</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">success = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    coins = <span class="number">27</span></span><br><span class="line">    space = <span class="number">0</span></span><br><span class="line">    p = getPrime(<span class="number">64</span>)</span><br><span class="line">    delta = getRandomNBitInteger(<span class="number">30</span>)</span><br><span class="line">    q = next_prime(p + delta)</span><br><span class="line">    N = p*q</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to my supermarket\n&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> coins &gt; <span class="number">0</span>:</span><br><span class="line">        choice = <span class="built_in">input</span>(<span class="string">&#x27;give me your choice\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            space = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;What size of house would you like to purchase?\n&quot;</span>))</span><br><span class="line">            <span class="keyword">assert</span> <span class="number">1</span> &lt;= space &lt;= <span class="number">10</span></span><br><span class="line">            ls = [<span class="number">0</span>] * space</span><br><span class="line">            coins -= space * <span class="number">5</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;coins&#125;</span> coins left\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">            op = <span class="built_in">input</span>()</span><br><span class="line">            <span class="keyword">assert</span> op <span class="keyword">in</span> [<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;//&#x27;</span>, <span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;root&#x27;</span>]</span><br><span class="line">            a, b, c= <span class="built_in">input</span>().split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> op == <span class="string">&#x27;root&#x27;</span>:</span><br><span class="line">                    <span class="built_in">exec</span>(<span class="string">f&#x27;<span class="subst">&#123;a&#125;</span>=iroot(<span class="subst">&#123;b&#125;</span>,<span class="subst">&#123;c&#125;</span>)[0]&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">exec</span>(<span class="string">f&#x27;<span class="subst">&#123;a&#125;</span>=<span class="subst">&#123;b&#125;</span><span class="subst">&#123;op&#125;</span><span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span>:exit</span><br><span class="line">            <span class="keyword">if</span> op <span class="keyword">in</span> <span class="string">&#x27;+-&#x27;</span>:</span><br><span class="line">                coins -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> op <span class="keyword">in</span> <span class="string">&#x27;*//%&#x27;</span>:</span><br><span class="line">                coins -= <span class="number">3</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                coins -= <span class="number">5</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;coins&#125;</span> coins left\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> choice == <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">            state = <span class="number">0</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;One coin to check\n&quot;</span>)</span><br><span class="line">            coins -= <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You must have decorated a beautiful house.\n&quot;</span>)</span><br><span class="line">            <span class="keyword">assert</span> coins &gt;= <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> ls:</span><br><span class="line">                <span class="keyword">if</span> i &gt; <span class="number">1</span> <span class="keyword">and</span> i &lt; N <span class="keyword">and</span> N%i == <span class="number">0</span>:</span><br><span class="line">                    success += <span class="number">1</span></span><br><span class="line">                    state = <span class="number">1</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;wonderful!, still <span class="subst">&#123;coins&#125;</span> coins left\n&#x27;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> state:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> success == <span class="number">20</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Congratulations! Here is your flag:<span class="subst">&#123;flag&#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure>


<p>$$<br>q &#x3D; p + x<br>$$</p>
<p>$x \approx 2^{30}$<br>$$<br>n &#x3D; pq &#x3D; p(p + x)<br>$$</p>
<p>要求用<code>+,-,%,//,*,iroot</code>6个运算，进行有限步操作把n分解<br>$$<br>n &#x3D; p^2 + px<br>$$</p>
<p>$$<br>n - px &#x3D; p^2<br>$$</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;47.94.85.95&quot;</span>,<span class="number">28743</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;give me your choice&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;What size of house would you like to purchase?&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;give me your choice&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;//&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;ls[0].N.q&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;give me your choice&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/1.png"></p>
<h3 id="bl0ck"><a href="#bl0ck" class="headerlink" title="bl0ck"></a>bl0ck</h3><blockquote>
<p>aes.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Implementation based on https://github.com/boppreh/aes/blob/master/aes.py</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is an exercise in secure symmetric-key encryption, implemented in pure</span></span><br><span class="line"><span class="string">Python (no external libraries needed).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Original AES-128 implementation by Bo Zhu (http://about.bozhu.me) at </span></span><br><span class="line"><span class="string">https://github.com/bozhu/AES-Python . PKCS#7 padding, CBC mode, PKBDF2, HMAC,</span></span><br><span class="line"><span class="string">byte array and string support added by me at https://github.com/boppreh/aes. </span></span><br><span class="line"><span class="string">Other block modes contributed by @righthandabacus.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Although this is an exercise, the `encrypt` and `decrypt` functions should</span></span><br><span class="line"><span class="string">provide reasonable security to encrypted messages.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s_box = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">inv_s_box = (</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line">    <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line">    <span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line">    <span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line">    <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = inv_s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] ^= k[i][j]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># learned from https://web.archive.org/web/20100626212235/http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c</span></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.3 in The Design of Rijndael</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">        v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">        s[i][<span class="number">0</span>] ^= u</span><br><span class="line">        s[i][<span class="number">1</span>] ^= v</span><br><span class="line">        s[i][<span class="number">2</span>] ^= u</span><br><span class="line">        s[i][<span class="number">3</span>] ^= v</span><br><span class="line"></span><br><span class="line">    mix_columns(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r_con = (</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x4D</span>, <span class="number">0x9A</span>,</span><br><span class="line">    <span class="number">0x2F</span>, <span class="number">0x5E</span>, <span class="number">0xBC</span>, <span class="number">0x63</span>, <span class="number">0xC6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6A</span>,</span><br><span class="line">    <span class="number">0xD4</span>, <span class="number">0xB3</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0xEF</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(matrix, []))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Returns a new byte array with the elements xor&#x27;ed. &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AES</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Class for AES-128 encryption with CBC mode and PKCS#7.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This is a raw implementation of AES, without key stretching or IV</span></span><br><span class="line"><span class="string">    management. Unless you need that, please use `encrypt` and `decrypt`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    rounds_by_key_size = &#123;<span class="number">16</span>: <span class="number">10</span>, <span class="number">24</span>: <span class="number">12</span>, <span class="number">32</span>: <span class="number">14</span>&#125;</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, master_key, backdoor = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Initializes the object with a given key.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(master_key) <span class="keyword">in</span> AES.rounds_by_key_size</span><br><span class="line">        self.n_rounds = AES.rounds_by_key_size[<span class="built_in">len</span>(master_key)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 😈 backdoored by crazyman</span></span><br><span class="line">        <span class="comment"># ===</span></span><br><span class="line">        <span class="keyword">if</span> backdoor <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: </span><br><span class="line">            self.n_rounds = (self.n_rounds &amp; <span class="number">0b1010</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        self._key_matrices = self._expand_key(master_key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        operations = []</span><br><span class="line"></span><br><span class="line">        operations.extend([</span><br><span class="line">            (add_round_key, self._key_matrices[<span class="number">0</span>])</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, self.n_rounds):</span><br><span class="line">            operations.extend([</span><br><span class="line">                (sub_bytes, ),</span><br><span class="line">                (shift_rows, ),</span><br><span class="line">                (mix_columns, ),</span><br><span class="line">                (add_round_key, self._key_matrices[i])</span><br><span class="line">            ])</span><br><span class="line"></span><br><span class="line">        operations.extend([</span><br><span class="line">            (sub_bytes, ),</span><br><span class="line">            (shift_rows, ),</span><br><span class="line">            (add_round_key, self._key_matrices[-<span class="number">1</span>])</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        self.operations = operations</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">self, master_key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Expands and returns a list of key matrices for the given master_key.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Initialize round keys with raw key material.</span></span><br><span class="line">        key_columns = bytes2matrix(master_key)</span><br><span class="line">        iteration_size = <span class="built_in">len</span>(master_key) // <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(key_columns) &lt; (self.n_rounds + <span class="number">1</span>) * <span class="number">4</span>:</span><br><span class="line">            <span class="comment"># Copy previous word.</span></span><br><span class="line">            word = <span class="built_in">list</span>(key_columns[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Perform schedule_core once every &quot;row&quot;.</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># Circular shift.</span></span><br><span class="line">                word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">                <span class="comment"># Map to S-BOX.</span></span><br><span class="line">                word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line">                <span class="comment"># XOR with first byte of R-CON, since the others bytes of R-CON are 0.</span></span><br><span class="line">                word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(master_key) == <span class="number">32</span> <span class="keyword">and</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">4</span>:</span><br><span class="line">                <span class="comment"># Run word through S-box in the fourth iteration when using a</span></span><br><span class="line">                <span class="comment"># 256-bit key.</span></span><br><span class="line">                word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># XOR with equivalent word from previous iteration.</span></span><br><span class="line">            word = xor_bytes(word, key_columns[-iteration_size])</span><br><span class="line">            key_columns.append(word)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Group key words in 4x4 byte matrices.</span></span><br><span class="line">        <span class="keyword">return</span> [key_columns[<span class="number">4</span>*i : <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_columns) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Encrypts a single block of 16 byte long plaintext.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(plaintext) == <span class="number">16</span></span><br><span class="line"></span><br><span class="line">        plain_state = bytes2matrix(plaintext)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> operation, *args <span class="keyword">in</span> self.operations:</span><br><span class="line">            operation(plain_state, *args)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matrix2bytes(plain_state)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>server.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> aes <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>([x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a * <span class="number">2</span>, b)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HAeSH</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key</span>):</span><br><span class="line">        self.state = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">16</span> </span><br><span class="line">        self.key = key</span><br><span class="line">        self.blocks = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, block, backdoor = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(block) == <span class="number">16</span> <span class="keyword">or</span> <span class="built_in">len</span>(block) == <span class="number">24</span> <span class="keyword">or</span> <span class="built_in">len</span>(block) == <span class="number">32</span>, <span class="string">&quot;🚫 Block length should be 16,24,32&quot;</span></span><br><span class="line">        self.blocks.append(block)</span><br><span class="line">        mid_state = xor(self.state, block) </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.blocks) &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">assert</span> mid_state <span class="keyword">not</span> <span class="keyword">in</span> self.blocks, <span class="string">&quot;🚫 Block repetition detected&quot;</span></span><br><span class="line">        self.state = xor(self.state, </span><br><span class="line">                         AES(mid_state, backdoor).</span><br><span class="line">                         encrypt_block(self.key))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">digest</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.state</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blocks_length_check</span>(<span class="params">blocks</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(blocks) &lt;= <span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(blocks[-<span class="number">1</span>]) == <span class="built_in">len</span>(blocks[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">&#x27;🔑: &#x27;</span>))</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(key) == <span class="number">16</span>, <span class="string">&quot;Key length should be 16&quot;</span> </span><br><span class="line">    <span class="built_in">hash</span> = HAeSH(key)</span><br><span class="line">    blocks = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;HAeSH&quot;</span>[<span class="number">2</span>:<span class="number">4</span>]:</span><br><span class="line">        block = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">f&quot;🥢[<span class="subst">&#123;_&#125;</span>]: &quot;</span>))</span><br><span class="line">        <span class="built_in">hash</span>.update(block, <span class="literal">True</span>) </span><br><span class="line">        blocks.append(block)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> blocks_length_check(blocks):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;🚫 Block length mismatch&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        quit_option = <span class="built_in">input</span>(<span class="string">&quot;🔚 Quit? (y/n): &quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> quit_option == <span class="string">&quot;y&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span>.digest() == <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">16</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;🔓 Success!&quot;</span>) </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;🏁 <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;🔒 Failed!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>注意到第一轮结束时 state &#x3D; <code>E_k(block1)</code></p>
<p>最后要求state &#x3D; <code>b&quot;\x00&quot;*16</code>，那么我们就构造一个<code>block1 = D_k(b&quot;\x00&quot;*16)</code>使得<code>b&quot;\x00&quot;*16 = E_k(block1)</code></p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/2.png"></p>
<p>这里有个坑点是，他用的是block1加密key，而非用key加密block1。</p>
<p>构造的话，根据9轮AES去逆就好了。</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Implementation based on https://github.com/boppreh/aes/blob/master/aes.py</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is an exercise in secure symmetric-key encryption, implemented in pure</span></span><br><span class="line"><span class="string">Python (no external libraries needed).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Original AES-128 implementation by Bo Zhu (http://about.bozhu.me) at </span></span><br><span class="line"><span class="string">https://github.com/bozhu/AES-Python . PKCS#7 padding, CBC mode, PKBDF2, HMAC,</span></span><br><span class="line"><span class="string">byte array and string support added by me at https://github.com/boppreh/aes. </span></span><br><span class="line"><span class="string">Other block modes contributed by @righthandabacus.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Although this is an exercise, the `encrypt` and `decrypt` functions should</span></span><br><span class="line"><span class="string">provide reasonable security to encrypted messages.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s_box = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">inv_s_box = (</span><br><span class="line">    <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6A</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xA5</span>, <span class="number">0x38</span>, <span class="number">0xBF</span>, <span class="number">0x40</span>, <span class="number">0xA3</span>, <span class="number">0x9E</span>, <span class="number">0x81</span>, <span class="number">0xF3</span>, <span class="number">0xD7</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0x7C</span>, <span class="number">0xE3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9B</span>, <span class="number">0x2F</span>, <span class="number">0xFF</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8E</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xC4</span>, <span class="number">0xDE</span>, <span class="number">0xE9</span>, <span class="number">0xCB</span>,</span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x7B</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xA6</span>, <span class="number">0xC2</span>, <span class="number">0x23</span>, <span class="number">0x3D</span>, <span class="number">0xEE</span>, <span class="number">0x4C</span>, <span class="number">0x95</span>, <span class="number">0x0B</span>, <span class="number">0x42</span>, <span class="number">0xFA</span>, <span class="number">0xC3</span>, <span class="number">0x4E</span>,</span><br><span class="line">    <span class="number">0x08</span>, <span class="number">0x2E</span>, <span class="number">0xA1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xD9</span>, <span class="number">0x24</span>, <span class="number">0xB2</span>, <span class="number">0x76</span>, <span class="number">0x5B</span>, <span class="number">0xA2</span>, <span class="number">0x49</span>, <span class="number">0x6D</span>, <span class="number">0x8B</span>, <span class="number">0xD1</span>, <span class="number">0x25</span>,</span><br><span class="line">    <span class="number">0x72</span>, <span class="number">0xF8</span>, <span class="number">0xF6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xD4</span>, <span class="number">0xA4</span>, <span class="number">0x5C</span>, <span class="number">0xCC</span>, <span class="number">0x5D</span>, <span class="number">0x65</span>, <span class="number">0xB6</span>, <span class="number">0x92</span>,</span><br><span class="line">    <span class="number">0x6C</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xFD</span>, <span class="number">0xED</span>, <span class="number">0xB9</span>, <span class="number">0xDA</span>, <span class="number">0x5E</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xA7</span>, <span class="number">0x8D</span>, <span class="number">0x9D</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x00</span>, <span class="number">0x8C</span>, <span class="number">0xBC</span>, <span class="number">0xD3</span>, <span class="number">0x0A</span>, <span class="number">0xF7</span>, <span class="number">0xE4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xB8</span>, <span class="number">0xB3</span>, <span class="number">0x45</span>, <span class="number">0x06</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0x2C</span>, <span class="number">0x1E</span>, <span class="number">0x8F</span>, <span class="number">0xCA</span>, <span class="number">0x3F</span>, <span class="number">0x0F</span>, <span class="number">0x02</span>, <span class="number">0xC1</span>, <span class="number">0xAF</span>, <span class="number">0xBD</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8A</span>, <span class="number">0x6B</span>,</span><br><span class="line">    <span class="number">0x3A</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4F</span>, <span class="number">0x67</span>, <span class="number">0xDC</span>, <span class="number">0xEA</span>, <span class="number">0x97</span>, <span class="number">0xF2</span>, <span class="number">0xCF</span>, <span class="number">0xCE</span>, <span class="number">0xF0</span>, <span class="number">0xB4</span>, <span class="number">0xE6</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x96</span>, <span class="number">0xAC</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xE7</span>, <span class="number">0xAD</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xE2</span>, <span class="number">0xF9</span>, <span class="number">0x37</span>, <span class="number">0xE8</span>, <span class="number">0x1C</span>, <span class="number">0x75</span>, <span class="number">0xDF</span>, <span class="number">0x6E</span>,</span><br><span class="line">    <span class="number">0x47</span>, <span class="number">0xF1</span>, <span class="number">0x1A</span>, <span class="number">0x71</span>, <span class="number">0x1D</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x89</span>, <span class="number">0x6F</span>, <span class="number">0xB7</span>, <span class="number">0x62</span>, <span class="number">0x0E</span>, <span class="number">0xAA</span>, <span class="number">0x18</span>, <span class="number">0xBE</span>, <span class="number">0x1B</span>,</span><br><span class="line">    <span class="number">0xFC</span>, <span class="number">0x56</span>, <span class="number">0x3E</span>, <span class="number">0x4B</span>, <span class="number">0xC6</span>, <span class="number">0xD2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9A</span>, <span class="number">0xDB</span>, <span class="number">0xC0</span>, <span class="number">0xFE</span>, <span class="number">0x78</span>, <span class="number">0xCD</span>, <span class="number">0x5A</span>, <span class="number">0xF4</span>,</span><br><span class="line">    <span class="number">0x1F</span>, <span class="number">0xDD</span>, <span class="number">0xA8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xC7</span>, <span class="number">0x31</span>, <span class="number">0xB1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7F</span>, <span class="number">0xA9</span>, <span class="number">0x19</span>, <span class="number">0xB5</span>, <span class="number">0x4A</span>, <span class="number">0x0D</span>, <span class="number">0x2D</span>, <span class="number">0xE5</span>, <span class="number">0x7A</span>, <span class="number">0x9F</span>, <span class="number">0x93</span>, <span class="number">0xC9</span>, <span class="number">0x9C</span>, <span class="number">0xEF</span>,</span><br><span class="line">    <span class="number">0xA0</span>, <span class="number">0xE0</span>, <span class="number">0x3B</span>, <span class="number">0x4D</span>, <span class="number">0xAE</span>, <span class="number">0x2A</span>, <span class="number">0xF5</span>, <span class="number">0xB0</span>, <span class="number">0xC8</span>, <span class="number">0xEB</span>, <span class="number">0xBB</span>, <span class="number">0x3C</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span>,</span><br><span class="line">    <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x04</span>, <span class="number">0x7E</span>, <span class="number">0xBA</span>, <span class="number">0x77</span>, <span class="number">0xD6</span>, <span class="number">0x26</span>, <span class="number">0xE1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0C</span>, <span class="number">0x7D</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] = inv_s_box[s[i][j]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">s, k</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            s[i][j] ^= k[i][j]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># learned from https://web.archive.org/web/20100626212235/http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.c</span></span><br><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_single_column</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.2 in The Design of Rijndael</span></span><br><span class="line">    t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">    u = a[<span class="number">0</span>]</span><br><span class="line">    a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">    a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">    a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">    a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        mix_single_column(s[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="comment"># see Sec 4.1.3 in The Design of Rijndael</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">        v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">        s[i][<span class="number">0</span>] ^= u</span><br><span class="line">        s[i][<span class="number">1</span>] ^= v</span><br><span class="line">        s[i][<span class="number">2</span>] ^= u</span><br><span class="line">        s[i][<span class="number">3</span>] ^= v</span><br><span class="line"></span><br><span class="line">    mix_columns(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r_con = (</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>,</span><br><span class="line">    <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span>, <span class="number">0x6C</span>, <span class="number">0xD8</span>, <span class="number">0xAB</span>, <span class="number">0x4D</span>, <span class="number">0x9A</span>,</span><br><span class="line">    <span class="number">0x2F</span>, <span class="number">0x5E</span>, <span class="number">0xBC</span>, <span class="number">0x63</span>, <span class="number">0xC6</span>, <span class="number">0x97</span>, <span class="number">0x35</span>, <span class="number">0x6A</span>,</span><br><span class="line">    <span class="number">0xD4</span>, <span class="number">0xB3</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0xEF</span>, <span class="number">0xC5</span>, <span class="number">0x91</span>, <span class="number">0x39</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i+<span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array.  &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">sum</span>(matrix, []))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Returns a new byte array with the elements xor&#x27;ed. &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AES</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Class for AES-128 encryption with CBC mode and PKCS#7.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This is a raw implementation of AES, without key stretching or IV</span></span><br><span class="line"><span class="string">    management. Unless you need that, please use `encrypt` and `decrypt`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    rounds_by_key_size = &#123;<span class="number">16</span>: <span class="number">10</span>, <span class="number">24</span>: <span class="number">12</span>, <span class="number">32</span>: <span class="number">14</span>&#125;</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, master_key, backdoor = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Initializes the object with a given key.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(master_key) <span class="keyword">in</span> AES.rounds_by_key_size</span><br><span class="line">        self.n_rounds = AES.rounds_by_key_size[<span class="built_in">len</span>(master_key)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 😈 backdoored by crazyman</span></span><br><span class="line">        <span class="comment"># ===</span></span><br><span class="line">        <span class="keyword">if</span> backdoor <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: </span><br><span class="line">            self.n_rounds = (self.n_rounds &amp; <span class="number">0b1010</span>) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        self._key_matrices = self._expand_key(master_key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">self, master_key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Expands and returns a list of key matrices for the given master_key.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># Initialize round keys with raw key material.</span></span><br><span class="line">        key_columns = bytes2matrix(master_key)</span><br><span class="line">        iteration_size = <span class="built_in">len</span>(master_key) // <span class="number">4</span></span><br><span class="line"></span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(key_columns) &lt; (self.n_rounds + <span class="number">1</span>) * <span class="number">4</span>:</span><br><span class="line">            <span class="comment"># Copy previous word.</span></span><br><span class="line">            word = <span class="built_in">list</span>(key_columns[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Perform schedule_core once every &quot;row&quot;.</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># Circular shift.</span></span><br><span class="line">                word.append(word.pop(<span class="number">0</span>))</span><br><span class="line">                <span class="comment"># Map to S-BOX.</span></span><br><span class="line">                word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line">                <span class="comment"># XOR with first byte of R-CON, since the others bytes of R-CON are 0.</span></span><br><span class="line">                word[<span class="number">0</span>] ^= r_con[i]</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">len</span>(master_key) == <span class="number">32</span> <span class="keyword">and</span> <span class="built_in">len</span>(key_columns) % iteration_size == <span class="number">4</span>:</span><br><span class="line">                <span class="comment"># Run word through S-box in the fourth iteration when using a</span></span><br><span class="line">                <span class="comment"># 256-bit key.</span></span><br><span class="line">                word = [s_box[b] <span class="keyword">for</span> b <span class="keyword">in</span> word]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># XOR with equivalent word from previous iteration.</span></span><br><span class="line">            word = xor_bytes(word, key_columns[-iteration_size])</span><br><span class="line">            key_columns.append(word)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Group key words in 4x4 byte matrices.</span></span><br><span class="line">        <span class="keyword">return</span> [key_columns[<span class="number">4</span>*i : <span class="number">4</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_columns) // <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Encrypts a single block of 16 byte long plaintext.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(plaintext) == <span class="number">16</span></span><br><span class="line">        operations = []</span><br><span class="line"></span><br><span class="line">        operations.extend([</span><br><span class="line">            (add_round_key, self._key_matrices[<span class="number">0</span>])</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, self.n_rounds):</span><br><span class="line">            operations.extend([</span><br><span class="line">                (sub_bytes, ),</span><br><span class="line">                (shift_rows, ),</span><br><span class="line">                (mix_columns, ),</span><br><span class="line">                (add_round_key, self._key_matrices[i])</span><br><span class="line">            ])</span><br><span class="line"></span><br><span class="line">        operations.extend([</span><br><span class="line">            (sub_bytes, ),</span><br><span class="line">            (shift_rows, ),</span><br><span class="line">            (add_round_key, self._key_matrices[-<span class="number">1</span>])</span><br><span class="line">        ])</span><br><span class="line">        </span><br><span class="line">        self.operations = operations</span><br><span class="line">        plain_state = bytes2matrix(plaintext)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> operation, *args <span class="keyword">in</span> self.operations:</span><br><span class="line">            operation(plain_state, *args)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matrix2bytes(plain_state)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Encrypts a single block of 16 byte long plaintext.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(ciphertext) == <span class="number">16</span></span><br><span class="line">        <span class="built_in">print</span>(ciphertext)</span><br><span class="line">        operations = []</span><br><span class="line"></span><br><span class="line">        operations.extend([</span><br><span class="line">            (add_round_key, self._key_matrices[-<span class="number">1</span>])</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, self.n_rounds):</span><br><span class="line">            operations.extend([</span><br><span class="line">                (inv_shift_rows, ),</span><br><span class="line">                (inv_sub_bytes, ),</span><br><span class="line">                (add_round_key, self._key_matrices[self.n_rounds-i]),</span><br><span class="line">                (inv_mix_columns,)</span><br><span class="line">            ])</span><br><span class="line"></span><br><span class="line">        operations.extend([</span><br><span class="line">            (inv_shift_rows, ),</span><br><span class="line">            (inv_sub_bytes, ),</span><br><span class="line">            (add_round_key, self._key_matrices[<span class="number">0</span>])</span><br><span class="line">        ])</span><br><span class="line">        </span><br><span class="line">        self.operations = operations</span><br><span class="line">        cipher_state = bytes2matrix(ciphertext)</span><br><span class="line">        <span class="keyword">for</span> operation, *args <span class="keyword">in</span> self.operations:</span><br><span class="line">            operation(cipher_state, *args)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matrix2bytes(cipher_state)</span><br><span class="line">    </span><br><span class="line">key = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;00000000000000000000000000000000&#x27;</span>)</span><br><span class="line">aes = AES(key,backdoor=<span class="literal">True</span>)</span><br><span class="line">ciphertext = <span class="string">b&quot;\x00&quot;</span>*<span class="number">16</span></span><br><span class="line">m = aes.decrypt_block(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(m.<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment"># 1ce3875ccc5613de0c4025effc27db77</span></span><br></pre></td></tr></table></figure>

<p>手动交互即可</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/2.png"></p>
<h3 id="fak1"><a href="#fak1" class="headerlink" title="fak1"></a>fak1</h3><blockquote>
<p>ntru.sage</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">p,n,q,dg,df = <span class="number">3</span>,<span class="number">117</span>,<span class="number">1091</span>,<span class="number">35</span>,<span class="number">37</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">RR.&lt;xx&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">QR = R.quotient(x ^ n + <span class="number">1</span>)</span><br><span class="line">QRR = RR.quotient(xx ^ n + <span class="number">1</span>)</span><br><span class="line">flag = <span class="string">b&quot;flag&#123;*******************************************&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">balancemodlist</span>(<span class="params"><span class="type">List</span>,p</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="type">List</span>)):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(<span class="type">List</span>[i]) &gt; p / <span class="number">2</span>:</span><br><span class="line">            <span class="type">List</span>[i] = <span class="built_in">int</span>(<span class="type">List</span>[i]) - p</span><br><span class="line">    <span class="keyword">return</span> <span class="type">List</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randomPoly</span>(<span class="params">d = <span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        poly = QR([random.randint(<span class="number">0</span>,<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        L_0 = [<span class="number">0</span>] * (n - <span class="number">2</span> * d - <span class="number">1</span>)</span><br><span class="line">        L_1 = (d + <span class="number">1</span>) * [<span class="number">1</span>]</span><br><span class="line">        L_2 = d * [-<span class="number">1</span>]</span><br><span class="line">        L = L_0 + L_1 + L_2</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(randint(<span class="number">5</span>,<span class="number">10</span>)):</span><br><span class="line">            random.shuffle(L)</span><br><span class="line">        poly = QR(L)</span><br><span class="line">    <span class="keyword">return</span> poly</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genPrivKey</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        poly = randomPoly(df)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            poly_q = (<span class="number">1</span> / QR(poly))</span><br><span class="line">            poly_p = (<span class="number">1</span> / QRR(RR(balancemodlist(poly.<span class="built_in">list</span>(),q))))   </span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">return</span> poly, poly_q, poly_p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MsgtoPoly</span>(<span class="params">msg</span>):</span><br><span class="line">    msg = Integer(bytes_to_long(msg))</span><br><span class="line">    m = msg.digits(p)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">        <span class="keyword">if</span> m[i] &gt; p / <span class="number">2</span>:</span><br><span class="line">            m[i] -= p</span><br><span class="line">    <span class="keyword">return</span> QR(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKeys</span>():</span><br><span class="line">    f, f_q, f_p = genPrivKey()</span><br><span class="line">    g = randomPoly(dg)</span><br><span class="line">    pk = QR(p * g * f_q)</span><br><span class="line">    sk = (f,f_q,f_p,g)</span><br><span class="line">    <span class="keyword">return</span> pk,sk</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">pk, m</span>):</span><br><span class="line">    r = randomPoly()</span><br><span class="line">    <span class="keyword">return</span> pk * r + m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">sk,c</span>):</span><br><span class="line">    f,_,f_p,_ = sk</span><br><span class="line">    m = QR(balancemodlist((QRR(balancemodlist((f * c).<span class="built_in">list</span>(),q)) * f_p).<span class="built_in">list</span>(),p))</span><br><span class="line">    <span class="keyword">return</span> m</span><br></pre></td></tr></table></figure>

<blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_handle_timeout</span>(<span class="params">signum, frame</span>):</span><br><span class="line">    <span class="keyword">raise</span> TimeoutError(<span class="string">&#x27;function timeout&#x27;</span>)</span><br><span class="line"></span><br><span class="line">timeout = <span class="number">60</span></span><br><span class="line">signal.signal(signal.SIGALRM, _handle_timeout)</span><br><span class="line">signal.alarm(timeout)</span><br><span class="line"></span><br><span class="line">load(<span class="string">&quot;ntru.sage&quot;</span>)</span><br><span class="line">p,n,q,dg,df = <span class="number">3</span>,<span class="number">117</span>,<span class="number">1091</span>,<span class="number">35</span>,<span class="number">37</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cs = []</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Game</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        pk,sk = genKeys()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="number">1</span> / pk</span><br><span class="line">            <span class="built_in">print</span>(pk.<span class="built_in">list</span>())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">                </span><br><span class="line">    secret = os.urandom(<span class="number">23</span>)</span><br><span class="line">    secretPoly = MsgtoPoly(secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to fak1. You can send some message to me. Have fun!&quot;</span>)</span><br><span class="line">    msgs = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">116</span>)]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        msg = [<span class="built_in">round</span>(<span class="built_in">int</span>(i,<span class="number">16</span>) % <span class="number">3329</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">input</span>(<span class="string">&quot;Give me a list of message (hex):&quot;</span>).split(<span class="string">&quot; &quot;</span>)]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(msg) != <span class="number">116</span> <span class="keyword">or</span> (msg <span class="keyword">in</span> msgs):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You bad!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        msgs.append(msg)</span><br><span class="line">        m = secretPoly + QR([<span class="built_in">round</span>(i / <span class="number">3329</span> * q) <span class="keyword">for</span> i <span class="keyword">in</span> msg])</span><br><span class="line">        c = encrypt(pk,m)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">assert</span> m == decrypt(sk,c)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You bad!!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="built_in">print</span>(c.<span class="built_in">list</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> long_to_bytes(<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;You wanner say something? :&quot;</span>), <span class="number">16</span>)) == secret:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You good!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;OK, bye bye~&quot;</span>) </span><br><span class="line"></span><br><span class="line">Game()</span><br></pre></td></tr></table></figure>

<p>由加密可知<br>$$<br>C_i &#x3D; pk \times r_i + m_i<br>$$<br>记$m_i &#x3D; Secret + M_i$，$M_i$为用户输入的明文</p>
<p>取两组进行分析<br>$$<br>C_i &#x3D; pk\times r_i + m_i<br>$$</p>
<p>$$<br>C_j &#x3D; pk\times r_j + m_j<br>$$</p>
<p>两式相减<br>$$<br>C_i - C_j &#x3D; pk(r_i - r_j) + (m_i + m_j)<br>$$</p>
<p>$$<br>\therefore C_i - C_j &#x3D; pk(r_i - r_j) + (M_i - M_j)<br>$$</p>
<p>我们可以计算出$r_i - r_j$的值<br>$$<br>r_i - r_j &#x3D; ((C_i - C_j) - (M_i - M_j))\times pk^{-1}<br>$$<br>$r_i,r_j$的系数为0，1。然后讨论$r_i - r_j$的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">当ri - rj = 0的时候，有可能为0-0，也有可能1-1</span><br><span class="line">当ri - rj = 1的时候，只可能是1-0，这样可以确定ri是1</span><br><span class="line">当ri - rj = -1的时候，只可能是0-1，这样可以确定ri是0</span><br></pre></td></tr></table></figure>

<p>我们可以有9组这样的值，很大概率能够恢复$r_i$。恢复$r_i$之后通过$C_i &#x3D; pk\times r_i + (Secret + M_i)$恢复Secret</p>
<p>测试了一下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">p,n,q,dg,df = <span class="number">3</span>,<span class="number">117</span>,<span class="number">1091</span>,<span class="number">35</span>,<span class="number">37</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">RR.&lt;xx&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">QR = R.quotient(x ^ n + <span class="number">1</span>)</span><br><span class="line">QRR = RR.quotient(xx ^ n + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密钥生成</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    pk,sk = genKeys()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="number">1</span> / pk</span><br><span class="line">        <span class="comment"># print(pk.list())</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">secret = os.urandom(<span class="number">23</span>)</span><br><span class="line">secretPoly = MsgtoPoly(secret)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;secret = <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">input_msgs = [[randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">116</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">msgs = [QR([<span class="built_in">round</span>(<span class="built_in">int</span>(i) / <span class="number">3329</span> * q) <span class="keyword">for</span> i <span class="keyword">in</span> msg]) <span class="keyword">for</span> msg <span class="keyword">in</span> msgs]</span><br><span class="line">Cs = [encrypt(pk,secretPoly + m) <span class="keyword">for</span> m <span class="keyword">in</span> msgs]</span><br><span class="line"></span><br><span class="line"><span class="comment"># r0 - ri</span></span><br><span class="line">Tmp = []</span><br><span class="line">C0 = Cs[<span class="number">0</span>]</span><br><span class="line">M0 = msgs[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    t = ((C0 - Cs[i]) - (M0 - msgs[i])) * pk^(-<span class="number">1</span>)</span><br><span class="line">    Tmp.append(t)</span><br><span class="line">    </span><br><span class="line">r0 = [<span class="string">&#x27;?&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">117</span>)]</span><br><span class="line"><span class="keyword">for</span> tmp <span class="keyword">in</span> Tmp:</span><br><span class="line">    t = tmp.<span class="built_in">list</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">        <span class="keyword">if</span> t[i] == <span class="number">1</span>:</span><br><span class="line">            r0[i] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> t[i] == <span class="number">1090</span>:</span><br><span class="line">            r0[i] = <span class="number">0</span></span><br><span class="line">r0 = QRR(r0)</span><br><span class="line">secret_poly = C0 - M0 - r0*pk</span><br><span class="line">s = secret_poly.<span class="built_in">list</span>()</span><br><span class="line">ss = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">1090</span>):</span><br><span class="line">        ss.append(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ss.append(i)</span><br><span class="line">secret = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ss)):</span><br><span class="line">    secret += <span class="built_in">int</span>(<span class="number">3</span>^i*<span class="built_in">int</span>(ss[i]))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(secret))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p,n,q,dg,df = <span class="number">3</span>,<span class="number">117</span>,<span class="number">1091</span>,<span class="number">35</span>,<span class="number">37</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">RR.&lt;xx&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">QR = R.quotient(x ^ n + <span class="number">1</span>)</span><br><span class="line">QRR = RR.quotient(xx ^ n + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">input_msgs = [[randint(<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">116</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line">send_msgs = [<span class="string">&quot; &quot;</span>.join([<span class="built_in">hex</span>(i)[<span class="number">2</span>:].zfill(<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> msg]) <span class="keyword">for</span> msg <span class="keyword">in</span> input_msgs]</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;47.94.85.95&quot;</span>,<span class="number">30833</span>)</span><br><span class="line">pk = <span class="built_in">eval</span>(sh.recvline().strip().decode())</span><br><span class="line">pk = QRR(pk)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Welcome to nntru. You can send some message to me. Have fun!&quot;</span>)</span><br><span class="line">Cs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Give me a list of message (hex):&quot;</span>)</span><br><span class="line">    sh.sendline(send_msgs[i].encode())</span><br><span class="line">    c = QRR(<span class="built_in">eval</span>(sh.recvline().strip().decode()))</span><br><span class="line">    Cs.append(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># r0 - ri</span></span><br><span class="line">TMP = []</span><br><span class="line">C0 = Cs[<span class="number">0</span>]</span><br><span class="line">M0 = msgs[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">    t = ((C0 - Cs[i]) - (M0 - msgs[i])) * pk^(-<span class="number">1</span>)</span><br><span class="line">    TMP.append(t)</span><br><span class="line">    </span><br><span class="line">r0 = [<span class="string">&#x27;?&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">117</span>)]</span><br><span class="line"><span class="keyword">for</span> tmp <span class="keyword">in</span> TMP:</span><br><span class="line">    t = tmp.<span class="built_in">list</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(t)):</span><br><span class="line">        <span class="keyword">if</span> t[i] == <span class="number">1</span>:</span><br><span class="line">            r0[i] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> t[i] == <span class="number">1090</span>:</span><br><span class="line">            r0[i] = <span class="number">0</span></span><br><span class="line">r0 = QRR(r0)</span><br><span class="line"></span><br><span class="line">secret_poly = C0 - M0 - r0*pk</span><br><span class="line">secret_num = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> secret_poly.<span class="built_in">list</span>():</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">1090</span>:                   <span class="comment"># -1就是2</span></span><br><span class="line">        secret_num.append(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        secret_num.append(i)</span><br><span class="line">        </span><br><span class="line">secret = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret_num)):</span><br><span class="line">    secret += <span class="built_in">int</span>(<span class="number">3</span>^i*<span class="built_in">int</span>(secret_num[i]))</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;You wanner say something? :&quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">hex</span>(secret)[<span class="number">2</span>:].encode())</span><br><span class="line"><span class="built_in">print</span>(sh.recvline().strip().decode())</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/4.png"></p>
<h3 id="f2ke——unsolved"><a href="#f2ke——unsolved" class="headerlink" title="f2ke——unsolved"></a>f2ke——unsolved</h3><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_handle_timeout</span>(<span class="params">signum, frame</span>):</span><br><span class="line">    <span class="keyword">raise</span> TimeoutError(<span class="string">&#x27;function timeout&#x27;</span>)</span><br><span class="line"></span><br><span class="line">timeout = <span class="number">70</span></span><br><span class="line">signal.signal(signal.SIGALRM, _handle_timeout)</span><br><span class="line">signal.alarm(timeout)</span><br><span class="line"></span><br><span class="line">load(<span class="string">&quot;ntru.sage&quot;</span>)</span><br><span class="line">p,n,q,dg,df = <span class="number">3</span>,<span class="number">117</span>,<span class="number">1091</span>,<span class="number">35</span>,<span class="number">37</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Game</span>():</span><br><span class="line">    secret = os.urandom(<span class="number">23</span>)</span><br><span class="line">    secretpoly = MsgtoPoly(secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Welcome to f2ke. You can send some message to me. Have fun!&quot;</span>)</span><br><span class="line">    msgs = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">116</span>)]]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>((n + <span class="number">3</span>) // <span class="number">2</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            pk,sk = genKeys()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="number">1</span> / pk</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">        msg = [<span class="built_in">round</span>(<span class="built_in">int</span>(i,<span class="number">16</span>) % <span class="number">3329</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">input</span>(<span class="string">&quot;Give me a list of message (hex):&quot;</span>).split(<span class="string">&quot; &quot;</span>)]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(msg) != <span class="number">116</span> <span class="keyword">or</span> (msg <span class="keyword">in</span> msgs):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You bad!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        msgs.append(msg)</span><br><span class="line">        m = secretpoly + QR([<span class="built_in">round</span>(i / <span class="number">3329</span> * q) <span class="keyword">for</span> i <span class="keyword">in</span> msg])</span><br><span class="line">        c = encrypt(pk,m)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">assert</span> m == decrypt(sk,c)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You bad!!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="built_in">print</span>(c.<span class="built_in">list</span>())</span><br><span class="line">        <span class="built_in">print</span>(pk.<span class="built_in">list</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> long_to_bytes(<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;You wanner say something? :&quot;</span>), <span class="number">16</span>)) == secret:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You good!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;OK, bye bye~&quot;</span>) </span><br><span class="line"></span><br><span class="line">Game()</span><br></pre></td></tr></table></figure>

<h3 id="Signin——unsolved"><a href="#Signin——unsolved" class="headerlink" title="Signin——unsolved"></a>Signin——unsolved</h3><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">7</span></span><br><span class="line">gx = <span class="number">0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798</span></span><br><span class="line">gy = <span class="number">0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8</span></span><br><span class="line">order = <span class="number">0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141</span></span><br><span class="line"></span><br><span class="line">zero = (<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">G = (gx, gy)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">p1, p2</span>):</span><br><span class="line">    <span class="keyword">if</span> p1 == zero:</span><br><span class="line">        <span class="keyword">return</span> p2</span><br><span class="line">    <span class="keyword">if</span> p2 == zero:</span><br><span class="line">        <span class="keyword">return</span> p1</span><br><span class="line">    (p1x, p1y), (p2x, p2y) = p1, p2</span><br><span class="line">    <span class="keyword">if</span> p1x == p2x <span class="keyword">and</span> (p1y != p2y <span class="keyword">or</span> p1y == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> zero</span><br><span class="line">    <span class="keyword">if</span> p1x == p2x:</span><br><span class="line">        tmp = (<span class="number">3</span> * p1x * p1x + a) * inverse(<span class="number">2</span> * p1y, p) % p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp = (p2y - p1y) * inverse(p2x - p1x, p) % p</span><br><span class="line">    x = (tmp * tmp - p1x - p2x) % p</span><br><span class="line">    y = (tmp * (p1x - x) - p1y) % p</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(x), <span class="built_in">int</span>(y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">n, p</span>):</span><br><span class="line">    r = zero</span><br><span class="line">    tmp = p</span><br><span class="line">    <span class="keyword">while</span> <span class="number">0</span> &lt; n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">1</span> == <span class="number">1</span>:</span><br><span class="line">            r = add(r, tmp)</span><br><span class="line">        n, tmp = n &gt;&gt; <span class="number">1</span>, add(tmp, tmp)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg, q, d, G</span>):</span><br><span class="line">    z = <span class="built_in">int</span>(sha256(msg).hexdigest(), <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = randint(<span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">        P = mul(k, G)</span><br><span class="line">        r = P[<span class="number">0</span>]</span><br><span class="line">        s = inverse(k, q) * (z + r * d) % q</span><br><span class="line">        <span class="keyword">if</span> r != <span class="number">0</span> <span class="keyword">and</span> s != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> r, s, k.bit_length()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">sig, msg, q, G, Q</span>):</span><br><span class="line">    r, s = sig</span><br><span class="line">    <span class="built_in">print</span>(r, s)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span> <span class="keyword">or</span> s == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    z = <span class="built_in">int</span>(sha256(msg).hexdigest(), <span class="number">16</span>)</span><br><span class="line">    u1 = z * inverse(s, q) % q</span><br><span class="line">    u2 = r * inverse(s, q) % q</span><br><span class="line">    P = add(mul(u1, G), mul(u2, Q))</span><br><span class="line">    <span class="keyword">return</span> P[<span class="number">0</span>] == r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">signal.alarm(<span class="number">240</span>)</span><br><span class="line">menu = \</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">1.sign</span></span><br><span class="line"><span class="string">2.verify</span></span><br><span class="line"><span class="string">3.exit</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">secret_key = bytes_to_long(urandom(<span class="number">27</span>) + <span class="string">b&quot;qwbs8&quot;</span>)</span><br><span class="line">Q = mul(secret_key, G)</span><br><span class="line"></span><br><span class="line">count = <span class="number">678</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">    <span class="built_in">print</span>(menu)</span><br><span class="line">    op = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>).strip())</span><br><span class="line">    <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">        msg = <span class="built_in">input</span>(<span class="string">&quot;msg: &quot;</span>).strip().encode()</span><br><span class="line">        <span class="keyword">if</span> msg == <span class="string">b&quot;qwbs8_send_flag_to_me&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;another msg plz.&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            r, s, kbits = sign(msg, order, secret_key, G)</span><br><span class="line">            <span class="built_in">print</span>(r, s, kbits)</span><br><span class="line">    <span class="keyword">elif</span> op == <span class="number">2</span>:</span><br><span class="line">        msg = <span class="built_in">input</span>(<span class="string">&quot;msg: &quot;</span>).strip().encode()</span><br><span class="line">        ur = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;r: &quot;</span>).strip())</span><br><span class="line">        us = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;s: &quot;</span>).strip())</span><br><span class="line">        sig = (ur, us)</span><br><span class="line">        <span class="keyword">if</span> verify(sig, msg, order, G, Q):</span><br><span class="line">            <span class="keyword">if</span> msg == <span class="string">b&quot;qwbs8_send_flag_to_me&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;malformed signature.&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<h3 id="b1ock——unsolved"><a href="#b1ock——unsolved" class="headerlink" title="b1ock——unsolved"></a>b1ock——unsolved</h3><blockquote>
<p>des.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># DES S-boxes</span></span><br><span class="line">S_BOXES = [</span><br><span class="line">    <span class="comment"># S1</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S2</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S3</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S4</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S5</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>],</span><br><span class="line">        [<span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>],</span><br><span class="line">        [<span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S6</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>],</span><br><span class="line">        [<span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S7</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>],</span><br><span class="line">        [<span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>]</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment"># S8</span></span><br><span class="line">    [</span><br><span class="line">        [<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>],</span><br><span class="line">        [<span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>]</span><br><span class="line">    ]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initial and Final Permutation tables</span></span><br><span class="line">IP = [<span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">      <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">FP = [<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">      <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">      <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">      <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">      <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">      <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">      <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">      <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># PC-1 - Permuted choice 1</span></span><br><span class="line">PC1 = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,</span><br><span class="line">       <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">       <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">       <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">       <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,</span><br><span class="line">       <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">       <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>,</span><br><span class="line">       <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># PC-2 - Permuted choice 2</span></span><br><span class="line">PC2 = [<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line">       <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line">       <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">26</span>, <span class="number">8</span>,</span><br><span class="line">       <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>,</span><br><span class="line">       <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>,</span><br><span class="line">       <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>,</span><br><span class="line">       <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>,</span><br><span class="line">       <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Left shifts for each round</span></span><br><span class="line">SHIFTS = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">E = [<span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">        <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">        <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">        <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">        <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">        <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">        <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">        <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">P = [<span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">             <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">             <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">             <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_initial_permutate</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># Apply initial permutation</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(block[i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> IP)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_final_permutate</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># Apply final permutation </span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(block[i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> FP)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_exchange_blocks</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># Exchange left and right halves</span></span><br><span class="line">    <span class="keyword">return</span> block[<span class="number">32</span>:<span class="number">64</span>] + block[:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_pbox_permutate</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># P-box permutation</span></span><br><span class="line">    <span class="keyword">return</span> block[<span class="number">0</span>:<span class="number">64</span>] + <span class="string">&quot;&quot;</span>.join(block[<span class="number">64</span>:].zfill(<span class="number">32</span>)[i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> P).zfill(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_sbox_permutate</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># Apply S-boxes</span></span><br><span class="line">    l, r, x = block[<span class="number">0</span>:<span class="number">32</span>], block[<span class="number">32</span>:<span class="number">64</span>], block[<span class="number">64</span>:].zfill(<span class="number">48</span>)</span><br><span class="line">    </span><br><span class="line">    output = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        chunk = x[i*<span class="number">6</span>:(i+<span class="number">1</span>)*<span class="number">6</span>]</span><br><span class="line">        row = <span class="built_in">int</span>(chunk[<span class="number">0</span>] + chunk[<span class="number">5</span>], <span class="number">2</span>)</span><br><span class="line">        col = <span class="built_in">int</span>(chunk[<span class="number">1</span>:<span class="number">5</span>], <span class="number">2</span>)</span><br><span class="line">        output += <span class="built_in">bin</span>(S_BOXES[i][row][col])[<span class="number">2</span>:].zfill(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> l + r + output</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_add_round_key</span>(<span class="params">block, key</span>):</span><br><span class="line">    <span class="comment"># XOR block with key</span></span><br><span class="line">    l, r, er = block[<span class="number">0</span>:<span class="number">32</span>], block[<span class="number">32</span>:<span class="number">64</span>], block[<span class="number">64</span>:].zfill(<span class="number">48</span>)</span><br><span class="line">    <span class="keyword">return</span> l + r + <span class="built_in">bin</span>(<span class="built_in">int</span>(er, <span class="number">2</span>) ^ key)[<span class="number">2</span>:].zfill(<span class="number">48</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_extend_block</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># Extend block to 48 bits</span></span><br><span class="line">    l, r = block[<span class="number">0</span>:<span class="number">32</span>], block[<span class="number">32</span>:<span class="number">64</span>] </span><br><span class="line">    <span class="keyword">return</span> l + r + <span class="string">&#x27;&#x27;</span>.join(r[i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> E)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_xor_blocks</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="comment"># XOR left and right halves</span></span><br><span class="line">    l, r, rr = block[<span class="number">0</span>:<span class="number">32</span>], block[<span class="number">32</span>:<span class="number">64</span>], block[<span class="number">64</span>:<span class="number">96</span>].zfill(<span class="number">32</span>) </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bin</span>(<span class="built_in">int</span>(l,<span class="number">2</span>) ^ <span class="built_in">int</span>(rr,<span class="number">2</span>))[<span class="number">2</span>:].zfill(<span class="number">32</span>) +  r</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DES</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, master_key, rounds=<span class="number">16</span>, backdoor = <span class="literal">None</span></span>):</span><br><span class="line">        R = random.Random()</span><br><span class="line"></span><br><span class="line">        self.rounds = rounds</span><br><span class="line">        self._subkeys = self._expand_key(master_key)</span><br><span class="line">        </span><br><span class="line">        operations = []</span><br><span class="line">        operations.extend([</span><br><span class="line">                (_initial_permutate, ), </span><br><span class="line">        ])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.rounds):</span><br><span class="line">            operations.extend([ </span><br><span class="line">                (_extend_block, ),</span><br><span class="line">                (_add_round_key, self._subkeys[i]),</span><br><span class="line">                (_sbox_permutate, ),</span><br><span class="line">                (_pbox_permutate, ),</span><br><span class="line">                (_xor_blocks, ),</span><br><span class="line">                (_exchange_blocks, ),</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        operations.extend([</span><br><span class="line">                (_exchange_blocks, ),</span><br><span class="line">                (_final_permutate, ),</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 😈 backdoored by CRAZYMAN!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span><br><span class="line">        <span class="keyword">if</span> backdoor:</span><br><span class="line">            R.seed(backdoor)</span><br><span class="line">            operations = R.choices(operations, k = <span class="built_in">len</span>(operations)) </span><br><span class="line"></span><br><span class="line">        self.operations = operations</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_expand_key</span>(<span class="params">self, master_key</span>):</span><br><span class="line">        key_bin = <span class="built_in">bin</span>(<span class="built_in">int</span>.from_bytes(master_key, <span class="string">&#x27;big&#x27;</span>))[<span class="number">2</span>:].zfill(<span class="number">64</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Apply PC-1</span></span><br><span class="line">        key = <span class="string">&#x27;&#x27;</span>.join([key_bin[i - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> PC1])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Split into left and right halves</span></span><br><span class="line">        c = key[:<span class="number">28</span>]</span><br><span class="line">        d = key[<span class="number">28</span>:]</span><br><span class="line">        </span><br><span class="line">        subkeys = [] </span><br><span class="line">        <span class="comment"># Generate subkeys</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="comment"># Left shift</span></span><br><span class="line">            c = c[SHIFTS[i]:] + c[:SHIFTS[i]]</span><br><span class="line">            d = d[SHIFTS[i]:] + d[:SHIFTS[i]]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Combine C and D</span></span><br><span class="line">            cd = c + d</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Apply PC-2</span></span><br><span class="line">            subkey = <span class="string">&#x27;&#x27;</span>.join([cd[i - <span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> PC2])</span><br><span class="line">            subkeys.append(<span class="built_in">int</span>(subkey,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, self.rounds):</span><br><span class="line">            subkeys.append(subkeys[i % <span class="number">16</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> subkeys[:self.rounds]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(plaintext) == <span class="number">8</span></span><br><span class="line">        </span><br><span class="line">        state = <span class="built_in">bin</span>(<span class="built_in">int</span>.from_bytes(plaintext, <span class="string">&#x27;big&#x27;</span>))[<span class="number">2</span>:].zfill(<span class="number">64</span>) </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> operation, *args <span class="keyword">in</span> self.operations: </span><br><span class="line">            state = operation(state, *args)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(state[:<span class="number">64</span>],<span class="number">2</span>).to_bytes(<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>server.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES <span class="keyword">as</span> pyDES</span><br><span class="line"><span class="comment"># from secret import flag</span></span><br><span class="line"><span class="keyword">from</span> des <span class="keyword">import</span> DES  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_handle_timeout</span>(<span class="params">signum, frame</span>):</span><br><span class="line">    <span class="keyword">raise</span> TimeoutError(<span class="string">&#x27;function timeout&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_test</span>():</span><br><span class="line">    key = os.urandom(<span class="number">8</span>)</span><br><span class="line">    des = pyDES.new(key, pyDES.MODE_ECB)</span><br><span class="line">    mydes = DES(key, rounds=<span class="number">16</span>)</span><br><span class="line">    mydes_backdoored = DES(key, rounds=<span class="number">16</span>, backdoor = <span class="number">0xdeadbeef</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        plaintext = os.urandom(<span class="number">8</span>)</span><br><span class="line">        ciphertext = des.encrypt(plaintext) </span><br><span class="line">        <span class="keyword">assert</span> (mydes.encrypt_block(plaintext) == ciphertext) </span><br><span class="line">        <span class="keyword">assert</span> (mydes_backdoored.encrypt_block(plaintext) != ciphertext) </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():  </span><br><span class="line">    seed = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;🌱 &#x27;</span>))</span><br><span class="line">    key = os.urandom(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    cipher = DES(key, rounds = <span class="number">48</span>, backdoor = seed)</span><br><span class="line">    m0 = os.urandom(<span class="number">8</span>)</span><br><span class="line">    c0 = cipher.encrypt_block(m0)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;🤐 <span class="subst">&#123;c0.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;🥵 You Only Live Once!&quot;</span>[<span class="number">0</span>]:</span><br><span class="line">        m = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">&#x27;💬 &#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> m == m0: </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;🏁 <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        c = cipher.encrypt_block(m)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;🤫 <span class="subst">&#123;c.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    _test()</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="st——unsolved"><a href="#st——unsolved" class="headerlink" title="st——unsolved"></a>st——unsolved</h3><p>这个，感觉就是个逆向，给了个data.bin和encrypt文件，要逆encrypt，然后data.bin寸的像是终端输入的信息，无果，连密码部分都没碰到。</p>
<h2 id="RW"><a href="#RW" class="headerlink" title="RW"></a>RW</h2><p>这部分更是一点都做不动。</p>
<p>压缩包密码</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">klmT0%Gamo+g : rw_FXPDF.zip</span><br><span class="line">gHB^#&amp;Kh1Yg! : rw_gnac.zip</span><br><span class="line">8JjD9sfvHH05 : rw_ire.zip</span><br><span class="line">bed^#O&amp;eam3&amp; : rw_ltp.zip</span><br><span class="line">QqMmHGExAxO8 : rw_ohMyLicense.zip</span><br><span class="line">rp3IU5GfU+^n : rw_OPDD.zip</span><br><span class="line">u!Awy#6DDMz! : rw_UbuntuPrv.zip</span><br><span class="line">sf7#Di_fweN^ : rw_WPNet.zip</span><br><span class="line">1IH!TWruaw~o : rw_DataEase.zip</span><br><span class="line">CcGllP6iXBCE : rw_realAC.zip</span><br><span class="line">r2b#!DtM~f9a : rw_thinkshop++.zip</span><br><span class="line">eut&amp;U5RH&amp;Q9j : Misc-CuteAnimals-附件.zip</span><br></pre></td></tr></table></figure>

<h3 id="FXPDF"><a href="#FXPDF" class="headerlink" title="FXPDF"></a>FXPDF</h3><blockquote>
<p>题目信息：</p>
<p>题目名称：FXPDF<br>旗帜名称：FXP<br>题目描述：附件中给出了一个已经正确安装Foxit PDF Editor Pro的Win10虚拟机，该虚拟机与台上靶机内的虚拟机环境完全相同，仅有系统密码不同。请挖掘并利用Foxit PDF Editor Pro中的漏洞，构造一个恶意PDF文档，实现在靶机的Win10 虚拟机中打开该文档后，能自动弹出系统计算器。上台演示的时候注意关闭exp的调试信息。<br>附件信息： 附件中的虚拟机与台上靶机内的虚拟机环境完全相同，仅有系统密码不同。附件中虚拟机系统用户名为jack，密码为admin。<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）开启附件中提供的虚拟机环境（操作系统Win10，仅系统密码和附件中的虚拟机不同），该虚拟机中已经正确安装Foxit PDF Editor Pro。<br>展示目标：选手携带自己的攻击机上台，将可以完成漏洞利用的恶意PDF文档文件上传到自己的HTTP服务器。操作员将在靶机的Win10 虚拟机中，下载并打开选手HTTP服务器上的恶意PDF文档，该文档需要在打开后的规定的时间内，自动在Win10 虚拟机中弹出系统计算器。</p>
</blockquote>
<h3 id="DataEase"><a href="#DataEase" class="headerlink" title="DataEase"></a>DataEase</h3><blockquote>
<p>题目信息：</p>
<p>题目名称：DataEase<br>旗帜名称：D-E<br>题目描述：附件中给出了一个已经正确的DataEase环境，展台上仅开放81端口，请通过81端口进行攻击，并获取靶机权限，从而将<a target="_blank" rel="noopener" href="https://ip:81/flag.html%E7%9A%84%E9%A1%B5%E9%9D%A2%E4%BF%AE%E6%94%B9%E4%B8%BA%E7%89%B9%E5%AE%9A%E4%B8%BB%E9%A1%B5%E3%80%82%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E5%9D%87%E4%B8%BAdataease">https://ip:81/flag.html的页面修改为特定主页。账号密码均为dataease</a><br>附件信息：附件为台上相同（除密码不同）的环境，但开放端口不同，展台仅开放81端口。<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）开启附件中的虚拟机环境（操作系统ubuntu，密码和附件不同），该虚拟机中部署了DataEase系统。虚拟机中仅有81端口被转发映射至靶机的81端口，可以使选手直接访问。且展台靶机允许回连选手机器<br>展示目标：选手携带自己的攻击机上台，需要在规定的时间内攻击81端口的服务程序，实现获取靶机权限，从而将主页的<a target="_blank" rel="noopener" href="https://ip:81/">https://ip:81</a> &#x2F;flag.html的页面修改为特定页面。需要修改的特定页面详见附件中的flag.html，选手展示时需将其替换为“hacked by <em><strong>”，</strong></em>为自己的队伍名。</p>
</blockquote>
<h3 id="gnac"><a href="#gnac" class="headerlink" title="gnac"></a>gnac</h3><blockquote>
<p>题目信息：<br>题目名称：gnac<br>旗帜名称：GNC<br>题目描述：题目给出了一台Genian NAC虚拟机，请选手攻击该镜像，修改admin用户密码，实现登录<a target="_blank" rel="noopener" href="https://192.168.143.19:8443/mc2/faces/adminlogin.xhtml%E3%80%82">https://192.168.143.19:8443/mc2/faces/adminlogin.xhtml。</a><br>附件信息：附件为台上相同的攻击环境，但是密码不同。<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）启动附件中的gnac环境。<br>展示目标：选手携带自己的攻击机上台，接入靶机所在网段，选手运行exp攻击服务器，若在规定时间内修改密码并登录<br><a target="_blank" rel="noopener" href="https://192.168.143.19:8443/mc2/faces/adminlogin.xhtml%E5%8D%B3%E4%B8%BA%E6%8C%91%E6%88%98%E6%88%90%E5%8A%9F%E3%80%82">https://192.168.143.19:8443/mc2/faces/adminlogin.xhtml即为挑战成功。</a></p>
</blockquote>
<h3 id="ire"><a href="#ire" class="headerlink" title="ire"></a>ire</h3><blockquote>
<p>题目信息：<br>题目名称：ire<br>旗帜名称：IRE<br>题目描述：附件中给出了一台Ubunt64-bit 22.04.5 LTS虚拟机，环境和展示区相同但密码不同。虚拟机&#x2F;home&#x2F;game目录中有start.sh脚本，选手可以执行start.sh脚本启动题目环境（提供的虚拟机中已经通过服务启动）。请挖掘并利用相关程序的漏洞，实现任意命令执行，若靶机弹出计算器则挑战成功。<br>附件信息：虚拟机用户名和口令为game&#x2F;game<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）启动附件中的Ubunt64-bit 22.04.5 LTS环境，并以game用户登录。<br>展示目标：选手携带自己的攻击机上台，接入靶机所在网段开始进行脆弱性检测，若在规定时间内靶机弹出计算器，即为挑战成功。</p>
</blockquote>
<h3 id="ltp"><a href="#ltp" class="headerlink" title="ltp"></a>ltp</h3><blockquote>
<p>题目信息：<br>题目名称：ltp<br>旗帜名称：LTP<br>题目描述：附件中给出了一台Ubuntu22.04虚拟机，虚拟机上启动了目标lighttp服务，题目文件、配置信息等在附件中也有给出。请针对目标http服务进行漏洞利用，获取qwb用户权限（修改lighttpd主页）。<br>附件信息：虚拟机密码为qwb@123456。<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）启动附件中的Ubuntu22.04环境，并以qwb用户登录。<br>展示目标：选手携带自己的攻击机上台，接入靶机所在网段。操作员以qwb用户登录Ubuntu22.04，测试网络连通性后，选手执行exp，修改主页（位于&#x2F;var&#x2F;index.html）成功，即为挑战成功。</p>
</blockquote>
<h3 id="OML"><a href="#OML" class="headerlink" title="OML"></a>OML</h3><blockquote>
<p>题目信息：<br>题目名称：ohMyLicense<br>旗帜名称：OML<br>题目描述：附件中给出了一台Windows Server 2025虚拟机，请针对目标虚拟机挖掘出未授权远程代码执行漏洞并进行利用，获取C:\Users\Public\flag.txt中的内容。<br>附件信息：附件为台上相同的攻击环境，但是密码不同。附件中Administrator用户对应密码为gV9!mD1{hE。<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）启动附件中的Windows Server 2025环境。<br>展示目标：选手携带自己的攻击机上台，接入靶机所在网段，选手运行exp攻击Windows Server 2025服务器，若在规定时间内获取C:\Users\Public\flag.txt中的内容，即为挑战成功。</p>
</blockquote>
<h3 id="OPDD"><a href="#OPDD" class="headerlink" title="OPDD"></a>OPDD</h3><blockquote>
<p>题目信息：<br>题目名称：OPDD<br>旗帜名称：OPDD<br>题目描述：附件中给出了一个opnsense的虚拟机。初始化过程中set up VLANS 选no，WAN选em0即可。环境和展示区相同但密码不同。请分析并挖掘利用opnsense服务程序的漏洞，实现RCE，并替换修改虚拟机中的&#x2F;usr&#x2F;local&#x2F;www&#x2F;index.php文件，从而将opnsense的登录页面修改为特定主页。<br>附件信息：附件为台上相同的环境，但是密码不同。附件中虚拟机系统账密为root&#x2F;opnsense<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）开启附件中的虚拟机环境（密码和附件不同），该虚拟机中部署了opnsense。<br>展示目标：选手携带自己的攻击机上台，需要在规定的时间内攻击web端口的服务程序，实现修改虚拟机中的&#x2F;usr&#x2F;local&#x2F;www&#x2F;index.php文件，从而将opnsense的登录界面修改为特定页面。需要修改的特定页面详见附件中的index.php，选手展示时需将其中的“XXXXX”替换为自己的队伍名。</p>
</blockquote>
<h3 id="rac"><a href="#rac" class="headerlink" title="rac"></a>rac</h3><blockquote>
<p>题目信息：<br>题目名称：realAC<br>旗帜名称：rAC<br>题目描述：附件中给出了一个虚拟机，环境和展示区相同但密码不同。请实现root权限的RCE，并将展示页面的<a target="_blank" rel="noopener" href="https://ip/login.html%E4%BF%AE%E6%94%B9%E4%B8%BA%E7%89%B9%E5%AE%9A%E4%B8%BB%E9%A1%B5%E3%80%82">https://ip:443/login.html修改为特定主页。</a><br>附件信息：附件为台上相同的攻击环境（仅密码不同）。<br>台上拓扑：交换机同时连接选手攻击机和代理虚拟机，代理虚拟机与靶机相连。代理虚拟机将靶机的80,85,443,9998端口，通过端口转发的方式可被选手访问。其中代理虚拟机仅提供端口转发功能。</p>
<p>展示目标：选手携带自己的攻击机上台，接入代理虚拟机所在网段，需要在规定的时间内攻击靶机，将<a target="_blank" rel="noopener" href="https://ip/login.html%E4%BF%AE%E6%94%B9%E4%B8%BA%E7%89%B9%E5%AE%9A%E9%A1%B5%E9%9D%A2%E3%80%82%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%E7%9A%84%E7%89%B9%E5%AE%9A%E9%A1%B5%E9%9D%A2%E8%AF%A6%E8%A7%81%E9%99%84%E4%BB%B6%E4%B8%AD%E7%9A%84login.html%EF%BC%8C%E9%80%89%E6%89%8B%E5%B1%95%E7%A4%BA%E6%97%B6%E9%9C%80%E5%B0%86%E5%85%B6%E4%B8%AD%E7%9A%84%E2%80%9CXXXXX%E2%80%9D%E6%9B%BF%E6%8D%A2%E4%B8%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E9%98%9F%E4%BC%8D%E5%90%8D%E3%80%82">https://ip:443/login.html修改为特定页面。需要修改的特定页面详见附件中的login.html，选手展示时需将其中的“XXXXX”替换为自己的队伍名。</a></p>
</blockquote>
<h3 id="ts"><a href="#ts" class="headerlink" title="ts++"></a>ts++</h3><blockquote>
<p>题目信息：<br>题目名称：thinkshop++<br>旗帜名称：TS++<br>题目描述：附件中给出了一个docker虚拟机（名称为thinkshopplus），虚拟机上部署了一个服务系统，请分析服务存在的漏洞，针对Web服务进行攻击，获取操作系统控制权限。并替换修改虚拟机中的&#x2F;var&#x2F;www&#x2F;html&#x2F;public&#x2F;hack.html文件，从而将<a href="http://ip:port/public/hack.html的页面修改为特定页面。">http://ip:port/public/hack.html的页面修改为特定页面。</a><br>附件信息：附件为台上相同的攻击环境。Web服务内部暴露端口为80，部署方式：<br>docker load &lt; thinkshopplus.tar<br>docker run -tid –name thinkshopplus -p 36000:80 thinkshopplus<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机运行docker虚拟机启动Web服务，并将内部80端口映射到指定端口。<br>展示目标：选手携带自己的攻击机上台，接入靶机所在网段，需要在规定的时间内攻击指定端口的Web服务，实现RCE，并替换修改虚拟机中的&#x2F;var&#x2F;www&#x2F;html&#x2F;public&#x2F;hack.html文件，从而将<a href="http://ip:port/public/hack.html的页面修改为附件中所提供的hack.html，其中选手展示时需将其中的“XXX”替换为自己的队伍名。">http://ip:port/public/hack.html的页面修改为附件中所提供的hack.html，其中选手展示时需将其中的“XXX”替换为自己的队伍名。</a></p>
</blockquote>
<h3 id="Ubp"><a href="#Ubp" class="headerlink" title="Ubp"></a>Ubp</h3><blockquote>
<p>题目信息：<br>题目名称：UbuntuPrv<br>旗帜名称：UbP<br>题目描述：附件中以OVF格式给出了一个VMWare17.5以上兼容性的Ubuntu虚拟机，Ubuntu虚拟机的内核经过修改重新编译，请利用漏洞提升至root权限。导入后的宿主机有一调试用户。调试用户的用户名为qwbs8，密码为8f4cpkdjwN2YPPra；<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware（最新版）开启附件中的Ubuntu虚拟机环境，虚拟机在22号端口开启ssh访问，映射到宿主机的11122端口，可以在攻击机通过scp协议将exp传输到虚拟机进行攻击。展示机包含调试用户，但是密码不同，无法通过ssh访问。选手通过操作账号连接ssh。操作账号的用户名为qwbs8_user，密码为123456。<br>展示目标：选手携带自己的攻击机上台，可以通过ssh直接登录客户虚拟机，上传文件并执行操作。选手需要在规定的时间内攻击虚拟机，得到root权限，并能够读取&#x2F;etc&#x2F;shadow文件。</p>
</blockquote>
<h3 id="WPNet"><a href="#WPNet" class="headerlink" title="WPNet"></a>WPNet</h3><blockquote>
<p>题目信息：<br>题目名称：WPNet<br>旗帜名称：WPNet<br>题目描述：附件中给出了一台Windows 10 x64虚拟机，及一台Ubuntu虚拟机，两台虚拟机均使用桥接模式，网段配置为：192.168.3.0。Windows虚拟机中安装有WPS应用程序，选手可上传1个doc或docx文件，并使用WPS打开；在攻击环境中，Ubuntu与Windows虚拟机处于同一局域网内，并开启了Apache服务。请选手针对Windows虚拟机上的wps进行漏洞利用，实现RCE（弹出计算器）。<br>附件信息：附件为台上相同的攻击环境。附件中Windows用户未设置密码，Ubuntu中qwb用户密码为welcometoqwb。<br>台上拓扑：交换机同时连接选手攻击机和靶机。靶机中使用vmware启动附件中的Windows 10环境。<br>展示目标：选手携带自己的攻击机上台，接入靶机所在网段，并开启http服务（如python3 -m http.server）。操作员登录Windows，下载选手使用的exp.doc或exp.docx，并使用WPS打开exp文件（展示期间可多次执行），若在规定时间内靶机弹出calc计算器，即为挑战成功。</p>
</blockquote>
<h1 id="Thinking"><a href="#Thinking" class="headerlink" title="Thinking"></a>Thinking</h1><p>4号下午到酒店之后，大概4点去场馆溜了一圈，大门如图</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/1.JPG"></p>
<p>比赛的地方在4楼赛博厅</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/2.JPG"></p>
<p>当时工作人员还在测试，我们就走进去看了一圈。两边是32支战队的战队logo，口号以及战队简介，一边各16支战队</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/3.JPG"></p>
<p>5号上午比赛正式开始的时候，场地中间插满了旗子，真就夺旗赛，但这些特殊的旗都是RW相关的赛题，一血的队伍就可以把旗子拔走</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/4.JPG"></p>
<p>接着讲讲我这一天干了啥，早上做了下Shopping game，手还算快，第八个做出来，然后去看st，逆了半天没触碰到一点密码的东西就放弃了，然后队友那边有个关于FXPDF的payload，让我试了试，题目要求的功能是实现了，但是很可惜，有多余的操作，所以上台挑战的时候没给过。到了下午2点放新题，我一看，好家伙上了3道密码，这让我怀疑这是强网杯还是强密杯。啃了两个多小时还好把bl0ck做了出来(也还算挺靠前的，好像也是第八个做了出来)，到5点比赛结束最终排名定格在17名(Jeopardy部分)，总榜不太确定，最后主办方连榜单都没放。说实话是远超预期，昨天和队友看了各大战队之后实在是想不到我们这双非战队能稳赢哪支队伍，一来我们4个实力就一般，二来比赛可联网，大家肯定都有后备力量，而我们….一言难尽，比啥都比不过😭</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/3.png"></p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/5.JPG"></p>
<p>噢，最后我们快走的时候还被拉去拍了点照片和视频当作宣传</p>
<p>接下来是6号的事情。</p>
<p>早上刚开赛，和我预期的差不多，大部分队伍都把前一天的题目做完了，而我们依旧没有进展，自然而然掉到了末尾。10点上了最后两题密码(Signin和f2ke)，可惜没做出来。</p>
<p>花了挺长时间把fak1做了出来，然后就摆烂等颁奖了。心有余而力不足，只能做出一些大家都会做的题，最后定榜29名😭</p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/5.png"></p>
<p><img src="/../../images/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/6.JPG"></p>
<p>晚上吃完饭后和星盟的师傅去ktv玩了一会儿，还挺开心的😀。</p>
<p>最后感谢一下主办方吧，谁叫强网杯给的这么多呢。定制队伍的赛牌(还区分了队长和队员)，有车费报销，有酒店，给了背包和鼠标垫周边，还保底3等奖(喜提1w)。<del>但线下赛有点像不需要交wp的ISCC(这是能说的吗？)</del></p>
<p>事已至此，我的CTF生涯就暂且告一段落了！！！！！！</p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/" title="2024强网杯线下赛">https://dexterjie.github.io/2024/12/05/赛题复现/2024强网杯线下赛/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" rel="prev" title="2024第二届福建省数据安全大赛">
                  <i class="fa fa-chevron-left"></i> 2024第二届福建省数据安全大赛
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E7%AC%AC%E4%B8%80%E5%B1%8AOpenHarmonyCTF/" rel="next" title="第一届OpenHarmonyCTF">
                  第一届OpenHarmonyCTF <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">318k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">19:16</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
