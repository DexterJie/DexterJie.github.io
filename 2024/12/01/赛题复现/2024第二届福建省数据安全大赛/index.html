<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="省内一个小比赛，简单记录下">
<meta property="og:type" content="article">
<meta property="og:title" content="2024第二届福建省数据安全大赛">
<meta property="og:url" content="https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="省内一个小比赛，简单记录下">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/57.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/58.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/59.png">
<meta property="article:published_time" content="2024-12-01T09:38:50.000Z">
<meta property="article:modified_time" content="2024-12-01T13:30:42.622Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/%E6%9D%82/57.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/","path":"2024/12/01/赛题复现/2024第二届福建省数据安全大赛/","title":"2024第二届福建省数据安全大赛"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024第二届福建省数据安全大赛 | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ddd"><span class="nav-number">1.1.</span> <span class="nav-text">ddd</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenRSA"><span class="nav-number">1.2.</span> <span class="nav-text">OpenRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ezmath-2"><span class="nav-number">1.3.</span> <span class="nav-text">ezmath_2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#part1"><span class="nav-number">1.3.1.</span> <span class="nav-text">part1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#part2"><span class="nav-number">1.3.2.</span> <span class="nav-text">part2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#QAQTAT%E2%80%94%E2%80%94Unsolved"><span class="nav-number">1.4.</span> <span class="nav-text">QAQTAT——Unsolved</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#step1"><span class="nav-number">1.4.1.</span> <span class="nav-text">step1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step2"><span class="nav-number">1.4.2.</span> <span class="nav-text">step2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step3"><span class="nav-number">1.4.3.</span> <span class="nav-text">step3</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DS"><span class="nav-number">2.</span> <span class="nav-text">DS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#findphone"><span class="nav-number">2.1.</span> <span class="nav-text">findphone</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">3.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024第二届福建省数据安全大赛 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024第二届福建省数据安全大赛
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-12-01 17:38:50 / 修改时间：21:30:42" itemprop="dateCreated datePublished" datetime="2024-12-01T17:38:50+08:00">2024-12-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>7 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>省内一个小比赛，简单记录下</p>
<span id="more"></span>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ddd"><a href="#ddd" class="headerlink" title="ddd"></a>ddd</h2><blockquote>
<p>题目描述: d是随机生成的 ，要通过n、e通过连分数wiener攻击直接反推d</p>
</blockquote>
<blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;DASCTF&#123;******&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = getPrime(<span class="number">256</span>)</span><br><span class="line">e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = s2n(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = &#x27;</span> + <span class="built_in">str</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;e = &#x27;</span> + <span class="built_in">str</span>(e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 114566998957451783636756389276471274690612644037126335470456866443567982817002189902938330449132444558501556339080521014838959058380963759366933946623103869574657553262938223064086322963492884606713973124514306815995276393344755433548846003574038937940253826360659447735554684257197194046341849089254659225497</span></span><br><span class="line"><span class="string">e = 35489734227210930185586918984451799765619374486784192218215354633053183935617953856556709715097294481614236703293033675674496036691242573294182072757562322996800390363453350727372642264982749305833933966045097125311467413670410802534093354414115267442785896373815076066721029449240889291057288090241124904705</span></span><br><span class="line"><span class="string">c = 60503455347700500866544596012233537789678841391057706123172519773588895502922586197178148979273264437566411675346207472455036341903878112074983509557751805365618433536738111588239911292341288514123006967218545943520736254346030465088445419278775539026233686559207400401082452551955780877227801939191694370380</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\frac{e}{n} \approx \frac{k}{d}<br>$$</p>
<p>对$\frac{e}{n}$展开即可</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage 10.4</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">114566998957451783636756389276471274690612644037126335470456866443567982817002189902938330449132444558501556339080521014838959058380963759366933946623103869574657553262938223064086322963492884606713973124514306815995276393344755433548846003574038937940253826360659447735554684257197194046341849089254659225497</span></span><br><span class="line">e = <span class="number">35489734227210930185586918984451799765619374486784192218215354633053183935617953856556709715097294481614236703293033675674496036691242573294182072757562322996800390363453350727372642264982749305833933966045097125311467413670410802534093354414115267442785896373815076066721029449240889291057288090241124904705</span></span><br><span class="line">c = <span class="number">60503455347700500866544596012233537789678841391057706123172519773588895502922586197178148979273264437566411675346207472455036341903878112074983509557751805365618433536738111588239911292341288514123006967218545943520736254346030465088445419278775539026233686559207400401082452551955780877227801939191694370380</span></span><br><span class="line"></span><br><span class="line">cf = continued_fraction(e / n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    k = cf.numerator(i)</span><br><span class="line">    d = cf.denominator(i)</span><br><span class="line">    <span class="keyword">if</span> (e*d - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line">        <span class="comment"># DASCTF&#123;e694f0b4e9556021d1bc9e8deedba575&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="OpenRSA"><a href="#OpenRSA" class="headerlink" title="OpenRSA"></a>OpenRSA</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPrime</span>(<span class="params">pp</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x=getPrime(<span class="number">512</span>)</span><br><span class="line">        s=x**<span class="number">2</span>+pp**<span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span>(isPrime(s)):</span><br><span class="line">            <span class="keyword">return</span> s,x</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">pp = ???</span><br><span class="line"><span class="keyword">assert</span> isPrime(pp)</span><br><span class="line">s,p=getPrime(pp)</span><br><span class="line"><span class="keyword">assert</span> iroot(s-pp**<span class="number">2</span>,<span class="number">2</span>)[<span class="number">0</span>] == p</span><br><span class="line"><span class="keyword">assert</span> s%<span class="number">2</span> == <span class="number">1</span></span><br><span class="line"><span class="comment">#注意观察一下数和数之间的关系，相信你一定可以猜到pp的值</span></span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;s = <span class="subst">&#123;s&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># n = 91332943043957251900549627486310189996740089685835683300621629110943492183477268072298084280915990633551010090925404931181501528744693585078837081210712114190987563470157519717774234682286443126927653309723270524901176734059185014688925211350678028031584074094348200320194354359517392064299266428589467651877</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br><span class="line"><span class="comment"># c = 56047741088808471978777825274508389592730927600153384445849570005499054151546904431595413241700524283982925340735997036959411123465509486474875805374561817710368400036617625285408296984445244211890678298780346979950633523883426046251122190772687200378680540970303449180211765041573634411303625986012155354363</span></span><br><span class="line"><span class="comment"># s = 85800895230491036216758530886003341168631461607188722404807814593592648170497231916924533123351386068154228324172747834362249217755009796485811038447281072462412691656306643440837354994979197958887259958930060878212841756145266179832110649310586242527945793993646330413532949285121357704413955480099382778653</span></span><br></pre></td></tr></table></figure>

<p>尝试一下爆破pp的值，即可得到p</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage 10.4</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">91332943043957251900549627486310189996740089685835683300621629110943492183477268072298084280915990633551010090925404931181501528744693585078837081210712114190987563470157519717774234682286443126927653309723270524901176734059185014688925211350678028031584074094348200320194354359517392064299266428589467651877</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">56047741088808471978777825274508389592730927600153384445849570005499054151546904431595413241700524283982925340735997036959411123465509486474875805374561817710368400036617625285408296984445244211890678298780346979950633523883426046251122190772687200378680540970303449180211765041573634411303625986012155354363</span></span><br><span class="line">s = <span class="number">85800895230491036216758530886003341168631461607188722404807814593592648170497231916924533123351386068154228324172747834362249217755009796485811038447281072462412691656306643440837354994979197958887259958930060878212841756145266179832110649310586242527945793993646330413532949285121357704413955480099382778653</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000</span>):</span><br><span class="line">    p = gmpy2.iroot(s - pp**<span class="number">2</span>,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="comment"># DASCTF&#123;luQ5xmNUKgEEDO_c5LoJCum&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ezmath-2"><a href="#ezmath-2" class="headerlink" title="ezmath_2"></a>ezmath_2</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">FLAG = ?</span><br><span class="line">FLAG = [</span><br><span class="line">    os.urandom(<span class="built_in">len</span>(FLAG) // <span class="number">2</span>) + FLAG[i : i + <span class="built_in">len</span>(FLAG) // <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(FLAG), <span class="built_in">len</span>(FLAG) // <span class="number">2</span>)</span><br><span class="line">]</span><br><span class="line">m = [bytes_to_long(j) <span class="keyword">for</span> j <span class="keyword">in</span> FLAG]</span><br><span class="line"></span><br><span class="line">BITS = <span class="number">1024</span></span><br><span class="line">p = [getPrime(BITS // <span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)]</span><br><span class="line">q = [getPrime(BITS // <span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)]</span><br><span class="line">N = [P * Q <span class="keyword">for</span> P, Q <span class="keyword">in</span> <span class="built_in">zip</span>(p, q)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">N, bits, x</span>):</span><br><span class="line">    a = getPrime(bits)</span><br><span class="line">    b = getPrime(bits)</span><br><span class="line">    c = getPrime(bits // <span class="number">8</span>)</span><br><span class="line">    M_enc = a * x**<span class="number">3</span> + b * x**<span class="number">2</span> + c * x + <span class="number">0x10001</span></span><br><span class="line">    E = <span class="number">0x3</span></span><br><span class="line">    C = [<span class="built_in">pow</span>(M_enc, E, _N) <span class="keyword">for</span> _N <span class="keyword">in</span> N]</span><br><span class="line">    <span class="keyword">return</span> C, [a, b]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">N, bits, y</span>):</span><br><span class="line">    k = getPrime(bits - <span class="number">4</span>)</span><br><span class="line">    d = getPrime(bits // <span class="number">4</span>)</span><br><span class="line">    n = N[<span class="number">0</span>]</span><br><span class="line">    M_enc = (k * y + d) % n</span><br><span class="line">    <span class="keyword">return</span> M_enc, k</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C1, leak = encrypt1(N, BITS, m[<span class="number">0</span>])</span><br><span class="line">C2, k = encrypt2(N, BITS, m[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(C1)</span><br><span class="line"><span class="built_in">print</span>(C2)</span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"><span class="built_in">print</span>([leak, k])</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[39210675902767171073064943854104914397318121446101723025421410905880809922084555547089255445739204847056571781414623387440961486919230976050521197525269694636836736107851592114925116635570595845406470355695245201686960752108723499535746031147888962448468104477354730127377741730751421503842594966365061523611, 21675905167425162616128574708482426955230011762565450546432364936973398813051136425098917635524738479523732526959097768185699891467456510724995814165940757573953563334749813828856406836385462518051562757883886257894755193702929911690331512867034067960955467807907987651082960006573707163859514151189827543039, 66096646108301934399274118257308307915231557977518695885499139839256014181396290864623880247920279192753433403162454637403686504278754650695426688787028099307619721804296019266799275886911316095654630310191287154797468810317077271658831168841822906220843805965896946953728348949612192513562755900124531154758, 59816886601480912425861095206037446174954537458093383156605042918202726886144484284172884843968514213820643706653657717557404667263187774440262247299425581386485491597772150125631418669042180872231911344421331339829988482974074339802681772022167376065661758991731468975172693119092409811751010977334168329227, 131112679648205048523511262232304859502163506136877121849063240771494134509706400792339739037802667536327789119019499831954753404701512209305892773099066871412825558546748906486379573354059606182478458566624155474561116064363798350343687749035291790215358299762818824762715192679061741172663737658450572209367, 43643310640383695871097616622185046165283021240350731928406909225878913445249677119015988525120798758775418577387758786199121326418375800915037663945124008154833579277980455516349120358578516630571358237698555737897690224543497284945932954560392188972299922833854829080951404429531955120945676560659965603489, 86701979450316886662439264990876741541848626976960034624252876210104377646367821419752434477592971050189312544598877228848283940012847610261340736108023333441319041145481591925058814393418916451447318593515784941028265270347094940824842340023587831783417359874112396393716774480909551782193847811701805516777]</span></span><br><span class="line"><span class="string">69085574629663347173384705931923126544561443330791566932169138079584064231904303151768069428960583575643803686043335536173400098508197016643364813988845877926095905027925245050156369608956271162096499662846148744826597576004622144548676808142857980790273598239328359851194701794184132266594811640276439440456</span></span><br><span class="line"><span class="string">[83920436472644468114336514458670203166880598601128629213598308122315943647477648725334757281389680856824680820442629500839369540102313057613153893435692695034612252508378877741178750893940959073206110762081573056538282939095067915733216069732793365154982444459730076795460746755054219576896243180622309884857, 132725596767862704519311360731167952441682391848549606707566529766492075878297265627550452781820477936750075669184726394066918391524561121462184958422342407700116198048855415767147751546773676949154640543842318481818501132472569320223397688131850509215014309464347944742887557711206490173666583920389700708831, 134924627121589644200921401227820412795405507111882227090262833556323180628807565090996082413568256234706441297383609794783760229737170162336471738881536481435219623055860760116596049170405220819894188454775060000680086232217890374169172583458490637564394929259454363429508999282925031939964400848769589350491, 128873943327746391603693540782887020567439398816916556875862010785996700782497987136622770387575206425258784072486787785284480725904135783490965670039756044204693704982723579454943461154427854528700288773813084171149070243932237877744362300759725228935486757660861229602909283227018382899918657561881038505619, 146832632487409671396147661776251053252046208436311196368599785764793563685029004937845604951364341799356830955030267144214717409682996405331059642712978272389959402896807487012140791810051018782014584613953469051848108273079298465214188035861451147379551532909177106228818975000253004995700791363303591398459, 164794000056055772924285466363399754240674124006507460926378234769317895388675748427263619040491359383822058130343718920056496491529452605384133370219387562170540140885372967208746914628883252353006600795724839852988192708909358442436793925249434036012614880298210398628406695755800212917360433722047228398049, 101360955650592921689511287927563023257443133857308066996955169752147379480351337740384360871509578019642636047297880904446292996435719693298396788514627167328783134915667602044518260283224334952739097096020465949142922986182437466658501922066272028288416623070747615601017662797178039974501336148874247521949]</span></span><br><span class="line"><span class="string">[[172033543709250079406995655514186574845651452962745246851429713084015875663851567154407802901198710950909083364140681295346099328642342642964306329277710115376244558913902669009971316379491707676584883313738404183495735745680526851775827217485023912138926199278588523491795347151834454906478204848015449997813, 141076387206674739034287088707862731834700608913604205427734752654777620884017167083324052275488296306707270126602400204310553515997946671957412375316563939770394276277286373103689883205823383839999222214982602107066164731992952653247836262771503144928200922488783295873863479410518601888457156204261711297989], 9602302825522719640915293768448626622720608131148112056474311058382453436558663436086549890754206860742148415450801990589075559602643849034039835405603849681286607302379793761113070642053599564324739951301921822772409355006357379151336441982606852681753672574610317738650515758507858176186342104502011657569]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h3><p>给了7个式子<br>$$<br>c_i \equiv M^3 \mod n_i<br>$$<br>由于是3次方，所以考虑中国剩余定理，得到$C \equiv M^3 \mod N$，此时的$M^3 &lt; N$，所以直接对$C$开3次方即可得到M。</p>
<p>求出M后得知M为2072bit，从而可以推出x的bit为350。<br>$$<br>M \equiv ax^3 + bx^2 +cx + 65537<br>$$<br>这里只有c和x是未知的，而且c为128bit，直接二元copper</p>
<h3 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h3><p>$$<br> c \equiv km + d \mod n<br>$$</p>
<p>只有m和d未知，而且m是350bit，d是256bit，二元copper即可</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">C1 = [<span class="number">39210675902767171073064943854104914397318121446101723025421410905880809922084555547089255445739204847056571781414623387440961486919230976050521197525269694636836736107851592114925116635570595845406470355695245201686960752108723499535746031147888962448468104477354730127377741730751421503842594966365061523611</span>, <span class="number">21675905167425162616128574708482426955230011762565450546432364936973398813051136425098917635524738479523732526959097768185699891467456510724995814165940757573953563334749813828856406836385462518051562757883886257894755193702929911690331512867034067960955467807907987651082960006573707163859514151189827543039</span>, <span class="number">66096646108301934399274118257308307915231557977518695885499139839256014181396290864623880247920279192753433403162454637403686504278754650695426688787028099307619721804296019266799275886911316095654630310191287154797468810317077271658831168841822906220843805965896946953728348949612192513562755900124531154758</span>, <span class="number">59816886601480912425861095206037446174954537458093383156605042918202726886144484284172884843968514213820643706653657717557404667263187774440262247299425581386485491597772150125631418669042180872231911344421331339829988482974074339802681772022167376065661758991731468975172693119092409811751010977334168329227</span>, <span class="number">131112679648205048523511262232304859502163506136877121849063240771494134509706400792339739037802667536327789119019499831954753404701512209305892773099066871412825558546748906486379573354059606182478458566624155474561116064363798350343687749035291790215358299762818824762715192679061741172663737658450572209367</span>, <span class="number">43643310640383695871097616622185046165283021240350731928406909225878913445249677119015988525120798758775418577387758786199121326418375800915037663945124008154833579277980455516349120358578516630571358237698555737897690224543497284945932954560392188972299922833854829080951404429531955120945676560659965603489</span>, <span class="number">86701979450316886662439264990876741541848626976960034624252876210104377646367821419752434477592971050189312544598877228848283940012847610261340736108023333441319041145481591925058814393418916451447318593515784941028265270347094940824842340023587831783417359874112396393716774480909551782193847811701805516777</span>]</span><br><span class="line">C2 = <span class="number">69085574629663347173384705931923126544561443330791566932169138079584064231904303151768069428960583575643803686043335536173400098508197016643364813988845877926095905027925245050156369608956271162096499662846148744826597576004622144548676808142857980790273598239328359851194701794184132266594811640276439440456</span></span><br><span class="line">N = [<span class="number">83920436472644468114336514458670203166880598601128629213598308122315943647477648725334757281389680856824680820442629500839369540102313057613153893435692695034612252508378877741178750893940959073206110762081573056538282939095067915733216069732793365154982444459730076795460746755054219576896243180622309884857</span>, <span class="number">132725596767862704519311360731167952441682391848549606707566529766492075878297265627550452781820477936750075669184726394066918391524561121462184958422342407700116198048855415767147751546773676949154640543842318481818501132472569320223397688131850509215014309464347944742887557711206490173666583920389700708831</span>, <span class="number">134924627121589644200921401227820412795405507111882227090262833556323180628807565090996082413568256234706441297383609794783760229737170162336471738881536481435219623055860760116596049170405220819894188454775060000680086232217890374169172583458490637564394929259454363429508999282925031939964400848769589350491</span>, <span class="number">128873943327746391603693540782887020567439398816916556875862010785996700782497987136622770387575206425258784072486787785284480725904135783490965670039756044204693704982723579454943461154427854528700288773813084171149070243932237877744362300759725228935486757660861229602909283227018382899918657561881038505619</span>, <span class="number">146832632487409671396147661776251053252046208436311196368599785764793563685029004937845604951364341799356830955030267144214717409682996405331059642712978272389959402896807487012140791810051018782014584613953469051848108273079298465214188035861451147379551532909177106228818975000253004995700791363303591398459</span>, <span class="number">164794000056055772924285466363399754240674124006507460926378234769317895388675748427263619040491359383822058130343718920056496491529452605384133370219387562170540140885372967208746914628883252353006600795724839852988192708909358442436793925249434036012614880298210398628406695755800212917360433722047228398049</span>, <span class="number">101360955650592921689511287927563023257443133857308066996955169752147379480351337740384360871509578019642636047297880904446292996435719693298396788514627167328783134915667602044518260283224334952739097096020465949142922986182437466658501922066272028288416623070747615601017662797178039974501336148874247521949</span>]</span><br><span class="line">leak,k = [[<span class="number">172033543709250079406995655514186574845651452962745246851429713084015875663851567154407802901198710950909083364140681295346099328642342642964306329277710115376244558913902669009971316379491707676584883313738404183495735745680526851775827217485023912138926199278588523491795347151834454906478204848015449997813</span>, <span class="number">141076387206674739034287088707862731834700608913604205427734752654777620884017167083324052275488296306707270126602400204310553515997946671957412375316563939770394276277286373103689883205823383839999222214982602107066164731992952653247836262771503144928200922488783295873863479410518601888457156204261711297989</span>], <span class="number">9602302825522719640915293768448626622720608131148112056474311058382453436558663436086549890754206860742148415450801990589075559602643849034039835405603849681286607302379793761113070642053599564324739951301921822772409355006357379151336441982606852681753672574610317738650515758507858176186342104502011657569</span>]</span><br><span class="line"></span><br><span class="line">a,b = leak</span><br><span class="line">c1 = crt(C1,N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">int</span>(gmpy2.iroot(c1,<span class="number">3</span>)[<span class="number">0</span>])</span><br><span class="line">n = prod(N)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m1 = ax^3 + bx^2 + cx + 65537</span></span><br><span class="line">R.&lt;x,y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = a*x^<span class="number">3</span> + b*x^<span class="number">2</span> + y*x + <span class="number">65537</span> - m1</span><br><span class="line">res = small_roots(f,bounds=(<span class="number">2</span>^<span class="number">350</span>,<span class="number">2</span>^<span class="number">128</span>),m=<span class="number">2</span>,d=<span class="number">3</span>)</span><br><span class="line">M1 = res[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(M1)))</span><br><span class="line"></span><br><span class="line">n = N[<span class="number">0</span>]</span><br><span class="line">R.&lt;x,y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = k*x + y - C2</span><br><span class="line">res = small_roots(f,bounds=(<span class="number">2</span>^<span class="number">350</span>,<span class="number">2</span>^<span class="number">256</span>),m=<span class="number">2</span>,d=<span class="number">3</span>)</span><br><span class="line">M2 = res[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(M2)))</span><br><span class="line"><span class="comment"># DASCTF&#123;0628fe9a-328a-4252-926c-3bb181deeae3&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="QAQTAT——Unsolved"><a href="#QAQTAT——Unsolved" class="headerlink" title="QAQTAT——Unsolved"></a>QAQTAT——Unsolved</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">pt, G, A, T, S, p</span>):</span><br><span class="line">    s = randint(<span class="number">0</span>,p-<span class="number">1</span>)</span><br><span class="line">    D = G^s</span><br><span class="line">    E = A*T*A</span><br><span class="line">    F = D*E*D</span><br><span class="line">    K = <span class="built_in">list</span>(D*S*D)</span><br><span class="line">    key = <span class="built_in">sum</span>(K[<span class="number">0</span>])+<span class="built_in">sum</span>(K[<span class="number">1</span>])+<span class="built_in">sum</span>(K[<span class="number">2</span>])</span><br><span class="line">    mask = <span class="built_in">int</span>(sha256(<span class="built_in">str</span>(key).encode()).hexdigest(),<span class="number">16</span>)</span><br><span class="line">    ct = pt ^^ mask</span><br><span class="line">    <span class="keyword">return</span> ct, F</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">ct, Q, F, p</span>):</span><br><span class="line">    K = Q*F*Q</span><br><span class="line">    key = <span class="built_in">sum</span>(K[<span class="number">0</span>])+<span class="built_in">sum</span>(K[<span class="number">1</span>])+<span class="built_in">sum</span>(K[<span class="number">2</span>])</span><br><span class="line">    mask = <span class="built_in">int</span>(sha256(<span class="built_in">str</span>(key).encode()).hexdigest(),<span class="number">16</span>)</span><br><span class="line">    pt = ct ^^ mask</span><br><span class="line">    <span class="keyword">return</span> pt</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">Fp2.&lt;i&gt; = GF(p^<span class="number">2</span>, modulus=x^<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line">M = MatrixSpace(Fp2, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Q = M.random_element()</span><br><span class="line">    A = M.random_element()</span><br><span class="line">    <span class="keyword">if</span> Q*A != A*Q:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">T = Q*A*Q</span><br><span class="line">S = T*A*T</span><br><span class="line">r1 = randint(<span class="number">0</span>,p-<span class="number">1</span>)</span><br><span class="line">G = Q^r1</span><br><span class="line">pk = (<span class="built_in">list</span>(A), <span class="built_in">list</span>(T), <span class="built_in">list</span>(S), <span class="built_in">list</span>(G))</span><br><span class="line"></span><br><span class="line">ct, F = enc(m, G, A, T, S, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pk = &quot;</span>, pk)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;F = &quot;</span>, <span class="built_in">list</span>(F))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ct = &quot;</span>, ct)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p =  72887242108660141996862343556330151015969690949835567252527194788428065480383</span></span><br><span class="line"><span class="string">pk =  ([(17721183402259872020800275954210023274983052570120081248291897425608931477093*i + 32398110280895896734010284949974832063887503132353681078977206899204202173789, 54531634495057046991515273558305428867102201405617856305008554208336946545276*i + 53559176432820530464958340934397135653021175198597495321065224929188410347695, 27719945502856754481236098196014205483081586087367078493933408080194499938927*i + 1450628736387393873166171805424299538505476789523674611289973478290718453200), (57242423786686483363839647362581564383925732392730073374546590355998555747077*i + 573726326354574516128249317235875704460857319673337707555095009277545125755, 33631043256657770245013631632455702904903259491780484310654749784948198388976*i + 17344746653834202604930860577508757708688427949046279718508635007113840369042, 37771390186920740637371383242878514021347606565375600086363978842439775164973*i + 60264754185911116825495147907207494752330900415794996812483089251259003404228), (1163730453993018743008743150834548760986076138562570206571825145859591284352*i + 69245390362211526197537288211735612650619880945856387683074182933575799994162, 11137807706588795799057940108843238078078690609437386007163034291855328303661*i + 50795522649623533714787572047531722836395032085224035511036953078383612475598, 14354786571703727534706086386589187674076604263117377684131521866407943036307*i + 63028649680815097939155846824928638616844025040257105384123424769274942520895)], [(22137116252880790433838296157765927318220905592359967466680754349755815464341*i + 35503968364379821899511866562472775961434113516937033217642581531414863539290, 38346074307552448152239080224505166810289185210503265380269711384969731945517*i + 9333819647786551924409858116441570177115099865486742684028611902450000042407, 24608192510515673607042276468532809071945836783394960695059783085937608049755*i + 27099766371861599260580052331632986107092105438254563604629919595057370886149), (57539731529782952718529369617033412770127782205874818027724894673104814770991*i + 12431864123786174601413168140961685219607645783666490625760143190724674574386, 33510082449726132893492104159133966168598115972734064630878005553829725389082*i + 30594711977745700371548334707069524826346332947574826081979927125841475148328, 8911862104171403632946802970568635607253840071000107875759139060453368618583*i + 51594672749496705581452789883241278156858476777167382827032876227546058970732), (58105830161247358431125768499050987088161417325586965601350797391396603985470*i + 10949064084676782939947256128733523229613253182051362970560478801614590446300, 6665352489343222248969975791152178151760060704226637217535985452272551528693*i + 16163109497937280055564868323730465088174193174761590036929535644203224067166, 26147088265849488467397913386934580340556987670869413865359802108333761377560*i + 14170094609019059182842713618319151553137248441974849089555832123638494739417)], [(60066006389024369318961505483331049048095679333675437984483948643792214278503*i + 67617085525047580942273623886038114942547589259839196477555874755427651308048, 38692305959834079988532869421062338838072016075793686080934562521314366274998*i + 21104829450473981189549299039898127784065322316764325995863199136802573514, 7207625628360021282792621977024027446511231977201394776410095364976996279450*i + 23039079766688651678553952766794875180844089420934577132338235904018762773928), (10808368042897084491009063074724200907600038030639153659288985642861405920614*i + 33955795465220353002933680692690511153845418737513482128237117905262919879043, 21645210772494061734726430463955231707074915293749580279327741388687068110310*i + 62225984739450865202997071369617271241348810092608626482294704825641320606694, 14572118842071162051223076904993643512402905544627821044103215186921277812496*i + 63504547636870837320642724540312613748726280369811190421219651308407770510674), (6529211642735966744323364626486352288002532267939478445216264742350974653419*i + 43426895500365913698127867498420593427453574994051597107529725996420257433857, 66636149494607064863031794353485502915121295051850619450321561966293398587284*i + 51049172134567530748763269555600518661288880531459625871071308764595168859033, 42297258788816007263333796194491196601979606573843177791726417124128570106777*i + 45527674821983322767637713856131638914194577467349514130179266972864796164733)], [(47645610858583239528541540288030905132801730740336899517917521534427703920375*i + 13272393664089987551368548207128885229248289454405159277755757369580866096516, 60503024931869977830369448001966194434192750710631225090391559259672930497207*i + 22742672333325631628906219543935772962495637869131049729874762344108069789046, 18239371575343144081671835175136676417172797381923442300525086630600561560114*i + 53605095942301227312866863441233162082087535371838738595931070092230378325532), (49652795839344946948771531270341537200526957150620826334216871981974859849848*i + 72788891932812016325514298655742330969740202920835574638161526839627026310392, 58465406030985457122487065262985150103086610852826560192123766406670919681919*i + 41631921368744416558173670147590406285376603436284660888096365325833457519047, 2867068797023070369258694926242485369317317985428997150826022662547346928319*i + 199536555238705400453079146297641296197748614855192340202929119323998667173), (19319782936524636558881137449470396788888469756320580071801690941326971557928*i + 34694728896207512382372151140975478616355941017631874070450334268575015485538, 60420266086997924618637147844041161464210208935194926422677077391866663978425*i + 13672363312837218411993834816309940812825734002380106434784905443915361955247, 56317025568717741728727542740124505299029374963112095990350877412868385510001*i + 56960621295573230601502052571104746367180500789238336757504091383665514782189)])</span></span><br><span class="line"><span class="string">F =  [(36081831373398765496490121898118275331597167308301671911642273861563666664545*i + 20818485079783326431414952124332440995164298376805349071762867760925654560129, 2080527476644284459469754065728582261439110792635520661740429151724797376184*i + 22485923248080983391383279592637691489160934672854638306617785344436031827838, 15544373162545014827602222261755865080947187122261471926061663568794038512828*i + 65994932829738499994169748656063604384011854387402875895186473718226656419067), (3553534440103543686958858303956716887328727627636404431097647427819509340361*i + 41182149981825439188243414995474733005799065992663037326956422731949977723727, 11444151159046255413538671703716370245288291793592500278345001664024824339590*i + 1802783416049323926195923226865768221398255563865542946492803065162093093803, 15739175840903697568714274177182938758189586472507039731239155962622285528109*i + 38249065906628598713138583591858150126778794837077688369911160900556744463900), (14364753807737302773559096493138893453118094354943941768609481298414054855231*i + 16290236676179704559365899211744462983770375364688247022596145726641137243214, 3863306473986430132042752882629555431418515741358351198972027547882636615940*i + 1209446834271293681961506708684952401569936830292701272655835127315444154958, 21868026584808712490812183410257662299067350008298604021123682243508255905173*i + 12828201007038003022201361213007595366913298546122923089499182187938898042596)]</span></span><br><span class="line"><span class="string">ct =  96910798667771988374291172958072220832574586618080134344021393928577220469428</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>没想到是前两天新疆的题目，赛后找鸡块要了份exp，后面有时间再复现</p>
<h3 id="step1"><a href="#step1" class="headerlink" title="step1"></a>step1</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">pt, G, A, T, S, p</span>):</span><br><span class="line">    s = randint(<span class="number">0</span>,p-<span class="number">1</span>)</span><br><span class="line">    D = G^s</span><br><span class="line">    E = A*T*A</span><br><span class="line">    F = D*E*D</span><br><span class="line">    K = <span class="built_in">list</span>(D*S*D)</span><br><span class="line">    key = <span class="built_in">sum</span>(K[<span class="number">0</span>])+<span class="built_in">sum</span>(K[<span class="number">1</span>])+<span class="built_in">sum</span>(K[<span class="number">2</span>])</span><br><span class="line">    mask = <span class="built_in">int</span>(sha256(<span class="built_in">str</span>(key).encode()).hexdigest(),<span class="number">16</span>)</span><br><span class="line">    ct = pt ^^ mask</span><br><span class="line">    <span class="keyword">return</span> ct, F</span><br><span class="line"></span><br><span class="line">p =  <span class="number">72887242108660141996862343556330151015969690949835567252527194788428065480383</span></span><br><span class="line">Fp2.&lt;i&gt; = GF(p^<span class="number">2</span>, modulus=x^<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line">M = MatrixSpace(Fp2, <span class="number">3</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">pk =  ([(<span class="number">17721183402259872020800275954210023274983052570120081248291897425608931477093</span>*i + <span class="number">32398110280895896734010284949974832063887503132353681078977206899204202173789</span>, <span class="number">54531634495057046991515273558305428867102201405617856305008554208336946545276</span>*i + <span class="number">53559176432820530464958340934397135653021175198597495321065224929188410347695</span>, <span class="number">27719945502856754481236098196014205483081586087367078493933408080194499938927</span>*i + <span class="number">1450628736387393873166171805424299538505476789523674611289973478290718453200</span>), (<span class="number">57242423786686483363839647362581564383925732392730073374546590355998555747077</span>*i + <span class="number">573726326354574516128249317235875704460857319673337707555095009277545125755</span>, <span class="number">33631043256657770245013631632455702904903259491780484310654749784948198388976</span>*i + <span class="number">17344746653834202604930860577508757708688427949046279718508635007113840369042</span>, <span class="number">37771390186920740637371383242878514021347606565375600086363978842439775164973</span>*i + <span class="number">60264754185911116825495147907207494752330900415794996812483089251259003404228</span>), (<span class="number">1163730453993018743008743150834548760986076138562570206571825145859591284352</span>*i + <span class="number">69245390362211526197537288211735612650619880945856387683074182933575799994162</span>, <span class="number">11137807706588795799057940108843238078078690609437386007163034291855328303661</span>*i + <span class="number">50795522649623533714787572047531722836395032085224035511036953078383612475598</span>, <span class="number">14354786571703727534706086386589187674076604263117377684131521866407943036307</span>*i + <span class="number">63028649680815097939155846824928638616844025040257105384123424769274942520895</span>)], [(<span class="number">22137116252880790433838296157765927318220905592359967466680754349755815464341</span>*i + <span class="number">35503968364379821899511866562472775961434113516937033217642581531414863539290</span>, <span class="number">38346074307552448152239080224505166810289185210503265380269711384969731945517</span>*i + <span class="number">9333819647786551924409858116441570177115099865486742684028611902450000042407</span>, <span class="number">24608192510515673607042276468532809071945836783394960695059783085937608049755</span>*i + <span class="number">27099766371861599260580052331632986107092105438254563604629919595057370886149</span>), (<span class="number">57539731529782952718529369617033412770127782205874818027724894673104814770991</span>*i + <span class="number">12431864123786174601413168140961685219607645783666490625760143190724674574386</span>, <span class="number">33510082449726132893492104159133966168598115972734064630878005553829725389082</span>*i + <span class="number">30594711977745700371548334707069524826346332947574826081979927125841475148328</span>, <span class="number">8911862104171403632946802970568635607253840071000107875759139060453368618583</span>*i + <span class="number">51594672749496705581452789883241278156858476777167382827032876227546058970732</span>), (<span class="number">58105830161247358431125768499050987088161417325586965601350797391396603985470</span>*i + <span class="number">10949064084676782939947256128733523229613253182051362970560478801614590446300</span>, <span class="number">6665352489343222248969975791152178151760060704226637217535985452272551528693</span>*i + <span class="number">16163109497937280055564868323730465088174193174761590036929535644203224067166</span>, <span class="number">26147088265849488467397913386934580340556987670869413865359802108333761377560</span>*i + <span class="number">14170094609019059182842713618319151553137248441974849089555832123638494739417</span>)], [(<span class="number">60066006389024369318961505483331049048095679333675437984483948643792214278503</span>*i + <span class="number">67617085525047580942273623886038114942547589259839196477555874755427651308048</span>, <span class="number">38692305959834079988532869421062338838072016075793686080934562521314366274998</span>*i + <span class="number">21104829450473981189549299039898127784065322316764325995863199136802573514</span>, <span class="number">7207625628360021282792621977024027446511231977201394776410095364976996279450</span>*i + <span class="number">23039079766688651678553952766794875180844089420934577132338235904018762773928</span>), (<span class="number">10808368042897084491009063074724200907600038030639153659288985642861405920614</span>*i + <span class="number">33955795465220353002933680692690511153845418737513482128237117905262919879043</span>, <span class="number">21645210772494061734726430463955231707074915293749580279327741388687068110310</span>*i + <span class="number">62225984739450865202997071369617271241348810092608626482294704825641320606694</span>, <span class="number">14572118842071162051223076904993643512402905544627821044103215186921277812496</span>*i + <span class="number">63504547636870837320642724540312613748726280369811190421219651308407770510674</span>), (<span class="number">6529211642735966744323364626486352288002532267939478445216264742350974653419</span>*i + <span class="number">43426895500365913698127867498420593427453574994051597107529725996420257433857</span>, <span class="number">66636149494607064863031794353485502915121295051850619450321561966293398587284</span>*i + <span class="number">51049172134567530748763269555600518661288880531459625871071308764595168859033</span>, <span class="number">42297258788816007263333796194491196601979606573843177791726417124128570106777</span>*i + <span class="number">45527674821983322767637713856131638914194577467349514130179266972864796164733</span>)], [(<span class="number">47645610858583239528541540288030905132801730740336899517917521534427703920375</span>*i + <span class="number">13272393664089987551368548207128885229248289454405159277755757369580866096516</span>, <span class="number">60503024931869977830369448001966194434192750710631225090391559259672930497207</span>*i + <span class="number">22742672333325631628906219543935772962495637869131049729874762344108069789046</span>, <span class="number">18239371575343144081671835175136676417172797381923442300525086630600561560114</span>*i + <span class="number">53605095942301227312866863441233162082087535371838738595931070092230378325532</span>), (<span class="number">49652795839344946948771531270341537200526957150620826334216871981974859849848</span>*i + <span class="number">72788891932812016325514298655742330969740202920835574638161526839627026310392</span>, <span class="number">58465406030985457122487065262985150103086610852826560192123766406670919681919</span>*i + <span class="number">41631921368744416558173670147590406285376603436284660888096365325833457519047</span>, <span class="number">2867068797023070369258694926242485369317317985428997150826022662547346928319</span>*i + <span class="number">199536555238705400453079146297641296197748614855192340202929119323998667173</span>), (<span class="number">19319782936524636558881137449470396788888469756320580071801690941326971557928</span>*i + <span class="number">34694728896207512382372151140975478616355941017631874070450334268575015485538</span>, <span class="number">60420266086997924618637147844041161464210208935194926422677077391866663978425</span>*i + <span class="number">13672363312837218411993834816309940812825734002380106434784905443915361955247</span>, <span class="number">56317025568717741728727542740124505299029374963112095990350877412868385510001</span>*i + <span class="number">56960621295573230601502052571104746367180500789238336757504091383665514782189</span>)])</span><br><span class="line">F =  [(<span class="number">36081831373398765496490121898118275331597167308301671911642273861563666664545</span>*i + <span class="number">20818485079783326431414952124332440995164298376805349071762867760925654560129</span>, <span class="number">2080527476644284459469754065728582261439110792635520661740429151724797376184</span>*i + <span class="number">22485923248080983391383279592637691489160934672854638306617785344436031827838</span>, <span class="number">15544373162545014827602222261755865080947187122261471926061663568794038512828</span>*i + <span class="number">65994932829738499994169748656063604384011854387402875895186473718226656419067</span>), (<span class="number">3553534440103543686958858303956716887328727627636404431097647427819509340361</span>*i + <span class="number">41182149981825439188243414995474733005799065992663037326956422731949977723727</span>, <span class="number">11444151159046255413538671703716370245288291793592500278345001664024824339590</span>*i + <span class="number">1802783416049323926195923226865768221398255563865542946492803065162093093803</span>, <span class="number">15739175840903697568714274177182938758189586472507039731239155962622285528109</span>*i + <span class="number">38249065906628598713138583591858150126778794837077688369911160900556744463900</span>), (<span class="number">14364753807737302773559096493138893453118094354943941768609481298414054855231</span>*i + <span class="number">16290236676179704559365899211744462983770375364688247022596145726641137243214</span>, <span class="number">3863306473986430132042752882629555431418515741358351198972027547882636615940</span>*i + <span class="number">1209446834271293681961506708684952401569936830292701272655835127315444154958</span>, <span class="number">21868026584808712490812183410257662299067350008298604021123682243508255905173</span>*i + <span class="number">12828201007038003022201361213007595366913298546122923089499182187938898042596</span>)]</span><br><span class="line">ct =  <span class="number">96910798667771988374291172958072220832574586618080134344021393928577220469428</span></span><br><span class="line"></span><br><span class="line">A, T, S, G = [M(ii) <span class="keyword">for</span> ii <span class="keyword">in</span> pk]</span><br><span class="line">F = M(F)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################################### attack</span></span><br><span class="line">E = A*T*A</span><br><span class="line">detA, detT, detS, detG, detE, detF = A.det(), T.det(), S.det(), G.det(), E.det(), F.det()</span><br><span class="line">r = <span class="number">2244966557637008779362441591080406338119704738381872153797151</span></span><br><span class="line"><span class="comment">#R = 80839783875482453208291688688697485912290384775841712705111124172946909733768714734343762988749579725275997021760357500939</span></span><br><span class="line"><span class="comment">#r = discrete_log(detG^R, ((detA^(-1)*detT).sqrt())^R, ord=(p^2-1)//R)</span></span><br><span class="line"><span class="comment">#s = discrete_log(((detA^(-2)*detT^(-1)*detF).sqrt())^R, detG^R, ord=(p^2-1)//R)</span></span><br><span class="line"><span class="comment">#not enough so use cado-nfs</span></span><br></pre></td></tr></table></figure>

<p>这里不够，用上cado-nfs</p>
<h3 id="step2"><a href="#step2" class="headerlink" title="step2"></a>step2</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">command = [</span><br><span class="line">    <span class="string">&#x27;./cado-nfs.py&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-dlp&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-ell&#x27;</span>, <span class="built_in">str</span>(r),</span><br><span class="line">    <span class="string">&#x27;target=&#x27;</span>+<span class="built_in">str</span>(t1),</span><br><span class="line">    <span class="built_in">str</span>(p)</span><br><span class="line">]</span><br><span class="line"><span class="comment">#1541758195020130454925136833461872657607368759409055632195831</span></span><br><span class="line"></span><br><span class="line">command = [</span><br><span class="line">    <span class="string">&#x27;./cado-nfs.py&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-dlp&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;-ell&#x27;</span>, <span class="built_in">str</span>(r),</span><br><span class="line">    <span class="string">&#x27;target=&#x27;</span>+<span class="built_in">str</span>(t2),</span><br><span class="line">    <span class="built_in">str</span>(p)</span><br><span class="line">]</span><br><span class="line"><span class="comment">#780392429787953543532147509264510635118839088869098098140941</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    result = subprocess.run(command, check=<span class="literal">True</span>, text=<span class="literal">True</span>, capture_output=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(result.stdout)</span><br><span class="line"><span class="keyword">except</span> subprocess.CalledProcessError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ERROR: <span class="subst">&#123;e.returncode&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ERROR:&quot;</span>, e.stderr)</span><br></pre></td></tr></table></figure>

<h3 id="step3"><a href="#step3" class="headerlink" title="step3"></a>step3</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#t2^s = t1</span></span><br><span class="line">Fr = GF(r)</span><br><span class="line">s1 = Fr(<span class="number">1541758195020130454925136833461872657607368759409055632195831</span>)</span><br><span class="line">s2 = Fr(<span class="number">780392429787953543532147509264510635118839088869098098140941</span>)</span><br><span class="line">ss = discrete_log(<span class="built_in">pow</span>(t1, <span class="number">6</span>*r, p), <span class="built_in">pow</span>(t2, <span class="number">6</span>*r, p), operation=<span class="string">&quot;*&quot;</span>, <span class="built_in">ord</span>=(p-<span class="number">1</span>)//r)</span><br><span class="line">s = crt([<span class="built_in">int</span>(ss), <span class="built_in">int</span>(s1/s2)], [(p-<span class="number">1</span>)//(<span class="number">6</span>*r), r])</span><br><span class="line"></span><br><span class="line">ss = s</span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    s = ss + ii * (p-<span class="number">1</span>) // <span class="number">6</span></span><br><span class="line">    D = G^<span class="built_in">int</span>(s)</span><br><span class="line">    K = <span class="built_in">list</span>(D*S*D)</span><br><span class="line">    key = <span class="built_in">sum</span>(K[<span class="number">0</span>])+<span class="built_in">sum</span>(K[<span class="number">1</span>])+<span class="built_in">sum</span>(K[<span class="number">2</span>])</span><br><span class="line">    mask = <span class="built_in">int</span>(sha256(<span class="built_in">str</span>(key).encode()).hexdigest(),<span class="number">16</span>)</span><br><span class="line">    pt = ct ^^ mask</span><br><span class="line">    <span class="keyword">if</span>(D.det()*detE*D.det() == detF):</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(pt))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#QAQ~4_Br0ken_Crypto_Sy5tem~TAT</span></span><br></pre></td></tr></table></figure>




<h1 id="DS"><a href="#DS" class="headerlink" title="DS"></a>DS</h1><h2 id="findphone"><a href="#findphone" class="headerlink" title="findphone"></a>findphone</h2><p>题目要求：</p>
<p><img src="/../../images/%E6%9D%82/57.png"></p>
<blockquote>
<p>data.txt</p>
</blockquote>
<p>是一段极长的文本，要求从这里面提取出734等开头的电话号码，并且存放到csv文件中。</p>
<p>写个正则就好了</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">tmp = [<span class="number">734</span>, <span class="number">735</span>, <span class="number">736</span>, <span class="number">737</span>, <span class="number">738</span>, <span class="number">739</span>, <span class="number">747</span>, <span class="number">748</span>, <span class="number">750</span>, <span class="number">751</span>, <span class="number">752</span>, <span class="number">757</span>, <span class="number">758</span>, <span class="number">759</span>, <span class="number">772</span>, <span class="number">778</span>, </span><br><span class="line"><span class="number">782</span>, <span class="number">783</span>, <span class="number">784</span>, <span class="number">787</span>, <span class="number">788</span>, <span class="number">795</span>, <span class="number">798</span>, <span class="number">730</span>, <span class="number">731</span>, <span class="number">732</span>, <span class="number">740</span>, <span class="number">745</span>, <span class="number">746</span>, <span class="number">755</span>, <span class="number">756</span>, <span class="number">766</span>, </span><br><span class="line"><span class="number">767</span>, <span class="number">771</span>, <span class="number">775</span>, <span class="number">776</span>, <span class="number">785</span>, <span class="number">786</span>, <span class="number">796</span>, <span class="number">733</span>, <span class="number">749</span>, <span class="number">753</span>, <span class="number">773</span>, <span class="number">774</span>, <span class="number">777</span>, <span class="number">780</span>, <span class="number">781</span>, <span class="number">789</span>, </span><br><span class="line"><span class="number">790</span>, <span class="number">791</span>, <span class="number">793</span>, <span class="number">799</span>]</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;output.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">writer = csv.writer(f)</span><br><span class="line">head = [<span class="string">&#x27;category&#x27;</span>,<span class="string">&#x27;value&#x27;</span>]</span><br><span class="line">writer.writerow(head)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">    t = <span class="built_in">str</span>(i).encode()</span><br><span class="line">    pattern = t + <span class="string">rb&#x27;\d&#123;8&#125;&#x27;</span></span><br><span class="line">    matches = re.findall(pattern, data)</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        <span class="built_in">print</span>(<span class="keyword">match</span>)</span><br><span class="line">        message = [<span class="string">&#x27;phone&#x27;</span>,<span class="keyword">match</span>.decode()]</span><br><span class="line">        writer.writerow(message)</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/%E6%9D%82/58.png"></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>开赛半小时把3道密码秒了(3个一血，题目挺简单的，<del>小人得志一下</del>)，然后转眼做了下数据安全相关的，发现也不难，顺手拿了个二血。此时分数已经是第二名的两倍了，当我以为比赛会比较轻松的时候，午饭过后大家集体顿悟，好在下午队友发力了，侥幸拿下。</p>
<p><img src="/../../images/%E6%9D%82/59.png"></p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" title="2024第二届福建省数据安全大赛">https://dexterjie.github.io/2024/12/01/赛题复现/2024第二届福建省数据安全大赛/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/11/23/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/" rel="prev" title="网鼎杯半决赛">
                  <i class="fa fa-chevron-left"></i> 网鼎杯半决赛
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/12/05/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%E8%B5%9B/" rel="next" title="2024强网杯线下赛">
                  2024强网杯线下赛 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">299k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">18:08</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/12/01/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E7%AC%AC%E4%BA%8C%E5%B1%8A%E7%A6%8F%E5%BB%BA%E7%9C%81%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
