<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录b01lersCTF——Crypto题解">
<meta property="og:type" content="article">
<meta property="og:title" content="b01lersCTF">
<meta property="og:url" content="https://dexterjie.github.io/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录b01lersCTF——Crypto题解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/TPCTF/18.png">
<meta property="article:published_time" content="2024-04-14T13:02:05.000Z">
<meta property="article:modified_time" content="2024-04-17T11:52:07.844Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/TPCTF/18.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/","path":"2024/04/14/赛题复现/b01lersCTF/","title":"b01lersCTF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>b01lersCTF | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#choose-the-param"><span class="nav-number">1.</span> <span class="nav-text">choose_the_param</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#half-big-rsa"><span class="nav-number">2.</span> <span class="nav-text">half-big-rsa</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%951"><span class="nav-number">2.1.</span> <span class="nav-text">法1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%952"><span class="nav-number">2.2.</span> <span class="nav-text">法2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fetus-RSA"><span class="nav-number">3.</span> <span class="nav-text">Fetus-RSA</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#schnore"><span class="nav-number">4.</span> <span class="nav-text">schnore</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#shamir-for-dummies%E2%80%94%E2%80%94%E6%B2%A1%E5%81%9A"><span class="nav-number">5.</span> <span class="nav-text">shamir-for-dummies——没做</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#count-the-counter%E2%80%94%E2%80%94%E6%B2%A1%E5%81%9A"><span class="nav-number">6.</span> <span class="nav-text">count_the_counter——没做</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">72</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="b01lersCTF | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          b01lersCTF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-04-14 21:02:05" itemprop="dateCreated datePublished" datetime="2024-04-14T21:02:05+08:00">2024-04-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-17 19:52:07" itemprop="dateModified" datetime="2024-04-17T19:52:07+08:00">2024-04-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录b01lersCTF——Crypto题解</p>
<span id="more"></span>

<h1 id="choose-the-param"><a href="#choose-the-param" class="headerlink" title="choose_the_param"></a>choose_the_param</h1><blockquote>
<p>nc gold.b01le.rs 5001</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">padded_flag = os.urandom(<span class="number">200</span>) + flag + os.urandom(<span class="number">200</span>)</span><br><span class="line">m = bytes_to_long(padded_flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chal</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;Choose your parameter</span></span><br><span class="line"><span class="string">Enter the bit length of the prime!</span></span><br><span class="line"><span class="string">I&#x27;ll choose two prime of that length, and encrypt the flag using rsa.</span></span><br><span class="line"><span class="string">Try decrypt the flag!    </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        bits = <span class="built_in">input</span>(<span class="string">&quot;Enter the bit length of your primes&gt; &quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            bit_len = <span class="built_in">int</span>(bits)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;please enter a valid intergar&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        p1 = getPrime(bit_len)</span><br><span class="line">        p2 = getPrime(bit_len)</span><br><span class="line"></span><br><span class="line">        n = p1 * p2</span><br><span class="line">        e = <span class="number">65537</span></span><br><span class="line">        c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n:x&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e:x&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c:x&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    chal()</span><br></pre></td></tr></table></figure>

<p>flag长度很长，大概450左右。思路是让$p,q$比较小，使得n很好分解，然后不断求解m，最后crt</p>
<p>我选择的素数是64bit的，生成128bit的n。大概交互32次就可以恢复完整的flag</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> factor,CRT_list</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;gold.b01le.rs&quot;</span>,<span class="number">5001</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Try decrypt the flag! &quot;</span>)</span><br><span class="line">N = []</span><br><span class="line">M = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> trange(<span class="number">32</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">&quot;Enter the bit length of your primes&gt; &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;64&quot;</span>)</span><br><span class="line">    n = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    e = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    N.append(n)</span><br><span class="line">    phi = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> factor(n):</span><br><span class="line">        phi *= i[<span class="number">0</span>] - <span class="number">1</span></span><br><span class="line">    d = gmpy2.invert(e,phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    M.append(m)</span><br><span class="line"></span><br><span class="line">msg = CRT_list(M,N)</span><br><span class="line">flag = long_to_bytes(msg)</span><br><span class="line"><span class="comment"># bctf&#123;dont_let_the_user_choose_the_prime_length_&gt;w&lt;&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="half-big-rsa"><a href="#half-big-rsa" class="headerlink" title="half-big-rsa"></a>half-big-rsa</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">num_bits = <span class="number">4096</span></span><br><span class="line">e = (num_bits - <span class="number">1</span>) * <span class="number">2</span></span><br><span class="line">n = getPrime(num_bits)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(<span class="string">&quot;e = &#123;0&#125;\n&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line">	f.write(<span class="string">&quot;n = &#123;0&#125;\n&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">	f.write(<span class="string">&quot;c = &#123;0&#125;\n&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">e = 8190</span></span><br><span class="line"><span class="string">n = 665515140120452927777672138241759151799589898667434054796291409500701895847040006534274017960741836352283431369658890777476904763064058571375981053480910502427450807868148119447222740298374306206049235106218160749784482387828757815767617741823504974133549502118215185814010416478030136723860862951197024098473528800567738616891653602341160421661595097849964546693006026643728700179973443277934626276981932233698776098859924467510432829393769296526806379126056800758440081227444482951121929701346253100245589361047368821670154633942361108165230244033981429882740588739029933170447051711603248745453079617578876855903762290177883331643511001037754039634053638415842161488684352411211039226087704872112150157895613933727056811203840732191351328849682321511563621522716119495446110146905479764695844458698466998084615534512596477826922686638159998900511018901148179784868970554998882571043992165232556707995154316126421679595109794273650628957795546293370644405017478289280584942868678139801608538607476925924119532501884957937405840470383051787503858934204828174270819328204062103187487600845013162433295862838022726861622054871029319807982173856563380230936757321006235403066943155942418392650327854150659087958008526462507871976852849</span></span><br><span class="line"><span class="string">c = 264114212766855887600460174907562771340758069941557124363722491581842654823497784410492438939051339540245832405381141754278713030596144467650101730615738854984455449696059994199389876326336906564161058000092717176985620153104965134542134700679600848779222952402880980397293436788260885290623102864133359002377891663502745146147113128504592411055578896628007927185576133566973715082995833415452650323729270592804454136123997392505676446147317372361704725254801818246172431181257019336832814728581055512990705620667354025484563398894047211101124793076391121413112862668719178137133980477637559211419385463448196568615753499719509551081050176747554502163847399479890373976736263256211300138385881514853428005401803323639515624537818822552343927090465091651711036898847540315628282568055822817711675290278630405760056752122426935056309906683423667413310858931246301024309863011027878238814311176040130230980947128260455261157617039938807829728147629666415078365277247086868327600962627944218138488810350881273304037069779619294887634591633069936882854003264469618591009727405143494184122164870065700859379313470866957332849299246770925463579384528152251689152374836955250625216486799615834558624798907067202005564121699019508857929778460</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="法1"><a href="#法1" class="headerlink" title="法1"></a>法1</h2><p>题目给的信息很少，抱着试试看的心态用<code>nthroot</code>跑了一下，大概20分钟出结果</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">8190</span></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">res = Zmod(n)(c).nth_root(e, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> res:</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="comment"># bctf&#123;Pr1M3_NUM83r5_4r3_C001_bu7_7H3Y_4r3_57r0N6_0N1Y_WH3N_7H3Y_4r3_MU171P113D_3V3N_1F_7H3Y_4r3_b1g&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="法2"><a href="#法2" class="headerlink" title="法2"></a>法2</h2><p>赛后和鸡块师傅交流的时候才发现，我比赛的时候没注意n是个素数可以求$\phi(n)$，正常思路应该是直接求d，但是发现$e$和$\phi(n)$的公因数是18</p>
<p>直接用<code>nthroot</code>确实可以出，但是我们可以加快速度，思路如下<br>$$<br>\because c \equiv m^{8190} \mod n<br>$$</p>
<p>$$<br>c \equiv m^{18\times 455} \mod n<br>$$</p>
<p>$$<br>\therefore c^{455^{-1}} \equiv m^{18\times 455\times 455^{-1}} \equiv m^{18} \mod n<br>$$</p>
<p>求得这个新的$c$，再用<code>nthroot</code></p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">8190</span></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">phi = n - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># t = gmpy2.gcd(e,phi)</span></span><br><span class="line"><span class="comment"># print(t)</span></span><br><span class="line"><span class="comment"># 18</span></span><br><span class="line"></span><br><span class="line">inv = gmpy2.invert(<span class="number">455</span>,phi)</span><br><span class="line"></span><br><span class="line">cc = <span class="built_in">pow</span>(c,inv,n)</span><br><span class="line">res = Zmod(n)(cc).nth_root(<span class="number">18</span>, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> res:</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>奇怪的是，还是跑了18分钟这么久</p>
<h1 id="Fetus-RSA"><a href="#Fetus-RSA" class="headerlink" title="Fetus-RSA"></a>Fetus-RSA</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime, isPrime</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> matrix, Zmod</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextPrime</span>(<span class="params">prim</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(prim):</span><br><span class="line">        <span class="keyword">return</span> prim</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> nextPrime(prim+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">128</span>)</span><br><span class="line">p2 = nextPrime(p1 * <span class="number">1</span>)</span><br><span class="line">p3 = nextPrime(p2 * <span class="number">3</span>)</span><br><span class="line">p4 = nextPrime(p3 * <span class="number">3</span>)</span><br><span class="line">p5 = nextPrime(p4 * <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">primes = [p1, p2, p3, p4, p5]</span><br><span class="line"></span><br><span class="line">n = p1 * p2 * p3 * p4 * p5</span><br><span class="line"></span><br><span class="line">fragments = [bytes_to_long(flag[<span class="number">5</span>*i:<span class="number">5</span>*i+<span class="number">5</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>)]</span><br><span class="line"></span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line">topG = matrix(Zmod(n), [[fragments[<span class="number">5</span>*i + j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)])</span><br><span class="line">bottomG = topG ** e</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>\n\n&quot;</span>)</span><br><span class="line">    file.write(<span class="string">&quot;Ciphertext Matrix:\n\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> bottomG:</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> row:</span><br><span class="line">            file.write(<span class="built_in">str</span>(num) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">        file.write(<span class="string">&quot;\n\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>先分解n，可以发现n是5个比较接近的素数之积，其实$n \approx 1701p^5$(这个值可能记错了，师傅们可以自己算一下)</p>
<p>把n除掉1701之后再开5次方得到一个比较接近p的值，然后做一个简单的爆破就可以得到$p$，再依次求出其他因子</p>
<p>然后是把flag每5个作为一组，转成数值后作为矩阵的元素，矩阵是$5\times 5$的规模，所以flag长度为125(这个不重要)</p>
<p>再对明文矩阵做了$e$次方的运算。</p>
<p>这题其实就类似于RSA，我们需要求一个$d$，满足$ed \equiv 1 \mod order$，order指的是模n下一般线性群的阶，在<a target="_blank" rel="noopener" href="https://tover.xyz/p/Order-GLnFp/">Tover师傅的博客</a>中有关于一般线性群阶的知识。</p>
<p><img src="/../../images/TPCTF/18.png"></p>
<p>注意到这个p是128bit的值，所以我们不需要在模n下求解，只需要在模p下求解。因此只需要求模p下5阶方阵的阶</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextPrime</span>(<span class="params">prim</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(prim):</span><br><span class="line">        <span class="keyword">return</span> prim</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> nextPrime(prim+<span class="number">1</span>)</span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line">n = <span class="number">515034877787990680304726859216098826737559607654653680536655175803818486402820694536785452537613547240092505793262824199243610743308333164103851365420630137187276313271869670701737383708742526677</span></span><br><span class="line">t = gmpy2.iroot(n//<span class="number">1701</span>,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(1000):</span></span><br><span class="line"><span class="comment">#     p = t - i</span></span><br><span class="line"><span class="comment">#     if isPrime(p):</span></span><br><span class="line">        <span class="comment"># print(f&quot;p = &#123;p&#125;&quot;)</span></span><br><span class="line">        </span><br><span class="line">p = <span class="number">197800081090910969169502702324035680453</span></span><br><span class="line">p1 = p</span><br><span class="line">p2 = nextPrime(p1 * <span class="number">1</span>)</span><br><span class="line">p3 = nextPrime(p2 * <span class="number">3</span>)</span><br><span class="line">p4 = nextPrime(p3 * <span class="number">3</span>)</span><br><span class="line">p5 = nextPrime(p4 * <span class="number">7</span>)</span><br><span class="line">n = p1*p2*p3*p4*p5</span><br><span class="line"></span><br><span class="line">order_p = p*(p-<span class="number">1</span>)*(p+<span class="number">1</span>)*(p^<span class="number">2</span>+p+<span class="number">1</span>)*(p^<span class="number">2</span>+<span class="number">1</span>)*(p^<span class="number">4</span>+p^<span class="number">3</span>+p^<span class="number">2</span>+p+<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,order_p)</span><br><span class="line"></span><br><span class="line">C = Matrix(Zmod(p),[</span><br><span class="line">    [<span class="number">247714609729115034577268860647809503348452679955541765864525644036519903244610407544592438833012659821363982836831477850927621505723503202914955484784761468695340160789629882004055804409080695867</span>,<span class="number">331625142917011732363496584111977497826539848810596405639715608289185491230192921594585113936516744954068559616963395888825085234835086592835782522823153199824647815923311303312529222423487842184</span>,<span class="number">55437288185949549641415195099137917985198178875175317590356850868652628068256771878957686344008331498612071069691453711091201145528626750365270496738628725699281809961803599963127434726167609435</span>,<span class="number">514660916099185196031776141538776359410382339048282799109733569738126784171011249457518653961429789338579350043906060924939800730829826389077489637524528092592193187169747629063004980325000389554</span>,<span class="number">432908737089369750416720813650504950741227543859957288298129130571557758647818791153409184252564534925607409378801765727301405467691263041798341098982058861749568674152447781841703730861074171486</span>],</span><br><span class="line">    [<span class="number">104171307746966345345857299403770324392522334886728513788970028646835780770090370816961277474173463662053179135418083415763603092683905102293259569143230591686555033557056635683615214642425173517</span>,<span class="number">281995809329109899498417283591516891672267505291547187769414960759245222376040526984420670509684233818236456944690830422135256653807646369718495017051487254128669606210585168140190305476396414836</span>,<span class="number">448210297704655248563230644309382726474650012116320871206976601497778210586480264554625801730855872456388662647389829317946932942681549854741993522145903386318540208729036379511878276729211658861</span>,<span class="number">399193502999265141959383452857091791757532600793923480036782294759164203783245516880539439411508616363396395258745387111132143827593272610961260623660064934154238955120293971424750525097551648180</span>,<span class="number">448909699677346701183758951038319440723583288307818355958233994863175886710495171317606803723159576428485212274726596045235998230677229224379125716760136092533604817049730746550292371970711497032</span>],</span><br><span class="line">    [<span class="number">10383824979618791372207750490225860866360446289011667617367731854443817405025701872398853456038612719059056477356275566409859556622099910727870579661815727983662245805512246175424036918556245316</span>,<span class="number">3042212133475156282375315438954933898496627384941849067508473136817427432524109900983912625376319043681252528210663860374506706029777992048856493297280439498831646567645849063286941560111486091</span>,<span class="number">303901520908845557762276355500926092138935908381564097855093945643653520650021074626397106363589843089839561176214123648988682404983806374183953260408815900582907133898417354283905163971086566554</span>,<span class="number">385414980407334346707284477209921028250475161696209076212214696858828374481374774762344617183479700018626970039426895699261230837253656355202103718574806419224338390036737550645417315148014935208</span>,<span class="number">172437598435610362668691083369422058178612127588567286669952095014310724933793758671802664372505747578789080527221296229242137567445447449560987571505575740311394634799579166058011734727404038041</span>],</span><br><span class="line">    [<span class="number">459726837943530454128170171077760511486009487765694189770202436458018005866133157577824055980174845256397040485330898693944501922148000904627621334536523927325451030816598478315788682056071758797</span>,<span class="number">318766645374831072244114015670117551595181174553017703335802708316885112551395705202907958737214488185739954176085085611052360624160681549561415131064529778955941226762589967588568203157586014646</span>,<span class="number">485361005374731090711430490780588207888099824436671620066599360058262282812311497518237782819588602409946446254729349547214950452718084694554650900064587640931729162822096611158015732013679765115</span>,<span class="number">442488981185685119421099225895492967006907103880489001122993678677306129218035946328038537612725434883858276836497639772750576738969390151812664236525222680918250542360570252193283310559820113337</span>,<span class="number">294017672174100375503817924437430140826863578191649796300540064690169411498877218939778928997294952104395700469268399214549954967540991489929488976904050382049934179672641195866868009511101289284</span>],</span><br><span class="line">    [<span class="number">394288980150370144394508377797340867635320394706221783789360450886862330500083595146934277232717671435601428999455723360437715407992902972393377872146437245909234935183690525050686313034961250106</span>,<span class="number">174537062539250527750306397111216900339583030576848484858177223085331307339246744122607759453386390209872407563526999813562242756044330978624067706177762337375480164381575660119163723806663394768</span>,<span class="number">167378817268639407255382001659131271694745168867873206910416580974376327982114272760583238198872032832961214636912981493082249850676384736073683786291369414678559758485110038329085571864758144806</span>,<span class="number">479478683656492256273719495784577239188841595512723735000697935028851355713461770920044121053505358284609828319371252306609569657211738503902322975549066701614139339082341370785743668742796520457</span>,<span class="number">468925056254460005965810812432459057693038841264871939568448625553319440670497244388153862616274082271409346691280049609288322448351851208172939513793874861880752049454593563028452119997997329883</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">M = C ** d</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(row)):</span><br><span class="line">        flag += long_to_bytes(<span class="built_in">int</span>(row[i]))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># bctf&#123;c0ngr4ts_y0u_35c4p3d_th3_m4tr1c3s, but really how? what color is your honda civic? sorry i just need to make this long.&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="schnore"><a href="#schnore" class="headerlink" title="schnore"></a>schnore</h1><blockquote>
<p>nc gold.b01le.rs 5005</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA512</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># FIPS 186-4 Appendix A.1/A.2 compliant prime order q group and prime order p field</span></span><br><span class="line"><span class="comment">#from Crypto.PublicKey import DSA as FFCrypto</span></span><br><span class="line"><span class="comment">#(p,q,g) = FFCrypto.generate(2048).domain()</span></span><br><span class="line">p = <span class="number">32148430219533869432664086521225476372736462680273996089092113172047080583085077464347995262368698415917196323365668601969574610671154445337781821758494432339987784268234681352859122106315479086318464461728521502980081310387167105996276982251134873196176224643518299733023536120537865020373805440309261518826398579473063255138837294134742678213639940734783340740545998610498824621665838546928319540277854869576454258917970187451361767420622980743233300167354760281479159013996441502511973279207690493293107263225937311062981573275941520199567953333720369198426993035900390396753409748657644625989750046213894003084507</span></span><br><span class="line">q = <span class="number">25652174680121164880516494520695513229510497175386947962678706338003</span></span><br><span class="line">g = <span class="number">23174059265967833044489655691705592548904322689090091191484900111607834369643418104621577292565175857016629416139331387500766371957528415587157736504641585483964952733970570756848175405454138833698893579333073195074203033602295121523371560057410727051683793079669493389242489538716350397240122001054430034016363486006696176634233182788395435344904669454373990351188986655669637138139377076507935928088813456234379677586947957539514196648605649464537827962024445144040395834058714447916981049408310960931998389623396383151616168556706468115596486100257332107454218361019929061651117632864546163172189693989892264385257</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prove</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;The oracles say that X is g^x and A is g^a. Be that as it may...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Perhaps there exists a way to make their confidence sway!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># (Sorry, can&#x27;t choose a :)</span></span><br><span class="line">    A = <span class="number">30210424620845820052071225945109142323820182565373787589801116895962027171575049058295156742156305996469210267854774935518505743920438652976152675486476209694284460060753584821225066880682226097812673951158980930881565165151455761750621260912545169247447437218263919470449873682069698887953001819921915874928002568841432197395663420509941263729040966054080025218829347912646803956034554112984570671065110024224236097116296364722731368986065647624353094691096824850694884198942548289196057081572758803944199342980170036665636638983619866569688965508039554384758104832379412233201655767221921359451427988699779296943487</span></span><br><span class="line"></span><br><span class="line">    h = SHA512.new(truncate=<span class="string">&quot;256&quot;</span>)</span><br><span class="line">    h.update(number.long_to_bytes(g) + number.long_to_bytes(p) + number.long_to_bytes(A))</span><br><span class="line">    c = number.bytes_to_long(h.digest()) % p</span><br><span class="line"></span><br><span class="line">    z = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;a + cx = &quot;</span>)) % p</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (A,c,z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&gt; I&#x27;m so sleepy, I almost forgot; we should share what we ought.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&gt; Just between you and me, can we agree on a verifying key...?&quot;</span>)</span><br><span class="line">    X = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt; X = &quot;</span>)) % p</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> X</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">A,c,z,X</span>):</span><br><span class="line">    h = SHA512.new(truncate=<span class="string">&quot;256&quot;</span>)</span><br><span class="line">    h.update(number.long_to_bytes(g) + number.long_to_bytes(p) + number.long_to_bytes(A))</span><br><span class="line">    cp = number.bytes_to_long(h.digest()) % p</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> c != cp <span class="keyword">or</span> <span class="built_in">pow</span>(g, z, p) != ((A * <span class="built_in">pow</span>(X, c, p)) % p):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt; Oh, even my bleary eyes can tell your evidence is fau x !!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt; Are you sure that what you say is what you truly know?&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt; &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    (A,c,z) = prove()</span><br><span class="line">    X = setup()</span><br><span class="line">    verify(A,c,z,X)</span><br></pre></td></tr></table></figure>

<p><code>c == cp</code>这个不需要在意，他自然就是满足的，主要是要让另外一边相等。我们能够控制<code>z</code>和<code>X</code></p>
<p>很巧妙的构思让$z &#x3D; 0$，于是<code>pow(g,z,p) = 0</code>，右边就要想办法让$X^c \equiv A^{-1} \mod p$</p>
<p>很自然的能想到类似RSA的思路，让$X \equiv (A^{-1})^e \mod p$，这个$e$需要满足$ec \equiv 1 \mod \phi(p)$</p>
<p>于是$X^c \equiv (A^{-1})^{ec} \equiv A^{-1} \mod p$</p>
<p>实际实现的时候可以发现，e与$\phi(p)$是不互素的，此时要注意到题目说了这个群的阶是$q$，可以转化到求$ec \equiv 1 \mod q$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA512</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">32148430219533869432664086521225476372736462680273996089092113172047080583085077464347995262368698415917196323365668601969574610671154445337781821758494432339987784268234681352859122106315479086318464461728521502980081310387167105996276982251134873196176224643518299733023536120537865020373805440309261518826398579473063255138837294134742678213639940734783340740545998610498824621665838546928319540277854869576454258917970187451361767420622980743233300167354760281479159013996441502511973279207690493293107263225937311062981573275941520199567953333720369198426993035900390396753409748657644625989750046213894003084507</span></span><br><span class="line">q = <span class="number">25652174680121164880516494520695513229510497175386947962678706338003</span></span><br><span class="line">g = <span class="number">23174059265967833044489655691705592548904322689090091191484900111607834369643418104621577292565175857016629416139331387500766371957528415587157736504641585483964952733970570756848175405454138833698893579333073195074203033602295121523371560057410727051683793079669493389242489538716350397240122001054430034016363486006696176634233182788395435344904669454373990351188986655669637138139377076507935928088813456234379677586947957539514196648605649464537827962024445144040395834058714447916981049408310960931998389623396383151616168556706468115596486100257332107454218361019929061651117632864546163172189693989892264385257</span></span><br><span class="line">A = <span class="number">30210424620845820052071225945109142323820182565373787589801116895962027171575049058295156742156305996469210267854774935518505743920438652976152675486476209694284460060753584821225066880682226097812673951158980930881565165151455761750621260912545169247447437218263919470449873682069698887953001819921915874928002568841432197395663420509941263729040966054080025218829347912646803956034554112984570671065110024224236097116296364722731368986065647624353094691096824850694884198942548289196057081572758803944199342980170036665636638983619866569688965508039554384758104832379412233201655767221921359451427988699779296943487</span></span><br><span class="line">h = SHA512.new(truncate=<span class="string">&quot;256&quot;</span>)</span><br><span class="line">h.update(number.long_to_bytes(g) + number.long_to_bytes(p) + number.long_to_bytes(A))</span><br><span class="line">c = number.bytes_to_long(h.digest()) % p</span><br><span class="line"></span><br><span class="line">Ainv = gmpy2.invert(A,p)</span><br><span class="line">e = gmpy2.invert(c,q)</span><br><span class="line">X = <span class="built_in">pow</span>(Ainv,e,p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line">z = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(g,z,p))</span><br><span class="line"><span class="built_in">print</span>(A*<span class="built_in">pow</span>(X,c,p)%p)</span><br></pre></td></tr></table></figure>



<p>最后只需要传入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a + cx = <span class="number">0</span></span><br><span class="line">X = <span class="number">19805709471217645482994063928989232052421953029889556196440912466885007894426627225609327983032620202153855550360223088814969950136658024031366644612027440003586527315627375755980023491174345196460462084013316854170594941724489426524643810285361495069244784160097875576606948416522808256009062151158878030536167300300563164985148039705086383522816788975595614152366395692547362281861708360767355898825189743785255175423703637558391032853146881669124678016614663704343518610020135219251764225040268005200779658861798846792177960065028841070288410881522856036877418862825279659139810238320244689690946600242314538099649</span></span><br></pre></td></tr></table></figure>

<p><code>bctf&#123;t00_t1r3d_t0_n0t1c3_m1551n9_pub_k3y_1n_5t4t3m3nt&#125;</code></p>
<h1 id="shamir-for-dummies——没做"><a href="#shamir-for-dummies——没做" class="headerlink" title="shamir-for-dummies——没做"></a>shamir-for-dummies——没做</h1><blockquote>
<p>nc gold.b01le.rs 5006</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">polynomial_evaluation</span>(<span class="params">coefficients, x</span>):</span><br><span class="line">	at_x = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(coefficients)):</span><br><span class="line">		at_x += coefficients[i] * (x ** i)</span><br><span class="line">		at_x = at_x % p</span><br><span class="line">	<span class="keyword">return</span> at_x</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;bctf&#123;REDACTED&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Thanks for coming in. I can really use your help.\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Like I said, my friend can only do additions. He technically can do division but he says he can only do it once a day.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;I need to share my secret using Shamir secret sharing. Can you craft the shares, in a way that my friend can recover it?\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Don&#x27;t worry, I have the polynomial and I will do all the math for you.&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">s = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">n = getPrime(<span class="number">4</span>)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> p % n != <span class="number">1</span>:</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Let&#x27;s use \n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;k =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">coefficients = [s]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):</span><br><span class="line">	coefficients.append(random.randint(<span class="number">2</span>, p-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Okay, I have my polynomial P(X) ready. Let me know when you are ready to generate shares with me.\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">evaluation_points = []</span><br><span class="line">shares = []</span><br><span class="line"></span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> count &lt; n+<span class="number">1</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Evaluate P(X) at X_&#123;0&#125; =&quot;</span>.<span class="built_in">format</span>(count))</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;&gt; &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">	eval_point = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">	<span class="keyword">if</span> eval_point % p == <span class="number">0</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;Lol, nice try. Bye.&quot;</span>)</span><br><span class="line">		exit()</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">elif</span> eval_point &lt; <span class="number">0</span> <span class="keyword">or</span> eval_point &gt; p:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;Let&#x27;s keep things in mod p. Please choose it again.&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">if</span> eval_point <span class="keyword">not</span> <span class="keyword">in</span> evaluation_points:</span><br><span class="line">			evaluation_points.append(eval_point)</span><br><span class="line">			share = polynomial_evaluation(coefficients, eval_point)</span><br><span class="line">			shares.append(share)</span><br><span class="line">			count += <span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;You used that already. Let&#x27;s use something else!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Nice! Let&#x27;s make sure we have enough shares.\n&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(shares) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(evaluation_points) == n</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;It looks like we do.\n&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;By the way, would he have to divide with anything? (Put 1 if he does not have to)&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&gt; &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">some_factor = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Good. Let&#x27;s send those over to him.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">	time.sleep(<span class="number">1</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line">sum_of_shares = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s_i <span class="keyword">in</span> shares:</span><br><span class="line">	sum_of_shares += s_i</span><br><span class="line">	sum_of_shares = sum_of_shares % p</span><br><span class="line"></span><br><span class="line">sum_of_shares_processed = (sum_of_shares * <span class="built_in">pow</span>(some_factor, -<span class="number">1</span>, p)) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sum_of_shares_processed == s:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Yep, he got my secret message!\n&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;The shares P(X_i)&#x27;s were&#x27;:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(shares)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;... Oh no. I think now you&#x27;d know the secret also... Thanks again though.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Sorry, it looks like that didn&#x27;t work :(&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="count-the-counter——没做"><a href="#count-the-counter——没做" class="headerlink" title="count_the_counter——没做"></a>count_the_counter——没做</h1><blockquote>
<p>nc gold.b01le.rs 5002</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt</span>(<span class="params">key, message, nonce</span>):</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CTR, nonce=long_to_bytes(nonce))</span><br><span class="line">    <span class="keyword">return</span> cipher.encrypt(message).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chal</span>():</span><br><span class="line">    key = os.urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Treat or Trick, count my thing. &quot;</span>)</span><br><span class="line">    nonce_counter = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(Encrypt(key, flag, nonce_counter))</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        nonce_counter += <span class="number">1</span></span><br><span class="line">        to_enc = <span class="built_in">input</span>(<span class="string">&quot;Give me something to encrypt: &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Encrypt(key, <span class="built_in">bytes</span>.fromhex(to_enc), nonce_counter))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    chal()</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/" title="b01lersCTF">https://dexterjie.github.io/2024/04/14/赛题复现/b01lersCTF/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/04/08/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/RITSEC-CTF/" rel="prev" title="RITSEC CTF">
                  <i class="fa fa-chevron-left"></i> RITSEC CTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/04/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B8%95%E9%B2%81%E6%9D%AF/" rel="next" title="帕鲁杯">
                  帕鲁杯 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">242k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">14:40</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/04/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/b01lersCTF/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
