<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="密码个人赛部分题解">
<meta property="og:type" content="article">
<meta property="og:title" content="NSSCTFRound19">
<meta property="og:url" content="https://dexterjie.github.io/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="密码个人赛部分题解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/1.jpg">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/nss/0.jpg">
<meta property="article:published_time" content="2024-03-16T11:14:49.000Z">
<meta property="article:modified_time" content="2024-03-18T13:07:34.338Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/nss/0.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/","path":"2024/03/16/赛题复现/NSSCTFRound19/","title":"NSSCTFRound19"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>NSSCTFRound19 | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#bestkasscn%E7%9A%84%E8%B6%85%E7%BA%A7%E7%AE%80%E5%8D%95%E5%AF%86%E7%A0%81"><span class="nav-number">1.</span> <span class="nav-text">bestkasscn的超级简单密码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#bestkasscn%E7%9A%84%E7%AE%80%E5%8D%95%E5%AF%86%E7%A0%81"><span class="nav-number">2.</span> <span class="nav-text">bestkasscn的简单密码</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3DES"><span class="nav-number">3.</span> <span class="nav-text">*3DES?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Decision"><span class="nav-number">4.</span> <span class="nav-text">*Decision</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="NSSCTFRound19 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          NSSCTFRound19
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-03-16 19:14:49" itemprop="dateCreated datePublished" datetime="2024-03-16T19:14:49+08:00">2024-03-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-03-18 21:07:34" itemprop="dateModified" datetime="2024-03-18T21:07:34+08:00">2024-03-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>密码个人赛部分题解</p>
<span id="more"></span>

<h1 id="bestkasscn的超级简单密码"><a href="#bestkasscn的超级简单密码" class="headerlink" title="bestkasscn的超级简单密码"></a>bestkasscn的超级简单密码</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = p * <span class="number">5</span> + i</span><br><span class="line">    <span class="keyword">if</span> isPrime(r):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    q = p * <span class="number">10</span> + i</span><br><span class="line">    <span class="keyword">if</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n = p * q * r</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag.encode()), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p3=&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">pow</span>(p, <span class="number">3</span>, n)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q3=&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">pow</span>(q, <span class="number">3</span>, n)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;r3=&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">pow</span>(r, <span class="number">3</span>, n)))</span><br><span class="line"><span class="comment"># n = 44571911854174527304485400947383944661319242813524818888269963870884859557542264803774212076803157466539443358890313286282067621989609252352994203884813364011659788234277369629312571477760818634118449563652776213438461157699447304292906151410018017960605868035069246651843561595572415595568705784173761441087845248621463389786351743200696279604003824362262237505386409700329605140703782099240992158439201646344692107831931849079888757310523663310273856448713786678014221779214444879454790399990056124051739535141631564534546955444505648933134838799753362350266884682987713823886338789502396879543498267617432600351655901149380496067582237899323865338094444822339890783781705936546257971766978222763417870606459677496796373799679580683317833001077683871698246143179166277232084089913202832193540581401453311842960318036078745448783370048914350299341586452159634173821890439194014264891549345881324015485910286021846721593668473</span></span><br><span class="line"><span class="comment"># c = 11212699652154912414419576042130573737460880175860430868241856564678915039929479534373946033032215673944727767507831028500814261134142245577246925294110977629353584372842303558820509861245550773062016272543030477733653059813274587939179134498599049035104941393508776333632172797303569396612594631646093552388772109708942113683783815011735472088985078464550997064595366458370527490791625688389950370254858619018250060982532954113416688720602160768503752410505420577683484807166966007396618297253478916176712265476128018816694458551219452105277131141962052020824990732525958682439071443399050470856132519918853636638476540689226313542250551212688215822543717035669764276377536087788514506366740244284790716170847347643593400673746020474777085815046098314460862593936684624708574116108322520985637474375038848494466480630236867228454838428542365166285156741433845949358227546683144341695680712263215773807461091898003011630162481</span></span><br><span class="line"><span class="comment"># p3 = 891438237083490546089708018947678893226384856270496377765399277417697191150845296075484241536063149330788867177806265725641352439792185047059884077696267280233195764685547392586251429555216372682368991273055524268769223153988946085858123028200360359212117360701384933036871231911448311911374115683475228820531478240539549424647154342506853356292956506486091063660095505979187297020928573605860329881982122478494944846700224611808246427660214535971723459345029873385956677292979041143593821672034573140001092625650099257402018634684516092489263998517027205660003413512870074652126328536906790020794659204007921147300771594986038917179253827432120018857213350120695302091483756021206199805521083496979628811676116525321724267588515105188480380865374667274442027086789352802613365511142499668793725505110436809024171752137883546327359935102833441492430652019931999144063825010678766130335038975376834579129516127516820037383067</span></span><br><span class="line"><span class="comment"># q3 = 44571911854174527304485400947383944661319242813524818888269963870884859557542264803774212076803157466539443358890313286282067621989609252352994203884813364011659788234277369629312571477760818634118449563652776213438461157699447304292906151410018017960605868035069246651843561595572415595568705784173761440671033435053531971051698504592848580356684103015611323747688216493729331061402058160819388999663041629882482138465124920580049057123360829897432472221079140360215664537272316836767039948368780837985855835419681893347839311156887660438769948501100287062738217966360434291369179859862550767272985972263442512061098317471708987686120577904202391381040801620069987103931326500146536990700234262413595295698193570184681785854277656410199477649697026112650581343325348837547631237627207304757407395388155701341044939408589591213693329516396531103489233367665983149963665364824119870832353269655933102900004362236232825539480774</span></span><br><span class="line"><span class="comment"># r3 = 22285955927087263652242700473691972330659621406762409444134981935442429778771132401887106038401578733269721679445156643141033810994804626176497101942406682005829894117138684814656285738880409317059224781826388106719230578849723652146453075705009008980302934017534623325921780797786207797784352892086880720749202442492937918619992591614713131681306874944356693778359565004415437554407990089293135634916859631279984463829118336826115430997439527110961309956466956650522900331263720500751112297418506140413317489683875995326726992533904683800042127871963320754241310699432792081707870167598822650064976439270556418985242630368723264289700246406905189810458354474959276748887369363592834205660349184660073395182450526542246354364903399132116153732074081050985584216815493617906868615192465631416955706457835185743023758573279838341229835613609332206338401219168119635681832981552328638132500079074010106995297184587143613134093145</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>很容易判断出$p^3 &lt; n$</p>
<p>直接把p3开根号即可得到p，然后用题目的代码生成q,r</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">44571911854174527304485400947383944661319242813524818888269963870884859557542264803774212076803157466539443358890313286282067621989609252352994203884813364011659788234277369629312571477760818634118449563652776213438461157699447304292906151410018017960605868035069246651843561595572415595568705784173761441087845248621463389786351743200696279604003824362262237505386409700329605140703782099240992158439201646344692107831931849079888757310523663310273856448713786678014221779214444879454790399990056124051739535141631564534546955444505648933134838799753362350266884682987713823886338789502396879543498267617432600351655901149380496067582237899323865338094444822339890783781705936546257971766978222763417870606459677496796373799679580683317833001077683871698246143179166277232084089913202832193540581401453311842960318036078745448783370048914350299341586452159634173821890439194014264891549345881324015485910286021846721593668473</span></span><br><span class="line">c = <span class="number">11212699652154912414419576042130573737460880175860430868241856564678915039929479534373946033032215673944727767507831028500814261134142245577246925294110977629353584372842303558820509861245550773062016272543030477733653059813274587939179134498599049035104941393508776333632172797303569396612594631646093552388772109708942113683783815011735472088985078464550997064595366458370527490791625688389950370254858619018250060982532954113416688720602160768503752410505420577683484807166966007396618297253478916176712265476128018816694458551219452105277131141962052020824990732525958682439071443399050470856132519918853636638476540689226313542250551212688215822543717035669764276377536087788514506366740244284790716170847347643593400673746020474777085815046098314460862593936684624708574116108322520985637474375038848494466480630236867228454838428542365166285156741433845949358227546683144341695680712263215773807461091898003011630162481</span></span><br><span class="line">p3 = <span class="number">891438237083490546089708018947678893226384856270496377765399277417697191150845296075484241536063149330788867177806265725641352439792185047059884077696267280233195764685547392586251429555216372682368991273055524268769223153988946085858123028200360359212117360701384933036871231911448311911374115683475228820531478240539549424647154342506853356292956506486091063660095505979187297020928573605860329881982122478494944846700224611808246427660214535971723459345029873385956677292979041143593821672034573140001092625650099257402018634684516092489263998517027205660003413512870074652126328536906790020794659204007921147300771594986038917179253827432120018857213350120695302091483756021206199805521083496979628811676116525321724267588515105188480380865374667274442027086789352802613365511142499668793725505110436809024171752137883546327359935102833441492430652019931999144063825010678766130335038975376834579129516127516820037383067</span></span><br><span class="line">q3 = <span class="number">44571911854174527304485400947383944661319242813524818888269963870884859557542264803774212076803157466539443358890313286282067621989609252352994203884813364011659788234277369629312571477760818634118449563652776213438461157699447304292906151410018017960605868035069246651843561595572415595568705784173761440671033435053531971051698504592848580356684103015611323747688216493729331061402058160819388999663041629882482138465124920580049057123360829897432472221079140360215664537272316836767039948368780837985855835419681893347839311156887660438769948501100287062738217966360434291369179859862550767272985972263442512061098317471708987686120577904202391381040801620069987103931326500146536990700234262413595295698193570184681785854277656410199477649697026112650581343325348837547631237627207304757407395388155701341044939408589591213693329516396531103489233367665983149963665364824119870832353269655933102900004362236232825539480774</span></span><br><span class="line">r3 = <span class="number">22285955927087263652242700473691972330659621406762409444134981935442429778771132401887106038401578733269721679445156643141033810994804626176497101942406682005829894117138684814656285738880409317059224781826388106719230578849723652146453075705009008980302934017534623325921780797786207797784352892086880720749202442492937918619992591614713131681306874944356693778359565004415437554407990089293135634916859631279984463829118336826115430997439527110961309956466956650522900331263720500751112297418506140413317489683875995326726992533904683800042127871963320754241310699432792081707870167598822650064976439270556418985242630368723264289700246406905189810458354474959276748887369363592834205660349184660073395182450526542246354364903399132116153732074081050985584216815493617906868615192465631416955706457835185743023758573279838341229835613609332206338401219168119635681832981552328638132500079074010106995297184587143613134093145</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(p3,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = p * <span class="number">5</span> + i</span><br><span class="line">    <span class="keyword">if</span> isPrime(r):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    q = p * <span class="number">10</span> + i</span><br><span class="line">    <span class="keyword">if</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># NSSCTF&#123;cc10786a-cc59-a07d-5c9f-df1c55b18cd4&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="bestkasscn的简单密码"><a href="#bestkasscn的简单密码" class="headerlink" title="bestkasscn的简单密码"></a>bestkasscn的简单密码</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, enc_key</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">64</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(enc_key) == <span class="number">64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGraph</span>(<span class="params">row, column</span>):</span><br><span class="line">    graph = [[<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(row)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(column)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(column):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(row):</span><br><span class="line">            graph[i][j] = <span class="built_in">dir</span>[randint(<span class="number">0</span>, <span class="number">63</span>)]</span><br><span class="line">    <span class="keyword">return</span> graph</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bestkasscnEncryption</span>(<span class="params"><span class="built_in">str</span></span>):</span><br><span class="line">    binary = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        binary += <span class="string">&#x27;0&#x27;</span> + <span class="built_in">bin</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:] + <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(binary) % <span class="number">6</span> != <span class="number">0</span>:</span><br><span class="line">        binary += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(binary) // <span class="number">6</span>):</span><br><span class="line">        res += <span class="built_in">dir</span>[<span class="built_in">int</span>(binary[i * <span class="number">6</span>:<span class="number">6</span> + i * <span class="number">6</span>], <span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(res) % <span class="number">3</span> != <span class="number">0</span>:</span><br><span class="line">        res += <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">encrypt = bestkasscnEncryption(enc_key)</span><br><span class="line"></span><br><span class="line">graph1 = getGraph(<span class="built_in">len</span>(encrypt), <span class="built_in">len</span>(encrypt))</span><br><span class="line">graph2 = getGraph(<span class="built_in">len</span>(encrypt), <span class="built_in">len</span>(encrypt))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    graph1[<span class="built_in">dir</span>.index(encrypt[i])][i] = enc_key[i]</span><br><span class="line">    graph2[i][<span class="built_in">dir</span>.index(encrypt[i])] = flag[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">2</span>):</span><br><span class="line">    graph2[i][<span class="built_in">dir</span>.index(encrypt[i])] = enc_key[i]</span><br><span class="line">    graph1[<span class="built_in">dir</span>.index(encrypt[i])][i] = flag[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;graph1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="string">&quot;graph1:\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> graph1:</span><br><span class="line">        file.write(<span class="built_in">str</span>(i))</span><br><span class="line">        file.write(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        file.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">file.close()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;graph2.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="string">&quot;graph2:\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> graph2:</span><br><span class="line">        file.write(<span class="built_in">str</span>(j))</span><br><span class="line">        file.write(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line">        file.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encrypt.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(encrypt)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<p>注意到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    graph1[<span class="built_in">dir</span>.index(encrypt[i])][i] = enc_key[i]</span><br><span class="line">    graph2[i][<span class="built_in">dir</span>.index(encrypt[i])] = flag[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">2</span>):</span><br><span class="line">    graph2[i][<span class="built_in">dir</span>.index(encrypt[i])] = enc_key[i]</span><br><span class="line">    graph1[<span class="built_in">dir</span>.index(encrypt[i])][i] = flag[i]</span><br></pre></td></tr></table></figure>

<p>key(压缩包的密码)的一部分可以通过graph1和encrypt求出</p>
<p>flag的一半也在graph1里</p>
<p>key的另外一半我用比较粗糙的手段(爆破)求出的，<code>key = One_who_has_seen_the_ocean_thinks_nothing_of_mere_rivers_so_do_I</code></p>
<p>求出key之后打开graph2，再根据flag的位置输出即可</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#123;&#125;&quot;</span></span><br><span class="line">encrypt = <span class="string">&quot;t25Lx3DOB19OyxnFC2vLBL90AgvFB2nLyw5FDgHPBMTZx25VDgHPBMDFB2zFBwvYzv9YAxzLCNnFC29Fzg9Fsq&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">graph1 = [[...]]</span><br><span class="line">graph2 = [[...]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        m = graph1[<span class="built_in">dir</span>.index(encrypt[i])][i]</span><br><span class="line">        flag += m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = graph2[i][<span class="built_in">dir</span>.index(encrypt[i])]</span><br><span class="line">        flag += m</span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># One_who_has_seen_the_ocean_thinks_nothing_of_mere_rivers_so_do_I</span></span><br><span class="line"><span class="comment"># NSSCTF&#123;What_I_miss_is_saying_nothing_nothing_better_than_hotpot&#125;</span></span><br></pre></td></tr></table></figure>

<p>以下赛题均为复现，参考<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/b4a50eee.html#more">2024-NSSCTF-Round19-Basic-wp-crypto | 糖醋小鸡块的blog (tangcuxiaojikuai.xyz)</a></p>
<h1 id="3DES"><a href="#3DES" class="headerlink" title="*3DES?"></a>*3DES?</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DEStream</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.table = <span class="string">&#x27;0123456789&#x27;</span></span><br><span class="line">        self.key = (<span class="string">&quot;&quot;</span>.join([choice(self.table) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)])).encode()</span><br><span class="line">        self.seed = <span class="string">b&quot;!NSSCTF!&quot;</span></span><br><span class="line">        self.des = DES.new(self.key,mode=DES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.des).encrypt(self.seed)</span><br><span class="line">        <span class="keyword">return</span> bytes_to_long(self.seed) &amp; <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">self,m</span>):</span><br><span class="line">        <span class="keyword">return</span> (self.des).encrypt(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">combine</span>(<span class="params">x1,x2,x3</span>):</span><br><span class="line">    <span class="keyword">return</span> (x1&amp;x2)^(x2&amp;x3)^x3</span><br><span class="line"></span><br><span class="line">des1 =  DEStream()</span><br><span class="line">des2 =  DEStream()</span><br><span class="line">des3 =  DEStream()</span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">    output += <span class="built_in">str</span>(combine(des1.<span class="built_in">next</span>(),des2.<span class="built_in">next</span>(),des3.<span class="built_in">next</span>()))</span><br><span class="line"></span><br><span class="line">cipher = des1.enc(pad(flag,<span class="number">8</span>))</span><br><span class="line">cipher = des2.enc(cipher)</span><br><span class="line">cipher = des3.enc(cipher)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output =&quot;</span>,output)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cipher =&quot;</span>,cipher)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">output = 10110101110110001000111000110101000110111100110110011010000010001110010010101111000101101100101011110101111011000000001110011001011001110010010000001010111101011110011011000111011101010000111011011110010001101001110010111100101111110001000110000110111010100010111010000110000001011010111100100011011010001101001001100000000001100101111110110011000101101100110101010000010101100001010010000010010011001011110000010101111000001110010100110110111011001010111111100010100111000110110010101101000001011000101110101100000110110000101101010100101010000100110011011110100110111101101100011100011100101000000100000000101001100101001010101001000110011110110000111111001111101110110110100001010000100110010100010101000001010001111100000010100000101101111010010011010100011000100111001101100001011111001100111101100011001001000001000100011011010000001101110000001111011000111000011001010011100110110111111101010110101110110110000101110110000000101110000011110101001100010000101001010010000011110111100001101011001110100011101111011001010110111000010000111000010010111111111000111100110000100100100011111100101111011001000000011000001100110100011100110010100010001110011001011100101001101001100110001010000011001001101010010101001111110100010111000000101011000100100000010011111011001011010001101101101001100111010110101001001111000111000001000001010000001100101110110010111111001001011111111000100110011100011000111011010100001011010000011110101001110101010011111000100010011010000101011100110110101000100010010001011101010010100100001011010101000010000110001100100010000010111110011111000011000100011001110001100100111111101000001001101110000100101011010010011001100100100100010000101100111001100110000110010001001010011011011101011010100110001100001000111010000100100100010110111100000100111010101100000111010111011000100011010111110010010000110111111001101000011111000111100110111110011110101001100110111000111111011010011100011000010010011010100000100110010011111011110111011111011011110010110000110011110000</span></span><br><span class="line"><span class="string">cipher = b&#x27;\xe3\t\x13\xe2\x8b\xd1\xdeql\x94F\xb5&#125;\xb8d\xfa~\x06&amp;~\x8f\xcb-&amp;\xf3q/j\xd3\xbe\x1f\xef\x18\x84hn\x1c[t\x03\x10\xb8\x8e?\x89\x8b\x00\xc5\xb9`5E\xeaC\xe9,&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>拿到题目发现flag进行了三次加密，很明显我们需要求出3个key</p>
<p>注意到key是由<code>0123456789</code>组成的，长度为8</p>
<p>题目只给出长度2000的二进制序列，所以只能通过这2000个值求3个key</p>
<p>先分析这个combine函数，自己遍历8个组合就可以知道这个combine的结果有75%的概率和$x_1$一样，有50%的概率和$x_2$的概率一样，有75%的概率和$x_3$一样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x1 = <span class="number">0</span>,x2 = <span class="number">0</span>,x3 = <span class="number">0</span>,combine = <span class="number">0</span></span><br><span class="line">x1 = <span class="number">0</span>,x2 = <span class="number">0</span>,x3 = <span class="number">1</span>,combine = <span class="number">1</span></span><br><span class="line">x1 = <span class="number">0</span>,x2 = <span class="number">1</span>,x3 = <span class="number">0</span>,combine = <span class="number">0</span></span><br><span class="line">x1 = <span class="number">0</span>,x2 = <span class="number">1</span>,x3 = <span class="number">1</span>,combine = <span class="number">0</span></span><br><span class="line">x1 = <span class="number">1</span>,x2 = <span class="number">0</span>,x3 = <span class="number">0</span>,combine = <span class="number">0</span></span><br><span class="line">x1 = <span class="number">1</span>,x2 = <span class="number">0</span>,x3 = <span class="number">1</span>,combine = <span class="number">1</span></span><br><span class="line">x1 = <span class="number">1</span>,x2 = <span class="number">1</span>,x3 = <span class="number">0</span>,combine = <span class="number">1</span></span><br><span class="line">x1 = <span class="number">1</span>,x2 = <span class="number">1</span>,x3 = <span class="number">1</span>,combine = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>而$x_1,x_3$分别是$key_1,key_3$对初始seed加密使用的密钥，这说明我们可以通过爆破的手段求得$key_1,key_3$，判断方式是观察其输出是否与2000位(用不上比较这么多位，鸡块的wp是用200位，加快速度)给定的序列有75%的相似度。还有需要注意的点是，DES加密过程并没有用上密钥的所有数据，密钥每个字节的第8bit(最低那位)是不参与加密的，可以自己跑代码实现试试，这又可以减少很多爆破时间。求key2的时候，只需要判断50位左右，因为在密钥错误的情况下，连续50位和题目给的序列一样的概率非常小。</p>
<blockquote>
<p>test.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;testtest&quot;</span></span><br><span class="line"></span><br><span class="line">testkey = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">    temp = (i // <span class="number">2</span>) &lt;&lt; <span class="number">1</span></span><br><span class="line">    temp += <span class="number">1</span>               <span class="comment">#加0也没区别</span></span><br><span class="line">    testkey += <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(temp)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&quot;A&quot;</span>*<span class="number">8</span></span><br><span class="line">des = DES.new(key,DES.MODE_ECB)</span><br><span class="line">c = des.encrypt(m)</span><br><span class="line"></span><br><span class="line">testdes = DES.new(testkey,DES.MODE_ECB)</span><br><span class="line">testc = testdes.encrypt(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(testc)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;10110101110110001000111000110101000110111100110110011010000010001110010010101111000101101100101011110101111011000000001110011001011001110010010000001010111101011110011011000111011101010000111011011110010001101001110010111100101111110001000110000110111010100010111010000110000001011010111100100011011010001101001001100000000001100101111110110011000101101100110101010000010101100001010010000010010011001011110000010101111000001110010100110110111011001010111111100010100111000110110010101101000001011000101110101100000110110000101101010100101010000100110011011110100110111101101100011100011100101000000100000000101001100101001010101001000110011110110000111111001111101110110110100001010000100110010100010101000001010001111100000010100000101101111010010011010100011000100111001101100001011111001100111101100011001001000001000100011011010000001101110000001111011000111000011001010011100110110111111101010110101110110110000101110110000000101110000011110101001100010000101001010010000011110111100001101011001110100011101111011001010110111000010000111000010010111111111000111100110000100100100011111100101111011001000000011000001100110100011100110010100010001110011001011100101001101001100110001010000011001001101010010101001111110100010111000000101011000100100000010011111011001011010001101101101001100111010110101001001111000111000001000001010000001100101110110010111111001001011111111000100110011100011000111011010100001011010000011110101001110101010011111000100010011010000101011100110110101000100010010001011101010010100100001011010101000010000110001100100010000010111110011111000011000100011001110001100100111111101000001001101110000100101011010010011001100100100100010000101100111001100110000110010001001010011011011101011010100110001100001000111010000100100100010110111100000100111010101100000111010111011000100011010111110010010000110111111001101000011111000111100110111110011110101001100110111000111111011010011100011000010010011010100000100110010011111011110111011111011011110010110000110011110000&quot;</span></span><br><span class="line">cipher = <span class="string">b&#x27;\xe3\t\x13\xe2\x8b\xd1\xdeql\x94F\xb5&#125;\xb8d\xfa~\x06&amp;~\x8f\xcb-&amp;\xf3q/j\xd3\xbe\x1f\xef\x18\x84hn\x1c[t\x03\x10\xb8\x8e?\x89\x8b\x00\xc5\xb9`5E\xeaC\xe9,&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">combine</span>(<span class="params">x1,x2,x3</span>):</span><br><span class="line">    <span class="keyword">return</span> (x1&amp;x2)^(x2&amp;x3)^x3</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare</span>(<span class="params">str1,str2</span>):               <span class="comment">#计算相似度</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(str1) == <span class="built_in">len</span>(str2)</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str1)):</span><br><span class="line">        <span class="keyword">if</span> str1[i] == str2[i]:</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> (num / <span class="built_in">len</span>(str1)) &gt; <span class="number">0.75</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">table = <span class="string">&quot;0123456789&quot;</span></span><br><span class="line">prefix = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">    temp = <span class="built_in">bin</span>(<span class="built_in">ord</span>(i) // <span class="number">2</span>)[<span class="number">2</span>:].zfill(<span class="number">7</span>)</span><br><span class="line">    <span class="keyword">if</span> temp <span class="keyword">not</span> <span class="keyword">in</span> prefix:</span><br><span class="line">        prefix.append(temp)</span><br><span class="line"><span class="comment"># 把这些字符2进制形式的高7位存入</span></span><br><span class="line"></span><br><span class="line">key_may = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(product(prefix,repeat = <span class="number">8</span>)):      <span class="comment">#爆破key1和key3,长度为八个字节</span></span><br><span class="line">    temp = <span class="string">&quot;&quot;</span>.join(j + <span class="string">&quot;0&quot;</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">list</span>(i))</span><br><span class="line">    key = long_to_bytes(<span class="built_in">int</span>(temp,<span class="number">2</span>))</span><br><span class="line">    <span class="comment"># 开始爆</span></span><br><span class="line">    des1 = DES.new(key,DES.MODE_ECB)</span><br><span class="line">    seed = <span class="string">b&quot;!NSSCTF!&quot;</span></span><br><span class="line">    output1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        seed = des1.encrypt(seed)</span><br><span class="line">        out = <span class="built_in">str</span>(bytes_to_long(seed) &amp; <span class="number">1</span>)</span><br><span class="line">        output1 += out</span><br><span class="line">    <span class="keyword">if</span> compare(output1,output[:<span class="number">200</span>]):</span><br><span class="line">        key_may.append(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 大概12分钟</span></span><br><span class="line"><span class="comment"># print(key_may)</span></span><br><span class="line"><span class="comment"># key_may = [b&#x27;06660408&#x27;, b&#x27;84822042&#x27;]</span></span><br><span class="line"><span class="comment"># 可能的密钥只有2个，只需要来回试一下key1,key3即可</span></span><br><span class="line">key1 = key_may[<span class="number">1</span>]                   </span><br><span class="line">key3 = key_may[<span class="number">0</span>]</span><br><span class="line">des1 = DES.new(key1,DES.MODE_ECB)</span><br><span class="line">des3 = DES.new(key3,DES.MODE_ECB)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 接下来爆key2</span></span><br><span class="line"><span class="comment"># 大概1分20秒</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(product(prefix,repeat = <span class="number">8</span>)):</span><br><span class="line">    temp = <span class="string">&quot;&quot;</span>.join(j + <span class="string">&quot;0&quot;</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">list</span>(i))</span><br><span class="line">    key = long_to_bytes(<span class="built_in">int</span>(temp,<span class="number">2</span>))</span><br><span class="line">    </span><br><span class="line">    des2 = DES.new(key,DES.MODE_ECB)</span><br><span class="line">    </span><br><span class="line">    seed1 = seed2 = seed3 = <span class="string">b&quot;!NSSCTF!&quot;</span></span><br><span class="line">    judge = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">        seed1 = des1.encrypt(seed1)</span><br><span class="line">        seed2 = des2.encrypt(seed2)</span><br><span class="line">        seed3 = des3.encrypt(seed3)</span><br><span class="line">        out1 = bytes_to_long(seed1) &amp; <span class="number">1</span></span><br><span class="line">        out2 = bytes_to_long(seed2) &amp; <span class="number">1</span></span><br><span class="line">        out3 = bytes_to_long(seed3) &amp; <span class="number">1</span></span><br><span class="line">        temp = combine(out1,out2,out3)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">str</span>(temp) != output[j]:</span><br><span class="line">            judge = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> judge:</span><br><span class="line">        flag = des3.decrypt(cipher)</span><br><span class="line">        flag = des2.decrypt(flag)</span><br><span class="line">        flag = des1.decrypt(flag)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="comment"># NSSCTF&#123;Y0U_C411_Th15_3DES???_;D_J4st_U53_CorreL@tion!&#125;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;key2 = <span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 26206626</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>


<p>$$<br>output &#x3D; x_1x_2 \oplus x_2x_3 \oplus x_3<br>$$<br>看了wp才知道这个叫Gefee生成器</p>
<h1 id="Decision"><a href="#Decision" class="headerlink" title="*Decision"></a>*Decision</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MRG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,para_len,p</span>):</span><br><span class="line">        self.init(para_len,p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.s = self.s[<span class="number">1</span>: ] + [(<span class="built_in">sum</span>([i * j <span class="keyword">for</span> (i, j) <span class="keyword">in</span> <span class="built_in">zip</span>(self.a, self.s)]) + self.b) % self.p]</span><br><span class="line">        <span class="keyword">return</span> self.s[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">self,para_len,p</span>):</span><br><span class="line">        self.p = p</span><br><span class="line">        self.b = randint(<span class="number">1</span>, self.p)</span><br><span class="line">        self.a = [randint(<span class="number">1</span>, self.p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(para_len)]</span><br><span class="line">        self.s = [<span class="built_in">ord</span>(choice(string.printable)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(para_len)]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_params</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> [self.a,self.b,self.s[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">flag_bin = <span class="built_in">bin</span>(flag)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">Round = <span class="number">2024</span></span><br><span class="line">A_len = <span class="number">10</span></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag_bin:</span><br><span class="line">    <span class="keyword">if</span>(i == <span class="string">&quot;0&quot;</span>):</span><br><span class="line">        temp = MRG(A_len,p)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(Round):</span><br><span class="line">            temp.<span class="built_in">next</span>()</span><br><span class="line">        output.append(temp.get_params())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a = [randint(<span class="number">1</span>,p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(A_len)]</span><br><span class="line">        b = randint(<span class="number">1</span>,p)</span><br><span class="line">        s = randint(<span class="number">1</span>,p)</span><br><span class="line">        output.append([a,b,s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(p))</span><br><span class="line">    f.write(<span class="built_in">str</span>(output))</span><br></pre></td></tr></table></figure>

<p>解题思路是通过flag当前位不同产生的s大小不一样来恢复</p>
<p>当flag当前位是0的时候，会用类MRG来初始化一个s，这个s是由可见字符的ASCII码值组成的，对比flag当前位为1的时候，s为1~p中的一个数，很容易发现当flag当前位为0的时候，s初始状态很小。</p>
<p>也就是说，我们要想办法求出s的初始状态</p>
<p>首先s每次迭代有<br>$$<br>s_{10} \equiv a_0s_0+a_1s_1 + … +a_9s_9 + b\mod p<br>$$<br>写成矩阵形式有</p>
<p><img src="/../../images/nss/0.png"></p>
<p>而题目迭代了2024次，写成矩阵形式就为</p>
<p><img src="/../../images/nss/1.png"></p>
<p>难点在于题目只给了$s_{0+2024},a_0,…,a_9,b$，如何利用这些数据来恢复$s_0-s_9$</p>
<p>记</p>
<p><img src="/../../images/nss/2.png"></p>
<p>上面表达式可写为$S_{2024} &#x3D; L\times S_0$</p>
<p>进行转置,得$S_{2024}^T &#x3D; S_0^T\times L^T$</p>
<p>就是</p>
<p><img src="/../../images/nss/4.png"></p>
<p>由于我们只有$s_{0+2024}$,所以我们只取$L^T$的第一列作为线性关系</p>
<p>就有</p>
<p><img src="/../../images/nss/1.jpg"></p>
<p>然后构造出格</p>
<p><img src="/../../images/nss/3.png"></p>
<p>其中$L_{1,i}^T$表示$L_1^T$中第i个元素</p>
<p>需要配上系数保证最后一列规约出0</p>
<p>所以最后构造的格为</p>
<p><img src="/../../images/nss/0.jpg"></p>
<p>赛时疑惑只有一个线性关系如何用格处理</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">output = </span><br><span class="line"></span><br><span class="line">m = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="built_in">len</span>(output)):</span><br><span class="line">    temp = output[j]</span><br><span class="line">    a = temp[<span class="number">0</span>]</span><br><span class="line">    a.append(<span class="number">1</span>)</span><br><span class="line">    b = temp[<span class="number">1</span>]</span><br><span class="line">    s2024 = temp[<span class="number">2</span>]</span><br><span class="line">    Ge = Matrix(Zmod(p),<span class="number">11</span>,<span class="number">11</span>)                   <span class="comment">#很值得注意，这个矩阵的定义域是mod p</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        Ge[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        Ge[-<span class="number">2</span>,i] = a[i]</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">2</span>] = a[-<span class="number">2</span>]</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">1</span>] = b</span><br><span class="line">    Ge[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    L = Ge^<span class="number">2024</span></span><br><span class="line">    L1 = vector(ZZ,L.transpose()[:,<span class="number">0</span>].<span class="built_in">list</span>())                <span class="comment">#提取转置矩阵的第一列，注意定义域</span></span><br><span class="line">    M = Matrix(ZZ,<span class="number">13</span>,<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        M[i,i] = <span class="number">1</span></span><br><span class="line">        M[i,-<span class="number">1</span>] = L1[i] * <span class="number">2</span>^<span class="number">1000</span></span><br><span class="line">    M[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    M[-<span class="number">2</span>,-<span class="number">1</span>] = -s2024 * <span class="number">2</span>^<span class="number">1000</span></span><br><span class="line">    M[-<span class="number">1</span>,-<span class="number">1</span>] = p * <span class="number">2</span>^<span class="number">1000</span></span><br><span class="line">    s0 = M.LLL()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(s0) &lt; <span class="number">128</span>:</span><br><span class="line">        m += <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&quot;1&quot;</span></span><br><span class="line">        </span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(m,<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># NSSCTF&#123;D3c1s1on_MRG_I5n&#x27;7_diFFiCulT_R1GHT?&#125;</span></span><br></pre></td></tr></table></figure>

<p>配系数建议乘上对角矩阵，因为手动乘的话，需要注意前面向量，矩阵的一些定义域问题</p>
<p>例如这题就需要先把向量L1从模p的定义域转到整数域</p>
<p>乘对角矩阵的exp</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">output = </span><br><span class="line"></span><br><span class="line">m = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="built_in">len</span>(output)):</span><br><span class="line">    temp = output[j]</span><br><span class="line">    a = temp[<span class="number">0</span>]</span><br><span class="line">    a.append(<span class="number">1</span>)</span><br><span class="line">    b = temp[<span class="number">1</span>]</span><br><span class="line">    s2024 = temp[<span class="number">2</span>]</span><br><span class="line">    Ge = Matrix(Zmod(p),<span class="number">11</span>,<span class="number">11</span>)                   <span class="comment">#很值得注意，这个矩阵的定义域是mod p</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        Ge[i,i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        Ge[-<span class="number">2</span>,i] = a[i]</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">2</span>] = a[-<span class="number">2</span>]</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">1</span>] = b</span><br><span class="line">    Ge[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">    L = Ge^<span class="number">2024</span></span><br><span class="line">    L1 = vector(ZZ,L.transpose()[:,<span class="number">0</span>].<span class="built_in">list</span>())                <span class="comment">#提取转置矩阵的第一列</span></span><br><span class="line">    M = Matrix(ZZ,<span class="number">13</span>,<span class="number">13</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">        M[i,i] = <span class="number">1</span></span><br><span class="line">        M[i,-<span class="number">1</span>] = L1[i]</span><br><span class="line">    M[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    M[-<span class="number">2</span>,-<span class="number">1</span>] = -s2024</span><br><span class="line">    M[-<span class="number">1</span>,-<span class="number">1</span>] = p</span><br><span class="line">    Q = diagonal_matrix([<span class="number">1</span>]*<span class="number">12</span> + [<span class="number">2</span>^<span class="number">1000</span>])</span><br><span class="line">    MM = M * Q</span><br><span class="line">    MM = MM.LLL()</span><br><span class="line">    MM = MM / Q</span><br><span class="line">    MM = M.LLL()</span><br><span class="line">    s0 = MM[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(s0) &lt; <span class="number">128</span>:</span><br><span class="line">        m += <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&quot;1&quot;</span></span><br><span class="line">        </span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(m,<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># NSSCTF&#123;D3c1s1on_MRG_I5n&#x27;7_diFFiCulT_R1GHT?&#125;</span></span><br></pre></td></tr></table></figure>

<p>这道题复现的卡顿点还蛮多的，首先在矩阵规模卡顿了一会，然后就是代码实现，因为和鸡块使用的函数不一样，几乎每一处矩阵都不断打印出来核对，最后对于手动配上系数和通过乘对角矩阵配系数也琢磨了挺久，最后花了接近4小时完成复现。</p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/" title="NSSCTFRound19">https://dexterjie.github.io/2024/03/16/赛题复现/NSSCTFRound19/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VCTF/" rel="prev" title="2024VCTF">
                  <i class="fa fa-chevron-left"></i> 2024VCTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/03/25/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NKCTF2024/" rel="next" title="NKCTF2024">
                  NKCTF2024 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">226k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">13:43</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/03/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTFRound19/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
