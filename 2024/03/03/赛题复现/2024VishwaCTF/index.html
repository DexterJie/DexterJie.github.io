<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录近期做的一些赛题，包括VishwaCTF,osu,GHCTF,pearlCTF">
<meta property="og:type" content="article">
<meta property="og:title" content="2024VishwaCTF">
<meta property="og:url" content="https://dexterjie.github.io/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录近期做的一些赛题，包括VishwaCTF,osu,GHCTF,pearlCTF">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/12.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/13.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/14.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/16.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/18.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/17.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/19.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/20.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/21.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/22.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/23.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/24.png">
<meta property="article:published_time" content="2024-03-03T11:00:15.000Z">
<meta property="article:modified_time" content="2024-03-10T15:51:38.193Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/%E6%9D%82/10.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/","path":"2024/03/03/赛题复现/2024VishwaCTF/","title":"2024VishwaCTF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024VishwaCTF | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#VishwaCTF"><span class="nav-number">1.</span> <span class="nav-text">VishwaCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#poly-fun"><span class="nav-number">1.1.</span> <span class="nav-text">poly fun</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Intellectual-Heir"><span class="nav-number">1.2.</span> <span class="nav-text">Intellectual Heir</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BitBane"><span class="nav-number">1.3.</span> <span class="nav-text">BitBane</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lets-smother-the-King"><span class="nav-number">1.4.</span> <span class="nav-text">Lets smother the King!</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GHCTF"><span class="nav-number">2.</span> <span class="nav-text">GHCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2024%E4%B9%9D%E7%9C%81%E8%81%94%E8%80%83"><span class="nav-number">2.1.</span> <span class="nav-text">2024九省联考</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2023%E5%9B%9B%E7%9C%81%E8%81%94%E8%80%83"><span class="nav-number">2.2.</span> <span class="nav-text">2023四省联考</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto1921"><span class="nav-number">2.3.</span> <span class="nav-text">Crypto1921</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto1939"><span class="nav-number">2.4.</span> <span class="nav-text">Crypto1939</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto2042"><span class="nav-number">2.5.</span> <span class="nav-text">Crypto2042</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#osu"><span class="nav-number">3.</span> <span class="nav-text">osu</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E9%81%93%E9%A2%98"><span class="nav-number">3.1.</span> <span class="nav-text">第一道题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E9%81%93%E9%A2%98"><span class="nav-number">3.2.</span> <span class="nav-text">第二道题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#pearlCTF"><span class="nav-number">4.</span> <span class="nav-text">pearlCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-pies"><span class="nav-number">4.1.</span> <span class="nav-text">3 pies</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby%E2%80%99s-Message-Out"><span class="nav-number">4.2.</span> <span class="nav-text">Baby’s Message Out</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bit-War"><span class="nav-number">4.3.</span> <span class="nav-text">Bit War</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#syntelestis"><span class="nav-number">4.4.</span> <span class="nav-text">syntelestis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Security"><span class="nav-number">4.5.</span> <span class="nav-text">Security++</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024VishwaCTF | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024VishwaCTF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-03-03 19:00:15" itemprop="dateCreated datePublished" datetime="2024-03-03T19:00:15+08:00">2024-03-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-03-10 23:51:38" itemprop="dateModified" datetime="2024-03-10T23:51:38+08:00">2024-03-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>32 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录近期做的一些赛题，包括VishwaCTF,osu,GHCTF,pearlCTF</p>
<span id="more"></span>

<h1 id="VishwaCTF"><a href="#VishwaCTF" class="headerlink" title="VishwaCTF"></a>VishwaCTF</h1><h2 id="poly-fun"><a href="#poly-fun" class="headerlink" title="poly fun"></a>poly fun</h2><blockquote>
<p>题目描述：</p>
<p>Its a simple symmetric key encryption, I am sure you will be able to solve it (what do you mean the key looks weird)</p>
</blockquote>
<blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">polyc = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">7</span>]</span><br><span class="line">poly = np.poly1d(polyc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_number</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        num = random.randint(<span class="number">100</span>, <span class="number">999</span>)</span><br><span class="line">        first_digit = num // <span class="number">100</span></span><br><span class="line">        last_digit = num % <span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(first_digit - last_digit) &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_number_again</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        num = random.randint(<span class="number">1000</span>, <span class="number">9999</span>)</span><br><span class="line">        <span class="keyword">if</span> num % <span class="number">1111</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">num</span>):</span><br><span class="line">    number = random.randint(<span class="number">1</span>, <span class="number">100000</span>)</span><br><span class="line">    org = number</span><br><span class="line">    number *= <span class="number">2</span></span><br><span class="line">    number += <span class="number">15</span></span><br><span class="line">    number *= <span class="number">3</span></span><br><span class="line">    number += <span class="number">33</span></span><br><span class="line">    number /= <span class="number">6</span></span><br><span class="line">    number -= org</span><br><span class="line">    <span class="keyword">if</span> number == <span class="number">13</span>:</span><br><span class="line">        num1 = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">        num2 = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">        number = num1 * <span class="number">2</span></span><br><span class="line">        number += <span class="number">5</span></span><br><span class="line">        number *= <span class="number">5</span></span><br><span class="line">        number += num2</span><br><span class="line">        number -= <span class="number">25</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(number / <span class="number">10</span>) == num1 <span class="keyword">and</span> number % <span class="number">10</span> == num2:</span><br><span class="line">            number = generate_random_number()</span><br><span class="line">            num1 = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">sorted</span>(<span class="built_in">str</span>(number), reverse=<span class="literal">True</span>)))</span><br><span class="line">            num2 = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">sorted</span>(<span class="built_in">str</span>(number))))</span><br><span class="line">            diff = <span class="built_in">abs</span>(num1 - num2)</span><br><span class="line">            rev_diff = <span class="built_in">int</span>(<span class="built_in">str</span>(diff)[::-<span class="number">1</span>])</span><br><span class="line">            number = diff + rev_diff</span><br><span class="line">            <span class="keyword">if</span> number == <span class="number">1088</span>:</span><br><span class="line">                org = num</span><br><span class="line">                num *= <span class="number">2</span></span><br><span class="line">                num /= <span class="number">3</span></span><br><span class="line">                num += <span class="number">5</span></span><br><span class="line">                num *= <span class="number">4</span></span><br><span class="line">                num -= <span class="number">9</span></span><br><span class="line">                num -= org</span><br><span class="line">                <span class="keyword">return</span> num</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                number = generate_random_number_again()</span><br><span class="line">                i = <span class="number">0</span></span><br><span class="line">                <span class="keyword">while</span> number != <span class="number">6174</span>:</span><br><span class="line">                    digits = [<span class="built_in">int</span>(d) <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">str</span>(number)]</span><br><span class="line">                    digits.sort()</span><br><span class="line">                    smallest = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, digits)))</span><br><span class="line">                    digits.reverse()</span><br><span class="line">                    largest = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, digits)))</span><br><span class="line">                    number = largest - smallest</span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> i &lt;= <span class="number">7</span>:</span><br><span class="line">                    org = num</span><br><span class="line">                    num *= <span class="number">2</span></span><br><span class="line">                    num += <span class="number">7</span></span><br><span class="line">                    num += <span class="number">5</span></span><br><span class="line">                    num -= <span class="number">12</span></span><br><span class="line">                    num -= org</span><br><span class="line">                    num += <span class="number">4</span></span><br><span class="line">                    num *= <span class="number">2</span></span><br><span class="line">                    num -= <span class="number">8</span></span><br><span class="line">                    num -= org</span><br><span class="line">                    <span class="keyword">return</span> num</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    org = num</span><br><span class="line">                    num **= <span class="number">4</span></span><br><span class="line">                    num /= <span class="number">9</span></span><br><span class="line">                    num += <span class="number">55</span></span><br><span class="line">                    num *= <span class="number">6</span></span><br><span class="line">                    num += <span class="number">5</span></span><br><span class="line">                    num -= <span class="number">23</span></span><br><span class="line">                    num -= org</span><br><span class="line">                    <span class="keyword">return</span> num</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            org = num</span><br><span class="line">            num *= <span class="number">10</span></span><br><span class="line">            num += <span class="number">12</span></span><br><span class="line">            num **= <span class="number">3</span></span><br><span class="line">            num -= <span class="number">6</span></span><br><span class="line">            num += <span class="number">5</span></span><br><span class="line">            num -= org</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        org = num</span><br><span class="line">        num += <span class="number">5</span></span><br><span class="line">        num -= <span class="number">10</span></span><br><span class="line">        num *= <span class="number">2</span></span><br><span class="line">        num += <span class="number">12</span></span><br><span class="line">        num -= <span class="number">20</span></span><br><span class="line">        num -= org</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">p,key</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(p(transform(i))) <span class="keyword">for</span> i <span class="keyword">in</span> key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="built_in">open</span>(<span class="string">&#x27;key.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">enc = encrypt(poly,key)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>enc_key</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">☞➭⥄⫣Ⲋ⸹⿰ㆯ㍶☞⒗☞☞☞➭☞⥄☞⫣☞Ⲋ☞⸹☞⿰☞ㆯ☞㍶➭⒗➭</span><br></pre></td></tr></table></figure>

<blockquote>
<p>enc_flag</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">u5FUKxDUxH9y8yxvfaaU+GSXDwvJS6QxlN/3udOEzpU6fIVUExjDLsB3LKqUTz/x</span><br></pre></td></tr></table></figure>

<p>花近一小时琢磨后发现这个<code>transform</code>函数并无作用，就是说<code>transform(number) = number</code></p>
<p>key的每位字符进行了多项式运算：</p>
<p>$enckey_i &#x3D; 4\times key^2 + 3\times key + 7$</p>
<p>解这个方程即可获得key的每位字符</p>
<p>解出来后<code>key = 12345678910111213141516171819202</code></p>
<p>根据题目描述的，这是个简单的对称加密，于是找了个AES的解密网站<a target="_blank" rel="noopener" href="https://www.mklab.cn/utils/aes">AES在线加密解密工具 - MKLab在线工具</a></p>
<p><img src="/../../images/%E6%9D%82/10.png"></p>
<h2 id="Intellectual-Heir"><a href="#Intellectual-Heir" class="headerlink" title="Intellectual Heir"></a>Intellectual Heir</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my secret to hide the combination of my safe in fornt of all without anyone getting a clue what it is ;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#some boring python function for conversion nothing new</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_ass</span>(<span class="params">input_string</span>):</span><br><span class="line">    ass_values = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> input_string:</span><br><span class="line">        ass_values.append(<span class="built_in">str</span>(<span class="built_in">ord</span>(char)))</span><br><span class="line">    ass_str = <span class="string">&#x27;&#x27;</span>.join(ass_values)</span><br><span class="line">    <span class="keyword">return</span> ass_str</span><br><span class="line"></span><br><span class="line">input_string = <span class="built_in">input</span>(<span class="string">&quot;Enter the Combination: &quot;</span>)</span><br><span class="line">result = str_to_ass(input_string)</span><br><span class="line">msg = <span class="built_in">int</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#not that easy, you figure out yourself what the freck is a &amp; z</span></span><br><span class="line">a = </span><br><span class="line">z = </span><br><span class="line"></span><br><span class="line">f = (? * ?) <span class="comment">#cant remember what goes in the question mark</span></span><br><span class="line">e = <span class="comment">#what is usually used</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ohh yaa!! now you cant figure out $h!t</span></span><br><span class="line">encrypted = <span class="built_in">pow</span>(msg, e, f)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(encrypted))</span><br><span class="line"></span><br><span class="line"><span class="comment">#bamm!! protection for primes</span></span><br><span class="line">number = </span><br><span class="line"><span class="built_in">bin</span> = <span class="built_in">bin</span>(number)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">#bamm!! bamm!! double protection for primes</span></span><br><span class="line">bin_arr = np.array(<span class="built_in">list</span>(<span class="built_in">bin</span>), dtype=<span class="built_in">int</span>)</span><br><span class="line">result = np.sin(bin_arr)</span><br><span class="line">result = np.cos(bin_arr)</span><br><span class="line">np.savetxt(<span class="string">&quot;file1&quot;</span>, result)</span><br><span class="line">np.savetxt(<span class="string">&quot;file2&quot;</span>, result)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>file.txt</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4400037514278889258479265625258024039636437755883377709505596356049534358755375772484057042989024750972247184288820831886430459963472328358741858934783775986591400972020736548834642094922678189447202173710409868474198821576627330424767999152339702779346380</span><br></pre></td></tr></table></figure>

<blockquote>
<p>file1.txt</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5.403023058681397650e-01</span><br><span class="line">1.000000000000000000e+00</span><br><span class="line">5.403023058681397650e-01</span><br><span class="line">1.000000000000000000e+00</span><br><span class="line">5.403023058681397650e-01</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<blockquote>
<p>file2.txt</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">8.414709848078965049e-01</span><br><span class="line">0.000000000000000000e+00</span><br><span class="line">0.000000000000000000e+00</span><br><span class="line">0.000000000000000000e+00</span><br><span class="line">0.000000000000000000e+00</span><br><span class="line">8.414709848078965049e-01</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p><code>file1.txt</code>和<code>file2.txt</code>内容蛮多的，就不贴全了</p>
<p><code>str_to_ass()</code>函数的作用就是把输入的字符变成ASCII码，再转成str，eg:输入<code>A</code>，则<code>str_to_ass(&#39;A&#39;) = 65</code></p>
<p>a,z其实不用管，看了后面<code>encrypted</code>知道这大概是RSA加密，然后猜f应该就是模，e说了是最常用的，所以是65537</p>
<p>然后下面给了两组三角函数的值，分别放在了两个文件里面。</p>
<p>只需要知道<code>np.sin()</code>这个函数的作用就是算<code>bin_arr</code>里面每个元素的正弦值，比如<code>bin_arr = [1 0]</code>，那么返回的就是<code>[sin 1, 0]</code></p>
<p>不知道也没关系，自己跑一下脚本也可以看出规律</p>
<p>同理<code>np,cos()</code>也就明白了</p>
<p><code>file.txt</code>放的就是c，<code>file1.txt</code>放的是<code>np.cos()</code>,<code>file2.txt</code>放的是<code>np.sin()</code></p>
<p>这时候我们只需要根据两个文件的内容来恢复<code>number</code></p>
<p>拿<code>file1.txt</code>来说，如果此时的值是0，就说明当前二进制的值是<code>0</code>，否则当前二进制为<code>1</code></p>
<p><code>file2.txt</code>同理，此时的值为1的时候，当前二进制的值是<code>0</code>，否则当前二进制的值是<code>1</code></p>
<p>通过两个文件，可以得到两个素数，而且都是426bit，再根据c的大小是850bit，说明思路并没有问题，然后解密即可</p>
<p>不过需要注意的是最后得到的m应该做一个对<code>str_to_ass()</code>的逆向</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">4400037514278889258479265625258024039636437755883377709505596356049534358755375772484057042989024750972247184288820831886430459963472328358741858934783775986591400972020736548834642094922678189447202173710409868474198821576627330424767999152339702779346380</span></span><br><span class="line"></span><br><span class="line">number = <span class="string">&quot;&quot;</span></span><br><span class="line">lines = <span class="built_in">open</span>(<span class="string">&quot;file1.txt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lines)):</span><br><span class="line">    data = <span class="built_in">eval</span>(lines[i])</span><br><span class="line">    <span class="keyword">if</span> data == <span class="number">1</span>:</span><br><span class="line">        number += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        number += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line">number1 = <span class="string">&quot;&quot;</span></span><br><span class="line">lines = <span class="built_in">open</span>(<span class="string">&quot;file2.txt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lines)):</span><br><span class="line">    data = <span class="built_in">eval</span>(lines[i])</span><br><span class="line">    <span class="keyword">if</span> data == <span class="number">0</span>:</span><br><span class="line">        number1 += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        number1 += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(number,<span class="number">2</span>)</span><br><span class="line">q = <span class="built_in">int</span>(number1,<span class="number">2</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 8948859564825195843551958748828435899579709551</span></span><br><span class="line">msg = <span class="built_in">str</span>(m)</span><br><span class="line">flag = <span class="string">&quot;VishwaCTF&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(msg),<span class="number">2</span>):</span><br><span class="line">    mm = <span class="built_in">int</span>(msg[i:i+<span class="number">2</span>])</span><br><span class="line">    flag += <span class="built_in">chr</span>(mm)</span><br><span class="line">flag += <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># VishwaCTF&#123;Y0U_@R3_T#3_W0RT#Y_OF_3&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="BitBane"><a href="#BitBane" class="headerlink" title="BitBane"></a>BitBane</h2><blockquote>
<p>task.cpp</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">createTopping</span><span class="params">(<span class="type">int</span> curr, <span class="type">int</span> idx, <span class="type">int</span> &amp;not_remainder)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> temp = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">1</span>;</span><br><span class="line">    num = num &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (curr)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> remainder = curr % idx;</span><br><span class="line">        <span class="keyword">if</span> (remainder)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = temp * <span class="number">10</span> + remainder;</span><br><span class="line">            curr = curr - remainder;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            num = num | <span class="number">1</span>;</span><br><span class="line">            curr = curr / idx;</span><br><span class="line">        &#125;</span><br><span class="line">        num = num &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    temp = temp &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    temp = temp | <span class="number">1</span>;</span><br><span class="line">    not_remainder = temp;</span><br><span class="line">    <span class="keyword">return</span> num | <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">createBase</span><span class="params">(<span class="type">int</span> not_remainder)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">30</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (not_remainder)</span><br><span class="line">        &#123;</span><br><span class="line">            num = num | (not_remainder &amp; <span class="number">1</span>);</span><br><span class="line">            not_remainder = not_remainder &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        num = num &lt;&lt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">create</span><span class="params">(<span class="type">int</span> curr, <span class="type">int</span> idx)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> not_remainder = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> topping = <span class="built_in">createTopping</span>(curr, idx, not_remainder);</span><br><span class="line">    <span class="type">int</span> base = <span class="built_in">createBase</span>(not_remainder);</span><br><span class="line">    <span class="type">int</span> num = base | topping;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">checkValidity</span><span class="params">(<span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i * i &lt; num; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (num % i == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extraSecurity</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;encryption)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = encryption.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> idx = i + <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">checkValidity</span>(idx))</span><br><span class="line">        &#123;</span><br><span class="line">            encryption[i] = ~encryption[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">encode</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;encryption, <span class="type">const</span> string &amp;data, string &amp;key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> len = data.<span class="built_in">length</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> curr = data[i];</span><br><span class="line">        <span class="type">int</span> idx = (i % <span class="number">8</span>) + <span class="number">2</span>;</span><br><span class="line">        <span class="type">int</span> num = <span class="built_in">create</span>(curr, idx);</span><br><span class="line">        encryption.<span class="built_in">push_back</span>(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">applyKey</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp;encryption, string &amp;key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = key.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> curr = key[i];</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> cpy = curr;</span><br><span class="line">        <span class="keyword">while</span> (cpy)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (cpy &amp; <span class="number">1</span>)</span><br><span class="line">                ++cnt;</span><br><span class="line">            cpy = cpy &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curr = curr &lt;&lt; (i + <span class="number">10</span>);</span><br><span class="line">        <span class="keyword">while</span> (cnt--)</span><br><span class="line">        &#123;</span><br><span class="line">            curr = curr &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            curr = curr ^ <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> k = encryption.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; k; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            encryption[j] = encryption[j] ^ curr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">writeToFile</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt; &amp;encryption)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">ofstream <span class="title">outfile</span><span class="params">(<span class="string">&quot;Encrypted.txt&quot;</span>)</span></span>;</span><br><span class="line">    string data;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> ele : encryption)</span><br><span class="line">    &#123;</span><br><span class="line">        data += <span class="built_in">to_string</span>(ele);</span><br><span class="line">        data += <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    outfile &lt;&lt; data;</span><br><span class="line">    outfile.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fstream file;</span><br><span class="line">    file.<span class="built_in">open</span>(<span class="string">&quot;Flag.txt&quot;</span>);</span><br><span class="line">    string data;</span><br><span class="line">    file &gt;&gt; data;</span><br><span class="line">    file.<span class="built_in">close</span>();</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; encryption;</span><br><span class="line">    string key = <span class="string">&quot;VishwaCTF&quot;</span>;</span><br><span class="line">    <span class="built_in">encode</span>(encryption, data, key);</span><br><span class="line">    <span class="built_in">applyKey</span>(encryption, key);</span><br><span class="line">    <span class="built_in">extraSecurity</span>(encryption);</span><br><span class="line">    <span class="built_in">writeToFile</span>(encryption);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这道题有点逆向的感觉</p>
<p>先看主函数，先把flag进行了加密，然后用<code>applyKey</code>对密文进行处理，然后再用<code>extraSecurity</code>对密文再次处理</p>
<p>在看<code>extraSecurity</code>这个函数之前，先看一下<code>checkValidity(x)</code>这个函数，作用就是判断x是否是素数</p>
<p>然后就很好理解<code>extraSecurity(encryption)</code>这个函数的作用就是，是根据目前索引值<code>i</code>再加2的值，即<code>i+2</code>是否是素数，决定是否对<code>encryption[i]</code>取反。这个我们很容易就可以逆回去。</p>
<p>再看完<code>applyKey</code>这个函数，具体细节我就不说了，说不太清楚。总之可以发现，既然我们有了<code>key</code>，完全可以把原来的<code>encryption</code>恢复，(可以自己测试一下)。</p>
<p>最后就是<code>encode()</code>函数，看了很久发现没什么可以利用的点</p>
<p>最后想了想，因为有了key，完全可以通过爆破的方式来求解flag，前面的理解完全都不用看了。</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">create_topping</span>(<span class="params">curr, idx</span>):</span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    num = <span class="number">1</span></span><br><span class="line">    num = num &lt;&lt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> curr:</span><br><span class="line">        remainder = curr % idx</span><br><span class="line">        <span class="keyword">if</span> remainder:</span><br><span class="line">            temp = temp * <span class="number">10</span> + remainder</span><br><span class="line">            curr = curr - remainder</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            num = num | <span class="number">1</span></span><br><span class="line">            curr = curr // idx</span><br><span class="line">        num = num &lt;&lt; <span class="number">1</span></span><br><span class="line">    temp = temp &lt;&lt; <span class="number">1</span></span><br><span class="line">    temp = temp | <span class="number">1</span></span><br><span class="line">    not_remainder = temp</span><br><span class="line">    <span class="keyword">return</span> num | <span class="number">1</span>, not_remainder</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_base</span>(<span class="params">not_remainder</span>):</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">if</span> not_remainder:</span><br><span class="line">            num = num | (not_remainder &amp; <span class="number">1</span>)</span><br><span class="line">            not_remainder = not_remainder &gt;&gt; <span class="number">1</span></span><br><span class="line">        num = num &lt;&lt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>(<span class="params">curr, idx</span>):</span><br><span class="line">    not_remainder = <span class="number">0</span></span><br><span class="line">    topping, not_remainder = create_topping(curr, idx)</span><br><span class="line">    base = create_base(not_remainder)</span><br><span class="line">    num = base | topping</span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_validity</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(num ** <span class="number">0.5</span>) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> num % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extra_security</span>(<span class="params">encryption</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(encryption)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        idx = i + <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> check_validity(idx):</span><br><span class="line">            encryption[i] = ~encryption[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">encryption, data, key</span>):</span><br><span class="line">    len_data = <span class="built_in">len</span>(data)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len_data):</span><br><span class="line">        curr = <span class="built_in">ord</span>(data[i])</span><br><span class="line">        idx = (i % <span class="number">8</span>) + <span class="number">2</span></span><br><span class="line">        num = create(curr, idx)</span><br><span class="line">        encryption.append(num)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">apply_key</span>(<span class="params">encryption, key</span>):</span><br><span class="line">    n = <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        curr = <span class="built_in">ord</span>(key[i])</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        cpy = curr</span><br><span class="line">        <span class="keyword">while</span> cpy:</span><br><span class="line">            <span class="keyword">if</span> cpy &amp; <span class="number">1</span>:</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">            cpy = cpy &gt;&gt; <span class="number">1</span></span><br><span class="line">        curr = curr &lt;&lt; (i + <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">while</span> cnt &gt; <span class="number">0</span>:</span><br><span class="line">            curr = curr &lt;&lt; <span class="number">1</span></span><br><span class="line">            curr = curr ^ <span class="number">1</span></span><br><span class="line">            cnt -= <span class="number">1</span></span><br><span class="line">        k = <span class="built_in">len</span>(encryption)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            encryption[j] = encryption[j] ^ curr</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_to_file</span>(<span class="params">encryption</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Encrypted.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> outfile:</span><br><span class="line">        data = <span class="string">&quot; &quot;</span>.join(<span class="built_in">str</span>(ele) <span class="keyword">for</span> ele <span class="keyword">in</span> encryption)</span><br><span class="line">        outfile.write(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    enc = [-<span class="number">1934298443</span>,-<span class="number">1728250251</span>,-<span class="number">2103640211</span>,-<span class="number">1153630219</span>,<span class="number">1775435890</span>,-<span class="number">1670578291</span>,<span class="number">2009268234</span>,-<span class="number">2009268235</span>,<span class="number">1950549658</span>,-<span class="number">1992754035</span>,<span class="number">1673724026</span>,-<span class="number">1398997107</span>,<span class="number">1405288466</span>,<span class="number">1824718858</span>,<span class="number">2131951730</span>,-<span class="number">1765998643</span>,<span class="number">1934298490</span>,-<span class="number">1330315635</span>,<span class="number">2063794322</span>,<span class="number">1889730674</span>,<span class="number">1124270194</span>,-<span class="number">2059599891</span>,<span class="number">1086521394</span>,-<span class="number">1858273331</span>,<span class="number">1909484170</span>,<span class="number">1229390194</span>,<span class="number">1757609994</span>,-<span class="number">1275265139</span>,<span class="number">1201864818</span>,-<span class="number">1892876403</span>,<span class="number">1673723922</span>,<span class="number">2009268234</span>,<span class="number">1950549402</span>,<span class="number">1229390194</span>,<span class="number">1947140466</span>,-<span class="number">1942159371</span>,<span class="number">1849884786</span>,<span class="number">1703084146</span>,<span class="number">1824718858</span>,-<span class="number">1665335347</span>,<span class="number">1909484170</span>,-<span class="number">1229390195</span>,<span class="number">1757609994</span>,<span class="number">1170407434</span>,<span class="number">1124270194</span>,-<span class="number">1918042227</span>,<span class="number">2038628466</span>,-<span class="number">1982005363</span>,<span class="number">1950549834</span>,<span class="number">1124270322</span>,<span class="number">1782775922</span>,-<span class="number">1738735731</span>,<span class="number">1768095858</span>,<span class="number">1842544754</span>,<span class="number">2127757426</span>]</span><br><span class="line">    enc[<span class="number">23</span>] = ~enc[<span class="number">23</span>]</span><br><span class="line">    enc[<span class="number">47</span>] = ~enc[<span class="number">47</span>]</span><br><span class="line">    key = <span class="string">&quot;VishwaCTF&quot;</span></span><br><span class="line">    know = <span class="string">&quot;VishwaCTF&#123;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc) - <span class="built_in">len</span>(know)):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">128</span>):</span><br><span class="line">            encryption = []</span><br><span class="line">            encode(encryption,know + <span class="built_in">chr</span>(i),key)</span><br><span class="line">            apply_key(encryption,key)</span><br><span class="line">            extra_security(encryption)</span><br><span class="line">            <span class="keyword">if</span> (enc[<span class="number">10</span>+j] == encryption[<span class="number">10</span>+j]):</span><br><span class="line">                know += <span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># else:</span></span><br><span class="line">            <span class="comment">#     print(f&quot;第&#123;10+j&#125;处出错&quot;)</span></span><br><span class="line">        <span class="built_in">print</span>(know)</span><br><span class="line">        <span class="comment"># VishwaCTF&#123;BIT5_3NCRYPT3D_D3CRYPTED_M1ND5_D33PLY_TE5T3D&#125;</span></span><br></pre></td></tr></table></figure>

<p>爆破的时候出了点小问题，慢慢调试了之后找到问题在于<code>enc[23]</code>和<code>enc[47]</code>没取反，所以对<code>enc[23]，enc[47]</code>进行了手动取反</p>
<h2 id="Lets-smother-the-King"><a href="#Lets-smother-the-King" class="headerlink" title="Lets smother the King!"></a>Lets smother the King!</h2><blockquote>
<p>题目描述:</p>
<p>In my friend circle, Mr. Olmstead and Mr. Ben always communicate with each other through a secret code language that they created, which we never understand. Here is one of the messages Mr. Ben sent to Mr. Olmstead, which I somehow managed to hack and extract it from Ben’s PC. However, it’s encrypted, and I don’t comprehend their programming language. Besides being proficient programmers, they are also professional chess players. It appears that this is a forced mate in a 4-move chess puzzle, but the information needs to be decrypted to solve it. Help me out here to solve the chess puzzle and get the flag.</p>
<p>Flag format: VishwaCTF{move1ofWhite_move1ofBlack_move2ofWhite_move2ofBlack_move3ofWhite_move3ofBlack_move4ofWhite}.</p>
<p>Note: Please use proper chess notations while writing any move.</p>
</blockquote>
<blockquote>
<p>code.txt</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D&#x27;`A_9!7&#125;;|jE7TBRdQbqM(n&amp;JlGGE3feB@!x=v&lt;)\r8YXtsl2Sonmf,jLKa&#x27;edFEa`_X|?UTx;WPUTMqKPONGFjJ,HG@d&#x27;=BA@?&gt;7[;4z21U54ts10/.&#x27;K+$j(!Efe#z@a&#125;vut:[Zvutsrqj0ngOe+Lbg`edc\&quot;CBXW&#123;[TSRvP8TMq4JONGFj-IBGF?c=a$@9]=6|:3W10543,P*/.&#x27;&amp;%$Hi&#x27;&amp;%$&#123;z@a&#125;vut:xqp6nVrqpoh.fedcb(IHdcba`_X|V[ZYXWPOsMLKJINGkKJI+G@dDCBA#&quot;8=6Z4z21U5ut,P0)(-&amp;J*)&quot;!E&#125;e#&quot;!x&gt;|uzs9qvo5srkpingf,Mchg`_%cbaZBXW&#123;&gt;=YXWPOs65KPImMLEDIBf)(D=a$:?&gt;7&lt;54X210/43,Pqp(&#x27;,+*#G&#x27;gf|B&quot;y?&#125;v^tsr8vuWsrqpi/POkdibgf_%]b[Z_X|?&gt;TYRQu8TMqQPIHGkEJIBA@dD&amp;B;@?8\&lt;5&#123;3W70/.-Q10/on,%Ij(&#x27;~&#125;|B&quot;!~&#125;_u;y[Zponm3qpoQg-kjihgfeG]#aCBXW&#123;[ZYX:Pt7SRQJONMLEiIHA@?cCB$@9]~&lt;;:921U543,10/.-&amp;J*j(&#x27;~&#125;$&#123;A!~&#125;vuzs9Zponm3qpihmf,jihgfeG]#n</span><br></pre></td></tr></table></figure>

<p>密文很怪，没什么线索。根据题目描述搜了下<code>Ben</code>和<code>Olmstead</code>，分开搜也没有线索，合起来搜以后了解到Malbolge这个编程语言</p>
<p><img src="/../../images/%E6%9D%82/11.png"></p>
<p>然后找个在线网站运行一下<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/tryrun/runcode?lang=malbolge">malbolge在线运行,在线工具，在线编译IDE_w3cschool</a></p>
<p>得到结果</p>
<p><img src="/../../images/%E6%9D%82/12.png"></p>
<p>再结合一下GPT得知，这是一个残局，这些符号的信息如下：</p>
<p><img src="/../../images/%E6%9D%82/13.png"></p>
<p>然后再找个网站分析一下残局，寻找白棋4步绝杀的方法</p>
<p><a target="_blank" rel="noopener" href="https://chessdb.cn/queryc/">国际象棋云库查询 (chessdb.cn)</a></p>
<p>使用的时候把在线计算关了，会快一点。</p>
<p><img src="/../../images/%E6%9D%82/14.png"></p>
<p>得到解法之后拼接flag即可</p>
<p><code>VishwaCTF&#123;Nc7+_Kb8_Na6+_Ka8_Qb8+_Rxb8_Nc7#&#125;</code></p>
<h1 id="GHCTF"><a href="#GHCTF" class="headerlink" title="GHCTF"></a>GHCTF</h1><h2 id="2024九省联考"><a href="#2024九省联考" class="headerlink" title="2024九省联考"></a>2024九省联考</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getKey</span>():</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">assert</span> m &lt; n</span><br><span class="line">    _g = randint(<span class="number">1</span>,n)</span><br><span class="line">    _a = randint(<span class="number">1</span>,n)</span><br><span class="line">    _b = randint(<span class="number">1</span>,n)</span><br><span class="line">    <span class="keyword">return</span> _g,_a,_b,p,n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    key = getKey()</span><br><span class="line">    _key = <span class="built_in">pow</span>(key[<span class="number">0</span>], key[<span class="number">1</span>] * (key[<span class="number">3</span>]-<span class="number">1</span>), key[<span class="number">4</span>])</span><br><span class="line">    c = (<span class="built_in">pow</span>(_key, key[<span class="number">2</span>], key[<span class="number">4</span>]) * m) % key[<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">return</span> key[<span class="number">4</span>], _key, c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(encrypt())</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">(18179834236782025892165859358541969039672768622078317899558535972829779066590034272465041741258879770213528640616887797155080398928088158585694106907734126514213361875345507975960317351812797992725951327122851713302327820458710931182497244211627793166445441450354787055708273445176257841426295561697059359851693234672902342001564298222123930677021693824135290857682548806726262690296776413730423712555689778608531366304345258560702517364961150273435113114487840186421965955626002395362990009595593448407759619600184788649602049313701058708439962867646774483596360223764988749726613678029307186833464512585242569435003, 11847655277251446942383940882912368688156808473955941053063218251376227576794849789637061751561030423224338717881358695503734129213448747206540310077968159679087902861554101729530885006978457916005370151390141770528828726044070599163879940393777653050010384591813315879288161460396096268260181418863020260300992421872071273292678599559844166740721617200084689717099280979932276914367828947937478359933181441706805653179826272658999406454166746306193757296165968606398592219586135127604969713571323480832108309240510220649110629512108142189299294329845348146274638537031635599971704959419196082418167981085622698281250, 14415195091596957208690057717270843038813723273773797640804955509618976877138721476691508292484187601673314627535732234517837698631950684940570225175917508902812451340933203438247448893168609525426014319195770233401480816194489198464476480610373345480444974658239730190879678428967798637043230820661470572128997114218312981971051639788050332764374932384836724719743407759997343303062259374222621789562479046933232021478087932233308027796973486804634154183554333108258875955181959785332882009189939917648988868671919046698887438054678239786487480196578700573286352849560893479759745211457149133610748492277912237022560)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>$$<br>\because key \equiv g^{a\times (p-1)} \mod n<br>$$</p>
<p>可以推出<br>$$<br>key \equiv g^{a\times (p-1)} \mod p<br>$$</p>
<p>$$<br>key \equiv g^{a\times (p-1)} \mod q<br>$$</p>
<p>通过费马小定理可以知道<br>$$<br>key \equiv g^{a\times (p-1)}\equiv 1 \mod p<br>$$</p>
<p>$$<br>\therefore key - 1 &#x3D; kp<br>$$</p>
<p>则<code>gcd(key-1,p) = p</code><br>$$<br>c \equiv key^b \times m\mod n<br>$$<br>同理可推出<br>$$<br>c \equiv key^b \times m\mod p<br>$$</p>
<p>$$<br>c \equiv key^b \times m\mod q<br>$$</p>
<p>在mod p下，我们有<br>$$<br>c \equiv key^b \times m \equiv 1 \times m \mod p<br>$$</p>
<p>$$<br>\therefore m \equiv c \mod p<br>$$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n,y1,y2 = (<span class="number">18179834236782025892165859358541969039672768622078317899558535972829779066590034272465041741258879770213528640616887797155080398928088158585694106907734126514213361875345507975960317351812797992725951327122851713302327820458710931182497244211627793166445441450354787055708273445176257841426295561697059359851693234672902342001564298222123930677021693824135290857682548806726262690296776413730423712555689778608531366304345258560702517364961150273435113114487840186421965955626002395362990009595593448407759619600184788649602049313701058708439962867646774483596360223764988749726613678029307186833464512585242569435003</span>, <span class="number">11847655277251446942383940882912368688156808473955941053063218251376227576794849789637061751561030423224338717881358695503734129213448747206540310077968159679087902861554101729530885006978457916005370151390141770528828726044070599163879940393777653050010384591813315879288161460396096268260181418863020260300992421872071273292678599559844166740721617200084689717099280979932276914367828947937478359933181441706805653179826272658999406454166746306193757296165968606398592219586135127604969713571323480832108309240510220649110629512108142189299294329845348146274638537031635599971704959419196082418167981085622698281250</span>, <span class="number">14415195091596957208690057717270843038813723273773797640804955509618976877138721476691508292484187601673314627535732234517837698631950684940570225175917508902812451340933203438247448893168609525426014319195770233401480816194489198464476480610373345480444974658239730190879678428967798637043230820661470572128997114218312981971051639788050332764374932384836724719743407759997343303062259374222621789562479046933232021478087932233308027796973486804634154183554333108258875955181959785332882009189939917648988868671919046698887438054678239786487480196578700573286352849560893479759745211457149133610748492277912237022560</span>)</span><br><span class="line"></span><br><span class="line">kp = y1 - <span class="number">1</span></span><br><span class="line">p = gmpy2.gcd(kp,n)</span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">m = y2 % p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># NSSCTF&#123;F3RmM4t&#x27;s_Li7tLe_The0Rem_1s_S0_Funny!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="2023四省联考"><a href="#2023四省联考" class="headerlink" title="2023四省联考"></a>2023四省联考</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag1, flag2</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">a = getPrime(<span class="number">256</span>)</span><br><span class="line">b = getPrime(<span class="number">256</span>)</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = getPrime(<span class="number">256</span>)</span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line">cipher_left = bytes_to_long(flag1) * m[<span class="number">0</span>]</span><br><span class="line">cipher_right = bytes_to_long(flag2) * m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;k = <span class="subst">&#123;k&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;E = <span class="subst">&#123;E&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_left = <span class="subst">&#123;cipher_left&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_right = <span class="subst">&#123;cipher_right&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p = 89483595401193659714875788802968429205691837099576262739461780495250135533277</span></span><br><span class="line"><span class="string">a = 64826237317229947176929808786908866900942344000188828024006529547932535008343</span></span><br><span class="line"><span class="string">b = 78534056584783370803046009116134540449521103461992771640264791547574821609373</span></span><br><span class="line"><span class="string">k = 67913488585481211548108713418125579002164994747094092682155324503393614823971</span></span><br><span class="line"><span class="string">E = Elliptic Curve defined by y^2 = x^3 + 64826237317229947176929808786908866900942344000188828024006529547932535008343*x + 78534056584783370803046009116134540449521103461992771640264791547574821609373 over Finite Field of size 89483595401193659714875788802968429205691837099576262739461780495250135533277</span></span><br><span class="line"><span class="string">c1 = (20170213458584797544543993897296811751081832389059185129461453627621072513038 : 27952719726918348295869968868334378954262663325210512999629622439578788756554 : 1)</span></span><br><span class="line"><span class="string">c2 = (76989745919392442231791141013473547805494699378782297471380010885452647846211 : 47918018207526659936015900897811268310416123040265940227150505093449710748656 : 1)</span></span><br><span class="line"><span class="string">cipher_left = 86744083522644883993519202607829403371478208823454264731598682010623698941787</span></span><br><span class="line"><span class="string">cipher_right = 56539907781612875080666281009932166966795966968474267210348249516329832411261</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>抓住关键即可<br>$$<br>\because c_1 &#x3D; m + r\times K &#x3D; m + r\times k \times G<br>$$</p>
<p>$$<br>c_2 &#x3D; r\times G<br>$$</p>
<p>$$<br>\therefore m&#x3D; c_1 - k\times c_2<br>$$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">89483595401193659714875788802968429205691837099576262739461780495250135533277</span></span><br><span class="line">a = <span class="number">64826237317229947176929808786908866900942344000188828024006529547932535008343</span></span><br><span class="line">b = <span class="number">78534056584783370803046009116134540449521103461992771640264791547574821609373</span></span><br><span class="line">k = <span class="number">67913488585481211548108713418125579002164994747094092682155324503393614823971</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">c1 = E(<span class="number">20170213458584797544543993897296811751081832389059185129461453627621072513038</span>,<span class="number">27952719726918348295869968868334378954262663325210512999629622439578788756554</span>)</span><br><span class="line">c2 = E(<span class="number">76989745919392442231791141013473547805494699378782297471380010885452647846211</span>,<span class="number">47918018207526659936015900897811268310416123040265940227150505093449710748656</span>)</span><br><span class="line">cipher_left = <span class="number">86744083522644883993519202607829403371478208823454264731598682010623698941787</span></span><br><span class="line">cipher_right = <span class="number">56539907781612875080666281009932166966795966968474267210348249516329832411261</span></span><br><span class="line"></span><br><span class="line">M = c1 - k*c2</span><br><span class="line">m1 = cipher_left // M[<span class="number">0</span>]</span><br><span class="line">m2 = cipher_right // M[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m1)) + long_to_bytes(<span class="built_in">int</span>(m2)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;d0_y0u_L1ke_YiXiXi?_dbad24c05a32&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Crypto1921"><a href="#Crypto1921" class="headerlink" title="Crypto1921"></a>Crypto1921</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.---- ...-- .---- .---- -..-. ----- -.... .---- ..... -..-. ----- ...-- ...-- ---.. -..-. ...-- .---- ..--- --... -..-. ....- ....- ...-- -.... -..-. ----- ..--- ...-- ....- -..-. ..--- ..... ----. ---.. -..-. .---- ---.. ----- --... -..-. -.... ....- ..--- ....- -..-. .---- -.... ...-- ...-- -..-. ...-- .---- ..... ----. -..-. ----- ...-- -.... ..--- -..-. ..... --... .---- ....- -..-. ...-- ----. ----. ..--- -..-. ----- .---- ...-- ---.. -..-. ..--- ..... ---.. ----. -..-. --... ....- ..... -.... -..-. ----- ....- ....- .---- -..-. ----- ....- ...-- ...-- -..-. .---- ...-- .---- .---- -..-. -.... .---- ..... ...-- -..-. ----- ....- -.... --... -..-. ----- -.... ...-- --... -..-. ..--- ..--- ...-- ..--- -..-. ..--- -.... ---.. -.... -..-. ----- ----. --... -.... -..-. ..--- ---.. --... .---- -..-. ..--- -.... ...-- ----. -..-. ....- ---.. ....- ..--- -..-. .---- -.... ...-- ...-- -..-. ----- ----- ..... ----. -..-. .---- -.... ...-- ...-- -..-. .---- -.... ..... ...-- -..-. ----- ----- ..... ----. -..-. ----- ...-- -.... ----- -..-. ----- ....- ...-- ...-- -..-. .---- -.... ...-- ...-- -..-. ----- ...-- -.... ..--- -..-. ....- ....- ...-- ..--- -..-. ----- ..... ..... ....- -..-. ....- ---.. ---.. ..... -..-. ----- ----- ----- ..... -..-. .---- -.... ...-- ...-- -..-. .---- -.... ..... ...-- -..-. .---- -.... ...-- ...-- -..-. ----- ----- ----- ..... -..-. ----- ....- ...-- ...-- -..-. ----- ...-- -.... ..--- -..-. ....- ....- ...-- ..---</span><br></pre></td></tr></table></figure>

<p>摩斯解码得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1311/0615/0338/3127/4436/0234/2598/1807/6424/1633/3159/0362/5714/3992/0138/2589/7456/0441/0433/1311/6153/0467/0637/2232/2686/0976/2871/2639/4842/1633/0059/1633/1653/0059/0360/0433/1633/0362/4432/0554/4885/0005/1633/1653/1633/0005/0433/0362/4432</span><br></pre></td></tr></table></figure>

<p>中文电码查询得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">1311：子</span><br><span class="line">0615：卿</span><br><span class="line">0338：兄</span><br><span class="line">3127：法</span><br><span class="line">4436：租</span><br><span class="line">0234：借</span><br><span class="line">2598：望</span><br><span class="line">1807：志</span><br><span class="line">6424：路</span><br><span class="line">1633：幺</span><br><span class="line">3159：洞</span><br><span class="line">0362：六</span><br><span class="line">5714：号</span><br><span class="line">3992：疑</span><br><span class="line">0138：似</span><br><span class="line">2589：有</span><br><span class="line">7456：马</span><br><span class="line">0441：列</span><br><span class="line">0433：分</span><br><span class="line">1311：子</span><br><span class="line">6153：请</span><br><span class="line">0467：前</span><br><span class="line">0637：去</span><br><span class="line">2232：探</span><br><span class="line">2686：查</span><br><span class="line">0976：坐</span><br><span class="line">2871：标</span><br><span class="line">2639：东</span><br><span class="line">4842：经</span><br><span class="line">1633：幺</span><br><span class="line">0059：二</span><br><span class="line">1633：幺</span><br><span class="line">1653：度</span><br><span class="line">0059：二</span><br><span class="line">0360：八</span><br><span class="line">0433：分</span><br><span class="line">1633：幺</span><br><span class="line">0362：六</span><br><span class="line">4432：秒</span><br><span class="line">0554：北</span><br><span class="line">4885：纬</span><br><span class="line">0005：三</span><br><span class="line">1633：幺</span><br><span class="line">1653：度</span><br><span class="line">1633：幺</span><br><span class="line">0005：三</span><br><span class="line">0433：分</span><br><span class="line">0362：六</span><br><span class="line">4432：秒</span><br><span class="line">121°28′16″   -&gt; 121.4711111111°</span><br><span class="line">31°13&#x27;6&quot;        -&gt; 31.2183333333°</span><br></pre></td></tr></table></figure>

<p>压缩包密码即<code>121.471E,31.218N</code></p>
<p>打开得到信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">這次會議遭到破壞，恐怕是存在著敵特的監視。請你幫助我們擬一封電報，發送給XXX，內容為：</span><br><span class="line">上海已不安全，請即刻前往嘉興。</span><br><span class="line">（题目背景为架空历史）</span><br><span class="line"></span><br><span class="line">压缩包2的密码为发送的电报（摩斯电码形式）的md5，请参考你所截获到的电报进行构建。</span><br></pre></td></tr></table></figure>

<p>将<code>上海已不安全，請即刻前往嘉興。</code>进行编码</p>
<p><img src="/../../images/%E6%9D%82/16.png"></p>
<p>转为<code>0006/3189/1571/0008/1344/0356/6153/0613/0466/0467/1766/0857/5281</code></p>
<p>进行摩斯编码得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">----- ----- ----- -.... -..-. ...-- .---- ---.. ----. -..-. .---- ..... --... .---- -..-. ----- ----- ----- ---.. -..-. .---- ...-- ....- ....- -..-. ----- ...-- ..... -.... -..-. -.... .---- ..... ...-- -..-. ----- -.... .---- ...-- -..-. ----- ....- -.... -.... -..-. ----- ....- -.... --... -..-. .---- --... -.... -.... -..-. ----- ---.. ..... --... -..-. ..... ..--- ---.. .----</span><br></pre></td></tr></table></figure>

<p>再md5得到<code>43f756680ebbcc619bc7b9a4c69e18ab</code>，即为压缩包密码</p>
<p>flag:<code>NSSCTF&#123;Wh3Re_7herE_1s_OppreSsi0n_Ther3_iS_REs1st4nce!&#125;</code></p>
<h2 id="Crypto1939"><a href="#Crypto1939" class="headerlink" title="Crypto1939"></a>Crypto1939</h2><blockquote>
<p>cipher.txt</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Che-chil-be-tah-ola</span><br><span class="line">Atcah</span><br><span class="line">Con-nil-kol-lih</span><br><span class="line">Tabaha</span><br><span class="line">Yo-ih</span><br><span class="line"></span><br><span class="line">密码为全小写，各个单词之间用_连接</span><br></pre></td></tr></table></figure>

<p>密文是Navajo</p>
<p>网上找码表即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Che-chil-be-tah-ola				-&gt; 		major</span><br><span class="line">Atcah							-&gt;		应是Astah					-&gt;Transport Plane</span><br><span class="line">Con-nil-kol-lih					-&gt;		应是Coh-nil-kol-lih 		-&gt;Blinker</span><br><span class="line">Tabaha							-&gt;		regiment</span><br><span class="line">Yo-ih							-&gt;		section</span><br></pre></td></tr></table></figure>

<p>压缩包密码为<code>major_transport_blinker_regiment_section</code></p>
<p><code>NSSCTF&#123;W0Rds_SomeTimes_N3ec1_L1vEs_To_DeFend!&#125;</code></p>
<h2 id="Crypto2042"><a href="#Crypto2042" class="headerlink" title="Crypto2042"></a>Crypto2042</h2><p>给出<code>c = 2280855825153079369164514405327170396436620371664464526496429415733055203155893358484242996086505609777681080427906338470140692619928813296029361848636902023401977358243759630394370381376771421271028169492126347929997983519619222735581769019133156193638407197605823449074124544232663174637158818370904094998560600412703805652546502801423946150024740398302185572802694514470006408627417645654400501165391976205173956917696904810606259304153658230235808250378495226246727449749944446621780268923502478344984402162063011322533642498211989023200258638304752854056875616723925602248635708248865548095231743243612632966212</code></p>
<p>以及破损私钥文件</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN BREAK PEM PRIVATE-----</span><br><span class="line">MIIEowIBAAKCAQEAw6JUixKmoIZjLyR1Qc/D/3mfTC3YvqKienLM7Nt/83UqpYeg</span><br><span class="line">9rOw02xLtIqgBdVyVkI+MknQdB5tB1W/bo95M8JjmNxi5rcEzXK4A5HiKtNxK9hC</span><br><span class="line">dE1GIt78XcT1FLoM86zxFonkDQ8LxHXPbU22+Ex8ov269pS/BEwZuKohqbIUU4iZ</span><br><span class="line">UltNYW2kaVsavAZw4NyQcQCQoijprdrQZLV6XjC/<span class="number">3</span>+uX6baLaZS+NWHm1M16UHde</span><br><span class="line">IF9B1gNuifO0xnuAWxRENjBIXw/3W8OVvRuRUppY2WYgeEG31fgfOCDoXhWVbqAD</span><br><span class="line">6fJA9JWdkOPDqUAsqFCr2VKnORa2X9V9HdO5lwIDAQABAoIBAQD/////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////AoGBAP//////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////AoGBAP//</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////////////////////////////</span><br><span class="line">////////////////////////////////////////AoGAZFBey/5KFQ1nOL6xe00r</span><br><span class="line">ehGXxxNQF/7oym0kzI6BBi4awYZ4FCtuGiiAfkcsOS0UhlhFn1gEemnl2f2EF78M</span><br><span class="line">THN5zVM5FSY5Cf8XwJT/fEytuWdCQke7JxVYOLNsEJeViicsasXeWeSL1nPYS3a5</span><br><span class="line">+T4027LUdjikIbu508dTT6UCgYAY+t0pv5nJ93J3773ZZYkLSCG+zXZBSgUtcCoQ</span><br><span class="line">GTBa4Qcr3MLeeUGDkb4qNIBdqWsQR0GiIXLkoIxcmOr66Rs+Hl60MD0kWQA6uz5/</span><br><span class="line">aJOhZc8pO0vGVG3+RbKA4xTxZshopp4CVdCrM20SqXXa3OEqr48Ec1aIES/ymZO8</span><br><span class="line">GuaOwQKBgB4ZWvOfPzCFOselDYyjz2Tub1RY3YrvI1do3jl42nhy/1Aoc6G3XLi4</span><br><span class="line">AIg8gxJGx36aPjpxBfe1HTicBhtUThBxq/A2/Ed1TwxFDvDPjhDc1Js/LL0qxhaP</span><br><span class="line">Z/xYCgGGZftjQqPTy+S62ppYVcTxjDON6vNBssatGUIzuGglC2Lf</span><br><span class="line">-----END BREAK PEM PRIVATE-----</span><br></pre></td></tr></table></figure>

<p>能提取出<code>n,e,dp,dq,inv</code>，关于提取数据可以参考<a href="https://dexterjie.github.io/2024/01/13/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NSSCTF-Round16/#break">NSSCTF Round16 | DexterJie’Blog</a></p>
<p>然后用dp泄露的思路进行求解</p>
<blockquote>
<p>Exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">2280855825153079369164514405327170396436620371664464526496429415733055203155893358484242996086505609777681080427906338470140692619928813296029361848636902023401977358243759630394370381376771421271028169492126347929997983519619222735581769019133156193638407197605823449074124544232663174637158818370904094998560600412703805652546502801423946150024740398302185572802694514470006408627417645654400501165391976205173956917696904810606259304153658230235808250378495226246727449749944446621780268923502478344984402162063011322533642498211989023200258638304752854056875616723925602248635708248865548095231743243612632966212</span></span><br><span class="line">n = <span class="built_in">int</span>(<span class="string">&quot;c3 a2 54 8b 12 a6 a0 86 63 2f 24 75 41 cf c3 ff 79 9f 4c 2d d8 be a2 a2 7a 72 cc ec db 7f f3 75 2a a5 87 a0 f6 b3 b0 d3 6c 4b b4 8a a0 05 d5 72 56 42 3e 32 49 d0 74 1e 6d 07 55 bf 6e 8f 79 33 c2 63 98 dc 62 e6 b7 04 cd 72 b8 03 91 e2 2a d3 71 2b d8 42 74 4d 46 22 de fc 5d c4 f5 14 ba 0c f3 ac f1 16 89 e4 0d 0f 0b c4 75 cf 6d 4d b6 f8 4c 7c a2 fd ba f6 94 bf 04 4c 19 b8 aa 21 a9 b2 14 53 88 99 52 5b 4d 61 6d a4 69 5b 1a bc 06 70 e0 dc 90 71 00 90 a2 28 e9 ad da d0 64 b5 7a 5e 30 bf df eb 97 e9 b6 8b 69 94 be 35 61 e6 d4 cd 7a 50 77 5e 20 5f 41 d6 03 6e 89 f3 b4 c6 7b 80 5b 14 44 36 30 48 5f 0f f7 5b c3 95 bd 1b 91 52 9a 58 d9 66 20 78 41 b7 d5 f8 1f 38 20 e8 5e 15 95 6e a0 03 e9 f2 40 f4 95 9d 90 e3 c3 a9 40 2c a8 50 ab d9 52 a7 39 16 b6 5f d5 7d 1d d3 b9 97&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>),<span class="number">16</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">dp = <span class="built_in">int</span>(<span class="string">&quot;64 50 5e cb fe 4a 15 0d 67 38 be b1 7b 4d 2b 7a 11 97 c7 13 50 17 fe e8 ca 6d 24 cc 8e 81 06 2e 1a c1 86 78 14 2b 6e 1a 28 80 7e 47 2c 39 2d 14 86 58 45 9f 58 04 7a 69 e5 d9 fd 84 17 bf 0c 4c 73 79 cd 53 39 15 26 39 09 ff 17 c0 94 ff 7c 4c ad b9 67 42 42 47 bb 27 15 58 38 b3 6c 10 97 95 8a 27 2c 6a c5 de 59 e4 8b d6 73 d8 4b 76 b9 f9 3e 34 db b2 d4 76 38 a4 21 bb b9 d3 c7 53 4f a5&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>),<span class="number">16</span>)</span><br><span class="line">dq = <span class="built_in">int</span>(<span class="string">&quot;18 fa dd 29 bf 99 c9 f7 72 77 ef bd d9 65 89 0b 48 21 be cd 76 41 4a 05 2d 70 2a 10 19 30 5a e1 07 2b dc c2 de 79 41 83 91 be 2a 34 80 5d a9 6b 10 47 41 a2 21 72 e4 a0 8c 5c 98 ea fa e9 1b 3e 1e 5e b4 30 3d 24 59 00 3a bb 3e 7f 68 93 a1 65 cf 29 3b 4b c6 54 6d fe 45 b2 80 e3 14 f1 66 c8 68 a6 9e 02 55 d0 ab 33 6d 12 a9 75 da dc e1 2a af 8f 04 73 56 88 11 2f f2 99 93 bc 1a e6 8e c1&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>),<span class="number">16</span>)</span><br><span class="line">inv = <span class="built_in">int</span>(<span class="string">&quot;1e 19 5a f3 9f 3f 30 85 3a c7 a5 0d 8c a3 cf 64 ee 6f 54 58 dd 8a ef 23 57 68 de 39 78 da 78 72 ff 50 28 73 a1 b7 5c b8 b8 00 88 3c 83 12 46 c7 7e 9a 3e 3a 71 05 f7 b5 1d 38 9c 06 1b 54 4e 10 71 ab f0 36 fc 47 75 4f 0c 45 0e f0 cf 8e 10 dc d4 9b 3f 2c bd 2a c6 16 8f 67 fc 58 0a 01 86 65 fb 63 42 a3 d3 cb e4 ba da 9a 58 55 c4 f1 8c 33 8d ea f3 41 b2 c6 ad 19 42 33 b8 68 25 0b 62 df&quot;</span>.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&quot;</span>),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp_leak</span>(<span class="params">dp,c,n,e</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">        t = (dp * e - <span class="number">1</span>) % i        </span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">            p = (dp * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">                q = n // p</span><br><span class="line">                d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line">                </span><br><span class="line">dp_leak(dp,c,n,e)</span><br><span class="line"><span class="comment"># NSSCTF&#123;(115.36517E, 39.30839N)&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="osu"><a href="#osu" class="headerlink" title="osu"></a>osu</h1><h2 id="第一道题"><a href="#第一道题" class="headerlink" title="第一道题"></a>第一道题</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getWYSIprime</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        digits = [random.choice(<span class="string">&quot;727&quot;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">272</span>)]</span><br><span class="line">        prime = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(digits))</span><br><span class="line">        <span class="keyword">if</span> isPrime(prime):</span><br><span class="line">            <span class="keyword">return</span> prime</span><br><span class="line">        </span><br><span class="line"><span class="comment"># RSA encryption using the WYSI primes</span></span><br><span class="line">p = getWYSIprime()</span><br><span class="line">q = getWYSIprime()</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">flag = bytes_to_long(os.getenv(<span class="string">&quot;FLAG&quot;</span>,<span class="string">b&quot;osu&#123;fake_flag_for_testing&#125;&quot;</span>))</span><br><span class="line">ciphertext = <span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ciphertext = <span class="subst">&#123;ciphertext&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 2160489795493918825870689458820648828073650907916827108594219132976202835249425984494778310568338106260399032800745421512005980632641226298431130513637640125399673697368934008374907832728004469350033174207285393191694692228748281256956917290437627249889472471749973975591415828107248775449619403563269856991145789325659736854030396401772371148983463743700921913930643887223704115714270634525795771407138067936125866995910432010323584269926871467482064993332990516534083898654487467161183876470821163254662352951613205371404232685831299594035879</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">ciphertext = 2087465275374927411696643073934443161977332564784688452208874207586196343901447373283939960111955963073429256266959192725814591103495590654238320816453299972810032321690243148092328690893438620034168359613530005646388116690482999620292746246472545500537029353066218068261278475470490922381998208396008297649151265515949490058859271855915806534872788601506545082508028917211992107642670108678400276555889198472686479168292281830557272701569298806067439923555717602352224216701010790924698838402522493324695403237985441044135894549709670322380450</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>从低位往高位爆破即可，因为题目生成的素数只含<code>7,2</code>，所以每次爆破只需要2个数字，爆破起来蛮快的</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">2160489795493918825870689458820648828073650907916827108594219132976202835249425984494778310568338106260399032800745421512005980632641226298431130513637640125399673697368934008374907832728004469350033174207285393191694692228748281256956917290437627249889472471749973975591415828107248775449619403563269856991145789325659736854030396401772371148983463743700921913930643887223704115714270634525795771407138067936125866995910432010323584269926871467482064993332990516534083898654487467161183876470821163254662352951613205371404232685831299594035879</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ciphertext = <span class="number">2087465275374927411696643073934443161977332564784688452208874207586196343901447373283939960111955963073429256266959192725814591103495590654238320816453299972810032321690243148092328690893438620034168359613530005646388116690482999620292746246472545500537029353066218068261278475470490922381998208396008297649151265515949490058859271855915806534872788601506545082508028917211992107642670108678400276555889198472686479168292281830557272701569298806067439923555717602352224216701010790924698838402522493324695403237985441044135894549709670322380450</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findp</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    <span class="keyword">if</span> l == <span class="number">272</span> <span class="keyword">and</span> n % <span class="built_in">int</span>(p) == <span class="number">0</span>:</span><br><span class="line">        q = n // <span class="built_in">int</span>(p)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        table = [<span class="string">&quot;2&quot;</span>,<span class="string">&quot;7&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> i,j <span class="keyword">in</span> itertools.product(table,repeat=<span class="number">2</span>):</span><br><span class="line">            pp = <span class="built_in">int</span>(i + p)</span><br><span class="line">            qq = <span class="built_in">int</span>(j + q)</span><br><span class="line">            <span class="keyword">if</span> pp * qq % <span class="number">10</span>**l == n % <span class="number">10</span>**l:</span><br><span class="line">                findp(i+p,j+q)</span><br><span class="line">                </span><br><span class="line"><span class="comment"># findp(&quot;7&quot;,&quot;7&quot;)</span></span><br><span class="line">p = <span class="number">27777727727777722777277277777272772727772722777777277777277772227772772772227272727777772772772727227772777277727777777222777777277727772272272777772722727722777727277727727777777772772777772777277772222727227777777222727777772772272727777222777777277777727272772272272277</span></span><br><span class="line">q = <span class="number">77777772777772222722727222227777272777772777772277727772722777777777227277727272772727277277272772727227272772772222277777772727727772722772777272727777272722772777277777277777277777727777277277777277777272772772777777727772727277727777772772777772272772272222227777777227</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ciphertext,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># osu&#123;h4v3_y0u_3v3r_n0t1c3d_th4t_727_1s_pr1m3?&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="第二道题"><a href="#第二道题" class="headerlink" title="第二道题"></a>第二道题</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="comment"># https://pypi.org/project/pycryptodome/</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> floor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">s, a, b, p</span>):</span><br><span class="line">    <span class="keyword">return</span> (a * s + b) % p</span><br><span class="line"></span><br><span class="line">p = getPrime(floor(<span class="number">72.7</span>))</span><br><span class="line">a = randrange(<span class="number">0</span>, p)</span><br><span class="line">b = randrange(<span class="number">0</span>, p)</span><br><span class="line">seed = randrange(<span class="number">0</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;a = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_roll</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = lcg(seed, a, b, p)</span><br><span class="line">    <span class="keyword">return</span> seed % <span class="number">100</span></span><br><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(floor(<span class="number">72.7</span>)):</span><br><span class="line">    out.append(get_roll())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;out = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">key = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">iv = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="built_in">print</span>(cipher.encrypt(pad(flag, <span class="number">16</span>)).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 4420073644184861649599</span></span><br><span class="line"><span class="string">a = 1144993629389611207194</span></span><br><span class="line"><span class="string">b = 3504184699413397958941</span></span><br><span class="line"><span class="string">out = [39, 47, 95, 1, 77, 89, 77, 70, 99, 23, 44, 38, 87, 34, 99, 42, 10, 67, 24, 3, 2, 80, 26, 87, 91, 86, 1, 71, 59, 97, 69, 31, 17, 91, 73, 78, 43, 18, 15, 46, 22, 68, 98, 60, 98, 17, 53, 13, 6, 13, 19, 50, 73, 44, 7, 44, 3, 5, 80, 26, 10, 55, 27, 47, 72, 80, 53, 2, 40, 64, 55, 6]</span></span><br><span class="line"><span class="string">enc = &#x27;34daaa9f7773d7ea4d5f96ef3dab1bbf5584ecec9f0542bbee0c92130721d925f40b175e50587196874e14332460257b&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>由$X_{n+1} \equiv aX_n + b \mod p$</p>
<p>拆成高低位来写，则有<br>$$<br>H_{n+1}\times 100 + L_{n+1} \equiv a(H_n\times 100 + L_n) +b \mod p<br>$$<br>化简得<br>$$<br>H_{n+1} \equiv aH_n + (aL_n + b -L_{n+1})\times 100^{-1} \mod p<br>$$<br>于是有<br>$$<br>H_2 \equiv aH_1 + (aL_1 + b - L_2)\times 100^{-1} \mod p<br>$$</p>
<p>$$<br>H_3 \equiv aH_2 + (aL_2+b-L_3) \times 100^{-1} \mod p<br>$$</p>
<p>即<br>$$<br>H_3 \equiv a^2H_1 + (a(aL_1+b-L_2) + (aL_2+b-L_3)) \times 100^{-1} \mod p<br>$$<br>写到这里是为了后面更好理解$B_i$如何计算</p>
<p>回到题目，简单来写就是<br>$$<br>H_{n+1} \equiv A_nH_1 + B_n \mod p<br>$$<br>即$H_{n+1} &#x3D; A_mH_1 + B_n +k_np$</p>
<p>构造格</p>
<p><img src="/../../images/%E6%9D%82/18.png"></p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">4420073644184861649599</span></span><br><span class="line">a = <span class="number">1144993629389611207194</span></span><br><span class="line">b = <span class="number">3504184699413397958941</span></span><br><span class="line">out = [<span class="number">39</span>, <span class="number">47</span>, <span class="number">95</span>, <span class="number">1</span>, <span class="number">77</span>, <span class="number">89</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">99</span>, <span class="number">23</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">87</span>, <span class="number">34</span>, <span class="number">99</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">67</span>, <span class="number">24</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">80</span>, <span class="number">26</span>, <span class="number">87</span>, <span class="number">91</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">71</span>, <span class="number">59</span>, <span class="number">97</span>, <span class="number">69</span>, <span class="number">31</span>, <span class="number">17</span>, <span class="number">91</span>, <span class="number">73</span>, <span class="number">78</span>, <span class="number">43</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">68</span>, <span class="number">98</span>, <span class="number">60</span>, <span class="number">98</span>, <span class="number">17</span>, <span class="number">53</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">73</span>, <span class="number">44</span>, <span class="number">7</span>, <span class="number">44</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">80</span>, <span class="number">26</span>, <span class="number">10</span>, <span class="number">55</span>, <span class="number">27</span>, <span class="number">47</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">53</span>, <span class="number">2</span>, <span class="number">40</span>, <span class="number">64</span>, <span class="number">55</span>, <span class="number">6</span>]</span><br><span class="line">enc = <span class="string">&#x27;34daaa9f7773d7ea4d5f96ef3dab1bbf5584ecec9f0542bbee0c92130721d925f40b175e50587196874e14332460257b&#x27;</span></span><br><span class="line"></span><br><span class="line">L = [<span class="number">0</span>] + out</span><br><span class="line">n = <span class="built_in">len</span>(out)</span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">    A.append(a*A[i-<span class="number">1</span>] % p)</span><br><span class="line">    B.append((a*B[i-<span class="number">1</span>] + (a*L[i]+b-L[i+<span class="number">1</span>])*gmpy2.invert(<span class="number">100</span>,p))%p)</span><br><span class="line"></span><br><span class="line">A = A[<span class="number">1</span>:]</span><br><span class="line">B = B[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,n+<span class="number">1</span>,n+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(A)):</span><br><span class="line">    Ge[i,i] = p</span><br><span class="line">    Ge[-<span class="number">2</span>,i] = A[i]</span><br><span class="line">    Ge[-<span class="number">1</span>,i] = B[i]</span><br><span class="line"></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = p // <span class="number">100</span></span><br><span class="line"></span><br><span class="line">M = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">H1 = M[-<span class="number">2</span>]</span><br><span class="line">L1 = out[<span class="number">0</span>]</span><br><span class="line">seed1 = H1 * <span class="number">100</span> + L1</span><br><span class="line"></span><br><span class="line">seed = ((seed1 - b)*gmpy2.invert(a,p))%p</span><br><span class="line"><span class="comment"># print(seed)</span></span><br><span class="line"><span class="comment"># 1972400400839421538435</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">s, a, b, p</span>):</span><br><span class="line">    <span class="keyword">return</span> (a * s + b) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_roll</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = lcg(seed, a, b, p)</span><br><span class="line">    <span class="keyword">return</span> seed % <span class="number">100</span></span><br><span class="line"></span><br><span class="line">temp = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(floor(<span class="number">72.7</span>)):</span><br><span class="line">    temp.append(get_roll())</span><br><span class="line"><span class="comment"># print(temp == out)</span></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line">key = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">iv = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = cipher.decrypt(<span class="built_in">bytes</span>.fromhex(enc))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># osu&#123;w0uld_y0u_l1k3_f1r5t_0r_53c0nd_p1ck&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="pearlCTF"><a href="#pearlCTF" class="headerlink" title="pearlCTF"></a>pearlCTF</h1><h2 id="3-pies"><a href="#3-pies" class="headerlink" title="3 pies"></a>3 pies</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n1 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">n3 = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">e=<span class="number">3</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n2)</span><br><span class="line">c3 = <span class="built_in">pow</span>(m,e,n3)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encrypted-messages.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;n1: <span class="subst">&#123;n1&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c1: <span class="subst">&#123;c1&#125;</span>\n\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n2: <span class="subst">&#123;n2&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c2: <span class="subst">&#123;c2&#125;</span>\n\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n3: <span class="subst">&#123;n3&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;e: <span class="subst">&#123;e&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c3: <span class="subst">&#123;c3&#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n1 = <span class="number">125267411676839013904356880992044234494446196964982422223130579882047339346910691451497681975351838034684254305738613386927222900898672184001345811471784343779083336010063097729870079645284178978512325038316112509718505547104307526489798594871208559607331790920412305711830820739308995357441030646151241475357</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c1 =  <span class="number">53377681151597930200174280269480737905892580547675095951568028531545776989476273786562435486230550919422086944133253611872983670236114054374565938184593173194919064517779661178744278071496565181181705071524501841159717567250259220092464925447795412484629687708208662079791459184303259833667333882817260906165</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">101985110329687359982214188967281711679876126442294375297547334583432698756724057183438691227371260175904715854057793173086301783390154807726779286131084537704721881438398569476214173211311977143694032174701007005033830070482491565424683664984059187439768982994371382763048098663670188786016786612348042190633</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c2 = <span class="number">86370003324603283962938004647941072863866893771153362222202759619566185050496089684606274416415418388916028237984708280964054009059814813483639010674182298294505525549842057730933691736372086557397211586739691237738757897947336698446258197604918828646265244195686107866422922575275382813594250335044143485624</span></span><br><span class="line"></span><br><span class="line">n3 = <span class="number">83259448903366278561128205003734328779222118906091604625605804813528274055482582431201682767294594942491788720967344243567819654813240542076250030802111361571504667752481579915864184180358691091092122509649590043074189547962292835856503625214027405901620103615424259796442446412031011575671410630232956892267</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c3 = <span class="number">25601241268900087228853235319569275926328919786631787991019848828558430219449358810095537362492238844266084660904521793373698736119824512458196492049138821633273765102576368573691391116632126183996786969554104441242376959688329346567745607825277943462236901478944551669406261301309719409165457168678763092118</span></span><br><span class="line"></span><br><span class="line">C = crt([n1,n2,n3],[c1,c2,c3])[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(C,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># This is your destination: &quot;https://pastes.io/1yjswxlvl2</span></span><br></pre></td></tr></table></figure>

<p>进入这个网站得到一串信息:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">You think this is Gibbrish, but it&#x27;s something different...</span><br><span class="line">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oAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigArzP9oXX/wCxPhrfQRvtuNSYWS467W5f/wAdBH416ZXyt+1F4i/tHxla6LA+YNLh/eY6GaTDH8l2D86cVdgzxevr/wDZE8NDTvBd9rkyYuNUn2ox6+VHkD82LH8q+R7CzuNRv7ays0Ml1cyrDEg/idiAB+Zr9G/CGiQ+G/DOmaPbY8qyt0hB/vEDk/icn8aufYKa6mxRRRUGwUUUUARXEEc6bZFyPXuKxbuykg5Hzp6jt9a36QjIoE1c5alrautOjlOY/kb26Gsy4s5oOWTK+q80iGiCiiigkKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKSlpKACiiigAooooAWiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigCC+uorGyuLu5YJBbxNNIx7KoLE/kDXwN4i1WXXNe1DVJyfMvJ3mOe2TkD8BgV9VftJeIDpHw6lsYX23GqyrbcdfLHzP8AmAB/wKvkStILqTI9d/Zg8O/258T7e7kTdb6VEbtiRwG+6n6kn/gNfbo6V4f+yb4ZXSPh9Lq00eLrV5zLuI58lPlQfnvP417hUyd2bQVkFFFFIoKKKKACiiigAxRiiigCtPZQTZLJhvVeKzptMkXmNg49Dwa2qKBNJnLyI0bbXUqfQ0ldNJGrrh1DD3FUZ9MjfmIlD+YpEuJj0VZmsZ4v4dw9V5qt0POaCAooooAKKKKACiiigAooooAKKKKACiiigAooooAKQ0tIaACiiigAooooAWiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiqesahFpWk3uoXLBYLSF53J9FBP8ASgD5Y/aZ8RDVvHq6XA2bfSIhC3oZmwzn8AVX8DXlujadcaxq9lptiu66vJkgiH+0zAD+dJq1/Nquq3moXJzNdTPM592JJ/nXr37Kfh3+1viM2pypug0mAzAnoJHyq/puP4VrsiUryPsDw7pUGh6HYaXaDFvaQJCnHUKMZrRoHSiszoCiiigAooooAKKKKACiiigAooooAKMUUUAGKhntoph+8QE+vepqKAMqfS+8L/g3+NZ00TwvskGDXSOQqknoK5u4lM07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F1GzucTMRmGA8gYByxHrjJ71d8beH7rXbnw1JaSQIumatFfzeaxG6NUkUhcA5bLjrgdeaB3LPiS41HSoWuvD3h5NWvZ2AmVbiO2YgD5SzN19Paub+DDwNo2tEmSLV5dVnudTtJI/LNtcPgmMDJyoULhsndyfYWdR07xppevajd+HLrTtT06+ZZfsmqTSo1q4UKRGyhhsOM7SBg9O9R+GdOufBmn65rviaRr7VdUuluLlNLtpJVTgIkcaAFmAHcj69M0CKvwTvfL8OPoX2a5Y6ZcXEf24Jm1uMzuf3Un8WM4PHBBr0euP+EWnXmlfDvSLXUreS2ugJZXhkGGTfK7gMOxwwyK7CgGFFFFAhKKKKACiiigAooooApaTpdlpMEsOnW6wRSyvO6qTy7nLNz6nmrtFFABRRRQAUUUUAFZ+uaNp2vadJYazZw3lo5BMUq5GR0I9D7jmtCigDl9G8A+GNG1CO+sNJjW8iBEc0sjzNHn+6XY7fwxXUUUUAFFFFABRRRQAVh+IPCmieIrm1n1uwS8e1OYhIzbByDyoO1uQOoPStyigAooooAUUUUZoAKKM0ZoAKKM0ZoAKKM0ZoAKKM0ZoAKKM0UAFFGaM0AFFGaM0AFFGaM0AFFGaM0AFFGaM0AFFGaM0AFFGaM0AFMniSeCSGVd0cilGGcZBGDT80ZoAwvDXhLQ/DLTvomnx20k+BLJuZ3cDoCzEnA9M4rdozRmgAoozRmgAoozRmgAoozRmgAoozRmgAoozRmgBKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/Z</span><br></pre></td></tr></table></figure>

<p>放入CyberChef</p>
<p><img src="/../../images/%E6%9D%82/17.png"></p>
<h2 id="Baby’s-Message-Out"><a href="#Baby’s-Message-Out" class="headerlink" title="Baby’s Message Out"></a>Baby’s Message Out</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">5</span>)</span><br><span class="line">sys.setrecursionlimit(n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextPrime</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> nextPrime(p + <span class="number">61</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = nextPrime(nextPrime(<span class="number">17</span>*p + <span class="number">1</span>) + <span class="number">3</span>)</span><br><span class="line">r = nextPrime(<span class="number">29</span>*p*q)</span><br><span class="line">s = nextPrime(q*r + p)</span><br><span class="line">t = nextPrime(r*s*q)</span><br><span class="line"></span><br><span class="line">n = p*q*r*s*t</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(FLAG.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c: <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n: <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>将$q,r,s,t$暂且设为</p>
<p>$q &#x3D; 17p+1,r &#x3D; 29p\times q,s &#x3D; q\times r + p,t &#x3D; r\times s\times q$</p>
<p>可以得到<br>$$<br>n &#x3D; 4933820698627921p^{13} + 2321797975824904p^{12} + 479194612657574p^{11} + 56652867922228p^{10} + 4196277199301p^9 + 199402260580p^8 + 5936228776p^7 + 101222760p^6 + 756900p^5<br>$$<br>把n的系数化为1，然后开13次方，可以得到一个在实际的p附近波动的值，然后再进行爆破即可恢复p</p>
<p>爆破范围的选定可以自己生成数据进行测试。</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="built_in">pow</span>(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextPrime</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> nextPrime(p + <span class="number">61</span>)</span><br><span class="line">    </span><br><span class="line">c = <span class="number">1838979268925267202615818395622122484893202706167722156383681963142079180161531237936585341507802530813847301831886857107840552940103096671213346624172927405178565892385733216702672851783423891229382579221604596673156151519463795808010572632138076246765227545034269340790242411584582692558549837221897037971538915332866933837117883228953143242965510280921618063635225603250391037969273250144174802927111408106890496901519737395485115788436384012937788617630381389196078818501905993385084557887716148781944416313908553565974546239241287340505018036547080504009483360838747251073440799502791555942879229132369697126614944991347408598924472158561247485575276852356316968119522601927483600978106155875300324966339458896992260918634629607740522754923275555209240690069838566642421234035117257380757518902549668151860260985363114235340791362277047923494577018035035653075155240898800910887230020812289524262582877697129108304758256250595391379019020972909027192107727799235384374670082518555887502478560056865020860127002</span></span><br><span class="line">n = <span class="number">485889862688353809145356849681869098056742135790325154633816315764783289109350404808839464043297429168130293002483316664607770068196944445394490388957147529192164743228508084885030734914365245916125607677185307000076761646830755541107131137865984020648243428286711853728051263128076845261298240617545417811431124904304446607845470628505361436115651109768237103000946120781642652665829238385087624612205525857191218811570122228639908283598707567056620352822139985271817003262919597858495812801663331842855143930997258260164422858382713240717739568744168349527025412634588705503126870149875268600539407786323924132037483972529603572727892740460450963315253482630345996561505957763886776070413535287129043703855880444326909520084249767518737040222995586717034060176093473694948961503759770499124924886087468497100053775745634680192678426965540847613838559522315570932873854027804486662281273550134766570419630624914801192395060568099367828616501877701994364906741451132770474154689411119296104818089636891131318495955929</span></span><br><span class="line"></span><br><span class="line">T = n // <span class="number">4933820698627921</span></span><br><span class="line">temp = gmpy2.iroot(T,<span class="number">13</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">10000</span>):</span><br><span class="line">    p = temp - i</span><br><span class="line">    <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> n % p == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        q = nextPrime(nextPrime(<span class="number">17</span>*p + <span class="number">1</span>) + <span class="number">3</span>)</span><br><span class="line">        r = nextPrime(<span class="number">29</span>*p*q)</span><br><span class="line">        s = nextPrime(q*r + p)</span><br><span class="line">        t = nextPrime(r*s*q)</span><br><span class="line">        phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)*(s-<span class="number">1</span>)*(t-<span class="number">1</span>)</span><br><span class="line">        e = <span class="number">65537</span></span><br><span class="line">        d = gmpy2.invert(e,phi)</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        flag = long_to_bytes(m)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;pearl&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># pearl&#123;7h1s_0n3_w4s_f0r_7h3_k1ds&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Bit-War"><a href="#Bit-War" class="headerlink" title="Bit War"></a>Bit War</h2><blockquote>
<p>task.c</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">100</span>];</span><br><span class="line">    <span class="type">int</span> length = <span class="number">8</span>;</span><br><span class="line">    <span class="type">int</span> rounds = <span class="number">1000</span>;</span><br><span class="line">    <span class="type">char</span> * end;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> buffer = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> bufferMask = <span class="number">0xff</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> leftMask = <span class="number">0x80</span>;   <span class="comment">//10000000</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> rightMask = <span class="number">0x1</span>;   <span class="comment">//00000001</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, str))&#123;</span><br><span class="line">        buffer = strtol(str, &amp;end, <span class="number">2</span>);</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> input = buffer;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; rounds; i++)&#123;</span><br><span class="line">            <span class="type">unsigned</span> <span class="type">int</span> new = ((buffer &amp; leftMask) &gt;&gt; <span class="number">7</span>) ^ (buffer &amp; rightMask);</span><br><span class="line">            buffer = ((buffer &lt;&lt; <span class="number">1</span>) &amp; bufferMask) ^ new;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> inputBits[length];</span><br><span class="line">        <span class="type">int</span> bufferBits[length];</span><br><span class="line">        <span class="type">int</span> i = length;</span><br><span class="line">        <span class="keyword">while</span>(i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(input &amp; <span class="number">0x1</span>) inputBits[i<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> inputBits[i<span class="number">-1</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(buffer &amp; <span class="number">0x1</span>) bufferBits[i<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> bufferBits[i<span class="number">-1</span>] = <span class="number">0</span>;</span><br><span class="line">            input = input &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            buffer = buffer &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            i--; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; i++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, bufferBits[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>output</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">output:01001000 11010111 11010001 11001011 01011010 01000110 11011101 01001110 01001010 01110000 11010001 01110000 01011010 11010101 01001010 11001011 11000011</span><br></pre></td></tr></table></figure>

<p>代码实现的是一个LFSR的作用，至于具体过程，我不太说的明白，值得注意的是，我们输入的数据得是2进制。</p>
<p>不过题目给出output,根据output的长度可以判断flag的长度并不长，于是想到了爆破的方法</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">m</span>):</span><br><span class="line">    length = <span class="number">8</span></span><br><span class="line">    rounds = <span class="number">1000</span></span><br><span class="line">    bufferMask = <span class="number">0xff</span></span><br><span class="line">    leftMask = <span class="number">0x80</span></span><br><span class="line">    rightMask = <span class="number">0x1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        buffer = <span class="built_in">int</span>(m, <span class="number">2</span>)</span><br><span class="line">        input_val = buffer</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">            new = ((buffer &amp; leftMask) &gt;&gt; <span class="number">7</span>) ^ (buffer &amp; rightMask)</span><br><span class="line">            buffer = ((buffer &lt;&lt; <span class="number">1</span>) &amp; bufferMask) ^ new</span><br><span class="line"></span><br><span class="line">        inputBits = []</span><br><span class="line">        bufferBits = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">            inputBits.append(input_val &amp; <span class="number">0x1</span>)</span><br><span class="line">            bufferBits.append(buffer &amp; <span class="number">0x1</span>)</span><br><span class="line">            input_val &gt;&gt;= <span class="number">1</span></span><br><span class="line">            buffer &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        bufferBits.reverse()</span><br><span class="line">        c = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> Bit <span class="keyword">in</span> bufferBits:</span><br><span class="line">            c += <span class="built_in">str</span>(Bit)</span><br><span class="line">        <span class="keyword">return</span> c </span><br><span class="line">        </span><br><span class="line">output = <span class="string">&quot;01001000 11010111 11010001 11001011 01011010 01000110 11011101 01001110 01001010 01110000 11010001 01110000 01011010 11010101 01001010 11001011 11000011&quot;</span></span><br><span class="line">c = output.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        cc = lfsr(<span class="built_in">bin</span>(j)[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> cc == c[i]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># pearl&#123;its_a_lfsr&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="syntelestis"><a href="#syntelestis" class="headerlink" title="syntelestis"></a>syntelestis</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, inverse</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">k = <span class="built_in">list</span>()</span><br><span class="line">flag = flag.<span class="built_in">hex</span>().encode()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag) - <span class="number">20</span>):</span><br><span class="line">    g = []</span><br><span class="line">    h = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">2</span>):</span><br><span class="line">        a, b = flag[j], flag[j + <span class="number">1</span>]</span><br><span class="line">        m, n = randint(<span class="number">0</span>, p - <span class="number">1</span>), randint(<span class="number">0</span>, p - <span class="number">1</span>)</span><br><span class="line">        c, d = m * a, n * b</span><br><span class="line">        e, f = <span class="built_in">pow</span>(inverse(c, p) + inverse(d, p), <span class="number">2</span>, p), (m ** <span class="number">2</span> * inverse(c, p) * n ** <span class="number">2</span> * inverse(d, p)) % p</span><br><span class="line">        g += [m, n]</span><br><span class="line">        h.append(e * inverse(f, p) % p)</span><br><span class="line">    g.append(<span class="built_in">sum</span>(h) % p)</span><br><span class="line">    k.append(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;k = <span class="subst">&#123;k&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>首先进行推导<br>$$<br>e \equiv (c^{-1}+d^{-1})^2 \mod p<br>$$</p>
<p>$$<br>f \equiv m^2c^{-1}n^2d^{-1} \mod p<br>$$</p>
<p>$$<br>f^{-1} \equiv m^{-2}cn^{-2}d \mod p<br>$$</p>
<p>$$<br>h \equiv ef^{-1} \equiv (c^{-2}+d^{-2}+2c^{-1}d^{-1})(m^{-2}cn^{-2}d) \equiv m^{-2}c^{-1}n^{-2}d + m^{-2}cn^{-2}d^{-1} +2m^{-2}n^{-2}<br>$$</p>
<p>把c,d用a,b表示，即可得到h关于a,b的式子<br>$$<br>h \equiv m^{-3}a^{-1}n^{-1}b + m^{-1}an^{-3}b^{-1} + 2m^{-2}n^{-2} \mod p<br>$$<br>再写成g和a,b的式子</p>
<p><img src="/../../images/%E6%9D%82/19.png"></p>
<p>题目一共给出54组这样的数据，于是想到用格来做，不过这里存在$a^{-1},b^{-1}$，比较麻烦。</p>
<p>在鸡块师傅的指导下，我们引入$t &#x3D; ord(‘0’)\times ord(‘1’)\times … \times ord(‘f’)$，然后两边同时乘上t可以得到</p>
<p><img src="/../../images/%E6%9D%82/20.png"></p>
<p>即</p>
<p><img src="/../../images/%E6%9D%82/21.png"></p>
<p>首先尝试用一组数据构造格：</p>
<p><img src="/../../images/%E6%9D%82/22.png"></p>
<p>结果不出所料，没有规约成功</p>
<p>进行优化，把$\sum_{i&#x3D;1}^{37}2m_i^{-2}n_i^{-2}t$记为一个变量R，此时格为</p>
<p><img src="/../../images/%E6%9D%82/23.png"></p>
<p>不过还是没有规约成功，把所有数据利用上，此时格为</p>
<p><img src="/../../images/%E6%9D%82/24.png"></p>
<p>利用这个格便可规约成功。有个值得注意的点是，最后两行的$R_i$和$g_i$可以合并为1个变量，这样可以把格的规模从$130\times 130$变为$129\times 129$</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">p = <span class="number">112484851204745228541474305508055656664633080619278978956579531639763617075417</span></span><br><span class="line">k = [[...]]</span><br><span class="line"></span><br><span class="line">t = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    t *= <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)+i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    t *= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+i</span><br><span class="line"></span><br><span class="line">n = <span class="number">54</span> + <span class="number">76</span></span><br><span class="line">Ge = Matrix(ZZ,n,n)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">54</span>):</span><br><span class="line">    g = k[i][-<span class="number">1</span>]</span><br><span class="line">    R = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">74</span>,<span class="number">2</span>):</span><br><span class="line">        m,n = k[i][j],k[i][j+<span class="number">1</span>]</span><br><span class="line">        minv = invert(m,p)</span><br><span class="line">        ninv = invert(n,p)</span><br><span class="line">        R += <span class="number">2</span>*minv^<span class="number">2</span>*ninv^<span class="number">2</span>*t</span><br><span class="line">        Ge[<span class="number">54</span>+j,i] = minv^<span class="number">3</span>*ninv</span><br><span class="line">        Ge[<span class="number">54</span>+j+<span class="number">1</span>,i] = minv*ninv^<span class="number">3</span></span><br><span class="line">    Ge[-<span class="number">2</span>,i] = R</span><br><span class="line">    Ge[-<span class="number">1</span>,i] = g</span><br><span class="line">    Ge[i,i] = p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">74</span>):</span><br><span class="line">    Ge[<span class="number">54</span>+i,<span class="number">54</span>+i] = <span class="number">1</span></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> lines <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    line = <span class="built_in">list</span>(lines)</span><br><span class="line">    <span class="keyword">if</span> line[:<span class="number">54</span>] == [<span class="number">0</span>]*<span class="number">54</span>:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br></pre></td></tr></table></figure>

<p>得到一系列$\frac{tb_i}{a_i},\frac{ta_i}{b_i}$以后，采取枚举的方式即可求得flag的16进制形式，再进行转化即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">p = <span class="number">112484851204745228541474305508055656664633080619278978956579531639763617075417</span></span><br><span class="line"></span><br><span class="line">t = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    t *= <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)+i</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    t *= <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+i</span><br><span class="line"></span><br><span class="line">table = [<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;4&#x27;</span>,<span class="string">&#x27;5&#x27;</span>,<span class="string">&#x27;6&#x27;</span>,<span class="string">&#x27;7&#x27;</span>,<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;9&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>]</span><br><span class="line"></span><br><span class="line">x = [<span class="number">132589502497094545512529920000</span>, <span class="number">174081269554562066048352000000</span>, <span class="number">149112036951786496978790400000</span>, <span class="number">154791989943541981199769600000</span>, <span class="number">137858298313915817961523200000</span>, <span class="number">167428070755259693950771200000</span>, <span class="number">138114065101140151575552000000</span>, <span class="number">167118018772379583406417920000</span>, <span class="number">278530031287299305677363200000</span>, <span class="number">82868439060684090945331200000</span>, <span class="number">270703567598234697088081920000</span>, <span class="number">85264295292030399697152000000</span>, <span class="number">137858298313915817961523200000</span>, <span class="number">167428070755259693950771200000</span>, <span class="number">292384869893357075599564800000</span>, <span class="number">78941666621534027812300800000</span>, <span class="number">157883333243068055624601600000</span>, <span class="number">146192434946678537799782400000</span>, <span class="number">157450034215299772796129280000</span>, <span class="number">146594753309104897724928000000</span>, <span class="number">281343465946766975431680000000</span>, <span class="number">82039754670077250035877888000</span>, <span class="number">137592879949815094399795200000</span>, <span class="number">167751041570759809101139200000</span>, <span class="number">157552340930189506241740800000</span>, <span class="number">146499561910852232206924800000</span>, <span class="number">142988679163533333395865600000</span>, <span class="number">161420813586957552153926400000</span>, <span class="number">284156900606234645185996800000</span>, <span class="number">81227479871363613896908800000</span>, <span class="number">163391544940405424599756800000</span>, <span class="number">141264035006955628716748800000</span>, <span class="number">292384869893357075599564800000</span>, <span class="number">78941666621534027812300800000</span>, <span class="number">286970335265702314940313600000</span>, <span class="number">80431132029487500035174400000</span>, <span class="number">157768758980917788530534400000</span>, <span class="number">146298602292318827224473600000</span>, <span class="number">292384869893357075599564800000</span>, <span class="number">78941666621534027812300800000</span>, <span class="number">140671732973383487715840000000</span>, <span class="number">164079509340154500071755776000</span>, <span class="number">143325916614390723333120000000</span>, <span class="number">161040999907929416737093632000</span>, <span class="number">146400909007208560670085120000</span>, <span class="number">157658508275829795666432000000</span>, <span class="number">163841194874881944516096000000</span>, <span class="number">140876346403162954607063040000</span>, <span class="number">151925471611254166733107200000</span>, <span class="number">151925471611254166733107200000</span>, <span class="number">292384869893357075599564800000</span>, <span class="number">78941666621534027812300800000</span>, <span class="number">143485167632851157470156800000</span>, <span class="number">160862264058975000070348800000</span>, <span class="number">142988679163533333395865600000</span>, <span class="number">161420813586957552153926400000</span>, <span class="number">281343465946766975431680000000</span>, <span class="number">82039754670077250035877888000</span>, <span class="number">132589502497094545512529920000</span>, <span class="number">174081269554562066048352000000</span>, <span class="number">278530031287299305677363200000</span>, <span class="number">82868439060684090945331200000</span>, <span class="number">151925471611254166733107200000</span>, <span class="number">151925471611254166733107200000</span>, <span class="number">154687752913276969764618240000</span>, <span class="number">149212516761053199470016000000</span>, <span class="number">145967609979440277841612800000</span>, <span class="number">158126511268856377620172800000</span>, <span class="number">143638627705185757638574080000</span>, <span class="number">160690402665749599429248000000</span>, <span class="number">163391544940405424599756800000</span>, <span class="number">141264035006955628716748800000</span>, <span class="number">276228130202280303151104000000</span>, <span class="number">83559009386189791703208960000</span>]</span><br><span class="line">m = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x),<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> j,k <span class="keyword">in</span> itertools.product(table,repeat=<span class="number">2</span>):</span><br><span class="line">        a = <span class="built_in">ord</span>(j)</span><br><span class="line">        b = <span class="built_in">ord</span>(k)</span><br><span class="line">        <span class="keyword">if</span> (t*b*invert(a,p) % p == x[i] % p) <span class="keyword">and</span> (t*a*invert(b,p) % p == x[i+<span class="number">1</span>]%p):</span><br><span class="line">            m += <span class="built_in">chr</span>(a)</span><br><span class="line">            m += <span class="built_in">chr</span>(b)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 706561726c7b615f35796d5068306e595f6f465f62527537005f63306d706c00783174597d</span></span><br><span class="line">flag = <span class="built_in">bytes</span>.fromhex(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>得到的结果是<code>pearl&#123;a_5ymPh0nY_oF_bRu7\x00_c0mpl\x00x1tY&#125;</code></p>
<p>进行猜测：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pearl&#123;a_5ymph0nY_oF_bRu7e_c0mplex1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu7e_c0mplEx1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu7e_c0mpl3x1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu7E_c0mplEx1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu7E_c0mplex1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu7E_c0mpl3x1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu73_c0mpl3x1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu73_c0mplex1tY&#125;</span><br><span class="line">pearl&#123;a_5ymph0nY_oF_bRu73_c0mplEx1tY&#125;</span><br></pre></td></tr></table></figure>

<p>正确的结果是<code>pearl&#123;a_5ymPh0nY_oF_bRu73_c0mpl3x1tY&#125;</code></p>
<p>在鸡块师傅的指正下，得到<code>pearl&#123;a_5ymPh0nY_oF_bRu7\x00_c0mpl\x00x1tY&#125;</code>这个结果后正确的思路如下：</p>
<p>出现<code>\x00</code>，说明改组$\frac{ta_i}{b_i} &#x3D; \frac{tb_i}{a_i}$，满足这个情况的a,b有$a &#x3D; ord(‘0’),b&#x3D;ord(‘0’)$…$a&#x3D;ord(‘f’),b&#x3D;ord(‘f’)$</p>
<p>也就是说，<code>\x00</code>的位置只可能是<code>\x00,\x11,&quot;,3,D,U,f,w,\x88,\x99,\xaa,\xbb,\xcc,\xdd,\xee,\xff</code></p>
<p>这样的话，很明显结果就是<code>pearl&#123;a_5ymPh0nY_oF_bRu73_c0mpl3x1tY&#125;</code></p>
<h2 id="Security"><a href="#Security" class="headerlink" title="Security++"></a>Security++</h2><blockquote>
<p>secure.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag, key</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> encrypt_block, pad</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data: <span class="built_in">bytes</span></span>):</span><br><span class="line">    pt = data + flag</span><br><span class="line">    pt = pad(pt)</span><br><span class="line">    block_count = <span class="built_in">len</span>(pt) // <span class="number">16</span></span><br><span class="line">    encText = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(block_count):</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            encText += encrypt_block(pt[i * <span class="number">16</span>:i * <span class="number">16</span> + <span class="number">16</span>], key[<span class="number">0</span>:<span class="number">16</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            encText += encrypt_block(pt[i * <span class="number">16</span>:i * <span class="number">16</span> + <span class="number">16</span>], key[<span class="number">16</span>:])</span><br><span class="line">    <span class="keyword">return</span> encText</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        msg = <span class="built_in">input</span>(<span class="string">&quot;\nEnter plaintext: &quot;</span>).strip()</span><br><span class="line">        res = encrypt(msg.encode())</span><br><span class="line">        <span class="built_in">print</span>(b64encode(res).decode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<blockquote>
<p>enc.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line">s_box = (</span><br><span class="line">    <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">    <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">    <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">    <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">    <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">    <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">    <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">    <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">    <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">    <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">    <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">    <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">    <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes2matrix</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">list</span>(text[i:i + <span class="number">4</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(text), <span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix2bytes</span>(<span class="params">m</span>):</span><br><span class="line">    plaintext = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            plaintext += <span class="built_in">chr</span>(m[row][j]).encode(<span class="string">&#x27;latin-1&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text: <span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(text) % <span class="number">16</span> != <span class="number">0</span>:</span><br><span class="line">        pad_len = ((<span class="built_in">len</span>(text) // <span class="number">16</span>) + <span class="number">1</span>) * <span class="number">16</span> - <span class="built_in">len</span>(text)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pad_len = <span class="number">0</span></span><br><span class="line">    text = text.ljust(<span class="built_in">len</span>(text) + pad_len, <span class="string">b&#x27;.&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">state, sbox</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(state)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            state[i][j] = sbox[state[i][j]]</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">s</span>):</span><br><span class="line">    s[<span class="number">1</span>][<span class="number">0</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">    s[<span class="number">2</span>][<span class="number">0</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">3</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">0</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    s[<span class="number">3</span>][<span class="number">0</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">0</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">2</span>]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gmul</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    tmp = (a &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> tmp <span class="keyword">if</span> a &lt; <span class="number">128</span> <span class="keyword">else</span> tmp ^ <span class="number">0x1b</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> gmul(a, <span class="number">2</span>) ^ a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_col</span>(<span class="params">col</span>):</span><br><span class="line">    temp = copy(col)</span><br><span class="line">    col[<span class="number">0</span>] = gmul(temp[<span class="number">0</span>], <span class="number">2</span>) ^ gmul(temp[<span class="number">1</span>], <span class="number">3</span>) ^ gmul(temp[<span class="number">2</span>], <span class="number">1</span>) ^ gmul(temp[<span class="number">3</span>], <span class="number">1</span>)</span><br><span class="line">    col[<span class="number">1</span>] = gmul(temp[<span class="number">0</span>], <span class="number">1</span>) ^ gmul(temp[<span class="number">1</span>], <span class="number">2</span>) ^ gmul(temp[<span class="number">2</span>], <span class="number">3</span>) ^ gmul(temp[<span class="number">3</span>], <span class="number">1</span>)</span><br><span class="line">    col[<span class="number">2</span>] = gmul(temp[<span class="number">0</span>], <span class="number">1</span>) ^ gmul(temp[<span class="number">1</span>], <span class="number">1</span>) ^ gmul(temp[<span class="number">2</span>], <span class="number">2</span>) ^ gmul(temp[<span class="number">3</span>], <span class="number">3</span>)</span><br><span class="line">    col[<span class="number">3</span>] = gmul(temp[<span class="number">0</span>], <span class="number">3</span>) ^ gmul(temp[<span class="number">1</span>], <span class="number">1</span>) ^ gmul(temp[<span class="number">2</span>], <span class="number">1</span>) ^ gmul(temp[<span class="number">3</span>], <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> col</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">state, round_key</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(state)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(state[<span class="number">0</span>])):</span><br><span class="line">            state[i][j] = state[i][j] ^ round_key[i][j]</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_block</span>(<span class="params">ptext: <span class="built_in">bytes</span>, key</span>):</span><br><span class="line">    cipher = ptext</span><br><span class="line">    rkey = bytes2matrix(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        ctext = bytes2matrix(cipher)</span><br><span class="line">        ctext = sub_bytes(ctext, s_box)</span><br><span class="line">        ctext = shift_rows(ctext)</span><br><span class="line">        temp = copy(ctext)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            column = [temp[<span class="number">0</span>][j], temp[<span class="number">1</span>][j], temp[<span class="number">2</span>][j], temp[<span class="number">3</span>][j]]</span><br><span class="line">            column = mix_col(column)</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                ctext[k][j] = column[k]</span><br><span class="line">        ctext = add_round_key(ctext, rkey)</span><br><span class="line">        cipher = matrix2bytes(ctext)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br></pre></td></tr></table></figure>

<p>靶机:<code>dyn.ctf.pearlctf.in 30015</code></p>
<p>花了很长时间看代码，后来在鸡块师傅指导下，可以用逐字节爆破的方式进行求解，具体过程如下：</p>
<p>先输入空，可知flag长度为32</p>
<p>然后输入<code>000000000000000</code>，即15个0。</p>
<p>此时明文分块为<br>$$<br>000000000000000m_1 \quad m_2m_3…m_{17} \quad m_{18}…m_{32}.<br>$$<br>最后那个点是填充</p>
<p>我们再输入<code>000000000000000 + X</code>，X为我们要爆破的字符</p>
<p>此时明文分块为<br>$$<br>000000000000000X \quad m_1m_2…m_{16} \quad m_{17}…m_{32}<br>$$<br>只需要对比第一块密文是否相同，我们就可以知道X是什么字符，也就是flag的第一个字符</p>
<p>接下来，我们爆破第二位</p>
<p>这个时候输入<code>00000000000000</code>，即14个0</p>
<p>此时明文分块为：<br>$$<br>00000000000000m_1m_2 \quad m_3m_4…m_{18} \quad m_{19}…m_{32}..<br>$$<br>最后两个点是填充</p>
<p>我们再输入<code>00000000000000m1 + X</code>，上一步已经把<code>m1</code>求出来了</p>
<p>此时明文分块为<br>$$<br>00000000000000m_1X \quad m_1m_2 …m_{16} \quad m_{17}…m_{32}<br>$$<br>还是对比第一块密文即可判断出flag的字符，依次爆破出flag的前16位</p>
<p>接下来爆破第17位</p>
<p>此时我们需要输入<code>0000000000000000000000000000000</code>，即31个0</p>
<p>此时明文分块为<br>$$<br>0000000000000000 \quad 00000000000000m_1 \quad m_2…m_{17} \quad m_{18}…m_{32}.<br>$$<br>再输入<code>flag[-15:] + X + 000000000000000</code>，就是flag倒数15个，X是要爆破的字符<br>$$<br>m_2…m_{16}X \quad 000000000000000m_1 \quad m_2…m_{17} \quad m_{18}…m_{32}.<br>$$<br>这个时候我们只需要把第一块密文和第三块密文进行对比，即可依次爆出所有字符</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;dyn.ctf.pearlctf.in&quot;</span>,<span class="number">30015</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">16</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Enter plaintext: &quot;</span>)</span><br><span class="line">    sh.sendline((<span class="string">&quot;0&quot;</span>*(<span class="number">15</span>-i)).encode())</span><br><span class="line">    c = sh.recvline().strip()</span><br><span class="line">    enc_flag = base64.b64decode(c)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">128</span>):</span><br><span class="line">        msg = (<span class="string">&quot;0&quot;</span>*(<span class="number">15</span>-i)) + flag +  <span class="built_in">chr</span>(j)</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;Enter plaintext: &quot;</span>)</span><br><span class="line">        sh.sendline(msg.encode())</span><br><span class="line">        cc = sh.recvline().strip()</span><br><span class="line">        cipher = base64.b64decode(cc)</span><br><span class="line">        <span class="keyword">if</span> cipher[:<span class="number">16</span>] == enc_flag[:<span class="number">16</span>]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;flag:<span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">16</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Enter plaintext: &quot;</span>)</span><br><span class="line">    sh.sendline((<span class="string">&quot;0&quot;</span>*(<span class="number">31</span>-i)).encode())</span><br><span class="line">    c = sh.recvline().strip()</span><br><span class="line">    enc_flag = base64.b64decode(c)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">128</span>):</span><br><span class="line">        msg = flag[-<span class="number">15</span>:] + <span class="built_in">chr</span>(j) + <span class="string">&quot;0&quot;</span>*(<span class="number">15</span>-i)</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;Enter plaintext: &quot;</span>)</span><br><span class="line">        sh.sendline(msg.encode())</span><br><span class="line">        cc = sh.recvline().strip()</span><br><span class="line">        cipher = base64.b64decode(cc)</span><br><span class="line">        <span class="keyword">if</span> cipher[:<span class="number">16</span>] == enc_flag[<span class="number">32</span>:<span class="number">48</span>]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;flag:<span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment"># pearl&#123;n0t_sn34ky_A3S_3ncrypt10n&#125;</span></span><br></pre></td></tr></table></figure>
















    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/" title="2024VishwaCTF">https://dexterjie.github.io/2024/03/03/赛题复现/2024VishwaCTF/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/" rel="prev" title="杂记(二)">
                  <i class="fa fa-chevron-left"></i> 杂记(二)
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/03/05/BlockChain/" rel="next" title="BlockChain">
                  BlockChain <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">240k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">14:34</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
