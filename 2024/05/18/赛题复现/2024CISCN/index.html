<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="è®°å½•å›½èµ›">
<meta property="og:type" content="article">
<meta property="og:title" content="2024CISCN">
<meta property="og:url" content="https://dexterjie.github.io/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="è®°å½•å›½èµ›">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/6.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%972.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/9.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/7.png">
<meta property="og:image" content="https://dexterjie.github.io/images/CISCN/8.png">
<meta property="article:published_time" content="2024-05-18T12:36:33.000Z">
<meta property="article:modified_time" content="2024-06-06T14:02:32.755Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/CISCN/3.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/","path":"2024/05/18/èµ›é¢˜å¤ç°/2024CISCN/","title":"2024CISCN"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024CISCN | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>å‹é“¾</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="nav-number">1.</span> <span class="nav-text">ç”¨æˆ·ä¿¡æ¯è®¿é—®æ§åˆ¶</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#hash%E2%80%94%E2%80%94%E5%A4%8D%E7%8E%B0"><span class="nav-number">2.</span> <span class="nav-text">hashâ€”â€”å¤ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%A8%E6%A0%BC%E6%9D%A5%E5%81%9A"><span class="nav-number">2.1.</span> <span class="nav-text">ç”¨æ ¼æ¥åš</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#myagcd%E2%80%94%E2%80%94%E7%B4%A7%E6%80%A5%E4%B8%8B%E7%BA%BF%E7%9A%84%E9%A2%98%E7%9B%AE"><span class="nav-number">3.</span> <span class="nav-text">myagcdâ€”â€”ç´§æ€¥ä¸‹çº¿çš„é¢˜ç›®</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#OvO"><span class="nav-number">4.</span> <span class="nav-text">OvO</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="nav-number">5.</span> <span class="nav-text">å¤å…¸å¯†ç </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ezrsa%E2%80%94%E2%80%94%E5%A4%8D%E7%8E%B0"><span class="nav-number">6.</span> <span class="nav-text">ezrsaâ€”â€”å¤ç°</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">ä¸€æšåªä¼šCryptoçš„èœé¸¡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="ä¸€æšåªä¼šCryptoçš„èœé¸¡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024CISCN | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024CISCN
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2024-05-18 20:36:33" itemprop="dateCreated datePublished" datetime="2024-05-18T20:36:33+08:00">2024-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2024-06-06 22:02:32" itemprop="dateModified" datetime="2024-06-06T22:02:32+08:00">2024-06-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Walineï¼š</span>
  
    <a title="waline" href="/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>3.1k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>11 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>è®°å½•å›½èµ›</p>
<span id="more"></span>

<p>æµ…æµ…è®°å½•ä¸€ä¸‹ç¬¬ä¸€å¤©è¢«å­¦é•¿å’Œé˜Ÿå‹å¸¦é£çš„å°é«˜å…‰</p>
<p><img src="/../../images/CISCN/3.png"></p>
<p>ç¬¬ä¸€å¤©çš„é¢˜ï¼Œå¯¹æˆ‘è¿™ç§ä¸­ç­‰æ°´å¹³çš„å¯†ç æ‰‹å¹¶ä¸å‹å¥½</p>
<p>ç¬¬äºŒå¤©å®šæ¦œ70ï¼Œåä¸œå—15ï¼Œè¢«é˜Ÿå‹å¸¦è¿›åŠå†³èµ›äº†(ä»Šå¤©ç»ˆäºæ˜¯åšå‡ºé¢˜äº†ï¼Œä¸¤é“50åˆ†çš„å¯†ç ğŸ˜­)</p>
<p><img src="/../../images/CISCN/6.png"></p>
<h1 id="ç”¨æˆ·ä¿¡æ¯è®¿é—®æ§åˆ¶"><a href="#ç”¨æˆ·ä¿¡æ¯è®¿é—®æ§åˆ¶" class="headerlink" title="ç”¨æˆ·ä¿¡æ¯è®¿é—®æ§åˆ¶"></a>ç”¨æˆ·ä¿¡æ¯è®¿é—®æ§åˆ¶</h1><p>è¿™é“é¢˜æ˜¯å’Œé˜Ÿå‹ä»¬ä¸€èµ·åšå‡ºæ¥çš„ï¼Œç”±æˆ‘è®°å½•ä¸€ä¸‹</p>
<p>è¦æ±‚â‘ ï¼šé€‰æ‰‹ä¿®æ”¹instance&#x2F;serverç›®å½•ä¸‹ç­–ç•¥æ–‡ä»¶record.listï¼Œè¡¥å…¨è¡¨1ä¸­æ‰€æœ‰è®°å½•é¡¹å¯¹åº”çš„å®¢ä½“å®‰å…¨å±æ€§</p>
<p>æ ¹æ®</p>
<p><img src="/../../images/CISCN/1.png"></p>
<p><img src="/../../images/CISCN/2.png"></p>
<p>record.listæœ¬æ¥å°±å­˜åœ¨çš„ä¸€äº›æ•°æ®ï¼Œåªéœ€è¦æ·»åŠ ä¸‹é¢å†…å®¹å³å¯å®Œæˆè¦æ±‚â‘ </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        &quot;name&quot;:&quot;cell&quot;,</span><br><span class="line">        &quot;isleveladjust&quot;:1,        //éœ€è¦è°ƒæ•´çº§åˆ«</span><br><span class="line">        &quot;isselfdefine&quot;:0,         //è¯¥å†…å®¹æ²¡æœ‰è‡ªå·±çš„ä¸“é—¨ç±»åˆ«</span><br><span class="line">        &quot;class&quot;:0,                //</span><br><span class="line">        &quot;level_fix&quot;:0,            //è¯¥é¡¹çº§åˆ«ä¸å›ºå®š</span><br><span class="line">        &quot;level_adjust&quot;:-1         //ä½1çº§</span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">        &quot;name&quot;:&quot;email&quot;,</span><br><span class="line">        &quot;isleveladjust&quot;:1,        //éœ€è¦è°ƒæ•´çº§åˆ«</span><br><span class="line">        &quot;isselfdefine&quot;:0,         //è¯¥å†…å®¹æ²¡æœ‰è‡ªå·±çš„ä¸“é—¨ç±»åˆ«</span><br><span class="line">        &quot;class&quot;:0,</span><br><span class="line">        &quot;level_fix&quot;:0,            //è¯¥é¡¹çº§åˆ«ä¸å›ºå®š</span><br><span class="line">        &quot;level_adjust&quot;:-2         //ä½2çº§</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚â‘¡ï¼šä¿®æ”¹src&#x2F;record_acl&#x2F;record_acl.cä¸­except_ruleï¼Œä»¥åœ¨æ•°æ®è¯»å–è¡Œä¸ºç¬¦åˆä¾‹å¤–è§„åˆ™æ—¶è¿”å›1,å¹¶åœ¨record_aclç›®å½•ä¸‹ç”¨makeå‘½ä»¤ç¼–è¯‘ã€‚è€Œåæ‰§è¡Œsh record_access.shè‡ªè¡Œæµ‹è¯•ï¼Œè§‚å¯Ÿè¾“å‡ºï¼Œå¦‚è¾“å‡ºç¬¦åˆç¬¬ä¸€èŠ‚ä¸­è®¿é—®æ§åˆ¶è¦æ±‚ï¼Œåˆ™å¯æ‰§è¡Œsh player.sh ï¼Œæäº¤ç­”æ¡ˆï¼Œç­‰å¾…èµ›é¢˜è£å†³æœºåˆ¶çš„è¾“å‡ºï¼Œå¦‚è¾“å‡ºflagï¼Œåˆ™æäº¤flagï¼Œå¦åˆ™å¦‚æœé¢˜ç›®ç»™å‡ºé”™è¯¯æç¤ºï¼Œåˆ™ä¿®æ”¹ç­–ç•¥æ–‡ä»¶å’Œä»£ç ï¼Œå¯¹ä»£ç é‡æ–°ç¼–è¯‘åå†æ¬¡æäº¤è¿›è¡Œæµ‹è¯•ã€‚</p>
<p>æ ¹æ®è¦æ±‚å®ç°æŸ¥è¯¢è–ªèµ„çš„åŠŸèƒ½ï¼ŒæŠŠå‡½æ•°ä¿®æ”¹ä¸ºä¸‹é¢å†…å®¹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">except_rule</span><span class="params">(<span class="type">char</span> * record_name,<span class="type">char</span> * read_user,<span class="type">char</span> * record_user)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ret;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strncmp</span>(record_name,<span class="string">&quot;salary&quot;</span>,<span class="number">6</span>) &amp;&amp; !<span class="built_in">strncmp</span>(read_user,record_user,<span class="built_in">strlen</span>(record_user)))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¦æ±‚æŸ¥è¯¢ç”¨æˆ·ä¸è¢«æŸ¥è¯¢ç”¨æˆ·ä¸¤ä¸ªå€¼ç›¸åŒï¼Œè€Œä¸”æŸ¥è¯¢å­—æ®µä¸ºè–ªæ°´(salary)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨makeä¹‹å‰ï¼Œéœ€è¦åœ¨cube-userinfo-accessä¸‹è¿è¡Œsource set_env.sh</p>
<p>ç„¶åå†åœ¨record_aclä¸‹make</p>
<p><img src="/../../images/CISCN/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%972.png"></p>
<p><img src="/../../images/CISCN/%E5%8F%AF%E4%BF%A1%E8%AE%A1%E7%AE%97.png"></p>
<h1 id="hashâ€”â€”å¤ç°"><a href="#hashâ€”â€”å¤ç°" class="headerlink" title="hashâ€”â€”å¤ç°"></a>hashâ€”â€”å¤ç°</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="comment"># Python 2.7 (64-bit version)</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os, binascii, hashlib</span><br><span class="line">key = os.urandom(<span class="number">7</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hash</span>(key)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">int</span>(hashlib.sha384(binascii.hexlify(key)).hexdigest(), <span class="number">16</span>) ^ <span class="built_in">int</span>(binascii.hexlify(flag), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">7457312583301101235</span></span><br><span class="line"><span class="string">13903983817893117249931704406959869971132956255130487015289848690577655239262013033618370827749581909492660806312017</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜èµ›ååœ¨é¸¡å—å¸ˆå‚…æŒ‡å¯¼ä¸‹å¤ç°çš„</p>
<p>é¦–å…ˆæŸ¥æºç ï¼š<a target="_blank" rel="noopener" href="https://pypi.org/project/py27hash/#files">py27hash Â· PyPI</a></p>
<p>æ¯”èµ›çš„æ—¶å€™ï¼Œä»å®˜ç½‘æŸ¥çš„æºç æ˜¯cè¯­è¨€ï¼Œä¸å¤ªæ‡‚æŒ‡é’ˆå¯¼è‡´æ²¡ç†è§£hashçš„è¿‡ç¨‹ã€‚è¿™æ–¹é¢è¿˜å¾—ç»ƒ</p>
<p>å¾—çŸ¥hashå®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">s</span>):</span><br><span class="line">    mask = <span class="number">0xffffffffffffffff</span></span><br><span class="line">    s = s.encode()</span><br><span class="line">    x = s[<span class="number">0</span>] &lt;&lt; <span class="number">7</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> s:</span><br><span class="line">        x = (<span class="number">1000003</span> * x) &amp; mask ^ char</span><br><span class="line">    x ^= <span class="built_in">len</span>(s) &amp; mask</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> x</span><br></pre></td></tr></table></figure>

<p><code>&amp; mask</code>ç›¸å½“äºæ¨¡$2^{64}$</p>
<p>å†™æˆæ•°å­¦å¼å­</p>
<p>$$<br>x_0 &#x3D; s_0 \times 2^7<br>$$</p>
<p>$$<br>x_1 &#x3D; 1000003\times x_0 \mod 2^{64} \otimes s_0<br>$$</p>
<p>$$<br>x_2 &#x3D; 1000003\times x_1 \mod 2^{64} \otimes s_1<br>$$</p>
<p>$$<br>x_3 &#x3D; 1000003\times x_2 \mod 2^{64} \otimes s_2<br>$$</p>
<p>$$<br>x_4 &#x3D; 1000003\times x_3 \mod 2^{64} \otimes s_3<br>$$</p>
<p>$$<br>x_5 &#x3D; 1000003\times x_4 \mod 2^{64} \otimes s_4<br>$$</p>
<p>$$<br>x_6 &#x3D; 1000003\times x_5 \mod 2^{64} \otimes s_5<br>$$</p>
<p>$$<br>x_7 &#x3D; 1000003\times x_6 \mod 2^{64} \otimes s_6<br>$$</p>
<p>$$<br>x &#x3D; x_7 \otimes length \mod 2^{64}\<br>$$</p>
<p>é€†å‘å›æ¥çš„è¯å¾ˆå®¹æ˜“<br>$$<br>x_7 &#x3D; x \otimes length \mod 2^{64}<br>$$</p>
<p>$$<br>x_6 &#x3D; x_7 \otimes s_6 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>$$<br>x_5 &#x3D; x_6 \otimes s_5 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>$$<br>x_4 &#x3D; x_5 \otimes s_4 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>$$<br>x_3 &#x3D; x_4 \otimes s_3 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>$$<br>x_2 &#x3D; x_3 \otimes s_2 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>$$<br>x_1 &#x3D; x_2 \otimes s_1 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>$$<br>x_0 &#x3D; x_1 \otimes s_0 \times 1000003^{-1} \mod 2^{64}<br>$$</p>
<p>ä¸­é—´ç›¸é‡æ”»å‡»çš„æ€è·¯åœ¨äºï¼Œå‡è®¾å¯†é’¥æ˜¯<code>abcdefg</code></p>
<p>æˆ‘ä»¬ä»å‰é¢åŠ å¯†4ä¸ªå­—ç¬¦ï¼Œå³åŠ å¯†åˆ°$x_4$ï¼Œå¹¶æŠŠä»–ä½œä¸ºå…ƒç»„è®°å½•ä¸‹æ¥ã€‚</p>
<p>å†æŠŠå¾—åˆ°çš„å¯†æ–‡ä»åé¢é€†å‘ï¼Œé€†åˆ°$x_4$,å¦‚æœå’Œå‰é¢çš„å¯¹åº”ä¸Šäº†ï¼Œå³çˆ†ç ´å‡ºkey</p>
<p>exp</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">mask = <span class="number">0xffffffffffffffff</span></span><br><span class="line">inv = inverse(<span class="number">1000003</span>,<span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">x7 = <span class="number">7457312583301101235</span></span><br><span class="line">cipher = <span class="number">13903983817893117249931704406959869971132956255130487015289848690577655239262013033618370827749581909492660806312017</span></span><br><span class="line"></span><br><span class="line">table = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">    <span class="comment"># è¿™æ˜¯ç¬¬ä¸€ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="keyword">for</span> tmp <span class="keyword">in</span> product([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)],repeat=<span class="number">3</span>):</span><br><span class="line">        <span class="comment"># ä¸‹é¢ä¾¿æ˜¯hashçš„å®ç°,ä½†æ˜¯æˆ‘ä»¬åªä¹˜ä¸Š3ä¸ªå­—ç¬¦</span></span><br><span class="line">        x = (i &lt;&lt; <span class="number">7</span>) &amp; mask                       </span><br><span class="line">        x = (<span class="number">1000003</span> * x) &amp; mask ^ i</span><br><span class="line">        pre = <span class="built_in">list</span>(tmp)</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> pre:</span><br><span class="line">            x = (<span class="number">1000003</span> * x) &amp; mask ^ char</span><br><span class="line">        </span><br><span class="line">        table[x] = pre</span><br><span class="line">        <span class="comment"># è®°å½•ä¸‹æ¥</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> tmp <span class="keyword">in</span> product([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)],repeat=<span class="number">3</span>):</span><br><span class="line">        tail = <span class="built_in">list</span>(tmp)</span><br><span class="line">        x7 = (x7 ^ <span class="number">7</span>) &amp; mask</span><br><span class="line">        x6 = (x7 ^ tail[-<span class="number">1</span>]) * inv &amp; mask</span><br><span class="line">        x5 = (x6 ^ tail[-<span class="number">2</span>]) * inv &amp; mask</span><br><span class="line">        x4 = (x5 ^ tail[-<span class="number">3</span>]) * inv &amp; mask</span><br><span class="line">        <span class="keyword">if</span> x4 <span class="keyword">in</span> table.keys():</span><br><span class="line">            <span class="built_in">print</span>(i,table[x4],tail)</span><br><span class="line">            <span class="comment"># 93 [140, 240, 63] [90, 8, 82]</span></span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>æ•´ä¸ªç¨‹åºå·®ä¸å¤š2.5å°æ—¶ï¼Œæ²¡è·‘å…¨ï¼Œé—®äº†é¸¡å—å¸ˆå‚…ã€‚æ­£ç¡®çš„æ˜¯93ï¼Œæœ€å<code>key = [93,140,240,63,90,8,82]</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">m = [<span class="number">93</span>,<span class="number">140</span>,<span class="number">240</span>,<span class="number">63</span>,<span class="number">90</span>,<span class="number">8</span>,<span class="number">82</span>]</span><br><span class="line">key = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    key += long_to_bytes(i)</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(hashlib.sha384(binascii.hexlify(key)).hexdigest(), <span class="number">16</span>) ^ cipher) </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;bdb537aa-87ef-4e95-bea4-2f79259bdd07&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="ç”¨æ ¼æ¥åš"><a href="#ç”¨æ ¼æ¥åš" class="headerlink" title="ç”¨æ ¼æ¥åš"></a>ç”¨æ ¼æ¥åš</h2><p>æ ¹æ®hashå‡½æ•°çš„è¿‡ç¨‹ï¼Œå…¶ä¸­$s_0,â€¦,s_6$éƒ½æ˜¯$0-255$çš„å€¼ï¼Œå¯ä»¥æŠŠå¼‚æˆ–çœ‹ä½œåŠ æˆ–è€…æ˜¯å‡å»ä¸€ä¸ªå€¼ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åç§»é‡ï¼ŒæŠŠåç§»é‡è®°ä¸º$b$</p>
<p>æ‰€ä»¥ç›¸å½“äºæ˜¯ä¸‹é¢è¿™ä¸ªè¿‡ç¨‹</p>
<p>$$<br>x_0 &#x3D; b_0 \times 2^7<br>$$</p>
<p>$$<br>x_1 \equiv ax_0 + b_0 \mod 2^{64}<br>$$</p>
<p>$$<br>x_2 \equiv ax_1 + b_1 \mod 2^{64}<br>$$</p>
<p>$$<br>x_3 \equiv ax_2 + b_2 \mod 2^{64}<br>$$</p>
<p>$$<br>x_4 \equiv ax_3 + b_3 \mod 2^{64}<br>$$</p>
<p>$$<br>x_5 \equiv ax_4 + b_4 \mod 2^{64}<br>$$</p>
<p>$$<br>x_6\equiv ax_5 + b_5 \mod 2^{64}<br>$$</p>
<p>$$<br>x_7 \equiv ax_6 +b_6 \mod 2^{64}<br>$$</p>
<p>$$<br>res \equiv x_7 \otimes 7 \mod 2^{64}<br>$$</p>
<p>æœ€åå¯ä»¥æŠŠä»–å†™æˆä¸€ä¸ªå¤šé¡¹å¼:<br>$$<br>x_7 \equiv 128a^7b_0 + a^6b_0 + a^5b_1 + a^4b_2 + a^3b_3 + a^2b_4 + ab_5 + b_6 \mod 2^{64}\<br>$$</p>
<p>æ„é€ æ ¼</p>
<p><img src="/../../images/CISCN/11.png"></p>
<p>ç›®æ ‡å‘é‡å¤§æ¦‚åœ¨$(-256,255)$</p>
<p>è§„çº¦å‡ºæ¥çš„å‘é‡ï¼Œä¸æ˜¯åŸæœ¬çš„å­—ç¬¦å€¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™æ ·çš„å…³ç³»æ¥å¾—åˆ°:<br>$$<br>x_7 &#x3D; x_6 \otimes s_6<br>$$<br>è€Œ$x_6 &#x3D; x_7 - b_6$</p>
<p>æ‰€ä»¥$s_6 &#x3D; (x_7 - b_6) \otimes x_7$</p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºkey</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">mask = <span class="number">0xffffffffffffffff</span></span><br><span class="line">res = <span class="number">7457312583301101235</span></span><br><span class="line">cipher = <span class="number">13903983817893117249931704406959869971132956255130487015289848690577655239262013033618370827749581909492660806312017</span></span><br><span class="line">MOD = <span class="number">2</span>^<span class="number">64</span></span><br><span class="line">a = <span class="number">1000003</span></span><br><span class="line"></span><br><span class="line">x7 = (res ^^ <span class="number">7</span>) &amp; mask</span><br><span class="line">xishu = [<span class="number">128</span>*a^<span class="number">7</span>+a^<span class="number">6</span>,a^<span class="number">5</span>,a^<span class="number">4</span>,a^<span class="number">3</span>,a^<span class="number">2</span>,a,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(xishu)</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,length+<span class="number">2</span>,length+<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">    Ge[i,i] = <span class="number">1</span></span><br><span class="line">    Ge[i,-<span class="number">1</span>] = xishu[i]</span><br><span class="line">    </span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">256</span></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">1</span>] = -x7</span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = MOD</span><br><span class="line"></span><br><span class="line">Ge[:,-<span class="number">1</span>:] *= <span class="number">2</span>^<span class="number">200</span></span><br><span class="line">c = x7</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    key = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> line[-<span class="number">1</span>] == <span class="number">0</span> <span class="keyword">and</span> line[-<span class="number">2</span>] == <span class="number">256</span>:</span><br><span class="line">        tmp = line[:-<span class="number">2</span>]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(tmp)):</span><br><span class="line">            tmpc = (c - tmp[<span class="number">6</span>-i]) % <span class="number">2</span>^<span class="number">64</span></span><br><span class="line">            s = (tmpc ^^ c)</span><br><span class="line">            key += long_to_bytes(s)</span><br><span class="line">            c = (c ^^ s) * gmpy2.invert(a,<span class="number">2</span>^<span class="number">64</span>) % <span class="number">2</span>^<span class="number">64</span></span><br><span class="line">    m = <span class="built_in">int</span>(hashlib.sha384(binascii.hexlify(key[::-<span class="number">1</span>])).hexdigest(), <span class="number">16</span>) ^^ cipher</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">    <span class="comment"># flag&#123;bdb537aa-87ef-4e95-bea4-2f79259bdd07&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="myagcdâ€”â€”ç´§æ€¥ä¸‹çº¿çš„é¢˜ç›®"><a href="#myagcdâ€”â€”ç´§æ€¥ä¸‹çº¿çš„é¢˜ç›®" class="headerlink" title="myagcdâ€”â€”ç´§æ€¥ä¸‹çº¿çš„é¢˜ç›®"></a>myagcdâ€”â€”ç´§æ€¥ä¸‹çº¿çš„é¢˜ç›®</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_param</span>(<span class="params">x, p, BITS</span>):</span><br><span class="line">    r = getPrime(BITS//<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(BITS)</span><br><span class="line">        <span class="keyword">if</span> q &lt; p:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    b = (x * q + r) % p</span><br><span class="line">    <span class="keyword">return</span> r, b, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">BITS</span>):</span><br><span class="line">    p = getPrime(BITS)</span><br><span class="line">    x = randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    sk = [x]</span><br><span class="line">    pk = [p]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        r, b, q = gen_param(x, p, BITS)</span><br><span class="line">        sk.append(r)</span><br><span class="line">        pk.extend([b, q])</span><br><span class="line">    <span class="keyword">return</span> sk, pk</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;welcome to my game, you need to pass 10 rounds to get the flag&quot;</span>)</span><br><span class="line">    <span class="built_in">round</span> = <span class="number">10</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">round</span>):</span><br><span class="line">        sk, pk = gen_key(<span class="number">256</span>)</span><br><span class="line">        x = sk[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;pk: &quot;</span>, pk)</span><br><span class="line">        x_ = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;give me x: &quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> x_ == x:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;good&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;wrong!&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;congratulation, here is your flag&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span>(f.read())</span><br></pre></td></tr></table></figure>

<p>ç”±é¢˜æ„çŸ¥<br>$$<br>b_0 &#x3D; xq_0 + r_0 \mod p<br>$$</p>
<p>$$<br>b_1 &#x3D; xq_1 + r_1 \mod p<br>$$</p>
<p>å·²çŸ¥$b,q,p$ï¼Œæ€è·¯æ˜¯æ¶ˆå»xï¼ŒæŠŠ$r_0$æˆ–$r_1$æ±‚å‡ºæ¥(rçš„æ•°é‡çº§åªæœ‰128)ï¼Œå†æ±‚è§£x</p>
<p>ä½œæ¨å¯¼å¯ä»¥å¾—åˆ°<br>$$<br>b_0q_1 \equiv xq_0q_1 + r_0q_1 \mod p\<br>b_1q_0 \equiv xq_1q_0 + r_1q_0 \mod p<br>$$</p>
<p>$$<br>b_0q_1 - b_1q_0 \equiv r_0q_1 - r_1q_0 \mod p<br>$$</p>
<p>$$<br>0 &#x3D; r_0q_1 - r_1q_0 + b_0q_1 - b_1q_0 + kp<br>$$</p>
<p><img src="/../../images/CISCN/9.png"></p>
<p>æœ€åä¸€åˆ—éœ€è¦ä¹˜ä¸€ä¸ªå¤§æ•°ï¼Œå¤§æ¦‚$2^{128}$ï¼Œå®é™…ä¸Šä¼šå¡ç•Œ</p>
<p>å› ä¸ºræ˜¯128bitçš„ç´ æ•°ï¼Œæ‰€ä»¥rçš„æœ€é«˜ä½å’Œæœ€ä½ä½æ˜¯1ï¼Œå¯ä»¥æŠŠrå†™æˆ$2^{127} + r_0 + 1$</p>
<p>è¿™æ ·çš„è¯ï¼Œç­‰å¼å†™ä¸º<br>$$<br>0 &#x3D; (2^{127} + r_0\times 2 + 1)q_1 - (2^{127} + r_1\times 2+1)q_0 + b_0q_1 - b_1q_0 + kp<br>$$</p>
<p>å³<br>$$<br>0 &#x3D; (2^{127} + 1)q_1 - (2^{127}+1)q_0 + b_0q_1 - b_1q_0 + kp<br>$$<br>æ„é€ æ ¼</p>
<p><img src="/../../images/CISCN/10.png"></p>
<p>è¿˜æ˜¯éœ€è¦åœ¨æœ€åä¸€åˆ—ä¹˜ä¸Šå¤§æ•°</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sk = [<span class="number">31067408706118531778836025838205112775236644965865772823812117127751271259476</span>, <span class="number">290929702745799288901141574400839037929</span>, <span class="number">321295811382361172183984777251716725209</span>]</span><br><span class="line">pk = [<span class="number">71326246066892613373620794096364722364475105426485661989214263916039351653301</span>, <span class="number">39065868145148974053618331846930041188453567579625647858296606637712340989831</span>, <span class="number">60701185955859641632147876660678128394101873280164553720147323354883999537411</span>, <span class="number">6495230186702141273101847496975434679236671407037295404955773501796732774419</span>, <span class="number">60522146751495726051537052036607716455760564547991467652808039897553164071019</span>]</span><br><span class="line"></span><br><span class="line">x = sk[<span class="number">0</span>]</span><br><span class="line">p,b0,q0,b1,q1 = pk</span><br><span class="line"></span><br><span class="line">T = <span class="number">2</span>^<span class="number">128</span></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>*q1*T],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">2</span>*q0*T],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">126</span>,((<span class="number">2</span>^<span class="number">127</span>+<span class="number">1</span>)*q1-(<span class="number">2</span>^<span class="number">127</span>+<span class="number">1</span>)*q0 + b1*q0-b0*q1)*T],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,p*T]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    t0 = <span class="built_in">abs</span>(line[<span class="number">0</span>])</span><br><span class="line">    t1 = <span class="built_in">abs</span>(line[<span class="number">1</span>])</span><br><span class="line">    r0 = <span class="number">2</span>^<span class="number">127</span> + <span class="number">2</span>*t0 + <span class="number">1</span></span><br><span class="line">    r1 = <span class="number">2</span>^<span class="number">127</span> + <span class="number">2</span>*t1 + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(r0) <span class="keyword">and</span> isPrime(r1):</span><br><span class="line">        xx = (b0 - r0)*inverse(q0,p) % p</span><br><span class="line">        <span class="built_in">print</span>(xx == x)</span><br></pre></td></tr></table></figure>

<p>è‡ªå·±æµ‹çš„æ•°æ®</p>
<h1 id="OvO"><a href="#OvO" class="headerlink" title="OvO"></a>OvO</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">512</span></span><br><span class="line">p = getPrime(nbits)</span><br><span class="line">q = getPrime(nbits)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    kk = getPrime(<span class="number">128</span>)</span><br><span class="line">    rr = kk + <span class="number">2</span></span><br><span class="line">    e = <span class="number">65537</span> + kk * p + rr * ((p+<span class="number">1</span>) * (q+<span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e = e &gt;&gt; <span class="number">200</span> &lt;&lt; <span class="number">200</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span></span><br><span class="line"><span class="string">e = 37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span></span><br><span class="line"><span class="string">c = 14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>$$<br>e &#x3D; 65537 + kp + (k+2)(p+1)(q+1) + 1<br>$$</p>
<p>åŒ–ç®€å¾—<br>$$<br>e &#x3D; 65537 + (k+2)n + 2(k+1)p + (k+2)q + k+3<br>$$<br>æ³¨æ„æ•°é‡çº§ï¼ŒæŠŠ<code>e // n</code>ä¹‹åï¼Œç­‰å·å³è¾¹åªå‰©ä¸‹$k+2$ï¼Œå¯ä»¥æ±‚å‡ºkï¼Œè¿™ä¸ªå¯ä»¥è‡ªå·±ç”Ÿæˆæ•°æ®æ£€éªŒï¼Œæ²¡æœ‰ä»€ä¹ˆé—®é¢˜</p>
<p>æˆ‘ä»¬æŠŠ$65537 +(k+2)n+k+3$è®°ä¸º<code>a</code><br>$$<br>e &#x3D; a + 2(k+1)p+(k+2)q<br>$$<br>ä¸¤è¾¹åŒä¹˜p<br>$$<br>ep &#x3D; ap + 2(k+1)p^2 + (k+2)n<br>$$<br>è¿™é‡Œåªæœ‰pæ˜¯æœªçŸ¥çš„ï¼Œä½†æ˜¯å› ä¸ºè¿™é‡Œeæ˜¯æ¨¡æ‰ä½200ä½ï¼Œæ‰€ä»¥æ±‚çš„pä¼šç¼ºå¤±200ä½</p>
<p>è¿™ä¸ªæ–¹ç¨‹æ±‚è§£ä¹‹åï¼Œç”¨é«˜ä½æ³„éœ²çš„æ€è·¯æ±‚è§£å³å¯</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_p</span>(<span class="params">phigh,n</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x + phigh</span><br><span class="line">    roots = f.monic().small_roots(X = <span class="number">2</span>^<span class="number">200</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = <span class="built_in">int</span>(x0) + phigh</span><br><span class="line">        <span class="keyword">assert</span> isPrime(p)</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    </span><br><span class="line">n = <span class="number">111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span></span><br><span class="line">e = <span class="number">37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span></span><br><span class="line">c = <span class="number">14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span></span><br><span class="line"></span><br><span class="line">k = e // n - <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(k)</span><br><span class="line">a = <span class="number">65537</span> + (k+<span class="number">2</span>)*n + (k+<span class="number">2</span>) + <span class="number">3</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(RealField(<span class="number">1024</span>))</span><br><span class="line">f = e*x - (<span class="number">2</span>*(k+<span class="number">1</span>)*x^<span class="number">2</span> + (k+<span class="number">2</span>)*n + a*x)</span><br><span class="line">res = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> res:</span><br><span class="line">    p_high = <span class="built_in">int</span>(root[<span class="number">0</span>])</span><br><span class="line">    p_high = p_high &gt;&gt; <span class="number">200</span> &lt;&lt; <span class="number">200</span></span><br><span class="line">    p = get_p(p_high,n)</span><br><span class="line">    <span class="keyword">if</span> p != <span class="literal">None</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        e = <span class="number">65537</span> + k * p + (k+<span class="number">2</span>) * ((p+<span class="number">1</span>) * (q+<span class="number">1</span>)) + <span class="number">1</span></span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="comment"># flag&#123;b5f771c6-18df-49a9-9d6d-ee7804f5416c&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="å¤å…¸å¯†ç "><a href="#å¤å…¸å¯†ç " class="headerlink" title="å¤å…¸å¯†ç "></a>å¤å…¸å¯†ç </h1><p>å¯†æ–‡ï¼š<code>AnU7NnR4NassOGp3BDJgAGonMaJayTwrBqZ3ODMoMWxgMnFdNqtdMTM9</code></p>
<p>åœ¨Atbashç è§£ç ä¹‹åï¼Œå†base64è§£ç å¾—åˆ°</p>
<p><code>fa&#123;2b838a-97ad-e9f743lgbb07-ce47-6e02804c&#125;</code></p>
<p>flagä¸€èˆ¬æ˜¯uuid4çš„æ ¼å¼ï¼Œæ‹¬å·å†…åº”è¯¥æ˜¯8-4-4-4-12</p>
<p>è¿™é‡Œè§£å‡ºæ¥çš„æ˜¯6-4-12-4-8ï¼Œè¯•äº†ä¸‹å›´æ å¯†ç ï¼Œå¾—åˆ°flag:<code>flag&#123;b2bb0873-8cae-4977-a6de-0e298f0744c3&#125;</code></p>
<p><img src="/../../images/CISCN/4.png"></p>
<h1 id="ezrsaâ€”â€”å¤ç°"><a href="#ezrsaâ€”â€”å¤ç°" class="headerlink" title="ezrsaâ€”â€”å¤ç°"></a>ezrsaâ€”â€”å¤ç°</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">key = RSA.generate(<span class="number">1024</span>)</span><br><span class="line">passphrase = <span class="built_in">str</span>(random.randint(<span class="number">0</span>,<span class="number">999999</span>)).zfill(<span class="number">6</span>).encode()</span><br><span class="line">output = key.export_key(passphrase=passphrase).split(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, <span class="number">15</span>):</span><br><span class="line">    output[i] = <span class="string">b&#x27;*&#x27;</span> * <span class="number">64</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;priv.pem&quot;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> output:</span><br><span class="line">        f.write(line + <span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(key._encrypt(m)))</span><br></pre></td></tr></table></figure>

<blockquote>
<p>priv.pem</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: DES-EDE3-CBC,435BF84C562FE793</span><br><span class="line"></span><br><span class="line">9phAgeyjnJYZ6lgLYflgduBQjdX+V/Ph/fO8QB2ZubhBVOFJMHbwHbtgBaN3eGlh</span><br><span class="line">WiEFEdQWoOFvpip0whr4r7aGOhavWhIfRjiqfQVcKZx4/f02W4pcWVYo9/p3otdD</span><br><span class="line">ig+kofIR9Ky8o9vQk7H1eESNMdq3PPmvd7KTE98ZPqtIIrjbSsJ9XRL+gr5a91gH</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">****************************************************************</span><br><span class="line">hQds7ZdA9yv+yKUYv2e4de8RxX356wYq7r8paBHPXisOkGIVEBYNviMSIbgelkSI</span><br><span class="line">jLQka+ZmC2YOgY/DgGJ82JmFG8mmYCcSooGL4ytVUY9dZa1khfhceg==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼è“å¸½æ¯2022çš„corrupted_key</p>
<p>ä¸ä¸€æ ·çš„æ˜¯ï¼Œè¿™é¢˜å¾—åˆ°çš„pemæ–‡ä»¶å†…å®¹æ˜¯åŠ å¯†çš„</p>
<p>æ ¹æ®ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key.export_key(passphrase=passphrase).split(<span class="string">b&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°Cryptoä¸‹çš„æºä»£ç  RSA.py</p>
<p><img src="/../../images/CISCN/7.png"></p>
<p>å‘ç°å…³é”®ä»£ç </p>
<p><img src="/../../images/CISCN/8.png"></p>
<p>å¦‚æœpassphraseå­˜åœ¨ï¼Œåˆ™éšæœºç”Ÿæˆä¸€ä¸ªsaltï¼Œç„¶åä½¿ç”¨PKBDF1æ–¹æ³•åŠ å¯†ä¸¤æ¬¡æ‹¼æ¥å¾—åˆ°keyã€‚</p>
<p>æ­¤æ—¶ä½¿ç”¨çš„åŠ å¯†æ–¹å¼ä¸º3des ï¼Œæ¨¡å¼ä¸ºcbcï¼Œivä¸ºsalt</p>
<p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥æ ¹æ®passphraseçš„ç”Ÿæˆæ–¹å¼æ¥çˆ†ç ´å‡ºå”¯ä¸€çš„passphrase</p>
<p>æ ¹æ®ç§é’¥çš„æ ¼å¼ï¼Œå¼€å¤´ä¸€å®šæ˜¯30820ï¼Œå†æ ¹æ®nä¸º1024bitï¼Œé‚£ä¹ˆåœ¨ç§é’¥ä¸­nçš„æ ¼å¼ä¸º02818xxxxxx,åŠ å¯†å‚æ•°eå¤§æ¦‚ç‡ä¸º65537ï¼Œå³0x10001</p>
<p>é‚£ä¹ˆå…¶åœ¨ç§é’¥ä¸­åˆ™ä¸º 0203010001ã€‚</p>
<p>è§£å¯†åå­˜åœ¨å¦‚ä¸‹ç‰¹å¾çš„æ˜æ–‡ï¼Œé‚£ä¹ˆå½“å‰çš„passphraseä¸ºæ‰€æ±‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Protocol.KDF <span class="keyword">import</span> PBKDF1</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> MD5</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enc1 = <span class="string">&quot;9phAgeyjnJYZ6lgLYflgduBQjdX+V/Ph/fO8QB2ZubhBVOFJMHbwHbtgBaN3eGlhWiEFEdQWoOFvpip0whr4r7aGOhavWhIfRjiqfQVcKZx4/f02W4pcWVYo9/p3otdDig+kofIR9Ky8o9vQk7H1eESNMdq3PPmvd7KTE98ZPqtIIrjbSsJ9XRL+gr5a91gH&quot;</span></span><br><span class="line">enc2 = <span class="string">&quot;hQds7ZdA9yv+yKUYv2e4de8RxX356wYq7r8paBHPXisOkGIVEBYNviMSIbgelkSIjLQka+ZmC2YOgY/DgGJ82JmFG8mmYCcSooGL4ytVUY9dZa1khfhceg==&quot;</span></span><br><span class="line"></span><br><span class="line">salt = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;435bf84c562fe793&quot;</span>)</span><br><span class="line"><span class="built_in">dict</span> = [<span class="built_in">str</span>(i).zfill(<span class="number">6</span>).encode() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">1000000</span>)]</span><br><span class="line"><span class="keyword">for</span> passphrase <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">    key = PBKDF1(passphrase, salt, <span class="number">16</span>, <span class="number">1</span>, MD5)</span><br><span class="line">    key += PBKDF1(key + passphrase, salt, <span class="number">8</span>, <span class="number">1</span>, MD5)</span><br><span class="line">    cipher = DES3.new(key, DES3.MODE_CBC, salt)</span><br><span class="line">    data = cipher.decrypt(base64.b64decode(enc1)).<span class="built_in">hex</span>()</span><br><span class="line">    <span class="keyword">if</span> data.startswith(<span class="string">&quot;30820&quot;</span>) <span class="keyword">and</span> <span class="string">&quot;02818&quot;</span> <span class="keyword">in</span> data <span class="keyword">and</span> <span class="string">&quot;0203010001&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">        <span class="built_in">print</span>(passphrase)</span><br><span class="line">        data2 = cipher.decrypt(base64.b64decode(enc2)).<span class="built_in">hex</span>()</span><br><span class="line">        <span class="built_in">print</span>(data2)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3082025c02010002818100a18f011bebacceda1c6812730b9e62720d3cbd6857af2cf8431860f5dc83c5520f242f3be7c9e96d7f96b41898ff000fdb7e43ef6f1e717b2b7900f35660a21d1b16b51849be97a0b0f7cbcf5cfe0f00370cce6193fefa1fed97b37bd367a673565162ce17b0225708c032961d175bbc2c829bf2e16eabc7e0881feca0975c810203010001</span><br><span class="line"></span><br><span class="line">6a033064c5a0dffc8f2363b340e502405f152c429871a7acdd28be1b643b4652800b88a3d23cc57477d75dd5555b635167616ef5c609d69ce3c2aedcb03b62f929bbcd891cadc0ba031ae6fec8a2116d0808080808080808</span><br></pre></td></tr></table></figure>

<p>å†æ ¹æ®ç§é’¥æ ¼å¼æå–<code>n,e,dq,inv</code></p>
<p>å› ä¸ºæœ¬é¢˜ä¸­ä¸­é—´éƒ¨åˆ†çš„ç§é’¥æ–‡ä»¶ç¼ºå¤±ï¼Œè€Œä¸”åŠ å¯†æ˜¯cbcçš„ï¼Œå¯¼è‡´enc2ç¬¬ä¸€å—è§£å¯†çš„ç»“æœé”™è¯¯ï¼Œéœ€è¦å»æ‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ­£ç¡®çš„dqåªæœ‰48bit</p>
<p>å› æ­¤å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = 0xa18f011bebacceda1c6812730b9e62720d3cbd6857af2cf8431860f5dc83c5520f242f3be7c9e96d7f96b41898ff000fdb7e43ef6f1e717b2b7900f35660a21d1b16b51849be97a0b0f7cbcf5cfe0f00370cce6193fefa1fed97b37bd367a673565162ce17b0225708c032961d175bbc2c829bf2e16eabc7e0881feca0975c81</span><br><span class="line">e = 65537</span><br><span class="line">dq_leak= 0x8f2363b340e5</span><br><span class="line">inv = 0x5f152c429871a7acdd28be1b643b4652800b88a3d23cc57477d75dd5555b635167616ef5c609d69ce3c2aedcb03b62f929bbcd891cadc0ba031ae6fec8a2116d</span><br></pre></td></tr></table></figure>

<p>$$<br>\because ed_q &#x3D; 1 + k(q-1)<br>$$</p>
<p>$$<br>\therefore kq &#x3D; ed_q +k-1<br>$$</p>
<p>kå¯ä»¥çˆ†ç ´ï¼Œä½†ä¸çŸ¥é“qï¼Œæ‰€ä»¥æ²¡åŠæ³•æ„é€ 1å…ƒcoppersmith<br>$$<br>\because inv \times q \equiv 1 \mod p<br>$$</p>
<p>$$<br>\therefore inv \times q - 1 \equiv 0 \mod p<br>$$</p>
<p>åŒä¹˜kq<br>$$<br>inv \times q \times kq - kq \equiv 0 \mod n<br>$$<br>æ­¤æ—¶ä¼šæœ‰ä¸ªçªå…€çš„qï¼Œä¸å¥½å¤„ç†ï¼Œæˆ‘ä»¬å†åŒä¹˜kï¼Œå¾—åˆ°<br>$$<br>inv \times (kq)^2 - k\times kq \equiv 0 \mod n<br>$$<br>å¾—åˆ°ä¸¤ä¸ªå¼å­ï¼š<br>$$<br>tmp &#x3D; e(x + dq_{low})+k-1<br>$$</p>
<p>$$<br>inv\times tmp^2 - k\times tmp \equiv 0 \mod n<br>$$</p>
<p>æ¢å¤å‡ºdqä¹‹åï¼Œ$q &#x3D; (ed_q + k - 1) &#x2F;&#x2F; k$</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line">n = <span class="number">0xa18f011bebacceda1c6812730b9e62720d3cbd6857af2cf8431860f5dc83c5520f242f3be7c9e96d7f96b41898ff000fdb7e43ef6f1e717b2b7900f35660a21d1b16b51849be97a0b0f7cbcf5cfe0f00370cce6193fefa1fed97b37bd367a673565162ce17b0225708c032961d175bbc2c829bf2e16eabc7e0881feca0975c81</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">dq_leak= <span class="number">0x8f2363b340e5</span></span><br><span class="line">inv = <span class="number">0x5f152c429871a7acdd28be1b643b4652800b88a3d23cc57477d75dd5555b635167616ef5c609d69ce3c2aedcb03b62f929bbcd891cadc0ba031ae6fec8a2116d</span></span><br><span class="line">c = <span class="number">55149764057291700808946379593274733093556529902852874590948688362865310469901900909075397929997623185589518643636792828743516623112272635512151466304164301360740002369759704802706396320622342771513106879732891498365431042081036698760861996177532930798842690295051476263556258192509634233232717503575429327989</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">coppersmith</span>(<span class="params">k</span>):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    tmp = e * (x * <span class="number">2</span>^<span class="number">48</span> + dq_leak) + k - <span class="number">1</span>          <span class="comment"># kq</span></span><br><span class="line">    f = inv * tmp^<span class="number">2</span> - k*tmp</span><br><span class="line">    f = f.monic()</span><br><span class="line">    x0 = f.small_roots(X=<span class="number">2</span>^<span class="number">464</span>,beta=<span class="number">1</span>,epsilon=<span class="number">0.09</span>)</span><br><span class="line">    <span class="keyword">return</span> x0</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">1</span>ï¼Œe):</span><br><span class="line">    x0 = coppersmith(k)</span><br><span class="line">    <span class="keyword">if</span> x0 != []:</span><br><span class="line">        dq = <span class="built_in">int</span>(x0[<span class="number">0</span>]) * <span class="number">2</span>^<span class="number">48</span> + dq_leak</span><br><span class="line">        q = (e*dq + k - <span class="number">1</span>) // k</span><br><span class="line">        <span class="comment"># print(f&quot;k = &#123;k&#125;&quot;)</span></span><br><span class="line">        <span class="comment"># k = 47794</span></span><br><span class="line">        p = n // q</span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="comment"># b&#x27;flag&#123;df4a4054-23eb-4ba4-be5e-15b247d7b819&#125;&#x27;</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://4xwi11.github.io/posts/9864757a/#%E8%A7%A3%E6%B3%95%E4%BA%8C">20220709-è“å¸½æ¯-CryptoSecWriteUp | 4XWi11â€™s Blog</a></p>
<p>åœ¨æ±‚å‡ºqåï¼Œå…¶å®<code>pow(c,dq,q)</code>ä¹Ÿèƒ½å‡ºflagï¼Œä¸ç”¨æ±‚p</p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------å·²ç»åˆ°åº•å•¦ï¼<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
      <a href="https://dexterjie.github.io/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/" title="2024CISCN">https://dexterjie.github.io/2024/05/18/èµ›é¢˜å¤ç°/2024CISCN/</a>
  </li>
  <li class="post-copyright-license">
      <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/05/12/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B/" rel="prev" title="ç¬¬äºŒå±Šé»„æ²³æµåŸŸç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ›">
                  <i class="fa fa-chevron-left"></i> ç¬¬äºŒå±Šé»„æ²³æµåŸŸç½‘ç»œå®‰å…¨æŠ€èƒ½æŒ‘æˆ˜èµ›
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/05/27/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024RCTF/" rel="next" title="2024RCTF">
                  2024RCTF <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">258k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">15:36</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="æ€»è®¿å®¢é‡">
    è®¿å®¢é‡<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="æ€»è®¿é—®é‡">
    ç»è¿‡<span id="busuanzi_value_site_pv"></span>æ¬¡å›çœ¸ä¸ä½ ç›¸é‡
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"è¯·æ–‡æ˜è¯„è®ºå‘€","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/05/18/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024CISCN/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
