<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录2024WMCTF——Crypto部分题解">
<meta property="og:type" content="article">
<meta property="og:title" content="2024WMCTF">
<meta property="og:url" content="https://dexterjie.github.io/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录2024WMCTF——Crypto部分题解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/9-7-1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/9-7-2.png">
<meta property="article:published_time" content="2024-09-17T01:42:56.000Z">
<meta property="article:modified_time" content="2025-10-07T02:42:08.152Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/%E6%9D%82/9-7-1.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/","path":"2024/09/17/赛题复现/2024WMCTF/","title":"2024WMCTF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024WMCTF | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#K-Cessation"><span class="nav-number">1.</span> <span class="nav-text">K-Cessation</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#FACRT"><span class="nav-number">2.</span> <span class="nav-text">FACRT</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RSA"><span class="nav-number">3.</span> <span class="nav-text">RSA</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024WMCTF | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024WMCTF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-17 09:42:56" itemprop="dateCreated datePublished" datetime="2024-09-17T09:42:56+08:00">2024-09-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-10-07 10:42:08" itemprop="dateModified" datetime="2025-10-07T10:42:08+08:00">2025-10-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>22 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录2024WMCTF——Crypto部分题解</p>
<span id="more"></span>

<h1 id="K-Cessation"><a href="#K-Cessation" class="headerlink" title="K-Cessation"></a>K-Cessation</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>,<span class="type">Union</span>,<span class="type">Literal</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> random,string,re</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">K_Cessation</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ## Background:</span></span><br><span class="line"><span class="string">    K-Cessation cipher is a cipher that uses a K bit wheel to pick the next cipher bit from plaintext bit.</span></span><br><span class="line"><span class="string">    When encryption starts, the wheel starts at the last bit of the wheel.</span></span><br><span class="line"><span class="string">    The wheel loops around when it reaches the end.</span></span><br><span class="line"><span class="string">    For every plaintext bit, the wheel is rotated to the next bit in the wheel that matches the plaintext bit, and the distance rotated is appended to the ciphertext.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Therefore, if the wheel is not known, it is not possible to decrypt the ciphertext. </span></span><br><span class="line"><span class="string">    Or is it?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ## Example:</span></span><br><span class="line"><span class="string">    To encode &quot;youtu.be/dQw4w9WgXcQ&quot; in 64-Cessation with the wheel 1100011011100011100110100011110110010110010100001011111011111010:</span></span><br><span class="line"><span class="string">    1. convert the plaintext to bits: 01111001 01101111 01110101 01110100 01110101 00101110 01100010 01100101 00101111 01100100 01010001 01110111 00110100 01110111 00111001 01010111 01100111 01011000 01100011 01010001</span></span><br><span class="line"><span class="string">    2. from wheel[-1] to the next &quot;0&quot; bit in the wheel, distance is 3, the current wheel position is wheel[2]</span></span><br><span class="line"><span class="string">    3. from wheel[2] to the next &quot;1&quot; bit in the wheel, distance is 3, the current wheel position is wheel[5]</span></span><br><span class="line"><span class="string">    4. repeat the steps until all bits is encoded</span></span><br><span class="line"><span class="string">    5. the result is 3312121232111411211311221152515233123332223411313221112161142123243321244111111311111112111131113211132412111212112112321122115251142114213312132313311222111112</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ## Challenge:</span></span><br><span class="line"><span class="string">    A flag is encoded with 64-Cessation cipher. </span></span><br><span class="line"><span class="string">    The wheel is not known. </span></span><br><span class="line"><span class="string">    The ciphertext is given in ciphertext.txt.</span></span><br><span class="line"><span class="string">    The flag is only known to be an ascii string that is longer than 64 characters. </span></span><br><span class="line"><span class="string">    No part of the flag is known, which means the flag is NOT in WMCTF&#123;&#125; or FLAG&#123;&#125; format.</span></span><br><span class="line"><span class="string">    When submitting, please make the flag in WMCTF&#123;&#125; format.</span></span><br><span class="line"><span class="string">    The most significant bit of each byte is flipped with a random bit.</span></span><br><span class="line"><span class="string">    You need to extract the flag from the ciphertext and submit it.</span></span><br><span class="line"><span class="string">    For your convenience, a salted sha256 hash of the flag is given in flag_hash.txt.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__is_valid_wheel</span>(<span class="params">self</span>):</span><br><span class="line">        hasZero = <span class="literal">False</span></span><br><span class="line">        hasOne = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.wheel:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(i,<span class="built_in">int</span>):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;Wheel must be a list of int&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                hasZero = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">1</span>:</span><br><span class="line">                hasOne = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">1</span> <span class="keyword">or</span> i &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;Wheel must be a list of 0s and 1s&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasZero <span class="keyword">or</span> <span class="keyword">not</span> hasOne:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Wheel must contain at least one 0 and one 1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,wheel:<span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">        self.wheel = wheel</span><br><span class="line">        self.__is_valid_wheel()</span><br><span class="line">        self.state = -<span class="number">1</span></span><br><span class="line">        self.finalized = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__find_next_in_wheel</span>(<span class="params">self,target:<span class="type">Literal</span>[<span class="number">1</span>,<span class="number">0</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        result = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            ptr = self.state + result</span><br><span class="line">            ptr = ptr % <span class="built_in">len</span>(self.wheel)</span><br><span class="line">            v = self.wheel[ptr]</span><br><span class="line">            <span class="keyword">if</span> v == target:</span><br><span class="line">                self.state = ptr</span><br><span class="line">                <span class="keyword">return</span> [result]</span><br><span class="line">            result+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter_bits</span>(<span class="params">self,data:<span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">yield</span> (b &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__check_finalized</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.finalized:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;This instance has already been finalized&quot;</span>)</span><br><span class="line">        self.finalized = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self,data:<span class="type">Union</span>[<span class="built_in">str</span>,<span class="built_in">bytes</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        self.__check_finalized()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(data,<span class="built_in">str</span>):</span><br><span class="line">            data = data.encode()</span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> self.__iter_bits(data):</span><br><span class="line">            rs = self.__find_next_in_wheel(bit)</span><br><span class="line">            <span class="comment"># print(f&quot;bit=&#123;bit&#125;,rs=&#123;rs&#125;,state=&#123;self.state&#125;&quot;)</span></span><br><span class="line">            out.extend(rs)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self,data:<span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        self.__check_finalized()</span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">type</span>(i) == <span class="built_in">int</span></span><br><span class="line">            self.state = self.state + i</span><br><span class="line">            self.state %= <span class="built_in">len</span>(self.wheel)</span><br><span class="line">            out.append(self.wheel[self.state])</span><br><span class="line">        long = <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,out))</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">int</span>(long,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate a random wheel with k bits.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_wheel</span>(<span class="params">k=<span class="number">64</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="keyword">return</span> [secrets.randbelow(<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># the most significant bit of each byte is flipped with a random bit.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_ascii_with_random_msb</span>(<span class="params">data:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">assert</span> b &lt; <span class="number">128</span>, <span class="string">&quot;not ascii&quot;</span></span><br><span class="line">        b = b ^ (<span class="number">0b10000000</span> * secrets.randbelow(<span class="number">2</span>))</span><br><span class="line">        out.append(b)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># for your convenience, here is the decoding function.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_ascii_with_random_msb</span>(<span class="params">data:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        b = b &amp; <span class="number">0b01111111</span></span><br><span class="line">        out.append(b)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">        <span class="keyword">from</span> flag <span class="keyword">import</span> wheel</span><br><span class="line">    <span class="keyword">except</span> ImportError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;flag.py not found, using test flag&quot;</span>)</span><br><span class="line">        flag = <span class="string">&quot;THIS_IS_TEST_FLAG_WHEN_YOU_HEAR_THE_BUZZER_LOOK_AT_THE_FLAG_BEEEP&quot;</span></span><br><span class="line">        wheel = random_wheel(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># wheel is wheel and 64 bits</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">type</span>(wheel) == <span class="built_in">list</span> <span class="keyword">and</span> <span class="built_in">len</span>(wheel) == <span class="number">64</span> <span class="keyword">and</span> <span class="built_in">all</span>((i <span class="keyword">in</span> [<span class="number">0</span>,<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> wheel))</span><br><span class="line">    <span class="comment"># flag is flag and string</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">type</span>(flag) == <span class="built_in">str</span></span><br><span class="line">    <span class="comment"># flag is ascii</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">all</span>((<span class="built_in">ord</span>(c) &lt; <span class="number">128</span> <span class="keyword">for</span> c <span class="keyword">in</span> flag))</span><br><span class="line">    <span class="comment"># flag is long</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(flag) &gt; <span class="number">64</span></span><br><span class="line">    <span class="comment"># flag does not start with wmctf&#123; nor does it end with &#125;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="keyword">not</span> flag.lower().startswith(<span class="string">&quot;wmctf&#123;&quot;</span>) <span class="keyword">and</span> <span class="keyword">not</span> flag.endswith(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">    <span class="comment"># flag also does not start with flag&#123;</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="keyword">not</span> flag.lower().startswith(<span class="string">&quot;flag&#123;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the most significant bit of each byte is flipped with a random bit.</span></span><br><span class="line">    plaintext = encode_ascii_with_random_msb(flag.encode())</span><br><span class="line"></span><br><span class="line">    c = K_Cessation(wheel)</span><br><span class="line">    ct = c.encrypt(plaintext)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ciphertext.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(ct))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    <span class="comment"># for you can verify the correctness of your decryption.</span></span><br><span class="line">    <span class="comment"># or you can brute force the flag hash, it is just a &gt;64 length string :)</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag_hash.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        salt = secrets.token_bytes(<span class="number">16</span>).<span class="built_in">hex</span>()</span><br><span class="line">        h = hashlib.sha256((salt + flag).encode()).hexdigest()</span><br><span class="line">        f.write(h + <span class="string">&quot;:&quot;</span> + salt)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># demostration that decryption works</span></span><br><span class="line">    c = K_Cessation(wheel)</span><br><span class="line">    pt = c.decrypt(ct)</span><br><span class="line">    pt = decode_ascii_with_random_msb(pt)</span><br><span class="line">    <span class="built_in">print</span>(pt)</span><br><span class="line">    <span class="keyword">assert</span> flag.encode() <span class="keyword">in</span> pt</span><br></pre></td></tr></table></figure>

<p>根据密文的值，我们可以判断出轮子中部分位置的值是相反的。比如密文第一个值是2，那么说明wheel中第一位和第二位不同</p>
<p>密文第4个值是3，说明wheel中第5，6位和第七位不同。根据这些约束，我们可以解方程得到wheel</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ct = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">X_64 = BooleanPolynomialRing(<span class="number">64</span>, [<span class="string">f&quot;x<span class="subst">&#123;i&#125;</span>&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)])</span><br><span class="line">Xs = <span class="built_in">list</span>(X_64.gens())</span><br><span class="line">eqs = []</span><br><span class="line">begin = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ct:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> j == i-<span class="number">2</span>:</span><br><span class="line">            eq = Xs[(begin + j) % <span class="number">64</span>] + Xs[(begin + j + <span class="number">1</span>) % <span class="number">64</span>] + <span class="number">1</span></span><br><span class="line">            eqs.append(eq)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            eq = Xs[(begin + j) % <span class="number">64</span>] + Xs[(begin + j + <span class="number">1</span>) % <span class="number">64</span>]</span><br><span class="line">            eqs.append(eq)</span><br><span class="line">    begin += i</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> eqs:</span><br><span class="line">    s = []</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Xs)):</span><br><span class="line">        <span class="keyword">if</span> Xs[x] <span class="keyword">in</span> i:</span><br><span class="line">            s.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s.append(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;+ 1&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(i):</span><br><span class="line">        B.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        B.append(<span class="number">0</span>)</span><br><span class="line">    m.append(s)</span><br><span class="line">m = matrix(GF(<span class="number">2</span>), m)</span><br><span class="line">B = vector(GF(<span class="number">2</span>), B)</span><br><span class="line"></span><br><span class="line">particular_solution = m.solve_right(B)</span><br><span class="line">homogeneous_solutions = m.right_kernel().basis()</span><br><span class="line">solution_set = [particular_solution + h <span class="keyword">for</span> h <span class="keyword">in</span> homogeneous_solutions]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(solution_set)</span><br><span class="line"><span class="comment"># [(0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1), (1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0)]</span></span><br></pre></td></tr></table></figure>

<p>把所有的解都弄出来尝试解密。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>,<span class="type">Union</span>,<span class="type">Literal</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> random,string,re</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">K_Cessation</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    ## Background:</span></span><br><span class="line"><span class="string">    K-Cessation cipher is a cipher that uses a K bit wheel to pick the next cipher bit from plaintext bit.</span></span><br><span class="line"><span class="string">    When encryption starts, the wheel starts at the last bit of the wheel.</span></span><br><span class="line"><span class="string">    The wheel loops around when it reaches the end.</span></span><br><span class="line"><span class="string">    For every plaintext bit, the wheel is rotated to the next bit in the wheel that matches the plaintext bit, and the distance rotated is appended to the ciphertext.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Therefore, if the wheel is not known, it is not possible to decrypt the ciphertext. </span></span><br><span class="line"><span class="string">    Or is it?</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    ## Example:</span></span><br><span class="line"><span class="string">    To encode &quot;youtu.be/dQw4w9WgXcQ&quot; in 64-Cessation with the wheel 1100011011100011100110100011110110010110010100001011111011111010:</span></span><br><span class="line"><span class="string">    1. convert the plaintext to bits: 01111001 01101111 01110101 01110100 01110101 00101110 01100010 01100101 00101111 01100100 01010001 01110111 00110100 01110111 00111001 01010111 01100111 01011000 01100011 01010001</span></span><br><span class="line"><span class="string">    2. from wheel[-1] to the next &quot;0&quot; bit in the wheel, distance is 3, the current wheel position is wheel[2]</span></span><br><span class="line"><span class="string">    3. from wheel[2] to the next &quot;1&quot; bit in the wheel, distance is 3, the current wheel position is wheel[5]</span></span><br><span class="line"><span class="string">    4. repeat the steps until all bits is encoded</span></span><br><span class="line"><span class="string">    5. the result is 3312121232111411211311221152515233123332223411313221112161142123243321244111111311111112111131113211132412111212112112321122115251142114213312132313311222111112</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ## Challenge:</span></span><br><span class="line"><span class="string">    A flag is encoded with 64-Cessation cipher. </span></span><br><span class="line"><span class="string">    The wheel is not known. </span></span><br><span class="line"><span class="string">    The ciphertext is given in ciphertext.txt.</span></span><br><span class="line"><span class="string">    The flag is only known to be an ascii string that is longer than 64 characters. </span></span><br><span class="line"><span class="string">    No part of the flag is known, which means the flag is NOT in WMCTF&#123;&#125; or FLAG&#123;&#125; format.</span></span><br><span class="line"><span class="string">    When submitting, please make the flag in WMCTF&#123;&#125; format.</span></span><br><span class="line"><span class="string">    The most significant bit of each byte is flipped with a random bit.</span></span><br><span class="line"><span class="string">    You need to extract the flag from the ciphertext and submit it.</span></span><br><span class="line"><span class="string">    For your convenience, a salted sha256 hash of the flag is given in flag_hash.txt.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__is_valid_wheel</span>(<span class="params">self</span>):</span><br><span class="line">        hasZero = <span class="literal">False</span></span><br><span class="line">        hasOne = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> self.wheel:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(i,<span class="built_in">int</span>):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;Wheel must be a list of int&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                hasZero = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="number">1</span>:</span><br><span class="line">                hasOne = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">1</span> <span class="keyword">or</span> i &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;Wheel must be a list of 0s and 1s&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> hasZero <span class="keyword">or</span> <span class="keyword">not</span> hasOne:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Wheel must contain at least one 0 and one 1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,wheel:<span class="type">List</span>[<span class="built_in">int</span>]</span>):</span><br><span class="line">        self.wheel = wheel</span><br><span class="line">        self.__is_valid_wheel()</span><br><span class="line">        self.state = -<span class="number">1</span></span><br><span class="line">        self.finalized = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__find_next_in_wheel</span>(<span class="params">self,target:<span class="type">Literal</span>[<span class="number">1</span>,<span class="number">0</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        result = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            ptr = self.state + result</span><br><span class="line">            ptr = ptr % <span class="built_in">len</span>(self.wheel)</span><br><span class="line">            v = self.wheel[ptr]</span><br><span class="line">            <span class="keyword">if</span> v == target:</span><br><span class="line">                self.state = ptr</span><br><span class="line">                <span class="keyword">return</span> [result]</span><br><span class="line">            result+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter_bits</span>(<span class="params">self,data:<span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">yield</span> (b &gt;&gt; i) &amp; <span class="number">1</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__check_finalized</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.finalized:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;This instance has already been finalized&quot;</span>)</span><br><span class="line">        self.finalized = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self,data:<span class="type">Union</span>[<span class="built_in">str</span>,<span class="built_in">bytes</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        self.__check_finalized()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(data,<span class="built_in">str</span>):</span><br><span class="line">            data = data.encode()</span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> self.__iter_bits(data):</span><br><span class="line">            rs = self.__find_next_in_wheel(bit)</span><br><span class="line">            <span class="comment"># print(f&quot;bit=&#123;bit&#125;,rs=&#123;rs&#125;,state=&#123;self.state&#125;&quot;)</span></span><br><span class="line">            out.extend(rs)</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self,data:<span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        self.__check_finalized()</span><br><span class="line">        out = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">type</span>(i) == <span class="built_in">int</span></span><br><span class="line">            self.state = self.state + i</span><br><span class="line">            self.state %= <span class="built_in">len</span>(self.wheel)</span><br><span class="line">            out.append(self.wheel[self.state])</span><br><span class="line">        long = <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,out))</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">int</span>(long,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># generate a random wheel with k bits.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_wheel</span>(<span class="params">k=<span class="number">64</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="keyword">return</span> [secrets.randbelow(<span class="number">2</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># the most significant bit of each byte is flipped with a random bit.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_ascii_with_random_msb</span>(<span class="params">data:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">assert</span> b &lt; <span class="number">128</span>, <span class="string">&quot;not ascii&quot;</span></span><br><span class="line">        b = b ^ (<span class="number">0b10000000</span> * secrets.randbelow(<span class="number">2</span>))</span><br><span class="line">        out.append(b)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line"><span class="comment"># for your convenience, here is the decoding function.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_ascii_with_random_msb</span>(<span class="params">data:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    out = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        b = b &amp; <span class="number">0b01111111</span></span><br><span class="line">        out.append(b)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line">ct = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">wheels = [(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> wheel <span class="keyword">in</span> wheels:</span><br><span class="line">    c = K_Cessation(wheel)</span><br><span class="line">    pt = c.decrypt(ct)</span><br><span class="line">    pt = decode_ascii_with_random_msb(pt)</span><br><span class="line">    <span class="built_in">print</span>(pt)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">b&#x27;;\x10\n\x1d\x13\x1a*\x12&lt;\x0b9$,LL4N18 \x0b\r\nH\x17RH\x17L \x08N\x0cLR\x19N\x11\x1b N\x11JH\x1aK\x1bRNH\x0c \x0f\rO\x19O\n\x11\x1bRK\x1dJ\x1a\x11\x1c\x1a \x11O\x08R\x18O \x0cO\x13\tLR\x0b\x17L L\x06L\x0cRN\x11 1O\x16\x0b\x1e&quot;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;DoubleUmCtF[S33K1NG_tru7h-7h3_w1s3-f1nd_1n57e4d-17s_pr0f0und-4b5ence_n0w-g0_s0lv3-th3_3y3s-1n_N0ita]&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>flag:<code>WMCTF&#123;S33K1NG_tru7h-7h3_w1s3-f1nd_1n57e4d-17s_pr0f0und-4b5ence_n0w-g0_s0lv3-th3_3y3s-1n_N0ita&#125;</code></p>
<h1 id="FACRT"><a href="#FACRT" class="headerlink" title="FACRT"></a>FACRT</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">Count=<span class="number">20</span></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">d=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp=d%(p-<span class="number">1</span>)</span><br><span class="line">dq=d%(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">flag=bytes_to_long(flag)</span><br><span class="line">length=flag.bit_length()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;length=<span class="subst">&#123;length&#125;</span>&quot;</span>)</span><br><span class="line">m=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Count):</span><br><span class="line">    m.append(getPrime(length))</span><br><span class="line">sq=[]</span><br><span class="line">sq_=[]</span><br><span class="line">sp=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Count):</span><br><span class="line">    sq.append(<span class="built_in">pow</span>(m[i],dq,q))</span><br><span class="line">    sq_.append(<span class="built_in">int</span>(<span class="string">&#x27;0&#x27;</span>*<span class="number">32</span>+<span class="built_in">bin</span>(<span class="built_in">pow</span>(m[i],dq,q))[<span class="number">2</span>:][<span class="number">32</span>:],<span class="number">2</span>))</span><br><span class="line">    sp.append(<span class="built_in">pow</span>(m[i], dp, p))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Count):</span><br><span class="line">    <span class="keyword">assert</span> sq_[i] &lt; q / <span class="number">32</span></span><br><span class="line">iq=inverse(q,p)</span><br><span class="line">s=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Count):</span><br><span class="line">    s.append(<span class="built_in">int</span>(sq_[i]+q*(((sp[i]-sq[i])*iq)%p)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;s=<span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;<span class="built_in">pow</span>(flag,e,n)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n=147633197136297320644148532167800594954463904917041365729781214689541810163409922050566363432759473356227399211204573839844534932354354132513677032099679754947582227369942835464578888307376910610182166537589845612944804885745392209830996561055058293663757559573736079810999615542354866920007861214183738025983</span></span><br><span class="line"><span class="string">length=455</span></span><br><span class="line"><span class="string">s=[135516280150137458535561766358086896198348823398876741567317041366935426854394060237235814065881756890818477438426875999503748746848408802883160976139168309216479723387043154316328752466115337006276833313025698482591954333004698732007362032602920842020200559463427548622804767419825141012760232500564198606888, 87138950331850035073233755923193357352015776817591237970872234630746818824503152055070348052111940612563932340910671611099400897135890145261451245577578879099083666861166614841834235097485990689182812564858373409987914436273165881047892580175317423057893816031028632720419872660582122916390309733324086153485, 138644295462947977586933469377687701489914340911921767410183452121042506019270712424245627451242649429408423057598802920666169608453899414528460692023716837136269325732757807484480055069814533664161537001762727348850128480964361110794017997076616622537153343830644577017008185863066319652708947485342513469942, 130919765117872700420555258668777170220585743300145967201676029268553369762501611700891574139388115937578229121079450407536963982339229719500478504489500235690293048515731859346431065030206394207045994366861194654126521065191859763903957682731311119322278004810859526215299984270862147897660764896871931296525, 114700370393183453087762195804219894122789831440066263230660331964018561704119945094712846882622289910478787117536755419287483635582978440493028286129198190921201156025431173751752743507530849046089710840106416071119787801330709608148349917138686962228418379795866832374558526179470426187199100866047189895398, 5526726757049511570122924251009639296817346269475117861098612689025237993752241296662636520025051472762072465223105287132204748691454643208692589407448303681720594661639751550346640974853714675951318971703834962983574657923366839131735681149307918005820142824780727533061358686675519367812942183782965460156, 144912005915009185433389709621768898379612902758176190094171990137016617813547436225820194585543950753591409962313416349983080186189291716456666174265994068233652987757656436662736504159419091874803636330149391525094620604417895137599924048423029008070688563937967247938795175561463188529887593887274447829757, 136250954616195732816473240575012270303125387854617764474032021538389021573726037002975200362404464882071072085887627232185387656472286476406393582907753248439212389626213347657516288312775908225085848334636924022113242155272938168661245231559256589332709251562390352253724058379737367174585436687621017694623, 62581851774850409035755528242738381905999051352008432547471965980273593728343556710086776830920012955472867109461528976241913935857428013748626805913556479910568244555311572298067590116614399220857206962127377751825672045446525674748896825242976163703599291103837976885179955618472741727241520609778322846005, 145854407984474847551927547284413490204495969306617565827750995876170774717809213321826036612782367152524129825636642176629348378245478404356883485091652713207020554564450132585121134356935492165152072283066165961023761302228624528890490009909363984222514631061033009247208437816124596049012309910840440309561, 124551623006909497965848991707513696948607938882176233365140848984406516643540438381538258922460588883294565931391660391812373244670311091543926813390568684148523894758100116918211999135492588543339785067482674405654655248001114133508625872962520401753384795662160688811171758878041475228921004115541651588149, 15938340419155549703292732921378484283671988749432038679365417994992859057494159116052524559743521485794692543381549875094855921795753932087886980295291140542937847588182771711846510176440458231173636452634043298156122152860644504752015830250690063832495966826188439527832958662817314634043438801092078111173, 86793422805279107846504839960808639992922541788273836408000957039906527697664805903722395255793430323591730573513732464380853123117859130756589515125491536316134863620706530836481623063642225089209431819777355554001327119466306759145993282751212553582691384017307673738794439532271560215747589628721710135897, 108675608374666743358023889479027512878400550037574532652565479774965642002565282273742545254311704772402696446846722391711332035309818100961301897022556307435354059324998874351394451945385491984524729822436607930537193897390621277431306545936473390631504396022406944910561421866589605078829721977335264154976, 87317748227288225233288224866786892964848811364878121564104341670954340348393418506174791619641614941888448848731903276361744955803183864888079233767189621441829023235771802783069311610169253651371628757455646066049167648114996530344278325612462268009587440597096690136975144034630898406289420602499264991623, 56652314874573546743584841968373113846850609963672297223607913939552862285375621862172324584570593402935091802803893885963277174956979046479939956703429737288793705461324779449285529662821030340203158503181009684937887687542388010343147675680002397630598445715400876202643169104742361423214638787268742234287, 98735788313453186782519834728824046613708479524564270665693218086798600541964070362862728960696910092702768075145925801913657156092005722008779014906938783990621453314812381950847944890837178907520481282447677162465215252648603374266972153988621533116563623242402366677831684416116807732808111964626488086987, 127540651954215161413641876933455408716614015796900097859173650400979733321781230732298931541274922911072112231027539634566966261240603321076224739659191443221985808678247919491141075440774231707687287562522535460013252508304387645505398442899700006526196099765002065480554613895222880144277349674640005507562, 133301958266564440496259158450519409455902192149222024966338884662576908051145274628854034018802181764563054480089111531034013218222971811942750317186820576575720998626362983321816936975595432624528396429872313110972358282919447478636004224335379606216720361742943716434992065840043748957089654449955193986860, 88160039502967812710045720428993741346375421128152598672398002732708719698481663322248764249302216242451840620334870977104442381110519298390156672581547539043729567682679341598750864890008905914145991583715826910836568061276943119691386206504777140515604809396852491015959654881350560399518061528959314304087]</span></span><br><span class="line"><span class="string">c=123907837039511977819816858353976764990739800475355111239750335121820426041872830656170595604631534502233882297517774737660499087852687022473212169680375890135271089504199640532421067201796868951827680690124297723304485612987566782809086630400500307531954278635605686302923551049889311808990254356288059153559</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>找到一篇名为Revisiting PACD-based Attacks on RSA-CRT的论文</p>
<p><img src="/../../images/%E6%9D%82/9-7-1.png"></p>
<p>根据论文的格实现攻击</p>
<p><img src="/../../images/%E6%9D%82/9-7-2.png"></p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">147633197136297320644148532167800594954463904917041365729781214689541810163409922050566363432759473356227399211204573839844534932354354132513677032099679754947582227369942835464578888307376910610182166537589845612944804885745392209830996561055058293663757559573736079810999615542354866920007861214183738025983</span></span><br><span class="line">length = <span class="number">455</span></span><br><span class="line">s = [<span class="number">135516280150137458535561766358086896198348823398876741567317041366935426854394060237235814065881756890818477438426875999503748746848408802883160976139168309216479723387043154316328752466115337006276833313025698482591954333004698732007362032602920842020200559463427548622804767419825141012760232500564198606888</span>, <span class="number">87138950331850035073233755923193357352015776817591237970872234630746818824503152055070348052111940612563932340910671611099400897135890145261451245577578879099083666861166614841834235097485990689182812564858373409987914436273165881047892580175317423057893816031028632720419872660582122916390309733324086153485</span>, <span class="number">138644295462947977586933469377687701489914340911921767410183452121042506019270712424245627451242649429408423057598802920666169608453899414528460692023716837136269325732757807484480055069814533664161537001762727348850128480964361110794017997076616622537153343830644577017008185863066319652708947485342513469942</span>, <span class="number">130919765117872700420555258668777170220585743300145967201676029268553369762501611700891574139388115937578229121079450407536963982339229719500478504489500235690293048515731859346431065030206394207045994366861194654126521065191859763903957682731311119322278004810859526215299984270862147897660764896871931296525</span>, <span class="number">114700370393183453087762195804219894122789831440066263230660331964018561704119945094712846882622289910478787117536755419287483635582978440493028286129198190921201156025431173751752743507530849046089710840106416071119787801330709608148349917138686962228418379795866832374558526179470426187199100866047189895398</span>, <span class="number">5526726757049511570122924251009639296817346269475117861098612689025237993752241296662636520025051472762072465223105287132204748691454643208692589407448303681720594661639751550346640974853714675951318971703834962983574657923366839131735681149307918005820142824780727533061358686675519367812942183782965460156</span>, <span class="number">144912005915009185433389709621768898379612902758176190094171990137016617813547436225820194585543950753591409962313416349983080186189291716456666174265994068233652987757656436662736504159419091874803636330149391525094620604417895137599924048423029008070688563937967247938795175561463188529887593887274447829757</span>, <span class="number">136250954616195732816473240575012270303125387854617764474032021538389021573726037002975200362404464882071072085887627232185387656472286476406393582907753248439212389626213347657516288312775908225085848334636924022113242155272938168661245231559256589332709251562390352253724058379737367174585436687621017694623</span>, <span class="number">62581851774850409035755528242738381905999051352008432547471965980273593728343556710086776830920012955472867109461528976241913935857428013748626805913556479910568244555311572298067590116614399220857206962127377751825672045446525674748896825242976163703599291103837976885179955618472741727241520609778322846005</span>, <span class="number">145854407984474847551927547284413490204495969306617565827750995876170774717809213321826036612782367152524129825636642176629348378245478404356883485091652713207020554564450132585121134356935492165152072283066165961023761302228624528890490009909363984222514631061033009247208437816124596049012309910840440309561</span>, <span class="number">124551623006909497965848991707513696948607938882176233365140848984406516643540438381538258922460588883294565931391660391812373244670311091543926813390568684148523894758100116918211999135492588543339785067482674405654655248001114133508625872962520401753384795662160688811171758878041475228921004115541651588149</span>, <span class="number">15938340419155549703292732921378484283671988749432038679365417994992859057494159116052524559743521485794692543381549875094855921795753932087886980295291140542937847588182771711846510176440458231173636452634043298156122152860644504752015830250690063832495966826188439527832958662817314634043438801092078111173</span>, <span class="number">86793422805279107846504839960808639992922541788273836408000957039906527697664805903722395255793430323591730573513732464380853123117859130756589515125491536316134863620706530836481623063642225089209431819777355554001327119466306759145993282751212553582691384017307673738794439532271560215747589628721710135897</span>, <span class="number">108675608374666743358023889479027512878400550037574532652565479774965642002565282273742545254311704772402696446846722391711332035309818100961301897022556307435354059324998874351394451945385491984524729822436607930537193897390621277431306545936473390631504396022406944910561421866589605078829721977335264154976</span>, <span class="number">87317748227288225233288224866786892964848811364878121564104341670954340348393418506174791619641614941888448848731903276361744955803183864888079233767189621441829023235771802783069311610169253651371628757455646066049167648114996530344278325612462268009587440597096690136975144034630898406289420602499264991623</span>, <span class="number">56652314874573546743584841968373113846850609963672297223607913939552862285375621862172324584570593402935091802803893885963277174956979046479939956703429737288793705461324779449285529662821030340203158503181009684937887687542388010343147675680002397630598445715400876202643169104742361423214638787268742234287</span>, <span class="number">98735788313453186782519834728824046613708479524564270665693218086798600541964070362862728960696910092702768075145925801913657156092005722008779014906938783990621453314812381950847944890837178907520481282447677162465215252648603374266972153988621533116563623242402366677831684416116807732808111964626488086987</span>, <span class="number">127540651954215161413641876933455408716614015796900097859173650400979733321781230732298931541274922911072112231027539634566966261240603321076224739659191443221985808678247919491141075440774231707687287562522535460013252508304387645505398442899700006526196099765002065480554613895222880144277349674640005507562</span>, <span class="number">133301958266564440496259158450519409455902192149222024966338884662576908051145274628854034018802181764563054480089111531034013218222971811942750317186820576575720998626362983321816936975595432624528396429872313110972358282919447478636004224335379606216720361742943716434992065840043748957089654449955193986860</span>, <span class="number">88160039502967812710045720428993741346375421128152598672398002732708719698481663322248764249302216242451840620334870977104442381110519298390156672581547539043729567682679341598750864890008905914145991583715826910836568061276943119691386206504777140515604809396852491015959654881350560399518061528959314304087</span>]</span><br><span class="line">c = <span class="number">123907837039511977819816858353976764990739800475355111239750335121820426041872830656170595604631534502233882297517774737660499087852687022473212169680375890135271089504199640532421067201796868951827680690124297723304485612987566782809086630400500307531954278635605686302923551049889311808990254356288059153559</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,<span class="number">20</span>,<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    Ge[i,i] = -n</span><br><span class="line">    Ge[<span class="number">0</span>,i] = s[i]</span><br><span class="line">    </span><br><span class="line">Ge[<span class="number">0</span>,<span class="number">0</span>] = <span class="number">2</span>^<span class="number">480</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    q = (gmpy2.gcd(line[<span class="number">0</span>],line[<span class="number">2</span>]))</span><br><span class="line">    p = n // q</span><br><span class="line">    m = <span class="built_in">pow</span>(c,inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)),n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">    <span class="comment"># flag&#123;Th3_Simultaneous_Diophantine_Approximation_Approach&#125;</span></span><br></pre></td></tr></table></figure>

<p>flag:<code>WMCTF&#123;Th3_Simultaneous_Diophantine_Approximation_Approach&#125;</code></p>
<h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">M = matrix(Zmod(n), [</span><br><span class="line">    [m, -m-p-q, -m-<span class="number">2</span>*p, <span class="number">2</span>*q-m],</span><br><span class="line">    [m+p+q,  m, <span class="number">2</span>*q-m,  m+<span class="number">2</span>*p],</span><br><span class="line">    [m+<span class="number">2</span>*p,  m-<span class="number">2</span>*q,  m, -m-p-q],</span><br><span class="line">    [m-<span class="number">2</span>*q, -m-<span class="number">2</span>*p,  m+p+q,  m]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">enc = M**e</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(enc))</span><br><span class="line">n=<span class="number">13228298199631335610499409465400552275305629934024756614227830931136508640681372951453757994834844498763877490566164031828108583453919741685657210448857955666192855872103622943922893572765718705893238315297600050789804418329650168680719372191579207505092037294294875908952803670819999025123209403251314588474192758376162806705064430837428828805477906627599506069017651159117664246131790529354533675662936081996490294431369820750274303028529977278828959613343997326534446148884333619071935180484450320323844737055406889458275298296950269660857078186043669204168045730995355857013530919638304423700701901063780318208789</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">enc=[...]</span><br></pre></td></tr></table></figure>


<p>$$<br>M &#x3D; \begin{pmatrix}<br>m &amp; -m-p-q&amp;-m-2p&amp;2q-m\\<br>m+p+q&amp;m&amp;2q-m&amp;m+2p\\<br>m+2p&amp;m-2q&amp;m&amp;-m-p-q\\<br>m-2q&amp;-m-2p&amp;m+p+q&amp;m<br>\end{pmatrix}<br>$$</p>
<p>$$<br>C &#x3D; M^e<br>$$</p>
<p>把M化成Jordan型，存在P矩阵使得<br>$$<br>P^{-1}MP &#x3D; M_{jordan}<br>$$</p>
<p>$$<br>C \equiv (PM_{jordan}P^{-1})^{65537} \mod n<br>$$</p>
<p>$$<br>C \equiv PM_{jordan}^{65537}P^{-1} \mod n<br>$$</p>
<p>$$<br>CP \equiv PM_{jordan}^{65537} \mod n<br>$$</p>
<p>注意到$P$长这样<br>$$<br>P &#x3D; \begin{pmatrix}<br>1 &amp; 1 &amp; 1 &amp;1\\<br>0 &amp; 0 &amp; 0 &amp; 0\\<br>p_{2,0} &amp; p_{2,1} &amp; p_{2,2} &amp; p_{2,3}\\<br>p_{3,0} &amp; p_{3,1} &amp; p_{3,2} &amp; p_{3,3}\\<br>\end{pmatrix}<br>$$<br>P矩阵下面两行都是比较复杂的式子</p>
<p>那可以知道$CP$这个矩阵的第二行全是0</p>
<p>$$<br>CP &#x3D; \begin{pmatrix}<br>c_{0,0}&amp;c_{0,1} &amp;c_{0,2} &amp; c_{0,3}\\<br>c_{1,0}&amp;c_{1,1} &amp;c_{1,2} &amp; c_{1,3}\\<br>c_{2,0}&amp;c_{2,1} &amp;c_{2,2} &amp; c_{2,3}\\<br>c_{3,0}&amp;c_{3,1} &amp;c_{3,2} &amp; c_{3,3}\<br>\end{pmatrix}<br>\begin{pmatrix}<br>1 &amp; 1 &amp; 1 &amp;1\\<br>0 &amp; 0 &amp; 0 &amp; 0\\<br>p_{2,0} &amp; p_{2,1} &amp; p_{2,2} &amp; p_{2,3}\\<br>p_{3,0} &amp; p_{3,1} &amp; p_{3,2} &amp; p_{3,3}\<br>\end{pmatrix}<br>&#x3D;<br>\begin{pmatrix}<br>t_{0,0}&amp;t_{0,1} &amp;t_{0,2} &amp; t_{0,3}\\<br>0&amp;0&amp;0&amp;0\\<br>t_{2,0}&amp;t_{2,1} &amp;t_{2,2} &amp; t_{2,3}\\<br>t_{3,0}&amp;t_{3,1} &amp;t_{3,2} &amp; t_{3,3}\<br>\end{pmatrix}<br>$$</p>
<p>利用sagemath把第二行的值打印出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">13228298199631335610499409465400552275305629934024756614227830931136508640681372951453757994834844498763877490566164031828108583453919741685657210448857955666192855872103622943922893572765718705893238315297600050789804418329650168680719372191579207505092037294294875908952803670819999025123209403251314588474192758376162806705064430837428828805477906627599506069017651159117664246131790529354533675662936081996490294431369820750274303028529977278828959613343997326534446148884333619071935180484450320323844737055406889458275298296950269660857078186043669204168045730995355857013530919638304423700701901063780318208789</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = [...]</span><br><span class="line"></span><br><span class="line">m,p,q = var(<span class="string">&quot;m p q&quot;</span>)</span><br><span class="line"></span><br><span class="line">M = Matrix([</span><br><span class="line">    [m, -m-p-q, -m-<span class="number">2</span>*p, <span class="number">2</span>*q-m],</span><br><span class="line">    [m+p+q,  m, <span class="number">2</span>*q-m,  m+<span class="number">2</span>*p],</span><br><span class="line">    [m+<span class="number">2</span>*p,  m-<span class="number">2</span>*q,  m, -m-p-q],</span><br><span class="line">    [m-<span class="number">2</span>*q, -m-<span class="number">2</span>*p,  m+p+q,  m]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">M_Jor, P = M.jordan_form(transformation=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">C = Matrix(enc)</span><br><span class="line">Tmp = C * P</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实部</span></span><br><span class="line">f1 = Tmp[<span class="number">1</span>][<span class="number">0</span>].real().simplify()</span><br><span class="line"><span class="comment"># 虚部</span></span><br><span class="line">f2 = Tmp[<span class="number">1</span>][<span class="number">0</span>].imag().simplify()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f1)</span><br><span class="line"><span class="built_in">print</span>(f2)</span><br></pre></td></tr></table></figure>

<p>得到的值还是有点复杂</p>
<p>我们利用<code>factor(f1),factor(f2)</code>之后得到</p>
<p>实部:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>/<span class="number">2</span>*(<span class="number">17052685678039365270013190496832946145489532686813139436681089578815063755785409643085613503553322328467917636064547056454738567965386703908624012527031365247344488369836152611605160451744515518567219837090066720029021582070456558805601278690837844643268562196878579092551194141792712348605348322343228050741545344776716090210538284347791495687668816750212755678728525862290231697713904184274675956776869433417946196064261855983380873202924252325259311828108174084170721556701063654763472693089360654462799495747110428698600943282208665416086673092927590717594475387269370232970270383184853484202338342439437747977263</span>*m*sqrt(<span class="built_in">abs</span>(<span class="number">3</span>*m^<span class="number">2</span> + <span class="number">6</span>*m*p + <span class="number">5</span>*p^<span class="number">2</span> - <span class="number">2</span>*(m - p)*q + <span class="number">5</span>*q^<span class="number">2</span>))*cos(<span class="number">1</span>/<span class="number">2</span>*arctan2(<span class="number">0</span>, -<span class="number">3</span>*m^<span class="number">2</span> - <span class="number">6</span>*m*p - <span class="number">5</span>*p^<span class="number">2</span> + <span class="number">2</span>*(m - p)*q - <span class="number">5</span>*q^<span class="number">2</span>)) + <span class="number">23068797980682606520939695222878122197959337999989439659463060223100940821636820498796323501114581015229139528378476011747406619373674219012654711036679216185435206920458114821813684811803255215071210021993225524462202325898617081380757277198725994459984702472016033977488077163817512898930755857975634130292726390994608493384853082111236511030958876989952691833996481188400633235618992677715425955155661003765813385632286451112973798595901431845116019957199285671071239395739214529274342043100057378018195903606552798854032051006376267379308809102755448075675705613976371379827552646430651063130539035567468678816952</span>*p*sqrt(<span class="built_in">abs</span>(<span class="number">3</span>*m^<span class="number">2</span> + <span class="number">6</span>*m*p + <span class="number">5</span>*p^<span class="number">2</span> - <span class="number">2</span>*(m - p)*q + <span class="number">5</span>*q^<span class="number">2</span>))*cos(<span class="number">1</span>/<span class="number">2</span>*arctan2(<span class="number">0</span>, -<span class="number">3</span>*m^<span class="number">2</span> - <span class="number">6</span>*m*p - <span class="number">5</span>*p^<span class="number">2</span> + <span class="number">2</span>*(m - p)*q - <span class="number">5</span>*q^<span class="number">2</span>)) - <span class="number">11036573375396124019086685770787770093019727373636839213899118934529186689933998787374903505992063641706695743750618101162070516557099188804593314017383514309253769819214190401396636091685775822063229652186907915595840838242296036230445280182949694826552421921741124207614311119767911798279940786710821971190364298558823687036223486584346480344378756510472819523460570536179830159808815690833925958398077863070079006496237260853787947809947072805402603699017062497270203717662912780252603343078663930907403087887668058543169835558041063452864537083099733359513245160562369086112988119939055905274137649311406817137574</span>*q*sqrt(<span class="built_in">abs</span>(<span class="number">3</span>*m^<span class="number">2</span> + <span class="number">6</span>*m*p + <span class="number">5</span>*p^<span class="number">2</span> - <span class="number">2</span>*(m - p)*q + <span class="number">5</span>*q^<span class="number">2</span>))*cos(<span class="number">1</span>/<span class="number">2</span>*arctan2(<span class="number">0</span>, -<span class="number">3</span>*m^<span class="number">2</span> - <span class="number">6</span>*m*p - <span class="number">5</span>*p^<span class="number">2</span> + <span class="number">2</span>*(m - p)*q - <span class="number">5</span>*q^<span class="number">2</span>)) + <span class="number">22560657613978191375477017306509293966603093472162629514044986602824691581137520573628879186279837923450292843877114294489401932662806174310174535011834552453575619768167801524362710899553992664010513001245323140351297939039464273076188468633566862978692974707147660950346461885529480288581596435506812992993941532775791911128309535650765146800132045271805307465252696576252928039455244722474919107612539574517977159839835256103573993006377060019297877406788702675877424387498977689579664261693135390239437183436298614337177116319649815896196746861764980271198339158892140778622690348686160022060197178369707783596783</span>*m^<span class="number">2</span> + <span class="number">28068629549917017480940844116185641787716654257512119591408883626834319406489631504172144869006353518432668051689681532524065297360225644711725057496637739659806751166499450437120261347363469809453806165400579560673574296008471987346775658576295881314117387217416742808141729629266248228557844548670397935246337720774867732046080786953738797912595273793397859251776867290215624381196585260675162258448209715618008123615408656223767112809829867713336442985469231267584127218296891724395855830296910126016074871125486799975753289357090966376306820630602369824802202930514911324275110314187466559918056014299977819216303</span>*m*p + <span class="number">22052517247273776230014339390140465735246848944335819368626912982548442340638220648461434871445094831671446159375752577231397245951938129607694358986989888721716032615877488226911736987304730112949815980497420756240393552180311464771619660068407731497401246942279287923204846607241447678232437013037991855695156674556975328871765989190293782569305213553657923096508911964105222843291496767234412260069418145270140934047384061094174187416852688193479734856378119680683609379258740849884986480286213402460678463266044429820322181632923364413084684620774512466720972703807910177417828050941668980989855321171946888376614</span>*p^<span class="number">2</span> - <span class="number">50141776300709265519114215657761181973756109004785798019207121495892692786357629078921951880990480801846059539190917734848206330474424022320911685531404768278314290804927831239913533530735021453580265469774395391865255972493064059807666218942195270967222231060898991223370351868802071825117726122092041877627066317892515106118527760122431758601352786814343498298698008362575284700814216642343014175244365441758166136607883177931343008429724013324141650383503356262124534653622717284901062516454237987830881046900822917062092960473173093282035894796801836543828693251639649496501086554065578370466331312922791453491451</span>*m*q - <span class="number">34105371356078730540026380993665892290979065373626278873362179157630127511570819286171227007106644656935835272129094112909477135930773407817248025054062730494688976739672305223210320903489031037134439674180133440058043164140913117611202557381675689286537124393757158185102388283585424697210696644686456101483090689553432180421076568695582991375337633500425511357457051724580463395427808368549351913553738866835892392128523711966761746405848504650518623656216348168341443113402127309526945386178721308925598991494220857397201886564417330832173346185855181435188950774538740465940540766369706968404676684878875495954526</span>*p*q + <span class="number">10020292641987293728161329938050113630307238317983218923062971693976688208935398937040014876322577458149002374747894666646061143135363099399632961967694186845534595514633563806494688267187250719941835610691103147374032064523990419621307663052631431863968966392004378153331080563191846577581621941773179696592794582121190522523136393663403751882725093074178050785973001311884419767481319780352912263311835004574406554911334870834988336630898329153766318598195896506882573701182439100863247780264819955349885647547159689509459966184588160486640412601118797750558512250393907883703263524450073823133453934915885026697236</span>*q^<span class="number">2</span>)/(m^<span class="number">2</span> + <span class="number">2</span>*m*p + <span class="number">2</span>*p^<span class="number">2</span> - <span class="number">2</span>*m*q + <span class="number">2</span>*q^<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>提取出以下式子即可</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1 = <span class="number">17052685678039365270013190496832946145489532686813139436681089578815063755785409643085613503553322328467917636064547056454738567965386703908624012527031365247344488369836152611605160451744515518567219837090066720029021582070456558805601278690837844643268562196878579092551194141792712348605348322343228050741545344776716090210538284347791495687668816750212755678728525862290231697713904184274675956776869433417946196064261855983380873202924252325259311828108174084170721556701063654763472693089360654462799495747110428698600943282208665416086673092927590717594475387269370232970270383184853484202338342439437747977263</span>*m+<span class="number">23068797980682606520939695222878122197959337999989439659463060223100940821636820498796323501114581015229139528378476011747406619373674219012654711036679216185435206920458114821813684811803255215071210021993225524462202325898617081380757277198725994459984702472016033977488077163817512898930755857975634130292726390994608493384853082111236511030958876989952691833996481188400633235618992677715425955155661003765813385632286451112973798595901431845116019957199285671071239395739214529274342043100057378018195903606552798854032051006376267379308809102755448075675705613976371379827552646430651063130539035567468678816952</span>*p-<span class="number">11036573375396124019086685770787770093019727373636839213899118934529186689933998787374903505992063641706695743750618101162070516557099188804593314017383514309253769819214190401396636091685775822063229652186907915595840838242296036230445280182949694826552421921741124207614311119767911798279940786710821971190364298558823687036223486584346480344378756510472819523460570536179830159808815690833925958398077863070079006496237260853787947809947072805402603699017062497270203717662912780252603343078663930907403087887668058543169835558041063452864537083099733359513245160562369086112988119939055905274137649311406817137574</span>*q+<span class="number">22560657613978191375477017306509293966603093472162629514044986602824691581137520573628879186279837923450292843877114294489401932662806174310174535011834552453575619768167801524362710899553992664010513001245323140351297939039464273076188468633566862978692974707147660950346461885529480288581596435506812992993941532775791911128309535650765146800132045271805307465252696576252928039455244722474919107612539574517977159839835256103573993006377060019297877406788702675877424387498977689579664261693135390239437183436298614337177116319649815896196746861764980271198339158892140778622690348686160022060197178369707783596783</span>*m^<span class="number">2</span>+<span class="number">28068629549917017480940844116185641787716654257512119591408883626834319406489631504172144869006353518432668051689681532524065297360225644711725057496637739659806751166499450437120261347363469809453806165400579560673574296008471987346775658576295881314117387217416742808141729629266248228557844548670397935246337720774867732046080786953738797912595273793397859251776867290215624381196585260675162258448209715618008123615408656223767112809829867713336442985469231267584127218296891724395855830296910126016074871125486799975753289357090966376306820630602369824802202930514911324275110314187466559918056014299977819216303</span>*m*p+<span class="number">22052517247273776230014339390140465735246848944335819368626912982548442340638220648461434871445094831671446159375752577231397245951938129607694358986989888721716032615877488226911736987304730112949815980497420756240393552180311464771619660068407731497401246942279287923204846607241447678232437013037991855695156674556975328871765989190293782569305213553657923096508911964105222843291496767234412260069418145270140934047384061094174187416852688193479734856378119680683609379258740849884986480286213402460678463266044429820322181632923364413084684620774512466720972703807910177417828050941668980989855321171946888376614</span>*p^<span class="number">2</span>-<span class="number">50141776300709265519114215657761181973756109004785798019207121495892692786357629078921951880990480801846059539190917734848206330474424022320911685531404768278314290804927831239913533530735021453580265469774395391865255972493064059807666218942195270967222231060898991223370351868802071825117726122092041877627066317892515106118527760122431758601352786814343498298698008362575284700814216642343014175244365441758166136607883177931343008429724013324141650383503356262124534653622717284901062516454237987830881046900822917062092960473173093282035894796801836543828693251639649496501086554065578370466331312922791453491451</span>*m*q-<span class="number">34105371356078730540026380993665892290979065373626278873362179157630127511570819286171227007106644656935835272129094112909477135930773407817248025054062730494688976739672305223210320903489031037134439674180133440058043164140913117611202557381675689286537124393757158185102388283585424697210696644686456101483090689553432180421076568695582991375337633500425511357457051724580463395427808368549351913553738866835892392128523711966761746405848504650518623656216348168341443113402127309526945386178721308925598991494220857397201886564417330832173346185855181435188950774538740465940540766369706968404676684878875495954526</span>*p*q+<span class="number">10020292641987293728161329938050113630307238317983218923062971693976688208935398937040014876322577458149002374747894666646061143135363099399632961967694186845534595514633563806494688267187250719941835610691103147374032064523990419621307663052631431863968966392004378153331080563191846577581621941773179696592794582121190522523136393663403751882725093074178050785973001311884419767481319780352912263311835004574406554911334870834988336630898329153766318598195896506882573701182439100863247780264819955349885647547159689509459966184588160486640412601118797750558512250393907883703263524450073823133453934915885026697236</span>*q^<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>虚部:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f2 = <span class="number">17052685678039365270013190496832946145489532686813139436681089578815063755785409643085613503553322328467917636064547056454738567965386703908624012527031365247344488369836152611605160451744515518567219837090066720029021582070456558805601278690837844643268562196878579092551194141792712348605348322343228050741545344776716090210538284347791495687668816750212755678728525862290231697713904184274675956776869433417946196064261855983380873202924252325259311828108174084170721556701063654763472693089360654462799495747110428698600943282208665416086673092927590717594475387269370232970270383184853484202338342439437747977263</span>*m+<span class="number">23068797980682606520939695222878122197959337999989439659463060223100940821636820498796323501114581015229139528378476011747406619373674219012654711036679216185435206920458114821813684811803255215071210021993225524462202325898617081380757277198725994459984702472016033977488077163817512898930755857975634130292726390994608493384853082111236511030958876989952691833996481188400633235618992677715425955155661003765813385632286451112973798595901431845116019957199285671071239395739214529274342043100057378018195903606552798854032051006376267379308809102755448075675705613976371379827552646430651063130539035567468678816952</span>*p-<span class="number">11036573375396124019086685770787770093019727373636839213899118934529186689933998787374903505992063641706695743750618101162070516557099188804593314017383514309253769819214190401396636091685775822063229652186907915595840838242296036230445280182949694826552421921741124207614311119767911798279940786710821971190364298558823687036223486584346480344378756510472819523460570536179830159808815690833925958398077863070079006496237260853787947809947072805402603699017062497270203717662912780252603343078663930907403087887668058543169835558041063452864537083099733359513245160562369086112988119939055905274137649311406817137574</span>*q</span><br></pre></td></tr></table></figure>

<p>这里两个式子再利用上$p\times q &#x3D;n$，用gb基可以解出m,p,q</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">13228298199631335610499409465400552275305629934024756614227830931136508640681372951453757994834844498763877490566164031828108583453919741685657210448857955666192855872103622943922893572765718705893238315297600050789804418329650168680719372191579207505092037294294875908952803670819999025123209403251314588474192758376162806705064430837428828805477906627599506069017651159117664246131790529354533675662936081996490294431369820750274303028529977278828959613343997326534446148884333619071935180484450320323844737055406889458275298296950269660857078186043669204168045730995355857013530919638304423700701901063780318208789</span></span><br><span class="line">R.&lt;m,p,q&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f1 = <span class="number">17052685678039365270013190496832946145489532686813139436681089578815063755785409643085613503553322328467917636064547056454738567965386703908624012527031365247344488369836152611605160451744515518567219837090066720029021582070456558805601278690837844643268562196878579092551194141792712348605348322343228050741545344776716090210538284347791495687668816750212755678728525862290231697713904184274675956776869433417946196064261855983380873202924252325259311828108174084170721556701063654763472693089360654462799495747110428698600943282208665416086673092927590717594475387269370232970270383184853484202338342439437747977263</span>*m+<span class="number">23068797980682606520939695222878122197959337999989439659463060223100940821636820498796323501114581015229139528378476011747406619373674219012654711036679216185435206920458114821813684811803255215071210021993225524462202325898617081380757277198725994459984702472016033977488077163817512898930755857975634130292726390994608493384853082111236511030958876989952691833996481188400633235618992677715425955155661003765813385632286451112973798595901431845116019957199285671071239395739214529274342043100057378018195903606552798854032051006376267379308809102755448075675705613976371379827552646430651063130539035567468678816952</span>*p-<span class="number">11036573375396124019086685770787770093019727373636839213899118934529186689933998787374903505992063641706695743750618101162070516557099188804593314017383514309253769819214190401396636091685775822063229652186907915595840838242296036230445280182949694826552421921741124207614311119767911798279940786710821971190364298558823687036223486584346480344378756510472819523460570536179830159808815690833925958398077863070079006496237260853787947809947072805402603699017062497270203717662912780252603343078663930907403087887668058543169835558041063452864537083099733359513245160562369086112988119939055905274137649311406817137574</span>*q+<span class="number">22560657613978191375477017306509293966603093472162629514044986602824691581137520573628879186279837923450292843877114294489401932662806174310174535011834552453575619768167801524362710899553992664010513001245323140351297939039464273076188468633566862978692974707147660950346461885529480288581596435506812992993941532775791911128309535650765146800132045271805307465252696576252928039455244722474919107612539574517977159839835256103573993006377060019297877406788702675877424387498977689579664261693135390239437183436298614337177116319649815896196746861764980271198339158892140778622690348686160022060197178369707783596783</span>*m^<span class="number">2</span>+<span class="number">28068629549917017480940844116185641787716654257512119591408883626834319406489631504172144869006353518432668051689681532524065297360225644711725057496637739659806751166499450437120261347363469809453806165400579560673574296008471987346775658576295881314117387217416742808141729629266248228557844548670397935246337720774867732046080786953738797912595273793397859251776867290215624381196585260675162258448209715618008123615408656223767112809829867713336442985469231267584127218296891724395855830296910126016074871125486799975753289357090966376306820630602369824802202930514911324275110314187466559918056014299977819216303</span>*m*p+<span class="number">22052517247273776230014339390140465735246848944335819368626912982548442340638220648461434871445094831671446159375752577231397245951938129607694358986989888721716032615877488226911736987304730112949815980497420756240393552180311464771619660068407731497401246942279287923204846607241447678232437013037991855695156674556975328871765989190293782569305213553657923096508911964105222843291496767234412260069418145270140934047384061094174187416852688193479734856378119680683609379258740849884986480286213402460678463266044429820322181632923364413084684620774512466720972703807910177417828050941668980989855321171946888376614</span>*p^<span class="number">2</span>-<span class="number">50141776300709265519114215657761181973756109004785798019207121495892692786357629078921951880990480801846059539190917734848206330474424022320911685531404768278314290804927831239913533530735021453580265469774395391865255972493064059807666218942195270967222231060898991223370351868802071825117726122092041877627066317892515106118527760122431758601352786814343498298698008362575284700814216642343014175244365441758166136607883177931343008429724013324141650383503356262124534653622717284901062516454237987830881046900822917062092960473173093282035894796801836543828693251639649496501086554065578370466331312922791453491451</span>*m*q-<span class="number">34105371356078730540026380993665892290979065373626278873362179157630127511570819286171227007106644656935835272129094112909477135930773407817248025054062730494688976739672305223210320903489031037134439674180133440058043164140913117611202557381675689286537124393757158185102388283585424697210696644686456101483090689553432180421076568695582991375337633500425511357457051724580463395427808368549351913553738866835892392128523711966761746405848504650518623656216348168341443113402127309526945386178721308925598991494220857397201886564417330832173346185855181435188950774538740465940540766369706968404676684878875495954526</span>*p*q+<span class="number">10020292641987293728161329938050113630307238317983218923062971693976688208935398937040014876322577458149002374747894666646061143135363099399632961967694186845534595514633563806494688267187250719941835610691103147374032064523990419621307663052631431863968966392004378153331080563191846577581621941773179696592794582121190522523136393663403751882725093074178050785973001311884419767481319780352912263311835004574406554911334870834988336630898329153766318598195896506882573701182439100863247780264819955349885647547159689509459966184588160486640412601118797750558512250393907883703263524450073823133453934915885026697236</span>*q^<span class="number">2</span></span><br><span class="line">f2 = <span class="number">17052685678039365270013190496832946145489532686813139436681089578815063755785409643085613503553322328467917636064547056454738567965386703908624012527031365247344488369836152611605160451744515518567219837090066720029021582070456558805601278690837844643268562196878579092551194141792712348605348322343228050741545344776716090210538284347791495687668816750212755678728525862290231697713904184274675956776869433417946196064261855983380873202924252325259311828108174084170721556701063654763472693089360654462799495747110428698600943282208665416086673092927590717594475387269370232970270383184853484202338342439437747977263</span>*m+<span class="number">23068797980682606520939695222878122197959337999989439659463060223100940821636820498796323501114581015229139528378476011747406619373674219012654711036679216185435206920458114821813684811803255215071210021993225524462202325898617081380757277198725994459984702472016033977488077163817512898930755857975634130292726390994608493384853082111236511030958876989952691833996481188400633235618992677715425955155661003765813385632286451112973798595901431845116019957199285671071239395739214529274342043100057378018195903606552798854032051006376267379308809102755448075675705613976371379827552646430651063130539035567468678816952</span>*p-<span class="number">11036573375396124019086685770787770093019727373636839213899118934529186689933998787374903505992063641706695743750618101162070516557099188804593314017383514309253769819214190401396636091685775822063229652186907915595840838242296036230445280182949694826552421921741124207614311119767911798279940786710821971190364298558823687036223486584346480344378756510472819523460570536179830159808815690833925958398077863070079006496237260853787947809947072805402603699017062497270203717662912780252603343078663930907403087887668058543169835558041063452864537083099733359513245160562369086112988119939055905274137649311406817137574</span>*q</span><br><span class="line">f3 = p*q-n</span><br><span class="line">F = [f1,f2,f3]</span><br><span class="line"><span class="comment"># 使用F构建一个理想的Ideal。</span></span><br><span class="line">ideal = Ideal(F)</span><br><span class="line"><span class="comment"># 计算Ideal的Gröbner基I</span></span><br><span class="line">I = ideal.groebner_basis()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(I[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>这个<code>I[0]</code>返回的是p，具体原因我不太理解，得到p之后解矩阵RSA即可，注意$\phi(n) &#x3D; (p^2-1)(q^2-1)$</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">98199204383444167136509999317652307746300154257439691314026803510437035509888229764173492052858804263577571331383214859652229706329210472593337809065208882042178413249493877596701444929209070708258353144837330382092255133776768117120874000890494449018234172972678168219613884207547781528635959091301251971281</span></span><br><span class="line">n = <span class="number">13228298199631335610499409465400552275305629934024756614227830931136508640681372951453757994834844498763877490566164031828108583453919741685657210448857955666192855872103622943922893572765718705893238315297600050789804418329650168680719372191579207505092037294294875908952803670819999025123209403251314588474192758376162806705064430837428828805477906627599506069017651159117664246131790529354533675662936081996490294431369820750274303028529977278828959613343997326534446148884333619071935180484450320323844737055406889458275298296950269660857078186043669204168045730995355857013530919638304423700701901063780318208789</span></span><br><span class="line">q = n // p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = [(<span class="number">1491873293560323909465836471682585391496137454962536255211620436893391549603126009345148985699013899435764986980919290827837440218992944453711597495517127038406936254470963878149611067609857046502282994346483454884781103538081677117421537728730737422899739818406539050745938770868537148564365984825217449546939297237128543198112642950063626687602582556615437626388875069902892432216468378684299365817407995725759407957747215159745600867120912008194130121350313833434901083388223410629737737418961006112893999319596217781130922876695397872007871395908185274519733474161410964601075476672137735633842608230612826681061</span>, <span class="number">4956025543963860548224153175168493318238985854531591968596322951867101383038318092494673400475554880419342014784571362229741642826660412082585292197764604908450405263330703286845800303018092222139976907126517882830745820723998293430203137128739850924103620078289772876248014239067659155995114953314111131752812515097213052728067061893768763077056914111566820414025280534046400995356712414837449121046062079911435309295464490263283769221830037029108374974495201782045992874653920211537537724643230986981824349266978767367402293999209162694369772760075107747609491264902786041130826876918123202134703658442941891830242</span>, <span class="number">7710011511933273600956066580006667228795766247206337007278271463871915295714373557766306241838812677910529618690854981247073325175370147283360553440166198511565970962496527743224575526922830794861623489204146092991883999208502150565496732100104360091815826333424313805145648110936043125983239009895903602879010609096750963186952687545255588633288528372363096307287365891027749166227382683937570696463897150461450791183251190323380329123556440876127657763835466077899344290052877228945633508945118354870143193111572860186690380517929737934424809644493802524411423150714171313957036859668776471063633076408076909640002</span>, <span class="number">11534398990341303260469847611439061098979668999994719829731530111550470410818410249398161750557290507614569764189238005873703309686837109506327355518339608092717603460229057410906842405901627607535605010996612762231101162949308540690378638599362997229992351236008016988744038581908756449465377928987817065146363195497304246692426541055618255515479438494976345916998240594200316617809496338857712977577830501882906692816143225556486899297950715922558009978599642835535619697869607264637171021550028689009097951803276399427016025503188133689654404551377724037837852806988185689913776323215325531565269517783734339408476</span>), (<span class="number">8272272655667475062275256290232058957066644079493164645631507979269407257643054858959084594359289618344535475781592669598366940627259329603071918251093350757742450608772919657077093269747626483753261408171082167959058597605651875250516235062839356580988417216005103032704789431752339869128094449937203456721380243278949753976997368943660065728420992516032685654992370625071263250775078114517084554616874002085054985135905330486990533806699940249720584638848795544488453274230413407534397455841219333342020387788428122090873004297741106966487305425968561456558554466092569815882704042720181221565998242620838426378547</span>, <span class="number">1491873293560323909465836471682585391496137454962536255211620436893391549603126009345148985699013899435764986980919290827837440218992944453711597495517127038406936254470963878149611067609857046502282994346483454884781103538081677117421537728730737422899739818406539050745938770868537148564365984825217449546939297237128543198112642950063626687602582556615437626388875069902892432216468378684299365817407995725759407957747215159745600867120912008194130121350313833434901083388223410629737737418961006112893999319596217781130922876695397872007871395908185274519733474161410964601075476672137735633842608230612826681061</span>, <span class="number">11534398990341303260469847611439061098979668999994719829731530111550470410818410249398161750557290507614569764189238005873703309686837109506327355518339608092717603460229057410906842405901627607535605010996612762231101162949308540690378638599362997229992351236008016988744038581908756449465377928987817065146363195497304246692426541055618255515479438494976345916998240594200316617809496338857712977577830501882906692816143225556486899297950715922558009978599642835535619697869607264637171021550028689009097951803276399427016025503188133689654404551377724037837852806988185689913776323215325531565269517783734339408476</span>, <span class="number">5518286687698062009543342885393885046509863686818419606949559467264593344966999393687451752996031820853347871875309050581035258278549594402296657008691757154626884909607095200698318045842887911031614826093453957797920419121148018115222640091474847413276210960870562103807155559883955899139970393355410985595182149279411843518111743292173240172189378255236409761730285268089915079904407845416962979199038931535039503248118630426893973904973536402701301849508531248635101858831456390126301671539331965453701543943834029271584917779020531726432268541549866679756622580281184543056494059969527952637068824655703408568787</span>), (<span class="number">5518286687698062009543342885393885046509863686818419606949559467264593344966999393687451752996031820853347871875309050581035258278549594402296657008691757154626884909607095200698318045842887911031614826093453957797920419121148018115222640091474847413276210960870562103807155559883955899139970393355410985595182149279411843518111743292173240172189378255236409761730285268089915079904407845416962979199038931535039503248118630426893973904973536402701301849508531248635101858831456390126301671539331965453701543943834029271584917779020531726432268541549866679756622580281184543056494059969527952637068824655703408568787</span>, <span class="number">1693899209290032350029561853961491176325960934030036784496300819586038229862962702055596244277553991149307726376926025954405273767082632179329854930518347573475252411874565533016051166864091098357633304300987288558703255380341627990340733592216210275099686058286858920208765088911242575657831474263497523327829562878858560012637889781810573289998468132623160152019410564917347628322294190496820698085105580113583601615226595193787403730579261356270949634744354490998826451014726354434764158934421631314746785252130490031259272793762135971202673634665945166330192924007170167099754596422978892135432383280045978800313</span>, <span class="number">1491873293560323909465836471682585391496137454962536255211620436893391549603126009345148985699013899435764986980919290827837440218992944453711597495517127038406936254470963878149611067609857046502282994346483454884781103538081677117421537728730737422899739818406539050745938770868537148564365984825217449546939297237128543198112642950063626687602582556615437626388875069902892432216468378684299365817407995725759407957747215159745600867120912008194130121350313833434901083388223410629737737418961006112893999319596217781130922876695397872007871395908185274519733474161410964601075476672137735633842608230612826681061</span>, <span class="number">4956025543963860548224153175168493318238985854531591968596322951867101383038318092494673400475554880419342014784571362229741642826660412082585292197764604908450405263330703286845800303018092222139976907126517882830745820723998293430203137128739850924103620078289772876248014239067659155995114953314111131752812515097213052728067061893768763077056914111566820414025280534046400995356712414837449121046062079911435309295464490263283769221830037029108374974495201782045992874653920211537537724643230986981824349266978767367402293999209162694369772760075107747609491264902786041130826876918123202134703658442941891830242</span>), (<span class="number">1693899209290032350029561853961491176325960934030036784496300819586038229862962702055596244277553991149307726376926025954405273767082632179329854930518347573475252411874565533016051166864091098357633304300987288558703255380341627990340733592216210275099686058286858920208765088911242575657831474263497523327829562878858560012637889781810573289998468132623160152019410564917347628322294190496820698085105580113583601615226595193787403730579261356270949634744354490998826451014726354434764158934421631314746785252130490031259272793762135971202673634665945166330192924007170167099754596422978892135432383280045978800313</span>, <span class="number">7710011511933273600956066580006667228795766247206337007278271463871915295714373557766306241838812677910529618690854981247073325175370147283360553440166198511565970962496527743224575526922830794861623489204146092991883999208502150565496732100104360091815826333424313805145648110936043125983239009895903602879010609096750963186952687545255588633288528372363096307287365891027749166227382683937570696463897150461450791183251190323380329123556440876127657763835466077899344290052877228945633508945118354870143193111572860186690380517929737934424809644493802524411423150714171313957036859668776471063633076408076909640002</span>, <span class="number">8272272655667475062275256290232058957066644079493164645631507979269407257643054858959084594359289618344535475781592669598366940627259329603071918251093350757742450608772919657077093269747626483753261408171082167959058597605651875250516235062839356580988417216005103032704789431752339869128094449937203456721380243278949753976997368943660065728420992516032685654992370625071263250775078114517084554616874002085054985135905330486990533806699940249720584638848795544488453274230413407534397455841219333342020387788428122090873004297741106966487305425968561456558554466092569815882704042720181221565998242620838426378547</span>, <span class="number">1491873293560323909465836471682585391496137454962536255211620436893391549603126009345148985699013899435764986980919290827837440218992944453711597495517127038406936254470963878149611067609857046502282994346483454884781103538081677117421537728730737422899739818406539050745938770868537148564365984825217449546939297237128543198112642950063626687602582556615437626388875069902892432216468378684299365817407995725759407957747215159745600867120912008194130121350313833434901083388223410629737737418961006112893999319596217781130922876695397872007871395908185274519733474161410964601075476672137735633842608230612826681061</span>)]</span><br><span class="line"></span><br><span class="line">C = Matrix(Zmod(n),enc)</span><br><span class="line">phi = (p^<span class="number">2</span>-<span class="number">1</span>)*(q^<span class="number">2</span>-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line"></span><br><span class="line">M = C ** d</span><br><span class="line">m = M[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># WMCTF&#123;QU4t3rni0n_4nd_Matr1x_4r3_4un&#125;</span></span><br></pre></td></tr></table></figure>

<p>小作文</p>
<p>最近在评综测，导致对保研的事情比较焦虑，有些话不知道找谁说，就记录在博客理吧。回顾一下两年的大学生活</p>
<p>2022年9月中旬入学，12月中旬因为疫情提前回家，所以这个学期显得特别短，这个学期比较有意义的事情是进入了学校的网安协会，然后因为室友的带动，我也浅浅打了一点CTF，但是也只是浅浅的打，更多的时间还是打游戏和卷绩点(当时根本没这想法，只是沿用了高中的学习方法)。然后由于期末考之前大家都因为疫情回家了，有些同学可能受疫情影响没能发挥全部实力，这就让我的绩点来到了专业第五，这时候的我就对保研有了一点想法(也只是一点想法，根本没去了解保研相关的细则)。这个学期中还有个事情就是我对某个女生有好感(也只是有好感，懦弱的性格导致我也只是和人家聊聊天)。寒假的时候想着自己要不学点CTF相关的东西，由于自己没方向，像个无头苍蝇一样乱窜。一开始学了点php语法，然后因为校队没有密码手，自己就开始逐步摸索密码学。很遗憾的是，寒假也只是做了一点题，很多推导以我当时的知识水平根本理解不了。</p>
<p>接下来是大一下学期，由于对保研有了想法，前面也说了，我没有仔细了解保研的细则，导致我虽然是挺努力的，即想要绩点，又想要竞赛，结果我没有平衡好二者，投入不合理，导致最后的结果是绩点从专业第五掉到了专业第十二，CTF有了一定的进展，也很幸运的经过某个师傅介绍，进入了星盟的预备队，还有就是靠着学长的带领拿了ISCC的二等，在保研的加分中有一定的帮助。然后暑假的时候，Harry师傅给我们预备队的队员开了个暑期密码特训，出了3周的题，经过这些题，我的认知从RSA拓展到了其他密码体制。然后在开学前调到了主队。</p>
<p>后来就是大二上，这一学期应该是我密码水平提高比较多的时期。关键的时间点在23年的9月30日，鸡块师傅加了我的QQ，和我讨论了我博客里的一道题，从此之后跟着鸡块师傅学到了很多东西。这一学期最大的感受就是课程压力很大，周一到周五天天早八，然后课也多，而且这个学期时间很长，有19周，而且中间夹杂了两周的军训，以及我在这么大课程压力的情况下，还报考了6级。这就意味着我要在空余时间备考6级，还要学习课程内容，以及提高密码水平。结果是我成功顶住了压力，6级也顺利通过了，虽然只有459，绩点也有略微提高，密码水平也提了不少，能在一些大一点的比赛中做出题了。接下来是寒假，经过这么长一个学期的拷打，寒假刚开始的时候我是玩了几天，然后战队那边给了个川大极客少年的培训，让我赚了点外快，再接着就没什么了。</p>
<p>最后是大二下，这个学期是打比赛比较多(大部分国内的比赛都有参与，小部分的国外赛也有打)，也是拿奖最多的一学期(虽然都是一些小奖项，但也足以让我开心)。直接从4月的长城杯说起，这是第一次打线下的比赛，线下赛制是AWD，很显然我前面学的都是密码，导致线下赛就是吉祥物，队友挺强的，带我拿了个三等奖。然后就是CISCN，队友带我拿了分区二等，没能进入决赛(要是我能帮上忙就好了)，接下来就是开学前的闽盾决赛，队友更加给力，带我拿了一等。最后就是前几天的羊城杯，这次线下之旅还是比较开心的，体验了以前没体验过的东西，虽然比赛的时候只拿到了优胜奖，但是队友是真的厉害，在比赛前大半程的时间毫无进展的情况下，在偶然的扫描高端口发现入口点之后，2个半小时砍了1500多分。</p>
<p>两年的大学生活主要就是这些，几乎都是关于CTF。我的总结是，卡在保研的边缘，运气占了很大一部分，但由于我对保研细则没有仔细研究，导致我在大三这一年无论怎么努力，也无法把竞赛分拉满。尽管如此，我也要尽自己最大的努力，保持自己的竞争力，无论最后的结果是好是坏。再一个就是希望能谈个恋爱(😭)</p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/" title="2024WMCTF">https://dexterjie.github.io/2024/09/17/赛题复现/2024WMCTF/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/08/06/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SRCTF/" rel="prev" title="SRCTF">
                  <i class="fa fa-chevron-left"></i> SRCTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/10/31/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E7%BD%91%E9%BC%8E%E6%9D%AF/" rel="next" title="2024网鼎杯">
                  2024网鼎杯 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">318k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">19:16</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024WMCTF/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
