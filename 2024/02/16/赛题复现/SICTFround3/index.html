<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录SICTFRound3——Crypto题解，以及其他方向部分题解">
<meta property="og:type" content="article">
<meta property="og:title" content="SICTFround3">
<meta property="og:url" content="https://dexterjie.github.io/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录SICTFRound3——Crypto题解，以及其他方向部分题解">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/6.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/5.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/8.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/9.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/7.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/SICTF/2.png">
<meta property="article:published_time" content="2024-02-16T03:41:02.000Z">
<meta property="article:modified_time" content="2024-02-22T01:30:24.881Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/SICTF/6.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/","path":"2024/02/16/赛题复现/SICTFround3/","title":"SICTFround3"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>SICTFround3 | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Crypto"><span class="nav-number">1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Vigenere"><span class="nav-number">1.1.</span> <span class="nav-text">Vigenere</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0%EF%BC%8C%E7%A1%AE%E4%BF%A1%EF%BC%81"><span class="nav-number">1.2.</span> <span class="nav-text">签到，确信！</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easyLattice"><span class="nav-number">1.3.</span> <span class="nav-text">easyLattice</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%93%9C%E5%8C%A0"><span class="nav-number">1.4.</span> <span class="nav-text">铜匠</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SuperbRSA"><span class="nav-number">1.5.</span> <span class="nav-text">SuperbRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gggcccddd"><span class="nav-number">1.6.</span> <span class="nav-text">gggcccddd</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BabyRSA"><span class="nav-number">1.7.</span> <span class="nav-text">*BabyRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easy-or-baby-RSA"><span class="nav-number">1.8.</span> <span class="nav-text">*easy_or_baby_RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2024-New-Setback"><span class="nav-number">1.9.</span> <span class="nav-text">*2024_New_Setback</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%81%A2%E5%A4%8D%E5%8F%82%E6%95%B0"><span class="nav-number">1.9.1.</span> <span class="nav-text">恢复参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B2%E7%BA%BF%E6%98%A0%E5%B0%84"><span class="nav-number">1.9.2.</span> <span class="nav-text">曲线映射</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E4%BA%8E%E6%9B%B2%E7%BA%BF%E5%BD%A2%E5%BC%8F%E7%9A%84%E6%96%87%E7%AB%A0"><span class="nav-number">1.9.3.</span> <span class="nav-text">关于曲线形式的文章</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#misc"><span class="nav-number">2.</span> <span class="nav-text">misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GeekChallenge"><span class="nav-number">2.1.</span> <span class="nav-text">GeekChallenge</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9C%9F%E7%AD%BE%E5%88%B0"><span class="nav-number">2.2.</span> <span class="nav-text">真签到</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reverse"><span class="nav-number">3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby-C"><span class="nav-number">3.1.</span> <span class="nav-text">Baby_C++</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ez-pyc"><span class="nav-number">3.2.</span> <span class="nav-text">Ez_pyc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AA%E6%9B%B4%E6%96%B0%E4%B9%8B%E5%89%8D%E7%9A%84%E9%99%84%E4%BB%B6"><span class="nav-number">3.2.1.</span> <span class="nav-text">未更新之前的附件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E5%90%8E%E7%9A%84%E9%99%84%E4%BB%B6"><span class="nav-number">3.2.2.</span> <span class="nav-text">更新后的附件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Forensics"><span class="nav-number">4.</span> <span class="nav-text">Forensics</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#OSINT%E7%AD%BE%E5%88%B0"><span class="nav-number">4.1.</span> <span class="nav-text">OSINT签到</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%99%E6%89%8D%E6%98%AF%E7%AD%BE%E5%88%B0"><span class="nav-number">4.2.</span> <span class="nav-text">这才是签到</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="SICTFround3 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SICTFround3
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-02-16 11:41:02" itemprop="dateCreated datePublished" datetime="2024-02-16T11:41:02+08:00">2024-02-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-02-22 09:30:24" itemprop="dateModified" datetime="2024-02-22T09:30:24+08:00">2024-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>18 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录SICTFRound3——Crypto题解，以及其他方向部分题解</p>
<span id="more"></span>

<p>近来发觉大部分内容需要重新学习，以前只是囫囵吞枣地下咽，是时候学的细致些了。。</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenere"></a>Vigenere</h2><blockquote>
<p>cipher.txt</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Gn taj xirly gf Fxgjuakd, oe igywnd mt tegbs mnrxxlrivywd sngearbsw wakksre. Bs kpimj gf tank, it bx gur bslenmngn th jfdetagur mt ceei yze Ugnled Lystel tx Amxwaca gjmtrtq.</span><br><span class="line"></span><br><span class="line">An taj wvegy gf tank nom xmccxjvinz, bw prhugse ts sllbffce hs lhe ytdlopnfg btxas wbyz Meqnuo: Tafl we lmsll ffce wtw logxyzer tsv madj heavj logxyzer. Pj khaeq yivLNUTF&#123;4695vft9-fd68-<span class="number">4684</span>-uj81-u6c1avg6uaft&#125;j yenxwgus ynfanvnsl snuhorm, ffd ag zfdekxlanwnfg og tmr ptwl thty Eexbhg <span class="keyword">is</span> mt jechsiuek yze lhxl tekwatokd an Nxb Eexbhg, Teqfk, anw Fjizhss. Thx iwtabqk of ljltlxrwnt tww leyy lo yhz.</span><br><span class="line"></span><br><span class="line">Qou tww inlyjucmjv to bsxorf yze Pkjkidxsl [of Fjpich] tx thx ftovx nf thx ljeamjkt chsxidxsue al xgon tx at il hwrttnf thty lhekj oile gw an hzlbrxfc of pfj wimm lhe Nsatew Xlatxx snd lzygely lham yze Pkjkidxsl, on ank owg nfitbflivx, nfvimj Bapts lo ifrwdityw adajjenvj oita yzis iqsn; am yze strw tifj, gffxw lo mxiaatx gwtwxjf Jaiff anw tmrsxqnes.</span><br><span class="line"></span><br><span class="line">Iqwasx hsll mt lhe tylenmngn oy yze Pkjkidxsl thty lhe kzlhlxxk emiqgymxsl of hzj suursrigjk nop txfekx lhe iwgspxhl of vtepeeqang Xsylagi lo mtpw pethw <span class="keyword">in</span> t kww mhslhs.</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">Vigenere Solver | guballa.de</a></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">On the first of February, we intend to begin unrestricted submarine warfare. In spite of this, it <span class="keyword">is</span> our intention to endeavour to keep the United States of America neutral.</span><br><span class="line"></span><br><span class="line">In the event of this <span class="keyword">not</span> succeeding, we propose an alliance on the following basis <span class="keyword">with</span> Mexico: That we shall make war together <span class="keyword">and</span> make peace together. We shall givSICTF&#123;4695cab9-fd68-<span class="number">4684</span>-be81-c6c1acb6cafa&#125;e generous financial support, <span class="keyword">and</span> an understanding on our part that Mexico <span class="keyword">is</span> to reconquer the lost territory <span class="keyword">in</span> New Mexico, Texas, <span class="keyword">and</span> Arizona. The details of settlement are left to you.</span><br><span class="line"></span><br><span class="line">You are instructed to inform the President [of Mexico] of the above <span class="keyword">in</span> the greatest confidence <span class="keyword">as</span> soon <span class="keyword">as</span> it <span class="keyword">is</span> certain that there will be an outbreak of war <span class="keyword">with</span> the United States <span class="keyword">and</span> suggest that the President, on his own initiative, invite Japan to immediate adherence <span class="keyword">with</span> this plan; at the same time, offer to mediate between Japan <span class="keyword">and</span> ourselves.</span><br><span class="line"></span><br><span class="line">Please call to the attention of the President that the ruthless employment of our submarines now offers the prospect of compelling England to make peace <span class="keyword">in</span> a few months.</span><br></pre></td></tr></table></figure>

<h2 id="签到，确信！"><a href="#签到，确信！" class="headerlink" title="签到，确信！"></a>签到，确信！</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_keys</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        p = getPrime(bits)</span><br><span class="line">        q = <span class="built_in">sum</span>([p**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)])</span><br><span class="line">        <span class="keyword">if</span> isPrime(q):</span><br><span class="line">            r = getPrime(<span class="number">1024</span>)</span><br><span class="line">            n = p*q*r</span><br><span class="line">            <span class="keyword">return</span> p,n</span><br><span class="line">p,n = gen_keys(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 8361361624563191168612863710516449028280757632934603412143152925186847721821552879338608951120157631182699762833743097837368740526055736516080136520584848113137087581886426335191207688807063024096128001406698217998816782335655663803544853496060418931569545571397849643826584234431049002394772877263603049736723071392989824939202362631409164434715938662038795641314189628730614978217987868150651491343161526447894569241770090377633602058561239329450046036247193745885174295365633411482121644408648089046016960479100220850953009927778950304754339013541019536413880264074456433907671670049288317945540495496615531150916647050158936010095037412334662561046016163777575736952349827380039938526168715655649566952708788485104126900723003264019513888897942175890007711026288941687256962012799264387545892832762304320287592575602683673845399984039272350929803217492617502601005613778976109701842829008365226259492848134417818535629827769342262020775115695472218876430557026471282526042545195944063078523279341459199475911203966762751381334277716236740637021416311325243028569997303341317394525345879188523948991698489667794912052436245063998637376874151553809424581376068719814532246179297851206862505952437301253313660876231136285877214949094995458997630235764635059528016149006613720287102941868517244509854875672887445099733909912598895743707420454623997740143407206090319567531144126090072331</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 990174418341944658163682355081485155265287928299806085314916265580657672513493698560580484907432207730887132062242640756706695937403268682912083148568866147011247510439837340945334451110125182595397920602074775022416454918954623612449584637584716343806255917090525904201284852578834232447821716829253065610989317909188784426328951520866152936279891872183954439348449359491526360671152193735260099077198986264364568046834399064514350538329990985131052947670063605611113730246128926850242471820709957158609175376867993700411738314237400038584470826914946434498322430741797570259936266226325667814521838420733061335969071245580657187544161772619889518845348639672820212709030227999963744593715194928502606910452777687735614033404646237092067644786266390652682476817862879933305687452549301456541574678459748029511685529779653056108795644495442515066731075232130730326258404497646551885443146629498236191794065050199535063169471112533284663197357635908054343683637354352034115772227442563180462771041527246803861110504563589660801224223152060573760388045791699221007556911597792387829416892037414283131499832672222157450742460666013331962249415807439258417736128976044272555922344342725850924271905056434303543500959556998454661274520986141613977331669376614647269667276594163516040422089616099849315644424644920145900066426839607058422686565517159251903275091124418838917480242517812783383</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>类似2023DASCTFX0psu3——GeneratePrime</p>
<p>参考<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/6144f326.html">2023-DASCTFX0psu3十一月挑战赛-wp-crypto | 糖醋小鸡块的blog (tangcuxiaojikuai.xyz)</a></p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">8361361624563191168612863710516449028280757632934603412143152925186847721821552879338608951120157631182699762833743097837368740526055736516080136520584848113137087581886426335191207688807063024096128001406698217998816782335655663803544853496060418931569545571397849643826584234431049002394772877263603049736723071392989824939202362631409164434715938662038795641314189628730614978217987868150651491343161526447894569241770090377633602058561239329450046036247193745885174295365633411482121644408648089046016960479100220850953009927778950304754339013541019536413880264074456433907671670049288317945540495496615531150916647050158936010095037412334662561046016163777575736952349827380039938526168715655649566952708788485104126900723003264019513888897942175890007711026288941687256962012799264387545892832762304320287592575602683673845399984039272350929803217492617502601005613778976109701842829008365226259492848134417818535629827769342262020775115695472218876430557026471282526042545195944063078523279341459199475911203966762751381334277716236740637021416311325243028569997303341317394525345879188523948991698489667794912052436245063998637376874151553809424581376068719814532246179297851206862505952437301253313660876231136285877214949094995458997630235764635059528016149006613720287102941868517244509854875672887445099733909912598895743707420454623997740143407206090319567531144126090072331</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">990174418341944658163682355081485155265287928299806085314916265580657672513493698560580484907432207730887132062242640756706695937403268682912083148568866147011247510439837340945334451110125182595397920602074775022416454918954623612449584637584716343806255917090525904201284852578834232447821716829253065610989317909188784426328951520866152936279891872183954439348449359491526360671152193735260099077198986264364568046834399064514350538329990985131052947670063605611113730246128926850242471820709957158609175376867993700411738314237400038584470826914946434498322430741797570259936266226325667814521838420733061335969071245580657187544161772619889518845348639672820212709030227999963744593715194928502606910452777687735614033404646237092067644786266390652682476817862879933305687452549301456541574678459748029511685529779653056108795644495442515066731075232130730326258404497646551885443146629498236191794065050199535063169471112533284663197357635908054343683637354352034115772227442563180462771041527246803861110504563589660801224223152060573760388045791699221007556911597792387829416892037414283131499832672222157450742460666013331962249415807439258417736128976044272555922344342725850924271905056434303543500959556998454661274520986141613977331669376614647269667276594163516040422089616099849315644424644920145900066426839607058422686565517159251903275091124418838917480242517812783383</span></span><br><span class="line">k = <span class="number">7</span></span><br><span class="line"></span><br><span class="line">R = Zmod(n)[<span class="string">&quot;x&quot;</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    Q = R.quo(R.random_element(k))</span><br><span class="line">    pp = gcd(ZZ(<span class="built_in">list</span>(Q.random_element() ^ n)[<span class="number">1</span>]), n)</span><br><span class="line">    <span class="keyword">if</span> pp != <span class="number">1</span>:</span><br><span class="line">        qq = <span class="built_in">sum</span>([pp**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)])</span><br><span class="line">        rr = n // (pp * qq)</span><br><span class="line">        <span class="keyword">assert</span> n == pp * qq * rr</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">phi = (pp - <span class="number">1</span>) * (qq - <span class="number">1</span>) * (rr - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># SICTF&#123;d9428fc7-fa3a-4096-8ec9-191c0a4562ff&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="easyLattice"><a href="#easyLattice" class="headerlink" title="easyLattice"></a>easyLattice</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">47</span></span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">g = getPrime(<span class="number">128</span>)</span><br><span class="line">h = gmpy2.invert(f, p) * g % p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p =&#x27;</span>, p)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">h = 9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line"><span class="string">p = 11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947     </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>$$<br>h \equiv f^{-1} \times g \mod p<br>$$</p>
<p>$$<br>\therefore g &#x3D; f\times h + kp<br>$$</p>
<p>构造格</p>
<p><img src="/../../images/SICTF/6.png"></p>
<p>这里$f \approx 2^{376}$,格的行列式约$2^{256}$，直接规约是规约不出来的。</p>
<p>调整一下参数，使格的行列式大于$f$即可</p>
<p><img src="/../../images/SICTF/5.png"></p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = <span class="number">9848463356094730516607732957888686710609147955724620108704251779566910519170690198684628685762596232124613115691882688827918489297122319416081019121038443</span></span><br><span class="line">p = <span class="number">11403618200995593428747663693860532026261161211931726381922677499906885834766955987247477478421850280928508004160386000301268285541073474589048412962888947</span>     </span><br><span class="line">T = <span class="number">2</span>^<span class="number">250</span></span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,[[<span class="number">1</span>,T*h],[<span class="number">0</span>,T*p]])</span><br><span class="line"></span><br><span class="line">f,g = L.LLL()[<span class="number">0</span>]</span><br><span class="line">f,g = <span class="built_in">abs</span>(f),<span class="built_in">abs</span>(g)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(f)))</span><br><span class="line"><span class="comment"># SICTF&#123;e3fea01c-18f3-4638-9544-9201393940a9&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="铜匠"><a href="#铜匠" class="headerlink" title="铜匠"></a>铜匠</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decimal_conversion</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> num:</span><br><span class="line">        digits.append(<span class="built_in">str</span>(num % <span class="number">5</span>))</span><br><span class="line">        num //= <span class="number">5</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">reversed</span>(digits))</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak = <span class="subst">&#123;Decimal_conversion(p)[:<span class="number">112</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">leak = 2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012</span></span><br><span class="line"><span class="string">n = 85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>给出的leak是5进制下的，112长度的5进制，约259bit</p>
<p>一开始想抹掉低3位，变成256bit，再爆8位用coppersmith</p>
<p>半小时爆破后没成功。<strong>发现是5进制转回10进制的时候出现了问题</strong></p>
<p>一般情况下5进制转10进制是这样:$tmp &#x3D; \sum_{i&#x3D;0}^{n} t\times 5^{i}$</p>
<p>但是这里的leak不能直接这样转，因为起始的$i$也就是$i &#x3D; 0$对应的底数不是这里leak最低位的<code>2</code></p>
<p>经过测试，发现512bit的数，转为5进制长度大概是221</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decimal_conversion</span>(<span class="params">num</span>):</span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> num:</span><br><span class="line">        digits.append(<span class="built_in">str</span>(num % <span class="number">5</span>))</span><br><span class="line">        num //= <span class="number">5</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">reversed</span>(digits))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    tmp = Decimal_conversion(p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(tmp))</span><br></pre></td></tr></table></figure>

<p>而这里leak是前112位，所以这里leak最低位的<code>2</code>对应的<code>i</code>应该是109</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">leak = <span class="string">&quot;2011133132443111302000224204142244403203442000141102312242343143241244243020003333022112141220422134444214010012&quot;</span></span><br><span class="line">n = <span class="number">85988668134257353631742597258304937106964673395852009846703777410474172989069717247424903079500594820235304351355706519069516847244761609583338251489134035212061654870087550317540291994559481862615812258493738064606592165529948648774081655902831715928483206013332330998262897765489820121129058926463847702821</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">64708526479058278743788046708923650158905888858865427385501446781738669889375403360886995849554813207230509920789341593771929287415439407977283018525484281064769128358863513387658744063469874845446480637925790150835186431234289848506337341595817156444941964510251032210939739594241869190746437858135599624562</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">five_to_ten</span>(<span class="params">num</span>):</span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    i = <span class="number">109</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">reversed</span>(num):</span><br><span class="line">        temp += <span class="built_in">int</span>(j) * <span class="number">5</span>**i</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> temp</span><br><span class="line"></span><br><span class="line">leak = five_to_ten(leak)</span><br><span class="line">gift = leak &gt;&gt; <span class="number">256</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>^<span class="number">8</span>):</span><br><span class="line">    ph = gift &lt;&lt; <span class="number">8</span></span><br><span class="line">    phigh = ph + i</span><br><span class="line">    phigh = phigh &lt;&lt; <span class="number">248</span></span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = phigh + x</span><br><span class="line">    res = f.small_roots(X=<span class="number">2</span>^<span class="number">248</span>, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.01</span>)</span><br><span class="line">    <span class="keyword">if</span> res != []:</span><br><span class="line">        p = phigh + <span class="built_in">int</span>(res[<span class="number">0</span>])</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;i = <span class="subst">&#123;i&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="SuperbRSA"><a href="#SuperbRSA" class="headerlink" title="SuperbRSA"></a>SuperbRSA</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user:mumu666</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e1=<span class="number">55</span></span><br><span class="line">e2=<span class="number">200</span></span><br><span class="line">m=bytes_to_long(<span class="string">&quot;flag&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">pow</span>(m,<span class="number">5</span>) &lt; n)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>,c2)</span><br><span class="line"></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br></pre></td></tr></table></figure>

<p>$e_1,e_2$不互素的共模攻击</p>
<p>根据扩展欧几里得算法有:<br>$$<br>e_1x + e_2y &#x3D; (e_1,e_2) &#x3D; 5<br>$$<br>所以<br>$$<br>c_1^{x}\times c_2^{y} \equiv m^{e_{1}x + e_{2}y} \equiv m^5 \mod n<br>$$<br><code>assert pow(m,5) &lt; n</code></p>
<p>所以直接开5次方即可</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">19006830358118902392432453595802675566730850352890246995920642811967821259388009049803513102750594524106471709641202019832682438027312468849299985832675191795417160553379580813410722359089872519372049229233732405993062464286888889084640878784209014165871696882564834896322508054231777967011195636564463806270998326936161449009988434249178477100127347406759932149010712091376183710135615375272671888541233275415737155953323133439644529709898791881795186775830217884663044495979067807418758455237701315019683802437323177125493076113419739827430282311018083976114158159925450746712064639569301925672742186294237113199023</span></span><br><span class="line">c1= <span class="number">276245243658976720066605903875366763552720328374098965164676247771817997950424168480909517684516498439306387133611184795758628248588201187138612090081389226321683486308199743311842513053259894661221013008371261704678716150646764446208833447643781574516045641493770778735363586857160147826684394417412837449465273160781074676966630398315417741542529612480836572205781076576325382832502694868883931680720558621770570349864399879523171995953720198118660355479626037129047327185224203109006251809257919143284157354935005710902589809259500117996982503679601132486140677013625335552533104471327456798955341220640782369529</span></span><br><span class="line">c2= <span class="number">11734019659226247713821792108026989060106712358397514827024912309860741729438494689480531875833287268454669859568719053896346471360750027952226633173559594064466850413737504267807599435679616522026241111887294138123201104718849744300769676961585732810579953221056338076885840743126397063074940281522137794340822594577352361616598702143477379145284687427705913831885493512616944504612474278405909277188118896882441812469679494459216431405139478548192152811441169176134750079073317011232934250365454908280676079801770043968006983848495835089055956722848080915898151352242215210071011331098761828031786300276771001839021</span></span><br><span class="line">e1 = <span class="number">55</span></span><br><span class="line">e2 = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(e1,e2)</span><br><span class="line"><span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">    s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        m = gmpy2.iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)+k*n)%n,t)</span><br><span class="line">        <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k += <span class="number">1</span></span><br><span class="line"><span class="comment"># SICTF&#123;S0_Great_RSA_Have_Y0u_Learned?&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="gggcccddd"><a href="#gggcccddd" class="headerlink" title="gggcccddd"></a>gggcccddd</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(<span class="number">233</span>*m+<span class="number">9527</span>,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191</span></span><br><span class="line"><span class="string">c1 = 60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684</span></span><br><span class="line"><span class="string">c2 = 20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>Franklin-Reiter相关消息攻击 ＋ half-gcd</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">500000</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">71451784354488078832557440841067139887532820867160946146462765529262021756492415597759437645000198746438846066445835108438656317936511838198860210224738728502558420706947533544863428802654736970469313030584334133519644746498781461927762736769115933249195917207059297145965502955615599481575507738939188415191</span></span><br><span class="line">c1 = <span class="number">60237305053182363686066000860755970543119549460585763366760183023969060529797821398451174145816154329258405143693872729068255155086734217883658806494371105889752598709446068159151166250635558774937924668506271624373871952982906459509904548833567117402267826477728367928385137857800256270428537882088110496684</span></span><br><span class="line">c2 = <span class="number">20563562448902136824882636468952895180253983449339226954738399163341332272571882209784996486250189912121870946577915881638415484043534161071782387358993712918678787398065688999810734189213904693514519594955522460151769479515323049821940285408228055771349670919587560952548876796252634104926367078177733076253</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^e - c1</span><br><span class="line">g = (<span class="number">233</span>*x+<span class="number">9527</span>)^e - c2</span><br><span class="line"></span><br><span class="line">res = GCD(f,g)</span><br><span class="line"></span><br><span class="line">m = -res.monic().coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># SICTF&#123;45115fb2-84d6-4369-88c2-c8c3d72b4c55&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="BabyRSA"><a href="#BabyRSA" class="headerlink" title="*BabyRSA"></a>*BabyRSA</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">p = random_prime(<span class="number">1</span>&lt;&lt;<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;ffllaagg.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = <span class="built_in">int</span>.from_bytes(f.read().strip(), <span class="string">&quot;big&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag &lt; p</span><br><span class="line"></span><br><span class="line">a = randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line">b = randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line">x = randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">h</span>():</span><br><span class="line">    <span class="keyword">global</span> a, b, x</span><br><span class="line">    x = (a*x + b) % p</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">PR.&lt;X&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = h() + h()*X + h()*X**<span class="number">2</span> + h()*X**<span class="number">3</span> + h()*X**<span class="number">4</span> + h()*X**<span class="number">5</span></span><br><span class="line">v_me_50 = [(i, f(i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(v_me_50)</span><br><span class="line"><span class="built_in">print</span>(f(flag))</span><br><span class="line"></span><br><span class="line">p = <span class="number">8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827</span></span><br><span class="line">v_me_50 = [(<span class="number">1</span>, <span class="number">5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355</span>), (<span class="number">2</span>, <span class="number">5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780</span>), (<span class="number">3</span>, <span class="number">5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113</span>), (<span class="number">4</span>, <span class="number">4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209</span>)]</span><br><span class="line">f_flag = <span class="number">7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867</span></span><br></pre></td></tr></table></figure>

<p><code>h()</code>函数实现的是lcg，每次更新x的值</p>
<p>首先要注意<code>f = h() + h()*X + h()*X**2 + h()*X**3 + h()*X**4 + h()*X**5</code></p>
<p>这里<code>h()</code>是x不同的状态，这里把$x$不同状态记为$x_i$</p>
<p>因为每个$x_i$都可以用$a,b,x$表示，我们可以写为4个方程，解这个方程组即可求得$a,b,x$</p>
<p>这里有个很容易犯的错是,误以为方程组是</p>
<p><img src="/../../images/SICTF/11.png"></p>
<p>但实际上，方程组是:</p>
<p><img src="/../../images/SICTF/10.png"></p>
<p>采取groebner的方式求解</p>
<p>然后再解下面这个方程即可<br>$$<br>f_2 \equiv x_1 + x_2\times m + x_3\times m^2 + x_4\times m^3 + x_{5}\times m^4 + x_{6}\times m^5 - enc\<br>$$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">8432316544210923620966806031040552674652729976238765323782536889706914762471638598119051165931563126522925761119650997703305509546949570434637437942542827</span></span><br><span class="line">c = [(<span class="number">1</span>, <span class="number">5237331460408741346823741966490617418367283531029963248255318507187035341590236835730694472064897540292182231844047116067936691956970631907605500080014355</span>), (<span class="number">2</span>, <span class="number">5798977431976767515500795413771120575460553181185728489626756434911307088093739452469315524092208822863785429164219547384598943937099787390543171055679780</span>), (<span class="number">3</span>, <span class="number">5030862375386942201139427367618716490378481408210696947331523552250206476805124204780313138835912303941204343248384742875319182761611109448446270069831113</span>), (<span class="number">4</span>, <span class="number">4705360705603328842229554954026497175574981026785287316439514185860486128679614980330307863925942038530792583274904352630757089631411920876914529907563209</span>)]</span><br><span class="line">enc_flag = <span class="number">7251453750672416392395590357197330390627853878488142305852099080761477796591562813165554150640801022882531891827653530623183405183605476913024545431842867</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P.&lt;a,b,x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"></span><br><span class="line">t = x</span><br><span class="line">T = [t]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    t = a*t + b</span><br><span class="line">    T.append(t)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">f1 = T[<span class="number">1</span>] + T[<span class="number">2</span>]*<span class="number">1</span> + T[<span class="number">3</span>]*<span class="number">1</span>^<span class="number">2</span> + T[<span class="number">4</span>]*<span class="number">1</span>^<span class="number">3</span> + T[<span class="number">5</span>]*<span class="number">1</span>^<span class="number">4</span> + T[<span class="number">6</span>]*<span class="number">1</span>^<span class="number">5</span> - c[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">f2 = T[<span class="number">1</span>] + T[<span class="number">2</span>]*<span class="number">2</span> + T[<span class="number">3</span>]*<span class="number">2</span>^<span class="number">2</span> + T[<span class="number">4</span>]*<span class="number">2</span>^<span class="number">3</span> + T[<span class="number">5</span>]*<span class="number">2</span>^<span class="number">4</span> + T[<span class="number">6</span>]*<span class="number">2</span>^<span class="number">5</span> - c[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">f3 = T[<span class="number">1</span>] + T[<span class="number">2</span>]*<span class="number">3</span> + T[<span class="number">3</span>]*<span class="number">3</span>^<span class="number">2</span> + T[<span class="number">4</span>]*<span class="number">3</span>^<span class="number">3</span> + T[<span class="number">5</span>]*<span class="number">3</span>^<span class="number">4</span> + T[<span class="number">6</span>]*<span class="number">3</span>^<span class="number">5</span> - c[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">f4 = T[<span class="number">1</span>] + T[<span class="number">2</span>]*<span class="number">4</span> + T[<span class="number">3</span>]*<span class="number">4</span>^<span class="number">2</span> + T[<span class="number">4</span>]*<span class="number">4</span>^<span class="number">3</span> + T[<span class="number">5</span>]*<span class="number">4</span>^<span class="number">4</span> + T[<span class="number">6</span>]*<span class="number">4</span>^<span class="number">5</span> - c[<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">F = [f1,f2,f3,f4]</span><br><span class="line">I = Ideal(F)</span><br><span class="line"></span><br><span class="line">a = ZZ(-I.groebner_basis()[<span class="number">0</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line">b = ZZ(-I.groebner_basis()[<span class="number">1</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line">x = ZZ(-I.groebner_basis()[<span class="number">2</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x = <span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">X = [x]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    x = (a * x + b) % p</span><br><span class="line">    X.append(x)</span><br><span class="line">    </span><br><span class="line">R.&lt;m&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = X[<span class="number">1</span>] + X[<span class="number">2</span>]*m + X[<span class="number">3</span>]*m^<span class="number">2</span> + X[<span class="number">4</span>]*m^<span class="number">3</span> + X[<span class="number">5</span>]*m^<span class="number">4</span> + X[<span class="number">6</span>]*m^<span class="number">5</span> - enc_flag</span><br><span class="line">res = f.roots()</span><br><span class="line">m = res[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># SICTF&#123;Th3s_1s_a_high_l3vel_p0lyn0mial&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="easy-or-baby-RSA"><a href="#easy-or-baby-RSA" class="headerlink" title="*easy_or_baby_RSA"></a>*easy_or_baby_RSA</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = (p**<span class="number">5</span>)*(q**<span class="number">3</span>)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*p**<span class="number">4</span> * q**<span class="number">2</span></span><br><span class="line">d = getPrime(<span class="number">1380</span>)</span><br><span class="line">e = gmpy2.invert(d,phi)</span><br><span class="line">p1 = gmpy2.next_prime(p)</span><br><span class="line">q1 = gmpy2.next_prime(q)</span><br><span class="line">c = <span class="built_in">pow</span>(m,<span class="number">65537</span>,p1*q1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 6027704939934795526809476320408984749353451163184148193613218899917989403800738729505135647560822568147775955030636790796412038749080589962404088890138</span></span><br><span class="line"><span class="string">n = 2345049742327685796181532105032554795628696111708534285951012187089560814230641663133312117797131139088986342455315166062482479446527815702735474197358418746066993291802284464812612727625991647573889402281825863578807474887341632160586307943897790827019291411639756252138594856687013363652094621849674259604512491449809337670874218320926522274379234396955495643125680407916326561528774056618181536326260093822819468635513422755218190798616168156924793527386350080400722536575372660262573683231490166520738579903818495107264328324326819989553511070207494208500239603511665056894947107356065440333537271115434438827753</span></span><br><span class="line"><span class="string">e = 1560967245790387854530279132085915310737094193704812456970549221459036227794862560384548159924112528879771688534015861357630951162558357151823378870345945435342412220708167081427844035498174919749839232806280901968067512188264340755833308035745702731211924571583963089915893479992177245815565483658484702813753029786985027579475059989141119719224961817402605977566829967197490932672021566512826377376988752959467389833419735737545201988916590880487156074463948048461415870071893002222885078350961871888123567241990517365430474025391208925638731208820904957752596249597885523540692851123131898267246576902438472358221</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>没能力根据论文实现攻击</p>
<blockquote>
<p>exp</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/zarismine">zarismine (zarismine) (github.com)</a></p>
<h2 id="2024-New-Setback"><a href="#2024-New-Setback" class="headerlink" title="*2024_New_Setback"></a>*2024_New_Setback</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user:mumu666</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, Curve</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">happy</span>(<span class="params">C, P</span>):</span><br><span class="line">    c, d, p = C</span><br><span class="line">    u, v = P</span><br><span class="line">    <span class="keyword">return</span> (u**<span class="number">2</span> + v**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * u**<span class="number">2</span>*v**<span class="number">2</span>)) % p == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">C, P, Q</span>):</span><br><span class="line">    c, d, p = C</span><br><span class="line">    u1, v1 = P</span><br><span class="line">    u2, v2 = Q</span><br><span class="line">    <span class="keyword">assert</span> happy(C, P) <span class="keyword">and</span> happy(C, Q)</span><br><span class="line">    u3 = (u1 * v2 + v1 * u2) * inverse(c * (<span class="number">1</span> + d * u1 * u2 * v1 * v2), p) % p</span><br><span class="line">    v3 = (v1 * v2 - u1 * u2) * inverse(c * (<span class="number">1</span> - d * u1 * u2 * v1 * v2), p) % p</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(u3), <span class="built_in">int</span>(v3))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">year</span>(<span class="params">C, P, m</span>):</span><br><span class="line">    <span class="keyword">assert</span> happy(C, P)</span><br><span class="line">    c, d, p = C</span><br><span class="line">    B = <span class="built_in">bin</span>(m)[<span class="number">2</span>:]</span><br><span class="line">    l = <span class="built_in">len</span>(B)</span><br><span class="line">    u, v = P</span><br><span class="line">    PP = (-u, v)</span><br><span class="line">    O = new(C, P, PP)</span><br><span class="line">    Q = O</span><br><span class="line">    <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line">    <span class="keyword">elif</span> m == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> P</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l-<span class="number">1</span>):</span><br><span class="line">            P = new(C, P, P)</span><br><span class="line">        m = m - <span class="number">2</span>**(l-<span class="number">1</span>)</span><br><span class="line">        Q, P = P, (u, v)</span><br><span class="line">        <span class="keyword">return</span> new(C, Q, year(C, P, m))</span><br><span class="line"></span><br><span class="line">c, d, p = Curve</span><br><span class="line"></span><br><span class="line">flag = flag.lstrip(<span class="string">b&#x27;SICTF&#123;&#x27;</span>).rstrip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">l_flag, r_flag = flag[:l // <span class="number">2</span>], flag[l // <span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">m1, m2 = bytes_to_long(l_flag), bytes_to_long(r_flag)</span><br><span class="line"><span class="keyword">assert</span> m1 &lt; p <span class="keyword">and</span> m2 &lt; p</span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;happy(C, P) = <span class="subst">&#123;happy(Curve, P)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;happy(C, Q) = <span class="subst">&#123;happy(Curve, Q)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;P = <span class="subst">&#123;P&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Q = <span class="subst">&#123;Q&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m1 * P = <span class="subst">&#123;year(Curve, P, m1)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m2 * Q = <span class="subst">&#123;year(Curve, Q, m2)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">happy(C, P) = True</span></span><br><span class="line"><span class="string">happy(C, Q) = True</span></span><br><span class="line"><span class="string">P = (398011447251267732058427934569710020713094, 548950454294712661054528329798266699762662)</span></span><br><span class="line"><span class="string">Q = (139255151342889674616838168412769112246165, 649791718379009629228240558980851356197207)</span></span><br><span class="line"><span class="string">m1 * P = (730393937659426993430595540476247076383331, 461597565155009635099537158476419433012710)</span></span><br><span class="line"><span class="string">m2 * Q = (500532897653416664117493978883484252869079, 620853965501593867437705135137758828401933) </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>happy(C,P)</code>的作用是验证点P是否在曲线C上面</p>
<p>根据<code>happy</code>函数我们可以知道对于曲线上的点G$(x,y)$满足<br>$$<br>x^2 + y^2 \equiv c^2\times (1+dx^2y^2) \mod p<br>$$<br>可知这是一条a&#x3D;1时候的扭曲爱德华曲线(Edwards Curve),不知道(ps:我也不太了解)的读者可以看这篇文章<a target="_blank" rel="noopener" href="https://learnblockchain.cn/article/1610">区块链中的数学 - 爱德华曲线方程 | 登链社区 | 区块链技术社区 (learnblockchain.cn)</a></p>
<p>我们首先要做的是恢复参数	</p>
<h3 id="恢复参数"><a href="#恢复参数" class="headerlink" title="恢复参数"></a>恢复参数</h3><p>取曲线上任意两点$G_1(x_1,y_1),G_2(x_2,y_2)$有<br>$$<br>x_1^2 + y_1^2 \equiv c^2\times (1+dx_1^2y_1^2) \mod p<br>$$</p>
<p>$$<br>x_2^2 + y_2^2 \equiv c^2\times (1+dx_2^2y_2^2) \mod p<br>$$</p>
<p>对两个式子相减有<br>$$<br>(x_1^2-x_2^2)+(y_1^2-y_2^2) \equiv c^2d(x_1^2y_1^2-x_2^2y_2^2) \mod p<br>$$<br>为了简化符号，我们记$A_{i,j} &#x3D; (x_i^2-x_j^2) + (y_i^2-y_j^2)$,$B_{i,j} &#x3D; x_i^2y_i^2 - x_j^2y_j^2$</p>
<p>也就是<br>$$<br>A_{1,2} - c^2d\times B_{1,2} \equiv 0 \mod p<br>$$<br>这里$c,d$均未知，所以我们把$c^2d$放等号右边，有<br>$$<br>\frac{A_{1,2}}{B_{1,2}} \equiv c^2d \mod p<br>$$<br>同理，我们再取两个点$G_3(x_3,y_3),G_4(x_4,y_4)$，有<br>$$<br>A_{3,4} - c^2d\times B_{3,4} &#x3D; k_2p<br>$$</p>
<p>$$<br>\frac{A_{3,4}}{B_{3,4}} \equiv c^2d \mod p<br>$$</p>
<p>再把两个$c^2d$式子相减有<br>$$<br>\frac{A_{1,2}}{B_{1,2}} - \frac{A_{3,4}}{B_{3,4}} \equiv 0 \mod p<br>$$<br>通分一下有<br>$$<br>A_{1,2} \times B_{3,4} - B_{1,2}\times A_{3,4} &#x3D; k_1p<br>$$<br>我们对$G_1(x_1,y_1),G_2(x_2,y_2),G_3(x_3,y_3),G_4(x_4,y_4)$四个点作不同的减法组合，可以得到不同的$kp$</p>
<p>第一组，我们取$G_1,G_2$这一对和$G_3,G_4$这一对</p>
<p>第二组，我们取$G_1,G_3$这一对和$G_2,G_4$这一对</p>
<p>第一组的结果是$A_{1,2} \times B_{3,4} - B_{1,2}\times A_{3,4} &#x3D; k_1p$</p>
<p>第二组的结果是$A_{1,3} \times B_{2,4} - B_{1,3}\times A_{2,4} &#x3D; k_2p$</p>
<p>再求最大公因数，即可得到p，这个p可能会是p的倍数，这个倍数不会太大，除掉即可</p>
<p>得到p之后</p>
<p>通过$A_{1,2} - c^2d\times B_{1,2} \equiv 0 \mod p$</p>
<p>可知$c^2d \equiv A_{1,2}\times B_{1,2}^{-1} \mod p$</p>
<p>回到$x^2 + y^2 \equiv c^2\times (1+dx^2y^2) \mod p$</p>
<p>可知$c^2 \equiv x^2+y^2 -c^2dx^2y^2 \mod p$，以及$d \equiv (x^2+y^2-c^2)\times (c^2x^2y^2)^{-1} \mod p$</p>
<p>到此参数便恢复完成</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_A</span>(<span class="params">G1,G2</span>):</span><br><span class="line">    x1,y1 = G1</span><br><span class="line">    x2,y2 = G2</span><br><span class="line">    A = x1^<span class="number">2</span> - x2^<span class="number">2</span> + y1^<span class="number">2</span> - y2^<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_B</span>(<span class="params">G1,G2</span>):</span><br><span class="line">    x1,y1 = G1</span><br><span class="line">    x2,y2 = G2</span><br><span class="line">    B = x1^<span class="number">2</span>*y1^<span class="number">2</span> - x2^<span class="number">2</span>*y2^<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_p</span>(<span class="params">G1,G2,G3,G4</span>):</span><br><span class="line">    A12,B12 = Get_A(G1,G2),Get_B(G1,G2)</span><br><span class="line">    A34,B34 = Get_A(G3,G4),Get_B(G3,G4)</span><br><span class="line">    temp1 = A12 * B34 - B12 * A34</span><br><span class="line">    A13,B13 = Get_A(G1,G3),Get_B(G1,G3)</span><br><span class="line">    A24,B24 = Get_A(G2,G4),Get_B(G2,G4)</span><br><span class="line">    temp2 = A13 * B24 - B13 * A24</span><br><span class="line">    may_p = gmpy2.gcd(temp1,temp2)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">2</span>^<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">if</span> may_p % i == <span class="number">0</span>:</span><br><span class="line">            may_p = may_p // i</span><br><span class="line">    <span class="keyword">return</span> may_p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_c_d</span>(<span class="params">G1,G2,p</span>):</span><br><span class="line">    A12,B12 = Get_A(G1,G2),Get_B(G1,G2)</span><br><span class="line">    ccd = (A12*gmpy2.invert(B12,p)) % p</span><br><span class="line">    x1,y1 = G1</span><br><span class="line">    cc = (x1^<span class="number">2</span> + y1^<span class="number">2</span> - ccd * x1^<span class="number">2</span> * y1^<span class="number">2</span>) % p</span><br><span class="line">    d = (x1^<span class="number">2</span> + y1^<span class="number">2</span> - cc) * gmpy2.invert(cc*x1^<span class="number">2</span>*y1^<span class="number">2</span>,p) % p</span><br><span class="line">    F = Zmod(p)</span><br><span class="line">    c = F(cc).sqrt()</span><br><span class="line">    <span class="keyword">return</span> c,d</span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line">C1 = (<span class="number">730393937659426993430595540476247076383331</span>, <span class="number">461597565155009635099537158476419433012710</span>)  <span class="comment">#m1*P</span></span><br><span class="line">C2 = (<span class="number">500532897653416664117493978883484252869079</span>, <span class="number">620853965501593867437705135137758828401933</span>)  <span class="comment">#m2*Q</span></span><br><span class="line"></span><br><span class="line">p = Get_p(P,Q,C1,C2)</span><br><span class="line">c,d = get_c_d(P,Q,p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;d = <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>需要注意的是，c是通过求解$c^2 \equiv cc \mod p$得到的。有两个c</p>
<h3 id="曲线映射"><a href="#曲线映射" class="headerlink" title="曲线映射"></a>曲线映射</h3><p>注意到$p - 1$是光滑的，把曲线从Edwards Curve映射到Weierstrass Curve，然后解离散对数</p>
<p>映射过程是从Twisted Edwards Curve到Montgomery Curve最后到Weierstrass Curve</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">903968861315877429495243431349919213155709</span></span><br><span class="line">c = <span class="number">662698094423288904843781932253259903384619</span> <span class="comment"># or p - c</span></span><br><span class="line">d = <span class="number">540431316779988345188678880301417602675534</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">P.&lt;z&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把扭曲爱德华曲线映射到蒙哥马利曲线</span></span><br><span class="line">aa = a</span><br><span class="line">dd = (d*c^<span class="number">4</span>)%p</span><br><span class="line">J = (<span class="number">2</span>*(aa+dd)*inverse(aa-dd,p))%p</span><br><span class="line">K = (<span class="number">4</span>*inverse(aa-dd,p))%p</span><br><span class="line">A = ((<span class="number">3</span>-J^<span class="number">2</span>)*inverse(<span class="number">3</span>*K^<span class="number">2</span>,p))%p</span><br><span class="line">B = ((<span class="number">2</span>*J^<span class="number">3</span>-<span class="number">9</span>*J)*inverse(<span class="number">27</span>*K^<span class="number">3</span>,p))%p</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  P(z^<span class="number">3</span>+A*z+B).roots():</span><br><span class="line">    alpha = <span class="built_in">int</span>(i[<span class="number">0</span>])</span><br><span class="line">    <span class="comment">#print(kronecker(3*alpha^2+A,p))</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> P(z^<span class="number">2</span>-(<span class="number">3</span>*alpha^<span class="number">2</span>+A)).roots():</span><br><span class="line">        s = <span class="built_in">int</span>(j[<span class="number">0</span>])</span><br><span class="line">        s = inverse_mod(s, p)</span><br><span class="line">        <span class="keyword">if</span> J==alpha*<span class="number">3</span>*s%p:</span><br><span class="line">            Alpha = alpha</span><br><span class="line">            S = s</span><br><span class="line"><span class="comment"># 扭曲爱德华映射到 Weierstrass形式(其中经过蒙哥马利转换)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">twist_to_weier</span>(<span class="params">x,y</span>):</span><br><span class="line">    v = x*inverse(c,p)%p</span><br><span class="line">    w = y*inverse(c,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (aa*v^<span class="number">2</span>+w^<span class="number">2</span>)%p==(<span class="number">1</span>+dd*v^<span class="number">2</span>*w^<span class="number">2</span>)%p</span><br><span class="line">    s = (<span class="number">1</span>+w)*inverse_mod(<span class="number">1</span>-w,p)%p</span><br><span class="line">    t = s*inverse(v,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (K*t^<span class="number">2</span>)%p==(s^<span class="number">3</span>+J*s^<span class="number">2</span>+s)%p</span><br><span class="line">    xW = (<span class="number">3</span>*s+J) * inverse_mod(<span class="number">3</span>*K, p) % p</span><br><span class="line">    yW = t * inverse_mod(K, p) % p</span><br><span class="line">    <span class="keyword">assert</span> yW^<span class="number">2</span> % p == (xW^<span class="number">3</span>+A*xW+B) % p</span><br><span class="line">    <span class="keyword">return</span> (xW,yW)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">weier_to_twist</span>(<span class="params">x,y</span>):</span><br><span class="line">    xM=S*(x-Alpha)%p</span><br><span class="line">    yM=S*y%p</span><br><span class="line">    <span class="keyword">assert</span> (K*yM^<span class="number">2</span>)%p==(xM^<span class="number">3</span>+J*xM^<span class="number">2</span>+xM)%p</span><br><span class="line">    xe = xM*inverse_mod(yM,p)%p</span><br><span class="line">    ye = (xM-<span class="number">1</span>)*inverse_mod(xM+<span class="number">1</span>,p)%p</span><br><span class="line">    <span class="keyword">assert</span> (aa*xe^<span class="number">2</span>+ye^<span class="number">2</span>)%p==(<span class="number">1</span>+dd*xe^<span class="number">2</span>*ye^<span class="number">2</span>)%p</span><br><span class="line">    xq = xe*c%p</span><br><span class="line">    yq = ye*c%p</span><br><span class="line">    <span class="keyword">assert</span> (a*xq^<span class="number">2</span>+yq^<span class="number">2</span>)%p==c^<span class="number">2</span>*(<span class="number">1</span>+d*xq^<span class="number">2</span>*yq^<span class="number">2</span>)%p</span><br><span class="line">    <span class="keyword">return</span> (xq,yq)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line">C1 = (<span class="number">730393937659426993430595540476247076383331</span>, <span class="number">461597565155009635099537158476419433012710</span>)</span><br><span class="line">C2 = (<span class="number">500532897653416664117493978883484252869079</span>, <span class="number">620853965501593867437705135137758828401933</span>) </span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p), [A, B])</span><br><span class="line">newP = twist_to_weier(P[<span class="number">0</span>],P[<span class="number">1</span>])</span><br><span class="line">newQ = twist_to_weier(Q[<span class="number">0</span>],Q[<span class="number">1</span>])</span><br><span class="line">newC1 = twist_to_weier(C1[<span class="number">0</span>],C1[<span class="number">1</span>])</span><br><span class="line">newC2 = twist_to_weier(C2[<span class="number">0</span>],C2[<span class="number">1</span>])</span><br><span class="line">P = E(newP)</span><br><span class="line">Q = E(newQ)</span><br><span class="line">C1 = E(newC1)</span><br><span class="line">C2 = E(newC2)</span><br><span class="line"></span><br><span class="line">m1 = P.discrete_log(C1)</span><br><span class="line">m2 = Q.discrete_log(C2)</span><br><span class="line">flag = <span class="string">b&quot;SICTF&#123;&quot;</span> + long_to_bytes(<span class="built_in">int</span>(m1)) + long_to_bytes(<span class="built_in">int</span>(m2)) + <span class="string">b&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># SICTF&#123;nOt_50_3a5Y_Edw4rDs_3LlipT!c_CURv3&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="关于曲线形式的文章"><a href="#关于曲线形式的文章" class="headerlink" title="关于曲线形式的文章"></a>关于曲线形式的文章</h3><p><a target="_blank" rel="noopener" href="https://learnblockchain.cn/article/1610">区块链中的数学 - 爱德华曲线方程 | 登链社区 | 区块链技术社区 (learnblockchain.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://learnblockchain.cn/article/1627">区块链中的数学-爱德华曲线运算的几何意义 | 登链社区 | 区块链技术社区 (learnblockchain.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://learnblockchain.cn/article/1641">区块链中的数学-蒙哥马利曲线和应用实例Curve25519 | 登链社区 | 区块链技术社区 (learnblockchain.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://learnblockchain.cn/article/1529">区块链中的数学-椭圆曲线的背景及基本性质 | 登链社区 | 区块链技术社区 (learnblockchain.cn)</a></p>
<p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2021/01/20/crypto-%E6%9B%B2%E7%BA%BF/">曲线 | Lazzaro (lazzzaro.github.io)</a></p>
<p>曲线转换：<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/290541183">(12 封私信) Curve25519曲线是什么？ - 知乎 (zhihu.com)</a></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="GeekChallenge"><a href="#GeekChallenge" class="headerlink" title="GeekChallenge"></a>GeekChallenge</h2><p>根据提示得知password的字符只有5种，而且长度为114</p>
<p>爆破即可</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;yuanshen.life&quot;</span>,<span class="number">33864</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">password = [<span class="number">0</span>] * <span class="number">114</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">    msg = <span class="built_in">chr</span>(i) * <span class="number">114</span></span><br><span class="line">    sh.sendline(msg.encode())</span><br><span class="line">    a = sh.recvline().decode().split(<span class="string">&quot;&gt;&quot;</span>)[-<span class="number">1</span>].strip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;1&quot;</span> <span class="keyword">in</span> a:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; &quot;</span> + <span class="built_in">chr</span>(i) + <span class="string">&quot;在password中&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">            <span class="keyword">if</span> a[j] == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">                password[j] = <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line">pwd = <span class="string">&quot;&quot;</span>.join(password)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;password = <span class="subst">&#123;pwd&#125;</span>&quot;</span>)</span><br><span class="line">sh.sendline(pwd.encode())</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="真签到"><a href="#真签到" class="headerlink" title="真签到"></a>真签到</h2><p>010打开压缩包发现末尾有一串16进制</p>
<p><img src="/../../images/SICTF/8.png"></p>
<p><code>TVTTTVTXABYUXTXTXCARYYXAZCYYYUXV=</code></p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=zimu">文本加密为字母,可自设密码|文本在线加密解密工具 (qqxiuzi.cn)</a></p>
<p>解密得到<code>2024HappyNewYear</code></p>
<p>看音频文件的频谱：</p>
<p><img src="/../../images/SICTF/9.png"></p>
<p>另外一个jpg图片，猜测是steghide</p>
<p>这串字符作为密码，试了几种，最后密码是<code>givemeyourLAGRANGE</code></p>
<p><img src="/../../images/SICTF/7.png"></p>
<h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="Baby-C"><a href="#Baby-C" class="headerlink" title="Baby_C++"></a>Baby_C++</h2><p>打开ida就能看到flag</p>
<h2 id="Ez-pyc"><a href="#Ez-pyc" class="headerlink" title="Ez_pyc"></a>Ez_pyc</h2><h3 id="未更新之前的附件"><a href="#未更新之前的附件" class="headerlink" title="未更新之前的附件"></a>未更新之前的附件</h3><p>反编译(未更新的附件)得到</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.11.5 | packaged by Anaconda, Inc. | (main, Sep 11 2023, 13:26:23) [MSC v.1916 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: C:\Users\Administrator\Desktop\233.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2024-01-11 17:19:49</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 1082 bytes</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">k = [[<span class="string">&#x27;#&#x27;</span>] * <span class="number">10</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">9</span>] + [<span class="number">0</span>] * <span class="number">3</span> + [<span class="number">3</span>, <span class="number">0</span>, <span class="number">7</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">8</span>] + [<span class="number">0</span>] * <span class="number">8</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">4</span>] + [<span class="number">0</span>] * <span class="number">5</span> + [<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">4</span> + [<span class="number">3</span>] + [<span class="number">0</span>] * <span class="number">4</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">5</span>] + [<span class="number">0</span>] * <span class="number">3</span> + [<span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">7</span>] + [<span class="number">0</span>] * <span class="number">5</span> + [<span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">9</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">9</span>]</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">s = <span class="built_in">str</span>(<span class="built_in">int</span>(<span class="built_in">input</span>(), <span class="number">16</span>))</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> [<span class="built_in">str</span>(t) <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)]:</span><br><span class="line">            s[cnt + <span class="number">43690</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k[i])):</span><br><span class="line">                <span class="keyword">if</span> k[i][j] == <span class="number">0</span>:</span><br><span class="line">                    k[i][j] = <span class="built_in">int</span>(s[cnt])</span><br><span class="line">                    cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                    <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> k[i]:</span><br><span class="line">                        s[cnt + <span class="number">3735928559</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                    tmp = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">            tmp.append(k[j][i])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> tmp:</span><br><span class="line">                    s[cnt + <span class="number">3735928559</span>] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k), <span class="built_in">int</span>(<span class="built_in">len</span>(k) ** <span class="number">0.5</span>)):</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k), <span class="built_in">int</span>(<span class="built_in">len</span>(k) ** <span class="number">0.5</span>)):</span><br><span class="line">                        square = [k[x][y] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(i, i + <span class="number">3</span>) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(j, j + <span class="number">3</span>)]</span><br><span class="line">                        <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                            <span class="keyword">if</span> t <span class="keyword">not</span> <span class="keyword">in</span> tmp:</span><br><span class="line">                                s[cnt + <span class="number">3735928559</span>] = <span class="number">2</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;SICTF&#123;%s&#125;&#x27;</span> % hashlib.md5(s.encode()).hexdigest())</span><br><span class="line">                            <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        e = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">del</span> e</span><br></pre></td></tr></table></figure>

<p>审计代码之后大致是解数独<br>$$<br>\begin{bmatrix}<br>? &amp; 1 &amp; 9 &amp; ? &amp; ? &amp; ? &amp; 3 &amp; ? &amp; 7\<br>8 &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ?\<br>4 &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; 2 &amp; ? &amp; ?\<br>? &amp; ? &amp; ? &amp; ? &amp; 3 &amp; ? &amp; ? &amp; ? &amp; ?\<br>5 &amp; ? &amp; ? &amp; ? &amp; 6 &amp; ? &amp; ? &amp; 2 &amp; ?\<br>? &amp; 7 &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; 3 &amp; 1\<br>? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ?\<br>? &amp; ? &amp; 8 &amp; ? &amp; 9 &amp; ? &amp; 7 &amp; ? &amp; ?\<br>? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ? &amp; ?<br>\end{bmatrix}<br>$$<br>拿在线网站解了一下</p>
<p>得到结果</p>
<p><img src="/../../images/SICTF/4.png"></p>
<p>依次修改矩阵K中为0的数</p>
<p>我们需要输入<code>2456835127469673891564192578837194925486324875196156342796214853</code>的16进制形式</p>
<p>即<code>5f8e46ab70fce3395aa40e33a4b9f781279a3eac0d62ae01ae245</code></p>
<p>得到flag:<code>SICTF&#123;600d3294869ed3c6361f3fd22a672aa0&#125;</code></p>
<h3 id="更新后的附件"><a href="#更新后的附件" class="headerlink" title="更新后的附件"></a>更新后的附件</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.4</span></span><br><span class="line"><span class="comment"># Python bytecode 3.8 (3413)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 3.11.5 | packaged by Anaconda, Inc. | (main, Sep 11 2023, 13:26:23) [MSC v.1916 64 bit (AMD64)]</span></span><br><span class="line"><span class="comment"># Embedded file name: E:\CTF赛题\ez_pyc\233.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2024-02-16 09:19:13</span></span><br><span class="line"><span class="comment"># Size of source mod 2**32: 1178 bytes</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">k = [[<span class="string">&#x27;#&#x27;</span>] * <span class="number">10</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">9</span>] + [<span class="number">0</span>] * <span class="number">3</span> + [<span class="number">3</span>, <span class="number">0</span>, <span class="number">7</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">8</span>] + [<span class="number">0</span>] * <span class="number">8</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">4</span>] + [<span class="number">0</span>] * <span class="number">5</span> + [<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">4</span> + [<span class="number">3</span>] + [<span class="number">0</span>] * <span class="number">4</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">5</span>] + [<span class="number">0</span>] * <span class="number">3</span> + [<span class="number">6</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">7</span>] + [<span class="number">0</span>] * <span class="number">5</span> + [<span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">9</span>,</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line"> [</span><br><span class="line">  <span class="string">&#x27;#&#x27;</span>] + [<span class="number">0</span>] * <span class="number">9</span>]</span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line">s = <span class="built_in">str</span>(<span class="built_in">int</span>(<span class="built_in">input</span>(), <span class="number">16</span>))</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> [<span class="built_in">str</span>(t) <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>)]:</span><br><span class="line">            s[cnt + <span class="number">43690</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k[i])):</span><br><span class="line">                <span class="keyword">if</span> k[i][j] == <span class="number">0</span>:</span><br><span class="line">                    k[i][j] = <span class="built_in">int</span>(s[cnt])</span><br><span class="line">                    cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                    <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> k[i]:</span><br><span class="line">                        s[cnt + <span class="number">3735928559</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                    tmp = []</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                        tmp.append(k[j][i])</span><br><span class="line"></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                        <span class="keyword">if</span> j <span class="keyword">not</span> <span class="keyword">in</span> tmp:</span><br><span class="line">                            s[cnt + <span class="number">3735928559</span>] = <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k), <span class="built_in">int</span>(<span class="built_in">len</span>(k) ** <span class="number">0.5</span>)):</span><br><span class="line">                            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k), <span class="built_in">int</span>(<span class="built_in">len</span>(k) ** <span class="number">0.5</span>)):</span><br><span class="line">                                square = [k[x][y] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(i, i + <span class="number">3</span>) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(j, j + <span class="number">3</span>)]</span><br><span class="line">                                <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(k)):</span><br><span class="line">                                    <span class="keyword">if</span> t <span class="keyword">not</span> <span class="keyword">in</span> tmp:</span><br><span class="line">                                        s[cnt + <span class="number">3735928559</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            m = hashlib.md5(s.encode()).hexdigest()</span><br><span class="line">                            <span class="keyword">if</span> m == <span class="string">&#x27;60b845d09f7b818a1e1e6cd0f4a04d96&#x27;</span>:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">&#x27;SICTF&#123;%s&#125;&#x27;</span> % m)</span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">&#x27;试着换一种解嘞qwq&#x27;</span>)</span><br><span class="line">                            <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        e = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">del</span> e</span><br></pre></td></tr></table></figure>

<p>这里把<code>m = 60b845d09f7b818a1e1e6cd0f4a04d96</code>泄露</p>
<p>flag:<code>SICTF&#123;60b845d09f7b818a1e1e6cd0f4a04d96&#125;</code></p>
<h1 id="Forensics"><a href="#Forensics" class="headerlink" title="Forensics"></a>Forensics</h1><h2 id="OSINT签到"><a href="#OSINT签到" class="headerlink" title="OSINT签到"></a>OSINT签到</h2><p>谷歌识图，定位到海口大英山机场附近</p>
<p><img src="/../../images/SICTF/3.png"></p>
<p>海口大英山机场现在叫海口美兰国际机场</p>
<p>在海口美兰国际机场附近找有大片湖泊的公园</p>
<p>最后为红城湖公园</p>
<p><code>SICTF&#123;海南省_海口市_琼山区_红城湖公园&#125;</code></p>
<h2 id="这才是签到"><a href="#这才是签到" class="headerlink" title="这才是签到"></a>这才是签到</h2><p>谷歌识图定位到意大利威尼斯</p>
<p><img src="/../../images/SICTF/0.png"></p>
<p>这篇文章的图片拿去识图，为达涅利酒店</p>
<p><img src="/../../images/SICTF/1.png"></p>
<p>谷歌卫星地图<a target="_blank" rel="noopener" href="https://www.earthol.com/">卫星地图-Google Earth高清卫星地图-谷歌地图-地球在线 (earthol.com)</a></p>
<p>找达涅利酒店，定位拍摄地点为GondolaDanieli</p>
<p><img src="/../../images/SICTF/2.png"></p>
<p>寻找附近的酒店和教堂等景点</p>
<p>最后<code>SICTF&#123;意大利_威尼斯_GondolaDanieli_ChiesadiSanZaccaria&#125;</code></p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/" title="SICTFround3">https://dexterjie.github.io/2024/02/16/赛题复现/SICTFround3/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/02/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024HGAME/" rel="prev" title="2024HGAME">
                  <i class="fa fa-chevron-left"></i> 2024HGAME
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/02/20/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/VNCTF2024/" rel="next" title="VNCTF2024">
                  VNCTF2024 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">258k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">15:36</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/02/16/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTFround3/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
