<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录些近期做的题目">
<meta property="og:type" content="article">
<meta property="og:title" content="杂记(二)">
<meta property="og:url" content="https://dexterjie.github.io/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录些近期做的题目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/9.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/8.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/25.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/15.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/34.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E6%9D%82/35.png">
<meta property="article:published_time" content="2024-02-29T13:59:02.000Z">
<meta property="article:modified_time" content="2024-04-12T07:45:42.589Z">
<meta property="article:author" content="DexterJie">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/%E6%9D%82/9.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/","path":"2024/02/29/杂记-二/","title":"杂记(二)"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>杂记(二) | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91"><span class="nav-number">1.</span> <span class="nav-text">2022西湖论剑</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E2%80%94%E2%80%94LockbyLock"><span class="nav-number">1.1.</span> <span class="nav-text">2022西湖论剑——LockbyLock</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E2%80%94%E2%80%94MyErrorLearn"><span class="nav-number">1.2.</span> <span class="nav-text">2022西湖论剑——MyErrorLearn</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E2%80%94%E2%80%94MyErrorLearnTwice"><span class="nav-number">1.3.</span> <span class="nav-text">2022西湖论剑——MyErrorLearnTwice</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2023%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91"><span class="nav-number">2.</span> <span class="nav-text">2023西湖论剑</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2023%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E2%80%94%E2%80%94Or1cle"><span class="nav-number">2.1.</span> <span class="nav-text">2023西湖论剑——Or1cle</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F"><span class="nav-number">2.1.1.</span> <span class="nav-text">非预期</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2022-%E7%8E%84%E6%AD%A6%E7%BB%84%E2%80%94%E2%80%94crypto557"><span class="nav-number">3.</span> <span class="nav-text">网鼎杯 2022 玄武组——crypto557</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2022-%E9%9D%92%E9%BE%99%E7%BB%84%E2%80%94%E2%80%94Grasshopper"><span class="nav-number">4.</span> <span class="nav-text">网鼎杯 2022 青龙组——Grasshopper</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#osuCTF"><span class="nav-number">5.</span> <span class="nav-text">osuCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%AA%E6%9E%9D"><span class="nav-number">5.1.</span> <span class="nav-text">剪枝</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LCG%E6%B3%84%E9%9C%B2%E4%BD%8E%E4%BD%8D"><span class="nav-number">5.2.</span> <span class="nav-text">LCG泄露低位</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HSCCTF-2024"><span class="nav-number">6.</span> <span class="nav-text">HSCCTF 2024</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#EzMath"><span class="nav-number">6.1.</span> <span class="nav-text">EzMath</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#simple-rsa"><span class="nav-number">7.</span> <span class="nav-text">simple_rsa</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">72</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="杂记(二) | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          杂记(二)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-02-29 21:59:02" itemprop="dateCreated datePublished" datetime="2024-02-29T21:59:02+08:00">2024-02-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-04-12 15:45:42" itemprop="dateModified" datetime="2024-04-12T15:45:42+08:00">2024-04-12</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>20 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录些近期做的题目</p>
<span id="more"></span>

<h1 id="2022西湖论剑"><a href="#2022西湖论剑" class="headerlink" title="2022西湖论剑"></a>2022西湖论剑</h1><h2 id="2022西湖论剑——LockbyLock"><a href="#2022西湖论剑——LockbyLock" class="headerlink" title="2022西湖论剑——LockbyLock"></a>2022西湖论剑——LockbyLock</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Lock</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, p, q</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.p = p</span><br><span class="line">            self.q = q</span><br><span class="line">            self.n = self.p * self.q</span><br><span class="line">            self.e = random.randint(<span class="number">10</span>**<span class="number">14</span>, <span class="number">10</span>**<span class="number">15</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> gcd(self.e, (self.p-<span class="number">1</span>)*(self.q-<span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">                self.d = invert(self.e, (self.p-<span class="number">1</span>)*(self.q-<span class="number">1</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">lock</span>(<span class="params">self, message: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> &lt; message &lt; self.n</span><br><span class="line">        <span class="keyword">return</span> powmod(message, self.e, self.n)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">unlock</span>(<span class="params">self, cipher: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> &lt; cipher &lt; self.n</span><br><span class="line">        <span class="keyword">return</span> powmod(cipher, self.d, self.n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secureProcedure</span>(<span class="params">A, B</span>):</span><br><span class="line">    <span class="keyword">global</span> flag</span><br><span class="line">    flag = bytes_to_long(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock lock lock lock unlock&#x27;</span>)</span><br><span class="line">    msg1 = A.lock(flag)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Alice: locked msg1 = <span class="subst">&#123;msg1&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock lock lock lock&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock unlock lock lock&#x27;</span>)</span><br><span class="line">    msg2 = B.lock(msg1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Bob: locked msg2 = <span class="subst">&#123;msg2&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock lock lock&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: unlock unlock unlock...&#x27;</span>)</span><br><span class="line">    msg3 = A.unlock(msg2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Alice: unlocked msg3 = <span class="subst">&#123;msg3&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock lock lock lock&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: unlock unlock unlock...&#x27;</span>)</span><br><span class="line">    msg = B.unlock(msg3)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> msg == flag</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock unlock&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock by lock, lock lock right, unlock unlock unlock...&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: right right, lock lock unlock&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock lock, flag lock lock lock.&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock unlock lock lock, unlock lock lock&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock!&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxyProcedure</span>(<span class="params">A, B</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Agent: lock lock, lock lock lock, unlock lock lock right&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock!&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock, unlock lock!&#x27;</span>)</span><br><span class="line">    omsg = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock lock lock lock unlock&#x27;</span>)</span><br><span class="line">    msg1 = A.lock(omsg)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Alice: locked msg1 = <span class="subst">&#123;msg1&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock lock lock lock&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock unlock lock lock&#x27;</span>)</span><br><span class="line">    msg2 = B.lock(msg1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Bob: locked msg2 = <span class="subst">&#123;msg2&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock lock lock&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: unlock unlock unlock...&#x27;</span>)</span><br><span class="line">    msg3 = A.unlock(msg2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Alice: unlocked msg3 = <span class="subst">&#123;msg3&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: lock lock lock lock&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: unlock unlock unlock...&#x27;</span>)</span><br><span class="line">    msg = B.unlock(msg3)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">assert</span> msg == omsg</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock, lock, locked lock lock lock unlock&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock by lock, lock lock right, lock unlock unlock unlock...&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Alice: right right, locked lock lock lock unlock&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Bob: lock lock!&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    AliceLock = Lock(p, q)</span><br><span class="line">    BobLock = Lock(p, q)</span><br><span class="line">    </span><br><span class="line">    secureProcedure(AliceLock, BobLock)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        proxyProcedure(AliceLock, BobLock)</span><br><span class="line">        proxyProcedure(AliceLock, BobLock)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Lock: lock lock lock, unlock lock lock lock, lock lock unlock lock unlock lock, lock.&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;lock unlock, lock locked, unlocked lock&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>审计代码得知<br>$$<br>msg_1 \equiv flag^{e_1} \mod n<br>$$</p>
<p>$$<br>msg_2 \equiv flag^{e_1*e_2} \mod n<br>$$</p>
<p>$$<br>msg_3 \equiv flag^{e_2} \mod n<br>$$</p>
<p>服务器给了两次<code>proxyProcedure()</code>的机会</p>
<p>通过<code>proxyProcedure()</code>我们可以得到3段密文</p>
<p>于是，我们输入<code>2</code>可得<br>$$<br>c_1 \equiv 2^{e_1} \mod n<br>$$</p>
<p>$$<br>c_2 \equiv 2^{e_1*e_2} \mod n<br>$$</p>
<p>$$<br>c_3 \equiv 2^{e_2} \mod n<br>$$</p>
<p>再输入<code>4</code>可得<br>$$<br>cc_1 \equiv 4^{e_1} \mod n<br>$$</p>
<p>$$<br>cc_2 \equiv 4^{e_1*e_2} \mod n<br>$$</p>
<p>$$<br>cc_3 \equiv 4^{e_2} \mod n<br>$$</p>
<p>把得到的两组密文进行组合，求得n。eg:$n &#x3D; gcd(c_1^2-cc_1,c_3^2-cc_3)$</p>
<p>再求解离散对数获得$e_1,e_2$（$10^{14}-10^{15}$大概几分钟）</p>
<p>再共模攻击</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1 = [<span class="number">8919686474918897168952707528612673476553786170801874964846124642381101742458542901830715980268623452966929900752858132438049227721458797460208284488780251775873246769330504302287407994319765869577906215349894658046577390388263589451001732598244036632984412842562489431047594491566838467764983466958980842137844677536462841351093174828887606793643068632029093558130789058597121248035054616064617223778747297125600126660576460060955869895521110712425293590190315342597318561479687856366871472497231392109572085060634379088016694764906328293260246308300814975705006670492500134392078342888450718601718022222930993217282</span>,<span class="number">7425518761994523073317364198947537442910885783906259167922831759980921168251754242069499709256145711530304827273647092602876125639390345250799155815552973274271252681365048383883276690297570135123140317311822486820469382365121145117987684635353219860768514397727531948192217069650335367422468548793299897763378603239057978280786893878765285050377795007037327434151657937614915353291680672904480481007754966874445330490973360536524163265310316559276582521483773857931781035768657973137352302775712706167004357095712599553396034676939636243002510825564410102241257798548639491115779622467253153775728235240585307152220</span>,<span class="number">2181617192203661371735017429198359162025737220087292110511761294058994571110199418171508100871522936260815601099943610508062418354760460212007371379965312164347042760948453091027937608680972160660922852831321012001170313405282852695406864646594343019500600244293499453602954148451046674137010317368810968694921777372589439694486685444784368840750489911337547486361578130125527592186113274198383286718186344218718128274401041586797422577425053217277884781032962785854168676156369097197255913481111686453434425750750756198518882743512813182526191431261206629117677430322615123656908000515270191493488669189654571151751</span>]</span><br><span class="line">c2 = [<span class="number">14171898980683650703815823847617062194657416048901605497683325789644283283142462222704392691935282200835680484710371199815708437414455858753316025648847278736734706547605791804640257506333720487484751993950790713766493435260578130140865576108228116847730834444896471531676115828422044059446021739901318240494138854046095499591654181834708962519053826072002918803533427412731274233361491855387600981920631551574272954469826462733368624850249019030343941656391400900426587970256715590448491140264303909013929718849975528390677173911504084434106882720162635719168218523726338018089817351448818087370461379922861021909713</span>,<span class="number">4860324160931804613459608271226507282150467135115350179864156987410506034051504290787680674119981385596563650589797251344620296331251716788646580253149097368340940984731009513388342050658541065281153662870532490604581093897306071132002827542237574363958475384451505396705074762830073742073864971463392248788973146151105753332464446669911841735820621741687451487332407322924989571202911174797144178489035778647173913241777729633238774307408660649739019370406319254293043292181100882609712233435119877867729739782865828025739689387156393991388981741717217281159767767553470723483112578556957696160678236801750337286609</span>,<span class="number">12515071316992093975741719272231454936929693495951674694172997083706049310755670153534121767294433058514225580906553776851865814795478321272092342551997846797037649833037566074844174515072710950746349594961819349192580271366294872867594238848278426203923887216598026509614305014075314177282823116599839442013642149783998673592468085477417954161078019541898301361883281802528559120809048579663299636400105773272580455451337572425678187752701749521381591061675445691734941125014540376523538795103366249623802898160724737265398273542166418851825022650158041768183017130500629477827250620222284836291969907830395844393509</span>]</span><br><span class="line">c3 = [<span class="number">369858427774169904461049227452782560932273390006843066948952113537902955230694241872630184876128533763539804666594986550600066729556996678424073928770758937798064281859152460682292334835525838558750960184667676458620169407136641190032250303181877597669650158309820288061918115940356003614885937404886651273550231251946895945371753347619244532318674385519281497124130634157967089514131092246785587398424697807103123014787468819604775392736417084514888658871516880552887289444751642253959645225606192133589859862177318750339212901834546879650869875347729488909022955107604363483972579779145559848329176980848913878070</span>,<span class="number">5654822427791974095246270532900190405950109607926280088377625546201144679670636916418191767454255193771537404495320329948460811648970795323928665802304017599628560376646415300140865793751181301698829644462758630246805539778990721719141629068609799643355921448991113823535040300166759700691992291039210552669941380818740641705272447221130347797777987693856808485682820997975665057551765604103729766946408295120655574617932634446928520077975913714743609551997907005944835003809338264936786195639188686278989010109386530859156260421210496165703425652796324045999507174633751258061125978685961702627123824708455687209741</span>,<span class="number">6155569487283245742338000777385393886764169967844501278631567721744713134419841108219959053313555353334271249860864935118896778532864637949013633814326038999921032159115696345763508445026649884667249919023787499592869832754972412246656741357999132911729154882795079570688109191827957004527558878904939490355358470701060618902959479823476014931295935435372965659522455979350055521071614497737255431370247076414625456625404880871040998212051411303494906394765756593993881824157076376480221771841635364602260257935196984813868974689691893745299732855490564826087524621730349145021388197162527326675817019202561118078174</span>]</span><br><span class="line"></span><br><span class="line">temp1 = c2[<span class="number">0</span>]**<span class="number">2</span> - c3[<span class="number">0</span>]</span><br><span class="line">temp2 = c2[<span class="number">1</span>]**<span class="number">2</span> - c3[<span class="number">1</span>]</span><br><span class="line">n = gmpy2.gcd(temp1,temp2)</span><br><span class="line"></span><br><span class="line">e1 = discrete_log_lambda(mod(c2[<span class="number">0</span>],n),mod(<span class="number">2</span>,n),(ZZ(<span class="number">10</span>^<span class="number">14</span>),ZZ(<span class="number">10</span>^<span class="number">15</span>)))</span><br><span class="line">e2 = discrete_log_lambda(mod(c2[<span class="number">2</span>],n),mod(<span class="number">2</span>,n),(ZZ(<span class="number">10</span>^<span class="number">14</span>),ZZ(<span class="number">10</span>^<span class="number">15</span>)))</span><br><span class="line">_,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">m = <span class="built_in">pow</span>(c1[<span class="number">0</span>],x,n)*<span class="built_in">pow</span>(c1[<span class="number">2</span>],y,n)%n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h2 id="2022西湖论剑——MyErrorLearn"><a href="#2022西湖论剑——MyErrorLearn" class="headerlink" title="2022西湖论剑——MyErrorLearn"></a>2022西湖论剑——MyErrorLearn</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">flag = os.getenv(<span class="string">&#x27;DASFLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = random.getrandbits(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&gt; mod =&#x27;</span>, p)</span><br><span class="line">secret = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XennyOracle</span>():</span><br><span class="line">    r = getPrime(<span class="number">512</span>)</span><br><span class="line">    d = invert(secret+r, p) - getPrime(<span class="number">246</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&gt; r =&#x27;</span>, r)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&gt; d =&#x27;</span>, d)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task</span>():</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        op = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">        <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">            XennyOracle()</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">2</span>:</span><br><span class="line">            ss = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ss == secret:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;flag: &#x27;</span>, flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    task()</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error. try again.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>已知<br>$$<br>d \equiv (secret + r)^{-1} -e \mod p<br>$$<br>则有<br>$$<br>(d_1+e_1)(secret+r_1) \equiv 1 \mod p<br>$$</p>
<p>$$<br>(d_2+e_2)(secret+r_2) \equiv 1 \mod p<br>$$</p>
<p>$e$的数量级为246bit，把secret消去后只有$e_1,e_2$两个未知数，再用二元copper求小根得到$e_1,e_2$</p>
<p>上面的式子乘$(d_2+e_2)$，下面式子乘$(d_1+e_1)$得<br>$$<br>(d_1+e_1)(d_2+e_2)(secret + r_1) \equiv d_2+e_2 \mod p<br>$$</p>
<p>$$<br>(d_1+e_1)(d_2+e_2)(secret + r_2) \equiv d_1+e_1 \mod p<br>$$</p>
<p>化简得<br>$$<br>(d_1+e_1)(d_2+e_2)(r_2-r_1) + (d_2+e_2)-(d_1+e_1) \equiv 0 \mod p<br>$$<br>用二元copper可解出$e_1,e_2$</p>
<p>再代入得$secret &#x3D; (d_1+e_1)^{-1} -r_1 \mod p$或者$secret &#x3D; (d_2+e_2)^{-1} - r_2 \mod p$</p>
<p>由于p不一定是素数，所以求逆元的时候可能不存在，多跑几次即可</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        sh = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28593</span>)</span><br><span class="line">        p = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        sh.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">        sh.recvline()</span><br><span class="line">        r1 = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        d1 = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        sh.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">        sh.recvline()</span><br><span class="line">        r2 = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        d2 = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        R.&lt;x,y&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"></span><br><span class="line">        f = (d1+x)*(d2+y)*(r2-r1)+(d2+y)-(d1+x)</span><br><span class="line">        e1,e2 = small_roots(f,bounds=(<span class="number">2</span>^<span class="number">246</span>,<span class="number">2</span>^<span class="number">246</span>))[<span class="number">0</span>]</span><br><span class="line">        s = inverse(<span class="built_in">int</span>(d1 + e1),p) - r1</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;s = <span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(s).encode())</span><br><span class="line">        sh.interactive()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<h2 id="2022西湖论剑——MyErrorLearnTwice"><a href="#2022西湖论剑——MyErrorLearnTwice" class="headerlink" title="2022西湖论剑——MyErrorLearnTwice"></a>2022西湖论剑——MyErrorLearnTwice</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">flag = os.getenv(<span class="string">&#x27;DASFLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = random.getrandbits(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&gt; mod =&#x27;</span>, p)</span><br><span class="line">secret = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XennyOracle</span>():</span><br><span class="line">    r = getPrime(<span class="number">512</span>)</span><br><span class="line">    d = invert(secret+r, p) - getPrime(<span class="number">328</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&gt; r =&#x27;</span>, r)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&gt; d =&#x27;</span>, d)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task</span>():</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        op = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">        <span class="keyword">if</span> op == <span class="number">1</span>:</span><br><span class="line">            XennyOracle()</span><br><span class="line">        <span class="keyword">elif</span> op == <span class="number">2</span>:</span><br><span class="line">            ss = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ss == secret:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;flag: &#x27;</span>, flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    task()</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Error. try again.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>与上题不同之处在于$e$变成了328bit的数，交互次数从3次提高到了16次</p>
<p>但328bit相对p的大小依旧是小量，而且可获得的数据有15组，可以用格解决</p>
<p>类似上题的推导<br>$$<br>(d_1+e_1)(d_2+e_2)(secret + r_1) \equiv d_2+e_2 \mod p<br>$$</p>
<p>$$<br>(d_1+e_1)(d_2+e_2)(secret + r_2) \equiv d_1+e_1 \mod p<br>$$</p>
<p>化简得<br>$$<br>(d_1+e_1)(d_2+e_2)(r_2-r_1) + (d_2+e_2)-(d_1+e_1) \equiv 0 \mod p<br>$$<br>我们每两组数据进行一次化简，便有了<br>$$<br>(d_1+e_1)(d_i+e_i)(r_i-r_1) + (d_i+e_i)-(d_1+e_1) \equiv 0 \mod p \quad \quad (2\le i \le 15)<br>$$<br>展开得<br>$$<br>e_1e_i(r_i-r_1) + e_i[d_1(r_i-r_1)+1] + e_1[d_i(r_i-r_1)-1] + [d_1d_i(r_i-r_1) + (d_i-d_1)] \equiv 0 \mod p<br>$$<br>记<br>$$<br>A_i &#x3D; r_i-r_1<br>$$</p>
<p>$$<br>B_i &#x3D; d_1(r_i-r_1) + 1<br>$$</p>
<p>$$<br>C_i &#x3D; d_i(r_i-r_1) - 1<br>$$</p>
<p>$$<br>D_i &#x3D; d_1d_i(r_i-r_1) + (d_i-d_1)<br>$$</p>
<p>则有<br>$$<br>A_ie_1e_i + B_ie_i + C_ie_1+D_i \equiv 0 \mod p<br>$$<br>即<br>$$<br>A_ie_1e_i + B_ie_i + C_ie_1+D_i + k_ip &#x3D; 0 \quad \quad (2\le i \le 15)<br>$$<br>构造格</p>
<p><img src="/../images/%E6%9D%82/9.png"></p>
<p>本人在做题的时候在格的规格这里有卡顿，如有同样疑惑的师傅可以静下来思考一下再往下。</p>
<p>$e_1e_i$共14个，$e_i$共15个，$k_i$共14个。因此格的规格是$44\times 44$</p>
<p>为了提高规约成功的概率，对格进行调平，最后的格如下：</p>
<p><img src="/../images/%E6%9D%82/8.png"></p>
<p>其中$T&#x3D; 2^{328},TT&#x3D;2^{328\times2},k &#x3D; 2^{328\times 3}$</p>
<p>得到$e_1$后，再代入得$secret &#x3D; (d_1+e_1)^{-1} -r_1 \mod p$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getData</span>():</span><br><span class="line">    p = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">    r = []</span><br><span class="line">    d = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        sh.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">        sh.recvline()</span><br><span class="line">        rr = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        dd = <span class="built_in">int</span>(sh.recvline().strip().decode().split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">        r.append(rr)</span><br><span class="line">        d.append(dd)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(r) == <span class="number">15</span> <span class="keyword">and</span> <span class="built_in">len</span>(d) == <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> r,d,p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getE</span>():</span><br><span class="line">    num = <span class="number">15</span></span><br><span class="line">    N = <span class="number">3</span>*num-<span class="number">1</span></span><br><span class="line">    T = <span class="number">2</span>^(<span class="number">328</span>*<span class="number">3</span>)</span><br><span class="line">    A = [r[i] - r[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,num)]</span><br><span class="line">    B = [d[<span class="number">0</span>]*(r[i] - r[<span class="number">0</span>]) + <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,num)]</span><br><span class="line">    C = [d[i]*(r[i] - r[<span class="number">0</span>]) - <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,num)]</span><br><span class="line">    D = [d[<span class="number">0</span>]*d[i]*(r[i] - r[<span class="number">0</span>]) + (d[i] - d[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,num)]</span><br><span class="line">    </span><br><span class="line">    Ge = Matrix(ZZ,N,N)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        Ge[i,i] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num-<span class="number">1</span>):</span><br><span class="line">        Ge[<span class="number">2</span>*num+i,<span class="number">2</span>*num+i] = p*T</span><br><span class="line">        </span><br><span class="line">        Ge[i,<span class="number">2</span>*num+i] = A[i]*T</span><br><span class="line">        Ge[num-<span class="number">1</span>,<span class="number">2</span>*num+i] = C[i]*T</span><br><span class="line">        Ge[num+i,<span class="number">2</span>*num+i] = B[i]*T</span><br><span class="line">        Ge[<span class="number">2</span>*num-<span class="number">1</span>,<span class="number">2</span>*num+i] = D[i]*T</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        Ge[num-<span class="number">1</span>+i,num-<span class="number">1</span>+i] = <span class="number">2</span>^<span class="number">328</span></span><br><span class="line">    Ge[<span class="number">2</span>*num-<span class="number">1</span>,<span class="number">2</span>*num-<span class="number">1</span>] = <span class="number">2</span>^(<span class="number">328</span>*<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">        <span class="keyword">if</span> line[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">            e1 = <span class="built_in">int</span>(<span class="built_in">abs</span>(line[<span class="number">14</span>]) // <span class="number">2</span>^<span class="number">328</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(e1).bit_length() == <span class="number">328</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;e1 = <span class="subst">&#123;e1&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> e1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getFlag</span>():</span><br><span class="line">    secret = (inverse(<span class="built_in">int</span>(d[<span class="number">0</span>]+e1),p) - r[<span class="number">0</span>]) % p</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;secret = <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(secret).encode())</span><br><span class="line">    sh.interactive()</span><br><span class="line">    </span><br><span class="line">sh = remote(<span class="string">&quot;node4.anna.nssctf.cn&quot;</span>,<span class="number">28661</span>)</span><br><span class="line">r,d,p = getData()</span><br><span class="line">e1 = getE()</span><br><span class="line">getFlag()</span><br></pre></td></tr></table></figure>

<h1 id="2023西湖论剑"><a href="#2023西湖论剑" class="headerlink" title="2023西湖论剑"></a>2023西湖论剑</h1><h2 id="2023西湖论剑——Or1cle"><a href="#2023西湖论剑——Or1cle" class="headerlink" title="2023西湖论剑——Or1cle"></a>2023西湖论剑——Or1cle</h2><p>无附件，通过getflag，输入的字符串，长度不是2的倍数，泄露源码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">signature</span>(<span class="params">self,msg</span>):</span><br><span class="line">    h = <span class="built_in">int</span>(hashlib.sha256(msg).hexdigest(),<span class="number">16</span>)</span><br><span class="line">    k = h^self.d</span><br><span class="line">    r = (k*secp256k1.G).x</span><br><span class="line">    s = inverse(k,secp256k1.q) * (h + r*self.d) % secp256k1.q</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;%064x%064x&#x27;</span> % (r, s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self,z, signature</span>):</span><br><span class="line">    r, s = <span class="built_in">int</span>(signature[:<span class="number">64</span>], <span class="number">16</span>), <span class="built_in">int</span>(signature[<span class="number">64</span>:], <span class="number">16</span>)</span><br><span class="line">    z = <span class="built_in">int</span>(hashlib.sha256(z).hexdigest(), <span class="number">16</span>)</span><br><span class="line">    s_inv = <span class="built_in">pow</span>(s, secp256k1.q - <span class="number">2</span>, secp256k1.q)</span><br><span class="line">    u1 = (z * s_inv) % secp256k1.q</span><br><span class="line">    u2 = (r * s_inv) % secp256k1.q</span><br><span class="line">    point = u1 * secp256k1.G + u2 * self.P</span><br><span class="line">    <span class="keyword">return</span> point.x == r</span><br></pre></td></tr></table></figure>

<p>猜测得到flag的条件是让<code>verify(signature)</code>函数返回True</p>
<p>我们能控制的只有signature</p>
<h3 id="非预期"><a href="#非预期" class="headerlink" title="非预期"></a>非预期</h3><p>因为<code>verify</code>没有对0采取处理，而且求逆元用的不是<code>inverse</code>or<code>invert</code>，而是</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s_inv = <span class="built_in">pow</span>(s, secp256k1.q - <span class="number">2</span>, secp256k1.q)</span><br></pre></td></tr></table></figure>

<p>因此，传入128个0即可让<code>verify(signature)</code>返回True</p>
<h1 id="网鼎杯-2022-玄武组——crypto557"><a href="#网鼎杯-2022-玄武组——crypto557" class="headerlink" title="网鼎杯 2022 玄武组——crypto557"></a>网鼎杯 2022 玄武组——crypto557</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">    p = getPrime(<span class="number">256</span>)</span><br><span class="line">    x = random.randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line">    tmp = bytes_to_long(flag)</span><br><span class="line">    enc = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(size(tmp)):</span><br><span class="line">        r = random.randint(<span class="number">2</span>, p-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> tmp%<span class="number">2</span>:</span><br><span class="line">            enc += [<span class="built_in">pow</span>(x, r, p)]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            enc += [r]</span><br><span class="line">        tmp //= <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    f.write(<span class="string">&quot;p = &quot;</span> + <span class="built_in">str</span>(p) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;enc = &quot;</span> + <span class="built_in">str</span>(enc) + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>题目根据m从低到高位为0或1给出不同的enc</p>
<p>所以我们解题思路也是通过enc来判断m当前位是0或1，本题用上二次剩余的性质</p>
<p>根据《信息安全数学基础》中的定理：如果$p$是奇素数，则模p的简化剩余系(也就是$(0,p-1)$)中有$\frac{p-1}{2}$个模p的平方剩余和$\frac{p-1}{2}$个平方非剩余，也就是说$x$是模p平方剩余的概率是0.5</p>
<p>所以我们做出下面分析</p>
<ol>
<li>如果$x$是模p的平方剩余，则$x^{\frac{p-1}{2}} \equiv 1 \mod p$(这条是平方剩余的性质)，可推出$(x^{\frac{p-1}{2}})^{r} \equiv 1 \mod p$也就是$c^{\frac{p-1}{2}}\equiv 1 \mod p$，$c$就是$x^{r}$，这个推导说明如果$x$是模p的平方剩余，则c也是模p的平方剩余</li>
<li>如果$x$不是模p的平方剩余，则c是模p平方剩余的概率也为0.5，因为$c \equiv x^{r} \mod p$，这个c也是$(0,p-1)$的数</li>
<li>再结合上m从低位到高位是0或1，可以推断出:</li>
<li>c是模p平方剩余的概率是$\frac{1}{2}\times 1 + \frac{1}{2} \times \frac{1}{2} &#x3D; 0.75$，对应的是x是模p平方剩余，且$m$当前位数是1，添入enc的是$x^r \mod p$，或m当前位数是0，添入enc的是$r$</li>
<li>c不是模p平方剩余的概率是$\frac{1}{2}\times \frac{1}{2} + \frac{1}{2}\times \frac{1}{2}&#x3D;\frac{1}{2}$，对应的是x不是模p平方剩余，所以c没有规律，就按照性质得知c是模p平方剩余的概率为$\frac{1}{2}$</li>
</ol>
<p>所以根据每组c是模p平方剩余的概率可以判断出这组c对应的x是否为模p的平方剩余。</p>
<p>把所有是模p平方剩余的x提取出来之后，我们再作出下面的分析：</p>
<ol>
<li>已知x是模p的平方剩余</li>
<li>如果当前的m是1，则添入enc的是$x^r \mod p$，应当也是模p的平方剩余</li>
<li>如果当前的m是0，则添入enc的是$r$，它是模p平方剩余的概率是$\frac{1}{2}$</li>
</ol>
<p>我们可以遍历所有x，判断当前的$c$是否为模p的平方剩余，只要遍历完所有x，发现c都是模p的平方剩余，则可以判断出m当前的位数就是1</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getData</span>():</span><br><span class="line">    cipher = []</span><br><span class="line">    p = []</span><br><span class="line">    lines = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).readlines()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lines), <span class="number">2</span>):</span><br><span class="line">        pp = <span class="built_in">eval</span>(lines[i].strip(<span class="string">b&quot;p = &quot;</span>).strip(<span class="string">b&quot;\n&quot;</span>))</span><br><span class="line">        p.append(pp)</span><br><span class="line">        cc = <span class="built_in">eval</span>(lines[i+<span class="number">1</span>].strip(<span class="string">b&quot;enc = &quot;</span>).strip(<span class="string">b&quot;\n&quot;</span>))</span><br><span class="line">        cipher.append(cc)</span><br><span class="line">    <span class="keyword">return</span> cipher,p</span><br><span class="line">    </span><br><span class="line">cipher,p = getData()</span><br><span class="line">x = []							<span class="comment">#提取所有是模p平方剩余的x</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher[<span class="number">0</span>])):</span><br><span class="line">        <span class="keyword">if</span> gmpy2.jacobi(cipher[i][j],p[i]) == <span class="number">1</span>:</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">    t = num / <span class="built_in">len</span>(cipher[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">if</span> t &gt; <span class="number">0.7</span>:</span><br><span class="line">        x.append(i)	</span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher[i])):</span><br><span class="line">    num = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> x:</span><br><span class="line">        <span class="keyword">if</span> gmpy2.jacobi(cipher[j][i],p[j]) != <span class="number">1</span>:</span><br><span class="line">            num = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> num:</span><br><span class="line">        m += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m[::-<span class="number">1</span>],<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;c8b10fb7-95f8-47a2-bfb3-b9489ad39711&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="网鼎杯-2022-青龙组——Grasshopper"><a href="#网鼎杯-2022-青龙组——Grasshopper" class="headerlink" title="网鼎杯 2022 青龙组——Grasshopper"></a>网鼎杯 2022 青龙组——Grasshopper</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> grassfield <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">k = [randrange(<span class="number">1</span>,p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    grasshopper = flag[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        k[j] = grasshopper = grasshopper * k[j] % p</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Grasshopper#&#x27;</span>+<span class="built_in">str</span>(i).zfill(<span class="number">2</span>)+<span class="string">&#x27;:&#x27;</span>+<span class="built_in">hex</span>(grasshopper)[<span class="number">2</span>:].zfill(<span class="number">4</span>))</span><br></pre></td></tr></table></figure>

<p>先理解题目的运算：</p>
<p>$i &#x3D; 0$时<br>$$<br>k_{10} &#x3D; g_0 &#x3D; ord(f) \times k_{00} \mod p\<br>$$</p>
<p>$$<br>k_{11} &#x3D; g_0 &#x3D; ord(f) \times k_{00}\times k_{01} \mod p\<br>$$</p>
<p>$$<br>k_{12} &#x3D; g_0 &#x3D; ord(f) \times k_{00}\times k_{01}\times k_{02} \mod p\<br>$$</p>
<p>$$<br>k_{13} &#x3D; g_0 &#x3D; ord(f) \times k_{00}\times k_{01}\times k_{02}\times k_{03} \mod p\<br>$$</p>
<p>$$<br>k_{14} &#x3D; g_0 &#x3D; ord(f) \times k_{00}\times k_{01}\times k_{02}\times k_{03} \times k_{04}\mod p<br>$$</p>
<p>$i &#x3D; 1$时<br>$$<br>k_{20} &#x3D; g_1 &#x3D; ord(l) \times k_{10} \mod p\<br>$$</p>
<p>$$<br>k_{21} &#x3D; g_1 &#x3D; ord(l) \times k_{10}\times k_{11} \mod p\<br>$$</p>
<p>$$<br>k_{22} &#x3D; g_1 &#x3D; ord(l) \times k_{10}\times k_{11}\times k_{12} \mod p\<br>$$</p>
<p>$$<br>k_{23} &#x3D; g_1 &#x3D; ord(l) \times k_{10}\times k_{11}\times k_{12}\times k_{13} \mod p\<br>$$</p>
<p>$$<br>k_{24} &#x3D; g_1 &#x3D; ord(l) \times k_{10}\times k_{11}\times k_{12}\times k_{13} \times k_{14}\mod p<br>$$</p>
<p>$i &#x3D; 2$时<br>$$<br>k_{30} &#x3D; g_2 &#x3D; ord(a) \times k_{20} \mod p\<br>$$</p>
<p>$$<br>k_{31} &#x3D; g_2 &#x3D; ord(a) \times k_{20}\times k_{21} \mod p\<br>$$</p>
<p>$$<br>k_{32} &#x3D; g_2 &#x3D; ord(a) \times k_{20}\times k_{21}\times k_{22} \mod p\<br>$$</p>
<p>$$<br>k_{33} &#x3D; g_2 &#x3D; ord(a) \times k_{20}\times k_{21}\times k_{22}\times k_{23} \mod p\<br>$$</p>
<p>$$<br>k_{34} &#x3D; g_2 &#x3D; ord(a) \times k_{20}\times k_{21}\times k_{22}\times k_{23} \times k_{24}\mod p<br>$$</p>
<p>$i &#x3D; 3$时<br>$$<br>k_{40} &#x3D; g_3 &#x3D; ord(g) \times k_{30} \mod p\<br>$$</p>
<p>$$<br>k_{41} &#x3D; g_3 &#x3D; ord(g) \times k_{30}\times k_{31} \mod p\<br>$$</p>
<p>$$<br>k_{42} &#x3D; g_3 &#x3D; ord(g) \times k_{30}\times k_{31}\times k_{32} \mod p\<br>$$</p>
<p>$$<br>k_{43} &#x3D; g_3 &#x3D; ord(g) \times k_{30}\times k_{31}\times k_{32}\times k_{33} \mod p\<br>$$</p>
<p>$$<br>k_{44} &#x3D; g_3 &#x3D; ord(g) \times k_{30}\times k_{31}\times k_{32}\times k_{33} \times k_{34}\mod p<br>$$</p>
<p>$i &#x3D; 4$时</p>
<p><img src="/../images/%E6%9D%82/25.png"></p>
<p>先求$k_{53} &#x3D; k_{54}\times k_{44}^{-1} \mod p$</p>
<p>再求$k_{43} &#x3D; k_{44}\times k_{34}^{-1}\mod p \longrightarrow k_{52} &#x3D; k_{53}\times k_{43}^{-1}\mod p$</p>
<p>再求$k_{33} &#x3D; k_{34}\times k_{24}^{-1}\mod p \longrightarrow k_{42} &#x3D; k_{43}\times k_{33}^{-1} \mod p \longrightarrow k_{51} &#x3D; k_{52}\times k_{42}^{-1}\mod p$</p>
<p>再求$k_{23} &#x3D; k_{24} \times k_{14}^{-1} \mod p \longrightarrow k_{32} &#x3D; k_{33}\times k_{23}^{-1}\mod p \longrightarrow k_{41} &#x3D; k_{42}\times k_{32}^{-1} \mod p \longrightarrow k_{50} &#x3D; k_{51}\times k_{41}^{-1} \mod p$</p>
<p>然后$i &#x3D; 5$时<br>$$<br>k_{60} &#x3D; g_5 &#x3D; ord(‘?’) \times k_{50} \mod p\<br>$$</p>
<p>$$<br>k_{61} &#x3D; g_5 &#x3D; ord(‘?’) \times k_{50}\times k_{51} \mod p\<br>$$</p>
<p>$$<br>k_{62} &#x3D; g_5 &#x3D; ord(‘?’) \times k_{50}\times k_{51}\times k_{52} \mod p\<br>$$</p>
<p>$$<br>k_{63} &#x3D; g_5 &#x3D; ord(‘?’) \times k_{50}\times k_{51}\times k_{52}\times k_{53} \mod p\<br>$$</p>
<p>$$<br>k_{64} &#x3D; g_5 &#x3D; ord(‘?’) \times k_{50}\times k_{51}\times k_{52}\times k_{53} \times k_{54}\mod p<br>$$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd,invert</span><br><span class="line"></span><br><span class="line">g = []</span><br><span class="line">lines = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).readlines()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(lines)):</span><br><span class="line">    g.append(<span class="built_in">int</span>(lines[i].strip()[-<span class="number">4</span>:].decode(),<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">know = <span class="string">b&quot;flag&#123;&quot;</span></span><br><span class="line">gmax = <span class="built_in">max</span>(g)</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(gmax+<span class="number">1</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    k14 = g[<span class="number">0</span>]</span><br><span class="line">    k24 = g[<span class="number">1</span>]</span><br><span class="line">    k34 = g[<span class="number">2</span>]</span><br><span class="line">    k44 = g[<span class="number">3</span>]</span><br><span class="line">    k54 = g[<span class="number">4</span>]</span><br><span class="line">    <span class="comment"># if gcd(know[0],p) == 1 and gcd(know[1],p) == 1 and gcd(know[2],p) == 1 and gcd(know[3],p) == 1 and gcd(know[4],p) == 1:</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="comment"># step1</span></span><br><span class="line">        k53 = k54 * invert(k44,p) % p</span><br><span class="line">        <span class="comment"># step2</span></span><br><span class="line">        k43 = k44 * invert(k34,p) % p</span><br><span class="line">        k52 = k53 * invert(k43,p) % p</span><br><span class="line">        <span class="comment"># step3</span></span><br><span class="line">        k33 = k34 * invert(k24,p) % p</span><br><span class="line">        k42 = k43 * invert(k33,p) % p</span><br><span class="line">        k51 = k52 * invert(k42,p) % p</span><br><span class="line">        <span class="comment"># step4 </span></span><br><span class="line">        k23 = k24 * invert(k14,p) % p</span><br><span class="line">        k32 = k33 * invert(k23,p) % p</span><br><span class="line">        k41 = k42 * invert(k32,p) % p </span><br><span class="line">        k50 = k51 * invert(k41,p) % p</span><br><span class="line">        </span><br><span class="line">        k = [k50,k51,k52,k53,k54]</span><br><span class="line">        flag = <span class="string">&#x27;flag&#123;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="built_in">len</span>(g)):</span><br><span class="line">            _k = k[<span class="number">0</span>]*k[<span class="number">1</span>]*k[<span class="number">2</span>]*k[<span class="number">3</span>]*k[<span class="number">4</span>]</span><br><span class="line">            </span><br><span class="line">            m = g[i] * invert(_k,p) % p</span><br><span class="line">            </span><br><span class="line">            flag += <span class="built_in">chr</span>(m)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">                k[j] = m = m * k[j] % p</span><br><span class="line">        <span class="keyword">if</span> flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="comment"># flag&#123;749d39d4-78db-4c55-b4ff-bca873d0f18e&#125;</span></span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="osuCTF"><a href="#osuCTF" class="headerlink" title="osuCTF"></a>osuCTF</h1><h2 id="剪枝"><a href="#剪枝" class="headerlink" title="剪枝"></a>剪枝</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getWYSIprime</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        digits = [random.choice(<span class="string">&quot;727&quot;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">272</span>)]</span><br><span class="line">        prime = <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(digits))</span><br><span class="line">        <span class="keyword">if</span> isPrime(prime):</span><br><span class="line">            <span class="keyword">return</span> prime</span><br><span class="line">        </span><br><span class="line"><span class="comment"># RSA encryption using the WYSI primes</span></span><br><span class="line">p = getWYSIprime()</span><br><span class="line">q = getWYSIprime()</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">flag = bytes_to_long(os.getenv(<span class="string">&quot;FLAG&quot;</span>,<span class="string">b&quot;osu&#123;fake_flag_for_testing&#125;&quot;</span>))</span><br><span class="line">ciphertext = <span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ciphertext = <span class="subst">&#123;ciphertext&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 2160489795493918825870689458820648828073650907916827108594219132976202835249425984494778310568338106260399032800745421512005980632641226298431130513637640125399673697368934008374907832728004469350033174207285393191694692228748281256956917290437627249889472471749973975591415828107248775449619403563269856991145789325659736854030396401772371148983463743700921913930643887223704115714270634525795771407138067936125866995910432010323584269926871467482064993332990516534083898654487467161183876470821163254662352951613205371404232685831299594035879</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">ciphertext = 2087465275374927411696643073934443161977332564784688452208874207586196343901447373283939960111955963073429256266959192725814591103495590654238320816453299972810032321690243148092328690893438620034168359613530005646388116690482999620292746246472545500537029353066218068261278475470490922381998208396008297649151265515949490058859271855915806534872788601506545082508028917211992107642670108678400276555889198472686479168292281830557272701569298806067439923555717602352224216701010790924698838402522493324695403237985441044135894549709670322380450</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>从低位往高位爆破即可，因为题目生成的素数只含<code>7,2</code>，所以每次爆破只需要2个数字，爆破起来蛮快的</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">2160489795493918825870689458820648828073650907916827108594219132976202835249425984494778310568338106260399032800745421512005980632641226298431130513637640125399673697368934008374907832728004469350033174207285393191694692228748281256956917290437627249889472471749973975591415828107248775449619403563269856991145789325659736854030396401772371148983463743700921913930643887223704115714270634525795771407138067936125866995910432010323584269926871467482064993332990516534083898654487467161183876470821163254662352951613205371404232685831299594035879</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ciphertext = <span class="number">2087465275374927411696643073934443161977332564784688452208874207586196343901447373283939960111955963073429256266959192725814591103495590654238320816453299972810032321690243148092328690893438620034168359613530005646388116690482999620292746246472545500537029353066218068261278475470490922381998208396008297649151265515949490058859271855915806534872788601506545082508028917211992107642670108678400276555889198472686479168292281830557272701569298806067439923555717602352224216701010790924698838402522493324695403237985441044135894549709670322380450</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findp</span>(<span class="params">p,q</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(p)</span><br><span class="line">    <span class="keyword">if</span> l == <span class="number">272</span> <span class="keyword">and</span> n % <span class="built_in">int</span>(p) == <span class="number">0</span>:</span><br><span class="line">        q = n // <span class="built_in">int</span>(p)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        table = [<span class="string">&quot;2&quot;</span>,<span class="string">&quot;7&quot;</span>]</span><br><span class="line">        <span class="keyword">for</span> i,j <span class="keyword">in</span> itertools.product(table,repeat=<span class="number">2</span>):</span><br><span class="line">            pp = <span class="built_in">int</span>(i + p)</span><br><span class="line">            qq = <span class="built_in">int</span>(j + q)</span><br><span class="line">            <span class="keyword">if</span> pp * qq % <span class="number">10</span>**l == n % <span class="number">10</span>**l:</span><br><span class="line">                findp(i+p,j+q)</span><br><span class="line">                </span><br><span class="line"><span class="comment"># findp(&quot;7&quot;,&quot;7&quot;)</span></span><br><span class="line">p = <span class="number">27777727727777722777277277777272772727772722777777277777277772227772772772227272727777772772772727227772777277727777777222777777277727772272272777772722727722777727277727727777777772772777772777277772222727227777777222727777772772272727777222777777277777727272772272272277</span></span><br><span class="line">q = <span class="number">77777772777772222722727222227777272777772777772277727772722777777777227277727272772727277277272772727227272772772222277777772727727772722772777272727777272722772777277777277777277777727777277277777277777272772772777777727772727277727777772772777772272772272222227777777227</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ciphertext,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># osu&#123;h4v3_y0u_3v3r_n0t1c3d_th4t_727_1s_pr1m3?&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="LCG泄露低位"><a href="#LCG泄露低位" class="headerlink" title="LCG泄露低位"></a>LCG泄露低位</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime <span class="comment"># https://pypi.org/project/pycryptodome/</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> floor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">s, a, b, p</span>):</span><br><span class="line">    <span class="keyword">return</span> (a * s + b) % p</span><br><span class="line"></span><br><span class="line">p = getPrime(floor(<span class="number">72.7</span>))</span><br><span class="line">a = randrange(<span class="number">0</span>, p)</span><br><span class="line">b = randrange(<span class="number">0</span>, p)</span><br><span class="line">seed = randrange(<span class="number">0</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;a = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_roll</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = lcg(seed, a, b, p)</span><br><span class="line">    <span class="keyword">return</span> seed % <span class="number">100</span></span><br><span class="line">out = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(floor(<span class="number">72.7</span>)):</span><br><span class="line">    out.append(get_roll())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;out = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">key = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">iv = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="built_in">print</span>(cipher.encrypt(pad(flag, <span class="number">16</span>)).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 4420073644184861649599</span></span><br><span class="line"><span class="string">a = 1144993629389611207194</span></span><br><span class="line"><span class="string">b = 3504184699413397958941</span></span><br><span class="line"><span class="string">out = [39, 47, 95, 1, 77, 89, 77, 70, 99, 23, 44, 38, 87, 34, 99, 42, 10, 67, 24, 3, 2, 80, 26, 87, 91, 86, 1, 71, 59, 97, 69, 31, 17, 91, 73, 78, 43, 18, 15, 46, 22, 68, 98, 60, 98, 17, 53, 13, 6, 13, 19, 50, 73, 44, 7, 44, 3, 5, 80, 26, 10, 55, 27, 47, 72, 80, 53, 2, 40, 64, 55, 6]</span></span><br><span class="line"><span class="string">enc = &#x27;34daaa9f7773d7ea4d5f96ef3dab1bbf5584ecec9f0542bbee0c92130721d925f40b175e50587196874e14332460257b&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>由$X_{n+1} \equiv aX_n + b \mod p$</p>
<p>拆成高低位来写，则有<br>$$<br>H_{n+1}\times 100 + L_{n+1} \equiv a(H_n\times 100 + L_n) +b \mod p<br>$$<br>化简得<br>$$<br>H_{n+1} \equiv aH_n + (aL_n + b -L_{n+1})\times 100^{-1} \mod p<br>$$<br>于是有<br>$$<br>H_2 \equiv aH_1 + (aL_1 + b - L_2)\times 100^{-1} \mod p<br>$$</p>
<p>$$<br>H_3 \equiv aH_2 + (aL_2+b-L_3) \times 100^{-1} \mod p<br>$$</p>
<p>即<br>$$<br>H_3 \equiv a^2H_1 + (a(aL_1+b-L_2) + (aL_2+b-L_3)) \times 100^{-1} \mod p<br>$$<br>写到这里是为了后面更好理解$B_i$如何计算</p>
<p>回到题目，简单来写就是<br>$$<br>H_{n+1} \equiv A_nH_1 + B_n \mod p<br>$$<br>即$H_{n+1} &#x3D; A_mH_1 + B_n +k_np$</p>
<p>构造格</p>
<p><img src="/../images/%E6%9D%82/15.png"></p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">4420073644184861649599</span></span><br><span class="line">a = <span class="number">1144993629389611207194</span></span><br><span class="line">b = <span class="number">3504184699413397958941</span></span><br><span class="line">out = [<span class="number">39</span>, <span class="number">47</span>, <span class="number">95</span>, <span class="number">1</span>, <span class="number">77</span>, <span class="number">89</span>, <span class="number">77</span>, <span class="number">70</span>, <span class="number">99</span>, <span class="number">23</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">87</span>, <span class="number">34</span>, <span class="number">99</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">67</span>, <span class="number">24</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">80</span>, <span class="number">26</span>, <span class="number">87</span>, <span class="number">91</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">71</span>, <span class="number">59</span>, <span class="number">97</span>, <span class="number">69</span>, <span class="number">31</span>, <span class="number">17</span>, <span class="number">91</span>, <span class="number">73</span>, <span class="number">78</span>, <span class="number">43</span>, <span class="number">18</span>, <span class="number">15</span>, <span class="number">46</span>, <span class="number">22</span>, <span class="number">68</span>, <span class="number">98</span>, <span class="number">60</span>, <span class="number">98</span>, <span class="number">17</span>, <span class="number">53</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">73</span>, <span class="number">44</span>, <span class="number">7</span>, <span class="number">44</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">80</span>, <span class="number">26</span>, <span class="number">10</span>, <span class="number">55</span>, <span class="number">27</span>, <span class="number">47</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">53</span>, <span class="number">2</span>, <span class="number">40</span>, <span class="number">64</span>, <span class="number">55</span>, <span class="number">6</span>]</span><br><span class="line">enc = <span class="string">&#x27;34daaa9f7773d7ea4d5f96ef3dab1bbf5584ecec9f0542bbee0c92130721d925f40b175e50587196874e14332460257b&#x27;</span></span><br><span class="line"></span><br><span class="line">L = [<span class="number">0</span>] + out</span><br><span class="line">n = <span class="built_in">len</span>(out)</span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">    A.append(a*A[i-<span class="number">1</span>] % p)</span><br><span class="line">    B.append((a*B[i-<span class="number">1</span>] + (a*L[i]+b-L[i+<span class="number">1</span>])*gmpy2.invert(<span class="number">100</span>,p))%p)</span><br><span class="line"></span><br><span class="line">A = A[<span class="number">1</span>:]</span><br><span class="line">B = B[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,n+<span class="number">1</span>,n+<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(A)):</span><br><span class="line">    Ge[i,i] = p</span><br><span class="line">    Ge[-<span class="number">2</span>,i] = A[i]</span><br><span class="line">    Ge[-<span class="number">1</span>,i] = B[i]</span><br><span class="line"></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = p // <span class="number">100</span></span><br><span class="line"></span><br><span class="line">M = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">H1 = M[-<span class="number">2</span>]</span><br><span class="line">L1 = out[<span class="number">0</span>]</span><br><span class="line">seed1 = H1 * <span class="number">100</span> + L1</span><br><span class="line"></span><br><span class="line">seed = ((seed1 - b)*gmpy2.invert(a,p))%p</span><br><span class="line"><span class="comment"># print(seed)</span></span><br><span class="line"><span class="comment"># 1972400400839421538435</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">s, a, b, p</span>):</span><br><span class="line">    <span class="keyword">return</span> (a * s + b) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_roll</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = lcg(seed, a, b, p)</span><br><span class="line">    <span class="keyword">return</span> seed % <span class="number">100</span></span><br><span class="line"></span><br><span class="line">temp = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(floor(<span class="number">72.7</span>)):</span><br><span class="line">    temp.append(get_roll())</span><br><span class="line"><span class="comment"># print(temp == out)</span></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line">key = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">iv = <span class="built_in">bytes</span>([get_roll() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = cipher.decrypt(<span class="built_in">bytes</span>.fromhex(enc))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># osu&#123;w0uld_y0u_l1k3_f1r5t_0r_53c0nd_p1ck&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="HSCCTF-2024"><a href="#HSCCTF-2024" class="headerlink" title="HSCCTF 2024"></a>HSCCTF 2024</h1><h2 id="EzMath"><a href="#EzMath" class="headerlink" title="EzMath"></a>EzMath</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;HSCCTF&#123;*****************************************&#125;&#x27;</span></span><br><span class="line">x = bytes_to_long(flag.encode())</span><br><span class="line">y = getPrime(<span class="number">200</span>)</span><br><span class="line">z = getPrime(<span class="number">200</span>)</span><br><span class="line"><span class="keyword">assert</span> (x**<span class="number">2</span>+<span class="number">1</span>)*(y**<span class="number">2</span>+<span class="number">1</span>)*(z**<span class="number">2</span>+<span class="number">1</span>) + <span class="number">4</span> * ((x*y*z)*(x+y+z)+(x*y+x*z+y*z)) == jl + <span class="number">2</span>*(x+y+z+x*y*z)*(x*y+y*z+x*z+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">w = <span class="number">1007766898498955907869786015006414110177963571599690507305616866798367726133772947904112344473803352290475298324967917118497719002314168582330651485077694557008496465717884047202330407870172675541471666596768873677342429660840647109788577728613362048023960188394853332768656214046219781162891725391990618222498709603165658933818803574737</span></span><br><span class="line">a = jl + <span class="number">2024</span></span><br><span class="line">b = jl + <span class="number">2025</span></span><br><span class="line">c = getPrime(<span class="number">1000</span>)</span><br><span class="line"><span class="keyword">assert</span> w*(a*c + b*c - a*b) == <span class="number">4</span>*a*b*c</span><br></pre></td></tr></table></figure>

<p>先从第二个assert算出jl<br>$$<br>\because w(ac + bc -ab) &#x3D; 4abc<br>$$<br>同除$wabc$得<br>$$<br>\frac{4}{w} &#x3D; \frac{1}{a}+\frac{1}{b} - \frac{1}{c}<br>$$<br>看了la佬博客才知道这是著名的丢番图方程，la佬也给出了<a target="_blank" rel="noopener" href="https://scialert.net/fulltext/?doi=aja.2011.31.37#t4">论文</a></p>
<p><img src="/../images/%E6%9D%82/34.png"></p>
<p><img src="/../images/%E6%9D%82/35.png"></p>
<p>根据论文有<br>$$<br>a &#x3D; \frac{w-1}{2},b&#x3D;\frac{w+1}{2}<br>$$<br>然后便能解出jl</p>
<p>再根据第一个assert<br>$$<br>jl &#x3D; (x^2+1)(y^2+1)(z^2+1)+4[xyz(x+y+z)+(xy+xz+yz)]-2(x+y+z+xyz)(xy+yz+xz+1)<br>$$<br>化简以后得到<br>$$<br>jl &#x3D; (x-1)^2(y-1)^2(z-1)^2<br>$$<br>推导不太流利的话，可以用下面函数计算</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">R.&lt;x,y,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">f=(x**<span class="number">2</span>+<span class="number">1</span>)*(y**<span class="number">2</span>+<span class="number">1</span>)*(z**<span class="number">2</span>+<span class="number">1</span>) + <span class="number">4</span> * ((x*y*z)*(x+y+z)+(x*y+x*z+y*z)) - <span class="number">2</span>*(x+y+z+x*y*z)*(x*y+y*z+x*z+<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(f.factor())</span><br></pre></td></tr></table></figure>

<p>然后计算出$\sqrt{jl}$即$(x-1)(y-1)(z-1)$ 的所有因子，限制$x,y,z$的位数，进行爆破(参考<a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/">HSCCTF 2024 | Lazzaro (lazzzaro.github.io)</a>)</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">w = <span class="number">1007766898498955907869786015006414110177963571599690507305616866798367726133772947904112344473803352290475298324967917118497719002314168582330651485077694557008496465717884047202330407870172675541471666596768873677342429660840647109788577728613362048023960188394853332768656214046219781162891725391990618222498709603165658933818803574737</span></span><br><span class="line"></span><br><span class="line">a = (w-<span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">b = (w+<span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">jl = a - <span class="number">2024</span></span><br><span class="line"></span><br><span class="line">s = jl.nth_root(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;s = <span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">sf = divisors(s)</span><br><span class="line"></span><br><span class="line">yz = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sf)):</span><br><span class="line">    t = sf[i] + <span class="number">1</span></span><br><span class="line">    <span class="comment"># 这个就是所有y,z的可能</span></span><br><span class="line">    <span class="keyword">if</span> t &gt; <span class="number">2</span>^<span class="number">200</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> t &gt; <span class="number">2</span>^<span class="number">199</span> <span class="keyword">and</span> t &lt; <span class="number">2</span>^<span class="number">200</span> <span class="keyword">and</span> is_prime(t):</span><br><span class="line">        yz.append(t)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(yz)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, <span class="built_in">len</span>(yz)):</span><br><span class="line">        x = long_to_bytes(s // ((yz[i]-<span class="number">1</span>)*(yz[j]-<span class="number">1</span>)) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> x.isascii():</span><br><span class="line">            <span class="built_in">print</span>(x)</span><br><span class="line">            <span class="comment"># HSCCTF&#123;math_is_good&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="simple-rsa"><a href="#simple-rsa" class="headerlink" title="simple_rsa"></a>simple_rsa</h1><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # sage</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag,inc</span><br><span class="line">flag.startwith(<span class="string">b&#x27;flag&#123;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">===================== Very very very easy rsa!!! =====================</span></span><br><span class="line"><span class="string">Rsa public key cryptosystem has been use for many years, in which the</span></span><br><span class="line"><span class="string">security of large prime number generation method has also been tested,</span></span><br><span class="line"><span class="string">the following is one of the typical,can you complete this simple chal-</span></span><br><span class="line"><span class="string">-lenge?</span></span><br><span class="line"><span class="string">======================================================================</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Enc_RSA</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,my_own_number</span>):</span><br><span class="line">        self.my_own_number = my_own_number</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">my_own_p</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">            x = getRandomNBitInteger(<span class="number">1020</span>)</span><br><span class="line">            Try = self.my_own_number*x**<span class="number">2</span> + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> self.Assert(Try):</span><br><span class="line">                <span class="keyword">if</span> isPrime(Try//<span class="number">4</span>):</span><br><span class="line">                    <span class="keyword">return</span> Try//<span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self,p,m</span>):</span><br><span class="line">        q = getPrime(<span class="number">2048</span>)</span><br><span class="line">        n = p*q</span><br><span class="line">        e = <span class="number">65537</span></span><br><span class="line">        c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">        <span class="keyword">return</span> c,n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Assert</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">if</span> x%<span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    m = bytes_to_long(flag)</span><br><span class="line">    <span class="comment"># (inc^3+79*inc^2+65*x+13) % 1009 == 75 and inc is the least number of the solutions</span></span><br><span class="line">    simple_rsa = Enc_RSA(inc)</span><br><span class="line">    my_own_p = simple_rsa.my_own_p()</span><br><span class="line">    c,n = simple_rsa.encrypt(my_own_p,m)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;The number n is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;The number c is &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">239991661594255432253524767015995553515237552533155266926256011465282762559353011052450949268256733652728779258766468919544696925923029971358451218605372587362458449054025033701801900645898472588154917088906800582917494664328520686255219374705615093349028400487500700497262125962699907814762260694512419306655681221550404511187947035240862982211439747534964306636253099170338798685973287325340707860219110341961583076710007409917903130974964116916771142272349466429861637432682323525150403022509642843376610181395841148978693337599615406649799191853827010907802086292506660315192889149853860466713408351169716170349941283866327264263674186111821195117718331162019362457552641053820550856338437084718718166335155055467914441669571434953065100946319980517952599059131363048098350727744633605485707572274095622988175888575181926216657671979400539900036737074022439888766895137513405183084782345787084384440219108285918795208147597105329833220778335653967184986454715474901645149893734487589920817923864154513632372040497339658475506015077106021525958925682144048668278652340622951676339892584652575698271269136840455952742490194969320271826016057595443197409385545226358578330860265774991784277066549276529111906273907674552737416753863</span></span><br><span class="line">c = <span class="number">109418524185171249754036328878536082517954029920067574655738384592535836773335628458417141595917825776593787435093397689973609739515369740356902095262586192608015183792599638006673560604912289524063947742864265648290222544146026010834512839441651151683977393085931597793493789773796447230096442592944882642030190816279289547021784085222443501471419720621671097963713920969317609128950658009064968297525559501068818689604481823678151138300279455535521354912993468606798440152484970180922154575782801057685058825930140799668236228757680911175511728786376925291100386181042980092849556078128905911704118673386991731613513557730970187099491096161742557673136761987701380023132477428777616821281546394707593721174087541309042519043802756642438656462900040566266286487497200417682129927549586193679630211442035605657360570424712008827694002996251982742270642787724129846345798013831392882500535407597060962835644676708823777282733770509418807720840903933760203606859546641772415565269905905400875432944204469576245094963764264460475437038261117576528119870956293781467399036647466377281634948738629392548705519595154811629053243321519324745857848358773804108513698662614500352057759607896553293314291425723185332246973550692552395028420164</span></span><br></pre></td></tr></table></figure>

<p>首先需要关注的是<code>    # (inc^3+79*inc^2+65*x+13) % 1009 == 75 and inc is the least number of the solutions</code></p>
<p>这里其实就是解方程$inc^3 + 79\times inc^2 + 65\times inc + 13 \equiv 75 \mod 1009$，应该是出题人打错了，所以<code>x</code>对应的就是<code>inc</code></p>
<p>解方程后可以知道inc是427，然后根据生成素数的方式得知这是个<code>RSA backdoor</code></p>
<p>参考<a target="_blank" rel="noopener" href="https://icewizard4902.github.io/Cryptohack/rsa-backdoor-viability/">RSA Backdoor Viability (icewizard4902.github.io)</a>，套一下脚本</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">FactorRes</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, r=<span class="literal">None</span>, c=<span class="literal">None</span>, u=<span class="literal">None</span>, a=<span class="literal">None</span></span>):</span><br><span class="line">        self.r = r</span><br><span class="line">        self.c = c</span><br><span class="line">        self.u = u</span><br><span class="line">        self.a = a</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xgcd</span>(<span class="params">f, g, N</span>):</span><br><span class="line">    toswap = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> f.degree() &lt; g.degree():</span><br><span class="line">        toswap = <span class="literal">True</span></span><br><span class="line">        f, g = g, f</span><br><span class="line">    r_i = f</span><br><span class="line">    r_i_plus = g</span><br><span class="line">    r_i_plus_plus = f</span><br><span class="line">    s_i, s_i_plus = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    t_i, t_i_plus = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">        lc = r_i.lc().lift()</span><br><span class="line">        lc *= r_i_plus.lc().lift()</span><br><span class="line">        lc *= r_i_plus_plus.lc().lift()</span><br><span class="line">        divisor = gcd(lc, N)</span><br><span class="line">        <span class="keyword">if</span> divisor &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> divisor, <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line">        q = r_i // r_i_plus</span><br><span class="line">        s_i_plus_plus = s_i - q * s_i_plus</span><br><span class="line">        t_i_plus_plus = t_i - q * t_i_plus</span><br><span class="line">        r_i_plus_plus = r_i - q * r_i_plus</span><br><span class="line">        <span class="keyword">if</span> r_i_plus.degree() &lt;= r_i_plus_plus.degree() <span class="keyword">or</span> r_i_plus_plus.degree() == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> toswap == <span class="literal">True</span>:</span><br><span class="line">                <span class="keyword">return</span> r_i_plus, t_i_plus, s_i_plus</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> r_i_plus, s_i_plus, t_i_plus,</span><br><span class="line">        r_i, r_i_plus = r_i_plus, r_i_plus_plus</span><br><span class="line">        s_i, s_i_plus = s_i_plus, s_i_plus_plus</span><br><span class="line">        t_i, t_i_plus = t_i_plus, t_i_plus_plus</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Qinverse</span> (Hx, a, N):</span><br><span class="line">    r,s,t = xgcd(a.lift(), Hx, N)</span><br><span class="line">    <span class="keyword">if</span> (s,t) == (<span class="literal">None</span>, <span class="literal">None</span>):</span><br><span class="line">        res = r, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rinv = r[<span class="number">0</span>]^(-<span class="number">1</span>)</span><br><span class="line">        res = <span class="number">1</span>, s * rinv</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CMfactor</span>(<span class="params">D, N</span>):</span><br><span class="line">    Hx = hilbert_class_polynomial(-D)</span><br><span class="line">    res = FactorRes()</span><br><span class="line">    ZN = Integers(N)</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(ZN)</span><br><span class="line">    Hx = R(Hx)</span><br><span class="line">    Q.&lt;j&gt; = QuotientRing(R, R.ideal(Hx))</span><br><span class="line">    gcd, inverse = Qinverse(Hx, <span class="number">1728</span> - j, N)</span><br><span class="line">    <span class="keyword">if</span> gcd == <span class="number">1</span>:</span><br><span class="line">        a = Q(j * inverse)</span><br><span class="line">    <span class="keyword">return</span> CMfactor_core(N, a, Q, ZN, Hx, res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CMfactor_core</span>(<span class="params">N, a, Q, ZN, Hx, res</span>):</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> [<span class="number">1.</span><span class="number">.10</span>]:</span><br><span class="line">        E = EllipticCurve(Q, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span> * a * c ^ <span class="number">2</span>, <span class="number">2</span> * a * c ^ <span class="number">3</span>])</span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> [<span class="number">1.</span><span class="number">.10</span>]:</span><br><span class="line">            rand_elem = ZN.random_element()</span><br><span class="line">            res.rand_elem = <span class="built_in">int</span>(rand_elem)</span><br><span class="line">            w = E.division_polynomial(N, Q(rand_elem), two_torsion_multiplicity=<span class="number">0</span>)</span><br><span class="line">            poly_gcd = xgcd(w.lift(), Hx, N)[<span class="number">0</span>]</span><br><span class="line">            r = gcd(ZZ(poly_gcd), N)</span><br><span class="line">            res.c = c</span><br><span class="line">            res.u = u</span><br><span class="line">            <span class="keyword">if</span> r &gt; <span class="number">1</span> <span class="keyword">and</span> r != N:</span><br><span class="line">                <span class="keyword">return</span> r, N//r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    sys.setrecursionlimit(<span class="number">50000</span>)</span><br><span class="line">    <span class="comment">#####################################INPUTS####################################</span></span><br><span class="line">    d = <span class="number">427</span></span><br><span class="line">    n = <span class="number">239991661594255432253524767015995553515237552533155266926256011465282762559353011052450949268256733652728779258766468919544696925923029971358451218605372587362458449054025033701801900645898472588154917088906800582917494664328520686255219374705615093349028400487500700497262125962699907814762260694512419306655681221550404511187947035240862982211439747534964306636253099170338798685973287325340707860219110341961583076710007409917903130974964116916771142272349466429861637432682323525150403022509642843376610181395841148978693337599615406649799191853827010907802086292506660315192889149853860466713408351169716170349941283866327264263674186111821195117718331162019362457552641053820550856338437084718718166335155055467914441669571434953065100946319980517952599059131363048098350727744633605485707572274095622988175888575181926216657671979400539900036737074022439888766895137513405183084782345787084384440219108285918795208147597105329833220778335653967184986454715474901645149893734487589920817923864154513632372040497339658475506015077106021525958925682144048668278652340622951676339892584652575698271269136840455952742490194969320271826016057595443197409385545226358578330860265774991784277066549276529111906273907674552737416753863</span></span><br><span class="line">    c = <span class="number">109418524185171249754036328878536082517954029920067574655738384592535836773335628458417141595917825776593787435093397689973609739515369740356902095262586192608015183792599638006673560604912289524063947742864265648290222544146026010834512839441651151683977393085931597793493789773796447230096442592944882642030190816279289547021784085222443501471419720621671097963713920969317609128950658009064968297525559501068818689604481823678151138300279455535521354912993468606798440152484970180922154575782801057685058825930140799668236228757680911175511728786376925291100386181042980092849556078128905911704118673386991731613513557730970187099491096161742557673136761987701380023132477428777616821281546394707593721174087541309042519043802756642438656462900040566266286487497200417682129927549586193679630211442035605657360570424712008827694002996251982742270642787724129846345798013831392882500535407597060962835644676708823777282733770509418807720840903933760203606859546641772415565269905905400875432944204469576245094963764264460475437038261117576528119870956293781467399036647466377281634948738629392548705519595154811629053243321519324745857848358773804108513698662614500352057759607896553293314291425723185332246973550692552395028420164</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    <span class="comment">#####################################INPUTS####################################</span></span><br><span class="line"></span><br><span class="line">    p, q = CMfactor(d, n)</span><br><span class="line"></span><br><span class="line">    phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">    flag = <span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">    <span class="built_in">print</span>(flag.to_bytes((flag.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;!ep1y_@tree&#125;</code></p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/" title="杂记(二)">https://dexterjie.github.io/2024/02/29/杂记-二/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/02/20/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/VNCTF2024/" rel="prev" title="VNCTF2024">
                  <i class="fa fa-chevron-left"></i> VNCTF2024
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/03/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024VishwaCTF/" rel="next" title="2024VishwaCTF">
                  2024VishwaCTF <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">243k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">14:44</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/02/29/%E6%9D%82%E8%AE%B0-%E4%BA%8C/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
