<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录下第一次打CryptoCTF的过程">
<meta property="og:type" content="article">
<meta property="og:title" content="CryptoCTF">
<meta property="og:url" content="https://dexterjie.github.io/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录下第一次打CryptoCTF的过程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/2024RCTF/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024RCTF/12.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023PolarCTF/RM2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2024RCTF/13.png">
<meta property="article:published_time" content="2024-06-09T14:43:28.000Z">
<meta property="article:modified_time" content="2024-07-07T10:50:48.721Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/2024RCTF/11.png">


<link rel="canonical" href="https://dexterjie.github.io/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/","path":"2024/06/09/赛题复现/CryptoCTF/","title":"CryptoCTF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>CryptoCTF | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Easy"><span class="nav-number">1.</span> <span class="nav-text">Easy</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Alibos"><span class="nav-number">1.1.</span> <span class="nav-text">Alibos</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mashy"><span class="nav-number">1.2.</span> <span class="nav-text">Mashy</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Medium"><span class="nav-number">2.</span> <span class="nav-text">Medium</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Joe-19"><span class="nav-number">2.1.</span> <span class="nav-text">Joe-19</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#honey"><span class="nav-number">2.2.</span> <span class="nav-text">honey</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Alibols"><span class="nav-number">2.3.</span> <span class="nav-text">Alibols</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RM2"><span class="nav-number">2.4.</span> <span class="nav-text">RM2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bada"><span class="nav-number">2.5.</span> <span class="nav-text">Bada</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#melek"><span class="nav-number">2.6.</span> <span class="nav-text">melek</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vantuk"><span class="nav-number">2.7.</span> <span class="nav-text">Vantuk</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Soufia%E2%80%94%E2%80%94Unsolved"><span class="nav-number">2.8.</span> <span class="nav-text">Soufia——Unsolved</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">76</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="CryptoCTF | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CryptoCTF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-09 22:43:28" itemprop="dateCreated datePublished" datetime="2024-06-09T22:43:28+08:00">2024-06-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-07 18:50:48" itemprop="dateModified" datetime="2024-07-07T18:50:48+08:00">2024-07-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>11 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录下第一次打CryptoCTF的过程</p>
<span id="more"></span>

<h1 id="Easy"><a href="#Easy" class="headerlink" title="Easy"></a>Easy</h1><h2 id="Alibos"><a href="#Alibos" class="headerlink" title="Alibos"></a>Alibos</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> d, flag</span><br><span class="line"></span><br><span class="line">get_context().precision = <span class="number">1337</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m, d</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(m)) &lt; d:</span><br><span class="line">		m = <span class="built_in">str</span>(m) + <span class="string">&#x27;1&#x27;</span> * (d - <span class="built_in">len</span>(<span class="built_in">str</span>(m)))</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">int</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">d</span>):</span><br><span class="line">	skey = getRandomRange(<span class="number">10</span> ** (d - <span class="number">1</span>), <span class="number">10</span> ** d)</span><br><span class="line">	pkey = <span class="built_in">int</span>(<span class="number">10</span>**d * (sqrt(skey) - floor(sqrt(skey))))</span><br><span class="line">	<span class="keyword">return</span> pkey, skey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pkey</span>):</span><br><span class="line">	m = pad(m, <span class="built_in">len</span>(<span class="built_in">str</span>(pkey)))</span><br><span class="line">	d = <span class="built_in">len</span>(<span class="built_in">str</span>(pkey))</span><br><span class="line">	c = (pkey + d ** <span class="number">2</span> * m) % (<span class="number">10</span> ** d)</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">pkey, skey = genkey(d)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = encrypt(m, pkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;pkey = <span class="subst">&#123;pkey&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc  = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>很容易就知道d &#x3D; 313<br>$$<br>c \equiv pk + d^2\times m \mod 10^d<br>$$</p>
<p>$$<br>c -pk \equiv d^2m \mod 10^d<br>$$</p>
<p>$$<br>m \equiv (c-pk)<br>$$</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse,long_to_bytes</span><br><span class="line"></span><br><span class="line">pkey = <span class="number">8582435512564229286688465405009040056856016872134514945016805951785759509953023638490767572236748566493023965794194297026085882082781147026501124183913218900918532638964014591302221504335115379744625749001902791287122243760312557423006862735120339132655680911213722073949690947638446354528576541717311700749946777</span></span><br><span class="line">enc  = <span class="number">6314597738211377086770535291073179315279171595861180001679392971498929017818237394074266448467963648845725270238638741470530326527225591470945568628357663345362977083408459035746665948779559824189070193446347235731566688204757001867451307179564783577100125355658166518394135392082890798973020986161756145194380336</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># d = </span></span><br><span class="line">d = <span class="number">313</span></span><br><span class="line">m = (enc - pkey)*inverse(d**<span class="number">2</span>,<span class="number">10</span>**d) % <span class="number">10</span>**d</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 6170704326493336128242608193100736601774626903966803036318189045381903593682775829229200905376968543264526051111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111</span></span><br><span class="line">m = <span class="number">617070432649333612824260819310073660177462690396680303631818904538190359368277582922920090537696854326452605</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># CCTF&#123;h0M3_m4De_cRyp70_5ySTeM_1N_CryptoCTF!!!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Mashy"><a href="#Mashy" class="headerlink" title="Mashy"></a>Mashy</h2><p>Solved by Sprinter</p>
<blockquote>
<p>task</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> salt, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>():</span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">s1, s2</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">bytes</span>([s1[_] ^ s2[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s1))])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;┃&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;.: Hi all, she did Mashy, you should do it too! Are you ready? :. &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛&quot;</span>)</span><br><span class="line"></span><br><span class="line">	REC = []</span><br><span class="line">	cnt, STEP = <span class="number">0</span>, <span class="number">7</span></span><br><span class="line">	sh = md5(salt).digest()</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		pr(border, <span class="string">f&#x27;Please send your first input:  &#x27;</span>)</span><br><span class="line">		d1 = sc().strip()</span><br><span class="line">		pr(border, <span class="string">f&#x27;Please send your second input: &#x27;</span>)</span><br><span class="line">		d2 = sc().strip()</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			d1 = hexlify(unhexlify(d1))</span><br><span class="line">			d2 = hexlify(unhexlify(d2))</span><br><span class="line">			h1 = md5(unhexlify(d1)).digest()</span><br><span class="line">			h2 = md5(unhexlify(d2)).digest()</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Your inputs are not valid! Bye!!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">if</span> d1 != d2 <span class="keyword">and</span> d1 <span class="keyword">not</span> <span class="keyword">in</span> REC <span class="keyword">and</span> d2 <span class="keyword">not</span> <span class="keyword">in</span> REC:</span><br><span class="line">			<span class="keyword">if</span> md5(xor(d1, d2)).hexdigest() != <span class="string">&#x27;ae09d7510659ca40eda3e45ca70e9606&#x27;</span>:</span><br><span class="line">				<span class="keyword">if</span> hexlify(xor(xor(h1, h2), sh)) == <span class="string">b&#x27;a483b30944cbf762d4a3afc154aad825&#x27;</span>:</span><br><span class="line">					REC += [d1, d2]</span><br><span class="line">					<span class="keyword">if</span> cnt == STEP:</span><br><span class="line">						die(border, <span class="string">f&#x27;Congrats! the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">					pr(border, <span class="string">&#x27;Good job, try next level :P&#x27;</span>)</span><br><span class="line">					cnt += <span class="number">1</span></span><br><span class="line">				<span class="keyword">else</span>:</span><br><span class="line">					die(border, <span class="string">&#x27;Your input is not correct! Bye!&#x27;</span>)</span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				die(border, <span class="string">&#x27;No this one! Sorry!!&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">&#x27;Kidding me!? Bye!!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<p>要找到8组特殊的数，满足两个数异或的结果的MD5值不为<code>ae09d7510659ca40eda3e45ca70e9606</code>，且<code>md5(d1) ^ md5(d2) ^ md5(salt)</code>&#x3D;&#x3D;<code>a483b30944cbf762d4a3afc154aad825</code></p>
<p>怀疑<code>a483b30944cbf762d4a3afc154aad825</code>就是md5(salt)的值，如果假设成立，那么只需找到8组原值不一样而MD5值一样的特殊hex字符即可。</p>
<p>使用妙妙工具fastcoll_v1.0.0.5.exe，新建一个txt文档，内容随便填，然后把txt拖进exe，生成两个txt文件，使用以下脚本读入即可得到原值不一样但MD5一样的字符串：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_to_hex</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file_content = file.read()</span><br><span class="line">            hex_content = binascii.hexlify(file_content).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> hex_content</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;文件未找到。&quot;</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;读取文件时出错: <span class="subst">&#123;e&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line">file1_path = <span class="string">&#x27;1_msg1.txt&#x27;</span>  <span class="comment"># 替换为你的文件路径</span></span><br><span class="line">file2_path = <span class="string">&#x27;1_msg2.txt&#x27;</span>  <span class="comment"># 替换为你的文件路径</span></span><br><span class="line"><span class="built_in">print</span>(file_to_hex(file1_path))</span><br><span class="line"><span class="built_in">print</span>(file_to_hex(file2_path))</span><br><span class="line"><span class="comment"># 33343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d200507c51798a3408f8d6b72fdf7b29ae789cefd20d0d5c152680428b960bdb9aebac0b6a6bee14cb2fdf34ad81181bf9f7902842fbb51a35003b5682e81a85a1cb79d015d3f49b3d7a7a43fd5e572ab2bc726029663e65c91a86bdecc7fde98045a617f4cf077e98424dd78f8055ea3d810638317e26b2b9eb1e32590762cd</span></span><br><span class="line"><span class="comment"># 33343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d200507c51798a3408f8d6b72fdf7b29ae789c6fd20d0d5c152680428b960bdb9aebac0b6a6bee14cb2fdf34ad01191bf9f7902842fbb51a35003bd682e81a85a1cb79d015d3f49b3d7a7a43fd5e572ab2bc72e029663e65c91a86bdecc7fde98045a617f4cf077e98424dd78f0055ea3d810638317e26b2b9eb1eb2590762cd</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&#x27;01.cr.yp.toc.tf&#x27;</span>, <span class="number">13771</span>)</span><br><span class="line"></span><br><span class="line">ds = [(<span class="string">b&quot;0e306561559aa787d00bc6f70bbdfe3404cf03659e704f8534c00ffb659c4c8740cc942feb2da115a3f4155cbb8607497386656d7d1f34a42059d78f5a8dd1ef&quot;</span>, <span class="string">b&quot;0e306561559aa787d00bc6f70bbdfe3404cf03659e744f8534c00ffb659c4c8740cc942feb2da115a3f415dcbb8607497386656d7d1f34a42059d78f5a8dd1ef&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2&quot;</span>, <span class="string">b&quot;4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;61626300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a9b7a9705dbc016d1ee7267986215fc17236f827f57efa2e5bc639daeecf923f47da03c75874d3356b065cb3fc6d3e2d4c31e717e0f0bb5bafda82badcff2a73c39fb1ca8b0beea617114d5c2b91d03b4c68742afd7a201ad99bf5c8d0687932354f17bb28f45e619971b0cfa4a646c6f0867c11d6b78a52a8d32d4d9dd3b36b&quot;</span>,<span class="string">b&quot;61626300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a9b7a9705dbc016d1ee7267986215fc17236f8a7f57efa2e5bc639daeecf923f47da03c75874d3356b065cb3fced3e2d4c31e717e0f0bb5bafda823adcff2a73c39fb1ca8b0beea617114d5c2b91d03b4c6874aafd7a201ad99bf5c8d0687932354f17bb28f45e619971b0cfa42646c6f0867c11d6b78a52a8d32dcd9dd3b36b&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;6200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000069dfdadccef14546a1a0809d4c8dc82b717c76f467a3f3e9431e3f8d8b49acccaabb0dc8ceefd6cd4b285c3ccfa944819ce400a4bf6c2dae6efdf2333b09eeaffdcff58b151f3a4780220f634b0154295d8383781e8d99ee74d7ffdf4f0c4d41740ec1ad06a77bfe6b9ae71831defde4fd5648a916e9982caf4ab0b1d7b00eca&quot;</span>, <span class="string">b&quot;6200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000069dfdadccef14546a1a0809d4c8dc82b717c767467a3f3e9431e3f8d8b49acccaabb0dc8ceefd6cd4b285c3ccf2945819ce400a4bf6c2dae6efdf2b33b09eeaffdcff58b151f3a4780220f634b0154295d8383f81e8d99ee74d7ffdf4f0c4d41740ec1ad06a77bfe6b9ae718315efde4fd5648a916e9982caf4ab031d7b00eca&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;617364666173646661736466000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007dd5056da72f5275f37335a3ce864634c45719bbf0f20a641f3a7cc2b28991065fb109decee5134fe765cc81d635228c0125c7c643b46d3c7649e59b32e490b5b6f839240471983c57ee34cdbe3f8c24bbbd0a69db9c9f4e843d9c4b5fa1e5c1ae68bd0a820793365b9667d130ac64db90058a656ef8c7e75e6daea5b8012ab7&quot;</span>, <span class="string">b&quot;617364666173646661736466000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007dd5056da72f5275f37335a3ce864634c457193bf0f20a641f3a7cc2b28991065fb109decee5134fe765cc81d6b5228c0125c7c643b46d3c7649e51b32e490b5b6f839240471983c57ee34cdbe3f8c24bbbd0ae9db9c9f4e843d9c4b5fa1e5c1ae68bd0a820793365b9667d1302c64db90058a656ef8c7e75e6dae25b8012ab7&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;716171000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006133f4597f9e0a80a1fcf81949371662bc64cc93feedeef1166280d5b4ad93b5290b0ce63a92fa1eebed4b418ed3857cb26b2d026c555660b6abe25f2841ba2e92c2dbfb18076c136a1084a5352c98339a1fb74907a60e6bd31a864becc6016cb8bec655f2491c7f6a27688f92bc05ef2fe26b4e2c342a8e569adb52367570fe&quot;</span>, <span class="string">b&quot;716171000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006133f4597f9e0a80a1fcf81949371662bc64cc13feedeef1166280d5b4ad93b5290b0ce63a92fa1eebed4b418e53867cb26b2d026c555660b6abe2df2841ba2e92c2dbfb18076c136a1084a5352c98339a1fb7c907a60e6bd31a864becc6016cb8bec655f2491c7f6a27688f923c05ef2fe26b4e2c342a8e569adbd2367570fe&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;3132330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036183de0fe32973a788f49067893ff2a425b45cdff8c19bdf90579e5764620bec9f3b5013e3f1b33eb61f0790546064f24be7a6b6644e47affffcf969f2527e6d82f11da93ef022a4bd2d7867565ed19492010620f789b4b761ba0c74f9c4fc1dca4b90e846d72bedabae798aac65a2d0c8b1b1f0f3a4b253764599d2e13349b&quot;</span>, <span class="string">b&quot;3132330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036183de0fe32973a788f49067893ff2a425b454dff8c19bdf90579e5764620bec9f3b5013e3f1b33eb61f07905c6064f24be7a6b6644e47affffcf169f2527e6d82f11da93ef022a4bd2d7867565ed19492010e20f789b4b761ba0c74f9c4fc1dca4b90e846d72bedabae798aa465a2d0c8b1b1f0f3a4b253764591d2e13349b&quot;</span>),</span><br><span class="line">      (<span class="string">b&quot;33343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d200507c51798a3408f8d6b72fdf7b29ae789cefd20d0d5c152680428b960bdb9aebac0b6a6bee14cb2fdf34ad81181bf9f7902842fbb51a35003b5682e81a85a1cb79d015d3f49b3d7a7a43fd5e572ab2bc726029663e65c91a86bdecc7fde98045a617f4cf077e98424dd78f8055ea3d810638317e26b2b9eb1e32590762cd&quot;</span>, <span class="string">b&quot;33343500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d200507c51798a3408f8d6b72fdf7b29ae789c6fd20d0d5c152680428b960bdb9aebac0b6a6bee14cb2fdf34ad01191bf9f7902842fbb51a35003bd682e81a85a1cb79d015d3f49b3d7a7a43fd5e572ab2bc72e029663e65c91a86bdecc7fde98045a617f4cf077e98424dd78f0055ea3d810638317e26b2b9eb1eb2590762cd&quot;</span>)</span><br><span class="line">      ]</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> ds:</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;first input:&quot;</span>)</span><br><span class="line">    r.sendline(d[<span class="number">0</span>])</span><br><span class="line">    r.recvuntil(<span class="string">b&quot;second input:&quot;</span>)</span><br><span class="line">    r.sendline(d[<span class="number">1</span>])</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment"># ┃ Congrats! the flag: b&#x27;CCTF&#123;mD5_h4Sh_cOlL!Si0N_CrYp7o_ch41lEnGe!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h1><h2 id="Joe-19"><a href="#Joe-19" class="headerlink" title="Joe-19"></a>Joe-19</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> GPT <span class="keyword">import</span> GPT6 <span class="comment"># deep fake </span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">P = [GPT6(<span class="string">&#x27;A 512-bit prime appears in consecutive digits of e&#x27;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">n, m = prod(P), bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这题只需要知道，p是从自然常数e中截取出来的，然后让GPT写个脚本就能出。</p>
<p>本来还以为是从65537里面的数组成的，想着用剪枝，但是看着n最低位是3，怎么组合都弄不成3，于是就转变思路了</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mpmath</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置mpmath的精度以计算足够多位的e</span></span><br><span class="line">mpmath.mp.dps = <span class="number">20000</span>  <span class="comment"># 计算到10000位小数</span></span><br><span class="line">n = <span class="number">8098851734937207931222242323719278262039311278408396153102939840336549151541408692581651429325092535316359074019383926520363453725271849258924996783681725111665666420297112252565291898169877088446887149672943461236879128453847442584868198963005276340812322871768679441501282681171263391133217373094824601748838255306528243603493400515452224778867670063040337191204276832576625227337670689681430055765023322478267339944312535862682499007423158988134472889946113994555274385595499503495488202251032898470224056637967019786473820952632846823442509236976892995505554046850101313269847925347047514591030406052185186963433</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取e的值</span></span><br><span class="line">e_value = <span class="built_in">str</span>(mpmath.e).replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># 去掉小数点</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定要寻找的素数的长度（十进制位数）</span></span><br><span class="line">target_length = <span class="number">154</span>  <span class="comment"># 512位二进制数大约是155位十进制数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从e的数字中提取连续的target_length位并检查素性</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_value) - target_length + <span class="number">1</span>):</span><br><span class="line">    candidate = e_value[i:i + target_length]</span><br><span class="line">    candidate_int = <span class="built_in">int</span>(candidate)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> sympy.isprime(candidate_int) <span class="keyword">and</span> (n % candidate_int == <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Found a 512-bit prime: <span class="subst">&#123;candidate&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;No 512-bit prime found in the specified range of digits.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>求出1个p之后尝试解了一下，没想到就出了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse,long_to_bytes</span><br><span class="line"></span><br><span class="line">c = <span class="number">7109666883988892105091816608945789114105575520302872143453259352879355990908149124303310269223886289484842913063773914475282456079383409262649058768777227206800315566373109284537693635270488429501591721126853086090237488579840160957328710017268493911400151764046320861154478494943928510792105098343926542515526432005970840321142196894715037239909959538873866099850417570975505565638622448664580282210383639403173773002795595142150433695880167315674091756597784809792396452578104130341085213443116999368555639128246707794076354522200892568943534878523445909591352323861659891882091917178199085781803940677425823784662</span></span><br><span class="line">p = <span class="number">7728751393377105569802455757436190501772466214587592374418657530064998056688376964229825501195065837843125232135309371235243969149662310110328243570065781</span></span><br><span class="line"></span><br><span class="line">d = inverse(<span class="number">65537</span>,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># CCTF&#123;ASIS_h1r3_7aL3nT5_t0_cO1La8orAt3_!N_Crypto_CTF!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="honey"><a href="#honey" class="headerlink" title="honey"></a>honey</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_params</span>(<span class="params">nbit</span>):</span><br><span class="line">	p, Q, R, S = getPrime(nbit), [], [], []</span><br><span class="line">	d = <span class="built_in">int</span>(sqrt(nbit &lt;&lt; <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">		Q.append(getRandomRange(<span class="number">1</span>, p - <span class="number">1</span>))</span><br><span class="line">		R.append(getRandomRange(<span class="number">0</span>, p - <span class="number">1</span>))</span><br><span class="line">		S.append(getRandomRange(<span class="number">0</span>, p - <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> p, Q, R, S</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, params</span>):</span><br><span class="line">	p, Q, R, S = params</span><br><span class="line">	<span class="keyword">assert</span> m &lt; p</span><br><span class="line">	d = <span class="built_in">int</span>(sqrt(p.bit_length() &lt;&lt; <span class="number">1</span>))</span><br><span class="line">	C = []</span><br><span class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(d):</span><br><span class="line">		r, s = [getRandomNBitInteger(d) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">		c = Q[_] * m + r * R[_] + s * S[_]</span><br><span class="line">		C.append(c % p)</span><br><span class="line">	<span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">params = gen_params(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">C = encrypt(m, params)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;params_enc.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;p = <span class="subst">&#123;params[<span class="number">0</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;Q = <span class="subst">&#123;params[<span class="number">1</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;R = <span class="subst">&#123;params[<span class="number">2</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;S = <span class="subst">&#123;params[<span class="number">3</span>]&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;C = <span class="subst">&#123;C&#125;</span>&#x27;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>审计代码知道<br>$$<br>C_i \equiv mQ_i + r_iR_i + s_iS_i \mod p<br>$$</p>
<p>估算一下参数的大小</p>
<p>$r_i,s_i$ -&gt; 32bit</p>
<p>$Q_i,R_i,S_i$ -&gt; 512bit</p>
<p>r,s比较小，所以以他作为目标向量，求出来之后再回推m</p>
<p><img src="/../../images/2024RCTF/11.png"></p>
<p>这里不是很确定m的大小，我就随便试了一下调整格的大小，结果就出了</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">10580731215444436219213907263947534038012197972307836319229421193761088798378768844649759133142120180834573817149711299466707823017636232456526471274387917</span></span><br><span class="line">Q = [<span class="number">6718668664591596190749745980002066645380242844394957953766947533978323053938214647829798301606252456858132121628517723050462291300790766055200866765561610</span>, ...]</span><br><span class="line">R = [<span class="number">8922553268219903948421811612403588317187402276064169063400419617931637566221670948925221403527928336656976084021780421068421112325215152715630319708159148</span>, ...]</span><br><span class="line">S = [<span class="number">4389820170235953517860364281419052587762385444517203945856665517072263529411621622474249480804818285716662154444854074939122170918939074730520091008754679</span>, ...]</span><br><span class="line">C = [<span class="number">2312453804397990204892582347458673184184584053391181580849656202381982276483135032773767708029907426388840618138608941250788745829088238589339462137662516</span>, ...]</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ge = Matrix(QQ,[</span><br><span class="line">    [QQ(<span class="number">1</span>/<span class="number">2</span>^<span class="number">400</span>),<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,Q[<span class="number">0</span>]],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,R[<span class="number">0</span>]],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,S[<span class="number">0</span>]],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">32</span>,-C[<span class="number">0</span>]],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,p]</span><br><span class="line">])</span><br><span class="line">Ge[:,-<span class="number">1</span>:] *= <span class="number">2</span>^<span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> line[-<span class="number">1</span>] == <span class="number">0</span> <span class="keyword">and</span> line[-<span class="number">2</span>] == <span class="number">2</span>^<span class="number">32</span>:</span><br><span class="line">        r0 = line[<span class="number">1</span>]</span><br><span class="line">        s0 = line[<span class="number">2</span>]</span><br><span class="line">        m = (C[<span class="number">0</span>] - r0*R[<span class="number">0</span>] - s0*S[<span class="number">0</span>])*inverse(Q[<span class="number">0</span>],p) % p</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;r0 = <span class="subst">&#123;r0&#125;</span>&quot;</span>)		<span class="comment"># 2638621544</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;s0 = <span class="subst">&#123;s0&#125;</span>&quot;</span>)		<span class="comment"># 3219364802</span></span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># CCTF&#123;3X7eNdED_H!dD3n_nNm8eR_pR0Bl3m_iN_CCTF!!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Alibols"><a href="#Alibols" class="headerlink" title="Alibols"></a>Alibols</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> d, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">d</span>):</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		f = getRandomRange(<span class="number">1</span>, <span class="built_in">int</span>(sqrt(<span class="number">2</span>) * <span class="number">10</span> ** d))</span><br><span class="line">		g = getRandomRange(<span class="number">10</span> ** d, <span class="built_in">int</span>(sqrt(<span class="number">2</span>) * <span class="number">10</span> ** d))</span><br><span class="line">		<span class="keyword">if</span> gcd(f, <span class="number">10</span> * g) == <span class="number">1</span>:</span><br><span class="line">			q = <span class="number">4</span> * <span class="number">100</span> ** d</span><br><span class="line">			h = inverse(f, q) * g % q</span><br><span class="line">			<span class="keyword">if</span> gcd(h, <span class="number">10</span> * d) == <span class="number">1</span>:</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	pkey, skey = (d, h), (f, g)</span><br><span class="line">	<span class="keyword">return</span> pkey, skey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, pkey</span>):</span><br><span class="line">	d, h = pkey</span><br><span class="line">	q = <span class="number">4</span> * <span class="number">100</span> ** d</span><br><span class="line">	<span class="keyword">assert</span> m &lt; <span class="number">10</span> ** d</span><br><span class="line">	r = getRandomRange(<span class="number">1</span>, <span class="number">10</span> ** d // <span class="number">2</span>)</span><br><span class="line">	c = (r * h + m + r) % q</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">pkey, _ = genkey(d)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = encrypt(m, pkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;h = <span class="subst">&#123;pkey[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>测了一下数据，d应该是等于563，其他参数的大小如下<br>$$<br>h \equiv f^{-1}g\mod q<br>$$</p>
<p>$f,g$ -&gt; 1871bit</p>
<p>$q$  -&gt; 3743bit	h -&gt; 3740bit</p>
<p>$m &lt;$ 1871bit</p>
<p>$r$ -&gt; 1871bit<br>$$<br>c \equiv rh + m + r \mod q<br>$$</p>
<p>$$<br>(h+1)r + m + kq -c &#x3D; 0<br>$$</p>
<p><img src="/../../images/2024RCTF/12.png"></p>
<p>没想到又出了</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">h = <span class="number">1051643987107349427988807326909852110640860009433515828832892541964729933410444984350917250524103015414239941369074041041830326426044333499878031164851095096864048639115431370526747014210332286314344073411522846701723463410585601251886732229726828022089809603850477551571014006202841406236367999378786782206165205893353928598469661871284779486855440579818275314024966224282757807716013799903830828885606714972634243850947534165272668985513949964901606268939300116019465522042467054120201087606016018354238401711720121586874288767235317479748890350702705575809130664969776549574720593740409234863974057904204809404816059921579771581800937241591669455683460570640868196509926763901079838233646036933530095891316054589051458146768287967886035091641162494322987627448810201550901588438560433001422233269632915351406169253963308421081459981594969405377353502889363324282815864766827664453823780238352371809048289845094882346227809082005375092441877966603138648719670349093616548820955566204871333952902983753935678447080673827214244142614295192263451840766771122229866931492260663320087497820892824540996643905125018452302747847009</span></span><br><span class="line">c = <span class="number">11913143174789215053772744981113562063689725867199301496294410323568897757042952642806438602327917861884988292757318755590132189620231444302311290566584065812614959093870787195145654508262419270742989923415342357807325941686508030706603920412262004324188375072184983301522882728578077572816154054220606088703932092256905881975876112779175003897105313776239681492514925430817300633974666123599685062340158348009344351002327049272743679109535286730751345284084148118733529966364414749672437370878526710641430471595906340522772252875146681541656231708112317601000655090279925720590940060372738708208419449824043905057860829031242339842131799965043031307394209699264362321397162645220002253271689678364848888381499587038475895945238726252440250183268252483198408039250213490525880829604473555612305513974817850974135874728084839426045420913060975464553734293001460752648937744531874552694145500413222582269910431269597066268600572899619407093373565994271589940926018891922169454906132284552523035481664164354874071831210264979733079749696197917769435226866441989054017071332158916586376454753209296136133271926449919437888563234409</span></span><br><span class="line">d = <span class="number">563</span></span><br><span class="line">q = <span class="number">4</span> * <span class="number">100</span> ** d</span><br><span class="line"></span><br><span class="line">Ge = Matrix(QQ,[</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,QQ(<span class="number">1</span>/<span class="number">2</span>^<span class="number">1300</span>),<span class="number">0</span>,h+<span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">500</span>,-c],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,q]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">Ge[:,-<span class="number">1</span>:] *= <span class="number">2</span>^<span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> line[-<span class="number">1</span>] == <span class="number">0</span> <span class="keyword">and</span> line[-<span class="number">2</span>] == <span class="number">2</span>^<span class="number">500</span>:</span><br><span class="line">        m = line[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="comment"># CCTF&#123;4_c0N9rU3n7!aL_Pu81iC_k3Y_cRyp70_5ySTeM_1N_CCTF!!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="RM2"><a href="#RM2" class="headerlink" title="RM2"></a>RM2</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">die</span>(<span class="params">*args</span>):</span><br><span class="line">	pr(*args)</span><br><span class="line">	quit()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">*args</span>):</span><br><span class="line">	s = <span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, args))</span><br><span class="line">	sys.stdout.write(s + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">	sys.stdout.flush()</span><br><span class="line">	</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sc</span>(): </span><br><span class="line">	<span class="keyword">return</span> sys.stdin.buffer.readline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">randstr</span>(<span class="params">l</span>):</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([printable[randint(<span class="number">0</span>, <span class="number">90</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(l)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, p, q</span>):</span><br><span class="line">	e = <span class="number">65537</span></span><br><span class="line">	m1, m2 = msg[:<span class="built_in">len</span>(msg) &gt;&gt; <span class="number">1</span>], msg[<span class="built_in">len</span>(msg) &gt;&gt; <span class="number">1</span>:]</span><br><span class="line">	m1, m2 = bytes_to_long(m1), bytes_to_long(m2)</span><br><span class="line">	c1, c2 = <span class="built_in">pow</span>(m1, e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>)), <span class="built_in">pow</span>(m2, e, (<span class="number">2</span>*p + <span class="number">1</span>) * (<span class="number">2</span>*q + <span class="number">1</span>))</span><br><span class="line">	<span class="keyword">return</span> (c1, c2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">	border = <span class="string">&quot;┃&quot;</span></span><br><span class="line">	pr(        <span class="string">&quot;┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓&quot;</span>)</span><br><span class="line">	pr(border, <span class="string">&quot;.: Welcome to RM2 task! Your mission is break our cryptosystem :. &quot;</span>, border)</span><br><span class="line">	pr(        <span class="string">&quot;┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛&quot;</span>)</span><br><span class="line">	nbit, _b = <span class="number">1024</span>, <span class="literal">False</span></span><br><span class="line">	pr(border, <span class="string">f&quot;Please provide your desired <span class="subst">&#123;nbit&#125;</span>-bit prime numbers p, q:&quot;</span>)</span><br><span class="line">	inp = sc().decode()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		p, q = [<span class="built_in">int</span>(_) <span class="keyword">for</span> _ <span class="keyword">in</span> inp.split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">		<span class="keyword">if</span> p.bit_length() == q.bit_length() == nbit <span class="keyword">and</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> p != q:</span><br><span class="line">			_b = <span class="literal">True</span></span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		die(border, <span class="string">f&quot;The input you provided is is not valid!&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> _b:</span><br><span class="line">		e, n =  <span class="number">65537</span>, p * q</span><br><span class="line">		s = randstr(nbit &gt;&gt; <span class="number">4</span>).encode()</span><br><span class="line">		m = bytes_to_long(s)</span><br><span class="line">		<span class="keyword">assert</span> m &lt; n &gt;&gt; <span class="number">2</span></span><br><span class="line">		c1, c2 = encrypt(s, p, q)</span><br><span class="line">		pr(border, <span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line">		pr(border, <span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line">		pr(border, <span class="string">f&#x27;Now, send us the secret string to get the flag: &#x27;</span>)</span><br><span class="line">		_m = sc().strip()</span><br><span class="line">		<span class="keyword">if</span> _m == s:</span><br><span class="line">			die(border, <span class="string">f&#x27;Congrats, you got the flag: <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			die(border, <span class="string">f&#x27;The secret string is not correct! Bye!!&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		die(border, <span class="string">f&quot;Your input does not meet the requirements!!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

<p>s不是很长，两个分别在因子下求解，所以传入一个$p-1$光滑的$p$，和$2q+1$光滑的q即可</p>
<p>下面记录下对生成这样素数的理解:</p>
<p>$p-1$光滑，所以$p-1 &#x3D; 2\times tmp$，tmp是一堆素数之积(除2外)，所以要生成的是$p &#x3D; 2\times tmp + 1$,tmp是一堆素数之积，这样生成会快一点</p>
<p>$2p+1$光滑，所以$2p+1 &#x3D; 2\times tmp$，tmp是一堆素数之积(除2外)，所以要生成的是$p &#x3D; \frac{2\times tmp - 1}{2}$</p>
<p>先生成素数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P_BITS = <span class="number">1024</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime1</span>(<span class="params">nbits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">int</span>(p).bit_length() &lt; nbits-<span class="number">1</span>):</span><br><span class="line">            p *= choice(sieve_base[<span class="number">1</span>:])</span><br><span class="line">        prime = <span class="number">2</span>*p + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(<span class="built_in">int</span>(prime)) <span class="keyword">and</span> <span class="built_in">int</span>(prime).bit_length() == P_BITS:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(prime)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime2</span>(<span class="params">nbits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">int</span>(p).bit_length() &lt; nbits+<span class="number">1</span>):</span><br><span class="line">            p *= choice(sieve_base)</span><br><span class="line">        prime = (p - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(<span class="built_in">int</span>(prime)) <span class="keyword">and</span> <span class="built_in">int</span>(prime).bit_length() == P_BITS:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(prime)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># p = gen_prime1(P_BITS)</span></span><br><span class="line"><span class="comment"># q = gen_prime2(P_BITS)</span></span><br><span class="line">p = <span class="number">133224050543430062211629847044421243222910690720365968427412841722506439174549747613990210142024028142848723612800105705159487044524842057980872245885287397333870551220049647060119814898547349156706111992624741988947657765158716186961219939168491143499535969766310024424830954645873772043625734178759763058883</span></span><br><span class="line">q = <span class="number">90330421064223713929276769622914087953294714791357085135339678205426985257931704523421399767629583035835956696500783300892674935831518546758439508387421293154286042908799206279898945836238163017701920492640836213120071887754494477278200584018477180611850795938206816002694846174745054900075332883738901295549</span></span><br></pre></td></tr></table></figure>

<p>然后求解</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long,inverse,getPrime</span><br><span class="line"></span><br><span class="line">p = <span class="number">133224050543430062211629847044421243222910690720365968427412841722506439174549747613990210142024028142848723612800105705159487044524842057980872245885287397333870551220049647060119814898547349156706111992624741988947657765158716186961219939168491143499535969766310024424830954645873772043625734178759763058883</span></span><br><span class="line">q = <span class="number">90330421064223713929276769622914087953294714791357085135339678205426985257931704523421399767629583035835956696500783300892674935831518546758439508387421293154286042908799206279898945836238163017701920492640836213120071887754494477278200584018477180611850795938206816002694846174745054900075332883738901295549</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line">n1 = (p-<span class="number">1</span>)</span><br><span class="line">phi1 = euler_phi(n1)</span><br><span class="line">c1 = <span class="number">10920040184063937330062369641058093987602180453203879555263555616008000859717369547035437856331030289892457348998292660185759316954283211112763057141499575810688552353918137784619536132865255353896574438643411877302963558058194884372599112539223773730379381954458919125418236366676594499508836447883244427719529495669022745639596702219937961719630056787147832971741741278370751419544547004477497899818613848989928598050054917555384828186318004221479799224794507515204208953695214347522664634474097349477921722329849903085734515811051215901056077439706937057643541605766587015587597029241872177246233639268369824801960</span></span><br><span class="line">d1 = inverse(e,phi1)</span><br><span class="line">msg1 = long_to_bytes(<span class="built_in">pow</span>(c1,d1,n1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">n2 = <span class="number">2</span>*q+<span class="number">1</span></span><br><span class="line">phi2 = euler_phi(n2)</span><br><span class="line">c2 = <span class="number">40240165444835868284063521915111268495390440479335880314319173479118240399430785825394427823808556469730471570337870033183167584945225672715772179844155636304379997183298167671558489860291993650194366426803784920045176344943441683642218580730296842012824462542341290923119391319224609662044459255384017532728103430799411305666473668767445227108425779639540656627336410110113904801954857501695392248776344619170213777317849221706996589446306999057541916623421407742141273775328090929130416512987442660457831440486646403511227732914832454675759140987636550786227531795703948669301173974004204991020091697915628179034806</span></span><br><span class="line">d2 = inverse(e,phi2)</span><br><span class="line">msg2 = long_to_bytes(<span class="built_in">pow</span>(c2,d2,n2))</span><br><span class="line"></span><br><span class="line">msg = msg1 + msg2</span><br><span class="line"><span class="built_in">print</span>(msg)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">#&lt;CPWr?dw^`J;hoKi]s]0qSv4A6IZ!j4jnTC&#123;BUGWB`O*(Zu`d0[1TNa7pdU^vv&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># CCTF&#123;i_l0v3_5UpeR_S4fE_Pr1m3s!!&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/2023PolarCTF/RM2.png"></p>
<h2 id="Bada"><a href="#Bada" class="headerlink" title="Bada"></a>Bada</h2><p>已知<br>$$<br>f(a+1,b) &#x3D; f(a,b) + a<br>$$</p>
<p>$$<br>f(a,b+1) &#x3D; f(a,b) - b<br>$$</p>
<p>稍微推了一下知道<br>$$<br>f(x,1) &#x3D; f(1,1) + \sum_{i&#x3D;1}^x(i-1)<br>$$<br>则<br>$$<br>f(x,y) &#x3D; f(1,1) +\sum_{i&#x3D;1}^x(i-1) - \sum_{i&#x3D;1}^y(i-1)<br>$$</p>
<p>$x,y$一样的时候，$f(x,y) &#x3D; f(1,1)$</p>
<p>有个比较妙的构造就是让$x &#x3D; y+1$，这样方便求$y$<br>$$<br>f(x,y) &#x3D; f(y+1,y) &#x3D; f(1,1) + y<br>$$</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;01.cr.yp.toc.tf&quot;</span>,<span class="number">17113</span>)</span><br><span class="line"></span><br><span class="line">sh.recvline().strip().decode()</span><br><span class="line">sh.recvline().strip().decode()</span><br><span class="line">sh.recvline().strip().decode()</span><br><span class="line">sh.recvline().strip().decode()</span><br><span class="line">sh.recvline().strip().decode()</span><br><span class="line">sh.recvline().strip().decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    data = sh.recvline().strip().decode().split(<span class="string">&quot;and&quot;</span>)</span><br><span class="line">    old = <span class="built_in">eval</span>(data[<span class="number">0</span>].split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">    new = <span class="built_in">eval</span>(data[<span class="number">1</span>].split(<span class="string">&quot;=&quot;</span>)[-<span class="number">1</span>])</span><br><span class="line">    y = new - old</span><br><span class="line">    x = y+<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    sh.recvline().strip().decode()</span><br><span class="line">    sh.sendline(<span class="string">f&quot;<span class="subst">&#123;x&#125;</span>,<span class="subst">&#123;y&#125;</span>&quot;</span>.encode())</span><br><span class="line">    <span class="built_in">print</span>(sh.recvline().strip().decode())</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">19</span>:</span><br><span class="line">        <span class="built_in">print</span>(sh.recvline().strip().decode())</span><br><span class="line">        <span class="comment"># CCTF&#123;BADA_iZ_4_K0r3An_5!ngeR!!&#125;</span></span><br></pre></td></tr></table></figure>

<p>连续过20次即可</p>
<h2 id="melek"><a href="#melek" class="headerlink" title="melek"></a>melek</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, nbit</span>):</span><br><span class="line">	m, p = bytes_to_long(msg), getPrime(nbit)</span><br><span class="line">	<span class="keyword">assert</span> m &lt; p</span><br><span class="line">	e, t = randint(<span class="number">1</span>, p - <span class="number">1</span>), randint(<span class="number">1</span>, nbit - <span class="number">1</span>)</span><br><span class="line">	C = [randint(<span class="number">0</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t - <span class="number">1</span>)] + [<span class="built_in">pow</span>(m, e, p)]</span><br><span class="line">	R.&lt;x&gt; = GF(p)[]</span><br><span class="line">	f = R(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t): f += x**(t - i - <span class="number">1</span>) * C[i]</span><br><span class="line">	P = [<span class="built_in">list</span>(<span class="built_in">range</span>(nbit))]</span><br><span class="line">	shuffle(P)</span><br><span class="line">	P = P[:t]</span><br><span class="line">	PT = [(a, f(a)) <span class="keyword">for</span> a <span class="keyword">in</span> [randint(<span class="number">1</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(t)]]</span><br><span class="line">	<span class="keyword">return</span> e, p, PT</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">512</span></span><br><span class="line">enc = encrypt(flag, nbit)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>很容易知道$t &#x3D; 385$</p>
<p>模p下有一个多项式:<br>$$<br>f \equiv C_0x^{384}+C_1x^{383} +…+C_{383}x+C_{384} \mod p<br>$$<br>而这个$C_{384} \equiv m^e \mod p$</p>
<p>题目给了我们385组$(a,f(a))$。思路比较清晰，就是把常数项求出来，然后解RSA</p>
<p>解这个矩阵方程，就能把$C_i$求出来</p>
<p><img src="/../../images/2024RCTF/13.png"></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="built_in">eval</span>(<span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>).read())</span><br><span class="line">e,p,PT = enc</span><br><span class="line">t = <span class="built_in">len</span>(PT)</span><br><span class="line"></span><br><span class="line">A = [[<span class="built_in">pow</span>(PT[i][<span class="number">0</span>],t-<span class="number">1</span>-j,p) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(t)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)]</span><br><span class="line">B = [PT[i][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)]</span><br><span class="line"></span><br><span class="line">A = Matrix(Zmod(p),A).transpose()</span><br><span class="line">B = vector(Zmod(p),B)</span><br><span class="line"></span><br><span class="line">C = A.solve_left(B).<span class="built_in">list</span>()</span><br><span class="line">c = C[-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># 7578451683223886721897751965012512970186814199061886859082385728532294810974986601048390882041773215459258245487361965408708218417206386123135513829067466</span></span><br></pre></td></tr></table></figure>

<p>然后求解RSA，<code>e,phi</code>不互素，公因数是2，有限域开根</p>
<blockquote>
<p>exp.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">7578451683223886721897751965012512970186814199061886859082385728532294810974986601048390882041773215459258245487361965408708218417206386123135513829067466</span></span><br><span class="line">e = <span class="number">3316473234742974510609176519968107496789324827839883341690084725836178910956015867823194881383215644380418162164089588828798132617649547462723383625707014</span></span><br><span class="line">p = <span class="number">9486915681801496583557174944405629563403346572353787092582704754226121096049954529719556720667960706741084895049852989479773192757968901195529919070579679</span></span><br><span class="line"></span><br><span class="line">d = inverse(e//<span class="number">2</span>,p-<span class="number">1</span>)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x^<span class="number">2</span> - m2</span><br><span class="line">res = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(root[<span class="number">0</span>])))</span><br><span class="line">    <span class="comment"># CCTF&#123;SSS_iZ_4n_3fF!ciEn7_5ecr3T_ShArIn9_alGorItHm!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Vantuk"><a href="#Vantuk" class="headerlink" title="Vantuk"></a>Vantuk</h2><blockquote>
<p>task.py</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">u</span>(<span class="params">a, x, y</span>):</span><br><span class="line">	<span class="keyword">assert</span> a.is_integer() <span class="keyword">and</span> x.is_rational() <span class="keyword">and</span> y.is_rational()</span><br><span class="line">	<span class="keyword">return</span> x + Rational((a * x - y)/(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">v</span>(<span class="params">a, x, y</span>):</span><br><span class="line">	<span class="keyword">assert</span> a.is_integer() <span class="keyword">and</span> x.is_rational() <span class="keyword">and</span> y.is_rational()</span><br><span class="line">	<span class="keyword">return</span> y - Rational((x + a * y)/(x ** <span class="number">2</span> + y ** <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">m1 = Integer(bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]))</span><br><span class="line">m2 = Integer(bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]))</span><br><span class="line">a = Integer(randint(<span class="number">1</span>, <span class="number">1</span> &lt;&lt; <span class="number">512</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;u(<span class="number">5</span>, a, <span class="number">4</span>*a)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;U = <span class="subst">&#123;u(a, m1, m2)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;V = <span class="subst">&#123;v(a, m1, m2)&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>已知<br>$$<br>A &#x3D; a+\frac{5a-4a}{a^2+16a^2} &#x3D; a+\frac{a}{17a^2}\<br>$$</p>
<p>$$<br>U &#x3D; m_1+\frac{am_1-m_2}{m_1^2+m_2^2}<br>$$</p>
<p>$$<br>V &#x3D; m_2-\frac{m_1+am_2}{m_1^2+m_2^2}<br>$$</p>
<p>先尝试解一下a吧。</p>
<p>$$<br>A &#x3D; a+\frac{1}{17a}<br>\quad \longrightarrow \quad 17A &#x3D; 17a + \frac{1}{a}<br>$$</p>
<p>解这样的方程即可求出a:<br>$$<br>17A\times a &#x3D; 17a^2 + 1<br>$$<br>这里A是分式，求解的时候左右两边同时乘上一个大数，再解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">A = <span class="number">6080057478320734754578252336954411086329731226445881868123716230995225973869803901199434606333357820515656618869146654158788168766842914410452961599054518002813068771365518772891986864276289860125347726759503163130747954047189098354503529975642910040243893426023284760560550058749486622149336255123273699589</span>/<span class="number">10166660077500992696786674322778747305573988490459101951030888617339232488971703619809763229396514541455656973227690713112602531083990085142454453827397614</span></span><br><span class="line"></span><br><span class="line">var(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">T = <span class="number">2</span>^<span class="number">2000</span></span><br><span class="line">f = (<span class="number">17</span>*a^<span class="number">2</span> + <span class="number">1</span>)*T - (<span class="number">17</span>*A * a)*T == <span class="number">0</span></span><br><span class="line">res = f.roots()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># 598038828088293688046274960163455723857293440615241291237111095137601911115982565871162542905677325967979821954570041947800148887293534420144379636905742</span></span><br></pre></td></tr></table></figure>

<p>然后用同样的思路，解$m_1,m_2$的方程组就出了</p>
<blockquote>
<p>exp</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">U = <span class="number">3225614773582213369706292127090052479554140270383744354251548034114969532022146352828696162628127070196943244336606099417210627640399143341122777407316956319347428454301338989662689983156270502206905873768685192940264891098471650041034871787036353839986435</span>/<span class="number">9195042623204647899565271327907071916397082689301388805795886223781949921278129819112624089473306486581983153439866384171645444456400131619437018878598534536108398238424609</span></span><br><span class="line">V = <span class="number">1971582892158351181843851788527088806814104010680626247728311504906886858748378948163011806974145871263749452213375101951129675358232283650086419295655854343862361076089682606804214329522917382524296561295274823374483828323983651110722084223144007926678084087</span>/<span class="number">9195042623204647899565271327907071916397082689301388805795886223781949921278129819112624089473306486581983153439866384171645444456400131619437018878598534536108398238424609</span></span><br><span class="line">a = <span class="number">598038828088293688046274960163455723857293440615241291237111095137601911115982565871162542905677325967979821954570041947800148887293534420144379636905742</span></span><br><span class="line">T = <span class="number">2</span>^<span class="number">2000</span></span><br><span class="line"></span><br><span class="line">var(<span class="string">&quot;m1,m2&quot;</span>)</span><br><span class="line"></span><br><span class="line">f1 = T*m1 + ((a*m1-m2)*T/(m1^<span class="number">2</span>+m2^<span class="number">2</span>)) == U*T</span><br><span class="line">f2 = T*m2 - ((m1+a*m2)*T/(m1^<span class="number">2</span>+m2^<span class="number">2</span>)) == V*T</span><br><span class="line"></span><br><span class="line">res = solve([f1,f2],[m1,m2])</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p>踩了个坑</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f1 = T*m1 + ((a*m1-m2)*T/(m1^<span class="number">2</span>+m2^<span class="number">2</span>)) == U*T</span><br><span class="line">f2 = T*m2 - ((m1+a*m2)*T/(m1^<span class="number">2</span>+m2^<span class="number">2</span>)) == V*T</span><br></pre></td></tr></table></figure>

<p>不能写成</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f1 = T*m1 + QQ((a*m1-m2)*T/(m1^<span class="number">2</span>+m2^<span class="number">2</span>)) == U*T</span><br><span class="line">f2 = T*m2 - QQ((m1+a*m2)*T/(m1^<span class="number">2</span>+m2^<span class="number">2</span>)) == V*T</span><br></pre></td></tr></table></figure>

<p>会报错</p>
<p>最后求出来的结果是</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">m1 = <span class="number">350799328046836724707876331502758499088281144928479088116262376685681093677946249551</span></span><br><span class="line">m2 = <span class="number">214418026424679791626535920403147011577793961208832046224896849702981130286017264892462</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(m1) + long_to_bytes(m2)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># CCTF&#123;d!D_y0U_5oLv3_7HiS_eQu4T!On_wItH_uSing_c0mPlEx_Num8erS!!?&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Soufia——Unsolved"><a href="#Soufia——Unsolved" class="headerlink" title="Soufia——Unsolved"></a>Soufia——Unsolved</h2><p>已知<br>$$<br>f(tx) + tf(y) &#x3D; f(f(x+y))<br>$$<br>函数来源<a target="_blank" rel="noopener" href="https://sqr5.wordpress.com/2019/07/17/2019%E5%B9%B4imo%E5%92%8C%E6%9F%AF%E8%A5%BF%E5%87%BD%E6%95%B0%E6%96%B9%E7%A8%8B/">2019年IMO和柯西函数方程 – Sqr5’s blog (wordpress.com)</a></p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/" title="CryptoCTF">https://dexterjie.github.io/2024/06/09/赛题复现/CryptoCTF/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/06/02/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024HDCTF/" rel="prev" title="2024HDCTF">
                  <i class="fa fa-chevron-left"></i> 2024HDCTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/07/06/%E6%9D%82%E8%AE%B03/" rel="next" title="杂记(三)">
                  杂记(三) <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">258k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">15:37</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2024/06/09/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/CryptoCTF/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
