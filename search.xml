<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ECDSA</title>
    <url>/2023/08/18/ECDSA/</url>
    <content><![CDATA[<p>起一篇文章简单记录一下ECDSA的签名过程</p>
<span id="more"></span>



<p>椭圆曲线数字签名算法（ECDSA）是使用椭圆曲线密码（ECC）对数字签名算法（DSA）的模拟</p>
<h1 id="DSA数字签名"><a href="#DSA数字签名" class="headerlink" title="DSA数字签名"></a>DSA数字签名</h1><h2 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h2><ol>
<li>选择一个合适的哈希函数，一般选择SHA1</li>
<li>选择密钥的长度$L$和$N$，</li>
<li>选择$N$比特的素数$q$</li>
<li>选择$L$比特的素数$p$，使得$p-1$是$q$的倍数</li>
<li>选择满足$g^k \equiv 1 \mod p$的最小正整数$k$为$q$的g，就是在模$p$的前提下，$ord(g) &#x3D; q的g$</li>
<li>选择私钥$x \in (0,q)$，计算$y\equiv g^x \mod p$</li>
<li>公钥为$(p,q,g,y)$，私钥为$x$</li>
</ol>
<h2 id="签名过程"><a href="#签名过程" class="headerlink" title="签名过程"></a>签名过程</h2><ol>
<li>选择随机整数$k(0,q)$作为临时密钥</li>
<li>计算$r\equiv (g^k \mod p) \mod q$</li>
<li>计算$s \equiv k^{-1}(H(m)+xr) \mod q$</li>
</ol>
<p>公开$(r,s)$，$H(m)$指哈希后的明文</p>
<h2 id="验证过程"><a href="#验证过程" class="headerlink" title="验证过程"></a>验证过程</h2><ol>
<li>计算$\omega \equiv s^{-1} \mod q$</li>
<li>计算$\mu_1 \equiv H(m)×\omega \mod q$</li>
<li>计算$\mu_2 \equiv r×\omega \mod q$</li>
<li>计算$v \equiv (g^{\mu_1}y^{\mu_2}\mod p) \mod q$</li>
<li>如果$v &#x3D; r$则验证成功</li>
</ol>
<h2 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h2><h3 id="复用k"><a href="#复用k" class="headerlink" title="复用k"></a>复用k</h3><p>如果两次签名用了同一个$k$，就可以进行攻击</p>
<p>当$k$一样时，两个$r$是一样的</p>
<p>则有</p>
<p>$s_1 \equiv k^{-1}(H(m_1)+xr) \mod q$</p>
<p>$s_2 \equiv k^{-1}(H(m_2)+xr) \mod q$</p>
<p>两式相减得</p>
<p>$(s_1-s_2) \equiv k^{-1}(H(m_1)-H(m_2)) \mod q$</p>
<p>$k \equiv (s_1-s_2)^{-1}(H(m_1)-H(m_2)) \mod q$</p>
<p>求出$k$后</p>
<p>根据$s \equiv k^{-1}(H(m)+xr) \longrightarrow ks \equiv H(m)+xr \longrightarrow x\equiv (ks - H(m))r^{-1}\mod q$</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="长城杯-2022——known-phi（复用k）"><a href="#长城杯-2022——known-phi（复用k）" class="headerlink" title="长城杯 2022——known_phi（复用k）"></a>长城杯 2022——known_phi（复用k）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, inverse, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">a</span>):</span><br><span class="line">    p = getPrime(a) </span><br><span class="line">    q = getPrime(a)</span><br><span class="line">    r = getPrime(a)</span><br><span class="line">    x = getPrime(a)</span><br><span class="line">    n = p*q*r*x</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)*(x-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> n, phi, [p, q, r, x]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">m, k, x, p, q, g</span>):</span><br><span class="line">    hm = bytes_to_long(sha256(m).digest())</span><br><span class="line">    r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">    s = (hm + x*r) * inverse(k, q) % q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r,s</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">a = <span class="number">256</span></span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line"><span class="comment"># print(x)</span></span><br><span class="line"></span><br><span class="line">n, phi, n_factors = gen(a)</span><br><span class="line">n_factors = <span class="built_in">sorted</span>(n_factors)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;phi = <span class="subst">&#123;phi&#125;</span>&#x27;</span>)</span><br><span class="line">m1 = long_to_bytes(n_factors[<span class="number">0</span>] + n_factors[<span class="number">3</span>])</span><br><span class="line">m2 = long_to_bytes(n_factors[<span class="number">1</span>] + n_factors[<span class="number">2</span>])</span><br><span class="line"><span class="comment"># print(f&#x27;m1 = &#123;m1&#125;&#x27;)</span></span><br><span class="line"><span class="comment"># print(f&#x27;m2 = &#123;m2&#125;&#x27;)</span></span><br><span class="line"></span><br><span class="line">key = DSA.generate(<span class="built_in">int</span>(<span class="number">2048</span>))</span><br><span class="line">q = key.q</span><br><span class="line">p = key.p</span><br><span class="line">g = key.g</span><br><span class="line"><span class="keyword">assert</span> q &gt; x</span><br><span class="line">k = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">r1, s1 = sign(m1, k, x, p, q, g)</span><br><span class="line">r2, s2 = sign(m2, k, x, p, q, g)</span><br><span class="line"><span class="comment"># print(f&#x27;k = &#123;k&#125;&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;r1 = <span class="subst">&#123;r1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;s1 = <span class="subst">&#123;s1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;r2 = <span class="subst">&#123;r2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;s2 = <span class="subst">&#123;s2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 104228256293611313959676852310116852553951496121352860038971098657350022997841589403091722735802150153734050783858816709247647536393314564077002364012463220999962114186339228164032217361145009468516448617173972835797623658266515762201804936729547278758839604969469770650218191574897316410254695420895895051693</span></span><br><span class="line"><span class="string">phi = 104228256293611313959676852310116852553951496121352860038971098657350022997837434645707418205268240995284026522165519145773852565112344453740579163420312890001524537570675468046604347184376661743552799809753709321949095844960227307733389258381950812717245522599433727311919405966404418872873961877021696812800</span></span><br><span class="line"><span class="string">q = 24513014442114004234202354110477737650785387286781126308169912007819</span></span><br><span class="line"><span class="string">r1 = 8881880595434882344509893789458546908449907797285477983407324325035</span></span><br><span class="line"><span class="string">s1 = 764450933738974696530033347966845551587903750431946039815672438603</span></span><br><span class="line"><span class="string">r2 = 8881880595434882344509893789458546908449907797285477983407324325035</span></span><br><span class="line"><span class="string">s2 = 22099482232399385060035569388467035727015978742301259782677969649659</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>已知$n,phi$，网上找个脚本把n分解之后，可以得到$m_1,m_2$。</p>
<p>有了$m_1,m_2$即可求哈希后的值$h_1,h_2$</p>
<p>求得$k \equiv (s_1-s_2)^{-1}(h_1-h_2) \mod q$</p>
<p>最后求得$x\equiv (ks_1 - H_1)r_1^{-1}\mod q$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">phi = </span><br><span class="line">q = <span class="number">24513014442114004234202354110477737650785387286781126308169912007819</span></span><br><span class="line">r1 = <span class="number">8881880595434882344509893789458546908449907797285477983407324325035</span></span><br><span class="line">s1 = <span class="number">764450933738974696530033347966845551587903750431946039815672438603</span></span><br><span class="line">r2 = <span class="number">8881880595434882344509893789458546908449907797285477983407324325035</span></span><br><span class="line">s2 = <span class="number">22099482232399385060035569388467035727015978742301259782677969649659</span></span><br><span class="line"></span><br><span class="line">primes = <span class="built_in">sorted</span>(factorize_multi_prime(n,phi))</span><br><span class="line"></span><br><span class="line">m1 = long_to_bytes(primes[<span class="number">0</span>]+primes[<span class="number">3</span>])</span><br><span class="line">m2 = long_to_bytes(primes[<span class="number">1</span>]+primes[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">h1 = bytes_to_long(sha256(m1).digest())</span><br><span class="line">h2 = bytes_to_long(sha256(m2).digest())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k = gmpy2.invert((s1-s2),q)*(h1-h2) % q</span><br><span class="line">r_ = gmpy2.invert(r1,q)</span><br><span class="line"></span><br><span class="line">d = ((k * s1) - h1)*r_ % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(d)))</span><br></pre></td></tr></table></figure>

<h3 id="NSSRound-1-Basic——number-by-number（线性k）"><a href="#NSSRound-1-Basic——number-by-number（线性k）" class="headerlink" title="NSSRound#1 Basic——number_by_number（线性k）"></a>NSSRound#1 Basic——number_by_number（线性k）</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">FLAG = <span class="string">b&#x27;******************&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> FLAG.startswith(<span class="string">b&#x27;NSSCTF&#123;&#x27;</span>) <span class="keyword">and</span> FLAG.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">FLAG = FLAG[<span class="number">7</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg, pub, pri, k</span>):</span><br><span class="line">    (p,q,g,y) = pub</span><br><span class="line">    x = pri</span><br><span class="line">    r = <span class="built_in">int</span>(<span class="built_in">pow</span>(g, k, p) % q)</span><br><span class="line">    h = <span class="built_in">int</span>(hashlib.sha256(msg).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">    s = <span class="built_in">int</span>((h + x * r) * invert(k, q) % q)</span><br><span class="line">    <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">g = </span><br><span class="line">x = bytes_to_long(FLAG)</span><br><span class="line">y = powmod(g, x, p)</span><br><span class="line"></span><br><span class="line">pub = (p,q,g,y)</span><br><span class="line">pri = x</span><br><span class="line"></span><br><span class="line">nonce = getPrime(<span class="number">64</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;y =&#x27;</span>, y)</span><br><span class="line"><span class="built_in">print</span>(sign(<span class="string">b&#x27;nssctfround#1&#x27;</span>, pub, pri, nonce))</span><br><span class="line"><span class="built_in">print</span>(sign(<span class="string">b&#x27;nssctfround#1&#x27;</span>, pub, pri, <span class="number">12345</span>*nonce + <span class="number">67890</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">y = </span></span><br><span class="line"><span class="string">(r, s)</span></span><br><span class="line"><span class="string">(r, s)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>注意到两次加密的信息是一致的，不同的是$k$，而且有$k’ &#x3D; ak+b$，其中$a&#x3D;12345,b&#x3D;67890$</p>
<p>$\because r_1 \equiv (g^k \mod p) \mod q$，$s_1 \equiv k^{-1}(h + xr_1) \mod q$，$h$表示哈希后的<code>msg</code></p>
<p>又已知$r_2 \equiv (g^{k’} \mod p) \mod q$，即$r_2 \equiv (g^{ak+b} \mod p) \mod q$</p>
<p>$s_2 \equiv (ak+b)^{-1}(h+xr_2) \mod q$</p>
<p>由</p>
<p><img src="/../images/DSA/0.png"></p>
<p>得</p>
<p><img src="/../images/DSA/1.png"></p>
<p>①式乘$r_2$，②式乘$r_1$得</p>
<p><img src="/../images/DSA/2.png"></p>
<p>然后两式相减得到$k(r_2s_1-ar_1s_2) \equiv h(r_2-r_1)-br_1s_2 \mod q$</p>
<p>$\therefore k \equiv [h(r_2-r_1)+br_1s_2]×(r_2s_1-ar_1s_2)^{-1} \mod q$</p>
<p>$x\equiv (ks - h)r^{-1}\mod q$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">y = </span><br><span class="line">r1,s1 = (, )</span><br><span class="line">r2,s2 = (, )</span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">g = </span><br><span class="line">msg = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">h = <span class="built_in">int</span>(hashlib.sha256(msg).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line">k = ((h*(r2 - r1) + b*r1*s2)*gmpy2.invert((r2*s1-a*r1*s2),q)) % q</span><br><span class="line"></span><br><span class="line">m1 = (k*s1 - h)*gmpy2.invert(r1,q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line"></span><br><span class="line">k1 = a*k+b</span><br><span class="line"></span><br><span class="line">m2 = (k1*s2 - h)*gmpy2.invert(r2,q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m2))</span><br></pre></td></tr></table></figure>



<h1 id="HZNUCTF-2023-preliminary-easyDSA"><a href="#HZNUCTF-2023-preliminary-easyDSA" class="headerlink" title="[HZNUCTF 2023 preliminary]easyDSA"></a>[HZNUCTF 2023 preliminary]easyDSA</h1><p>task.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="built_in">hash</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dsa</span>(<span class="params">hmac, _pk, _sk, k</span>):</span><br><span class="line">    _p, _q, _g, _y = _pk</span><br><span class="line">    x = _sk</span><br><span class="line">    r = <span class="built_in">pow</span>(_g, k, _p) % _q</span><br><span class="line">    s = ((hmac + x * r) * invert(k, _q)) % _q</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(r), <span class="built_in">int</span>(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>(flag.<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">g = getRandomNBitInteger(<span class="number">2048</span>)</span><br><span class="line">y = <span class="built_in">pow</span>(g, m, p)</span><br><span class="line">pk = (p, q, g, y)</span><br><span class="line">sk = m</span><br><span class="line">hm1 = <span class="built_in">int</span>(SM3(default_hm1), <span class="number">16</span>)</span><br><span class="line">hm2 = <span class="built_in">int</span>(SM3(default_hm2), <span class="number">16</span>)</span><br><span class="line">nonce = getPrime(<span class="number">64</span>)</span><br><span class="line">xxxx = getPrime(<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;(r1, s1) = <span class="subst">&#123;dsa(hm1, pk, sk, nonce)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;(r2, s2) = <span class="subst">&#123;dsa(hm1, pk, sk, nonce ** <span class="number">2</span> + xxxx)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>\nq = <span class="subst">&#123;q&#125;</span>\ng = <span class="subst">&#123;g&#125;</span>\ny = <span class="subst">&#123;y&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># (r1, s1) = (, )</span></span><br><span class="line"><span class="comment"># (r2, s2) = (, )</span></span><br><span class="line"><span class="comment"># p = </span></span><br><span class="line"><span class="comment"># q = 69375998045163628324086568160767337544901252262545889505892695427466730978301</span></span><br><span class="line"><span class="comment"># g = </span></span><br><span class="line"><span class="comment"># y = </span></span><br></pre></td></tr></table></figure>

<p>hash.py</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">IV = <span class="number">0x7380166f4914b2b9172442d7da8a0600a96f30bc163138aae38dee4db0fb0e4e</span></span><br><span class="line">default_hm1 = <span class="string">b&#x27;HZNUCTFRound#1&#x27;</span></span><br><span class="line">default_hm2 = <span class="string">b&#x27;HZNUCTFRound#1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_k</span>(<span class="params">l</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>):</span><br><span class="line">        <span class="keyword">if</span> (l + <span class="number">1</span> + i - <span class="number">448</span>) % <span class="number">512</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">msg</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(msg)</span><br><span class="line">    k = solve_k(l)</span><br><span class="line">    l64 = <span class="built_in">bin</span>(l)[<span class="number">2</span>:].rjust(<span class="number">64</span>, <span class="string">&#x27;0&#x27;</span>)  <span class="comment"># what if msg is too long, how?</span></span><br><span class="line">    <span class="comment"># so mention the condition in guideline of Algorithm</span></span><br><span class="line">    msg = msg + <span class="string">&#x27;1&#x27;</span> + <span class="string">&#x27;0&#x27;</span> * k + l64</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(msg) % <span class="number">512</span> == <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> msg, l, k</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iteration</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ring_shift_left</span>(<span class="params">x, num</span>):</span><br><span class="line">    x = <span class="built_in">bin</span>(x)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)               <span class="comment"># shift in 32 bit, take care of it</span></span><br><span class="line">    x = <span class="built_in">int</span>(x[num:] + x[:num], <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p0</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ^ ring_shift_left(x, <span class="number">9</span>) ^ ring_shift_left(x, <span class="number">17</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p1</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x ^ ring_shift_left(x, <span class="number">15</span>) ^ ring_shift_left(x, <span class="number">23</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extending</span>(<span class="params">msg</span>):</span><br><span class="line">    WW = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg) // <span class="number">512</span>):</span><br><span class="line">        W = [<span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">132</span>)]</span><br><span class="line">        msgi = msg[i * <span class="number">512</span>:(i + <span class="number">1</span>) * <span class="number">512</span>]</span><br><span class="line">        <span class="comment"># 512 ====&gt; 16 * 32</span></span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msgi) // <span class="number">32</span>):</span><br><span class="line">            W[ii] = msgi[ii * <span class="number">32</span>:(ii + <span class="number">1</span>) * <span class="number">32</span>]</span><br><span class="line">            <span class="keyword">assert</span> <span class="built_in">len</span>(W[ii]) == <span class="number">32</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">68</span>):</span><br><span class="line">            <span class="comment"># how to xor word, change to number or bytes?</span></span><br><span class="line">            <span class="comment"># number, of course</span></span><br><span class="line">            W[j] = p1(<span class="built_in">int</span>(W[j - <span class="number">16</span>], <span class="number">2</span>) ^ <span class="built_in">int</span>(W[j - <span class="number">9</span>], <span class="number">2</span>) ^ ring_shift_left(<span class="built_in">int</span>(W[j - <span class="number">3</span>], <span class="number">2</span>), <span class="number">15</span>)) ^ \</span><br><span class="line">                   ring_shift_left(<span class="built_in">int</span>(W[j - <span class="number">13</span>], <span class="number">2</span>), <span class="number">7</span>) ^ <span class="built_in">int</span>(W[j - <span class="number">6</span>], <span class="number">2</span>)</span><br><span class="line">            W[j] = <span class="built_in">bin</span>(W[j])[<span class="number">2</span>:]</span><br><span class="line">            W[j] = W[j].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">68</span>, <span class="number">132</span>):</span><br><span class="line">            W[j] = <span class="built_in">int</span>(W[j - <span class="number">68</span>], <span class="number">2</span>) ^ <span class="built_in">int</span>(W[j - <span class="number">68</span> + <span class="number">4</span>], <span class="number">2</span>)</span><br><span class="line">            W[j] = <span class="built_in">bin</span>(W[j])[<span class="number">2</span>:]</span><br><span class="line">            W[j] = W[j].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        WW.append(W)</span><br><span class="line">    <span class="keyword">return</span> WW</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cons</span>(<span class="params">j</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0x79cc4519</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="number">16</span> &lt;= j &lt;= <span class="number">63</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0x7a879d8a</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bool_ff</span>(<span class="params">param, j</span>):</span><br><span class="line">    x, y, z = param</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">16</span> &lt;= j &lt;= <span class="number">63</span>:</span><br><span class="line">        <span class="keyword">return</span> (x &amp; y) | (x &amp; z) | (y &amp; z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bool_gg</span>(<span class="params">param, j</span>):</span><br><span class="line">    x, y, z = param</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span> &lt;= j &lt;= <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line">    <span class="keyword">elif</span> <span class="number">16</span> &lt;= j &lt;= <span class="number">63</span>:                <span class="comment"># take care of not</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]) &lt; <span class="number">32</span>:</span><br><span class="line">            ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            x = <span class="built_in">bin</span>(x)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            y = <span class="built_in">bin</span>(y)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            z = <span class="built_in">bin</span>(z)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">32</span>):</span><br><span class="line">                <span class="keyword">if</span> x[i] == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                    ans += <span class="built_in">str</span>((<span class="built_in">int</span>(x[i], <span class="number">2</span>) &amp; <span class="built_in">int</span>(y[i], <span class="number">2</span>)) | (<span class="number">1</span> &amp; <span class="built_in">int</span>(z[i], <span class="number">2</span>)))</span><br><span class="line">                <span class="keyword">elif</span> x[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                    ans += <span class="built_in">str</span>((<span class="built_in">int</span>(x[i], <span class="number">2</span>) &amp; <span class="built_in">int</span>(y[i], <span class="number">2</span>)) | (<span class="number">0</span> &amp; <span class="built_in">int</span>(z[i], <span class="number">2</span>)))</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">int</span>(ans, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(x)[<span class="number">2</span>:]) == <span class="number">32</span>:</span><br><span class="line">            <span class="keyword">return</span> (x &amp; y) | (~x &amp; z)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cf</span>(<span class="params">v, w</span>):</span><br><span class="line">    W, W_ = w[:<span class="number">68</span>], w[<span class="number">68</span>:]</span><br><span class="line">    <span class="comment"># for i in W:</span></span><br><span class="line">    <span class="comment">#     print(hex(int(i, 2)), end=&#x27; &#x27;)</span></span><br><span class="line">    <span class="comment"># for i in W_:</span></span><br><span class="line">    <span class="comment">#     print(hex(int(i, 2)), end=&#x27; &#x27;)</span></span><br><span class="line">    <span class="comment"># print()</span></span><br><span class="line">    v = <span class="built_in">bin</span>(v)[<span class="number">2</span>:].rjust(<span class="number">256</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    A, B, C, D, E, F, G, H = [v[_ * <span class="number">32</span>:(_ + <span class="number">1</span>) * <span class="number">32</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span> // <span class="number">32</span>)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        <span class="comment"># be care of plus, it may surpass 32 bits</span></span><br><span class="line">        <span class="comment"># remember j mod 32, or output will be wrong</span></span><br><span class="line">        tmp = (ring_shift_left(<span class="built_in">int</span>(A, <span class="number">2</span>), <span class="number">12</span>) + <span class="built_in">int</span>(E, <span class="number">2</span>) + ring_shift_left(cons(j), j % <span class="number">32</span>)) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        SS1 = ring_shift_left(tmp, <span class="number">7</span>)</span><br><span class="line">        SS1 = <span class="built_in">bin</span>(SS1)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        SS2 = <span class="built_in">int</span>(SS1, <span class="number">2</span>) ^ ring_shift_left(<span class="built_in">int</span>(A, <span class="number">2</span>), <span class="number">12</span>)</span><br><span class="line">        SS2 = <span class="built_in">bin</span>(SS2)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        tmp = (bool_ff([<span class="built_in">int</span>(A, <span class="number">2</span>), <span class="built_in">int</span>(B, <span class="number">2</span>), <span class="built_in">int</span>(C, <span class="number">2</span>)], j) + <span class="built_in">int</span>(D, <span class="number">2</span>) + <span class="built_in">int</span>(SS2, <span class="number">2</span>) + <span class="built_in">int</span>(W_[j], <span class="number">2</span>)) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        TT1 = <span class="built_in">bin</span>(tmp)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        tmp = (bool_gg([<span class="built_in">int</span>(E, <span class="number">2</span>), <span class="built_in">int</span>(F, <span class="number">2</span>), <span class="built_in">int</span>(G, <span class="number">2</span>)], j) + <span class="built_in">int</span>(H, <span class="number">2</span>) + <span class="built_in">int</span>(SS1, <span class="number">2</span>) + <span class="built_in">int</span>(W[j], <span class="number">2</span>)) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        TT2 = <span class="built_in">bin</span>(tmp)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        D = C.rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        C = ring_shift_left(<span class="built_in">int</span>(B, <span class="number">2</span>), <span class="number">9</span>)</span><br><span class="line">        C = <span class="built_in">bin</span>(C)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        B = A.rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        A = TT1.rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        H = G.rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        G = ring_shift_left(<span class="built_in">int</span>(F, <span class="number">2</span>), <span class="number">19</span>)</span><br><span class="line">        G = <span class="built_in">bin</span>(G)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        F = E.rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        E = p0(<span class="built_in">int</span>(TT2, <span class="number">2</span>))</span><br><span class="line">        E = <span class="built_in">bin</span>(E)[<span class="number">2</span>:].rjust(<span class="number">32</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># print(j, end=&#x27; &#x27;)</span></span><br><span class="line">        <span class="comment"># for i in [A, B, C, D, E, F, G, H]:</span></span><br><span class="line">        <span class="comment">#     print(hex(int(i, 2)), end=&#x27; &#x27;)</span></span><br><span class="line">        <span class="comment"># print()</span></span><br><span class="line">    ans = A + B + C + D + E + F + G + H</span><br><span class="line">    ans = <span class="built_in">int</span>(ans, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SM3</span>(<span class="params">msg</span>):</span><br><span class="line">    msg = bytes_to_long(msg)</span><br><span class="line">    <span class="keyword">if</span> msg.bit_length() % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        msg = (<span class="number">4</span> - (msg.bit_length() % <span class="number">4</span>)) * <span class="string">&#x27;0&#x27;</span> + <span class="built_in">bin</span>(msg)[<span class="number">2</span>:]</span><br><span class="line">    msg, l, k = padding(msg)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># extend</span></span><br><span class="line">    W = extending(msg)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># iteration</span></span><br><span class="line">    vi = IV</span><br><span class="line">    n = (l + k + <span class="number">65</span>) // <span class="number">512</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        res = cf(vi, W[i])</span><br><span class="line">        vi = vi ^ res</span><br><span class="line"></span><br><span class="line">    <span class="comment"># compress</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hex</span>(vi)[<span class="number">2</span>:]</span><br></pre></td></tr></table></figure>

<p>hash这个文件很长，主要就是算<code>SM3</code>，不要畏难</p>
<h3 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h3><p>加密的明文是一样的，用$h$表示</p>
<p>$k_2 &#x3D; k_1^2 + b$</p>
<p>$r_1 \equiv (g^k \mod p) \mod q$，$s_1 \equiv k_1^{-1}(h+xr_1) \mod q$</p>
<p>$r_2 \equiv (g^{k_1^2+b} \mod p) \mod q$，$s_2 \equiv (k_1^2+b)^{-1}(h+xr_2)\mod q$</p>
<p>$\therefore s_1k_1 \equiv h+xr_1 \mod q$</p>
<p>$s_2(k_1^2+b)\equiv h+xr_2 \mod q$</p>
<p>所以</p>
<p>$s_1r_2k_1 \equiv hr_2 + xr_1r_2 \mod q$</p>
<p>$r_1s_2(k_1^2+b) \equiv hr_1 + xr_1r_2 \mod q$</p>
<p>$(k_1^2-k_1+b)(s_2r_1 - s_1r_2) \equiv h(r_1-r_2) \mod q$</p>
<p>两个未知量</p>
<p>换个推导</p>
<p>由$\therefore s_1k_1 \equiv h+xr_1 \mod q$和$s_2(k_1^2+b)\equiv h+xr_2 \mod q$得<br>$$<br>x \equiv (s_1k_1 -h)r_1^{-1} \mod q\<br>x \equiv (s_2(k_1^2+b)-h)r_2^{-1} \mod q<br>$$<br>通过$f(x) &#x3D; (s_2(k_1^2+\color{red}x\color{black})-h)r_2^{-1} - (s_1k_1-h)r_1^{-1} \mod q$</p>
<p>先求出<code>h=19905280947443115569469777697852124038269468456842113763109865796452965095134</code></p>
<p>二元copper求出$k_1,x$，即可求解</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">(r1, s1) = (<span class="number">43665657147136977892760835332544097729763754398125679419859037123212964274095</span>, <span class="number">11372107439153704547599978617809027960018057676066118055075660375442954789009</span>)</span><br><span class="line">(r2, s2) = (<span class="number">29184887007213204285288676779168140587575609668559831035949650649308618592275</span>, <span class="number">5011738292572181542092375902756977363590922060964162373234404450451520414798</span>)</span><br><span class="line">p = <span class="number">31961141251107494919420190534228520246958409864267239760354623819192809291490262139213317490432416411403367763443527530375117617196123131270496004125231254335150221348901335274505489844222882171272650010562960614279185073793274638651086760235178963210965828168433516820007716846876686795459738332444629111764967204355463398049697867061034126529189537688874999118692225915790053920062142349951686250122300061810240375783724631961234942175580462986265098353263395579346466921241016500821787793395554444982717141449909744838267161237273856377774256250949274635575801148994817767751541256849860886577256992383324866941911</span></span><br><span class="line">q = <span class="number">69375998045163628324086568160767337544901252262545889505892695427466730978301</span></span><br><span class="line">g = <span class="number">23095306638137759877487469277470910487928442296144598697677211337473146684728707820084075779044942034329888686699655576145455963231144004571165817481066424910959951439014314776050521403558035997997820617824839889597136772108383034876458141163933312284054415480674388788905935457149956424898637134087874179010376667509489926236214865373552518669840236207944772752416668193786003948717604980584661094548997197117467440864460714843246250800575997370964173558788145639802963655916833143883799542309432910222224223561677245110195809587171802538978009246887077924173034608600837785506594525481696000424121705524449481831586</span></span><br><span class="line">y = <span class="number">30195133393879069638917191223585579396119430591488890396938821804398771785068454607425044458865556053274470709839502680269466948174813926392729790863065933078609827279352860810689776644132512095691760326095517755483748554008211568781998662554432781285208646921699265866446498342049913829592480268053599307065979016922204438675164034767731708343084371572648019835171087671868322447023378942812010740490724160077164191297435291229504616686997442254543493394641023587237077429236872101951650325361004443988267286616139798736713430746804524113024341440435623834197278500144543476528466395780355874841379098027115073850819</span></span><br><span class="line">h = <span class="number">19905280947443115569469777697852124038269468456842113763109865796452965095134</span></span><br><span class="line"></span><br><span class="line">R.&lt;k,x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">f = (s2*(k^<span class="number">2</span>+x)-h)*<span class="built_in">int</span>(gmpy2.invert(r2,q)) - (s1*k-h)*<span class="built_in">int</span>(gmpy2.invert(r1,q))</span><br><span class="line">roots = small_roots(f,(<span class="number">2</span>^<span class="number">64</span>,<span class="number">2</span>^<span class="number">20</span>),m=<span class="number">1</span>,d=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"></span><br><span class="line">k,b = roots[<span class="number">0</span>]</span><br><span class="line">m = (s1*k-h)*gmpy2.invert(r1,q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>







<h1 id="ECDSA"><a href="#ECDSA" class="headerlink" title="ECDSA"></a>ECDSA</h1><h2 id="签名过程-1"><a href="#签名过程-1" class="headerlink" title="签名过程"></a>签名过程</h2><ol>
<li>首先选择一条椭圆曲线$E_p(a,b)$，和基点$G$</li>
<li>选择私钥$d,(d&lt;n)$，$n$是基点$G$的阶</li>
<li>利用基点计算公钥$Q &#x3D; dG$，$Q$表示为$(Q_X,Q_Y$并公开$Q$</li>
<li>选择一个随机数$k,(k&lt;n)$，计算$R &#x3D; kG$，$R$表示为$(R_X,R_Y)$</li>
<li>计算$r \equiv R_X \mod n$，如果$r &#x3D; 0$，则选取另一个$k$并重新计算</li>
<li>计算明文$m$的哈希值，记为$H &#x3D; hash(m)$</li>
<li>计算$s \equiv k^{-1}(H+rd)\mod n$</li>
<li>如果$s&#x3D;0$，则选取另外一个$k$并重新计算</li>
<li>输出签名$(r,s)$</li>
</ol>
<h2 id="验证过程-1"><a href="#验证过程-1" class="headerlink" title="验证过程"></a>验证过程</h2><ol>
<li>计算整数$u_1 &#x3D; s^{-1}×H \mod n$</li>
<li>计算整数$u_2 &#x3D;s^{-1}×r \mod n$</li>
<li>计算点$R &#x3D; u_1G+u_2Q \mod n$</li>
</ol>
<p>证明验证过程的正确性</p>
<p>$\because R &#x3D; u_1G + u_2Q \mod n \longrightarrow R &#x3D; u_1G+u_2dG &#x3D; (u_1+u_2d) \mod n$</p>
<p>把$u_1,u_2$替换掉</p>
<p>$\therefore R &#x3D; (s^{-1}H+s^{-1}rd)G \mod n$</p>
<p>$\therefore R &#x3D; s^{-1}(H+rd)G \mod n$</p>
<p>结合$s \equiv k ^{-1}(H+rd) \mod n$，我们能得到$s^{-1} \equiv k(H+rd)^{-1} \mod n$</p>
<p>则$R &#x3D; k(H+rd)^{-1}×(H+rd) \mod n &#x3D; kG$</p>
<p>与签名过程的$R&#x3D;kG$一致</p>
<h2 id="攻击-1"><a href="#攻击-1" class="headerlink" title="攻击"></a>攻击</h2><p>如果使用同一个k，危险性很大，在此情况下，很容易反推出$d$</p>
<p>我们需要两个哈希值$H_1,H_2$，两组签名$(r_1,s_1),(r_2,s_2)$，还有椭圆曲线的参数</p>
<p>因为$R \equiv kG$，$r &#x3D; R_x \mod n$，如果$k$一样，则$r_1 &#x3D; r_2$</p>
<p>$\because s \equiv k^{-1}(H+rd)$，$\therefore (s_1-s_2) \equiv k^{-1}(H_1-H_2) \mod n$</p>
<p>两边同乘$k$得$k(s_1-s_2) \equiv H_1-H_2 \mod n$</p>
<p>$\therefore k \equiv (s_1-s_2)^{-1}(H_1-H_2) \mod n$</p>
<p>求出k之后，根据$s \equiv k^{-1}(H+rd) \longrightarrow ks \equiv H+rd \longrightarrow d \equiv (ks - H)r^{-1}\mod n$</p>
<p>例题</p>
]]></content>
      <tags>
        <tag>签名</tag>
      </tags>
  </entry>
  <entry>
    <title>DES</title>
    <url>/2023/08/24/DES/</url>
    <content><![CDATA[<p>DES算法学习</p>
<p>找人借了CSDN的vip看了这篇文章，赶紧记下来</p>
<span id="more"></span>

<h1 id="所需参数"><a href="#所需参数" class="headerlink" title="所需参数"></a>所需参数</h1><ol>
<li>key:8个字节共64位的工作密钥</li>
<li>data:8字节共64位的（密文或明文）数据</li>
<li>mode:DES工作模式，加密或解密</li>
</ol>
<h1 id="加密流程"><a href="#加密流程" class="headerlink" title="加密流程"></a>加密流程</h1><p>DES 加密算法大致分为 4 个步骤：</p>
<ol>
<li>初始置换</li>
<li>生成子秘钥</li>
<li>迭代过程</li>
<li>逆置换</li>
</ol>
<h2 id="一、初始置换"><a href="#一、初始置换" class="headerlink" title="一、初始置换"></a>一、初始置换</h2><p>初始置换规则如下</p>
<p><img src="/../images/DES/3.png"></p>
<p>IP置换表：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,</span><br><span class="line"><span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,</span><br><span class="line"><span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>, <span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,</span><br><span class="line"><span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,</span><br><span class="line"><span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,</span><br></pre></td></tr></table></figure>

<p><strong>这里数字表示的是数据所在位置，而不是数据的值</strong></p>
<p>就是将输入的64位明文的第1位置换到第40位，第2位置换到第8位，第3位置换到第48位。以此类推，最后一位是原来的第7位。</p>
<p>例如：</p>
<p>输入64位明文数据M（64位）：<br><strong>明文M（64位）</strong>&#x3D;<br>0110001101101111011011010111000001110101011101000110010101110010<br>选取密钥K（64位）：<br><strong>密钥K（64位）</strong>&#x3D;<br>0001001100110100010101110111100110011011101111001101111111110001</p>
<p><strong>M经过IP置换后为M’</strong></p>
<p><strong>M’（64位）</strong> &#x3D;<br>1111111110111000011101100101011100000000111111110000011010000011<br>取M’的前32位作为$L_0$，则有<br>$L_0$<strong>（32位）</strong>&#x3D; 11111111101110000111011001010111<br>取M’的后32位作为$R_0$，则有<br>$R_0$<strong>（32位）</strong>&#x3D; 00000000111111110000011010000011</p>
<p>经过初始置换后，进行16轮完全相同的运算，在运算过程中数据与秘钥结合。</p>
<p>函数<strong>f</strong>（$f(n) &#x3D; R_n \otimes key_n$）的输出经过一个异或运算，和左半部分结合形成新的右半部分，原来的右半部分成为新的左半部分</p>
<p>即$L_n &#x3D; R_{n-1}$，$R_n &#x3D; L_{n-1} \otimes f(R_n-1,key_{n-1})$</p>
<p>$key_n$是向第N层输入的48位的秘钥，f的输出32位</p>
<h2 id="二、生成子秘钥"><a href="#二、生成子秘钥" class="headerlink" title="二、生成子秘钥"></a>二、生成子秘钥</h2><p>$\color{red}操作对象是64位秘钥$</p>
<p>DES 加密共执行16次迭代，每次迭代过程的数据长度为48位，因此需要16个48位的子密钥来进行加密，生成子密钥的过程如下：</p>
<h3 id="秘钥置换选择1——PC-1"><a href="#秘钥置换选择1——PC-1" class="headerlink" title="秘钥置换选择1——PC-1"></a>秘钥置换选择1——PC-1</h3><p>64位秘钥经过秘钥置换选择1降至56位秘钥，其过程不是简单地将每个字节的第八位删除，而是<strong>通过缩小选择置换选择表1的变换变成56位。</strong></p>
<p><strong>置换选择表1（PC-1）如下：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,</span><br><span class="line"><span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,</span><br><span class="line"><span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,</span><br><span class="line"><span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,</span><br><span class="line"><span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>再将秘钥分为$C_0,D_0$：</p>
<p>$C_0 &#x3D; key_{57}，key_{49},…,key_{36}$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,</span><br><span class="line"><span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,</span><br><span class="line"><span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,</span><br></pre></td></tr></table></figure>

<p>$D_0 &#x3D; key_{63},key_{55},…,key_4$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,</span><br><span class="line"><span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,</span><br><span class="line"><span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span></span><br></pre></td></tr></table></figure>

<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>例如：</p>
<p><strong>密钥 K &#x3D; 0001001100110100010101110111100110011011101111001101111111110001经过PC-1表置换</strong></p>
<p>变为<strong>K’（56位）</strong>&#x3D; 11110000110011001010101011110101010101100110011110001111<br>取K’的前28位作为$C_0$，则有<br>$C_0$<strong>（28位）</strong>&#x3D; 1111000011001100101010101111<br>取K’的后28位作为$D_0$，则有<br>$D_0$<strong>（28位）</strong>&#x3D; 0101010101100110011110001111</p>
<p>获得$C_0,D_0$后查询移动位数表进行左移操作：</p>
<p><strong>循环左移每轮移动的位数如下：</strong></p>
<p><img src="/../images/DES/0.png"></p>
<p>第一轮是循环左移1位。$C_0$循环左移1位后得到$C_1$如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,		---&gt;	<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,				<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,</span><br><span class="line"><span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,				<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,</span><br><span class="line"><span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,				<span class="number">11</span>,<span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">57</span></span><br></pre></td></tr></table></figure>

<p>$D_0$循环左移1位后得到$D_1$如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,		---&gt;	<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,				<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,</span><br><span class="line"><span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,				<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,</span><br><span class="line"><span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>					<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">63</span></span><br></pre></td></tr></table></figure>

<p>$C_1$和$D_1$合并之后，再经过<strong>置换选择表2</strong>生成48位的子秘钥$key_1$。</p>
<h3 id="置换选择2——PC-2"><a href="#置换选择2——PC-2" class="headerlink" title="置换选择2——PC-2"></a>置换选择2——PC-2</h3><p>**置换选择表2(PC-2)**如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,</span><br><span class="line"><span class="number">3</span>,<span class="number">28</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,</span><br><span class="line"><span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">26</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,</span><br><span class="line"><span class="number">30</span>,<span class="number">40</span>,<span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,</span><br><span class="line"><span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,<span class="number">34</span>,<span class="number">53</span>,</span><br><span class="line"><span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span></span><br></pre></td></tr></table></figure>

<p>去掉第9、18、22、25、35、38、43、54位，秘钥从56位变成48位.。</p>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><p>例如：</p>
<p><strong>上述$C_0,D_0$经变换得到子秘钥$key_1$过程如下：</strong></p>
<p>$C_0$<strong>（28位）</strong>&#x3D; 1111000011001100101010101111</p>
<p>$D_0$<strong>（28位）</strong>&#x3D; 0101010101100110011110001111</p>
<p>进行第一轮移位，轮数为1，查表得左移位数为1。</p>
<p>$C_0$左移1位为$C_1$：<br>$C_1$<strong>（28位）</strong> &#x3D; 1110000110011001010101011111<br>$D_0$左移1位为$D_1$：<br>$D_1$<strong>（28位）</strong> &#x3D; 1010101011001100111100011110</p>
<p>将$C_1$和$D_1$合并后，经过PC-2表置换得到子密钥$key_1$</p>
<p>$key_1$<strong>（48位）</strong>&#x3D; 000110110000001011101111111111000111000001110010</p>
<p><strong>———————————-第一轮生成子秘钥就完成了————————————-</strong></p>
<p>$C_1$和$D_1$再次经过循环左移变换，生成$C_2$和$D_2$，$C_2$和$D_2$合并后为56位，通过PC-2得到子秘钥$key_2$。</p>
<p>以此类推，得到子秘钥$key_1—key_{16}$。需要注意其中循环左移的位数。</p>
<p>过程如下</p>
<p>$C_2$<strong>（28位）</strong>&#x3D; 1100001100110010101010111111<br>$D_2$<strong>（28位）</strong>&#x3D; 0101010110011001111000111101<br>$key_2$<strong>（48位）</strong>&#x3D; 011110011010111011011001110110111100100111100101</p>
<p>$C_3$（28位） &#x3D; 0000110011001010101011111111<br>$D_3$（28位） &#x3D; 0101011001100111100011110101<br>$key_3$（48位） &#x3D; 010101011111110010001010010000101100111110011001</p>
<p>$C_4$（28位） &#x3D; 0011001100101010101111111100<br>$D_4$（28位） &#x3D; 0101100110011110001111010101<br>$key_4$（48位） &#x3D; 011100101010110111010110110110110011010100011101</p>
<p>$C_5$（28位） &#x3D; 1100110010101010111111110000<br>$D_5$（28位） &#x3D; 0110011001111000111101010101<br>$key_5$（48位） &#x3D; 011111001110110000000111111010110101001110101000</p>
<p>$C_6$（28位） &#x3D; 0011001010101011111111000011<br>$D_6$（28位） &#x3D; 1001100111100011110101010101<br>$key_6$（48位） &#x3D; 011000111010010100111110010100000111101100101111</p>
<p>$C_7$（28位） &#x3D; 1100101010101111111100001100<br>$D_7$（28位） &#x3D; 0110011110001111010101010110<br>$key_7$（48位） &#x3D; 111011001000010010110111111101100001100010111100</p>
<p>$C_8$（28位） &#x3D; 0010101010111111110000110011<br>$D_8$（28位） &#x3D; 1001111000111101010101011001<br>$key_8$（48位） &#x3D; 111101111000101000111010110000010011101111111011</p>
<p>$C_9$（28位） &#x3D; 0101010101111111100001100110<br>$D_9$（28位） &#x3D; 0011110001111010101010110011<br>$key_9$（48位） &#x3D; 111000001101101111101011111011011110011110000001</p>
<p>$C_{10}$（28位） &#x3D; 0101010111111110000110011001<br>$D_{10}$（28位） &#x3D; 1111000111101010101011001100<br>$key_{10}$（48位） &#x3D; 101100011111001101000111101110100100011001001111</p>
<p>$C_{11}$（28位） &#x3D; 0101011111111000011001100101<br>$D_{11}$（28位） &#x3D; 1100011110101010101100110011<br>$key_{11}$（48位） &#x3D; 001000010101111111010011110111101101001110000110</p>
<p>$C_{12}$（28位） &#x3D; 0101111111100001100110010101<br>$D_{12}$（28位） &#x3D; 0001111010101010110011001111<br>$key_{12}$（48位） &#x3D; 011101010111000111110101100101000110011111101001</p>
<p>$C_{13}$（28位） &#x3D; 0111111110000110011001010101<br>$D_{13}$（28位） &#x3D; 0111101010101011001100111100<br>$key_{13}$（48位） &#x3D; 100101111100010111010001111110101011101001000001</p>
<p>$C_{14}$（28位） &#x3D; 1111111000011001100101010101<br>$D_{14}$（28位） &#x3D; 1110101010101100110011110001<br>$key_{14}$（48位） &#x3D; 010111110100001110110111111100101110011100111010</p>
<p>$C_{15}$（28位） &#x3D; 1111100001100110010101010111<br>$D_{15}$（28位） &#x3D; 1010101010110011001111000111<br>$key_{15}$（48位） &#x3D; 101111111001000110001101001111010011111100001010</p>
<p>$C_{16}$（28位） &#x3D; 1111000011001100101010101111<br>$D_{16}$（28位） &#x3D; 0101010101100110011110001111<br>$key_{16}$（48位） &#x3D; 110010110011110110001011000011100001011111110101</p>
<h2 id="三、迭代过程"><a href="#三、迭代过程" class="headerlink" title="三、迭代过程"></a>三、迭代过程</h2><p>设$L_i$（32位）和$R_i$（32位）为第<strong>i</strong>次迭代结果的左半部分与右半部分，子密钥$key_i$为第<strong>i</strong>轮的48位加密密钥。定义运算规则：</p>
<p>$L_i &#x3D; R_{i-1}$</p>
<p>$R_i &#x3D; L_i \otimes f(R_{i-1},key_i)$</p>
<p><img src="/../images/DES/4.png"></p>
<h3 id="扩展置换E（E位选择表）"><a href="#扩展置换E（E位选择表）" class="headerlink" title="扩展置换E（E位选择表）"></a>扩展置换E（E位选择表）</h3><p>通过扩展置换E，数据的右半部分$R_n$从32位扩展到48位。扩展置换改变了位的次序，重复了某些位。</p>
<p>扩展置换的目的：</p>
<ol>
<li>产生与秘钥相同长度的数据以进行异或运算，$R_0$是32位，子秘钥是48位，所以$R_0$要先进行扩展置换之后与子秘钥进行异或运算；</li>
<li>提供更长的结果，使得在替代运算时能够进行压缩。</li>
</ol>
<p>扩展置换E规则如下：</p>
<p><img src="/../images/DES/1.png"></p>
<h4 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h4><p>例如：</p>
<p>$L_0$（32位）&#x3D; 11111111101110000111011001010111</p>
<p>$R_0$（32位）&#x3D; 00000000111111110000011010000011</p>
<p>$R_0$经过扩展置换后变为48位数据：</p>
<p>$E(R_0)$ &#x3D; 100000000001011111111110100000001101010000000110</p>
<p>将$E(R_0)$（48位）与$key_1$（48位）作异或运算</p>
<p>​			<strong>100000000001011111111110100000001101010000000110</strong><br>​    ^    <strong>000110110000001011101111111111000111000001110010</strong><br>​	 &#x3D;    100110110001010100010001011111001010010001110100</p>
<p>即$E(R_0)\otimes key_1 $&#x3D; 100110110001010100010001011111001010010001110100</p>
<h3 id="S-盒代替（功能表S盒）"><a href="#S-盒代替（功能表S盒）" class="headerlink" title="S-盒代替（功能表S盒）"></a>S-盒代替（功能表S盒）</h3><p>把$R_n$扩展置换之后（48位）与子秘钥$key_n$（48位）异或以后的结果作为输入块进行S盒代替运算，<br>其功能是把48位数据变为32位数据。</p>
<p><strong>代替运算由8个不同的代替盒(S盒)完成。每个S-盒有6位输入，4位输出。</strong></p>
<p><strong>所以48位的输入块被分成8个6位的分组，每一个分组对应一个S-盒代替操作。</strong></p>
<p><strong>经过S-盒代替，形成8个4位分组结果。</strong></p>
<p><strong>注意：每一个S-盒的输入数据是64位，输出数据是4位，但是每个S-盒自身是64位！！</strong></p>
<p>每个S-和是4行16列的格式，因为二进制4位是0~15。</p>
<p>8个S-盒的值如下：</p>
<p>S-盒1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,</span><br><span class="line"><span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒2</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>,</span><br><span class="line"><span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>,</span><br><span class="line"><span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>,</span><br><span class="line"><span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒3</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒4</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>,</span><br><span class="line"><span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>,</span><br><span class="line"><span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,</span><br><span class="line"><span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒5</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,</span><br><span class="line"><span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>,</span><br><span class="line"><span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>,</span><br><span class="line"><span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒6</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,</span><br><span class="line"><span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>,</span><br><span class="line"><span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒7</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>,</span><br><span class="line"><span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>,</span><br></pre></td></tr></table></figure>

<p>S-盒8</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>,</span><br><span class="line"><span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>,</span><br><span class="line"><span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,</span><br><span class="line"><span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,</span><br></pre></td></tr></table></figure>

<h4 id="S-盒计算示例"><a href="#S-盒计算示例" class="headerlink" title="S-盒计算示例"></a>S-盒计算示例</h4><p>以S-盒8为例讲解</p>
<p><img src="/../images/DES/2.png"></p>
<p>假设S-盒8的输入为<strong>110011</strong>，因为对48位的数据做了6位6位的分组，这是最后一组。(即异或函数的第43~48位)为<strong>110011</strong>。</p>
<p><strong>110011</strong>的第一位和最后一位拼接形成了<strong>11</strong>，对应S-盒8的第3行（<strong>二进制下的11对应十进制的3</strong>）</p>
<p><strong>110011</strong>中间的4位拼接形成<strong>1001</strong>，对应S-盒8的第9列（<strong>二进制下的1001对应十进制的9</strong>）</p>
<p><strong>S-盒8第3行第9列值是12</strong>。则S-盒输出是1100（二进制）。</p>
<p>则$E(R_0)\otimes key_1 $&#x3D; 100110110001010100010001011111001010010001110100（48位）</p>
<p>经过S-盒替换后得到 10001011110001000110001011101010（32位）</p>
<h3 id="P-盒置换"><a href="#P-盒置换" class="headerlink" title="P-盒置换"></a>P-盒置换</h3><p>将S-盒替代的输出结果作为P-盒置换的输入。</p>
<p>P-盒置换表：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,</span><br><span class="line"><span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span>,</span><br></pre></td></tr></table></figure>

<p>将S盒输出	10001011110001000110001011101010（32位）经过P盒置换，P-盒置换输出	01001000101111110101010110000001</p>
<p>令<strong>扩展置换E、S-盒替代、P盒置换</strong>的过程作为函数f。</p>
<p>第一次迭代过程$f(R_0,key_1)$为：<br>$f(R_0,key_1)$ &#x3D; 01001000101111110101010110000001</p>
<p>计算$L_1$（32位）&#x3D; $R_0$ &#x3D; 00000000111111110000011010000011<br>计算$R_1$（32位）&#x3D; $L_0 \otimes f(R_0,key_1)$<br>             <strong>11111111101110000111011001010111</strong><br>     ^ 	<strong>01001000101111110101010110000001</strong><br>     &#x3D;    <strong>10110111000001110010001111010110</strong></p>
<p>$R_1$（32位） &#x3D; 10110111000001110010001111010110。<br>将$L_1$与$R_1$作为输入，继续执行迭代过程f。直至输出$L_{16}$与$R_{16}$。</p>
<p>经过16次迭代后输出:</p>
<p>$L_{16}$（32位）&#x3D; 00110000100001001101101100101000<br>$R_{16}$（32位）&#x3D; 10110001011001010011000000011000</p>
<h2 id="四、逆置换"><a href="#四、逆置换" class="headerlink" title="四、逆置换"></a>四、逆置换</h2><p>将初始置换进行16次的迭代，即进行16层的加密变换，得到$L_{16}$和$R_{16}$，将此作为输入块，<strong>进行逆置换得到最终的密文输出块</strong>。</p>
<p><strong>逆置换是初始置换的逆运算</strong>。从初始置换规则中可以看到，原始数据的第1位置换到了第40位，第2位置换到了第8位。则逆置换就是将第40位置换到第1位，第8位置换到第2位。以此类推</p>
<p>逆置换规则表如下:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,</span><br><span class="line"><span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,<span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,</span><br><span class="line"><span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,<span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,</span><br><span class="line"><span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span> <span class="number">26</span>,<span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>, <span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>,</span><br></pre></td></tr></table></figure>

<p><img src="/../images/DES/5.png"></p>
<p>将$L_{16}$与$R_{16}$构成64位数据，经过逆置换表输出密文为：<strong>0101100000001000001100000000101111001101110101100001100001101000</strong></p>
<h1 id="DES解密"><a href="#DES解密" class="headerlink" title="DES解密"></a>DES解密</h1><p>加密和解密可以使用相同的算法。加密和解密唯一不同的是秘钥的次序是相反的。就是说如果每一轮的<strong>加密秘钥分别是$key_1,key_2,…,key_{16}$，那么解密秘钥就是$key_{16},key_{15},…,key_1$。</strong>为每一轮产生秘钥的算法也是循环的。<strong>加密是秘钥循环左移，解密是秘钥循环右移。解密秘钥每次移动的位数是：0、1、2、2、2、2、2、2、1、2、2、2、2、2、2、1。</strong></p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://www.freebuf.com/articles/web/219723.html">DES 子密钥逆推初始密钥 - FreeBuf网络安全行业门户</a></p>
<p><a href="https://www.cxyxiaowu.com/1478.html">算法科普：神秘的 DES 加密算法_吴师兄学算法 (cxyxiaowu.com)</a></p>
<p><a href="https://blog.csdn.net/qq_27570955/article/details/52442092">DES算法原理完整版_朱小姐的博客的博客-CSDN博客</a></p>
]]></content>
      <categories>
        <category>块密码</category>
      </categories>
      <tags>
        <tag>对称</tag>
      </tags>
  </entry>
  <entry>
    <title>HNP</title>
    <url>/2023/09/23/HNP/</url>
    <content><![CDATA[<p>隐藏数问题（HNP &#x2F; Hidden Number Problem）</p>
<span id="more"></span>

<p>本文章参考：<a href="https://tover.xyz/p/HNP-note">HNP学习笔记 | Tover’ Blog</a></p>
<h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p><img src="/../images/HNP/0.png"></p>
<p>给出n组方程：$\beta_i \equiv A_ix \mod q$</p>
<p>给出$q$,每组方程中完整的$A_i$和每组方程中$\beta_i$的一部分，目标是求出$x$（每组使用一样的$x$）</p>
<h1 id="Level1"><a href="#Level1" class="headerlink" title="Level1"></a>Level1</h1><blockquote>
<p>泄露高位</p>
</blockquote>
<p>$n &#x3D; 35$，$m &#x3D; 256$，$q &#x3D; 2^m$，泄露$\beta_i$的高$s&#x3D;8$位</p>
<p>根据$A_ix \equiv B_i \mod q$，把$\beta_i$拆成高低位相加，即$A_ix \equiv B_i + b_i \mod q$</p>
<p><strong>根据使用格规约的经验，未知数越小越好，如果未知数过大的话需要一定的技巧转换成小的未知数。</strong>现在有$x$和$b_i$两个未知数，$x&#x3D;mbit$，$b_i&#x3D;(m-s)bit$，如果可以把$x$的未知量转换成$(m-s)bit$以下或者消去的话是最好的（按以前的经验，如果有未知数和模数一样大的话问题大概率不能解，不过也要看具体问题）。</p>
<p>下面把$x$消去</p>
<p>由$A_0x \equiv B_0+b_0 \mod q \longrightarrow x \equiv A_0^{-1}(B_0+b_0) \mod q$</p>
<p>再把$x$代入到$A_ix \equiv B_i+b_i \mod q$</p>
<p>可得$A_0^{-1}A_iB_0 + A_0^{-1}A_ib_0 \equiv B_i + b_i \mod q$</p>
<p>$\longrightarrow A_0^{-1}A_iB_0 + A_0^{-1}A_ib_0-B_i \equiv b_i \mod q$</p>
<p>化简$A_0^{-1}(A_iB_0+A_0B_i)+A_0^{-1}A_ib_0 \equiv b_i \mod q$，括号里的$A_0$是为了凑成$B_i &#x3D; A_0A_0^{-1}B_i$</p>
<p>记$D_i \equiv A_0^{-1}(A_iB_0-A_0B_i) \mod q$，$E_i \equiv A_0^{-1}A_i \mod q$</p>
<p>于是可以得到$D_i + E_ib_0 -k_iq &#x3D; b_i$</p>
<p>其中$D_i+E_ib_0-b_i$大概$(2m-s)bit$，$q &#x3D; 2^{m}$，所以$k_i \approx (m-s)bit$，最终所有未知数都是$(m-s)bit$</p>
<p><strong>具体问题具体分析</strong></p>
<p>构造格</p>
<p><img src="/../images/HNP/1.png"></p>
<p>目标向量的大小约$2^{m-s}$，记为$||\vec{w}||$</p>
<p>格的行列式大约$2^{\frac{n\times m -s}{n+1}}$，记为$||L(B)||$</p>
<p>如果$||\vec{w}|| \le ||L(B)||$，即$m-s \le \frac{n\times m-s}{n+1}$</p>
<p>$\longrightarrow m \le s\times n$</p>
<p>$\longrightarrow n \ge \frac{m}{s} &#x3D; \frac{256}{8} &#x3D; 32$，有32组$A_i$和$B_i$就可以求解</p>
<p>实际应用的时候有个技巧：$\beta_i$拆成$B_i + b_i$中，$b_i$恒为正，如果在$B_i$中加上一个$2^{m-s-1}$（<strong>这里有点疑惑</strong>），$b_i$就可以为负数，于是$|b_i| &#x3D; 2^{m-s-1}$，比原来小了一位。</p>
<p>此时目标向量的大小$||\vec{w}||$约$2^{m-s-1}$</p>
<p>格的行列式$||L(B)|| \approx 2^{\frac{n\times m - s-1}{n+1}}$</p>
<p>此时只需要$m-s-1 \le \frac{n\times m -s -1}{n+1}$</p>
<p>$\longrightarrow m \le s\times(n+1)$</p>
<p>$n \ge \frac{m}{s} -1 &#x3D; \frac{m}{s} &#x3D; \frac{256}{8}-1 &#x3D; 31$</p>
<p>给出大佬的脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            <span class="keyword">if</span> BB[ii, jj] == <span class="number">0</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a += <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = <span class="number">256</span></span><br><span class="line">s = <span class="number">8</span></span><br><span class="line">A = [<span class="number">18552404646625607802031743110914366573746520337013211033858024804225024940105</span>, <span class="number">56740036082990036588497013242271054916308856321570552305509938130173539445472</span>, <span class="number">59151439106786023980294355710672227931867183624220164412449673201752454427530</span>, <span class="number">13237216641371845192978293178609922091717977301070743799393539700879904443882</span>, <span class="number">25521989498907374126270233511179332613176188357074084516145063870461587530079</span>, <span class="number">110373287726565132556868199791116743883479507462720789643002594117884198700321</span>, <span class="number">23164903547736414155098856552696538941671109145839680706777330348132893758376</span>, <span class="number">112317341520121361103394518162080142791337563371930821607290630212762885866685</span>, <span class="number">73602790104232639616117254612617322979502450981103933805801785995687212573454</span>, <span class="number">113145039363502017094862783201370026372300556734287986351718168665459193502214</span>, <span class="number">66752470834028806678996615611836368933193481054193671954744443482353362530351</span>, <span class="number">37885763745636944137222355249634741567990575810143646003783562456845747212235</span>, <span class="number">60674901228684783253438467293302465286904156079948039750087902536773550538257</span>, <span class="number">4029135120952255935577861138157768103871099891225580456050557442883221381899</span>, <span class="number">87110291743288015103684657507788672501671197995888766138553136615049440922626</span>, <span class="number">108475696248983352880061369263551813906495341629323964921505055957988023812980</span>, <span class="number">83416621974706382829277243604100354890139141581042882194438954088524849887867</span>, <span class="number">19245862793444813607481767285049756188815676201896743690081204143253700135972</span>, <span class="number">11702220320346004623919485591819310523698914037766103494194186271288684604641</span>, <span class="number">53650697128270898439439820062869718897508959394971208739178865364160828587866</span>, <span class="number">86298488282944797651846585796016081710178675335636660102781089976336154593543</span>, <span class="number">4136525846891367151846727671338730252074102602553586165236438384243069631589</span>, <span class="number">82731569222552504414520663913443330663589973089453084218485394614125745573229</span>, <span class="number">6986076680374526547120184745403321767740390008363348862463722663630672347111</span>, <span class="number">106422889487655896671519650526514700237258388781502173490854830949789400690408</span>, <span class="number">16775350122321655684381538675737891240435560437644501095997285211841162830283</span>, <span class="number">60715724258075207854441574832820200049713413790161572118914663705964318813735</span>, <span class="number">86378073558442926717305615013480837417875785095929960716238520861353373828520</span>, <span class="number">99622486470993628308838394020972502717831728969329149849214388815946885810359</span>, <span class="number">28456916048865657422674440109984009630438622667667220911784018502270764868902</span>, <span class="number">25892885988982356203939786181343425231879915890968667040243364248452242057900</span>, <span class="number">17413022025348865115063748077713569507127705504386172745313237025251904211992</span>, <span class="number">51234147496890033975981358744482850570851594626878797842820311130273807392120</span>, <span class="number">36008458362103302836895934732945996322469327525421388029129389086179170566920</span>, <span class="number">107550710275116422568739631767667910493746227681937454697899115874888730378358</span>]</span><br><span class="line">B = [<span class="number">157</span>, <span class="number">217</span>, <span class="number">80</span>, <span class="number">79</span>, <span class="number">34</span>, <span class="number">141</span>, <span class="number">103</span>, <span class="number">194</span>, <span class="number">254</span>, <span class="number">201</span>, <span class="number">217</span>, <span class="number">149</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">77</span>, <span class="number">4</span>, <span class="number">143</span>, <span class="number">218</span>, <span class="number">125</span>, <span class="number">124</span>, <span class="number">22</span>, <span class="number">208</span>, <span class="number">219</span>, <span class="number">23</span>, <span class="number">172</span>, <span class="number">127</span>, <span class="number">198</span>, <span class="number">61</span>, <span class="number">77</span>, <span class="number">25</span>, <span class="number">18</span>, <span class="number">38</span>, <span class="number">59</span>, <span class="number">183</span>, <span class="number">62</span>]</span><br><span class="line"></span><br><span class="line">AAA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">BBB = [x <span class="keyword">for</span> x <span class="keyword">in</span> B]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AAA]</span><br><span class="line">  B = [x <span class="keyword">for</span> x <span class="keyword">in</span> BBB]</span><br><span class="line">  <span class="comment">#B = [x &lt;&lt; (m-s) for x in B]</span></span><br><span class="line">  B = [(x &lt;&lt; (m-s)) + (<span class="number">1</span> &lt;&lt; (m-s-<span class="number">1</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> B]</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">len</span>(A) == <span class="built_in">len</span>(B)</span><br><span class="line">  q = <span class="number">2</span>^m</span><br><span class="line"></span><br><span class="line">  n = <span class="built_in">len</span>(A)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">  AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">  BB = [x <span class="keyword">for</span> x <span class="keyword">in</span> B]</span><br><span class="line">  <span class="keyword">for</span> choice <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AA]</span><br><span class="line">    B = [x <span class="keyword">for</span> x <span class="keyword">in</span> BB]</span><br><span class="line">    <span class="keyword">if</span> A[choice] % <span class="number">2</span> != <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    A0 = A[choice]</span><br><span class="line">    A0i = A0.inverse_mod(q)</span><br><span class="line">    B0 = B[choice]</span><br><span class="line">    <span class="keyword">del</span> A[choice]</span><br><span class="line">    <span class="keyword">del</span> B[choice]</span><br><span class="line">    <span class="keyword">assert</span> gcd(A0, q) == <span class="number">1</span></span><br><span class="line">    Mt = matrix(ZZ, n+<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">      Mt[i, i]  = -q</span><br><span class="line">      Mt[-<span class="number">2</span>, i] = A0i*A[i] % q</span><br><span class="line">      Mt[-<span class="number">1</span>, i] = A0i*(A[i]*B0 - A0*B[i]) % q</span><br><span class="line">    Mt[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    R = <span class="number">2</span>^(m-s-<span class="number">1</span>)</span><br><span class="line">    Mt[-<span class="number">1</span>, -<span class="number">1</span>] = R</span><br><span class="line">    <span class="comment">#print(det(Mt) == 0)</span></span><br><span class="line">    <span class="comment">#matrix_overview(Mt)</span></span><br><span class="line"></span><br><span class="line">    L = Mt.BKZ()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">      <span class="keyword">if</span> l[-<span class="number">1</span>] == R:</span><br><span class="line">        b = vector(l)</span><br><span class="line"></span><br><span class="line">        b0 = b[-<span class="number">2</span>]</span><br><span class="line">        <span class="comment">#print(b0)</span></span><br><span class="line"></span><br><span class="line">        x0 = (B0+b0) * A0.inverse_mod(q) % q</span><br><span class="line"></span><br><span class="line">        test1 = [bi &gt;&gt; (m-s) <span class="keyword">for</span> bi <span class="keyword">in</span> B] </span><br><span class="line">        test2 = [(ai*x0 % q) &gt;&gt; (m-s) <span class="keyword">for</span> ai <span class="keyword">in</span> A]</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(x0)</span><br><span class="line">        <span class="built_in">print</span>(test1)</span><br><span class="line">        <span class="built_in">print</span>(test2)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> test1 == test2:</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&#x27;get: %d&#x27;</span> % x0)</span><br><span class="line">          exit(<span class="number">0</span>)</span><br><span class="line">          <span class="comment"># 78144589840853375593166683982569465121561954434303166342212446896078204238395</span></span><br></pre></td></tr></table></figure>

<h2 id="一道例题"><a href="#一道例题" class="headerlink" title="一道例题"></a>一道例题</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag&#123;xxxxxxx&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">38</span></span><br><span class="line">p = getPrime(<span class="number">300</span>)</span><br><span class="line">t = <span class="number">30</span></span><br><span class="line">x1,x2 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    a = random.randint(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        b = (a * x1 % p) &gt;&gt; (<span class="number">300</span> - <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        b = (a * x2 % p) &amp; (<span class="number">2</span> ** <span class="number">30</span> - <span class="number">1</span>)</span><br><span class="line">    A.append(a)</span><br><span class="line">    B.append(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = [<span class="number">463887498379837178289434930796937204555475877586622290749258048874370169798799337104469937</span>, <span class="number">773107696240723064348524874255963716154847723824140324851906738257594371092025839092322618</span>, <span class="number">959382311121888872352942066453176913016345159699733628226033809692442378255600652170133603</span>, <span class="number">1475439387312927400751305948540244549759336332552059673660666894619118830047069015157686938</span>, <span class="number">849526462831348819335657678027942464464758618063917043187129057068191653250289714276486390</span>, <span class="number">1334127037206856127523941580821068150671372041649866724020399671459149591275291992977444717</span>, <span class="number">270665083631525557759154548751201812246030483353898310710004039080238333516013780476382216</span>, <span class="number">1018902660322104052776222955411066044807125950939527765041383184188103427291053881056928575</span>, <span class="number">209244905602559751670010690327768486619524571513992042827189611303489897515540986981111728</span>, <span class="number">1448752767778370938295347623067314667365820805495380149782146153110745097342875410404772323</span>, <span class="number">259828604923763561672700195721292502767730876290458742290887049867931720014196470106481233</span>, <span class="number">64955927829662789888801246059321257505518334913081564868033981302809434355859085577340789</span>, <span class="number">541853690860409175470448997776819435952775864942641589293140819248380415841093286149509439</span>, <span class="number">1139888865143435145477538463183158820201430904436762627802923622604703492742131126856361559</span>, <span class="number">1275201358819804049372292362561266777547371187070453684762542985512809430125709931354890689</span>, <span class="number">369607296264184981154638102500387132578476452666540211313258531786190436544288889435124252</span>, <span class="number">806708347908045807047609135976903208402075815467445877191713196364943763493569595760618980</span>, <span class="number">1455987609449801976533130312961654430816056114205781282886620693328977276162282426493869107</span>, <span class="number">78240737983903215239118749844347047542830586146993600511897384363311151546231920353144287</span>, <span class="number">178433523161741238741165004364134882377268446191666891015503424004703296483616704501522431</span>, <span class="number">160833029194895051498255704447576591540146606885321132274228852060778655408117052809405842</span>, <span class="number">665439140689838885724776126488323057267424913454382363615180272084605737991756925728109752</span>, <span class="number">1212399960630524647715423021430580541043060607704004760594818883478379710374660040225211737</span>, <span class="number">1024104693386208450852231949868224748229315263011728008967767316172947909984939303025784616</span>, <span class="number">1172245617567690331560150298653167704336960464136186977917753583487333782434094205711336284</span>, <span class="number">783927796969236661199653579569651324291785925516516459946058680074574047025620354913449506</span>, <span class="number">662785009487244748764576805406718936165913097166011574087131710238816769129253409163197996</span>, <span class="number">176622195892476124982696054672313827341938528038522227778420609502821124526352064161794848</span>, <span class="number">1207882741313080019507286406568893562247091201154746129221516369048603742944945854959243209</span>, <span class="number">865971631872293774191772297150903858147356635890878227481230935983612340880935090288780814</span>]</span><br><span class="line">B = [<span class="number">213262950</span>, <span class="number">338585619</span>, <span class="number">651186563</span>, <span class="number">161224022</span>, <span class="number">614133782</span>, <span class="number">358709201</span>, <span class="number">81465247</span>, <span class="number">606102220</span>, <span class="number">333896117</span>, <span class="number">244095320</span>, <span class="number">29938894</span>, <span class="number">126014939</span>, <span class="number">555731335</span>, <span class="number">373319033</span>, <span class="number">662799251</span>, <span class="number">517458562</span>, <span class="number">33441774</span>, <span class="number">922070946</span>, <span class="number">236657217</span>, <span class="number">323031182</span>, <span class="number">143007144</span>, <span class="number">9082131</span>, <span class="number">230128400</span>, <span class="number">805207434</span>, <span class="number">699486605</span>, <span class="number">511887222</span>, <span class="number">957047430</span>, <span class="number">474639197</span>, <span class="number">74284022</span>, <span class="number">547483878</span>]</span><br><span class="line">p = <span class="number">1515897080671400659075132434127277346281580386706329236487649363388239277840368389427768563</span></span><br></pre></td></tr></table></figure>

<p>前半部分考点就是泄露高30位</p>
<p>本题需要满足$n \ge \frac{300}{30} &#x3D; 10$，即需要10组方程进行求解</p>
<h1 id="构造格-p-和-p-其实是一样的，只不过最后规约的结果差了正负-begin-pmatrix-k-1-k-2-…-k-14-b-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix"><a href="#构造格-p-和-p-其实是一样的，只不过最后规约的结果差了正负-begin-pmatrix-k-1-k-2-…-k-14-b-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix" class="headerlink" title="构造格($p$和$-p$其实是一样的，只不过最后规约的结果差了正负)$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; b_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R\end{pmatrix}"></a>构造格($p$和$-p$其实是一样的，只不过最后规约的结果差了正负)<br>$$<br>\begin{pmatrix}<br>k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; b_0 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\<br>E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\<br>D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>b_1 &amp; b_2 &amp; … &amp; b_{14} &amp; b_0 &amp; R<br>\end{pmatrix}<br>$$<br>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = <span class="number">300</span>                        </span><br><span class="line">s = <span class="number">30</span></span><br><span class="line">A = [...]</span><br><span class="line">B = [...]</span><br><span class="line">p = </span><br><span class="line"></span><br><span class="line">A1 = A[:<span class="number">15</span>]</span><br><span class="line">B1 = [x &lt;&lt; (m-s) <span class="keyword">for</span> x <span class="keyword">in</span> B[:<span class="number">15</span>]]       <span class="comment">#记得移位</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(A1) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):         <span class="comment">#把每个A都当作一次A0</span></span><br><span class="line">    AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A1]</span><br><span class="line">    BB = [x <span class="keyword">for</span> x <span class="keyword">in</span> B1]</span><br><span class="line">    A0 = AA[i]</span><br><span class="line">    B0 = BB[i]</span><br><span class="line">    </span><br><span class="line">    A0i = gmpy2.invert(A0,p)</span><br><span class="line">    <span class="keyword">del</span> AA[i]              <span class="comment">#从AA中删去A0</span></span><br><span class="line">    <span class="keyword">del</span> BB[i]              <span class="comment">#同理</span></span><br><span class="line">    </span><br><span class="line">    D = []</span><br><span class="line">    E = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(AA)):</span><br><span class="line">        d = A0i * (AA[j]*B0 - A0*BB[j]) % p</span><br><span class="line">        D.append(d)</span><br><span class="line">        e = A0i * AA[j] % p</span><br><span class="line">        E.append(e)</span><br><span class="line">        </span><br><span class="line">    Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Ge[j,j] = p</span><br><span class="line">        Ge[-<span class="number">2</span>,j] = E[j]</span><br><span class="line">        Ge[-<span class="number">1</span>,j] = D[j]</span><br><span class="line">    R = <span class="number">2</span>^(m-s)</span><br><span class="line">    Ge[-<span class="number">1</span>,-<span class="number">1</span>] = R</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(line[-<span class="number">1</span>]) == R:</span><br><span class="line">            b0 = <span class="built_in">abs</span>(line[-<span class="number">2</span>])</span><br><span class="line">            x0 = (B0+b0) * A0i % p</span><br><span class="line">            <span class="built_in">print</span>(x0)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x0)))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="Level2"><a href="#Level2" class="headerlink" title="Level2"></a>Level2</h1><blockquote>
<p>泄露低位</p>
</blockquote>
<p>$n &#x3D; 35$，$m &#x3D; 256$，$p &#x3D; 2^m$，泄露$\beta_i$的低$s&#x3D;8$位</p>
<p>令$T&#x3D;2^s$，$B_i$为$\beta_i$的高$(m-s)$位，$b_i$为泄露的低$s$位</p>
<p>于是$A_ix \equiv \beta \mod p$变为</p>
<p>$A_ix \equiv TB_i + b_i \mod p$</p>
<p>和泄露高位一样，消去$x$</p>
<p>由$A_ix \equiv TB_i + b_i \mod p$得$x \equiv A_0^{-1}(TB_0+b_0) \mod p$</p>
<p>代入得$A_iA_0^{-1}TB_0 + A_iA_0^{-1}b_0 \equiv TB_i + b_i \mod p$</p>
<p>再同乘$T^{-1}$得$A_iA_0^{-1}B_0 + (TA_0)^{-1}A_ib_0 - T^{-1}b_i \equiv B_i \mod p$</p>
<p>化简一下得到$(TA_0)^{-1}(A_ib_0 - A_0b_i) +(A_0^{-1}A_i)B_0 \equiv B_i \mod p$</p>
<p>令$D_i \equiv (TA_0)^{-1}(A_ib_0 - A_0b_i) \mod p$，$E_i \equiv (A_0^{-1}A_i) \mod p$</p>
<p>则有$D_i + E_iB_0 -k_ip &#x3D; B_i$</p>
<p>$D_i\approx 256bit,E_iB_0 \approx 256+(m-s)bit$，$\therefore k_i$大概$(m-s)bit$</p>
<h1 id="构造格-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-n-1-1-0-D-1-D-2-…-D-n-1-0-R-end-pmatrix"><a href="#构造格-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-n-1-1-0-D-1-D-2-…-D-n-1-0-R-end-pmatrix" class="headerlink" title="构造格$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{n-1} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{n-1} &amp; 0 &amp; R\end{pmatrix}"></a>构造格<br>$$<br>\begin{pmatrix}<br>k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\<br>E_1 &amp; E_2 &amp; … &amp;E_{n-1} &amp; 1 &amp; 0\<br>D_1 &amp; D_2 &amp; … &amp;D_{n-1} &amp; 0 &amp; R<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>B_1 &amp; B_2 &amp; … &amp; B_{n-1} &amp; B_0 &amp; R<br>\end{pmatrix}<br>$$<br>目标向量的大小约$2^{m-s}$，记为$||\vec{w}||$</p>
<p>格的行列式大约$2^{\frac{n\times m -s}{n+1}}$，记为$||L(B)||$</p>
<p>和level1一样需要满足$s\times n \ge m$，当$n\ge \frac{256}{8}&#x3D;32$时，即可求解</p>
<p>同样可以类似地给每个$b_i$加上一个$S &#x3D; 2^{m-1}$，以缩小$|B_i|$，最后同样算出需要$s\times(n+1) \ge m$，当$n\ge \frac{256}{8}-1 &#x3D; 31$时，即可求解</p>
<p>大佬的exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">256</span></span><br><span class="line">s = <span class="number">8</span></span><br><span class="line">q = <span class="number">115489892924193056836132383269279333763560438068210655617495986590734951348939</span></span><br><span class="line">A = [<span class="number">88343870158530321655131443357178261426174895372868830504272120303037917055013</span>, <span class="number">85325303175048321004526613601928244614666767838733487462001976992406756134576</span>, <span class="number">90882364208421865383373693892883461160089951040169826835449248853396593827733</span>, <span class="number">48914354030973321553237573953543292277797421300981960367879618295795824538320</span>, <span class="number">54807516969335094120648558162272221993576047935493515314772824356732246459169</span>, <span class="number">36812706430304694201746706101182856438293116568179945850376468523555258664980</span>, <span class="number">82131367704052948529124949596528379797191577328465393163417792351565563409081</span>, <span class="number">79831902260187536843981833314825687645917600445250894882694033518072492615411</span>, <span class="number">66451378066281903908400021310571865791652283484940347282384194834125438807669</span>, <span class="number">32608010020001240619280738531261961681212354978314347253538745087986905117352</span>, <span class="number">7860885267345608425989913131759834056868685988803386261763395690366879022243</span>, <span class="number">37222587210728314208398619915821886964807914912901991406229349412326449418179</span>, <span class="number">56977280188144899274798380397415402131167271269654342143740837856150016067047</span>, <span class="number">76914199480415217940069930651954512153166917821529826063118308350202255002671</span>, <span class="number">18482272857234951157518933548282264533448787764627865284794057957457833764067</span>, <span class="number">107785071766998271581871821738453393552452017028698961365332240900866426857020</span>, <span class="number">190580133668087354680103117288389841931579854419397703359087694916128442143</span>, <span class="number">87853755322161944258340024647448387411527829155020919155674005583828401150896</span>, <span class="number">76207892917006659328380688401842000960522284878422213324432301551629799359509</span>, <span class="number">89980437739540931413898766918299076236852227002328442545512525695266247961371</span>, <span class="number">29608262839130429904290779751973451938444466286918205057729003916606001439172</span>, <span class="number">115767332930668164788424928332158725353720265911370328402436011707488227509170</span>, <span class="number">23454937519042942777425481684992940005179760184276271526453270580778964069005</span>, <span class="number">51653856405431150848646432136923921761643227936128812898907620835063712753107</span>, <span class="number">38088856145419492865333380128661037442170218303908041272254133861517117697079</span>, <span class="number">75111121637244940656922292991292429644427922643078727610936163720627826376691</span>, <span class="number">37679596638329344601154736576807084398120494208842456132545479949504134442217</span>, <span class="number">19578501816856097058106840236189238165953876832209668961625428053694596718313</span>, <span class="number">106766811019229785397297997988809755521283473820331287599956272493657323971569</span>, <span class="number">43832604772584623719595136819589206777192799798556704267698095619303307189174</span>, <span class="number">70061885003643620468669941804388700557128540127031943407678737766857349689523</span>, <span class="number">37279712184962201746108339606086267909697185360173358859124878886903891176335</span>, <span class="number">11376435694200796618267405577538644656116405689070455991895178888164192367660</span>, <span class="number">1508734971460809891010884694302107503995322143407596431243044985641741988731</span>, <span class="number">60348216835678499133215105211752499387941826826503028490323295859278352333263</span> ]</span><br><span class="line">b = [ <span class="number">93</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">64</span>, <span class="number">150</span>, <span class="number">73</span>, <span class="number">243</span>, <span class="number">36</span>, <span class="number">158</span>, <span class="number">102</span>, <span class="number">14</span>, <span class="number">250</span>, <span class="number">20</span>, <span class="number">101</span>, <span class="number">25</span>, <span class="number">167</span>, <span class="number">18</span>, <span class="number">241</span>, <span class="number">106</span>, <span class="number">198</span>, <span class="number">63</span>, <span class="number">110</span>, <span class="number">239</span>, <span class="number">254</span>, <span class="number">192</span>, <span class="number">132</span>, <span class="number">23</span>, <span class="number">62</span>, <span class="number">228</span>, <span class="number">100</span>, <span class="number">120</span>, <span class="number">233</span>, <span class="number">90</span>, <span class="number">14</span>, <span class="number">140</span> ]</span><br><span class="line">T = <span class="number">2</span>^s</span><br><span class="line">Ti = T.inverse_mod(q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(A) == <span class="built_in">len</span>(b)</span><br><span class="line">AAA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">bbb = [x <span class="keyword">for</span> x <span class="keyword">in</span> b]</span><br><span class="line"></span><br><span class="line"><span class="comment">#Z = sorted(list(zip(AAA, bbb)), reverse=True)[:m//s+1]</span></span><br><span class="line">Z = <span class="built_in">sorted</span>(<span class="built_in">list</span>(<span class="built_in">zip</span>(AAA, bbb)), reverse=<span class="literal">True</span>)</span><br><span class="line">A = [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">b = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">S = <span class="number">2</span>^(m-<span class="number">1</span>)</span><br><span class="line">b = [x + S <span class="keyword">for</span> x <span class="keyword">in</span> b]</span><br><span class="line">n = <span class="built_in">len</span>(A)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">bb = [x <span class="keyword">for</span> x <span class="keyword">in</span> b]</span><br><span class="line"><span class="keyword">for</span> choice <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">  A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AA]</span><br><span class="line">  b = [x <span class="keyword">for</span> x <span class="keyword">in</span> bb]</span><br><span class="line"></span><br><span class="line">  A0 = A[choice]</span><br><span class="line">  A0i = A0.inverse_mod(q)</span><br><span class="line">  b0 = b[choice]</span><br><span class="line">  <span class="keyword">del</span> A[choice]</span><br><span class="line">  <span class="keyword">del</span> b[choice]</span><br><span class="line">  <span class="keyword">assert</span> gcd(A0, q) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  Mt = matrix(ZZ, n+<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Mt[i, i]  = -q</span><br><span class="line">    Mt[-<span class="number">2</span>, i] = A0i*A[i] % q</span><br><span class="line">    Mt[-<span class="number">1</span>, i] = A0i*Ti*(A[i]*b0 - A0*b[i]) % q</span><br><span class="line">  Mt[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">  R = <span class="number">2</span>^(m-s-<span class="number">1</span>) + <span class="number">2</span>^(m-s-<span class="number">2</span>)</span><br><span class="line">  Mt[-<span class="number">1</span>, -<span class="number">1</span>] = R</span><br><span class="line"></span><br><span class="line">  L = Mt.BKZ(block_size=Mt.rank())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> l[-<span class="number">1</span>] == R:</span><br><span class="line">      B = vector(l)</span><br><span class="line"></span><br><span class="line">      B0 = B[-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">      x0 = (T*B0+b0) * A0i % q</span><br><span class="line"></span><br><span class="line">      test1 = [bi <span class="keyword">for</span> bi <span class="keyword">in</span> bbb] </span><br><span class="line">      test2 = [(ai*x0 % q) &amp; ((<span class="number">1</span>&lt;&lt;s) - <span class="number">1</span>) <span class="keyword">for</span> ai <span class="keyword">in</span> AAA]</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(x0)</span><br><span class="line">      <span class="built_in">print</span>([test1[x]-test2[x] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test1))])</span><br><span class="line">      <span class="comment">#print(test1)</span></span><br><span class="line">      <span class="comment">#print(test2)</span></span><br><span class="line">      <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> test1 == test2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get: %d&#x27;</span> % x0)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 14784001462013082660879013393081171292907080173178221189428088561527208747939</span></span><br></pre></td></tr></table></figure>



<h2 id="一道例题-1"><a href="#一道例题-1" class="headerlink" title="一道例题"></a>一道例题</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag&#123;xxxxxxx&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">38</span></span><br><span class="line">p = getPrime(<span class="number">300</span>)</span><br><span class="line">t = <span class="number">30</span></span><br><span class="line">x1,x2 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    a = random.randint(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        b = (a * x1 % p) &gt;&gt; (<span class="number">300</span> - <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        b = (a * x2 % p) &amp; (<span class="number">2</span> ** <span class="number">30</span> - <span class="number">1</span>)</span><br><span class="line">    A.append(a)</span><br><span class="line">    B.append(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = </span><br><span class="line">B = </span><br><span class="line">p = </span><br></pre></td></tr></table></figure>

<p>同上面的题，这回解的是后半部分</p>
<h1 id="构造-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix"><a href="#构造-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix" class="headerlink" title="构造$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R\end{pmatrix}"></a>构造<br>$$<br>\begin{pmatrix}<br>k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\<br>E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\<br>D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>B_1 &amp; B_2 &amp; … &amp; B_{14} &amp; B_0 &amp; R<br>\end{pmatrix}<br>$$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = <span class="number">300</span></span><br><span class="line">s = <span class="number">30</span></span><br><span class="line">A = [...]</span><br><span class="line">B = [...]</span><br><span class="line">p = </span><br><span class="line"></span><br><span class="line">A2 = A[<span class="number">15</span>:]</span><br><span class="line">B2 = B[<span class="number">15</span>:]</span><br><span class="line"></span><br><span class="line">T = <span class="number">2</span>^s</span><br><span class="line">Ti = gmpy2.invert(T,p)</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(A2) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):         <span class="comment">#把每个A都当作一次A0</span></span><br><span class="line">    AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A2]</span><br><span class="line">    bb = [x <span class="keyword">for</span> x <span class="keyword">in</span> B2]</span><br><span class="line">    A0 = AA[i]</span><br><span class="line">    b0 = bb[i]</span><br><span class="line">    </span><br><span class="line">    A0i = gmpy2.invert(A0,p)</span><br><span class="line">    <span class="keyword">del</span> AA[i]              <span class="comment">#从AA中删去A0</span></span><br><span class="line">    <span class="keyword">del</span> bb[i]              <span class="comment">#同理</span></span><br><span class="line">    </span><br><span class="line">    D = []</span><br><span class="line">    E = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(AA)):</span><br><span class="line">        d = (Ti*A0i) * (AA[j]*b0 - A0*bb[j]) % p</span><br><span class="line">        D.append(d)</span><br><span class="line">        e = A0i * AA[j] % p</span><br><span class="line">        E.append(e)</span><br><span class="line">        </span><br><span class="line">    Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Ge[j,j] = p</span><br><span class="line">        Ge[-<span class="number">2</span>,j] = E[j]</span><br><span class="line">        Ge[-<span class="number">1</span>,j] = D[j]</span><br><span class="line">    R = <span class="number">2</span>^(m-s)</span><br><span class="line">    Ge[-<span class="number">1</span>,-<span class="number">1</span>] = R</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(line[-<span class="number">1</span>]) == R:</span><br><span class="line">            B0 = <span class="built_in">abs</span>(line[-<span class="number">2</span>])</span><br><span class="line">            x0 = (T*B0+b0) * A0i % p</span><br><span class="line">            <span class="built_in">print</span>(x0)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x0)))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="Level3"><a href="#Level3" class="headerlink" title="Level3"></a>Level3</h1><blockquote>
<p>泄露中间位数</p>
</blockquote>
<p>前提条件</p>
<p>$n&#x3D;45$，$m&#x3D;512$，$q$是$m$bit的素数，$\beta_i$的高$s_1 &#x3D; 128bit$和低$s_3&#x3D;360bit$未知，泄露$\beta_i$中间$s_2&#x3D;24bit$</p>
<p>先把$\beta_i$划分为3块:<br>$$<br>\beta_i &#x3D; b_{i,1}(s_1\quad bit)\quad ||\quad b_{i,2}(s_2\quad bit)\quad ||\quad b_{i,3}(s_3\quad bit)<br>$$<br>令$T_1 &#x3D; 2^{s_2+s_3}$，$T_2 &#x3D; 2^{s_3}$，问题可以表述为：<br>$$<br>A_ix \equiv T_1b_{i,1} + T_2b_{i,2} + b_{i,3} \mod q<br>$$<br>同样消去$x$<br>$$<br>x \equiv A_0^{-1}(T_1b_{0,1} + T_2b_{0,2} + b_{0,3}) \mod q<br>$$</p>
<p>$$<br>\therefore A_i(A_0^{-1}T_1b_{0,1} + A_0^{-1}T_2b_{0,2} + A_0^{-1}b_{0,3})\equiv T_1b_{i,1} + T_2b_{i,2} + b_{i,3} \mod q<br>$$</p>
<p>化简一下，把$b_{i,3}$放右边，得到$T_2A_0^{-1}(A_ib_{0,2}-A_0b_{i,2})+(T_1A_0^{-1}A_i)b_{0,1}-T_1b_{i,1}+(A_0^{-1}A_i)b_{0,3} \equiv b_{i,3} \mod q$</p>
<p>令$D_i \equiv T_2A_0^{-1}(A_ib_{0,2}-A_0b_{i,2}) \mod q$、$E_i \equiv T_1A_0^{-1}A_i \mod q$、$F_i \equiv A_0^{-1}A_i \mod q$</p>
<p>于是有$b_{i,3} &#x3D; D_i + E_ib_{0,1}-T_1b_{i,1} + F_ib_{0,3} - k_iq$</p>
<h1 id="设-R-2-s-3-T-3-2-s-3-s-1-，构造格-begin-pmatrix-k-1-b-1-1-k-2-b-2-1-…-k-n-1-b-n-1-1-b-0-3-b-0-1-1-end-pmatrix-begin-pmatrix-q-0-0-0-…-0-0-0-0-0-T-1-T-3-0-0-…-0-0-0-0-0-0-0-q-0-…-0-0-0-0-0-0-0-T-1-T-3-…-0-0-0-0-0-vdots-vdots-vdots-vdots-ddots-vdots-vdots-vdots-vdots-vdots-0-0-0-0-…-q-0-0-0-0-0-0-0-0-…-T-1-T-3-0-0-0-F-1-0-F-2-0-…-F-n-1-0-1-0-0-E-1-0-E-2-0-…-E-n-1-0-0-T-3-0-D-1-0-D-2-0-…-D-n-1-0-0-0-R-end-pmatrix-2n-1-times-2n-1"><a href="#设-R-2-s-3-T-3-2-s-3-s-1-，构造格-begin-pmatrix-k-1-b-1-1-k-2-b-2-1-…-k-n-1-b-n-1-1-b-0-3-b-0-1-1-end-pmatrix-begin-pmatrix-q-0-0-0-…-0-0-0-0-0-T-1-T-3-0-0-…-0-0-0-0-0-0-0-q-0-…-0-0-0-0-0-0-0-T-1-T-3-…-0-0-0-0-0-vdots-vdots-vdots-vdots-ddots-vdots-vdots-vdots-vdots-vdots-0-0-0-0-…-q-0-0-0-0-0-0-0-0-…-T-1-T-3-0-0-0-F-1-0-F-2-0-…-F-n-1-0-1-0-0-E-1-0-E-2-0-…-E-n-1-0-0-T-3-0-D-1-0-D-2-0-…-D-n-1-0-0-0-R-end-pmatrix-2n-1-times-2n-1" class="headerlink" title="设$R&#x3D;2^{s_3}$,$T_3&#x3D;2^{s_3-s_1}$，构造格$$\begin{pmatrix}k_1 &amp; b_{1,1} &amp; k_2 &amp; b_{2,1} &amp;… &amp; k_{n-1} &amp; b_{n-1,1} &amp; b_{0,3} &amp; b_{0,1} &amp; 1\end{pmatrix}\begin{pmatrix}-q &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\-T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\0 &amp; 0 &amp; -q &amp;0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\0 &amp; 0 &amp; -T_1 &amp; T_3 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots &amp; \vdots &amp; \vdots &amp; \vdots \0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -q &amp; 0 &amp; 0&amp; 0&amp; 0\0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; 0\F_1 &amp; 0 &amp; F_2 &amp; 0 &amp; … &amp; F_{n-1} &amp; 0 &amp; 1 &amp; 0 &amp; 0\E_1 &amp; 0 &amp; E_2 &amp; 0 &amp; … &amp; E_{n-1} &amp; 0 &amp; 0 &amp; T_3 &amp; 0\D_1 &amp; 0 &amp; D_2 &amp; 0 &amp; … &amp; D_{n-1} &amp; 0 &amp; 0 &amp; 0 &amp; R\end{pmatrix}_{(2n+1)\times (2n+1)}"></a>设$R&#x3D;2^{s_3}$,$T_3&#x3D;2^{s_3-s_1}$，构造格<br>$$<br>\begin{pmatrix}<br>k_1 &amp; b_{1,1} &amp; k_2 &amp; b_{2,1} &amp;… &amp; k_{n-1} &amp; b_{n-1,1} &amp; b_{0,3} &amp; b_{0,1} &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>-q &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>-T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; 0 &amp; -q &amp;0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; 0 &amp; -T_1 &amp; T_3 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots &amp; \vdots &amp; \vdots &amp; \vdots \<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -q &amp; 0 &amp; 0&amp; 0&amp; 0\<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; 0\<br>F_1 &amp; 0 &amp; F_2 &amp; 0 &amp; … &amp; F_{n-1} &amp; 0 &amp; 1 &amp; 0 &amp; 0\<br>E_1 &amp; 0 &amp; E_2 &amp; 0 &amp; … &amp; E_{n-1} &amp; 0 &amp; 0 &amp; T_3 &amp; 0\<br>D_1 &amp; 0 &amp; D_2 &amp; 0 &amp; … &amp; D_{n-1} &amp; 0 &amp; 0 &amp; 0 &amp; R<br>\end{pmatrix}_{(2n+1)\times (2n+1)}</h1><p>\begin{pmatrix}<br>b_{1,3} &amp; T_3b_{1,1} &amp; b_{2,3} &amp; T_3b_{2,1} &amp; … &amp;b_{n-1,3} &amp;T_3b_{n-1,1} &amp;b_{0,3} &amp;T_3b_{0,1} &amp; R<br>\end{pmatrix}<br>$$<br><strong>格的规模和大佬博客的有点不同，我就按我理解的来写了</strong></p>
<p>目标向量大小$||\vec{w}|| &#x3D; 2^{s_3}$</p>
<p>格的行列式$||L(B)||&#x3D;2^{\frac{(n-1)(m+s_3-s_1)+2s_3-s_1}{2n+1}}$</p>
<p>若$||\vec{w}||\le ||L(B)||$，即$s_3 \le \frac{(n-1)(m+s_3-s_1)+2s_3-s_1}{2n+1} \longrightarrow n \ge\frac{m}{m-s_1-s_3}$</p>
<p>$\because s_2 &#x3D; m-s_1-s_3$,$\therefore n \ge \frac{m}{s_2}$</p>
<p><strong>优化</strong>：</p>
<p>在已知的$T_2b_{i,2}$部分加上一个$S &#x3D; 2^{m-1}+2^{s_3-1}$，原理和前面类似，就是加上未知数的最高比特，以降低对应未知数的绝对值规模。优化后设置$R&#x3D;2^{s_3-1}$，重新计算<br>$$<br>||\vec{w}|| &#x3D; 2^{s_3-1}<br>$$</p>
<p>$$<br>||L(B)|| &#x3D; 2^{\frac{(n-1)(m+s_3-s_1)+2s_3-s_1-1}{2n+1}}<br>$$</p>
<p>最后算得$n\ge \frac{m}{s_2+2}$</p>
<p>给出大佬的exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">512</span></span><br><span class="line">s1 = <span class="number">128</span></span><br><span class="line">s2 = <span class="number">24</span></span><br><span class="line">s3 = <span class="number">360</span></span><br><span class="line">q = <span class="number">9560792366438456408260738854830723707433313518273338023048084562934319966293294896329095798633420211864817785355567299335123635073425044586190935062371363</span></span><br><span class="line">A = [<span class="number">2693023266307193674130753259922304868222107145570752971321007609478208087950819230325973514861186073885406878323592121469513656969622896317188548446633784</span>, <span class="number">8785512325992763455825199692000460571517834183218755569097223618124106341652451821725892116772650362553591671412077856105898073665095841079486256807067306</span>, <span class="number">12386289199153705766782197687938287187000534145958433894804423142406910927880264185439922256995188378449480018881406273420386620869540926421199629319647214</span>, <span class="number">7416095351737790251022594980817779580684613694979242480002719542428840160491315637681443454956529880170329111614984846032248249259911860552600555136208543</span>, <span class="number">7697974016683042748266020943554913338612433987626989480302426333302909435256004459432900364006268423433788538012565206603339344715546753584818471442207073</span>, <span class="number">4186354864979832730408458284993041599021589619327814632942270492428908405693989535739742148508857495973220315565598757360076249931180977910829693610071891</span>, <span class="number">8727275754915947728643624783163551337534904428297453305136805895543553182595432520579697527391391207848721688173924870776124365612055802346338933900117239</span>, <span class="number">10941460446434501439298848596995106284490140699259548358480147265518996095012828504465005060130558534722968630468802709976609939848406120023146576837789583</span>, <span class="number">8259883991308211154289511718368156026109384650285845641402046351030049037220401142270393361746354406841219671539116472122632627493574700196002513172485655</span>, <span class="number">3983079465191700245062514565458583381962198195683763307819686217487379339901644377536201141397807766062401800178625442075271729346326076527442103453210202</span>, <span class="number">5244702264977327278320870012491074210221462948223915976821656413017924909705064903684162565154071789839960019633013970334716585108365220072590755374703278</span>, <span class="number">5291151012558614600583010230995646257041300794353193390525609590490561648982999435942132384399188745286887878565229424830159154790573275766853617555652411</span>, <span class="number">13376537998776012009314970194028929991069169432509877179648764336298411856607226670179358946433850379350530415443255113457650490622848610735722940367531094</span>, <span class="number">1320577928055881865833264931386525876645366275702245535366485903629214773012241182720232084428261256805275074154279381451085217023438842777730231838805521</span>, <span class="number">4624205834183746767055351710577116259387874270879587844541751892197439724205857803167685894994409036200702335468011492225335415292502168575607445133447261</span>, <span class="number">5563895391050356518337061896431670935091032239251555132293790411864743553590087783206226280221040770267886936512621844705804976864068059070358358625202920</span>, <span class="number">12827790893444989733048776469648788267135383128079693878482232328430354535768514103994571882959591390682332549005644128031384797039513739686323606259957957</span>, <span class="number">12252084608783729245990158175591620197924800323228850960323690735815309501075168493847345371800576057769133986754671778456671004657079586235930970854187752</span>, <span class="number">1657921198563869880350990075690523102625863816457321518288521999596639875255490216514151103766541394560935153182967313558771102516581898630710822943099174</span>,</span><br><span class="line"><span class="number">9219274536121877500448871260238231221042400890788027802089860137401522984959977056772350114877037870187756679617067504051344563745814435804183381170494284</span>, <span class="number">1748460868318530291399045242989575093142552407759686279682576514582197400071186886395009927678257744714825012099081776085396477000150503562703015340857425</span>, <span class="number">12097420237566579272043307832790245960963890522311189050238104792484832017686368855370935990254305211595492665130600310022589959454951879833116897750998428</span>, <span class="number">12358535390937351447732841924647470567841972439921307596541967297460841844333495080824576160065074382448269455680525372581785700464333699293602661448790154</span>, <span class="number">12063760154733402287249071777313421846696267413115226792803495046285138326035281596187883853756001696856539738553227620458124718565607875758917149908543506</span>, <span class="number">2303658006732630530354362396576218217479774096634534067678087368027750523261362874798354672335259847545900339345320813999099554374757386588053933181889964</span>, <span class="number">13080614939780066645485672444555381463913395720598258604233598986511005716421252998376368573125975001945335843989208119713852278971834347770656477810390640</span>, <span class="number">5806228512723887021559003555949389380932506538248366411493934436815507516241692504983935053410147217801131533144935042742154118845215080408645310891794156</span>, <span class="number">4158253803818053710419974676436028020497988289801823810387506682141523891053076010353682008145357553080443635351513680778972858476261005805183169130672271</span>, <span class="number">901720231210245767072309739431942352926185462937666048714174644408372682935523179329498708201825222154246682262800752865190660440778449118418985533094105</span>, <span class="number">10454374169436877663990756889544098958877556026137736165229918458867781739533254573244560790380897040566402158107540558451293997491671638018951381047912688</span>, <span class="number">4974181555682685751542705093313153126511169197799896261763621164887216237401002638750101176367544196892004854663483430137887313549820050138364998675721991</span>, <span class="number">1723335526511535197701833346493128234713348824370996430890310949384112731946661560478260786626542758303897097215563427063632687987122688865533351393834073</span>, <span class="number">10546556973596660252639285860361898932107787308127931983505944003487107775352695197716642212915033191540651979295391343598456422942843486373224024873409627</span>, <span class="number">9079284206247739353345950504298981119615132261207265682594246042963238725134024067814797639517217401860251060295710421418556645862224293836835103902130785</span>, <span class="number">7219827103328150187732953138499280095751899064289748344301075686667703871746653497117283061823025573836231487034678682402057188765887097511436390378979980</span>, <span class="number">4214104343592383857759084728462440814891423459187541675664471381293469160797252117342999154248530698738781467754755294136424903864170164991693886487632855</span>, <span class="number">780191582642434041483668147859478052817167039884006235620769823182094343517569155176753126373426127761829929481146772802353065926975260652961203760272382</span>, <span class="number">2997255382397979337191133019326169357740317929898745842898952849013871743749567559616653759513797345195607539811536780699668359411121434334107663291809383</span>, <span class="number">1090117073747541792795748263189869393635595289682444585726732356599933824574908622345909231267216210206951834470495157839963988798335949836661678705960697</span>, <span class="number">6685657284087595818164753915190068685879934409072315258463222789646095024039544522635167243294747439306676127931109541703671436504324038998479410454735510</span>, <span class="number">3081817971013143842377901811479602610471065791726379727948626375189132386050379067031289551463731722240568637555525105876622277032975228495259350635961603</span>,</span><br><span class="line"><span class="number">7527577790068874896244157688824820434374562845873036315647414123459469674644499728420036444653022289097224618221708343262838243341509907332837392280607606</span>, <span class="number">12903219833816188592504821841083999004930835076092663002731204321979289494552142011690947952258526676858708529308953530978836941060082450559697065146316293</span>, <span class="number">2198565616610080020634243830034549917750482951041529281656489536841785141219855252440954587802988241603984121500632708261676889613560608370887146407895858</span>, <span class="number">3827731453472306068045050791958062181645057625114707438579450671441759582703011636443816013820165485857176842513391210353735870371767070755645538120025864</span> ]</span><br><span class="line">b2 = [ <span class="number">981527</span>, <span class="number">11519059</span>, <span class="number">9672240</span>, <span class="number">10356594</span>, <span class="number">5561848</span>, <span class="number">9422894</span>, <span class="number">16657092</span>, <span class="number">14792987</span>, <span class="number">2713471</span>, <span class="number">9879125</span>, <span class="number">14071330</span>, <span class="number">1576336</span>, <span class="number">1487926</span>, <span class="number">13135164</span>, <span class="number">4134979</span>, <span class="number">1593074</span>, <span class="number">3555191</span>, <span class="number">7304939</span>, <span class="number">15289618</span>, <span class="number">9894255</span>, <span class="number">15950778</span>, <span class="number">9459653</span>, <span class="number">1839077</span>, <span class="number">3882171</span>, <span class="number">2646805</span>, <span class="number">1871250</span>, <span class="number">2837712</span>, <span class="number">7964306</span>, <span class="number">5870823</span>, <span class="number">11468538</span>, <span class="number">12185042</span>, <span class="number">14376056</span>, <span class="number">3815630</span>, <span class="number">7553412</span>, <span class="number">954291</span>, <span class="number">9315730</span>, <span class="number">7777161</span>, <span class="number">10019167</span>, <span class="number">2747540</span>, <span class="number">927416</span>, <span class="number">6882280</span>, <span class="number">8199291</span>, <span class="number">8427358</span>, <span class="number">12316018</span>, <span class="number">5138533</span> ]</span><br><span class="line">T1 = <span class="number">2</span>^(s2+s3)</span><br><span class="line">T2 = <span class="number">2</span>^(s3)</span><br><span class="line">T3 = <span class="number">2</span>^(s3-s1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(A) == <span class="built_in">len</span>(b2)</span><br><span class="line">Aorg = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">b2org = [x <span class="keyword">for</span> x <span class="keyword">in</span> b2]</span><br><span class="line"></span><br><span class="line"><span class="comment">#Z = list(zip(Aorg, b2org))</span></span><br><span class="line"><span class="comment">#Z = list(zip(Aorg, b2org))[:ceil((m-s2)/s2)]</span></span><br><span class="line">Z = <span class="built_in">sorted</span>(<span class="built_in">list</span>(<span class="built_in">zip</span>(Aorg, b2org)), reverse=<span class="literal">True</span>)[:ceil((s1+s3)/s2)+<span class="number">5</span>]</span><br><span class="line">A = [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">b2 = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">S = <span class="number">2</span>^(m-<span class="number">1</span>) + <span class="number">2</span>^(s3-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#S = 0</span></span><br><span class="line">b2 = [T2 * x + S <span class="keyword">for</span> x <span class="keyword">in</span> b2]</span><br><span class="line">n = <span class="built_in">len</span>(A)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">bb2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> b2]</span><br><span class="line"><span class="keyword">for</span> choice <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">  A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AA]</span><br><span class="line">  b2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> bb2]</span><br><span class="line"></span><br><span class="line">  A0 = A[choice]</span><br><span class="line">  A0i = A0.inverse_mod(q)</span><br><span class="line">  b02 = b2[choice]</span><br><span class="line">  <span class="keyword">del</span> A[choice]</span><br><span class="line">  <span class="keyword">del</span> b2[choice]</span><br><span class="line">  <span class="keyword">assert</span> gcd(A0, q) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  Mt = matrix(ZZ, <span class="number">2</span>*n+<span class="number">3</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Mt[<span class="number">2</span>*i, <span class="number">2</span>*i]  = -q</span><br><span class="line">    Mt[<span class="number">2</span>*i+<span class="number">1</span>, <span class="number">2</span>*i]  = -T1</span><br><span class="line">    Mt[<span class="number">2</span>*i+<span class="number">1</span>, <span class="number">2</span>*i+<span class="number">1</span>]  = T3</span><br><span class="line">    Mt[-<span class="number">3</span>, <span class="number">2</span>*i] = A0i*A[i] % q</span><br><span class="line">    Mt[-<span class="number">2</span>, <span class="number">2</span>*i] = T1*A0i*A[i] % q</span><br><span class="line">    Mt[-<span class="number">1</span>, <span class="number">2</span>*i] = A0i*(A[i]*b02 - A0*b2[i]) % q</span><br><span class="line">  Mt[-<span class="number">3</span>, -<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">  Mt[-<span class="number">2</span>, -<span class="number">2</span>] = T3</span><br><span class="line">  R = <span class="number">2</span>^(s3-<span class="number">1</span>)</span><br><span class="line">  Mt[-<span class="number">1</span>, -<span class="number">1</span>] = R</span><br><span class="line">  <span class="comment">#matrix_overview(Mt)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#L = Mt.BKZ(block_size=Mt.rank())</span></span><br><span class="line">  L = Mt.BKZ(block_size=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> l[-<span class="number">1</span>] == R <span class="keyword">and</span> l[-<span class="number">2</span>]%T3 == <span class="number">0</span> <span class="keyword">and</span> l[-<span class="number">4</span>]%T3 == <span class="number">0</span>:</span><br><span class="line">      b0 = vector(l)</span><br><span class="line"></span><br><span class="line">      b01 = b0[-<span class="number">2</span>] // T3</span><br><span class="line">      b03 = b0[-<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">      x0 = (T1*b01 + b02 + b03) * A0i % q</span><br><span class="line"></span><br><span class="line">      test1 = [bi <span class="keyword">for</span> bi <span class="keyword">in</span> b2org] </span><br><span class="line">      test2 = [((ai*x0 % q) &gt;&gt; s3) % (<span class="number">1</span>&lt;&lt;s2) <span class="keyword">for</span> ai <span class="keyword">in</span> Aorg]</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(A0, x0)</span><br><span class="line">      <span class="built_in">print</span>([test1[x]-test2[x] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test1))])</span><br><span class="line">      <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> test1 == test2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get: %d&#x27;</span> % x0)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 11175003251502357065368374725827220048766874529296813908783514847111854792422701846999086919622254945359048568224138155336743512330734172901570038320078871117500325150235706536837472582722004876687452929681390878351484711185479242270184699908691962225494535904856822413815533674351233073417290157003832007887</span></span><br></pre></td></tr></table></figure>



<h1 id="Level4"><a href="#Level4" class="headerlink" title="Level4"></a>Level4</h1><blockquote>
<p>分为5个部分</p>
</blockquote>
<p>$n &#x3D; 30$，$m &#x3D; 512$，$q是mbit$的素数，$\beta_i$切成了5段，情况如下：<br>$$<br>\beta_i &#x3D; b_{i,1}(s_1\quad bit)\quad ||\quad b_{i,2}(s_2\quad bit)\quad ||\quad b_{i,3}(s_3\quad bit)\quad || \quad b_{i,4}(s_4 \quad bit) \quad || b_{i,5}(s_5 \quad bit)<br>$$<br>知道每组的$b_{i,2}$和$b_{i,4}$，其中$s_1&#x3D;s_3&#x3D;s_5&#x3D;154$，$s_2&#x3D;s_4&#x3D;25$。</p>
<p>令$s_{135}&#x3D;154$、$s_{24} &#x3D; 25$，再令<br>$$<br>T_1 &#x3D; 2^{s_2+s_3+s_4+s_5} &#x3D; 2^{2s_{135}+2s_{24}}<br>$$</p>
<p>$$<br>T_2&#x3D;2^{s_3+s_4+s_5} &#x3D; 2^{2s_{135}+s_{24}}<br>$$</p>
<p>$$<br>T_3 &#x3D; 2^{s_4+s_5} &#x3D; 2^{s_{135}+s_{24}}<br>$$</p>
<p>$$<br>T_4 &#x3D; 2^{s_5}<br>$$</p>
<p>问题即表述为：<br>$$<br>A_ix \equiv T_1b_{i,1} + T_2b_{i,2}+ T_3b{i,3}+T_4b_{i,4}+b_{i,5}<br>$$<br>还是消去x</p>
<p>得到$A_0^{-1}(T_2(A_ib_{0,2}-A_0b_{i,2})+T_4(A_ib_{0,4}-A_0b_{i,4}))+(T_1A_0^{-1}A_i)b_{0,1}-T_1b_{i,1}+(T_3A_0^{-1}A_i)b_{0,3}-T_3b_{i,3}+(A_0^{-1}A_i)b_{0,5} \equiv b_{i,5} \mod q$</p>
<p>令<br>$$<br>D_i \equiv A_0^{-1}(T_2(A_ib_{0,2}-A_0b_{i,2})+T_4(A_ib_{0,4}-A_0b_{i,4}))\mod q<br>$$</p>
<p>$$<br>E_i \equiv T_1A_0^{-1}A_i \mod q<br>$$</p>
<p>$$<br>F_i \equiv T_3A_0^{-1}A_i \mod q<br>$$</p>
<p>$$<br>G_i \equiv A_0^{-1}A_i \mod q<br>$$</p>
<p>最后化简为$b_{i,5} &#x3D; D_i -T_3b_{i,3}-T_1b_{i,1} +E_ib_{0,1}+F_ib_{0,3}+G_ib_{0,5}-k_iq$</p>
<p>构造格<br>$$<br>\begin{pmatrix}<br>k_1 &amp; b_{1,3} &amp; b_{1,1} &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; k_{n-1}<br>\end{pmatrix}<br>$$</p>
]]></content>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux学习</title>
    <url>/2023/08/09/Linux%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<p>每天学一点点</p>
<span id="more"></span>

<h1 id="Linux系统的文件"><a href="#Linux系统的文件" class="headerlink" title="Linux系统的文件"></a>Linux系统的文件</h1><h2 id="Linux系统的文件目录结构"><a href="#Linux系统的文件目录结构" class="headerlink" title="Linux系统的文件目录结构"></a>Linux系统的文件目录结构</h2><p><img src="/../images/Linux/0.png"></p>
<p><strong>bin</strong>：该目录中存储的是一些二进制文件，文件都是可以被运行的</p>
<p><strong>dev</strong>：该目录中存放的都是一些外接设备，例如盘，其他的光盘等。在其中的外接设备是不能直接被使用的，需要<strong>挂载(类似windows下的分配盘符)</strong></p>
<p><strong>etc</strong>：存储一些配置文件</p>
<p><strong>home</strong>：表示除了<strong>root用户以外其他用户的目录</strong>，类似于windows下的User目录</p>
<p><strong>proc</strong>：process，表示进程，该目录中存储的是Linux运行时候的进程。</p>
<p><strong>root</strong>：该目录是root用户自己的家目录</p>
<p><strong>sbin：</strong>全称super binary，该目录也是存储一些可以被执行的二进制文件，但是必须得有super权限的用户才能执行。</p>
<p><strong>tmp：</strong>表示“临时”的，当系统运行时候产生的临时文件会在这个目录存着。</p>
<p><strong>usr：</strong>存放的是用户自己安装的软件。类似于windows下的program files。</p>
<p><strong>var：</strong>存放的程序&#x2F;系统的日志文件的目录。 </p>
<p><strong>Mnt</strong>：当外接设备需要挂载的时候，就需要挂载到mnt目录下。</p>
<h2 id="Linux的文件类型"><a href="#Linux的文件类型" class="headerlink" title="Linux的文件类型"></a>Linux的文件类型</h2><h3 id="1-普通文件"><a href="#1-普通文件" class="headerlink" title="1.普通文件"></a>1.普通文件</h3><p>Linux中最多的一种文件类型, 包括 纯文本文件(ASCII)，二进制文件(binary)，数据格式的文件(data)，各种压缩文件。第一个属性为 [-]</p>
<h3 id="2-目录文件"><a href="#2-目录文件" class="headerlink" title="2.目录文件"></a>2.目录文件</h3><p>就是目录， 能用 cd 命令进入的。第一个属性为 [d]，例如 [drwxrwxrw]</p>
<h3 id="3-块设备文件"><a href="#3-块设备文件" class="headerlink" title="3.块设备文件"></a>3.块设备文件</h3><p>就是存储数据以供系统存取的接口设备，简单而言就是硬盘。例如一号硬盘的代码是 &#x2F;dev&#x2F;hda1等文件。第一个属性为 [b]</p>
<h3 id="4-字符设备"><a href="#4-字符设备" class="headerlink" title="4.字符设备"></a>4.字符设备</h3><p>字符设备文件：即串行端口的接口设备，例如键盘、鼠标等等。第一个属性为 [c]</p>
<h3 id="5-套接字文件"><a href="#5-套接字文件" class="headerlink" title="5.套接字文件"></a>5.套接字文件</h3><p>这类文件通常用在网络数据连接。可以启动一个程序来监听客户端的要求，客户端就可以通过套接字来进行数据通信。第一个属性为 [s]，最常在 &#x2F;var&#x2F;run目录中看到这种文件类型.</p>
<h3 id="6-管道文件"><a href="#6-管道文件" class="headerlink" title="6.管道文件"></a>6.管道文件</h3><p>FIFO也是一种特殊的文件类型，它主要的目的是，解决多个程序同时存取一个文件所造成的错误。FIFO是first-in-first-out(先进先出)的缩写。第一个属性为 [p]</p>
<h3 id="7-链接文件"><a href="#7-链接文件" class="headerlink" title="7.链接文件"></a>7.链接文件</h3><p>类似Windows下面的快捷方式。第一个属性为 [l]，例如 [lrwxrwxrw]</p>
]]></content>
  </entry>
  <entry>
    <title>SystemView</title>
    <url>/2023/09/25/SystemView/</url>
    <content><![CDATA[<p>起一篇博客记录一下用SystemView完成通信原理实验</p>
<span id="more"></span>

<h1 id="一、-实验目的"><a href="#一、-实验目的" class="headerlink" title="一、 实验目的"></a>一、 实验目的</h1><p>1.熟悉SystemView软件的基本功能与使用方法;</p>
<p>2.学习如何利用SystemView构建通信系统模型并进行仿真分析。</p>
<h1 id="二、实验内容"><a href="#二、实验内容" class="headerlink" title="二、实验内容"></a>二、实验内容</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>1.试用频率分别为$f_1 &#x3D; 200Hz$，$f_2 &#x3D; 2000Hz$的两个正弦信号源，合成一个调制信号$y(t) &#x3D;5sin(2\pi f_1t)\times cos(2\pi f_2t)$，观察其频谱与输出信号波形。注意根据信号的频率选择适当的系统采样速率。</p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>2.将一正弦信号与高斯噪声相加后观察输出波形及其频谱。由小到大改变高斯噪声的功率，重新观察输出波形及其频谱。</p>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><p>3.双音多频信号（DTMF），电话系统中电话机与交换机之间的一种用户信令，通常用于发送被叫号码。双音多频信号是贝尔实验室发明的，其目的是为了自动完成长途呼叫。双音多频的拨号键盘是4×4的矩阵，每一行代表一个低频，每一列代表一个高频。每按一个键就发送一个高频和低频的正弦信号组合，比如’1’相当于697和1209赫兹(Hz)。交换机可以解码这些频率组合并确定所对应的按键。</p>
<p><img src="file:///C:\Users\WANGYU~1\AppData\Local\Temp\ksohtml19696\wps4.png" alt="img"></p>
<p><strong>试合成0~9、*、#的双音频，并使用接收图符中的单声道音频文件（8bit wav）输出，通过计算机的声卡输出声音，与实际电话输出的声音比较。注意，在输出端用加入一定的增益来放大波形。</strong></p>
<h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><p>4.在设计区放置两个信号源图符，将其中一个定义为周期正弦波，频率为$20kHz$，幅度为$5V$,相位为$45度$；另一个定义为高斯噪声，标准方差为<strong>1</strong>，均值为0。将两者通过一个加法器图符连接，同时放置一个实时接收计算器图符，并连接到加法器图符的输出，观察输出波形。</p>
<h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><p>5.试定义一个线性系统算子，将其设置为一个“Analog”类型的5极点“Butterworth”低通滤波器，截止频率为3000Hz。</p>
<h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><p>6.将题4中定义的高斯噪声通过题5定义的低通滤波器后与题4中定义的正弦波相乘，观察输出波形。</p>
<h1 id="三、实验环境"><a href="#三、实验环境" class="headerlink" title="三、实验环境"></a>三、实验环境</h1><p>Systemview仿真软件、PIV电脑</p>
<h1 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h1><h2 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h2><h3 id="电路模型"><a href="#电路模型" class="headerlink" title="电路模型"></a>电路模型</h3><p> <img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C1%E7%94%B5%E8%B7%AF.png" alt="1电路"></p>
<p> <strong>先用</strong><code>multipliter</code><strong>函数把两个波形相乘</strong>，<strong>再根据两个波形的频率</strong>$f_1&#x3D;200Hz$，$f_2&#x3D;2000Hz$，<strong>调整时钟频率为12000</strong>，最后再用<code>FFT</code>进行傅里叶变换，即可看到频谱图</p>
<h3 id="仿真结果"><a href="#仿真结果" class="headerlink" title="仿真结果"></a>仿真结果</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C1%E7%BB%93%E6%9E%9C.png" alt="1结果"></p>
<h2 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h2><h3 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h3><p>在<code>source</code>里选择高斯噪声</p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C%E4%BA%8C1.png" alt="二1"></p>
<h3 id="电路模型-1"><a href="#电路模型-1" class="headerlink" title="电路模型"></a>电路模型</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C2%E7%94%B5%E8%B7%AF.png" alt="2电路"></p>
<h3 id="仿真结果-1"><a href="#仿真结果-1" class="headerlink" title="仿真结果"></a>仿真结果</h3><h4 id="选取频率为100Hz，幅度为1的sin波形"><a href="#选取频率为100Hz，幅度为1的sin波形" class="headerlink" title="选取频率为100Hz，幅度为1的sin波形"></a>选取频率为100Hz，幅度为1的sin波形</h4><p>选择$f &#x3D; 100Hz$，幅度为1的sin图像</p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C21.png" alt="21"></p>
<h4 id="方差为0-15V噪声"><a href="#方差为0-15V噪声" class="headerlink" title="方差为0.15V噪声"></a>方差为0.15V噪声</h4><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C22.png" alt="22"></p>
<h4 id="方差为0-2V噪声"><a href="#方差为0-2V噪声" class="headerlink" title="方差为0.2V噪声"></a>方差为0.2V噪声</h4><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C23.png" alt="23"></p>
<h4 id="方差为0-4V噪声"><a href="#方差为0-4V噪声" class="headerlink" title="方差为0.4V噪声"></a>方差为0.4V噪声</h4><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C24.png" alt="24"></p>
<h4 id="方差为0-6V噪声"><a href="#方差为0-6V噪声" class="headerlink" title="方差为0.6V噪声"></a>方差为0.6V噪声</h4><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C25.png" alt="25"></p>
<h4 id="方差为0-8V噪声"><a href="#方差为0-8V噪声" class="headerlink" title="方差为0.8V噪声"></a>方差为0.8V噪声</h4><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C26.png" alt="26"></p>
<h2 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h2><h3 id="操作步骤-1"><a href="#操作步骤-1" class="headerlink" title="操作步骤"></a>操作步骤</h3><p>选择两个正弦信号，调整好频率，进行相加（相加和相乘都尝试过，感觉相加生成的信号更加合适）</p>
<p>进入<code>operation</code>中的<code>Gain</code></p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C%E4%B8%891.png" alt="三1"></p>
<p>选择<code>Linear</code>扩大声音</p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C%E4%B8%892.png" alt="三2"></p>
<p><code>sink</code>中调为导出文件</p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C%E4%B8%893.png" alt="三3"></p>
<p><strong>（上面时钟可以调整音频时长），时钟频率调的是7500</strong></p>
<h3 id="电路模型-2"><a href="#电路模型-2" class="headerlink" title="电路模型"></a>电路模型</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C3%E7%94%B5%E8%B7%AF.png" alt="3电路"></p>
<h3 id="仿真结果-2"><a href="#仿真结果-2" class="headerlink" title="仿真结果"></a>仿真结果</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C3%E7%BB%93%E6%9E%9C.png" alt="3结果"></p>
<h2 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h2><p>在设计区放置两个信号源图符，将其中一个定义为周期正弦波，频率为$20kHz$，幅度为$5V$,相位为$45度$；另一个定义为高斯噪声，标准方差为<strong>1</strong>，均值为0。将两者通过一个加法器图符连接，同时放置一个实时接收计算器图符，并连接到加法器图符的输出。<strong>时钟频率调为</strong>$120000Hz$</p>
<h3 id="电路模型-3"><a href="#电路模型-3" class="headerlink" title="电路模型"></a>电路模型</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C4%E7%94%B5%E8%B7%AF.png" alt="4电路"></p>
<h3 id="仿真结果-3"><a href="#仿真结果-3" class="headerlink" title="仿真结果"></a>仿真结果</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C4%E7%BB%93%E6%9E%9C.png" alt="4结果"></p>
<h2 id="5-1"><a href="#5-1" class="headerlink" title="5"></a>5</h2><h3 id="操作步骤-2"><a href="#操作步骤-2" class="headerlink" title="操作步骤"></a>操作步骤</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C%E5%85%AD1.png" alt="六1"></p>
<p>然后选<code>Analog</code></p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C51.png" alt="51"></p>
<p>进入<code>Analog</code>后选择<code>Butterworth</code>（巴特沃斯滤波器）</p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C52.png" alt="52"></p>
<p>进入到<code>Butterworth</code>之后，把<code>No.of Poles</code>改成5，即<strong>5极点</strong>，再把<code>Low Cuttoff</code>改成$3000$，即截止频率。</p>
<p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C53.png" alt="53"></p>
<h2 id="6-1"><a href="#6-1" class="headerlink" title="6"></a>6</h2><h3 id="电路模型-4"><a href="#电路模型-4" class="headerlink" title="电路模型"></a>电路模型</h3><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C6%E7%94%B5%E8%B7%AF.png" alt="6电路"></p>
<h3 id="仿真结果-4"><a href="#仿真结果-4" class="headerlink" title="仿真结果"></a>仿真结果</h3><p><img src="/../images/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C6%E7%BB%93%E6%9E%9C.png" alt="6结果"></p>
<h1 id="五、实验结果与讨论"><a href="#五、实验结果与讨论" class="headerlink" title="五、实验结果与讨论"></a>五、实验结果与讨论</h1><h2 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h2><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C1%E7%BB%93%E6%9E%9C.png" alt="1结果"></p>
<h2 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h2><p>看前面</p>
<h2 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h2><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C3%E7%BB%93%E6%9E%9C.png" alt="3结果"></p>
<h2 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h2><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C4%E7%BB%93%E6%9E%9C.png" alt="4结果"></p>
<h2 id="5-2"><a href="#5-2" class="headerlink" title="5"></a>5</h2><h2 id="6-2"><a href="#6-2" class="headerlink" title="6"></a>6</h2><p><img src="/../images%5C%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9%5C6%E7%BB%93%E6%9E%9C.png" alt="6结果"></p>
<h1 id="六、总结"><a href="#六、总结" class="headerlink" title="六、总结"></a>六、总结</h1><p> 在第三个实验中，尝试了把两个波源进行相乘，相加。发现相加更加合适，多尝试。</p>
]]></content>
      <tags>
        <tag>杂</tag>
      </tags>
  </entry>
  <entry>
    <title>初识格</title>
    <url>/2023/07/28/%E5%88%9D%E8%AF%86%E6%A0%BC/</url>
    <content><![CDATA[<p>记录笔者学习Lattice的过程，好记忆不如烂笔头</p>
<span id="more"></span>

<h1 id="格的定义"><a href="#格的定义" class="headerlink" title="格的定义"></a>格的定义</h1><p>给定$n$维空间中$n$个线性无关向量：$\vec{b_1},\vec{b_2},…,\vec{b_n}$，并把这$n$个向量称为基</p>
<p>对于这一组向量，存在线性组合$x_1\vec{b_1}+x_2\vec{b_2}+\dots+x_n\vec{b_n}$</p>
<p>我们把整系数的线性组合构成的集合称为格即$x_i \in \mathbb{Z}$<br>$$<br>记为\mathcal{L}(B) &#x3D;<br>\begin{Bmatrix}<br>x_1\vec{b_1}+x_2\vec{b_2} + …+x_n\vec{b_n} ,x_i \in \mathbb{Z}<br>\end{Bmatrix}<br>$$</p>
<p>举个例子</p>
<p><img src="/../images/Lattice/0.png"></p>
<p>上图为2维空间中的一个格，这个格的基为$(0,1)和(1,0)$</p>
<p><strong>需要注意的是，不同的基有可能生成同样的格。</strong></p>
<p>同样是这个二维空间的格，我们可以用下面这个基构成</p>
<p><img src="/../images/Lattice/1.png"></p>
<p><strong>这组基为</strong>$(1,1)$和$(2,1)$</p>
<p>这里提出一个问题，<strong>什么样的基可以生成同样的格？</strong>即格基的等价变换问题</p>
<h1 id="格基的等价变换"><a href="#格基的等价变换" class="headerlink" title="格基的等价变换"></a>格基的等价变换</h1><ol>
<li>$\color{red}列向量交换$，即$\vec{b_i}\longleftrightarrow \vec{b_j}$</li>
</ol>
<p>这里给出二维空间中的例子</p>
<p><strong>上述格基$\vec{b_1} &#x3D;(0,1),\vec{b_2}&#x3D;(1,0)$，现在令二者交换，即$\vec{b_1} &#x3D;(1,0),\vec{b_2}&#x3D;(0,1)$</strong></p>
<p>显而易见，两组格基产生的格是一样的</p>
<ol start="2">
<li>$\color{red}向量取反$，即$\vec{b_i} \longleftrightarrow {-\vec{b_i}}$</li>
</ol>
<p>还是上述例子，$\vec{b_1} &#x3D; (0,1)$，现在令$\vec{b_1}’ &#x3D; -\vec{b_1} &#x3D; (0,-1)$</p>
<p>显而易见，变换之后的基产生的格是一样的</p>
<ol start="3">
<li>$\color{red}整系数线性组合$，即$\vec{b_i} \longleftrightarrow \vec{b_i} + k \vec{b_j}$</li>
</ol>
<p>对于上述基$\vec{b_1}&#x3D;(0,1),\vec{b_2}&#x3D;(1,0)$构成的格中</p>
<p>取格点$(4,3)$</p>
<p>现将$\vec{b_1} \longleftrightarrow \vec{b_1}+2\vec{b_2}$，即新的格基为$\vec{b_1}’&#x3D;(2,1),\vec{b_2}’&#x3D;(1,0)$</p>
<p>则格点$(3,4)$对于新的格基有了新的线性组合$(3,4)&#x3D;3\vec{b_1}’-2\vec{b_2}’$</p>
<p>但还是在这个新基的产生的格点上</p>
<p><strong>上述3个方法可以概括为格基矩阵B右乘一个幺模矩阵U(行列式为</strong>$±1$<strong>的矩阵)</strong></p>
<p>对于上述例子有下式</p>
<p><img src="/../images/Lattice/2.png"></p>
<p>且$||U||&#x3D;1$</p>
<p>$\therefore$格基$B$和格基$B’$等价</p>
<p>由此我们可以得到结论</p>
<h1 id="两个格基产生相同格的条件"><a href="#两个格基产生相同格的条件" class="headerlink" title="两个格基产生相同格的条件"></a>两个格基产生相同格的条件</h1><p>如果格基矩阵$B_1,B_2$满足$B_2&#x3D;B_1U$，则两格基产生的格一样</p>
<h1 id="格的基本区域"><a href="#格的基本区域" class="headerlink" title="格的基本区域"></a>格的基本区域</h1><p><strong>给定格基B产生的格</strong>，<strong>我们可以确定基础平行多面体</strong>，设为P(B)，$P(B) &#x3D;<br>\begin{Bmatrix}<br>a_1\vec{b_1}+a_2\vec{b_2} + … +a_n\vec{b_n}\quad |(0 \le a_i &lt;1)<br>\end{Bmatrix}$</p>
<p>可以理解为最小重复单元</p>
<p>下面给出二维空间中某个格的基本区域</p>
<p><img src="/../images/Lattice/3.png"></p>
<p><strong>上图中，红色区域就是这个格的基本区域</strong></p>
<p>当我们把基本区域放到的每个格点中，则会遍布这个二维空间</p>
<p><strong>基本区域有什么用呢？</strong></p>
<p>我们发现，当在格中随便取一点$k$，我们都可以把他映射到基本区域中的某个点中</p>
<p>例如$k(3.5,2.4)$，其映射在基本区域的点就是$k’(0.5,0.4)$</p>
<p><img src="/../images/Lattice/4.png"></p>
<p>映射后：</p>
<p><img src="/../images/Lattice/5.png"></p>
<p>上面的操作可归纳为：<br>$$<br>k &#x3D; m_1\vec{b_1}+m_2\vec{b_2}+…+m_n\vec{b_n}<br>$$<br>映射:<br>$$<br>k’ &#x3D; (m_1 \mod 1)\vec{b_1}+(m_2 \mod 1)\vec{b_2} +…+(m_n \mod 1)\vec{b_n}<br>$$</p>
<p><strong>除此之外，我们可以发现，在一个基本区域中，不存在两个等价的点</strong></p>
<h1 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h1><p>格的行列式指的是基本区域的体积</p>
<p>由上面格基产生相同格的条件，我们可以推断出<strong>他们的行列式相同</strong></p>
<p>$\because B_2 &#x3D; B_1U$</p>
<p>$\therefore det(B_2)&#x3D;det(B_1)det(U)&#x3D;det(B_1)$</p>
<p><strong>行列式越小，格点的密度越大</strong></p>
<h1 id="延展空间"><a href="#延展空间" class="headerlink" title="延展空间"></a>延展空间</h1><p>我们称格$\mathcal{L}(B)$中基向量的所有线性组合所形成的集合为这组基向量所张成的延展空间(span)</p>
<p>即$span(\mathcal{L}(B)) &#x3D;<br>span(B)&#x3D;<br>\begin{Bmatrix}<br>a_1\vec{b_1}+a_2\vec{b_2}+…+a_n\vec{b_n}|a_i\in \mathbb{R}<br>\end{Bmatrix}$</p>
<h1 id="Successive-Minima-连续极小"><a href="#Successive-Minima-连续极小" class="headerlink" title="Successive Minima(连续极小)"></a>Successive Minima(连续极小)</h1><p><strong>由于格上的点是离散的，所以除了零向量外肯定存在一个非零向量，其长度是最短的。</strong></p>
<p>我们定义$\lambda_1(\mathcal{L})$为格$\mathcal{L}$中最短非零向量的长度**(这里不考虑零向量)**</p>
<p>这里的长度指的是欧几里得范数</p>
<p>准确的说，应该是最短非零向量集，因为有一个最短非零向量就有两个(这个向量取反)</p>
<p>因此，在$n$维格中，我们有$2n$个最短向量，每个轴上都有两个最短向量</p>
<p><strong>给个二维空间中的例子来理解</strong></p>
<p><img src="/../images/Lattice/6.png"></p>
<h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>在格$\mathcal{L}$中，第$i$连续极小值$(i&#x3D;1,2,\dots,n)$，为$\lambda_i&#x3D;min{r:dim \enspace span(\mathcal{B}(r))\cap \mathcal{L}\ge i}$</p>
<p>定义是比较抽象的</p>
<p>在定义中，$\mathcal{B}(r)$表示半径为$r$的超球体,该超球体和格$\mathcal{\mathcal{L}}$交集产生的向量张成(span)的空间的维度(dim)为i</p>
<p>换言之,第i个连续极小值即包含至少i个线性无关格向量的最小球半径</p>
<p><strong>以下图为例</strong></p>
<p><img src="/../images/Lattice/7.png"></p>
<p><strong>把球的中心放在原点，若球中有非零格向量，那么球中不止一个格向量。以上图为例，红色区域包含了一个非零格向量以及它的逆向量，但这二者在同一条直线上，仅张成一维空间，该超球体的半径是$\lambda_1$</strong></p>
<p><strong>而下图中，一个更大的超球体包含了4个非零格向量，可以张成二维空间，该超球体的半径是$\lambda_2$</strong> </p>
<p><img src="/../images/Lattice/8.png"></p>
<p>对这个概念模糊不清</p>
<p><strong>重点是要知道$\lambda_1(\mathcal{L})$指的是格$\mathcal{L}$最短非零向量的长度</strong></p>
<p><strong>施密特正交化给出格中最短非零向量长度的有效下界</strong></p>
<h1 id="施密特正交化"><a href="#施密特正交化" class="headerlink" title="施密特正交化"></a>施密特正交化</h1><p>其作用是把一组基转换成一组正交基。学了线性代数这门课的话理解起来并不难。</p>
<p>这里给出二维空间中的一个例子：</p>
<p><img src="/../images/Lattice/9.png"></p>
<p><strong>如图，把原来一组基</strong>$\vec{b_1},\vec{b_2}$<strong>，转换成</strong>$\widetilde{b}_1,\widetilde{b}_2$<strong>这一组正交基</strong></p>
<p>过程如下</p>
<p>首先,给定一组线性无关的向量$\vec{b_1},\vec{b_2},…,\vec{b_n}$</p>
<p>然后通过计算得到一组正交基$\widetilde{b}_1,\widetilde{b}_2,…,\widetilde{b}_n$</p>
<p><img src="/../images/Lattice/10.png"></p>
<p>$&lt;\vec{b_i},\vec{b_j}&gt;$表示$\vec{b_i}$与$\vec{b_j}$的内积</p>
<p>我们令$\mu_{i,j}&#x3D;\frac{&lt;\vec{b_i},\widetilde{b}_j&gt;}{&lt;\widetilde{b}_j,\widetilde{b}_j&gt;}$</p>
<p>则正交化向量可表示为</p>
<p><img src="/../images/Lattice/11.png"></p>
<p>书上的解释（虽然有些杂乱，也可参考参考）：</p>
<p><img src="/../images/Lattice/0.jpg"></p>
<p><strong>值得一提的是，施密特正交化能将基正交化，但并不能直接应用于格基，因为正交化过程中系数并没限制为整数，也就是 格基 施密特正交化后的结果很可能不在格上</strong></p>
<p>下面讲施密特正交化的应用</p>
<h2 id="QR分解"><a href="#QR分解" class="headerlink" title="QR分解"></a>QR分解</h2><p>对于格而言，先对格基$\vec{b_1},\vec{b_2},…,\vec{b_n}$间接使用施密特正交化 ($\color{red}施密特正交化过程中,没有保证系数都是整数,我们需要对其取整$)</p>
<p>之后我们能得到<strong>近似正交基</strong>$\widetilde{b}_1,\widetilde{b}_2,…,\widetilde{b}_n$</p>
<p>把他写成矩阵形式为</p>
<p><img src="/../images/Lattice/13.png"></p>
<p>本质上，QR分解形式的矩阵是格基的另一种矩阵表示法，上图中每个列向量都是格基</p>
<p><strong>结论如下</strong></p>
<ol>
<li>该矩阵是上三角行列式所以行列式$det(B) &#x3D; \prod_{i&#x3D;1}^{n}||\widetilde{b}_i||$</li>
<li>我们能得到$\lambda_1$的下界，即$\lambda_1\ge min(||\widetilde{b}_i||)$</li>
</ol>
<p>我的理解是，既然得到了近似正交基，那我把$min(||\widetilde{b}_i||)$这个基之外的基全部取0，是不是就能得到$\lambda_1$了</p>
<p>更严谨的证明：</p>
<p><img src="/../images/Lattice/12.png"></p>
<p>看不懂证明就这样吧，总之我们得到了$\lambda_1$的下界</p>
<h1 id="格中难题"><a href="#格中难题" class="headerlink" title="格中难题"></a>格中难题</h1><h2 id="SVP最短向量问题-Shortest-Vector-Problem"><a href="#SVP最短向量问题-Shortest-Vector-Problem" class="headerlink" title="SVP最短向量问题(Shortest Vector Problem)"></a>SVP最短向量问题(Shortest Vector Problem)</h2><p>SVP，最短向量问题，准确的说是最短非零向量问题。定义如下</p>
<p><strong>给定一个基为$B$的格$\mathcal{L}(B)$,找到一个这个基构成的格点,使得这个点离0坐标点的距离最近</strong>，即$||Bx||\le \lambda_1$</p>
<p><strong>因为$\lambda_1$是格点之间的最短距离，所以Bx距离0点的距离并不会小于$\lambda_1$，最多等于$\lambda_1$</strong></p>
<p><strong>最短向量是存在上界的</strong></p>
<h2 id="Hermite定理"><a href="#Hermite定理" class="headerlink" title="Hermite定理"></a>Hermite定理</h2><p>这个定理给出了最短向量的上界，定理内容如下</p>
<p><strong>对于n维的格$\mathcal{L}$,都包含一个非零向量$\vec{v} \in \mathcal{L}$,满足$||\vec{v}|| \le \sqrt{n}det(\mathcal{L})^{\frac{1}{n}}$</strong></p>
<p><img src="/../images/Lattice/20.png"></p>
<p>上图中，格的基向量$B&#x3D;[b_1,b_2]$,我们找到了$Bx&#x3D;5b_1-2b_2$这个点，正好就是格的最短向量λ1</p>
<p>对于某些不太好的格来说，严格计算SVP是件很苦难的事，于是有了要求宽松一点的$SVP\gamma$问题</p>
<p><strong>定义如下：</strong></p>
<p>给定一个基为B的格$\mathcal{L}(B)$,找到一个这个基构成的格点,使得这个点离0坐标点的距离$\le \gamma\lambda_1$</p>
<p>$||Bx|| \le \gamma \lambda_1$</p>
<p><img src="/../images/Lattice/15.png"><br>$$<br>如图所示，当\gamma&#x3D;2时，SVP_\gamma问题有了很多解<br>$$</p>
<h2 id="CVP最近向量问题-Closest-Vector-Problem"><a href="#CVP最近向量问题-Closest-Vector-Problem" class="headerlink" title="CVP最近向量问题(Closest Vector Problem)"></a>CVP最近向量问题(Closest Vector Problem)</h2><p>定义如下：</p>
<p><strong>给定连续空间中任意的一个点t，找到距离这个点最近的格点Bx，满足$||Bx-t|| \le \mu$</strong></p>
<p><img src="/../images/Lattice/16.png"></p>
<p>这里我们的约束距离$\mu$就是这个Lattice的覆盖半径(即所有可能的t中距离格点最长的距离)。</p>
<p>同理我们有要求宽松点的$CVP\gamma$问题</p>
<p><strong>定义如下：</strong><br>$$<br>||Bx-t|| \le \gamma\mu<br>$$<br><img src="/../images/Lattice/17.png"><br>$$<br>这个图很好表示了当\gamma&#x3D;2的情况下，我们找到了更多满足CVP的点<br>$$<br>加上一个宽松的参数$\gamma$之后，CVP问题就会变得简单一些，解的数量也变多了。</p>
<h2 id="SIVP最短独立向量问题-Shortest-Independent-Vector-Problem"><a href="#SIVP最短独立向量问题-Shortest-Independent-Vector-Problem" class="headerlink" title="SIVP最短独立向量问题(Shortest Independent Vector Problem)"></a>SIVP最短独立向量问题(Shortest Independent Vector Problem)</h2><p><strong>定义如下</strong><br>$$<br>给定一个格\mathcal{L}(B),找到n个线性独立的向量Bx_1,Bx_2,…Bx_n并且这些向量的长度都要小于等于最长的最短向量<br>$$</p>
<p>$$<br>max||Bx_i|| \le \lambda_n<br>$$</p>
<p><img src="/../images/Lattice/18.png"><br>$$<br>这个图很好表达了当n&#x3D;2的情况下，我们找到了两个小于等于\lambda_2的点<br>$$</p>
<p>$$<br>同理,我们有SIVP_\gamma问题<br>$$</p>
<p>$$<br>在SIVP_\gamma问题中,我们只需要找到\gamma \lambda_n范围中的格点即可<br>$$</p>
<p><img src="/../images/Lattice/19.png"></p>
<h1 id="LLL算法"><a href="#LLL算法" class="headerlink" title="LLL算法"></a>LLL算法</h1><p><strong>首先，我们知道一个格可能有很多基，这些基里面，肯定有好坏之分</strong></p>
<p><img src="/../images/Lattice/22.png"></p>
<p>比如上图中，蓝色的基明显就比绿色的基好。</p>
<p>这是因为</p>
<ol>
<li><strong>蓝色的基向量更短</strong></li>
<li><strong>蓝色的基夹角更大，即正交性更好，这会帮助我们更好地观察格</strong></li>
</ol>
<h2 id="LLL算法的目的"><a href="#LLL算法的目的" class="headerlink" title="LLL算法的目的"></a>LLL算法的目的</h2><p><strong>在n维空间中，LLL算法要做的是让施密特正交化的程度最大化</strong></p>
<p>官方解答是，LLL算法要找一个基，使得Gram-Schmidt向量的正交程度不会下降太快</p>
<p>以下是LLL规约基的样子</p>
<p><img src="/../images/Lattice/23.png"></p>
<p>这其实就是施密特正交化的过程</p>
<p>B这个基可以写成一个正交向量构成的矩阵，乘上一个幺模矩阵</p>
<h2 id="LLL规约基拥有的性质"><a href="#LLL规约基拥有的性质" class="headerlink" title="LLL规约基拥有的性质"></a>LLL规约基拥有的性质</h2><ol>
<li><p>所有$|\mu_{i,j}|\le \frac{1}{2}$</p>
</li>
<li><p>向量长度满足这样关系:</p>
<p><img src="/../images/Lattice/27.png"></p>
</li>
</ol>
<p>性质2大概的意思就是得到的向量不能太短</p>
<p>两个性质综合起来的结论是$||\widetilde{b}_{i+1}||^2 \ge \frac{1}{2}||\widetilde{b}_i||^2$</p>
<p><strong>这就是LLL算法？？？？？？？？？？？？？对此我十分疑惑</strong></p>
<p><img src="/../images/Lattice/24.png"><br>$$<br>我们有一个基B，用b_1,b_2,\dots,b_n表示，写成列向量的形式即得到等号左边的矩阵。<br>$$</p>
<p>$$<br>中间的是施密特正交基,用\widetilde{b}_1,\widetilde{b}_2,\dots,\widetilde{b}_n表示<br>$$</p>
<p>需要在正交基乘上右边的矩阵才能得到B</p>
<h3 id="如何让这些u都小于0-5？"><a href="#如何让这些u都小于0-5？" class="headerlink" title="如何让这些u都小于0.5？"></a>如何让这些u都小于0.5？</h3><p>只要把每一列多次减去第一列就可以满足</p>
<h3 id="如何保证向量不会减小得太快"><a href="#如何保证向量不会减小得太快" class="headerlink" title="如何保证向量不会减小得太快"></a>如何保证向量不会减小得太快</h3><p>$$<br>如果\widetilde{b}_2和\widetilde{b}_3不符合第二个条件，会把\widetilde{b}_2和\widetilde{b}_3换一下<br>$$</p>
<p>每次交换后，我们都会更接近于得到一个更好的基</p>
<p>这里没给出证明。</p>
<p><strong>讲到这里，我还是不太明白LLL算法能给我带来什么</strong></p>
<p>一道例题讲解格密码的应用：</p>
<h1 id="入门题"><a href="#入门题" class="headerlink" title="入门题"></a>入门题</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line">p = getPrime(512)</span><br><span class="line">g = getPrime(128)</span><br><span class="line">h = gmpy2.invert(f+20192020202120222023, p) * g % p</span><br><span class="line"></span><br><span class="line">print(&#x27;h =&#x27;, h)</span><br><span class="line">print(&#x27;p =&#x27;, p)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">h = 2230300126583677861466927910427460605336142000604400796769019169330805327830058127399640469637301157563524664730082687590109425103649095203274991089542329</span><br><span class="line">p = 6950733137747588463708927295050453925761832477377823596882238234496472403054344156839969133381577140118982692621000380716326275220824006196311323447685281</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>要拿到flag,就得求出f的值</p>
<p>先令$f’ &#x3D; f+20192020202120222023$</p>
<p>已知$h \equiv f’^{-1}g (\mod p)$</p>
<p>$\therefore hf’ \equiv g (\mod p)$</p>
<p>$\therefore g &#x3D; hf’ -kp$</p>
<p>构造出</p>
<p><img src="/../images/Lattice2/0.png"></p>
<h2 id="为什么LLL算法可以得到我们需要的f’-g"><a href="#为什么LLL算法可以得到我们需要的f’-g" class="headerlink" title="为什么LLL算法可以得到我们需要的f’,g"></a>为什么LLL算法可以得到我们需要的f’,g</h2><p><strong>LLL算法可以把</strong>$(h,1),(p,0)$<strong>这组基，变成正交化程度最大的一组基，它可以求解最短向量问题</strong></p>
<p><strong>如果说</strong>$点(f’,g)$<strong>正好是最短向量，那是不是用LLL算法就可以求解出f’,g的值</strong></p>
<p><strong>为什么点</strong>$(f’,g)$<strong>是最短向量？</strong></p>
<p><strong>Hermite定理给出了最短向量的上界：</strong><br>$$<br>||\vec{v}|| \le \sqrt{n}det(\mathcal{L})^{\frac{1}{n}}<br>$$<br>对于格$\mathcal{L}$</p>
<p><img src="/../images/Lattice2/7.png"></p>
<p>其行列式$det(\mathcal{L})&#x3D;p$</p>
<p>所以最短向量$||\vec{v}|| \le \sqrt{2p}$</p>
<p>而$p$是$512bit$的，$g$是$128bit$</p>
<p>所以向量$\vec{v}&#x3D;(f’,g)$的长度$||\vec{v}||$远小于$\sqrt{2p}$的大小</p>
<p>所以可以认为我们需要求的$f’,g$就是最短向量</p>
<p>求解出$f’$后，我们便能求出f</p>
<p>构造的矩阵依赖下式</p>
<p><img src="/../images/Lattice2/1.png"></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">h = 2230300126583677861466927910427460605336142000604400796769019169330805327830058127399640469637301157563524664730082687590109425103649095203274991089542329</span><br><span class="line">p = 6950733137747588463708927295050453925761832477377823596882238234496472403054344156839969133381577140118982692621000380716326275220824006196311323447685281</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[h,1],[p,0]])</span><br><span class="line">print(Ge.LLL())</span><br><span class="line">g,f = Ge.LLL()[0]</span><br><span class="line">g,f = abs(g),abs(f)</span><br><span class="line"></span><br><span class="line">print(libnum.n2s(int(f-20192020202120222023)))</span><br></pre></td></tr></table></figure>

<p>值得注意的是，当我们把中间的已知矩阵进行乘法以后，输出的结果也会有所不同。</p>
<p><strong>例如，我把中间向量修改为</strong></p>
<p><img src="/../images/Lattice2/12.png"></p>
<p><strong>输出的值是原来g的10倍</strong><br>$$<br>\because f’×10h-10p×k &#x3D; 10g<br>$$<br>在一定情况下，可以先求需求量的倍数，再求需求量</p>
]]></content>
      <categories>
        <category>格密码</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>格密码入门</title>
    <url>/2023/07/29/%E6%A0%BC%E5%AF%86%E7%A0%81%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<p>初识格密码</p>
<span id="more"></span>

<p>做题关键，构造出下列矩阵乘法<br>$$<br>v·M&#x3D;\overrightarrow{w}<br>$$</p>
<p>$$<br>v:未知量矩阵<br>$$</p>
<p>$$<br>M:已知量矩阵<br>$$</p>
<p>$$<br>\overrightarrow{w}:目标向量，即要求的值<br>$$</p>
<p><strong>需要注意的是，因为LLL算法是一步一步约减的，所以目标向量一定要比原来已知矩阵小</strong></p>
<p>根据$Hermite$定理，我们所求的目标向量一定要满足SVP的范围</p>
<h1 id="NTRU有关"><a href="#NTRU有关" class="headerlink" title="NTRU有关"></a>NTRU有关</h1><h2 id="入门题"><a href="#入门题" class="headerlink" title="入门题"></a>入门题</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">f = bytes_to_long(flag)</span><br><span class="line">p = getPrime(512)</span><br><span class="line">g = getPrime(128)</span><br><span class="line">h = gmpy2.invert(f+20192020202120222023, p) * g % p</span><br><span class="line"></span><br><span class="line">print(&#x27;h =&#x27;, h)</span><br><span class="line">print(&#x27;p =&#x27;, p)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">h = 2230300126583677861466927910427460605336142000604400796769019169330805327830058127399640469637301157563524664730082687590109425103649095203274991089542329</span><br><span class="line">p = 6950733137747588463708927295050453925761832477377823596882238234496472403054344156839969133381577140118982692621000380716326275220824006196311323447685281</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>$$<br>要拿到flag,就得求出f的值<br>$$</p>
<p>$$<br>先令f’ &#x3D; f+20192020202120222023<br>$$</p>
<p>$$<br>已知h \equiv f’^{-1}g (\mod p)<br>$$</p>
<p>$$<br>\therefore hf’ \equiv g (\mod p)<br>$$</p>
<p>$$<br>\therefore g &#x3D; hf’ -kp<br>$$</p>
<p>构造出</p>
<p><img src="/../images/Lattice2/0.png"></p>
<p><strong>LLL算法可以把</strong>$(h,1),(p,0)$<strong>这组基，变成正交化程度最大的一组基</strong></p>
<p>其实际过程是把向量$(h,1),(p,0)$做线性组合，最后的结果就是$x_1(h,1)+x_2(p,0)&#x3D;(x_1h+x_2p,x_1+0)$</p>
<p>当$x_1&#x3D;f’,x_2&#x3D;-k$的时候，就是我们要的结果</p>
<h3 id="为什么LLL算法的结果就是我们要的值？"><a href="#为什么LLL算法的结果就是我们要的值？" class="headerlink" title="为什么LLL算法的结果就是我们要的值？"></a>为什么LLL算法的结果就是我们要的值？</h3><p>LLL算法是求解SVP问题的，我们要求的向量$\vec{v} &#x3D; (f’,g)$满足$||\vec{v}||\le \sqrt{2}det(\mathcal{L})$</p>
<p>其中，$\mathcal{L}$是$(h,1),(p,0)$构成的矩阵，其行列式为$p$</p>
<p>求解出$f’$后，我们便能求出$f$</p>
<p>构造的矩阵依赖下式</p>
<p><img src="/../images/Lattice2/1.png"></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">h = 2230300126583677861466927910427460605336142000604400796769019169330805327830058127399640469637301157563524664730082687590109425103649095203274991089542329</span><br><span class="line">p = 6950733137747588463708927295050453925761832477377823596882238234496472403054344156839969133381577140118982692621000380716326275220824006196311323447685281</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[1,h],[0,p]])</span><br><span class="line">print(Ge.LLL())</span><br><span class="line">f,g = Ge.LLL()[0]</span><br><span class="line">f,g = abs(f),abs(g)</span><br><span class="line"></span><br><span class="line">print(libnum.n2s(int(f-20192020202120222023)))</span><br></pre></td></tr></table></figure>

<h2 id="NSSCTF-HNCTF-2022-WEEK2-——littleLattice"><a href="#NSSCTF-HNCTF-2022-WEEK2-——littleLattice" class="headerlink" title="NSSCTF [HNCTF 2022 WEEK2] ——littleLattice"></a>NSSCTF [HNCTF 2022 WEEK2] ——littleLattice</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from hashlib import *</span><br><span class="line"></span><br><span class="line">p = getPrime(2048)</span><br><span class="line">f = getPrime(1024)</span><br><span class="line">g = getPrime(768)</span><br><span class="line">h = pow(f,-1,p)*g%p</span><br><span class="line">verify = sha256(bytes.fromhex(hex(f+g)[2:])).hexdigest()</span><br><span class="line">print(f&#x27;verify = &#123;verify&#125;&#x27;)</span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;h = &#123;h&#125;&#x27;)</span><br><span class="line">print(&#x27;NSSCTF&#123;&#x27; + md5(bytes.fromhex(hex(f+g)[2:])).hexdigest() + &#x27;&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">verify = 24425b693dbcace08a32572d499a5cbeb36e30db9278704195c67c3d32a81bdf</span><br><span class="line">p = 29908110980126088961686288727545150169450107297750996656924523214377817308111189721234667959695817050736874247951762130190209278324144437406652857446810518839546701950883392761869656586963587376306050382973323860395932741791372333809871487575268245618618143456971257992301722141464238875859134379745122404533776003095129169004284619647906206323263396219776072091827094295366090100037898314156271404760715453914459484087562963158208356228410105170495322276351631637885450926240143055767142216931354736779666836018983658010126520397012025067407223630891975504746697630878807952266767406899527721170062789607980517722293</span><br><span class="line">h = 26523576589113781532769165293024254940419790396713708680496148398686334583553504180195363282085884580924842673123375450894537445679687851322807762432476357713740302064160599132450619363411158141423252170448770929403179895813409897048848337375715079396639330537231353596884530617911351334318435031007342479134081403319324838464987064025256038807217697133175585927493402963025439540077915248356077623612217525231722274634984400273765262532561558296870531741633238736650375250957780701118781183335729715295271752736307479795186963108377228330313771245434127095507278278768792281414702334956407755841000748255424212840137</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>$$<br>我们已知h \equiv  f^{-1}×g (\mod p)<br>$$</p>
<p>$$<br>\therefore hf \equiv g (\mod p)<br>$$</p>
<p>$$<br>g &#x3D; hf-kp<br>$$</p>
<p>$$<br>要求flag,我们要求出f,g<br>$$</p>
<p>$$<br>我们的目标量就是f,g了<br>$$</p>
<p><img src="/../images/Lattice2/2.png"></p>
<p>因为$g,f$的值小于已知的$h,p$，而且$||(f,g)||\approx 1024bit$的大小小于$\sqrt{2p} \approx \sqrt{2}×1024bit$</p>
<p>所以可以用LLL算法求解$g,f$<br>$$<br>构造的矩阵依赖于下式:<br>$$<br><img src="/../images/Lattice2/3.png"></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from hashlib import sha256,md5</span><br><span class="line"></span><br><span class="line">verify = &quot;24425b693dbcace08a32572d499a5cbeb36e30db9278704195c67c3d32a81bdf&quot;</span><br><span class="line">p = 29908110980126088961686288727545150169450107297750996656924523214377817308111189721234667959695817050736874247951762130190209278324144437406652857446810518839546701950883392761869656586963587376306050382973323860395932741791372333809871487575268245618618143456971257992301722141464238875859134379745122404533776003095129169004284619647906206323263396219776072091827094295366090100037898314156271404760715453914459484087562963158208356228410105170495322276351631637885450926240143055767142216931354736779666836018983658010126520397012025067407223630891975504746697630878807952266767406899527721170062789607980517722293</span><br><span class="line">h = 26523576589113781532769165293024254940419790396713708680496148398686334583553504180195363282085884580924842673123375450894537445679687851322807762432476357713740302064160599132450619363411158141423252170448770929403179895813409897048848337375715079396639330537231353596884530617911351334318435031007342479134081403319324838464987064025256038807217697133175585927493402963025439540077915248356077623612217525231722274634984400273765262532561558296870531741633238736650375250957780701118781183335729715295271752736307479795186963108377228330313771245434127095507278278768792281414702334956407755841000748255424212840137</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[1,h],[0,p]])</span><br><span class="line">#print(Ge.LLL())</span><br><span class="line">f,g = Ge.LLL()[0]</span><br><span class="line">f,g = abs(f),abs(g)</span><br><span class="line"></span><br><span class="line">if sha256(bytes.fromhex(hex(f+g)[2:])).hexdigest() == verify:</span><br><span class="line">    flag = &#x27;NSSCTF&#123;&#x27; + md5(bytes.fromhex(hex(f+g)[2:])).hexdigest() + &#x27;&#125;&#x27;</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<p><code>NSSCTF&#123;884beaede45bb83d3706bcc14827dece&#125;</code></p>
<h2 id="CSDN某博主分享"><a href="#CSDN某博主分享" class="headerlink" title="CSDN某博主分享"></a>CSDN某博主分享</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"> </span><br><span class="line">p = getPrime(1024)</span><br><span class="line"> </span><br><span class="line">f = getPrime(400)</span><br><span class="line">g = getPrime(512)</span><br><span class="line">r = getPrime(400)</span><br><span class="line"> </span><br><span class="line">h = inverse(f, p) * g % p</span><br><span class="line"> </span><br><span class="line">m = b&#x27;******&#x27;</span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line"> </span><br><span class="line">c = (r*h + m) % p</span><br><span class="line"> </span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;h = &#123;h&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line"> </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p = 170990541130074930801165526479429022133700799973347532191727614846803741888876816210632483231997413973919037199883422312436314365293577997262903161076615619596783971730864586404602951191341733308807254112018161897113881363794353050758324742415299277578203838160939521046655099610387485947145087271531951477031</span><br><span class="line">h = 19027613518333504891337723135627869008620752060390603647368919831595397216728378486716291001290575802095059192000315493444659485043387076261350378464749849058547797538347059869865169867814094180939070464336693973680444770599657132264558273692580535803622882040948521678860110391309880528478220088107038861065</span><br><span class="line">c = 75639016590286995205676932417759002029770539425113355588948888258962338419567264292295302442895077764630601149285564849867773180066274580635377957966186472159256462169691456995594496690536094824570820527164224000505303071962872595619159691416247971024761571538057932032549611221598273371855762399417419551483</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>$$<br>\because c \equiv (r×f^{-1}×g +m) \mod p,这里f^{-1}是模p的逆元<br>$$</p>
<p>$$<br>\therefore fc \equiv (rg + mf) \mod p<br>$$</p>
<p>$$<br>mf \equiv (fc - rg) \mod p<br>$$</p>
<p>两边同模g，把r消去<br>$$<br>mf \equiv (fc\mod p) \mod g<br>$$</p>
<p>$$<br>m \equiv(fc\mod p) ×f^{-1}\mod g,这里f^{-1}是模g的逆元<br>$$</p>
<p><strong>这里需要注意的是</strong>$rg+mf应当小于p$,$m应当小于g$<strong>才能正确解密</strong></p>
<p>如果不满足上式的参数条件，$m$在加密过程中便有可能丢失数据</p>
<p>已知$c,p$，求出$f,g$即可求解$m$</p>
<p>构造</p>
<p><img src="/../images/Lattice2/2.png"></p>
<p>$\because \vec{v}&#x3D;(f,g) \approx 512bit &lt; \sqrt{2p} \approx \sqrt{2}×512bit$</p>
<p>依然是依赖于下式</p>
<p><img src="/../images/Lattice2/3.png"></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = 170990541130074930801165526479429022133700799973347532191727614846803741888876816210632483231997413973919037199883422312436314365293577997262903161076615619596783971730864586404602951191341733308807254112018161897113881363794353050758324742415299277578203838160939521046655099610387485947145087271531951477031</span><br><span class="line">h = 19027613518333504891337723135627869008620752060390603647368919831595397216728378486716291001290575802095059192000315493444659485043387076261350378464749849058547797538347059869865169867814094180939070464336693973680444770599657132264558273692580535803622882040948521678860110391309880528478220088107038861065</span><br><span class="line">c = 75639016590286995205676932417759002029770539425113355588948888258962338419567264292295302442895077764630601149285564849867773180066274580635377957966186472159256462169691456995594496690536094824570820527164224000505303071962872595619159691416247971024761571538057932032549611221598273371855762399417419551483</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[h,1],[p,0]])</span><br><span class="line">print(Ge.LLL())</span><br><span class="line">g,f = Ge.LLL()[0]</span><br><span class="line">g,f = abs(g),abs(f)</span><br><span class="line"></span><br><span class="line">m = ((f*c%p)*gmpy2.invert(f,g)) % g</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<p><code>NSSCTF&#123;94068324-38bb-410b-b464-e1b8baf6b358&#125;</code></p>
<h2 id="2020巅峰极客修改"><a href="#2020巅峰极客修改" class="headerlink" title="2020巅峰极客修改"></a>2020巅峰极客修改</h2><p>题目:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def generate():</span><br><span class="line">    p = getStrongPrime(2048)</span><br><span class="line">    while True:</span><br><span class="line">        f = getRandomNBitInteger(1024)</span><br><span class="line">        g = getStrongPrime(768)</span><br><span class="line">        h = gmpy2.invert(f, p) * g % p</span><br><span class="line">        return (p, f, g, h)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(plaintext, p, h):</span><br><span class="line">    m = bytes_to_long(plaintext)</span><br><span class="line">    r = getRandomNBitInteger(1024)</span><br><span class="line">    c = (r * h + m) % p</span><br><span class="line">    return c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, f, g, h = generate()</span><br><span class="line">c = encrypt(flag, p, h)</span><br><span class="line">print(&#x27;h =&#x27;, h)</span><br><span class="line">print(&#x27;p =&#x27;, p)</span><br><span class="line">print(&#x27;c =&#x27;, c)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">h = 15920807412952692847985174177588211960281948838307253586797239960508125481987882224605864406372742338485793530131031795389776531751200676051949170672004649326503467447518123006808297262753280286176914568491022298784897984879823370933511805201516939304165656461649805404345353075803763209810253831770288511818668398003443730898078080711296567200650962390927974385735100849320021423318726773493255693093044142610555698370275203822724528162516863483780170076614868308468049805668954554578089167666866242081591436319781031943877834260419842837279937368942586813623585114579680192182136454951076576180846308031147577895183</span><br><span class="line">p = 29616445112694260274774681537287299269831042656521626513009034520717072986110554689452007791622053679125813101887358792411152206641110832730768759894034995329749945245036475665938165090997263055454214551943883405059392525425764609291470545536168035201657530029849113821500078015786845062143152799634844986753056256220285729693791666273618731684193516606613125066125143895019716948226556471128531174411802630235945882713680099627033330758906060609807833477234842026397619463093836747345939002210487194276855948870859245196439206070300222410002340377429280616491741559912351526804469748340235688215655559714767093336011</span><br><span class="line">c = 24894154600738747801028572977171957374256712941786243361235711912410748252475712552938200529578615522555383736598357845901370674754857388874985225645650913059820754690696257510209172235875364336887131653254443697948965333434213242584604843844646774324930722413839123594241879178636469903372909302377061318833174246232722769872293078758804927418352848560803152544304608965368181815249876729133751310904899772060616419975025741262545479052454752165874425435226386604586446369944613258629120527951194286510228752204113015018002437399369034486123978271982779314575972603420464431960235222295086660836240988842127196837233</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>和上题一样</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">h = 15920807412952692847985174177588211960281948838307253586797239960508125481987882224605864406372742338485793530131031795389776531751200676051949170672004649326503467447518123006808297262753280286176914568491022298784897984879823370933511805201516939304165656461649805404345353075803763209810253831770288511818668398003443730898078080711296567200650962390927974385735100849320021423318726773493255693093044142610555698370275203822724528162516863483780170076614868308468049805668954554578089167666866242081591436319781031943877834260419842837279937368942586813623585114579680192182136454951076576180846308031147577895183</span><br><span class="line">p = 29616445112694260274774681537287299269831042656521626513009034520717072986110554689452007791622053679125813101887358792411152206641110832730768759894034995329749945245036475665938165090997263055454214551943883405059392525425764609291470545536168035201657530029849113821500078015786845062143152799634844986753056256220285729693791666273618731684193516606613125066125143895019716948226556471128531174411802630235945882713680099627033330758906060609807833477234842026397619463093836747345939002210487194276855948870859245196439206070300222410002340377429280616491741559912351526804469748340235688215655559714767093336011</span><br><span class="line">c = 24894154600738747801028572977171957374256712941786243361235711912410748252475712552938200529578615522555383736598357845901370674754857388874985225645650913059820754690696257510209172235875364336887131653254443697948965333434213242584604843844646774324930722413839123594241879178636469903372909302377061318833174246232722769872293078758804927418352848560803152544304608965368181815249876729133751310904899772060616419975025741262545479052454752165874425435226386604586446369944613258629120527951194286510228752204113015018002437399369034486123978271982779314575972603420464431960235222295086660836240988842127196837233</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[1,h],[0,p]])</span><br><span class="line">print(Ge.LLL())</span><br><span class="line">f,g = Ge.LLL()[0]</span><br><span class="line">f,g = abs(f),abs(g)</span><br><span class="line"></span><br><span class="line">m = ((f*c%p)*gmpy2.invert(f,g)) % g</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>



<h2 id="NSSCTF-深育杯2021-——GeGe"><a href="#NSSCTF-深育杯2021-——GeGe" class="headerlink" title="NSSCTF [深育杯2021]——GeGe"></a>NSSCTF [深育杯2021]——GeGe</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">def encrypt(plaintext):</span><br><span class="line">    p = getStrongPrime(3072) </span><br><span class="line">    m = bytes_to_long(plaintext)</span><br><span class="line">    r = getRandomNBitInteger(1024)</span><br><span class="line">    while True:</span><br><span class="line">        f = getRandomNBitInteger(1024)</span><br><span class="line">        g = getStrongPrime(768)</span><br><span class="line">        h = gmpy2.invert(f, p) * g % p</span><br><span class="line">        c = (r * h + m * f) % p</span><br><span class="line">        return (h, p, c)</span><br><span class="line"></span><br><span class="line">h, p, c = encrypt(flag)</span><br><span class="line">with open(&quot;cipher.txt&quot;, &quot;w&quot;) as f:</span><br><span class="line">    f.write(&quot;h = &quot; + str(h) + &quot;\n&quot;)</span><br><span class="line">    f.write(&quot;p = &quot; + str(p) + &quot;\n&quot;)</span><br><span class="line">    f.write(&quot;c = &quot; + str(c) + &quot;\n&quot;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">#output</span><br><span class="line">h = 3967900409518491437091166715380802161532841159072519563471354336400750930009970177101953304861954502146570721506995224520631716261108071684882841102381144720177664434981608584075201907891964214604246219441325377602163957172642582158192223452845671007585556951922415200415538060247456213608112360361636912703380306386439846269645696750929811607783895294670639202472465920599542568227657152922843001792754116981992696203788298740550812661583820191877594185184758074771316815650833195023325150218113883046328740408517222933980589974912467363367727038230703152354450353199257411964288022409128890352346036423792759938468964462267528727695183747947515480432786669353434638860350849296620606820894819933050645748656981993408399675189724419997805599649975500093890450393421897803267909569938850674774386012819838940544502656293639875120854745249463561940935651895728242282430164407574626178693654713011323376912585958110558532953333</span><br><span class="line">p = 4407206782832544188667944201727813617189883940490534227436068867901196311508151544316989531306678865408607390128649278629254128753967046691736522108356971272311308455619879297358588727267184200777923695048248757115057072357087881336680504033511958280710547178971268670442650871890760916203109226852889599638484429889898210426540567794020013920566784973281560628666918122674783539653720295629054898529900882965691587718212291373734218555167591690910246380516121338139063419587750344469214004539520017140593342859857394308703001939640899189432836134392830208318268131639318655382175643272565186884496188876341460968563623529229713790076050095498053846983536874648190033735162809614805624209827336432223553914651838063614534617044557310972056169869738746432924853953258079006936103497626054364115282007843847693813896856977882285910369660539092462408790126385881581833165309032853389777355480169212478669139225609058338565029211</span><br><span class="line">c = 4052491539376955553220568757544621659293304958837707160681090710624505862889512520190589879197831394720145909992216099963759496125523078969015706069688556356682711471641851937470179182960755800968587551608595725470945584970094036299764623894583379909329996337429067328575804567222496890803396234507278490116354758303807070775249711087938549824010697869930856205244006491475201993228121418890520174179969294094963249013786611889790711801269524919695653453576043288934196952437164829830756439734795068980207758771052483500272264363028346668629397497794792110170275173209377114274164087320163340547019935562316429227119346802124620682293405375798340275679831750482339301440428527223801872439611461272229275824994734898078664180541096159146759378804836952981089673755590353588900522455968721971944276318473421193690310601002295637581030417570868955379815661133148339565983621730401675643094909263098778572081973142223744746526672</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>$$<br>已知h \equiv f^{-1}g (\mod p)<br>$$</p>
<p>有</p>
<p><img src="/../images/Lattice2/3.png"></p>
<p>$\because \vec{v}&#x3D;(f,g) \approx 512bit &lt; \sqrt{2p} \approx \sqrt{2}×512bit$</p>
<p><img src="/../images/Lattice2/2.png"><br>$$<br>又\because c \equiv rh+mf (\mod p)<br>$$</p>
<p>$$<br>c \equiv rf^{-1}g + mf (\mod p )<br>$$</p>
<p>$$<br>fc \equiv rg+mf^2 (\mod p)<br>$$</p>
<p>$$<br>mf^2 &#x3D; (fc(\mod p))(\mod g)<br>$$</p>
<p>$$<br>m &#x3D;(fc(\mod p))×f’^{2}(\mod g),这里f’是模g的逆元<br>$$</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">h = 3967900409518491437091166715380802161532841159072519563471354336400750930009970177101953304861954502146570721506995224520631716261108071684882841102381144720177664434981608584075201907891964214604246219441325377602163957172642582158192223452845671007585556951922415200415538060247456213608112360361636912703380306386439846269645696750929811607783895294670639202472465920599542568227657152922843001792754116981992696203788298740550812661583820191877594185184758074771316815650833195023325150218113883046328740408517222933980589974912467363367727038230703152354450353199257411964288022409128890352346036423792759938468964462267528727695183747947515480432786669353434638860350849296620606820894819933050645748656981993408399675189724419997805599649975500093890450393421897803267909569938850674774386012819838940544502656293639875120854745249463561940935651895728242282430164407574626178693654713011323376912585958110558532953333</span><br><span class="line">p = 4407206782832544188667944201727813617189883940490534227436068867901196311508151544316989531306678865408607390128649278629254128753967046691736522108356971272311308455619879297358588727267184200777923695048248757115057072357087881336680504033511958280710547178971268670442650871890760916203109226852889599638484429889898210426540567794020013920566784973281560628666918122674783539653720295629054898529900882965691587718212291373734218555167591690910246380516121338139063419587750344469214004539520017140593342859857394308703001939640899189432836134392830208318268131639318655382175643272565186884496188876341460968563623529229713790076050095498053846983536874648190033735162809614805624209827336432223553914651838063614534617044557310972056169869738746432924853953258079006936103497626054364115282007843847693813896856977882285910369660539092462408790126385881581833165309032853389777355480169212478669139225609058338565029211</span><br><span class="line">c = 4052491539376955553220568757544621659293304958837707160681090710624505862889512520190589879197831394720145909992216099963759496125523078969015706069688556356682711471641851937470179182960755800968587551608595725470945584970094036299764623894583379909329996337429067328575804567222496890803396234507278490116354758303807070775249711087938549824010697869930856205244006491475201993228121418890520174179969294094963249013786611889790711801269524919695653453576043288934196952437164829830756439734795068980207758771052483500272264363028346668629397497794792110170275173209377114274164087320163340547019935562316429227119346802124620682293405375798340275679831750482339301440428527223801872439611461272229275824994734898078664180541096159146759378804836952981089673755590353588900522455968721971944276318473421193690310601002295637581030417570868955379815661133148339565983621730401675643094909263098778572081973142223744746526672</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[1,h],[0,p]])</span><br><span class="line">print(Ge.LLL())</span><br><span class="line">f,g = Ge.LLL()[0]</span><br><span class="line">f,g = abs(f),abs(g)</span><br><span class="line"></span><br><span class="line">f1 = gmpy2.invert(f,g)</span><br><span class="line">m = ((f * c % p)*f1**2)%g</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<p>上面五道题都是NTRU加密</p>
<h1 id="结合RSA"><a href="#结合RSA" class="headerlink" title="结合RSA"></a>结合RSA</h1><h2 id="羊城杯2020-LRSA"><a href="#羊城杯2020-LRSA" class="headerlink" title="羊城杯2020 LRSA"></a>羊城杯2020 LRSA</h2><p>题目:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from pwn import *</span><br><span class="line">from hashlib import sha256</span><br><span class="line">import string</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">from flag import flag</span><br><span class="line"></span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">def getPQ(p,q):</span><br><span class="line">    P=getPrime(2048)</span><br><span class="line">    Q=getPrime(2048)</span><br><span class="line">    t=(p*P-58*P+q)%Q</span><br><span class="line">    assert (isPrime(Q))</span><br><span class="line">    return P,Q,t</span><br><span class="line"></span><br><span class="line">B=getRandomNBitInteger(11)</span><br><span class="line">p=getPrime(B)</span><br><span class="line">q=getPrime(B)</span><br><span class="line">n=p*q</span><br><span class="line">e=65537</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">P,Q,t=getPQ(p,q)</span><br><span class="line"></span><br><span class="line">print(&quot;B=&quot;,B)</span><br><span class="line">print(&quot;P*P*Q=&quot;,P*P*Q)</span><br><span class="line">print(&quot;P*Q*Q=&quot;,P*Q*Q)</span><br><span class="line">print(&quot;t=&quot;,t)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"># B=1023</span><br><span class="line"># P*P*Q=17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981</span><br><span class="line"># P*Q*Q=17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909</span><br><span class="line"># t=44</span><br><span class="line"># c=4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746</span><br></pre></td></tr></table></figure>

<p>先求$PPQ,PQQ$的公因数$PQ$</p>
<p>$P &#x3D; PPQ &#x2F;&#x2F; PQ$,$Q &#x3D; PQQ &#x2F;&#x2F; PQ$<br>$$<br>\because t \equiv (p-58)P+q (\mod Q)<br>$$</p>
<p>$$<br>\therefore t-q \equiv (p-58)P (\mod Q)<br>$$</p>
<p>$$<br>\therefore t-q &#x3D; (p-58)P+kQ<br>$$</p>
<p>构造格:</p>
<p><img src="/../images/Lattice2/4.png"></p>
<p>$t$已知，随后便可求出$p,q$</p>
<p>这里事先不知道$p,q$的大小，但是最后结果出来以后，$(p-58,t-q)$的长度是非常接近$\sqrt{2Q}$的</p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">B = 1023</span><br><span class="line">PPQ = 17550772391048142376662352375650397168226219900284185133945819378595084615279414529115194246625188015626268312188291451580718399491413731583962229337205180301248556893326419027312533686033888462669675100382278716791450615542537581657011200868911872550652311318486382920999726120813916439522474691195194557657267042628374572411645371485995174777885120394234154274071083542059010253657420242098856699109476857347677270860654429688935924519805555787949683144015873225388396740487817155358042797286990338440987035608851331840925854381286767024584195081004360635842976624747610461507795755042915965483135990495921912997789567020652729777216671481467049291624343256152446367091568361258918212012737611001009003078023715854575413979603297947011959023398306612437250872299406744778763429172689675430968886613391356192380152315042387148665654062576525633130546454743040442444227245763939134967515614637300940642555367668537324892890004459521919887178391559206373513466653484926149453481758790663522317898916616435463486824881406198956479504970446076256447830689197409184703931842169195650953917594642601134810084247402051464584676932882503143409428970896718980446185114397748313655630266379123438583315809104543663538494519415242569480492899140190587129956835218417371308642212037424611690324353109931657289337536406499314388951678319136343913551598851601805737870217800009086551022197432448461112330252097447894028786035069710260561955740514091976513928307284531381150606428802334767412638213776730300093872457594524254858721551285338651364457529927871215183857169772407595348187949014442596356406144157105062291018215254440382214000573515515859668018846789551567310531570458316720877172632139481792680258388798439064221051325274383331521717987420093245521230610073103811158660291643007279940393509663374960353315388446956868294358252276964954745551655711981</span><br><span class="line">PQQ = 17632503734712698604217167790453868045296303200715867263641257955056721075502316035280716025016839471684329988600978978424661087892466132185482035374940487837109552684763339574491378951189521258328752145077889261805000262141719400516584216130899437363088936913664419705248701787497332582188063869114908628807937049986360525010012039863210179017248132893824655341728382780250878156526086594253092249935304259986328308203344932540888448163430113818706295806406535364433801544858874357459282988110371175948011077595778123265914357153104206808258347815853145593128831233094769191889153762451880396333921190835200889266000562699392602082643298040136498839726733129090381507278582253125509943696419087708429546384313035073010683709744463087794325058122495375333875728593383803489271258323466068830034394348582326189840226236821974979834541554188673335151333713605570214286605391522582123096490317734786072061052604324131559447145448500381240146742679889154145555389449773359530020107821711994953950072547113428811855524572017820861579995449831880269151834230607863568992929328355995768974532894288752369127771516710199600449849031992434777962666440682129817924824151147427747882725858977273856311911431085373396551436319200582072164015150896425482384248479071434032953021738952688256364397405939276917210952583838731888536160866721278250628482428975748118973182256529453045184370543766401320261730361611365906347736001225775255350554164449014831203472238042057456969218316231699556466298168668958678855382462970622819417830000343573014265235688391542452769592096406400900187933156352226983897249981036555748543606676736274049188713348408983072484516372145496924391146241282884948724825393087105077360952770212959517318021248639012476095670769959011548699960423508352158455979906789927951812368185987838359200354730654103428077770839008773864604836807261909</span><br><span class="line">t = 44</span><br><span class="line">c = 4364802217291010807437827526073499188746160856656033054696031258814848127341094853323797303333741617649819892633013549917144139975939225893749114460910089509552261297408649636515368831194227006310835137628421405558641056278574098849091436284763725120659865442243245486345692476515256604820175726649516152356765363753262839864657243662645981385763738120585801720865252694204286145009527172990713740098977714337038793323846801300955225503801654258983911473974238212956519721447805792992654110642511482243273775873164502478594971816554268730722314333969932527553109979814408613177186842539860073028659812891580301154746</span><br><span class="line"></span><br><span class="line">PQ = gmpy2.gcd(PPQ,PQQ)</span><br><span class="line"></span><br><span class="line">P = PPQ // PQ</span><br><span class="line">Q = PQQ // PQ</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[1,P],[0,Q]])</span><br><span class="line"></span><br><span class="line">p1 ,q1 = Ge.LLL()[0]</span><br><span class="line"></span><br><span class="line">#print(p1,q1)</span><br><span class="line">p1 = abs(p1)</span><br><span class="line"></span><br><span class="line">#print(p1,q1)</span><br><span class="line">p = p1 + 58</span><br><span class="line">q = t + q1</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(65537,(p-1)*(q-1))</span><br><span class="line">m = pow(c,d,n)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h2 id="NUSTCTF-2022-新生赛-——lattice"><a href="#NUSTCTF-2022-新生赛-——lattice" class="headerlink" title="[NUSTCTF 2022 新生赛]——lattice"></a>[NUSTCTF 2022 新生赛]——lattice</h2><p>一道简单论文题</p>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import randint</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">d = getPrime(randint(370, 390))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def enc(i):</span><br><span class="line">    print()</span><br><span class="line">    p = getPrime(512)</span><br><span class="line">    q = getPrime(512)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    e = inverse(d, phi)</span><br><span class="line">    c = pow(flag, e, n)</span><br><span class="line">    print(f&#x27;e_&#123;i&#125; =&#x27;, e)</span><br><span class="line">    print(f&#x27;n_&#123;i&#125; =&#x27;, n)</span><br><span class="line">    print(f&#x27;c_&#123;i&#125; =&#x27;, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(3):</span><br><span class="line">        enc(i)</span><br><span class="line"></span><br><span class="line"># e_0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line"># n_0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line"># c_0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line"># e_1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line"># n_1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line"># c_1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line"># e_2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line"># n_2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line"># c_2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br></pre></td></tr></table></figure>



<p>令$M &#x3D; \sqrt{N_{max}}$，$M$是一组$N$中最大的$N$并且开根号。这组$N$满足：$N_1&lt;N_2&lt;\dots&lt;N_r &lt;2N_1$</p>
<p>又$\because e_id \equiv 1 (\mod \phi(N_i))$</p>
<p>这里把它写成$e_id &#x3D; 1+k_i\phi{N_i}$</p>
<p>假设$\phi(N_i)$可以写成$k_i(N_i-s_i)$的形式。其中$|s_i&lt;3N_i^{\frac{1}{2}}|$</p>
<p>则$e_id &#x3D; 1 + k_i(N_i-s_i)$</p>
<p>化简得$e_id-k_iN_i &#x3D; 1-k_is_i$</p>
<p>所以我们有$r+1$个等式:</p>
<p><img src="/../images/Lattice2/10.png"></p>
<p>写成矩阵相乘的形式</p>
<p><img src="/../images/Lattice2/11.png"></p>
<p>因为最后的目标向量满足LLL算法，所以我们可以得到$dM$</p>
<p>求得$dM$之后，我们可以求得$d$</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line">n0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line">c0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line">e1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line">n1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line">c1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line">e2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line">n2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line">c2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [n0,n1,n2]</span><br><span class="line">M = isqrt(max(n))</span><br><span class="line"></span><br><span class="line">ge = [[M,e0,e1,e2],</span><br><span class="line">    [0,-n0,0,0],</span><br><span class="line">    [0,0,-n1,0],</span><br><span class="line">    [0,0,0,-n2]]</span><br><span class="line">Ge = Matrix(ZZ,ge)</span><br><span class="line"></span><br><span class="line">dM = Ge.LLL()[0][0]</span><br><span class="line">d = abs(dM) // M</span><br><span class="line">m = pow(c0,d,n0)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h3 id="参考论文"><a href="#参考论文" class="headerlink" title="参考论文"></a>参考论文</h3><p><a href="https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf">IJCSI-9-2-1-311-314.pdf</a></p>
<h1 id="CSDN某博主分享-1"><a href="#CSDN某博主分享-1" class="headerlink" title="CSDN某博主分享"></a>CSDN某博主分享</h1><p>题目</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"> </span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"> </span><br><span class="line">a = getPrime(<span class="number">1024</span>)</span><br><span class="line">b = getPrime(<span class="number">1536</span>)</span><br><span class="line"> </span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = random.randint(<span class="number">2</span>**<span class="number">14</span>, <span class="number">2</span>**<span class="number">15</span>)</span><br><span class="line"><span class="keyword">assert</span> ((p-r) * a + q) % b &lt; <span class="number">50</span></span><br><span class="line"> </span><br><span class="line">c = <span class="built_in">pow</span>( m, <span class="number">65537</span>, p*q )</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 78168998533427639204842155877581577797354503479929547596593341570371249960925614073689003464816147666662937166442652068942931518685068382940712171137636333670133426565340852055387100597883633466292241406019919037053324433086548680586265243208526469135810446004349904985765547633536396188822210185259239807712</span></span><br><span class="line"><span class="string">a = 134812492661960841508904741709490501744478747431860442812349873283670029478557996515894514952323891966807395438595833662645026902457124893765483848187664404810892289353889878515048084718565523356944401254704006179297186883488636493997227870769852726117603572452948662628907410024781493099700499334357552050587</span></span><br><span class="line"><span class="string">b = 1522865915656883867403482317171460381324798227298365523650851184567802496240011768078593938858595296724393891397782658816647243489780661999411811900439319821784266117539188498407648397194849631941074737391852399318951669593881907935220986282638388656503090963153968254244131928887025800088609341714974103921219202972691321661198135553928411002184780139571149772037283749086504201758438589417378336940732926352806256093865255824803202598635567105242590697162972609</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>已知等式<code>((p-r) * a + q) % b &lt; 50</code></p>
<p>令$x \equiv ((p-r)×a+q) \mod b$</p>
<p>$\therefore x - q \equiv (p-r)×a \mod b$</p>
<p>$\therefore x-q &#x3D; (p-r)×a+kb$</p>
<p>构造格求$p-r和x-q$，再爆破得到$p,q$</p>
<p><img src="/../images/Lattice2/5.png"></p>
<p>exp:</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># sage</span><br><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from tqdm import *</span><br><span class="line"></span><br><span class="line">c = 78168998533427639204842155877581577797354503479929547596593341570371249960925614073689003464816147666662937166442652068942931518685068382940712171137636333670133426565340852055387100597883633466292241406019919037053324433086548680586265243208526469135810446004349904985765547633536396188822210185259239807712</span><br><span class="line">a = 134812492661960841508904741709490501744478747431860442812349873283670029478557996515894514952323891966807395438595833662645026902457124893765483848187664404810892289353889878515048084718565523356944401254704006179297186883488636493997227870769852726117603572452948662628907410024781493099700499334357552050587</span><br><span class="line">b = 1522865915656883867403482317171460381324798227298365523650851184567802496240011768078593938858595296724393891397782658816647243489780661999411811900439319821784266117539188498407648397194849631941074737391852399318951669593881907935220986282638388656503090963153968254244131928887025800088609341714974103921219202972691321661198135553928411002184780139571149772037283749086504201758438589417378336940732926352806256093865255824803202598635567105242590697162972609</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[a,1],[b,0]])</span><br><span class="line"></span><br><span class="line">x_q,p_r = Ge.LLL()[0]</span><br><span class="line">xq,pr = -abs(x_q),abs(p_r)				#因为x是远小于q的，所以x-q肯定是负的</span><br><span class="line"></span><br><span class="line">for x in trange(50):</span><br><span class="line">    for r in range(2**14,2**15):</span><br><span class="line">        p = pr + r</span><br><span class="line">        q = x - xq</span><br><span class="line">        n = p*q</span><br><span class="line">        try:</span><br><span class="line">            d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">            m = pow(c,d,n)</span><br><span class="line">            flag = libnum.n2s(int(m))</span><br><span class="line">            if b&#x27;NSSCTF&#x27; in flag:</span><br><span class="line">                print(flag)</span><br><span class="line">                break</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br></pre></td></tr></table></figure>



<h1 id="CSDN分享"><a href="#CSDN分享" class="headerlink" title="CSDN分享"></a>CSDN分享</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"> </span><br><span class="line">flag = b&#x27;******&#x27;</span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line"> </span><br><span class="line">p = getPrime(1024)</span><br><span class="line">r = getPrime(175)</span><br><span class="line">a = inverse(r, p)</span><br><span class="line">a = (a*flag) % p</span><br><span class="line"> </span><br><span class="line">print(f&#x27;a = &#123;a&#125;&#x27;)</span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line"> </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">a = 79047880584807269054505204752966875903807058486141783766561521134845058071995038638934174701175782152417081883728635655442964823110171015637136681101856684888576194849310180873104729087883030291173114003115983405311162152717385429179852150760696213217464522070759438318396222163013306629318041233934326478247</span><br><span class="line">p = 90596199661954314748094754376367411728681431234103196427120607507149461190520498120433570647077910673128371876546100672985278698226714483847201363857703757534255187784953078548908192496602029047268538065300238964884068500561488409356401505220814317044301436585177722826939067622852763442884505234084274439591</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>已知等式： $a \equiv r^{-1}flag (\mod p)$</p>
<p>$\therefore flag \equiv ar (\mod p)$</p>
<p>即$flag &#x3D; ar + kp$</p>
<p>$a&#x3D;1023bit$</p>
<p>构造格$\mathcal{L}$</p>
<p><img src="/../images/Lattice2/6.png"></p>
<p>$\vec{v} &#x3D; (flag,k)且||\vec{v}||&lt;\sqrt{2}Det(\mathcal{L})$</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">a = 79047880584807269054505204752966875903807058486141783766561521134845058071995038638934174701175782152417081883728635655442964823110171015637136681101856684888576194849310180873104729087883030291173114003115983405311162152717385429179852150760696213217464522070759438318396222163013306629318041233934326478247</span><br><span class="line">p = 90596199661954314748094754376367411728681431234103196427120607507149461190520498120433570647077910673128371876546100672985278698226714483847201363857703757534255187784953078548908192496602029047268538065300238964884068500561488409356401505220814317044301436585177722826939067622852763442884505234084274439591</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[[a,0],[p,1]])</span><br><span class="line"></span><br><span class="line">m,k = Ge.LLL()[0]</span><br><span class="line">m = abs(m)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>



<h1 id="CSDN分享-1"><a href="#CSDN分享-1" class="headerlink" title="CSDN分享"></a>CSDN分享</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from gmpy2 import *</span><br><span class="line"> </span><br><span class="line">flag = b&#x27;******&#x27;</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"> </span><br><span class="line">assert m.bit_length() == 351</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">b = getPrime(1024)</span><br><span class="line">c = getPrime(400)</span><br><span class="line"> </span><br><span class="line">a = (b*m + c) % p</span><br><span class="line"> </span><br><span class="line">print(f&#x27;a = &#123;a&#125;&#x27;)</span><br><span class="line">print(f&#x27;b = &#123;b&#125;&#x27;)</span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line"> </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">a = 92716521851427599147343828266552451834533034815416003395170301819889384044273026852184291232938197215198124164263722270347104189412921224361134013717269051168246275213624264313794650441268405062046423740836145678559969020294978939553573428334198212792931759368218132978344815862506799287082760307048309578592</span><br><span class="line">b = 155530728639099361922541063573602659584927544589739208888076194504495146661257751801481540924821292656785953391450218803112838556107960071792826902126414012831375547340056667753587086997958522683688746248661290255381342148052513971774612583235459904652002495564523557637169529882928308821019659377248151898663</span><br><span class="line">p = 100910862834849216140965884888425432690937357792742349763319405418823395997406883138893618605587754336982681610768197845792843123785451070312818388494074168909379627989079148880913190854232917854414913847526564520719350308494462584771237445179797367179905414074344416047541423116739621805238556845903951985783</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>已知等式$\quad $$a \equiv bm + c(\mod p)$<br>$$<br>\therefore c &#x3D; a -bm + kp<br>$$<br>构造格</p>
<p><img src="/../images/Lattice2/8.png"></p>
<p><strong>由于不知道中间矩阵最后一列应该是什么，我们先从右边的矩阵入手。</strong></p>
<p>因为$c$是$400bit$，$m$是$351bit$，所以向量$\vec{V}&#x3D;(c,m,?)$的长度大概就是在$400bit$左右</p>
<p><strong>由$Hermite$定理我们知道最短向量有上界</strong></p>
<p>$||\vec{v} ||&lt; \sqrt{3}×\sqrt[3]{||det(\mathcal{L}||})$$\therefore det(\mathcal{L})$应大于$400bit$</p>
<p>我认为$?$的取值应该在$176bit$以上</p>
<p>所以构造下列格：</p>
<p><img src="/../images/Lattice2/9.png"></p>
<p><strong>这个</strong>$2^{176}$<strong>需要不断测试，我测试结果为</strong>$2^{180}$<strong>即可获得正确答案</strong></p>
]]></content>
      <categories>
        <category>格密码</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>挨打日记</title>
    <url>/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/</url>
    <content><![CDATA[<p>记录一些未知来源的题目</p>
<span id="more"></span>





<h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">BITS = <span class="number">233</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">broken</span>(<span class="params">x, bits</span>):</span><br><span class="line">    <span class="keyword">return</span> x&gt;&gt;bits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    p,q = getPrime(<span class="number">512</span>),getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    <span class="keyword">return</span> n, broken(p+q, BITS)</span><br><span class="line"></span><br><span class="line">n, hint = gen()</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">107847645025513535850791225440130707186374273414737521825714442885442542984529827092766916748308266623066053421754530398675086374798530909982183476265477598220972320436343536618913608933549054793948336438240303192183575843300257235195070331758555882832698815894168120103459360566404203412796086643598204242029</span></span><br><span class="line"><span class="string">1505246122706281178983443268987790509406564031452059494152554645294649335244676839890</span></span><br><span class="line"><span class="string">16589212605025468264862689939961340646400626438824064459026078002373801735937861932598660491280834517490394340315480853421268981930217857435669572426110105938015092688880859031418213297139875807487434491329423279700179082306961439610731922669459168752958192842026918421354512654494583087220572962719510130677</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>爆破。好久好久</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">N = <span class="number">107847645025513535850791225440130707186374273414737521825714442885442542984529827092766916748308266623066053421754530398675086374798530909982183476265477598220972320436343536618913608933549054793948336438240303192183575843300257235195070331758555882832698815894168120103459360566404203412796086643598204242029</span></span><br><span class="line">gift = <span class="number">1505246122706281178983443268987790509406564031452059494152554645294649335244676839890</span></span><br><span class="line">gift = gift&lt;&lt;<span class="number">233</span></span><br><span class="line"> </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">ok = <span class="literal">False</span></span><br><span class="line">test=<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pq_add</span>(<span class="params">tp,tq,tgift,idx</span>):</span><br><span class="line">    <span class="keyword">global</span> ok </span><br><span class="line">    <span class="keyword">global</span> test</span><br><span class="line">    <span class="keyword">if</span> ok:</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span> tp*tq&gt;N:</span><br><span class="line">        <span class="comment">#print(&#x27;&gt;&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (tp+(<span class="number">2</span>&lt;&lt;idx))*(tq+(<span class="number">2</span>&lt;&lt;idx))&lt;N:</span><br><span class="line">        <span class="comment">#print(&#x27;&lt;&#x27;, hex((tp+(1&lt;&lt;(idx+2))))[:20], hex(tq+(2&lt;&lt;idx))[:20], hex(N)[:20])</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> idx&lt;=<span class="number">233</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            test += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(test)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">                tpp = tp+(i&lt;&lt;<span class="number">223</span>)</span><br><span class="line">                f = tpp + x </span><br><span class="line">                test += <span class="number">1</span></span><br><span class="line">                rr = f.monic().small_roots(X=<span class="number">2</span>^<span class="number">223</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">                <span class="keyword">if</span> rr != []:</span><br><span class="line">                    <span class="built_in">print</span>(rr)</span><br><span class="line">                    <span class="built_in">print</span>(tpp)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>,f(rr[<span class="number">0</span>]))</span><br><span class="line">                    ok = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    idx -=<span class="number">1</span></span><br><span class="line">    b = tgift &gt;&gt;idx </span><br><span class="line">    one = <span class="number">1</span>&lt;&lt;idx</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#print(hex(tp)[:20],hex(tq)[:20],hex(tgift)[:20],idx,b)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">0</span> <span class="keyword">or</span> b==<span class="number">1</span>:</span><br><span class="line">        pq_add(tp,tq,tgift,idx)    </span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">1</span> <span class="keyword">or</span> b==<span class="number">2</span>:</span><br><span class="line">        pq_add(tp+one,tq,tgift-one,idx)</span><br><span class="line">        pq_add(tp,tq+one,tgift-one,idx)</span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">2</span> <span class="keyword">or</span> b==<span class="number">3</span>:</span><br><span class="line">        pq_add(tp+one,tq+one,tgift-(one&lt;&lt;<span class="number">1</span>),idx)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">tp = <span class="number">1</span>&lt;&lt;<span class="number">511</span></span><br><span class="line">tq = <span class="number">1</span>&lt;&lt;<span class="number">511</span></span><br><span class="line">tgift = gift -tp -tq </span><br><span class="line">pq_add(tp,tq,tgift,<span class="number">511</span>)</span><br><span class="line"><span class="built_in">print</span>(test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;111111111111&quot;</span>)</span><br><span class="line"><span class="comment"># p = 10671810890705142935923698352497956126372923054885272713948800012376136275817384032407712447142702386637160839942871245602734437654810217233791561733480407</span></span><br></pre></td></tr></table></figure>

<p>求出p后，正常求解</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">p = <span class="number">10671810890705142935923698352497956126372923054885272713948800012376136275817384032407712447142702386637160839942871245602734437654810217233791561733480407</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;ccc2e285-7bb1-484e-ad62-58cc474ef9d4&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_secretkeys</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        m = <span class="number">2</span> ** <span class="number">3</span></span><br><span class="line">        a = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        b = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">if</span> a &gt; b :</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> b &gt; <span class="number">2</span> * a:<span class="number">7</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        ra_ = randint(<span class="number">1000</span>,<span class="number">10000</span>)</span><br><span class="line">        p_ = <span class="built_in">pow</span>(a,m) + ra_</span><br><span class="line">        p = next_prime(p_)</span><br><span class="line">        ra = p - p_ + ra_</span><br><span class="line">        rb_ = randint(<span class="number">1000</span>, <span class="number">10000</span>)</span><br><span class="line">        q_ = <span class="built_in">pow</span>(b, m) + rb_</span><br><span class="line">        q = next_prime(q_)</span><br><span class="line">        rb = q - q_ + rb_</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ra &gt; <span class="number">100000</span> <span class="keyword">or</span> rb &gt; <span class="number">100000</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> b &gt; iroot(<span class="number">2</span> * <span class="built_in">pow</span>(a, m) + ra, m)[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> ra &gt; <span class="number">2</span> * iroot(a,m//<span class="number">2</span>)[<span class="number">0</span>] <span class="keyword">or</span> rb &gt; <span class="number">2</span> * iroot(b,m//<span class="number">2</span>)[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, ra, <span class="built_in">int</span>(p).bit_length(), q, rb, <span class="built_in">int</span>(q).bit_length()</span><br><span class="line"></span><br><span class="line">p, ra, len_p, q, rb, len_q = get_secretkeys()</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">ct = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ra = <span class="subst">&#123;ra&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;rb = <span class="subst">&#123;rb&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len_p = <span class="subst">&#123;len_p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len_q = <span class="subst">&#123;len_q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ct = <span class="subst">&#123;ct&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ra = 8607</span></span><br><span class="line"><span class="string">rb = 7150</span></span><br><span class="line"><span class="string">len_p = 1024</span></span><br><span class="line"><span class="string">len_q = 1024</span></span><br><span class="line"><span class="string">n = 28098722633030488893312283528887829649553659514053781575839443778746567710358683558509768930786261053897116586758341172713231425712608663734433267335002333760261583976848753337338129716792124202066388265994360580739266657504481707827816610267011366001142300093926601793983384666604377328323493638248481764153911921310476848622133065363121266256704484624454408157373499690818152144645904269865423396689289703578108901228755055729490144039004436875090060394642072739901593627031008002995026214521011417826487454434739123729500727953687489123493596702814564384266479646307886530097993679086392267067430262508230063492593</span></span><br><span class="line"><span class="string">ct = 1361368491194202361715607865372797868849909740139730895054740999951755977992724940480130958163781061991384502597774968578284702191375825258332749459177999721414531960173967638050842294432428891589365478524879091438660354502169037756949918455465931069407443747905678846811248473459896942787043705093661155283970943862884656259675846526304020149516360300122739147864690004414833366319773397061007864065322841302908571648122903295064833926287970664637537668175501504866705196230324464962122113398544393881450146243000410853975781504185685414280739943390199620950135398253008721600717727922668728798959184802994979420495</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$\because q_ &#x3D; b^8 +rb_ $</p>
<p>$q - q_ &#x3D;q - b^8 - rb_$</p>
<p>$q-q_ + rb_ &#x3D; q-b^8$</p>
<p>$\therefore rb &#x3D; q - b^8$</p>
<p>同理</p>
<p>$ra &#x3D; p - a^8$</p>
<p>$\therefore p &#x3D; a^8 + ra$，$q &#x3D; b^8 + rb$</p>
<p>$\therefore n &#x3D; pq &#x3D; (a^8+ra)(b^8+rb) &#x3D; (ab)^8 + ra\times b^8+rb\times a^8 + ra\times rb$</p>
<p>因为$a^8 + ra \approx a^8$，$\therefore n \approx a^8b^8$</p>
<p>n开8次方得到$ab$，再结合 $n&#x3D;(ab)^8 + ra\times b^8+rb\times a^8 + ra\times rb$解方程组</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ra = <span class="number">8607</span></span><br><span class="line">rb = <span class="number">7150</span></span><br><span class="line">n = </span><br><span class="line">ct = </span><br><span class="line"></span><br><span class="line"><span class="comment"># ab = int(gmpy2.iroot(n,8)[0])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># var(&quot;a,b&quot;)</span></span><br><span class="line"><span class="comment"># f1 = a*b - ab</span></span><br><span class="line"><span class="comment"># f2 = ab^8 + ra*b^8 + rb * a^8 + ra*rb - n</span></span><br><span class="line"><span class="comment"># ans = solve([f1,f2],[a,b])</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">334500267976593357847948592364017458136</span></span><br><span class="line">b = <span class="number">340164785123729724868130765428093274671</span></span><br><span class="line"><span class="comment"># print(isPrime(b))</span></span><br><span class="line"><span class="comment"># print(int(b).bit_length())</span></span><br><span class="line">p = a^<span class="number">8</span> + ra</span><br><span class="line">q = b^<span class="number">8</span> + rb</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ct,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>注意一下a和b的大小即可</p>
<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt;= <span class="number">35</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">t = getPrime(<span class="number">32</span>)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">hint = ((t+q)**<span class="number">4</span>+(t+q)**<span class="number">3</span>+(t+q)**<span class="number">2</span>+(t+q)+<span class="number">2023</span>) % n</span><br><span class="line"></span><br><span class="line">r = <span class="number">11779674470989201650533406519886591289516202072957618550910646323186300227953911</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(t,m,r)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6580860405834148836110773014414875358234621644983930335529135801623195480368832</span></span><br><span class="line"><span class="comment"># 139415227833650606627481949032630333904915784502498383402775795770352459104117035911044614539656661779065034631025979910419387363425628162982061251276669112098757186870838748231794731153245273066810769109396532311364451556967782895742561287251234088360088678874714586399626016737310602036235187097500522638791</span></span><br><span class="line"><span class="comment"># 43691909620514553907337084747877613125770180914725560231672822190047048268654323014909857087117101555550872581680976037673609645072816688179430921113411189775681186282652913102207473404267361338845128228750191128828347979058211793191911795538917687509092140331114867217314732225741963090158157118956958361667</span></span><br></pre></td></tr></table></figure>

<p>$hint \equiv (t+q)^4+(t+q)^3+(t+q)^2+(t+q) + 2023 \mod n$</p>
<p>展开后发现$hint \equiv t^4 + t^3 + t^2 + t + 2023 + 很多q\mod n$</p>
<p>在Coppersmith下模n，会把q全部模完，所以可以直接求出$t$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">hint = <span class="number">43691909620514553907337084747877613125770180914725560231672822190047048268654323014909857087117101555550872581680976037673609645072816688179430921113411189775681186282652913102207473404267361338845128228750191128828347979058211793191911795538917687509092140331114867217314732225741963090158157118956958361667</span></span><br><span class="line">n = <span class="number">139415227833650606627481949032630333904915784502498383402775795770352459104117035911044614539656661779065034631025979910419387363425628162982061251276669112098757186870838748231794731153245273066810769109396532311364451556967782895742561287251234088360088678874714586399626016737310602036235187097500522638791</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^<span class="number">4</span> + x^<span class="number">3</span> + x^<span class="number">2</span> + x + <span class="number">2023</span> - hint</span><br><span class="line">res = f.small_roots(X=<span class="number">2</span>^<span class="number">32</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># res = [4000655279]</span></span><br></pre></td></tr></table></figure>

<p>$\therefore t &#x3D; 4000655279$</p>
<p>$\because c\equiv t^m \mod r$</p>
<p>注意到$ len(flag) \le 35 \therefore m \le 2^{280}$，但是<code>r.bit_length()</code>只有263</p>
<p>通过$c \equiv t^m \mod r$求出的$m’$是缺失后的m。</p>
<p>$c \equiv t ^{m} \mod r \longrightarrow t ^{m’} \times t^{\phi(r)} \mod r$</p>
<p>所以$m &#x3D; m’ + k\times \phi(r)$</p>
<p><strong>发现m一直出不来，怀疑数据有问题，自己生成了一段数据</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="number">4137560691961718739425091763048204826246959556735333974068696193052111117736453</span></span><br><span class="line">n = <span class="number">86601146891444074456956817892770288311475988322265302838984237580231651859629274475035744328825382202048914060822444105427683352708309881334364203096281689276996522731222677104664324360842817909734370275307581489510464608534413529746798578300893242561668699805039088505923390582961646156539509555519633683481</span></span><br><span class="line">hint = <span class="number">51301250958957185881448512504234182680376619692496967874471014061919485062523459109807826901303643096803496187324129647601172411558722614620741746891647406746358348531784312173885812701563244883422722916122675824886592476043582415303390561692687548141851593610708466592094080775902506766915088060053520879968</span></span><br><span class="line">r = <span class="number">11779674470989201650533406519886591289516202072957618550910646323186300227953911</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">4137560691961718739425091763048204826246959556735333974068696193052111117736453</span></span><br><span class="line">n = <span class="number">86601146891444074456956817892770288311475988322265302838984237580231651859629274475035744328825382202048914060822444105427683352708309881334364203096281689276996522731222677104664324360842817909734370275307581489510464608534413529746798578300893242561668699805039088505923390582961646156539509555519633683481</span></span><br><span class="line">hint = <span class="number">51301250958957185881448512504234182680376619692496967874471014061919485062523459109807826901303643096803496187324129647601172411558722614620741746891647406746358348531784312173885812701563244883422722916122675824886592476043582415303390561692687548141851593610708466592094080775902506766915088060053520879968</span></span><br><span class="line">r = <span class="number">11779674470989201650533406519886591289516202072957618550910646323186300227953911</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = x^<span class="number">4</span> + x^<span class="number">3</span> + x^<span class="number">2</span> + x + <span class="number">2023</span> - hint</span><br><span class="line">res = f.small_roots(X=<span class="number">2</span>^<span class="number">32</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line">t = res[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line">m = discrete_log(mod(c,r),mod(t,r))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>^<span class="number">17</span>):</span><br><span class="line">    m += r-<span class="number">1</span></span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="2023江苏省首届数据安全竞赛"><a href="#2023江苏省首届数据安全竞赛" class="headerlink" title="2023江苏省首届数据安全竞赛"></a>2023江苏省首届数据安全竞赛</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">day</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;# == Day Time == #&quot;</span>)</span><br><span class="line">    A = [getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">30</span>, <span class="number">1</span> &lt;&lt; <span class="number">40</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01234&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> notebook <span class="keyword">import</span> pubkeys</span><br><span class="line">    hint = <span class="built_in">str</span>(A)[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;, &#x27;</span>, <span class="string">&#x27;||&#x27;</span>).encode()</span><br><span class="line">    hint = bytes_to_long(pad(hint))</span><br><span class="line">    package = []</span><br><span class="line">    <span class="keyword">for</span> pubkey <span class="keyword">in</span> pubkeys:</span><br><span class="line">        e, n = pubkey</span><br><span class="line">        package.append(<span class="built_in">pow</span>(hint, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;package = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">night</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;# == Night Time == #&quot;</span>)</span><br><span class="line">    <span class="keyword">from</span> secrets <span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line">    p, q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">    e, n = <span class="number">0x10001</span>, p * q</span><br><span class="line">    message = bytes_to_long(pad(secret))</span><br><span class="line">    ciphertext = <span class="built_in">pow</span>(message, e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    core = getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">70</span>, <span class="number">1</span> &lt;&lt; <span class="number">80</span>)</span><br><span class="line">    box = (A[<span class="number">4</span>] * p ** <span class="number">4</span> + A[<span class="number">3</span>] * p ** <span class="number">3</span> + A[<span class="number">2</span>] * p ** <span class="number">2</span> + A[<span class="number">1</span>] * p ** <span class="number">1</span> + core) % n</span><br><span class="line">    shell = (A[<span class="number">4</span>] * box ** <span class="number">4</span> + A[<span class="number">3</span>] * box ** <span class="number">3</span> + A[<span class="number">2</span>] * box ** <span class="number">2</span> + A[<span class="number">1</span>] * box ** <span class="number">1</span> + A[<span class="number">0</span>]) % n</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">A = day()</span><br><span class="line">night(A)</span><br></pre></td></tr></table></figure>

<p>附件1：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># == Day Time == #</span></span><br><span class="line">package = [<span class="number">11348275592172789430802632398715397831929456592129727148350341695822097922745546634103895397114240780119492097879709874341733998189314701220819602086989170395665694216144611451695210776788208725517321710496401109614989729783280209806513298851774400705822274570042128297336679615535569295725037051009221966882907606741910671983811835353310553679554656322510247012465612842055583530354825164440556725066351429241835394579392892121937744444324723509039593320520073762479405487678614235658010109343868772211070874500834820005557924944766175445227592086997786601600141172729543326022039897279215360210475222205314199752358</span>, <span class="number">11817047514083750028443306573161291960303002458276716688201587284992675854178250185695613342603396451495053496021018943618684096193774851513377343785523373066637422156529843356640438514917147007662989366432951340073247573347091422478343675687872524102452812391963856179412214914106817415620613886827405526709334122157218264253412138947978859771457788135381194396144386611627935519990330309154612803264373276472523863776757124489507206744895878709136339189551422814752920383697719212261820943113370067423118794871570596583232694067119303936516491830190746798281923693136901268220982292626728815051587839682733501582997</span>, <span class="number">3131427695639074007646625687827523632044624200167725001731246731463369200890045250738898155425873822581405723445926216099453276470655307513244478613248253397941362848890729091875615893643288181126353294271063912991208029628896380928878098320509891044728414542705582996774991148116051162157848421643082210867849206627757941596203046799655123006406284498009424107637970927771132706399889289085811447333980744767367889464364519571965014435281718495338752896521777070285880327861778156398424643033288480056322928449210425585380975486759287881877636187364299666207762828705236236071045450767253946524067440138527952996304</span>, <span class="number">3345060634868343217881273515503289974894457362066685037297545772310131198850220025672843957153107490874807599311288876818421468275658855183857485067696603798636556327070411528170381402923911922437076616994460720931230980991440337397730061039967493443152767007916713160518618697678791358770766857737217910848181657393760417031865203943283074078341988117567851667858026108335625589177179258992930648353570238327435125409871028669479754623782967450462280802423233657422873275069133939005033872391235288329468886849808534906305377008408076775145268714146937205940659708210819711903273898505450411746796296074348301840443</span>, <span class="number">689229715602713064347690095007369004049337459458047359544160409565437783924368962797071453687950582019132146435134269723546824657132278724115055713024437048832952574546581164678912794341156478859615959289720931333010836265396177238403118182219901102453660596556053537987705012972371809213618745302576874122654094213771963420178465724399112964705426548207838941065298709968044913923423922781681311806180694571535910059881703228238538782302346351472443730399075812346657046097375387076507982673848430573754749554553794234945423901111974280859817600907619255722739374513108613738135872066592727564964404002462119084702</span>]</span><br><span class="line"><span class="comment"># == Night Time == #</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">19628814650078845889624476490795800811418703155298421183649751922179289373872110164946485468758965499898659860381452920316689731813466611171330082419646032975535828938381971760997472673267667258345915647828047467420412766203712358122436358120743184983881044132767579608354023899206025747277296489890315455139161247982158229333619416375842911027431739437723838483131248360727904613423834627213036877579164949084954352768932164210879329537266501942223360207803513487189832308290555832923018589686990981697562750385892888271329399531648035355662276186237232094775404084845357101354614900716614704579902047366473325519851</span></span><br><span class="line">ciphertext = <span class="number">18231770979476945075115454933498285687471248736331968136534439886998853983159878091479109027681230666670001308495054141682281492473521819495259722942633525843224223138121210743435008344491182811096997837681349401919300801071760448609909297020846949507707329708251861866061443743942558286917774317607571379516986051564317860557772153943821431899226380831989795907857566336085097807330399388077758869632230636727348278392968946952484442630549599469645903047917899063746000458656292320802815605327181346234519795519772619774175495201258591571744214020509439053957080210165266709953654561600989486386199867341092142358249</span></span><br><span class="line">shell = <span class="number">7450311459083436799013470526820816670296314417175130490433500468646960366746415074085735399822973890608046359739147553438015771999419943640758794686461655503899174274852006852675273759918109697488252918038788275865249305840107266839320745067341253227218580768443831238305064450748932813304412926315551102620477056031794884272260575749720364002093756539399717557808977458033683588388899534871439955606629530406662400672087729944642496842353084711242911328651341343429685261174338868058208644730980459845089948243884209259777439653298562832822410224626781415627048867272937969823329086437858777995321438386601575065665</span></span><br></pre></td></tr></table></figure>

<p>附件2：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, <span class="number">16966923273393034574368601955241184391111444785998466710722972275633988040568029224272430397635357872449163107278928804572765398970752644900568552514020294813546024733050135082024292481598322682990045855877556853392263676715734911232910368712575738786450510156105046776600566496799942574786503183241332740784997363514285857446938222302824964396227964711868412832852194845619628366554904150230665043909281603861298992421759553638135733037244888585600075655017766713763334284974682754159767494437867386464788270392548503256135412609157993954349845981674000072937143857040970855382655304911806719316346552101453584266121</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">13636547774903694433910615288816366243965221147245493790443257513469643051508482519945160993497983268746607032666514024577996510214003878851754244812785830861056511467944880656887067183093022088006603023892079757597903932697728395729605528467171403935076011715369931494813762896302405865063013876978950952553183445737415893862580946529557997177862386840671940665891984463553509323759394863514802662045074793125218445076375294720405008157895103559623204523371691063630903658360461001806917018298844432738514873530829540084732665560723768831816785580126848217585494349751859982707295270194451027637908966488433591336079</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">13422209706853784863425138450444393536114566510977689013118842078064352816867606066548879016746689784867031499069217146653949323203507755857385123653072875573743110808787259755688613540214185294636104765964080842615717180413731820679997453377899736419007193552970900617704671115646941207925636014254352661937769415565529244046272257822921740649781322893596978112103176487718960676212380426151079825140922318909470514158027009961239217428522970405297292867815726509360369236095377704967444339421311749405316999191339677904499413281713365474466679134722393111495793887387332928227905039036942450742103526490509249576159</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">21746430662648628292439055708644436184530740821098010749514133474681581832957631729292681550968108122182841907644832479495695011213810971334153360397292385819609198743433956578966857749821825621262178208409227379634952172419748956184624505995106932133301461499473823229623656490844764958301835433668618062743327682117611417235819168865744757242990985069648255779083246816509593018812991050741917153961245784296647661659339041115118272068392627299499703962645966495325055378652176922700072734325787550811454984878236039742147547963385471101805136506286953288566035101103034341742923072819774753918471775281464739904101</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">16012920802348742413202394765537959589119609441428117329692661212660781149297315973073063954731746455220386673231725950116051390914388279415796378305381377822621647264088603927560119754278978906758212463937071494263575443156089509654950881813861479449401068535285885349738367249035960528895049222211387021733152221289202030407416118814341241382479971018611239102343929419190892133819275458474489856666791981711793637127167775551296403296397810821548297674986394286293380472089135564385129140069501205054853729781710604489652713172579677128036322403868618295553335257593973027194532512596143733434234439677513237984107</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><code>day</code>主要是把填充后的<code>hint</code>进行5次同<code>e，n</code>的加密。</p>
<p>第一反应应该是用中国剩余定理进行求解，<strong>但是填充后的<code>hint</code>约2048bit</strong>，5组n是不够求解的。</p>
<p>分析<code>pad</code>，发现<code>pad</code>函数只是在<code>msg</code>后面填充上许多<code>00</code></p>
<p>于是根据$c \equiv m^e \mod n$可以推出$c \equiv (m’ \times pad)^e \mod n$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line">A = [getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">30</span>, <span class="number">1</span> &lt;&lt; <span class="number">40</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01234&#x27;</span>]</span><br><span class="line"></span><br><span class="line">hint = <span class="built_in">str</span>(A)[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;, &#x27;</span>, <span class="string">&#x27;||&#x27;</span>).encode()</span><br><span class="line">hint1 = bytes_to_long(hint) </span><br><span class="line">hint2 = bytes_to_long(pad(hint))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(hint2 // hint1))</span><br></pre></td></tr></table></figure>

<p>自己测试几组数据发现填充的内容大概是</p>
<p><code>0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></p>
<p>实际可以把填充内容减少一些0</p>
<p>于是我们有$c \equiv m’^e \times  pad ^e \mod n \longrightarrow m’^e \equiv c \times (pad^e)^{-1} \mod n$</p>
<p><code>m&#39;</code>大约560bit</p>
<p>到此，我们有了5组新的<code>c</code>，可以用中国剩余定理求解了</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">package = [, , , , ]</span><br><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ]</span><br><span class="line">]</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    N.append(pubkeys[i][<span class="number">1</span>])</span><br><span class="line">c = []</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">pad = <span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    cc = <span class="built_in">int</span>(package[i] * <span class="built_in">pow</span>(pad,-<span class="number">13</span>,N[i]))</span><br><span class="line">    c.append(cc)</span><br><span class="line">    </span><br><span class="line">C = CRT_list([c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>],c[<span class="number">4</span>]],[N[<span class="number">0</span>],N[<span class="number">1</span>],N[<span class="number">2</span>],N[<span class="number">3</span>],N[<span class="number">4</span>]])</span><br><span class="line">m = gmpy2.iroot(C,e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>

<p>得到<code>hint = 646919678902||598613162045||90472013741||917100488664||838250498519\x00</code></p>
<p>我们便得到了A</p>
<p>想先通过方程<code>shell = (A[4] * box ** 4 + A[3] * box ** 3 + A[2] * box ** 2 + A[1] * box ** 1 + A[0]) % n</code>，来求解<code>box</code></p>
<p>但是没成功</p>
<p><strong>请教了一下Van1sh师傅，他说一般roots解二次方程，而且一般得模素数</strong></p>
<p>换个思路，通过</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">core = getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">70</span>, <span class="number">1</span> &lt;&lt; <span class="number">80</span>)</span><br><span class="line">box = (A[<span class="number">4</span>] * p ** <span class="number">4</span> + A[<span class="number">3</span>] * p ** <span class="number">3</span> + A[<span class="number">2</span>] * p ** <span class="number">2</span> + A[<span class="number">1</span>] * p ** <span class="number">1</span> + core) % n</span><br><span class="line">shell = (A[<span class="number">4</span>] * box ** <span class="number">4</span> + A[<span class="number">3</span>] * box ** <span class="number">3</span> + A[<span class="number">2</span>] * box ** <span class="number">2</span> + A[<span class="number">1</span>] * box ** <span class="number">1</span> + A[<span class="number">0</span>]) % n</span><br></pre></td></tr></table></figure>

<p>我们发现$shell \equiv A[4]\times core^4 + A[3]\times core^3 + A[2]\times core^2 + A[1]\times core + A[0] \mod p$</p>
<p>$core$给出范围，可以通过copper求解</p>
<p>求解出$core$后，$kp &#x3D;shell - A[4]\times core^4 + A[3]\times core^3 + A[2]\times core^2 + A[1]\times core + A[0]$ </p>
<p>求$kp$和$n$公因数便可得到p</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">package = [, , , , ]</span><br><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ]</span><br><span class="line">]</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    N.append(pubkeys[i][<span class="number">1</span>])</span><br><span class="line">c = []</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">pad = <span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    cc = <span class="built_in">int</span>(package[i] * <span class="built_in">pow</span>(pad,-<span class="number">13</span>,N[i]))</span><br><span class="line">    c.append(cc)</span><br><span class="line">    </span><br><span class="line">C = CRT_list([c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>],c[<span class="number">4</span>]],[N[<span class="number">0</span>],N[<span class="number">1</span>],N[<span class="number">2</span>],N[<span class="number">3</span>],N[<span class="number">4</span>]])</span><br><span class="line">hint = gmpy2.iroot(C,e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(hint[<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line">A = [,,,,]</span><br><span class="line">shell = </span><br><span class="line">n = </span><br><span class="line">ciphertext = </span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (A[<span class="number">4</span>] * x^<span class="number">4</span> + A[<span class="number">3</span>] * x^<span class="number">3</span> + A[<span class="number">2</span>] * x^<span class="number">2</span> + A[<span class="number">1</span>] * x + A[<span class="number">0</span>]) - shell</span><br><span class="line">f = f.monic()</span><br><span class="line">ans = f.small_roots(X=<span class="number">2</span>^<span class="number">80</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.02</span>)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">core = </span><br><span class="line">kp = shell - (A[<span class="number">4</span>] * core^<span class="number">4</span> + A[<span class="number">3</span>] * core^<span class="number">3</span> + A[<span class="number">2</span>] * core^<span class="number">2</span> + A[<span class="number">1</span>] * core + A[<span class="number">0</span>])</span><br><span class="line">p = gmpy2.gcd(kp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ciphertext,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#b&#x27;Your flag is: flag&#123;8d24d7d491106a7974d5afe9342b2834&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="祥云杯线下（高校组）"><a href="#祥云杯线下（高校组）" class="headerlink" title="祥云杯线下（高校组）"></a>祥云杯线下（高校组）</h1><h2 id="ezmath——未解决"><a href="#ezmath——未解决" class="headerlink" title="ezmath——未解决"></a>ezmath——未解决</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">total_bit = <span class="number">512</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_para</span>(<span class="params">bit_size</span>):</span><br><span class="line">    P = getStrongPrime(bit_size)</span><br><span class="line">    Q = getStrongPrime(bit_size)</span><br><span class="line">    N = P * Q</span><br><span class="line">    magic = (N + <span class="number">1</span>) * (N + P + Q + <span class="number">1</span>) + (P - Q) ** <span class="number">2</span> + N</span><br><span class="line">    d = <span class="built_in">int</span>(<span class="number">0.394</span> * bit_size)</span><br><span class="line">    e = inverse(d, magic)</span><br><span class="line">    k = d * e // magic</span><br><span class="line">    <span class="keyword">return</span> (N, e), (P, Q, k)</span><br><span class="line">pubkey, sec_key = make_para(<span class="number">2</span> * total_bit)</span><br><span class="line">flag = bytes_to_long(flag) * sec_key[<span class="number">2</span>]</span><br><span class="line">p = getStrongPrime(total_bit)</span><br><span class="line">q = getStrongPrime(total_bit)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line">t = ((p - getRandomNBitInteger(<span class="number">16</span>)) * sec_key[<span class="number">0</span>] + q) % sec_key[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(pubkey) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>((t, c)))</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N,e=(21136120517038375343657055317361461947217610380415290931285704769845405139443342030139838613845989765254932385503454684656325859309861269837188207923942223163348944160792729101485975484543693998035828762630825174735962679103457025646672449491007685400869138263581883506767852264244013623583813540066115060793144049256890248337903932112449333735324371400873419104520104079223733159263094092843185909770131443506433825708789563521497940390674504488024226655482568491358458107989880756229607524452273305978138461190013290440068226454238375505010225133919526068226837545142734502100757510899741312502285931571783851666429, 291542085122413541028076006933740091355832744332602513957292369860771664833892358795585946753279254101863581542678927529330607906769804928526978686071141386341893467977451552634615917127445748737712286687041822255325772392569586666055711202824870471562051621883329559663555059967665101455578668904247279540014709971958403913939101728330638301270881265277488332145439522278871554725936095617940701105161078332467466405454007283937177070102098256744642045839067405705972784471374421818844770106228499198315920181837950503279178647052157269318876892192700670366858062171759498850112906238502375693099462427930964555274451795362167393410749436026095037695100430810204847979914959732383773952788768239221142673268839750770222737928397507645337714199166919835667638401309062163501094032890215821366318775462220119081175885338966308921205861717088926659072208866126879068213582499260316364548817213314952246293713853884872460934174624844462586276340207505217646013915381902979372875919823493439285174120160656952728493383464761519634974414670811896809158801804891938928244053980210687334268664219571818927285279999791212932795196689285015367417706597781418431735001428656415752334850685705212368666855124013583549768407830008606258798409140)</span></span><br><span class="line"><span class="string">t,c=(18872151984199200051633005759140295224788252451326410141022483203855894790958837408470348915966212063467995292461061069273539234939320647533902914083943444743748789975745514239518406829738286900177972974033143896932863898553599888597165054837513698667686277110587659188172271629973371164557353473146831275972, 47672712219012743425382676880904671136942826695249149129159924785186563239747047304204962529935078111450524236186612259355850306867579998685662967391936502046679744616903469002187225791339629835786750259999982506494377133775859573660632942293353420327987860136624649402598383416748766985203781387716072244402)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>







<h1 id="安徽省省赛——rwx"><a href="#安徽省省赛——rwx" class="headerlink" title="安徽省省赛——rwx"></a>安徽省省赛——rwx</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">m</span>):</span><br><span class="line">    r=[]</span><br><span class="line">    w=[]</span><br><span class="line">    x=[]</span><br><span class="line">    e=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        r.append(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[-<span class="number">1</span>])</span><br><span class="line">        w.append(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[-<span class="number">2</span>])</span><br><span class="line">        x.append(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[-<span class="number">3</span>])</span><br><span class="line">        e.append(<span class="built_in">ord</span>(i)&gt;&gt;<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> r,w,e,x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inf</span>(<span class="params">r,w,x,files</span>):</span><br><span class="line">    re=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files)):</span><br><span class="line">        re.append(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">bin</span>(bytes_to_long(files[i]))[<span class="number">2</span>:]+r[i]+w[i]+x[i],<span class="number">2</span>)))</span><br><span class="line">    <span class="keyword">return</span> re</span><br><span class="line"></span><br><span class="line">r,w,e,x=know(flag)</span><br><span class="line">files=[]</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;output&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    files.append(urandom(<span class="number">8</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:</span><br><span class="line">    f.write(i.encode(<span class="string">&quot;hex&quot;</span>)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">files=inf(r,w,x,files)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:</span><br><span class="line">    f.write(hashlib.sha256(i).hexdigest()+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e:</span><br><span class="line">    f.write(hashlib.sha256(<span class="built_in">str</span>(i)+urandom(<span class="number">2</span>)).hexdigest()+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> r</span><br><span class="line"><span class="built_in">print</span> w</span><br><span class="line"><span class="built_in">print</span> x</span><br><span class="line"><span class="built_in">print</span> e</span><br></pre></td></tr></table></figure>

<p>output</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">abb490d5efe69766</span><br><span class="line">a42c15dd0717102b</span><br><span class="line">ee0d2fc5c7351947</span><br><span class="line">4876242f69135f77</span><br><span class="line">f7f7e8648cf39204</span><br><span class="line">594b5fb7c4396a5d</span><br><span class="line">5b254e10bc3f2e83</span><br><span class="line">d27b465c51cb56aa</span><br><span class="line">02fde9f77e201f13</span><br><span class="line">5a5a717c5610113c</span><br><span class="line">0228c96208f04be7</span><br><span class="line">1f21b57c69e164c6</span><br><span class="line">eb9ff8ed6de6ae5a</span><br><span class="line">e9ff62161ebfd07f</span><br><span class="line">fc92701a784575fb</span><br><span class="line">246fb05d1f5a6f74</span><br><span class="line">91a9a630e9e91e8b</span><br><span class="line">c27160d38c8b8247</span><br><span class="line">4b473325d4de665c</span><br><span class="line">d1c1b9a58ca6d1e5</span><br><span class="line">818cf44df4d7b088</span><br><span class="line">569014c59066b916</span><br><span class="line">408fb2edb34c77a9</span><br><span class="line">d24576a95ddc151c</span><br><span class="line">9284b46648b92a5c</span><br><span class="line">073f776f6a36eb4a</span><br><span class="line">1b9a6ff58b537364</span><br><span class="line">9a327f0ff86f7687</span><br><span class="line">be0fe6df6ce0726f</span><br><span class="line">98734efb617a527b</span><br><span class="line">3e0e772fd9669166</span><br><span class="line">af8f0e61263ad605</span><br><span class="line">326c9434cc213d55</span><br><span class="line">5d6df6d0425fd13c</span><br><span class="line">c798fca9337f4e09</span><br><span class="line">b8b44901c1e2847c</span><br><span class="line">39c7932c6c9565d8</span><br><span class="line">0df12d3f4023f6cf</span><br><span class="line">df47f8efee88f469</span><br><span class="line">92bbcc351d041479</span><br><span class="line">77b55a5574fa0830</span><br><span class="line">24b60c00c2cda9c2</span><br><span class="line">3c00ce8fad4bdb0e</span><br><span class="line">3368003bfbca99e727ddfe6de1976fe7133392ddcf1e9b858af76aec41a3a0d6</span><br><span class="line">e5cf55af23a0c8b42b4d9f22d1c9dfc2b04a22c0202cd35c783bbf9b82e79525</span><br><span class="line">54ad655d2f450d96eb0198dd620758cbddc8987656b195df04a5e254447e9f19</span><br><span class="line">d093a5e18283d59816ed32156eaaabe64fc2575bc3cee6b4fccf6325d4b669a3</span><br><span class="line">8d32f93d356a459e8c2807c91ab52581c2d3ea225187b8fc2b7d6dc0dbf81500</span><br><span class="line">8778e6d1901c10b1d1090c32cef6aeb36702d37dceac8c0e5a16356473f82a15</span><br><span class="line">090bfe2dd0be43160b406e6b33845c6c5bde6bf47d466d26b7f69ea896eddfdd</span><br><span class="line">91e3ece70e184e3f768925751fb5a0c2cf9369d6bc268464cd2737af38dea781</span><br><span class="line">f16f4fae20ae181dc5a332e423a2a79fb3e2d28f072cb7ba2f8a0b29e2c1c698</span><br><span class="line">b5efdd3705fcf45d3b330202e0387ab9d24c1b79af9577ba0563b669d420723d</span><br><span class="line">d31afdf0eb4149e516658867b07b3032ec3d685f2eb68a565249f4f439a688fa</span><br><span class="line">ac039fae367745a39019561e4f9f953068d0b4639c19a5eaf7a05abc46e734e0</span><br><span class="line">f09637c3a24c14ad0d4fd442ede44009f85f898d506f9ba7a8563650cc4068e5</span><br><span class="line">4bedd3d498e83bd16f363a3eaed9209d1b700f63eeb6f96f775d97ab31cac5f8</span><br><span class="line">33c37802ce6c6dc22d15e60b62e68649ac2d2888ec1ea6fc8c44e01d9869dd75</span><br><span class="line">b5610f79b982ce4666b0df76539cfd74255a00aca06d08acd05eaa7d60084a1c</span><br><span class="line">24a8467f30d49602dc24318cd0665ea57b3333ed22aefde5f161a5f3044272bd</span><br><span class="line">4b1b131e729d9bd102bd27ced202f6d5d800c2c17969c04a30bc7ad29664e59a</span><br><span class="line">19429fd0d54ccf175abd9c4ecc7f24de183f5fee5193c5e895638dcda6a8bc27</span><br><span class="line">6ce1410665315540b25e34c0f1e058567d88ef4fa91e710114f20d62114fd550</span><br><span class="line">fec593226268610fbbc5352d0fb1f41b79a77eab3a2429f731feebaeb23841f7</span><br><span class="line">33935fb947103ab453057052223fd5958a8897b665c8b3650b5cfaf1d8cccdc7</span><br><span class="line">888b1eb7a6d29dc1cef64e6cc539d68b024c109736915630d5ddacc9c636851f</span><br><span class="line">9970385c755daf6275142edb885d03506a738762bf5bfa957f9aadb31f31cb7a</span><br><span class="line">c5ff5de1968b6458758a641d70525d098272c714840e0c2057ba8ec05d531b63</span><br><span class="line">2c208eb6a63a5beca0488ee83d4e5f0eedcc29227f6f25cddd169e87bd07a320</span><br><span class="line">b1d6e133e07eacfa6fbdcd9178344a861599d73c0aa1480b7b0bd7335736d665</span><br><span class="line">aefbae60c94eea15bfbc7a2824f7032b2740f95e19460bde15aae20cae0722ca</span><br><span class="line">6bdfea1b95fd48f168d545e409626e783c272b12b0895cbd17564dbbcf2da66f</span><br><span class="line">02a1b05474d3a86672f76712f0338a00ce95af62b7c6d2aca5492d3d7a8c7305</span><br><span class="line">3a011998e70fe4460f0acdec68a77933b41f6efbad345e66b18cf014cd88af88</span><br><span class="line">cd0fdb32c3e60912b54a2c1f26df90c3243626f636a9c498acbebcbcc2cbebbc</span><br><span class="line">87dc8336d829915f3f98709041cfa033be859e2b1ace2c9478e26c457e4aadc0</span><br><span class="line">d2e84a52aa49ed36237c81ea9f2ff66ca9d48d406df092535971601e80ec31d1</span><br><span class="line">042025bb6c7535549c2cb536a04125348c48454ac6a8210cfef8a71e50813aff</span><br><span class="line">436308db651644f181d02c1b90368c150f5499836d71e6b7ae8e8334811a258e</span><br><span class="line">5b8b9c76b17324ef5f35692b9ee069ec3c6135b1725bb82900bf3fbe953e0586</span><br><span class="line">0506511cdc9561f76e5d85d147120fd746668b043f5a71760148008ebe37d9f0</span><br><span class="line">6d89ad6b0a094a7f9a9bf4ee1ca2f3b0e5ec56f924b7efeb16fbdfbfd41358d3</span><br><span class="line">25019aa8cec744ea6937729fd454100c6f5a589284b007c645c6d7c6ef58c8bc</span><br><span class="line">39322232c9118f9541f6432913384444309fd10a0f627c9ecc2f95309701ab13</span><br><span class="line">115a84ee3ac24122fd5482b0f7eb900ce99382ca41777cc2577c82cec766cab0</span><br><span class="line">ed9f6161c423f30cc7ceac974ae5e432e755f08cb79b47ce3d43452dcf74c76c</span><br><span class="line">a3df8f1e5dd063595188044473fa1c2bc69eec2e29bafaeeb3962c2750585fca</span><br><span class="line">3f8bb91ade38f8e0b0e269a57191d70cf60ac2db4c79518e79b48c08a737f6cb</span><br><span class="line">439190a055187e9c9a0120ed91b15365f716330c8df21cadcf14f6ea0f35b4b8</span><br><span class="line">dd1ce000a01a41ead05d03d74e184345aa1340c14873d75bf99275b6042c66a5</span><br><span class="line">5e2002006de48dc19d2116bd6de751ede5bdcfd96bfafbc41d9a227b06c8f7e6</span><br><span class="line">d05a972e1fa0d36533c88c3d6f51175df426ab3ad3950cbd82fe789907de7178</span><br><span class="line">e108856d6e85ea36e8b0330a5b62489ce939c11f0e3aa673327eef4c87adfdf9</span><br><span class="line">0f673f6397808e53248ce5778e31d669ad9ddcdd4c732a3dcea05a3c03322972</span><br><span class="line">2c6d0af5b1ea6178d647eaad2a41f76bdf0111dce813b136262ab9cbd1a042da</span><br><span class="line">2c4b24bc7213bd16739ac23b0988e27ea3b52fbf87b7c3648cae97d3535449d2</span><br><span class="line">accea9e2c218217fc967bd11d772c442adf4cfbaf6d81c57e13eda48c907a584</span><br><span class="line">befe454b22b4eb940732ab972657e474c211d6d9dfcddd34f68d9628b32d61fe</span><br><span class="line">fc1090ba15ccae04a9648183bfd9050e5513d98035af00a83e9a371bcff72512</span><br><span class="line">d85b886abcdc31f028a2be8fdfa31ef3510c4b7f099baa0f15b9308493f3d2a7</span><br><span class="line">2e631a9a04bf11d2354df921e482d6059684cc746ca1725b6d62952739c75ade</span><br><span class="line">31dcc3a2dd334474173f6d16adcd3546736ddea1dda53d7ae7120bc5bcbc12f1</span><br><span class="line">11d699bf7dcc57780f5b4217b4a6f777c0c4cdbd4269bf76b3daa5b6a6901fcb</span><br><span class="line">02ae1e11650bf5ea33b0f2b9a65e830a0e4ff33b64be2f84eb0c89aeea0718fb</span><br><span class="line">e3d6ba04b3583099db6095205e50eaf338260cbd97c77c3b3d9058522f108892</span><br><span class="line">81f062c17993b7266ce990b4d115721973958d5f81a9f24fa5e7c718b4bfd1be</span><br><span class="line">9dbb8f5215d43034aff34bcb3a2cb950b76c5dc78320bf729739f28c2316c381</span><br><span class="line">b5ce8e8ca3b8e872f7640f0980af6aec31cb8549f48911081264b87c94ed9a16</span><br><span class="line">70cdeb42324021d98cb408f2e0e2425a4be90d6b263a44f05e65af40c842a105</span><br><span class="line">ef679767995bfa61402bf90cd697f388199ed92b24e5a1cd67485f9951b73bf0</span><br><span class="line">ccfb009cacb758e3ed525b4941c61e973d7bc2bc079c3a2bd089f85fbf634a2f</span><br><span class="line">f367d169e7fed794e76f711a4f75c0dbf8ac9426f1da48374bc86f179487d83a</span><br><span class="line">90e786a6c635b110c1a9e8b717809b665d2ea91cf0851e8615ea276628544a6d</span><br><span class="line">926cc73a86228b74a4ef8a386c2ecd56c7ed1c8979f2437dd53aa8c1a15b5513</span><br><span class="line">32e8b07e1f7bb7da7012fff02cdcf84971d976fe056ddba651731657c7bce278</span><br><span class="line">dbd86282a86ce7523cc2920ecd87070f46f436f4c9436667599fff95b0ebdc1b</span><br><span class="line">4ab6a0ad4b50df2e2a178576f4aae0c7289ea00385b9d29be0c4e3b2921b5f2d</span><br><span class="line">1b9a6ed279789ca017162f12586aef68f0d55acbbfb85f7a0ea294ff22a2eacf</span><br><span class="line">07fc3be55d5d43dcb80f69121d6847aa0d093d4d4f723017ef75ab5b09ec555b</span><br><span class="line">efb6468f620d1a0dd71ddfdc66b1a5145a1666c07729db8cba93ccadf66d6363</span><br><span class="line">25164ae1c0e8c1f6243fb7761310c398c607b3be6ff0cdc41fa7583288cece47</span><br><span class="line">01baccd7e9415275d8e9f797b90362496935e279d02bcf68e5bcd89577688934</span><br><span class="line">e6bb9d20c9f7b528dcf323143fde093be6859b63583e58fbe0c319d5f6104cfd</span><br><span class="line">048856baa298e3d69421db8f4777fd44756f25933484edf6574f1ad0c3a35d6a</span><br><span class="line">0799af8cad7311dd6c27f07a1b13e57eb81d9ff79520b05428d6599105d41c37</span><br><span class="line">f34f86804facfee48869f64b42b2f507fab255425001d368078bae02ae660f21</span><br><span class="line">dc658b6bef96c02fd9ddcf1aaa442a5994c4789cc6ab76b2e592a36e0f61e205</span><br><span class="line">8852c503f1fe03706f3a6afffed6f5ad6a9f375f7ef430fc29ecbefc7696d28c</span><br><span class="line">62a37ed7404473449d756a1750ff5d65de9b3e27e10367e63a25e38681a144d3</span><br></pre></td></tr></table></figure>

<p>分析代码知道<code>r</code>,<code>w</code>,<code>x</code>，<code>e</code>分别存放<code>flag</code>每个字符转ASCII码的倒数第一位，倒数第二位，倒数第三位，前<code>x-3</code>位</p>
<p>分析<code>inf(r,w,x,files)</code>函数</p>
<p>根据<code>re.append(long_to_bytes(int(bin(bytes_to_long(files[i]))[2:]+r[i]+w[i]+x[i],2)))</code></p>
<p>发现需要通过加密后的<code>files</code>和加密前的<code>files</code>来恢复<code>r</code>,<code>w</code>,<code>x</code></p>
<p>题目已经给出加密前的<code>files</code>，只需要爆破3位就可以知道<code>r</code>,<code>w</code>,<code>x</code></p>
<p>得到<code>r</code>,<code>w</code>,<code>x</code>以后</p>
<p>根据<code>f.write(hashlib.sha256(str(i)+urandom(2)).hexdigest()+&quot;\n&quot;)</code></p>
<p>来爆破<code>e</code>，因为e是flag每个字符转ASCII码右移3位后的值，所以$1 \le e \le 16$</p>
<p>又因为<code>urandom(2)</code>的值在$2^8 —2^{16}$之间（这个下限一开始找错了，从$2^{15}$一直试到$2^8$），这样以来，我们便确定了爆破范围</p>
<p>然后把<code>e</code>,<code>r</code>,<code>w</code>,<code>x</code>拼接转回字符就行</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;0.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">files = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">129</span>):</span><br><span class="line">    files.append(f.readline().strip())</span><br><span class="line"></span><br><span class="line">files1 = files[:<span class="number">43</span>]</span><br><span class="line">files2 = files[<span class="number">43</span>:<span class="number">43</span>*<span class="number">2</span>]</span><br><span class="line">files3 = files[<span class="number">43</span>*<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = []</span><br><span class="line">w = []</span><br><span class="line">x = []</span><br><span class="line">byte = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files1)):</span><br><span class="line">    byte_f = <span class="built_in">bytes</span>.fromhex(files1[i])</span><br><span class="line">    num_f = bytes_to_long(byte_f)</span><br><span class="line">    bin_f = <span class="built_in">bin</span>(num_f)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> product([<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;0&#x27;</span>],repeat=<span class="number">3</span>):</span><br><span class="line">        may_f = bin_f + <span class="string">&quot;&quot;</span>.join(j)</span><br><span class="line">        hash_f = hashlib.sha256(long_to_bytes(<span class="built_in">int</span>(may_f,<span class="number">2</span>))).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> hash_f == files2[i]:</span><br><span class="line">            r.append(<span class="string">&quot;&quot;</span>.join(j)[-<span class="number">3</span>])</span><br><span class="line">            w.append(<span class="string">&quot;&quot;</span>.join(j)[-<span class="number">2</span>])</span><br><span class="line">            x.append(<span class="string">&quot;&quot;</span>.join(j)[-<span class="number">1</span>])</span><br><span class="line">            byte.append(byte_f)</span><br><span class="line"></span><br><span class="line">e = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">43</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">        may_e = <span class="built_in">str</span>(i).encode()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>,<span class="number">2</span>**<span class="number">8</span>,-<span class="number">1</span>):</span><br><span class="line">            may = may_e + long_to_bytes(j)</span><br><span class="line">            hash_may = hashlib.sha256(may).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> hash_may == files3[k]:</span><br><span class="line">                e.append(may_e)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">43</span>):</span><br><span class="line">    bin_m = <span class="built_in">bin</span>(<span class="built_in">int</span>(e[i].decode()))[<span class="number">2</span>:] + x[i] + w[i] + r[i]</span><br><span class="line">    mm = <span class="built_in">int</span>(bin_m,<span class="number">2</span>)</span><br><span class="line">    m.append(<span class="built_in">chr</span>(mm))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag=&quot;</span>,flag)</span><br><span class="line"><span class="comment">#flag&#123;8uuuuu_dd_3yyyui_like_the_internet_g0&#125;</span></span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>Paillier算法</title>
    <url>/2023/08/23/Paillier%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<p>刷题过程中偶然涉及到Paillier算法</p>
<p>用博客的形式把他记录下来</p>
<span id="more"></span>

<p>Paillier算法属于半同态加密算法</p>
<h1 id="什么是同态加密-HE-？"><a href="#什么是同态加密-HE-？" class="headerlink" title="什么是同态加密(HE)？"></a>什么是同态加密(HE)？</h1><p>同态加密是一种特殊的加密方法，它允许直接对加密数据执行计算，如加法和乘法，而计算过程不会泄露原文的任何信息。计算的结果仍然是加密的，拥有密钥的用户对处理过的密文数据进行解密后，得到的正好是处理后原文的结果。</p>
<p>根据支持的计算类型和支持程度，同态加密可以分为以下三种类型：<strong>半同态加密</strong>，<strong>部分同态加密</strong>，<strong>全同态加密</strong></p>
<h2 id="半同态加密"><a href="#半同态加密" class="headerlink" title="半同态加密"></a>半同态加密</h2><p><strong>半同态加密</strong>(Partially Homomorphic Encryption, <strong>PHE</strong>)：只支持加法或乘法中的一种运算。其中，只支持加法运算的又叫加法同态加密（Additive Homomorphic Encryption, AHE），常见的有<strong>RSA</strong>，<strong>Elgamal</strong>，<strong>Paillier</strong></p>
<h2 id="部分同态加密"><a href="#部分同态加密" class="headerlink" title="部分同态加密"></a>部分同态加密</h2><p><strong>部分同态加密</strong>(Somewhat Homomorphic Encryption, <strong>SWHE</strong>)：可同时支持加法和乘法运算，但支持的计算次数有限</p>
<h2 id="全同态加密"><a href="#全同态加密" class="headerlink" title="全同态加密"></a>全同态加密</h2><p><strong>全同态加密</strong>(Fully Homomorphic Encryption, <strong>FHE</strong>)：支持任意次的加法和乘法运算</p>
<p>第一个满足加法和乘法同态的同态加密方法直到2009年才由Craig Gentry提出。目前来说，全同态加密算法性能较差，应用较少。比较常用的是半同态加密算法。</p>
<h1 id="Paillier算法"><a href="#Paillier算法" class="headerlink" title="Paillier算法"></a>Paillier算法</h1><h2 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h2><ol>
<li><p>随机选两个大素数$p,q$，满足$gcd(pq,(p-1)(q-1)) &#x3D; 1$，且$p,q$长度相同（安全性高一点）</p>
</li>
<li><p>计算$n &#x3D; pq$，以及$\lambda &#x3D; lcm(p-1,q-1)$，即$\lambda$是$p-1$和$q-1$的最小公倍数</p>
</li>
<li><p>随机选择$g \in Z_{n^2}^*$，表示$g$为$(0,n^2)$中的正整数，g还需满足$gcd(L(g^{\lambda} \mod n^2),n) &#x3D; 1$。后面发现$g &#x3D; n+1$满足条件，可以直接取$g &#x3D; n+1$</p>
</li>
<li><p>定义$L$函数：$L(x) &#x3D; \frac{x-1}{n}$，计算$\mu &#x3D; (L(g^{\lambda}\mod n^2))^{-1} \mod n$</p>
</li>
<li><p>公钥为$(n,g)$，私钥为$(\lambda,\mu)$</p>
</li>
</ol>
<h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><ol>
<li><p>明文$m$，满足$m \in Z_n$</p>
</li>
<li><p>选择随机数$r$，满足$r \in Z_n^*$</p>
</li>
<li><p>计算密文$c &#x3D; g^mr^n \mod n^2$</p>
</li>
</ol>
<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p>$m &#x3D; L(c^\lambda \mod n^2)×\mu \mod n$即$m &#x3D; \frac{L(c^\lambda \mod n^2)}{L(g^\lambda \mod n^2)} \mod n$</p>
<h2 id="解密的正确性"><a href="#解密的正确性" class="headerlink" title="解密的正确性"></a>解密的正确性</h2><p>根据二项式定理</p>
<p><img src="/../images/paper/2.png"></p>
<p>$\because g &#x3D; n+1,\therefore L(g^\lambda \mod n^2) &#x3D; \lambda$</p>
<p>$\therefore \mu &#x3D; (L(g^\lambda \mod n^2))^{-1} \mod n &#x3D; \lambda^{-1} \mod n$</p>
<p>$m&#x3D;L(c^\lambda \mod n^2)×\mu \mod n&#x3D; L((g^mr^n)^\lambda \mod n^2)× \lambda^{-1} \mod n$</p>
<p>又$\because L((g^mr^n)^\lambda \mod n^2) &#x3D; L(g^{\lambda m}r^{\lambda n} \mod n^2)$</p>
<p>而这个$\lambda n &#x3D; \frac{(p-1)(q-1)}{k}×pq$，其实就是$\frac{\phi(n^2)}{k}$</p>
<p>$\therefore L((g^mr^n)^\lambda \mod n^2) &#x3D; L(g^{\lambda m}r^{\lambda n} \mod n^2) &#x3D; \lambda m \mod n^2$</p>
<p>$\therefore m&#x3D;L(c^\lambda \mod n^2)×\mu \mod n&#x3D; L((g^mr^n)^\lambda \mod n^2)× \lambda^{-1} \mod n &#x3D; \lambda m ×\lambda^{-1} \mod n &#x3D; m$</p>
<h2 id="同态加法的性质"><a href="#同态加法的性质" class="headerlink" title="同态加法的性质"></a>同态加法的性质</h2><p>对于任意$m_1,m_2 \in Z_n$和任意$r_1,r_2 \in Z_n^*$</p>
<p>对应密文$c_1 &#x3D; E(m_1,r_1) &#x3D; g^{m_1}r_1^n$，$c_2 &#x3D; E(m_2,r_2) &#x3D; g^{m_2}r_2^{n}$</p>
<p>把密文作乘法$c &#x3D; c_1×c_2 &#x3D; g^{m_1+m_2}(r_1×r_2)^n \mod n^2$</p>
<p>把密文c解密得到的是$m_1+m_2$</p>
<p>即我们得到了：$c_1 × c_2 &#x3D; m_1 + m_2$，即密文乘等于明文加。</p>
<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="NISACTF-2022-public"><a href="#NISACTF-2022-public" class="headerlink" title="[NISACTF 2022]public"></a>[NISACTF 2022]public</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag=<span class="string">b&quot;NSSCTF&#123;xxxxxxxxxxxxxxxxxxx&#125;&quot;</span></span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">n = p*q</span><br><span class="line">g = n+<span class="number">1</span></span><br><span class="line">flag = flag + os.urandom(<span class="number">256</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c=(<span class="built_in">pow</span>(g,p,n*n)*<span class="built_in">pow</span>(m,n,n*n))%(n*n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c=<span class="subst">&#123;<span class="built_in">str</span>(c)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;<span class="built_in">str</span>(n)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint=<span class="subst">&#123;<span class="built_in">str</span>(<span class="built_in">pow</span>(m,n,n*n))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># c=</span></span><br><span class="line"><span class="comment"># n=</span></span><br><span class="line"><span class="comment"># hint=</span></span><br></pre></td></tr></table></figure>

<p>给出$hint \equiv m^n \mod n^2$</p>
<p>$\because c \equiv (g^p \mod n^2)×(m^n \mod n^2) \mod n^2$</p>
<p>可计算出$g^p \mod n^2$</p>
<p>$\because g &#x3D; n+1$</p>
<p>$\therefore g^p &#x3D; (n+1)^p &#x3D; n^p + n^{p-1} +… +n +1$</p>
<p>则$g^p \equiv \sum n^{奇数} + 1$ </p>
<p>则$g^p -1 &#x3D; (pq)^x +…+pq$，把它除去$n$以后（否则求出的公因数是n）再和$n$，求公因数得到p</p>
<p>又$\because hint \equiv m^n \mod n^2$</p>
<p>当作一个加密指数为$n$的RSA解密</p>
<p>解密指数$d$，应满足$nd \equiv 1 \mod n(p-1)(q-1)$</p>
<p>但这样求逆元是不存在的，我们转而求$nd \equiv 1 \mod (p-1)(q-1)$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c=<span class="number">218076151021560547051903316719541222512040541728274127251955864973204319200312422995983092104505370830336341646283643290975865810979693431665790610118752578450560322701464606111124759353729454729357651736630354926734261137232304018105525402480409214739463624926019853406667257471858400554068936984966255122726345392299611192889869061539625603262461395069803838256649227551122691722958477064737646079234633593322257264277828874899605785719884582898801922036376706945214557655573105936069927519342707813584133447394527727777145289236041783964596526172298751923527410923728437653793368452092818162677292173126395038239746952564824349029187021070624008127312777783389153721156471730690460245726539173442219919067086198412985379251064006364545842890512676104195964096685904104471607447579133813262242889948684214615216415152003486684332654021763372875688811108164167029372542655680239691864011325001804416649090546652965592245015233937378914902555020997254559783431091213187054225512285704706127222748135840936979571164239968858574619878355623067035562073147836429462588372618500946665592533980646179287203705864082701267348885216165672773119373427706470575290690902668785242467233967870570261108990892859880739698792351646244754952340844420919259404502699266393058426943569348443212550646905609608670176752388829848639990144513783071090027192962534454341704209113094332822171724354423757760205937173503650126923081671379294681026909824698111163520911268295889474804858820122835834292711776643387277793548733641809948674628119693459864760337483163877679917119388740268787073315582536101385769332216844206772200893152057186765390268976281904057200764887141067277637744939424349347335952574178492737111320884889894593413406720620482887249419382551684677812936351975305964980443771310389160311391859989139144435489943187361252326617436405569045786172471146825826484820533463066934499480104433398977611810330276369147938097117995654985458513989302241106332776904067311803420489090552556891879767682415265560743407340298578130798877648570926192953127574474259716781135801273211777116319348356510073635809816358623224620898024473581877733194648312939500788032519396047197931401057492369464362250728505049498537131676040902419082386902837490490020207391112191256297932073021141841637862479797419191517126847743253818063471644376196087415026020405982443713386674133996026381008967344619818015476575693412862275373303754013892689230528546297224836909468991043799205998787941893011</span></span><br><span class="line">n=<span class="number">508649864931677614732467390772427961758931524996950943172348989353779413500135745017318030372818346445171787306774776609051270954621980771071637593801560166625137373096310055034937710873339570248386417692379532713565448110999149898224125057983565314582568870217037082321220190178702247284057805478222196862321877126877541221804916630403210745798454726695767965708773814502024042373335280648703042654755304969849832318086242798067639199224298659205981289856966590499810461072473369452077687615913217546268362501813809748922922532657782215807173319693469430751556310985767810712372068465527832726893651833030643914873945580271625080157996808574695857605733101549978621472016493582602814890278818563043847095493265778824174731054566468708287724290549925230267719117266452407869862605078436659020887227224470196270187491398217001451889275579626459491632506953638949085966203707446055610214983015428316166700670710716910016807567113694397559364621848368518820842900845963635710936101678917277407976769668789284143702572735353391307624460327339616496606065042109014043456540221432729574605562610831787594345569772727113605355252600129915926507232161710531913156415953128254338208741867773085355435238760994755555830964013004019492562245961</span></span><br><span class="line">hint=<span class="number">218453179086923289943807203202770838925178689627774745147232020515098516891161432630028304346664762962142685215503546042472463188085210756898964960254583869432945520650866749585786670220495127010275938757711518963512690357966318771229029024139860779906436335668507703089169058834533472932888386221671186182247869434699020350251916212956639268455849140594527951127570312231046210122761381292092058171708887595484453711631828228850043342993869671675498781490707220852504338423236844200845629493885003815571053367960570828719514793961666314203716137708394529735950110878173175859966298104855781891314256393660478947857997049309347664916363312769426872393903240797057291513182057786294193463281179876929436423970304992964378978343703058273610599094670858299390115880959442514513002687898361714995376183382702580310860520166550246905769724461107221385567718477106980293610194354260662299313387637029454859051754049141731708862005007657254777005078937290648653252057172789665484106225904252249322285164277069353595858401391763857781471982430400812430485462777863701578165740021651239264400111602346875691919587562776319002092593590043298682899772829734368041057265219520645505796166918571599787733464916168997021422429642875880015201743138557239246816614645961943942384226721696842364578221142494114967457346538723563534281835490913459152865031135512888020156712332950698315471031328945767161582387501768383019764191345069522790270253976284543970378444427727423121536104008553289510510497088596599741651012409020454471902200942494893254608355219933431097693790764370965829619433976045850073467615077879096698409574487772631069225578624386542659818683559823001358916184145187794138636007200677181455572920942709512649217555102476437241677652845050079961562071604521307752725300453167225947534296744839161286409625003203181858982730609149419917332043428767843293277924022007390853988328511663307394805322715579362345649842431371200748639996476587970393904239732072852670279076966635546790856059886353247283187091483814130965265452117641315707359747672993447721009270939662160468115475733881984431822454194850017395548046798675473636140217840418467588166347095543815767317284635513061287105795015042775738353765062476084211922890124244419037796630154403434882572164730631883001098922170198642065216541425903144234820480236095640278292837060194123091442480170728800340689332104613912950234195039809087610879082689821270573215009809335626725761798981628604037461376378712686098</span></span><br><span class="line"></span><br><span class="line">inv_hint = gmpy2.invert(hint,n**<span class="number">2</span>)</span><br><span class="line">temp = c * inv_hint % n**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n,(temp-<span class="number">1</span>)//n)</span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(n,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(hint,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>格密码进阶</title>
    <url>/2023/08/25/%E6%A0%BC%E5%AF%86%E7%A0%81%E8%BF%9B%E9%98%B6/</url>
    <content><![CDATA[<p>刷题过程中，接触到有关格更进一步的问题</p>
<span id="more"></span>

<h1 id="隐藏数问题（HNP-Hidden-Number-Problem）"><a href="#隐藏数问题（HNP-Hidden-Number-Problem）" class="headerlink" title="隐藏数问题（HNP &#x2F; Hidden Number Problem）"></a>隐藏数问题（HNP &#x2F; Hidden Number Problem）</h1><p>打WMCTF的时候偶然接触这个感念，便在<a href="https://lazzzaro.github.io/2020/11/07/crypto-%E6%A0%BC%E5%AF%86%E7%A0%81/">la佬的博客</a>学习了一下</p>
<p>大概就是下面这样的形式</p>
<p>由$k_i \equiv A_ix + B_i \mod p$</p>
<p>如果有多组$k_i,A_i,B_i$</p>
<p>可以通过构造格，来求得这个x</p>
<p><img src="/../images/Lattice2/20.png"></p>
<p>$K$是$k_i$的上界</p>
<p>我的在疑惑是否可以自己调参，而不是套用别人构造的格呢？</p>
<p><img src="/../images/Lattice2/21.png"></p>
<p>根据具体情况调参</p>
<p>两种情况在实际测试过程中并没有成功。能恢复出bit位一样，但是值不对</p>
<p>会不会是因为数据之间得满足某些关系，才能用格恢复</p>
<p>希望懂的师傅们指点指点</p>
<p>下面分享一些有关HNP的题目</p>
<p>第一个当然是WM</p>
<h2 id="WMCTF2023——signin"><a href="#WMCTF2023——signin" class="headerlink" title="WMCTF2023——signin"></a>WMCTF2023——signin</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">bit</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        P = getPrime(bit)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(P)) - <span class="number">2</span> == bit:</span><br><span class="line">            <span class="keyword">return</span> P</span><br><span class="line"></span><br><span class="line">pq_bit = <span class="number">512</span></span><br><span class="line">offset = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">P,Q = [gen_prime(pq_bit) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">N = P * Q</span><br><span class="line">gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(P ^ (Q &gt;&gt; offset))[<span class="number">2</span>+offset:],<span class="number">2</span>)</span><br><span class="line">pr(N)</span><br><span class="line">pr(gift)</span><br><span class="line"></span><br><span class="line">inpP = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> inpP != P:</span><br><span class="line">    pr(<span class="string">b&quot;you lose!&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">secret = randrange(<span class="number">0</span>,P)</span><br><span class="line">bs = [randrange(<span class="number">0</span>,P) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>)]</span><br><span class="line"></span><br><span class="line">results = [(bi * secret) % P <span class="keyword">for</span> bi <span class="keyword">in</span> bs]</span><br><span class="line">rs = [ri &amp; (<span class="number">2</span> ** offset - <span class="number">1</span>)  <span class="keyword">for</span> ri <span class="keyword">in</span> results]</span><br><span class="line"></span><br><span class="line">pr(bs)</span><br><span class="line">pr(rs)</span><br><span class="line">inpsecret = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> inpsecret == secret:</span><br><span class="line">    pr(flag)</span><br></pre></td></tr></table></figure>

<p>又是p ^ q这类的题目，类似于DAS7月赛</p>
<p>先遍历$2^{15}——2^{16}$恢复出gift，再爆出p,q</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = </span><br><span class="line">N = </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">15</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(j)[<span class="number">2</span>:] +<span class="built_in">bin</span>(h)[<span class="number">2</span>:].rjust(<span class="number">496</span>,<span class="string">&#x27;0&#x27;</span>),<span class="number">2</span>)</span><br><span class="line">    pbar = gift &gt;&gt;(<span class="number">512</span>-<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            qbar = (N&gt;&gt;(<span class="number">1024</span> - pbar.bit_length()*<span class="number">2</span>))//pbar</span><br><span class="line">            qbar = qbar&gt;&gt;<span class="number">6</span></span><br><span class="line">            gifts = gift^(qbar&lt;&lt;(<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length()))</span><br><span class="line">            pbar = gifts &gt;&gt; (<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        p = (pbar&lt;&lt;<span class="number">6</span>)+i</span><br><span class="line">        <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">            q = N//p</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] p =&quot;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] q =&quot;</span>,q)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>$\because R_i \equiv  B_i × secret \mod p $，题目只给出了$R_i$的低16位</p>
<p>$\therefore r_i \equiv R_i \mod 2^{16}$</p>
<p>$\therefore r_i \equiv (B_i×secret \mod 2^{16}) \mod p \longrightarrow r_i \equiv B_i×secret + k_i×2^{16} \mod p$</p>
<p>$\therefore k_i×2^{16} \equiv B_i×secret -r_i \mod p \longrightarrow k_i \equiv B_i×secret×inv - r_i×inv \mod p $这里$inv$是$2^{16}$模$p$的逆元</p>
<p>最后可以得到$k_i &#x3D; B_i×secret×inv - r_i×inv + l_ip$</p>
<p>于是有</p>
<p><img src="/../images/Lattice2/22.png"></p>
<p>这里的$k_i \approx 496bit$，所以取$K&#x3D;2^{496}$，为了让右边向量的值都差不多大，调出$\frac{K×secret}{p}$</p>
<p>因为这题不是很清楚secret的大小，我就直接套脚本了。</p>
<p>现学的，理解不是很透彻</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = </span><br><span class="line">N = </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">15</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(j)[<span class="number">2</span>:] +<span class="built_in">bin</span>(h)[<span class="number">2</span>:].rjust(<span class="number">496</span>,<span class="string">&#x27;0&#x27;</span>),<span class="number">2</span>)</span><br><span class="line">    pbar = gift &gt;&gt;(<span class="number">512</span>-<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            qbar = (N&gt;&gt;(<span class="number">1024</span> - pbar.bit_length()*<span class="number">2</span>))//pbar</span><br><span class="line">            qbar = qbar&gt;&gt;<span class="number">6</span></span><br><span class="line">            gifts = gift^(qbar&lt;&lt;(<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length()))</span><br><span class="line">            pbar = gifts &gt;&gt; (<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        p = (pbar&lt;&lt;<span class="number">6</span>)+i</span><br><span class="line">        <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">            q = N//p</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] p =&quot;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] q =&quot;</span>,q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">B = </span><br><span class="line">R = </span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(R)</span><br><span class="line"></span><br><span class="line">M = Matrix(QQ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">inv = invert(<span class="number">2</span> ** <span class="number">16</span>,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M[i,i] = p</span><br><span class="line">    M[-<span class="number">2</span>,i] = B[i] * inv</span><br><span class="line">    M[-<span class="number">1</span>,i] = -R[i] * inv</span><br><span class="line"></span><br><span class="line">t = QQ(<span class="number">2</span>^<span class="number">496</span> / p)</span><br><span class="line">K = <span class="number">2</span>^<span class="number">496</span></span><br><span class="line"></span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>] = t</span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = K</span><br><span class="line"></span><br><span class="line">L = M.LLL()</span><br><span class="line"></span><br><span class="line">x = L[<span class="number">1</span>][-<span class="number">2</span>] // t</span><br><span class="line"><span class="built_in">print</span>(x % p)</span><br></pre></td></tr></table></figure>



<h2 id="2023闽盾杯DDSA"><a href="#2023闽盾杯DDSA" class="headerlink" title="2023闽盾杯DDSA"></a>2023闽盾杯DDSA</h2><p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randbytes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">prime_q = <span class="number">127421879856060385096053898551127157118456253994158974724886976404028426764068562017096096817549513218041429679987628739034764964376732733276949462214328863705096240012832165273860133745796844957157858326462845401062317289670577559619496217615868033525902303096223754465050250835491302759273614202275099668351</span></span><br><span class="line">prime_p = <span class="number">2</span> * prime_q + <span class="number">1</span></span><br><span class="line">generator = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_keys</span>(<span class="params">prime_p:<span class="built_in">int</span>, prime_q: <span class="built_in">int</span>, generator: <span class="built_in">int</span></span>):</span><br><span class="line">    private_key = <span class="built_in">int</span>(randbytes(<span class="number">48</span>).<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">    public_key = <span class="built_in">pow</span>(generator, private_key, prime_p)</span><br><span class="line">    <span class="keyword">return</span> private_key, public_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">signature</span>(<span class="params">m: <span class="built_in">str</span>, private_key: <span class="built_in">int</span></span>):</span><br><span class="line">    ephemeral_key = <span class="built_in">pow</span>(<span class="built_in">int</span>.from_bytes(m.encode(), <span class="string">&quot;big&quot;</span>), -<span class="number">1</span>, prime_q)</span><br><span class="line">    value_r = <span class="built_in">pow</span>(generator, ephemeral_key, prime_p) % prime_q</span><br><span class="line">    hash_value = sha256(m.encode()).hexdigest()</span><br><span class="line">    value_s = <span class="built_in">pow</span>(ephemeral_key, -<span class="number">1</span>, prime_q) * (<span class="built_in">int</span>(hash_value, <span class="number">16</span>) + private_key * value_r) % prime_q</span><br><span class="line">    <span class="keyword">return</span> hash_value, value_r, value_s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verification</span>(<span class="params">message_hash: <span class="built_in">str</span>, value_r: <span class="built_in">int</span>, value_s: <span class="built_in">int</span>, public_key: <span class="built_in">int</span></span>):</span><br><span class="line">    message_hash = <span class="built_in">int</span>(message_hash, <span class="number">16</span>)</span><br><span class="line">    inverse_s = <span class="built_in">pow</span>(value_s, -<span class="number">1</span>, prime_q)</span><br><span class="line">    u1 = message_hash * inverse_s % prime_q</span><br><span class="line">    u2 = value_r * inverse_s % prime_q</span><br><span class="line">    value_v = (<span class="built_in">pow</span>(generator, u1, prime_p) * <span class="built_in">pow</span>(public_key, u2, prime_p) % prime_p) % prime_q</span><br><span class="line">    <span class="keyword">return</span> value_v == value_r</span><br><span class="line"></span><br><span class="line">private_key, public_key = generate_keys(prime_p, prime_q, generator)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;prime_p = <span class="subst">&#123;prime_p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;prime_q = <span class="subst">&#123;prime_q&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;generator = <span class="subst">&#123;generator&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;public_key = <span class="subst">&#123;public_key&#125;</span>&quot;</span>)</span><br><span class="line">hash_value, value_r, value_s = signature(FLAG, private_key)</span><br><span class="line"><span class="keyword">assert</span> verification(hash_value, value_r, value_s, public_key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;FLAG= *******************************&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Here is your gift = <span class="subst">&#123;hash_value&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;value_r = <span class="subst">&#123;value_r&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;value_s = <span class="subst">&#123;value_s&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">prime_p = <span class="number">254843759712120770192107797102254314236912507988317949449773952808056853528137124034192193635099026436082859359975257478069529928753465466553898924428657727410192480025664330547720267491593689914315716652925690802124634579341155119238992435231736067051804606192447508930100501670982605518547228404550199336703</span></span><br><span class="line">prime_q = <span class="number">127421879856060385096053898551127157118456253994158974724886976404028426764068562017096096817549513218041429679987628739034764964376732733276949462214328863705096240012832165273860133745796844957157858326462845401062317289670577559619496217615868033525902303096223754465050250835491302759273614202275099668351</span></span><br><span class="line">generator = <span class="number">2</span></span><br><span class="line">public_key = <span class="number">67243435243013084147486854556817234112402511481243660325565023251853355494433326575673419694681555652669449040366620819266474334253578972440047168279142184141910485872726393507923996391796227576994885784959692699388957187699662551912804856807879764447982440118185734843107861320087767180763032071844141444498</span></span><br><span class="line">hash_value = <span class="string">&#x27;1cd920cc96d95280c96dd519df9ef49fed44c0ccfc80202372d1d196ea52ccb1&#x27;</span></span><br><span class="line">value_r = <span class="number">55738970979693187681378167695787130117222895714960965190485398883361826593727577547551100491285488657995662094510198245807164881975668033129508588482949937072551764160574163358989597712065236233432502150653495180122562651440328815420270936429340024510654195118602283837975822678425908768515924976212206091388</span></span><br><span class="line">value_s = <span class="number">16167384383010337939063062611160328697878797853686180912699394152331808942993583340068941838844464059078517385061012722104618040645796346201205622044690989665622791251498050801728558982153896995503905626972211668853043513769350513237538819164197920332285202321957958655237257294973629465658550364418471213584</span></span><br></pre></td></tr></table></figure>

<p>题目把$m$当作$k^{-1}$，把m的哈希值记作$H$，$x$是私钥</p>
<p>已知$s \equiv k^{-1}×(H + xr) \mod q$即$s \equiv m(H+xr) \mod q$</p>
<p>其中，$H,r,q,s$已知</p>
<p>做个推导$\because s \equiv mH+mxr \mod q \longrightarrow sH^{-1} \equiv m + mxrH^{-1} \mod q$</p>
<p>$\therefore m &#x3D; sH^{-1}-mxrH^{-1} +kq$，$sH^{-1}$看作常数$B$，$-rH^{-1}$看作$A$，令$mx&#x3D;t$</p>
<p>于是有$m &#x3D; At + B + kq$</p>
<p>构造格</p>
<p><img src="/../images/Lattice2/18.png"></p>
<p>猜测$m \approx 320bit$，因为$x \approx 384bit$，所以$t \approx 2^{384+320}$</p>
<p>所以构造出$1&#x2F;2^{384}$，使得目标向量每个值差不多大</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">pb = </span><br><span class="line">h = <span class="string">&#x27;1cd920cc96d95280c96dd519df9ef49fed44c0ccfc80202372d1d196ea52ccb1&#x27;</span></span><br><span class="line">r = </span><br><span class="line">s = </span><br><span class="line"></span><br><span class="line">H = <span class="built_in">int</span>(h,<span class="number">16</span>)</span><br><span class="line">inv = gmpy2.invert(H,q)</span><br><span class="line">A = -r*inv</span><br><span class="line">B = s*inv</span><br><span class="line"></span><br><span class="line">M = [[q,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">      [A,<span class="number">1</span>/<span class="number">2</span>^<span class="number">384</span>,<span class="number">0</span>],</span><br><span class="line">      [B,<span class="number">0</span>,<span class="number">2</span>^<span class="number">320</span>]]</span><br><span class="line"></span><br><span class="line">Ge = Matrix(M)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">2</span>^<span class="number">320</span>:</span><br><span class="line">        m = i[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h2 id="BabyHNP"><a href="#BabyHNP" class="headerlink" title="BabyHNP"></a>BabyHNP</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from random import randint</span><br><span class="line">import libnum</span><br><span class="line">import os</span><br><span class="line">assert len(flag) == 44</span><br><span class="line"></span><br><span class="line">def padding(f):</span><br><span class="line">    return f + os.urandom(64 - 1 - len(f))</span><br><span class="line"></span><br><span class="line">n = 5</span><br><span class="line">m = libnum.s2n(padding(flag))</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">A = [randint(1, q) for i in range(n)]</span><br><span class="line">B = [A[i] * m % q for i in range(n)]</span><br><span class="line">b = [B[i] % 2**128 for i in range(n)]</span><br><span class="line"></span><br><span class="line">print(&#x27;q = %s&#x27; % q)</span><br><span class="line">print(&#x27;A = %s&#x27; % A)</span><br><span class="line">print(&#x27;b = %s&#x27; % b)</span><br></pre></td></tr></table></figure>

<p>感谢Harry师傅提供的题目</p>
<p>$\because B_i \equiv A_im \mod q$，$b_i \equiv B_i \mod 2^{128}$</p>
<p>$\therefore B_i &#x3D; b_i + k_i×2^{128}$</p>
<p>$\therefore b_i+k_i×2^{128} \equiv A_im \mod q \longrightarrow k_i×2^{128} \equiv A_im-b_i \mod q$</p>
<p>$\therefore k_i \equiv A_im×inv - b_i×inv \mod q$，inv是$2^{128}$模$q$的逆元</p>
<p>$\therefore k_i &#x3D; A_im×inv - b_i×inv +l_iq$</p>
<p><img src="/../images/Lattice2/23.png"></p>
<p>这里$k_i \approx 2^{384}$，所以$K&#x3D; 2^{384}$</p>
<p>因为$m \approx 2^{512}$，为了让最后目标向量差不多大，$K&#x2F;q$这个位置可以换成$\frac{1}{2^{128}}$差不多大的值</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">B = [, , , , ]</span><br><span class="line">R = [, , , , ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(R)</span><br><span class="line"></span><br><span class="line">M = Matrix(QQ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">inv = invert(<span class="number">2</span> ** <span class="number">128</span>,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M[i,i] = p</span><br><span class="line">    M[-<span class="number">2</span>,i] = B[i] * inv</span><br><span class="line">    M[-<span class="number">1</span>,i] = -R[i] * inv</span><br><span class="line"></span><br><span class="line">t = <span class="number">1</span> / <span class="number">2</span>^<span class="number">128</span></span><br><span class="line">K = <span class="number">2</span>^<span class="number">384</span></span><br><span class="line"></span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>] = t</span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = K</span><br><span class="line"></span><br><span class="line">L = M.LLL()</span><br><span class="line"></span><br><span class="line">x = L[<span class="number">1</span>][-<span class="number">2</span>] // t</span><br><span class="line">m = x % p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(m).bit_length())</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h2 id="HGAME-2023-week4-LLLCG-Revenge"><a href="#HGAME-2023-week4-LLLCG-Revenge" class="headerlink" title="[HGAME 2023 week4]LLLCG Revenge"></a>[HGAME 2023 week4]LLLCG Revenge</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.n = next_prime(<span class="number">2</span>**<span class="number">360</span>)</span><br><span class="line">        self.a = bytes_to_long(flag)</span><br><span class="line">        self.seed = randint(<span class="number">1</span>, self.n-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.seed * self.a + randint(-<span class="number">2</span>**<span class="number">340</span>, <span class="number">2</span>**<span class="number">340</span>)) % self.n</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line">lcg = LCG()</span><br><span class="line"></span><br><span class="line">outputs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    outputs.append(lcg.<span class="built_in">next</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(outputs))</span><br></pre></td></tr></table></figure>

<p>$X_{i+1} \equiv aX_i + b_i \mod n$</p>
<p>$\therefore X_{i+1} &#x3D; aX_i + b_i + k_in \longrightarrow b_i &#x3D; X_{i+1} - aX_i + k_in$</p>
<p>HNP问题</p>
<p>构造格</p>
<p><img src="/../images/Lattice2/33.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = next_prime(<span class="number">2</span>^<span class="number">360</span>)</span><br><span class="line">x = [...]</span><br><span class="line"></span><br><span class="line">Ge = Matrix(QQ,<span class="number">41</span>,<span class="number">41</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    Ge[i,i] = n</span><br><span class="line">    Ge[-<span class="number">2</span>,i] = x[i]</span><br><span class="line">    Ge[-<span class="number">1</span>,i] = x[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">2</span>^<span class="number">340</span></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">1</span>]) == <span class="number">2</span>^<span class="number">340</span>:</span><br><span class="line">        a = <span class="built_in">abs</span>(i[-<span class="number">2</span>])</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(a)))</span><br></pre></td></tr></table></figure>

<p>另外一种格</p>
<p><img src="/../images/Lattice2/34.png"></p>
<p>其中$K &#x3D; 2^{340}$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = next_prime(<span class="number">2</span>^<span class="number">360</span>)</span><br><span class="line">x = [...]</span><br><span class="line"></span><br><span class="line">Ge = Matrix(QQ,<span class="number">41</span>,<span class="number">41</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">39</span>):</span><br><span class="line">    Ge[i,i] = n</span><br><span class="line">    Ge[-<span class="number">2</span>,i] = x[i]</span><br><span class="line">    Ge[-<span class="number">1</span>,i] = x[i+<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">t = QQ(<span class="number">2</span>^<span class="number">340</span> / n)</span><br><span class="line"></span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">2</span>^<span class="number">340</span></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = t</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">1</span>]) == <span class="number">2</span>^<span class="number">340</span>:</span><br><span class="line">        a = ZZ(i[-<span class="number">2</span>] / (t))</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">abs</span>(a)))</span><br></pre></td></tr></table></figure>

<h2 id="未知来源"><a href="#未知来源" class="headerlink" title="未知来源"></a>未知来源</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag&#123;xxxxxxx&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">38</span></span><br><span class="line">p = getPrime(<span class="number">300</span>)</span><br><span class="line">t = <span class="number">30</span></span><br><span class="line">x1,x2 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    a = random.randint(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        b = (a * x1 % p) &gt;&gt; (<span class="number">300</span> - <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        b = (a * x2 % p) &amp; (<span class="number">2</span> ** <span class="number">30</span> - <span class="number">1</span>)</span><br><span class="line">    A.append(a)</span><br><span class="line">    B.append(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = [<span class="number">463887498379837178289434930796937204555475877586622290749258048874370169798799337104469937</span>, <span class="number">773107696240723064348524874255963716154847723824140324851906738257594371092025839092322618</span>, <span class="number">959382311121888872352942066453176913016345159699733628226033809692442378255600652170133603</span>, <span class="number">1475439387312927400751305948540244549759336332552059673660666894619118830047069015157686938</span>, <span class="number">849526462831348819335657678027942464464758618063917043187129057068191653250289714276486390</span>, <span class="number">1334127037206856127523941580821068150671372041649866724020399671459149591275291992977444717</span>, <span class="number">270665083631525557759154548751201812246030483353898310710004039080238333516013780476382216</span>, <span class="number">1018902660322104052776222955411066044807125950939527765041383184188103427291053881056928575</span>, <span class="number">209244905602559751670010690327768486619524571513992042827189611303489897515540986981111728</span>, <span class="number">1448752767778370938295347623067314667365820805495380149782146153110745097342875410404772323</span>, <span class="number">259828604923763561672700195721292502767730876290458742290887049867931720014196470106481233</span>, <span class="number">64955927829662789888801246059321257505518334913081564868033981302809434355859085577340789</span>, <span class="number">541853690860409175470448997776819435952775864942641589293140819248380415841093286149509439</span>, <span class="number">1139888865143435145477538463183158820201430904436762627802923622604703492742131126856361559</span>, <span class="number">1275201358819804049372292362561266777547371187070453684762542985512809430125709931354890689</span>, <span class="number">369607296264184981154638102500387132578476452666540211313258531786190436544288889435124252</span>, <span class="number">806708347908045807047609135976903208402075815467445877191713196364943763493569595760618980</span>, <span class="number">1455987609449801976533130312961654430816056114205781282886620693328977276162282426493869107</span>, <span class="number">78240737983903215239118749844347047542830586146993600511897384363311151546231920353144287</span>, <span class="number">178433523161741238741165004364134882377268446191666891015503424004703296483616704501522431</span>, <span class="number">160833029194895051498255704447576591540146606885321132274228852060778655408117052809405842</span>, <span class="number">665439140689838885724776126488323057267424913454382363615180272084605737991756925728109752</span>, <span class="number">1212399960630524647715423021430580541043060607704004760594818883478379710374660040225211737</span>, <span class="number">1024104693386208450852231949868224748229315263011728008967767316172947909984939303025784616</span>, <span class="number">1172245617567690331560150298653167704336960464136186977917753583487333782434094205711336284</span>, <span class="number">783927796969236661199653579569651324291785925516516459946058680074574047025620354913449506</span>, <span class="number">662785009487244748764576805406718936165913097166011574087131710238816769129253409163197996</span>, <span class="number">176622195892476124982696054672313827341938528038522227778420609502821124526352064161794848</span>, <span class="number">1207882741313080019507286406568893562247091201154746129221516369048603742944945854959243209</span>, <span class="number">865971631872293774191772297150903858147356635890878227481230935983612340880935090288780814</span>]</span><br><span class="line">B = [<span class="number">213262950</span>, <span class="number">338585619</span>, <span class="number">651186563</span>, <span class="number">161224022</span>, <span class="number">614133782</span>, <span class="number">358709201</span>, <span class="number">81465247</span>, <span class="number">606102220</span>, <span class="number">333896117</span>, <span class="number">244095320</span>, <span class="number">29938894</span>, <span class="number">126014939</span>, <span class="number">555731335</span>, <span class="number">373319033</span>, <span class="number">662799251</span>, <span class="number">517458562</span>, <span class="number">33441774</span>, <span class="number">922070946</span>, <span class="number">236657217</span>, <span class="number">323031182</span>, <span class="number">143007144</span>, <span class="number">9082131</span>, <span class="number">230128400</span>, <span class="number">805207434</span>, <span class="number">699486605</span>, <span class="number">511887222</span>, <span class="number">957047430</span>, <span class="number">474639197</span>, <span class="number">74284022</span>, <span class="number">547483878</span>]</span><br><span class="line">p = <span class="number">1515897080671400659075132434127277346281580386706329236487649363388239277840368389427768563</span></span><br></pre></td></tr></table></figure>

<h3 id="Part1"><a href="#Part1" class="headerlink" title="Part1"></a>Part1</h3><p>$\because B_i \equiv A_ix_1 \mod p$</p>
<p>$\therefore B_i &#x3D; A_ix_1 + k_ip$，把$B_i$分成高低位相加</p>
<p>即$B_{iHigh} + B_{iLow} - A_ix_1 + k_ip$</p>
<p>$\therefore B_{ilow} &#x3D; A_ix_1 + k_ip - B_{iHigh}$</p>
<p>构造格</p>
<p><img src="/../images/Lattice2/35.png"></p>
<h3 id="Part2"><a href="#Part2" class="headerlink" title="Part2"></a>Part2</h3><p>$\because B_i \equiv A_ix_2 \mod p$，题目给出低30位</p>
<p>即$b_i \equiv B_i \mod 2^{30}$</p>
<p>$\therefore b_i \equiv (A_ix_2 \mod p) \mod 2^{30}$，因为<code> b = (a * x2 % p)</code>，所以可以把模$2^{30}$放里面</p>
<p>即$b_i \equiv (A_ix_2 \mod 2^{30}) \mod p \longrightarrow b_i \equiv (A_ix_2 + l_i\times 2^{30}) \mod p$</p>
<p>$\therefore l_i \times 2^{30} \equiv A_ix_2 - b_i \mod p \longrightarrow l_i \equiv A_ix_2 \times inv - b_i \times inv \mod p$</p>
<p>最后得到$l_i &#x3D; A_ix_2 \times inv - b_i \times inv +k_ip$，其中$inv$是$2^{30}$模$p$的逆元</p>
<p>$l_i \approx 2^{270}$</p>
<p>构造格</p>
<p><img src="/../images/Lattice2/36.png"></p>
<p>或者</p>
<p><img src="/../images/Lattice2/36(1).png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">A = [...]</span><br><span class="line">B = [...]</span><br><span class="line">p = <span class="number">1515897080671400659075132434127277346281580386706329236487649363388239277840368389427768563</span></span><br><span class="line"></span><br><span class="line">A1 = A[<span class="number">0</span>:<span class="number">15</span>]</span><br><span class="line">A2 = A[<span class="number">15</span>:]</span><br><span class="line">B1 = B[<span class="number">0</span>:<span class="number">15</span>]</span><br><span class="line">B2 = B[<span class="number">15</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1</span></span><br><span class="line">M = matrix(ZZ,<span class="number">17</span>,<span class="number">17</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    M[i, i] = p</span><br><span class="line">    M[-<span class="number">2</span>, i] = A1[i]</span><br><span class="line">    M[-<span class="number">1</span>, i] = B1[i] &lt;&lt; <span class="number">270</span></span><br><span class="line">M[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">2</span>^(<span class="number">270</span> - <span class="number">19</span>*<span class="number">8</span>)</span><br><span class="line">M[-<span class="number">1</span>, -<span class="number">1</span>] = <span class="number">2</span>^<span class="number">270</span></span><br><span class="line"><span class="comment"># print(M.LLL())</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">1</span>]) == <span class="number">2</span>^<span class="number">270</span>:</span><br><span class="line">        x1 = <span class="built_in">abs</span>(i[-<span class="number">2</span>]) // <span class="number">2</span>^(<span class="number">270</span> - <span class="number">19</span>*<span class="number">8</span>)</span><br><span class="line">        flag1 = long_to_bytes(<span class="built_in">int</span>(x1))</span><br><span class="line">        <span class="built_in">print</span>(flag1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">M1 = Matrix(QQ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">inv = invert(<span class="number">2</span> ** <span class="number">30</span>,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M1[i,i] = p</span><br><span class="line">    M1[-<span class="number">2</span>,i] = A2[i] * inv</span><br><span class="line">    M1[-<span class="number">1</span>,i] = B2[i] * inv</span><br><span class="line"></span><br><span class="line">t = QQ(<span class="number">2</span>^<span class="number">270</span> / p)</span><br><span class="line">K = <span class="number">2</span>^<span class="number">270</span></span><br><span class="line"></span><br><span class="line">M1[-<span class="number">2</span>,-<span class="number">2</span>] = t</span><br><span class="line">M1[-<span class="number">1</span>,-<span class="number">1</span>] = K</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M1.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">1</span>]) == K:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        x2 = <span class="built_in">int</span>(<span class="built_in">abs</span>(i[-<span class="number">2</span>]) // t)</span><br><span class="line">        flag2 = long_to_bytes(x2)</span><br><span class="line">        <span class="built_in">print</span>(flag2)</span><br><span class="line">        </span><br><span class="line">flag = flag1 + flag2</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://blog.csdn.net/qq_41626232/article/details/129964038?spm=1001.2014.3001.5502">lattice的HNP问题学习_无趣的浅的博客-CSDN博客</a></p>
<p><a href="https://www.anquanke.com/post/id/204846">浅尝 Lattice 之 HNP-安全客 - 安全资讯平台 (anquanke.com)</a></p>
<h1 id="子集和问题（HSP-Hideen-Sum-Problem）"><a href="#子集和问题（HSP-Hideen-Sum-Problem）" class="headerlink" title="子集和问题（HSP&#x2F;Hideen Sum Problem）"></a>子集和问题（HSP&#x2F;Hideen Sum Problem）</h1><p>子集和问题的一个实例为&lt;S，t&gt;。其中，$S&#x3D;\begin{Bmatrix}{x_1,x_2,\dots,x_n}\end{Bmatrix}$是一个正整数的<a href="https://so.csdn.net/so/search?q=%E9%9B%86%E5%90%88&spm=1001.2101.3001.7020">集合</a>，c是一个正整数。子集和问题判定是否存在S的一个子集$S_1$，使得子集$S_1$的和等于c。</p>
<p>背包密码就是个子集和问题，见另一篇博客</p>
<h2 id="MoeCTF2022——MiniMiniBackPack"><a href="#MoeCTF2022——MiniMiniBackPack" class="headerlink" title="MoeCTF2022——MiniMiniBackPack"></a>MoeCTF2022——MiniMiniBackPack</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">size</span>):</span><br><span class="line">    s = <span class="number">1000</span></span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">        a = random.randint(s + <span class="number">1</span>, <span class="number">2</span> * s)</span><br><span class="line">        <span class="keyword">assert</span> a &gt; <span class="built_in">sum</span>(key)</span><br><span class="line">        key.append(a)</span><br><span class="line">        s += a</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">L = <span class="built_in">len</span>(<span class="built_in">bin</span>(m)[<span class="number">2</span>:])</span><br><span class="line">key = gen_key(L)</span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):</span><br><span class="line">    c += key[i]**(m&amp;<span class="number">1</span>)</span><br><span class="line">    m &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<p><code>gen_key</code>生成超递增序列。$c$由背包加密得来，题目把$c$和私钥都给了。</p>
<p>把$c$依次和序列中最大的值比较即可求解</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">key = [1928, 4648, 12352, 24010, 58760, 148406, 441469, 906294, 2347544, 4145527, 13246047, 33012060, 104677731, 233784625, 398671830, 1138569375, 3847891246, 7151230548, 17442630021, 46416620988, 118857237060, 363519789685, 661956375011, 1712300152639, 4761949150147, 8964540458636, 24746310311237, 62452210349278, 150016895989040, 453927852027278, 948923770773559, 3275343477577565, 5756783232753127, 13616706687879089, 26402320025439836, 91814578040763059, 211796919962932717, 385545413311588646, 742071895214889791, 2137385737378343660, 5820500440463297078, 15401185997444609852, 49206779920875282228, 101148479344021765606, 205390946600728256099, 593695571211967641654, 1163476540184124239753, 3920275177926640702128, 11188401781366603668803, 26452211702098700985776, 56612547941955968739356, 176511950177344415872304, 350456159524844834233165, 932655004294881661656249, 3077731648705646793828507, 9127653332576335535543235, 14107124912327219069005253, 53639235705342264540097281, 139903414487199921597126219, 377113327325865137005647964, 797007439689940464465071770, 2456373221352926158802602905, 4997725491122440484756502995, 17601885978368777637676626066, 27945705300453872028061217316, 70259455336271034962808380541, 241339934663279791843376677893, 565927167417896365819102921696, 1498269591024734505946670540129, 4476165672138335294342834148717, 8246962867693878472370951037335, 29609522845816295639745215494800, 71952214344473760246502727717474, 169361817288205588754741757159731, 390045301314759178244461824288458, 1337540279161737220902909199776611, 3221480198479784802709388960779700, 9670513515504338974817616478456700, 16261746247432868145400788404115430, 53594268392537203440232335914792279, 142627442102890550431018293710429426, 249683635647920776857130562696997561, 689878480570146636843962995034183967, 1647889244922264517646376201060969417, 4362391204795633804803911898013660682, 11983025462449787764688227594361812707, 19474005190319410527122673327870913310, 40950423948271412394664153066384954054, 139255978428478610787399242087880835737, 382133188700471370531564036246745271608, 618340037056166043673108074267387394368, 1728641328632513907826054966389623526131, 4246454964077064700888723109771772689322, 7526932088676669848792644586429545161503, 14761773428394206759829134632198244970685, 42336665776969730227150513015344171877811, 73191053942159553542196382411683917861300, 211549032502894704558541919050681697675397, 554709644259380577558971870420849574372151, 1251152425154260246544953154540513290303621, 2818798972367329802956936052623797403793942, 7638358444068983298092603686815486790113890, 24695143882440275994689721479314417528417480, 45729327569890326278523663568847218262894959, 129925286147414817076637512089880305727457533, 357058960265822950281886346091988882031910760, 870811282376277097902073516532006850342152858, 2399129617319427629796691807338852665469337085, 7522497498897836117435156411281203259743818186, 17703808279261898891912155690137638994014567408, 39174398341780347981624886777838524967209728446, 71626422074785376430650030090797947505033373583, 189453667691364649027951065496599754814571374684, 437295033677960022667168340703719574179513440159, 1105022320374390979035499970036715293235993540826, 2482140894382786914874701298953446381142900730227, 7941406921570365260066022237661009338911386179194, 13688077798315662160188528865690475378175919829521, 40118424472696130315297350323559766967889857978364, 105189379969045772302352882060687514329245824860122, 199293659238948607716187263853532082285127398693261, 499536111913922039437392654679505181047127518386152, 1265716378918935998920835568757397506132677689873802, 4251975766094131691018482661130820129953060977929504, 11152957210935036994690757763894857926461579995709364, 29243034751011001056721898400833781278921232465896703, 83127804731558215656517415813913013712630964732885793, 197287313991484123623412111326147421339126168589781103, 580348074469542880297800575176456597744257638809118170, 952848219059546044449261356813174361415872857630315510, 2114745453546299027601967135831843941629758587200332803, 6732303576367127091793491258707612535996916865106486930, 17969751578033370972927234837249484835783104974373526668, 50353964851880252824761483078317672020552394668185625845, 114792749147200000567884552573247130055515068451479473326, 344881289580954366545252182642967036273037618565165401985, 1028830458186445450162354520820201527695218769577051320473, 2074905233540761021629273629118215092544205899770047449244, 6827824489946353955926387525605200460781082737913381690336, 13024891552715019198360589788142658101822141014082307429749, 25961005268769363699702206141880105110265708699262059458918, 75403822308341240881775753922079349096463802345797378834029, 237384123451169596772029918832412849807327730438354057322622, 712646240930595428776240903619042913605109976371239636231758, 1858677703618066892165605509033944664007520745899837556768895, 4139395606166311238767981220233801698454319610253778363314838, 11051661045091733320416016319660914967058929654228453865287281, 29811585925705783247773137027702029276636378622129036803066195, 90685056735716951430085719312184849024248295771954003433442472, 157500945846011120649342030924242308092488581060888955520117740, 372901626023221848769914983494185928870895559258054416488096811, 768231028240804910809905945806694160784354754863882766743917789, 2779285901235347349512412519384436770411460171816095983145397440, 6374104945628711471675855561257403169698347988699930709009388571, 15606620797895735826222569176215400049549335070727802852935792508, 36407286542538484153926148252126040596266900628856973721204544487, 124345134443495254231144676818478910782759198180390061540449975329, 247113740493284619019931820393865652802499920117478290621711932786, 546250851448819627474782890078865878619982888424175090054606739349, 1708592433038733956978819431107564666115535756847903016488985258178, 3469784692808773680977989909012383598601318450115335667599446101916, 10923256812598128494335226092601900716551326610194937277684839542369, 21012491338240214838754959441277560200420746284908398093641375760080, 60889459302270258776558311240916612146241213106331686794170240374762, 163976015330661921425351604828688078789049035481531041973974028089785, 289037863251569623683823097040957275672420698243074506420157297827331, 757077203699594125515581476518783513279367742304415416466493229482750, 2419895647396662523171144180707701121877346566438572088091207837906226, 7355085337963583789485765997525070376210546183075717620390510384848601, 15051216064674860618341980616144084279926804604562228123313569479773613, 27941489504573067317849352242679271094163397351402254909630669501407776, 101620497919142332166787423172023060084593540312322612628746436809445674, 226881723516906947900548874100926330355595061853588440070446478001634192, 436083549067326238210237926429619818583468595956103126733614121273925302, 1114300762650958326100809843235006795980444078921364112608090634574957344, 2067630703150668695099956606446000647289440828791043320265352802856027353, 6184858091099126482135322120120464262653454412363734887325664168742191917, 20198724557091875844715800016163838909724718285368458520056089111628596330, 31016012035612935043240048944310566375654982913771972602093586083253422398, 120517928868495613278649932692310155587627278645665690072538147101563551766, 189853493819940791022006359464978248211780374156959402302888328075135559122, 709261139869078187523368280811328692680117587337216655356117972203528916551, 1494450926662311226674274795483402016068321469408932952124223720040234068030, 4833201522454078687541173754025375255160393643329610440001807389162022858137, 13065426763007211443646416727098859879614516619696845038342383829309179073982, 31498041121702214861734489217437935540479379421202405303460486717862084301294, 59291071262486212405215961522173655254987660557013973769285757104149711757459, 137325620971003240316895273046089454057536316983680621619104742603734626157973, 322033994335205758184753941417891767592538862759074152575171260357782006734442, 820082783566832754339608163235147685713597507674476057203654315048011026367219, 2282651344288337092906883083740075053173109353137863831730238422975306417325757, 5445119536937019732153059574137765564679350539463171899410036275958492350218676, 15640432491440562916581632653853505713511238255286321934711250830601955403677071, 41106883032429969859399906487019322357415120653637758039703350990320596875155176, 103754830954744065029443848605781937050053754534445990149281507972325774765844876, 234666834709268927734887936099822319961738129376455664521947726208265410000264742, 796501101363737180381507228150305361162624877853273443755457607681031102231623307, 1624552917282803716066319956956102765638808948119862597393339135995911391379123522, 4643272637840339310515026952678388354699825180379372281574901801196876030063101974, 12698618143562269391895747140398377495554004174836256597996901873500325652914287227, 35723733467261031422647885542793080310475947027099953899906182407397300154268828906, 66579759042299327879621766658030061118334921216187867761491910504181344451238684350, 239558348723378720363003224968080360385965369779814655734270075126998161979921905000, 674426340811237207208953232785934391016215462902095720638324651170969997400637801355, 1698823780061918718547756106555041994312203433347013142428193591099315938666752495147, 3485698669992831956608280816819201625859973318902236645999324294867314338271763576226, 11913442231481393917536601792582866930393303587594985248503741285895455503031416467367, 23070531945625150855016941245865388154950147453856685413887739256847410892916751249842, 63062109298026246794043518591814177894498277952179449322185515920851203385563000039545, 201500456854818387020432137947274011145636992031847792130877996231861744196691929847748, 386293027342088096708767070123592359264038177654678967794307420131436089009234887958085, 962652147623483170628478119235555226505070396879489339105090935822447174750045231232478, 3035935960793431917350036879195567655285637476975406683996240225461808984868014791791433, 6208746117115824715018162711918248788514776556569667609833722045497831346028332955531410, 11762322147658744239353552479176647603950873433079903790516674882105043434830328826675415, 22679200582127225664793559521091332878355319644677462980823198911465583443269858630893253, 73929710933006149888049977928677968518055319247626886667227984506656971966999436923186972, 122524349818395517581134493004049791722607446965559017459380345881157453828660236992049404, 412926833511789222428174650284405691872834629858851326844087117202853421601692502254318141, 1029385129423499530322969843276842783066057615497035785381633948646265964471244991407283657, 2374019900827890887681448469648598056064267661046120767421848772396302513783495423644064007, 7129046282305997419886465925038724574815350866486395082327924571694995543004421437396685163, 15553684426659575255143733092646126163883808844830770798803864550707886694317293166976752540, 36868510946091898479948303208447807989049331965479662439764899809218618486185846045349542501, 92245655628350120221629636214996850938258802134676165059052497372214318974743615511153118145, 186463470334970062582820387784350511557982560369498424617823476509363037536450250866616200018, 572967521502291777355369990006837729815084981232789335148124013079835565379339449250907380488, 1481745249132912511970258586968019679134485717661841452421417313959912906838055641721186578588, 3465571259266031075485176569236690543411907657240139447438094553546637617425088900258756309108, 8435925081032968505659480326132770316717891729208893135134645312992136104713045209348571379936, 20315655322325100095226141940419414017723560946817780337100296517956534785685937181001107745352, 43069115966613244938070771746304575880400024938295357246717079316564326270692925649165248799853, 154233412749662382894550506472683312102297703424057840129476320316144010040200771168572376219849, 352877164586305833533208196782157198192758667776588081344657867110512140773408077435261431699405, 731939874265903145518316019567169287035472945759023530855697163432627661288949769619402453516834, 2189452024672949178210645600969378516255080271308334836448144354429705327344143994347331957449853, 3896543605375761834186485166037278157701213968430616464967138263870727947226180820650265115757354, 9136364061744114854751740581900554472617621867814569413142650998411332183920873701211555172374338, 31182169589957210510416755511542482029989997938097777712995732237583051643250531461221140115798313, 76737932310662322563271317876920472434982416417386459109415811734811165935978744596464401289256365, 191657687539432627521287232027340814340762593718642860136243059179657356411665753239917046107562015, 530361069831754440835688500919172905456422674539149906219439563860239029311496751350136915275150864, 1387792997020024308183922178096461451972294935906886419345639014544739179094711431002567439046777688, 2286383934503119795216122706571707851067263586234080042542833733216757155431244141022301236049602882, 5217435832596475959525740735112831333306893965389666926215938837589313774349496690036610287629333005, 13857335145208908258169891019385567845284268412333112678215001155302498425490658878264656236992134935, 40163901018471004896425196956916864061977023091787666532481831101052032374062940939516719648018676594, 82892214529323438899501402117098988403652889186148588453800977258361448264060748670322604495661134167, 178956544188555415155972101504345380390695957167910254018903325710948594375512551321503428603501757891, 563888574268395325287659273510106617675959539240732287901035847602904779682730930207201257182213858543, 1616044303623257921514683914498983737627603891472634935907943748930280908786049272784565904600012939098, 2891229181345915888829785513242002484495784340354174828728993457272687483459059048534538302181816688976, 10207730272860940549823879515425309207636840459300447491903147067853625202918689426829904372421061677895, 17526621515916394607402562632381069779604072768221581075247386337947979364802058499395942689207299830365, 55864742839796343168209200305202648507682753148596246337408494037308856790224259497580631081634646188041, 165332196033938201434627346583990806851682965862702414330472648748014088812475559273855488926778988149883, 494729626554411141427744566730794748483202977845760867859438479405205853778032755546761473203576297889449, 773241724058457908926664671814549280391747757602041708672622636112281590651589333985868232639345426359863, 2643090721830219937871980242863893762864524580138013585975903383984399727700467749841537295988160882592554, 7602742125929529736410459828760559621377824926000865839917497433361558637433229365703421216832254559844712, 20298012813427893859751095024917906619591438637592000480476880613738608994530228331797315397345124353458048, 57138113294488937158388285440237932686091901290656714986248760196665994518443306993120321953623611701468826, 156180826248086652580528603931836069088833849466705801833826561589537926864487694377480227882717998855358198, 405091254840842081029125739284610173825182926000756067214428354197290398676973286834323853061720032954965963, 778366116109730017138034746329928058267161795656720444904686750506814152375884477590166274857108289313593118, 1796005150394618766778725965351985496132876507371048438760920669904977557456986675227521156526604287512648264, 3898444018773054695814825596014017751795964177961572987153324103751602074848254485225397417397654262390321944, 10703462078231223004197739814155717950000211259146027443753796966491790618726938276000128782966812980398530204, 18372321975824831177753464245580317968933119357879255869022769977852558056854497414886761863892673585456643891, 48317491803925955550053615386786484989034506042840366819980397407568791721238179125455458641299301269848666510, 158255568588301663954187011445643163738485858122034088577201324726783893231449209827193255340005164973552974453, 456823552578369748946561710072366945172148623875999657195033140013027572670231347304984109456384691884394301596, 707160118481884894551388234729179730915972581073118662214623842056893684770640844231508665861861467073743805665, 2706927376520605764276007802932993151885010075033345167172586198244735154579188535970342536626727165782495180134, 5524495123704893916572931697399108221354633312984253879509446961783982258828184219735409076305664075360213376822, 11902801828947547843316856179728603283371324186706149334180029898787026360919748804787239985463725865632928552507, 42817758358028425898228144386760814695029076486689089958556088081002352872886441780712721026897632438300836110665, 85341298053933033277929612803230545434450389443924565926372394273668666803233325131592974981823970679666528469082, 203545487666526735282497187348232067937848828434866343193810463204944901878674073018178572958556722616056919932826, 404490991972927610287798222030298357859147323959244483279529298622268125169109324278915340735214314234862449055448, 1015889532249910731454157235904076803563143859066636167138222193683905683535906365566683356226160720652109370999321, 2376026683785110886914732723263521678018967831673326233555377196140833492114241003132626058539164015299593970425136, 6462912523501528306439979574464826777892245783057732634021629306276087967421373795532316029843905278328516884883058, 16981441701453104471733297233747957918575727289870879189918428405182537334140409929337675754279869961515500536636176, 37605582989982272328044312175947277729400907856460324692248887357599456103017970584086153023793040540391945445989257, 91747039052675678105959960961981861389020215173307703983752122608163760292472703277085998681706298344337891404847646, 197976695213061406953734629818998754281337862490966315225432914015679415715157795368611025598068494075696354180224057, 407579734020903728451591407903624856111929215373480871243621182164970838186438777218257932637652562832905518769398262, 1192695842629740666007709455549699909835266353292608841275812622248241416280954865990629770667881078271433918923422731, 2356450454926316659685731978750584215969826513728852376452662114206102092287531644004469937748823746129670826796883901, 6606194810680818911726753398369719656427756109429906495763748359459974583720214056977960616895121295259675484772228900, 21238856384108665139068993634246013308212000660518883089302921531246892139968871926076965355331061987385136533519279525, 60431698017667972588320134967121949330864812114211557015977441929363675768812209839204671181454067749535515855713156763, 174665868422753780275604141699079697885219220210916384980421958910804651659162534153721798589901082858559767609552079345, 394230935137659132182806278870718863867754651145064639278806591391259891710009233085853984826856234290081395609225890238, 938316178783979725028510016300351906317832877618969965871296642973988528249289624189564279188734089982984293864940639663, 1690300816950917856165481180579373059665398098127346945618427499442023814975741786872721941536175836912500050716899314350, 4241040212750921734662543578806315663721700243000974307468609317605794291246764526126048318503818177838783905309400289117, 9899615703109749398438558898664002269482804539466079984631091253252047080143600618559486614511675282173378128689947106499, 19072918764217687057379877185516040357999863490449836492311841376572022870447983721729056895047026984202403660270528351362, 61457030295636043956746238914591148777316757448303861396901131680368800892725607851722251866187547310356464672462006792936, 130554685050076234706409249768453974245979757597714789262984612467812333642313018653001831006709360179701213479970689476759, 317707441009141362433020809851971219097475768762476580041791647909345575364794752462683617015215387354639266789655705355159, 766407353781281024676870262720057676902122989643223864583232810528888853102644816087185770633710024110065414129660560848818, 1378158372668635043591303404733183053913783647791091758022520799715774445178343987469574552089574912051263356050601448829569, 2849814783153826557775488037652012659704609417837692209372285071574038848736100379264094051217084360358380745456795092662367, 7761768442678261726960193678894950205212069061687767898603990098871593859918952089239031086652597614705182760193814143657094, 25797856998139398890116390239859835084629679432044893266362900315705828350899796936954893678013444560821963770721738841492762, 45230528787260219469707111504991583088449246785732739036848497764369166856369435663350796527642874763730890628636593210838634, 125595007654406839330037705158661517651788635482067500225344073216015649944944879970130124750959631685921435054581613709164822, 338747508849935686599681561847193572302329804892368313208731993174039023400358858978202514407262943107662339259004212857955666, 927842701337787263386928773903441275979399427379662460065544246411463087320044839262987027337743305220579800532826965270689250, 1974283905173053393614664395812743602970084360210384412934832566684934360366297764438728189449912704403685566054487439810857627, 6547791381850377804871914819409383329722364771877581519586671693693630274474320389311984387956647850854999536112540018330183809, 15709320907036538202306551117984227990557852089499582468594623629463507925701405510011304643762744267804282547349971254508845938, 40270138688478461945314017148044972001708543125646521974155404640273555509873235113536988809551924038925428913961013964565197607, 99168179703900580858922903603323807687115252977021819828415602208147447841271397891925410158445036111494543958823713690209285369, 269868178430265744761277563499719925184037917272176039027995896214226177897366881562687640385414521231482816048831046030643750903, 831659192392583336646613887566957000280656975320208034953861277421104038936580189145699653541798336705409469145595542460062434471, 2073476643694212471632333653958562004434818366225131771845046659755589302151344899589183197864077374128293181680576229954100550419, 4554149306780266313933686119966338774145476827044906188542821462680791576860383095025724314895890630857897398967476576259995321191, 14651118307465336327922062019691151414683570292038775511915021602908118951591926995520466221396947959539039452124967851254379010308, 32590352694473324794187157416677986187287003972605121693147144070229453983956761041980924463747749024664597601177994952136065984811, 81134631049823241301269776481475653931802229294857541846620286653857647735078830230944498091871440739749676625155855958593920070814, 185677119342066492911752180414903294080590111905381979357926969960006994207482364686831869137669282514024709390338951171955152686319, 611640161419871188028819133410469586343996954403636969815202842657504592966769167857498786484339404586484056783483882604337795700345, 1665805557476802274778809527131744615949426833045219219448282924298718975882034660815478936907356513550130652021165488275923832785881]</span><br><span class="line">c = 2396891354790728703114360139080949406724802115971958909288237002299944566663978116795388053104330363637753770349706301118152757502162</span><br><span class="line"></span><br><span class="line">m = &#x27;&#x27;</span><br><span class="line">for i in reversed(key):</span><br><span class="line">    if c &gt; i:</span><br><span class="line">        m += &#x27;1&#x27;</span><br><span class="line">        c -= i</span><br><span class="line">    else:</span><br><span class="line">        m += &#x27;0&#x27;</span><br><span class="line">        c -= 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(int(m,2))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>笔者对这道题进行稍微修改发现，有的序列(数据比较多，可能会导致序列中的数据有一些奇妙的关系)经过LLL算法规划后得到的数据有0，1以外的数据。</p>
<h2 id="MoeCTF2022——knapsack"><a href="#MoeCTF2022——knapsack" class="headerlink" title="MoeCTF2022——knapsack"></a>MoeCTF2022——knapsack</h2><p>题目</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,GCD,inverse</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bitlength</span>(<span class="params">n</span>):<span class="comment">#判断消息长度</span></span><br><span class="line">	length=<span class="built_in">len</span>(<span class="built_in">bin</span>(bytes_to_long(n))[<span class="number">2</span>:])</span><br><span class="line">	<span class="keyword">return</span> length</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeKey</span>(<span class="params">n</span>):<span class="comment">#生成超递增序列，得到私钥、公钥</span></span><br><span class="line">	length=<span class="built_in">len</span>(n)</span><br><span class="line">	privKey = [randint(<span class="number">1</span>, <span class="number">65536</span>**length)]</span><br><span class="line">	<span class="built_in">sum</span> = privKey[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, length):</span><br><span class="line">		privKey.append(randint(<span class="built_in">sum</span>*<span class="number">255</span> + <span class="number">1</span>, <span class="number">65536</span>**(length + i)))</span><br><span class="line">		<span class="built_in">sum</span> += privKey[i]</span><br><span class="line">	q = <span class="number">255</span>*randint(privKey[length-<span class="number">1</span>] + <span class="number">1</span>, <span class="number">2</span>*privKey[length-<span class="number">1</span>])</span><br><span class="line">	r = randint(<span class="number">1</span>, q)</span><br><span class="line">	<span class="keyword">while</span> GCD(r, q) != <span class="number">1</span>:</span><br><span class="line">		r = randint(<span class="number">1</span>, q)</span><br><span class="line">	pubKey = [ r*w % q <span class="keyword">for</span> w <span class="keyword">in</span> privKey ]<span class="comment">#将超递增序列变为非超递增序列，作为公钥</span></span><br><span class="line">	<span class="keyword">return</span> privKey, q, r, pubKey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, pubKey</span>):<span class="comment">#用公钥加密消息</span></span><br><span class="line">	cipher = <span class="number">0</span></span><br><span class="line">	i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> bit <span class="keyword">in</span> msg:</span><br><span class="line">		cipher += bit*pubKey[i]</span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher, privKey, q, r</span>):<span class="comment">#用私钥求得超递增序列并解密</span></span><br><span class="line">	d = inverse(r, q)</span><br><span class="line">	msg = cipher*d % q</span><br><span class="line">	res = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	n = <span class="built_in">len</span>(privKey)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">		temp=<span class="number">0</span></span><br><span class="line">		<span class="keyword">if</span> msg &gt;= privKey[i]:</span><br><span class="line">			<span class="keyword">while</span> msg &gt;= privKey[i]:</span><br><span class="line">				temp=temp+<span class="number">1</span></span><br><span class="line">				msg -= privKey[i]</span><br><span class="line">			res =  <span class="built_in">bytes</span>([temp]) + res</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			res =  <span class="built_in">bytes</span>([<span class="number">0</span>]) + res </span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">privKey, q, r, pubKey=makeKey(flag)</span><br><span class="line">cipher=encrypt(flag,pubKey)</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;pubKey.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(pubKey))</span><br><span class="line">f.close()</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;cipher.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(cipher))</span><br><span class="line">f.close()</span><br><span class="line"><span class="built_in">print</span>(decrypt(encrypt(flag,pubKey),privKey,q,r))</span><br><span class="line"><span class="keyword">assert</span> decrypt(encrypt(flag,pubKey),privKey,q,r)==flag</span><br></pre></td></tr></table></figure>

<p>题目已经很贴心给了注释</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">M = [8639902583677674310880931793028177280541434011292290504202065853840987502967193292082744312615700434593144813157877283996511132107220470301049233647133408049028266415548603044821875100911736779016733764651538561081471760073024901013269329030282540268057926893298880605006783804814169640893918174416684396473085843437738560093104518378524427428449369031845530695254533729875357632791209728472396631069254545688073527219830, 16412795671399200780410369416718200126247920664621109172347415680005387903489020995450209711828570735415943889363228088231729204296365628434015660102046415392160980472272559259705186844881452797719608700810640858964540124307963570631307965212179112567625375169247224532541645290209536697657292517320097861498807160219866672156203488965096062697707956833540149569006121676793811420684019155246005879602727894940460106460425, 1002483078449652086908127901165742700721575695431977944228135611564705696962544084765706920800603400348407970043674673111909948831677555786509139726134228930151292393556003965787320346201469741608940033259208434513230462286500445047749412928990508135782414968218031136356601029216877376563453734566125800306022631214791796995657970239075130824719419551039046131552320134110768030600558391775291997167887552475043961982479, 2238951719129102684908508004589371017508128103247447515477314623396874326632900138922634752384371309915247686376088188378411136513128697780426310438781294619639028237392912133929126286576611773410531662546965371159839695457500259703379712133530424987700108668317058486891872074268472615506849525949557819649248663298510166491366824248526632970988729421252090737838283604158996925358054184183912031175441649168801364477497, 5634843816732445026126467098373466021485769627903521660842347695720253281030482413552009914416263510962518645905534351024856098851613741584157560289954680322367708989388356896291579138242423737071936969416183795417059233168737593374557100712180960324956368186029307481493787661489262846069411165605826200576757012590288649575515313112890878467873797655979953750167348022896037285417957167761342222784479775154484055454300, 9186610770346409723100374171388664935178707704940676612563986340255427150913228007547473624373722376412452006509593871272640178049654772086095028603022475485769195013987324300619058730137213629241547292874688026607272301254060765768412491266856867815505612614998943264567979641302858974943094758843838673682824294909500855339786155131092900834359374160001259207411314769180927212657053081774058447428598226306560920557103, 20086923313584400496691602764043099251746628122644779399842432220366854165950153096939613947370676658491693142658541069764999486380151371297168776865169982649753241182524436613459151210953276528861607793419032177588079933942873702274888793149133043040881921816738144320494857431431348403935934220691400258374550028362585563810770890511960106477474196749665991783492371663595335417853709562030925255330540927197410589197346, 16344638306391326377686133680466529244247158645077173788183670515669569922257628136592428719458630174158247262608062501473710159252996556402841773688479781261071952868217032789112171578864311013133034166125522508960509753908661140291243310989744814838516658654858087285501428760026897645388510723360904014743591560741892432193065079183777716928931428528657537811530112798506687040813493577134938597056885544404165334440417, 2612829152363810360381140114448267548309487113451765642875771138774557011657898432249330366979748000196797448616557121603054240633550483300886876115997009072175661113374511516053173148943538562172144361976376460500609759755722891157667525246977951372954709581129289399522608993482768996162810200357621658110354562179066558050350148834136898974813148680250028733112017355078329753267780915289394014243208598474729032384564, 19064240755529577125292283074595989361230925740751604828791433834485710855856801533155956923513647433086102471927289219051556692578080054437968339223710189223092053257138547582773966036253443266822181812437558595870339679800887565183836282812813501470568462858382546100456455622835475204306486289729917538078517665215080886364990781487301918217104266484901312499340347150623781762028474648151175735340611348792151618766861, 3702565937757268048976391733125277066442618380743768416638899741455818391864276934809663789147326816784849214974228391513975011092043466189181524135072744668991818700123641118048186561731463987428008289526424894229838318750539451785156527758792285754054388512341416769819020768917817009268720412709209493639300206208469077070001276757631341988430056132551557700579907926834862070107929804804811568088452140366936341777345, 11502581665457615587254363930374727534860957412318365767186339391962456747857398825121846821211261108113447361990519412493867120624842707484788658261017505214188933491782380457717248447441244784000616729072274616859314952832500266181433915883265604874701734571473682998617103861022495595430816700108408197717973513190148901952092370293707843130828467727037293783684148539875615050978469354573967054299566840777623355696582, 10073083484226771776559359501269382896512475376861352563707048944846887937508361476948371289888897049589767849211355238137412974054578287303103882003280146530845186837491695691790335230428734898979480016209102240902149523701595231852831084035640546876424433409207622149923419358639246084622889479686948602188084403074936426671633324202401473825907348902812619313043234644293320117923314933945154795101196969895143521199483, 18992409093137046378732842744306503603860785524225852139724096390190053840935906726926035874997131679911084133508187235324077341016070148447808448470772128318056137717495126904574038547394615807743718419710808943840981025768473805273816544440631835254252102209159686821504850348775772310988837820388009691813555637320221225893184839014117064201469792554472415820296766165441072313200265279873167507641917097468147741179316, 12008203894395308866804419286918131211163695386800382803649167279012655799569753801988115828424417187344919188165247175430808022391086771474851545255339167112615263516693822036949280138705995693945006477452686019283850377188419366812168825267599287239756656176060444742334708935226087327402356564944368424241454091730626764098428899236088185072241508877992009374541429500266147060644167717198271648252572069852366770066941, 4038832885441543178685778998777010366178385846540652554740976864087276470059402915973964964623701441198410064422128360212066090056314261540125817743157487504771683739028804039509503547125770628097134761153720275162291365442343531369529592717402946253265532741567152583164953954964898610320442871432658088455178094417777512351495473972183676615716829056159421852585171139955117355872271110823592402383029525931751267792629, 19670194103573995335546778884365243181264524353822662897934014963532181109426494031783122562547168306646340318701174006591358124967291240381472860805618047808677531825042365670594937665873102378022268329092094697067984029740301822623602184731823873558795434660094128877563657141012814479754588351209580370149201870079338556937517586419874603443731575388938047952534772975732556105736933783615623583780757885995121940503338, 448587250547880364312998824100142781832002491807797554233277109625321555526950425023215743109760909527612986436313497543133603769113094218925472945334223939771684911674114594383329812680099071618542069490401164113149299269806494788678936049434267166672312670105320059285800764845917405038243022972683567686862055442132133699091060023879225704166728623235301057086116134392930454897470872517830183804157659700625445889830, 10930161231241723347656392354185186093279947414736961273749133046917264525983266922573827501912949183911557744485967859327719400057117437345731516339396700486673896394578991271601789139805337761538463364911028532947314087595485794633342964066494181066852782300122468958298766435768883484054954993425768743684068334128908076033268101822190508581559994522635605495674677985961570352022867982948658497701704571958572471959037, 8912625957861947176692856854564685913647250060559881612290601882706188054788510505473405766899729572895845562443591906130010557402952386484482517393552180643811875543260186615419673392566496124447912269542460226666482647910551668827648093182498966897648613164572222270243359702963101177490336287533554365928047224202986800381789195759761436787301775857956490336462761874360038594427862527456596260884381704781454223633779, 2306551289216069191130454513919221829895901755421732012054334929893242554080663470365833623647910595823559794161380381203244457273338204281828065815403836409342993408047475650247775548054870518506855112285782988053629107469383261669351486184529190835182475578503456288807168306057143062378581633799682759776120760924076418979302287358897599267369532373529226015751378954828919709070562305354324298101375251784620884529050, 4255339440978927655211913099708439239541744749715858205450532296135993491711072531673546488130525220452788120740747243665720666392815530093014478271039742032112194171931906319993753445172382189426854066713529003995100528854075591430543823563496149091625019122021620407298536429119275536878732816760877148779834810333996516623906435500182034146675214175983106767418866525349482073016790959017939121229158782423051437153215, 9873893139520117327959006627839041532640596084122498183275311439807583416537326867898240112497398037831103133225780536794667751621338906594306093907094491162973280124466357134326208711961138712559043474881854410281347249860558412201637927695809309506382983697195652836773807770471078146063769391274295604089026631661057995193996447578694999955394342030970191038699379802329038272700169720344712485611198818958034826301237, 4765089917604817672113377465925141955529222421516223531063923657154702433478270434880545390917216534893263025759911541042026110573924335888049100333952299835341171480017258706209901577677469866704411013270064823075970967687971507570610839591584275076452847872481076324238205066797040752210320592563122318631044755701635637739646416025765614160810641418286841779812770371444583299208365194975180768006212895673072116522386, 6112224947687945480280239711320637787918908433138683424770734756570826229243307796646495301320885785370269249822669591195293264920047304899609677414526321546201923169183273630074677571673196655278790073365810828842079110549121344560176457524241399552011885247148188807289668163473493287160336470378903648449586092642655607573691920693404111756416187219108551575656506522734845257486376035264495521946081148938719828033544, 195388411930456292659004793034783822168552894119815825793239515251988057168890947473241809393054966668062312553975721264016843250888334146134794233076452609281861146295329070151936139818953601652277333969475084082043879066015009690415217938561659533862830515140741722462773302261048996453107340978194386484615281173964478851257661832707168812221430391245333553374969697275213417090199524308016415986232808953337791233555, 1244720792234771369080092658020249943250558558858543228087410218998345534662117779763183654722069027909843499722901164419943926229796467885376166352837320116084647482129514330031374427777713274658505472735592998618829380710477875259621314494025610959270630909513767438377166574595122721020642680480636508393782145457915510494406492704624711370382819548311152206515088909451187140041316879980487624305109667331613444702397, 17420521136158610155456592286731848541982479314642855401677490675166753515234198487007423812022874870146225072931804869494964153944097179858754058711975536064958198128181259089930184414024073207404745484941865020376185583612084575830698697473861393413223317543665696780708006419160734997175211056844409117770896148029948413413830070992404759100435183372428243532877202421584255843340950511372816896926816072148853459897597, 706903708472011058848699822306335654841601117402541259992980291382595513869156934281756720925440180372041334909766487263157124536984532709278378467802794655209393786719712770166975275570907988257884089016583036566222245762906544594817287350363157701978129672388011595734906479201562800232080436561292648589995413689187423799267922779667354879432847963481081819133273312642100271608294867632390722051556035070483171016618, 13588117928036525396131036929216722140727623626773457297456804642287761920269285941755714752389926502053635244735082938908723844163590227890370507021161665584070634134943166185409041414310104540858882424783436357851264149321701932666540464732095496709151056094385506784810633450577104530541976191745761226361392054647950122452702677055536328206478865891505902190711023934956429659436170984452323755148142827783946983689170, 13035612161448099569620637080527976769991099967659035134135726157510271293484224205316460392491491142810512547489719500384339641597134042306613279002050232752593558311676343579221779534892019944116141753798217189420843176613961166129335180457416469246554334190776482345258322812060613256769751208473952032112714346919765236132411088975889482598477817665407310561133545838921580753339246754910148949146829091161220277523800, 5061468190653798738267114315103277995240484866758940466674688031109170357205008555147400605884432466490013550324043153140916286904706720594942806466313925952519739861008671389738724448491617803723488014434597761423015360791986220671348427679576702646137192962379221866734759953356438405870464423279037434471697115717040170596343588013833231257338815360451128669119488799203334539631159855944659628348586189260831916846349, 310519211081224360436038529767369886079208063233638857045321280938913013264485831500988519083286823510448024911412774486006384354093058665586412478745091555621093880910291350060806527846380258780481452221805321697545098807534406639559969270790330318763674434212070131506363658570473180232691446781542261978745471405470147422634838558227017494138965139937056188221867200916092073501864711946128579149564779783995131812764, 7765454929386860718098457667571027065776365809087712130247806423210057380994819419379356255913567513855445325193098721224960552359712259673134202556374845746328084939006183410638772980553376342740123581295433206004604779839814416843588103144731533226288767681739309033321761816241055963854560413354103299523850186399263379947122808750960631330918177463573091711382789330104148605172305241880223088742424771925359262276961, 21279920209240501229319113350331584665790430778846094897524930483118106031814634260802903045495829850399437278182329574699963138929930179421992737117248479197193414157068700951767757037252093980620859984584071460503299890187279597588828028508209377280155232780973353085622102108867131114851476798667397114731024315266211677829660093151838411660005343321511262290101904600206044359113839043382769572874124915349587253828026, 9404384361847700092017917497360922914422495675694955197107944898045656929107075851201447292136561925215747086463268855004949841022671138446351748131867439799577663701934862965438385718226937668810306608404586652755516424859810792109427278538957262669803852485387086606698225561320268174451728686271748237597096162506211489602963953896833644360026423773017344347726848234574166701592970696201428964781400031197865618239089, 11473536515781570615295467590180776005414036990843757506218537332857260548916287699656257748679485492923976380438772031340714031903195664536413478729735501964060575660816573010818951724268030300190364858009842520160469005602716000106343559079229134105037981332746560515786853914884397058119553354501751785487490141582378799261378484951808914485153056302334467726453053631816737123137188339174736559611576619507335456442065, 6658209986765214576523603095408925684859819107411400320441704339845709232148546095393111386992961430272770760133826876144536472235021040569911199220002850001682157274254019940107808579210365324279421587725318046615758025182034807320964209281952211101801085038313213267840401921768361130482812244634047647201542664623820862660431801687169272410840936474148169852200351846151154823648248871251508145387214557197530965990966, 3662147743842078783350403504385983360536988791880409841594842856902008843747184249906408091065206792255852486983899949749040441757153766073770174862371596437255143770762330535544930819336506298143363720373654482508230603611719528450050592020391695607369389318359724713540160798965029351305356511671756157832414716675860595439627182073770194023818550160188620097391401855031574633727321506854349395990238905940067612856696, 7933293379259371913947753225829182973440327166821331624782742813667530306183685142511569661517697089303221887502895505020874247160719683710997562072608556098407772048528722269678632972762531765385931704290441640393166153819226767175593692496736619644331844236704817294952000150386014066539732697524646127418982668700056812006011572693231332529972933598812433064570022253850176804351568177341485541235602653505364414768080, 14070615118184600860551882213714094275919094443487489248696755809883503918195587018270172984608205938888536939875430264012942369576596527716679396096608215568698430682346516654899828724942187624877959402757540416078645260766852866647428645421972345262477895972147694258806702534022844164408377042363711608742060536759496086945857809612633396792905136739597255654549008843569173238058444402641970915726989105904551420858546, 15342946815132442226042116907050674991277073193801523392169239948932666433020608630679091801966034372511342999029292508497887755004306581018004584285609282795773152090001950867971092852778256889890353738132730167551173577706777310439847369540286505119147781133148801979251138693701919045904692041106260141920375686688488149802396671219316061485675475896415179620183729993314843987100325425615893137781286754296462178178342, 3740152297282187181815345820098735405456007044475540504111210108524926232502982744404912884880365972432141621724673777802787744807157725980349110691844313336431011685019041193074796249612246618677944456394104745372829079160559888495080142311688681340347875401650358392693131033779246448214818537452437421066622719432500713770985665015229700477055550680052280279789072242114276313112192777540668840785267601183144210396020, 10185332676507104923693600244914563536350322909616212746220121432434723035761182080872998830142207437310309114085510373952850103117757585120341980926754941337344093553857422551961676140723291586487782410700709958292644147040988012341985875728853255609738370894663167840784046951024718142033286281019071858182773531406479425092563184020268791578909132566309388794626911391615731256258486251046314500831039355225743436984975]</span><br><span class="line">S = 28856686525748125802152914172483571798453880654624111179873716369801238646447969551927508246737816822527579725991046201801262381722186539084044859241033407568422008911415092147086235301286167536726137372507078079415577358704181165698320539751269992479349480281465975374187246799267369957964807679383646749609694064517591097971225234359495013928292239934008888234863117359059334395043146949808360202225171337210959511092044766</span><br><span class="line"></span><br><span class="line">n = len(M)</span><br><span class="line">Ge = Matrix.identity(n)</span><br><span class="line">last_row = [0 for x in range(n)]</span><br><span class="line">Ge_last_row = Matrix(ZZ, 1, len(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = M[:]</span><br><span class="line">last_col.append(S)</span><br><span class="line">Ge_last_col = Matrix(ZZ, len(last_col), 1, last_col)</span><br><span class="line"></span><br><span class="line">Ge = Ge.stack(Ge_last_row)</span><br><span class="line">Ge = Ge.augment(Ge_last_col)</span><br><span class="line"></span><br><span class="line">X = Ge.LLL()[0]</span><br><span class="line">print(X)</span><br><span class="line">ans = []</span><br><span class="line">for i in X:</span><br><span class="line">    ans.append(abs(i))</span><br><span class="line">    </span><br><span class="line">print(bytes(ans))</span><br></pre></td></tr></table></figure>

<p>很典型的用LLL算法通杀背包密码</p>
<h2 id="MoeCTF2021——BBBBBBBackpack"><a href="#MoeCTF2021——BBBBBBBackpack" class="headerlink" title="MoeCTF2021——BBBBBBBackpack"></a>MoeCTF2021——BBBBBBBackpack</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">flag = xxxxx</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">backpack = [1]</span><br><span class="line">for i in range(160):</span><br><span class="line">    backpack = backpack + [random.randrange(backpack[-1]*2,backpack[-1]*4)]</span><br><span class="line">print(backpack)</span><br><span class="line"></span><br><span class="line">backpack = backpack[::-1]</span><br><span class="line">l_list = []</span><br><span class="line">for i in backpack:</span><br><span class="line">    l_list.append(m//i)</span><br><span class="line">    m = m % i </span><br><span class="line">print(l_list)</span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">[0, 0, 0, 0, 1, 1, 2, 2, 0, 0, 1, 1, 0, 2, 1, 0, 1, 2, 1, 1, 1, 2, 0, 0, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 2, 2, 0, 0, 2, 1, 0, 0, 1, 0, 1, 1, 1, 0, 2, 1, 3, 0, 2, 2, 0, 0, 2, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 2, 0, 0, 1, 0, 1, 3, 0, 2, 0, 0, 1, 1, 3, 1, 2, 2, 1, 0, 0, 0, 2, 1, 1, 0, 0, 0, 1, 0, 1, 2, 1, 0, 1, 2, 0, 1, 3, 1, 0, 2, 2, 0, 1, 0, 1, 2, 1, 2, 3, 1, 0, 2, 1, 1, 2, 1, 2, 1, 0, 2, 0, 2, 2, 2, 1, 2, 1, 1, 1, 2, 3, 0, 1, 1, 2, 0, 1, 0, 0, 2, 2, 3, 2, 1, 2, 1, 1, 1, 3, 1, 0]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>已知$L_i &#x3D; \frac{m}{s_i}$，$m’ &#x3D; m \mod s_i$</p>
<p>我们可以从中推断，当$L_i&#x3D;0$时，$m$是不变的，当$L_i &#x3D; 1,2,3$时，$m’ \equiv m \mod s_i \longrightarrow m’ &#x3D; m - x×s_i$</p>
<p>而且最后$\frac{m}{1} &#x3D; 0$，说明最后$m&#x3D;0$</p>
<p>把$s_i$和$L_i$相乘求和就能得到$m$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">s = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">23</span>, <span class="number">81</span>, <span class="number">199</span>, <span class="number">670</span>, <span class="number">1844</span>, <span class="number">5535</span>, <span class="number">19547</span>, <span class="number">75437</span>, <span class="number">259056</span>, <span class="number">974664</span>, <span class="number">2399609</span>, <span class="number">7304021</span>, <span class="number">18537736</span>, <span class="number">38733276</span>, <span class="number">143785607</span>, <span class="number">300890806</span>, <span class="number">778420517</span>, <span class="number">3112554961</span>, <span class="number">9955080778</span>, <span class="number">34625138877</span>, <span class="number">103531993246</span>, <span class="number">294207209833</span>, <span class="number">632363887456</span>, <span class="number">2341888528510</span>, <span class="number">8736224869982</span>, <span class="number">33727228149167</span>, <span class="number">113026240109398</span>, <span class="number">334534210335245</span>, <span class="number">754812282783351</span>, <span class="number">2871232541211362</span>, <span class="number">7147990367228081</span>, <span class="number">16813142520913249</span>, <span class="number">62232346665698392</span>, <span class="number">132813746566508109</span>, <span class="number">436969187287191174</span>, <span class="number">1371311321857557068</span>, <span class="number">3465499917202578303</span>, <span class="number">10761115866584374884</span>, <span class="number">25998484366411649657</span>, <span class="number">81986464388691181616</span>, <span class="number">324842980726420787162</span>, <span class="number">1063428202306999892763</span>, <span class="number">3318046410585817603032</span>, <span class="number">12569059003729082352479</span>, <span class="number">29822650425811094387624</span>, <span class="number">89829868596281155601134</span>, <span class="number">207467076929560545986692</span>, <span class="number">424101883375592006882573</span>, <span class="number">1410057940679583010646572</span>, <span class="number">4795250448769489602371933</span>, <span class="number">12419955465903295439689190</span>, <span class="number">32127052925660652338148413</span>, <span class="number">121768246803017981541739592</span>, <span class="number">286293639144639999224246905</span>, <span class="number">876618562849333372078886060</span>, <span class="number">3495370549956845610130431964</span>, <span class="number">13777448384830441398471073019</span>, <span class="number">45339968634224370226443992856</span>, <span class="number">159636974047457043534720001443</span>, <span class="number">403806399587759901542286515690</span>, <span class="number">1190949464093267805434271517577</span>, <span class="number">2625636206558220580206955200643</span>, <span class="number">5447410189447132699195152662348</span>, <span class="number">13798370097217657917056458399390</span>, <span class="number">42652195271813913821236091812630</span>, <span class="number">87624112365004035907264763291796</span>, <span class="number">295833079631922620770335225824586</span>, <span class="number">717255284196409248439771704866883</span>, <span class="number">2119024457898120787521595829459142</span>, <span class="number">8097762744600097674390735606807128</span>, <span class="number">22990496332708170421088808438995636</span>, <span class="number">55268619563994680834441597248247582</span>, <span class="number">157779112538179073738464223501777499</span>, <span class="number">553561084981889545670380643023607621</span>, <span class="number">2094594867042850711386606235023415160</span>, <span class="number">7427564397983932982484534762285032864</span>, <span class="number">28541899514275079822011638819911534081</span>, <span class="number">59854615377110931361953157015440306520</span>, <span class="number">137071568336121640486639449884477676903</span>, <span class="number">434368553369190183317274206512577489165</span>, <span class="number">1607515956833802196435755021284640023303</span>, <span class="number">4247439813046769661567823675143526066989</span>, <span class="number">12252982336388472725165513300377051313644</span>, <span class="number">43586970358791422986656986286232849952290</span>, <span class="number">94754002216262928157061686798919700234151</span>, <span class="number">205403633516427560050027271636224615375855</span>, <span class="number">727922215919878343821825296552148942903123</span>, <span class="number">1541646353685774868780093433673052445519807</span>, <span class="number">5703469721749658936787093922654529457118594</span>, <span class="number">20762100689139896330208273986505541316962105</span>, <span class="number">80195197197818086812949239946286778357513961</span>, <span class="number">198522126001869063688321920177617046841212852</span>, <span class="number">719060816608760633741229682178956301630549900</span>, <span class="number">2171712751463320729665634385979825928332317622</span>, <span class="number">7968526190188064156742281507099763347000210904</span>, <span class="number">20302513556821857703528100337806260797703562338</span>, <span class="number">54967103106163860243927426134510653397499429384</span>, <span class="number">189866376897538250029834405810321956080892995934</span>, <span class="number">516088075785491414669664215795496674103100750375</span>, <span class="number">1531616665488077085604100033058238685259376456655</span>, <span class="number">4795563798371064843556375420641263389159268373753</span>, <span class="number">12715206263244537077480789152826620386135239585589</span>, <span class="number">45628223673569886022145657218662773486560769778049</span>, <span class="number">127988774487590162169660910342623736153210927472871</span>, <span class="number">429761810968391607465089641939438991272623610573254</span>, <span class="number">1694286408402338132220805654166083638884822137745848</span>, <span class="number">5577419986858786911316434594350519553014729018524982</span>, <span class="number">22146179230778265190752372551893625479326089828877879</span>, <span class="number">78983119075073724439850825731329386811892547014513513</span>, <span class="number">165805826557531832743325076551678254671357810872202277</span>, <span class="number">525687524776397669648788242907896052104054917192402349</span>, <span class="number">1596680185629512867035574394423929715498386636216930988</span>, <span class="number">3808351509446054183279144714875260973968494634290203802</span>, <span class="number">10792542598439044383994436390450612942036864538927761344</span>, <span class="number">31776077718298264756461043701077481610506447838959767949</span>, <span class="number">69483787236434708634666641366101673156349500969799745632</span>, <span class="number">212620878051727200345257734337176214877612639791408110401</span>, <span class="number">565705372069455623425268706185184158331866127768259060570</span>, <span class="number">2228971348185635371906791535156337404926063871528397270892</span>, <span class="number">4859328204121938264839760465087547752629065763656619388434</span>, <span class="number">14185348803209161448182653444177464165713091554806223414499</span>, <span class="number">44242932119616103779840255273986809836494122475150635493273</span>, <span class="number">156176016196847319874949580221731690886061627436916661422852</span>, <span class="number">472567672907289753186461661432798790751774534772655287936877</span>, <span class="number">1765317440470718113352833182911767208733594355879647245836603</span>, <span class="number">5835719030771522391675663002032404790451900100534570526468736</span>, <span class="number">14528961633147270325279483890277955669830128461595478399405580</span>, <span class="number">53503137764341373520101774208921450303897226002280491351371881</span>, <span class="number">153340302591307960181257267214621247064964249027062324798966650</span>, <span class="number">467036429085212303265974827129085622046910166509299763268535756</span>, <span class="number">1760478013800716951650816419888923889893355872867499404847043361</span>, <span class="number">4791886951911545137378952129838133145784256723738609871941913863</span>, <span class="number">19126760116038883506408830737976498053029475253123685318001466609</span>, <span class="number">51635927378821965754946959553487670084314385367430813170544188707</span>, <span class="number">203944552994591250724882161307279862158139878326498083669171922709</span>, <span class="number">718868928147325949276701359623063723395455731358210896767864810436</span>, <span class="number">2005627527854915017699090052821431775394584514441537184407714355949</span>, <span class="number">6108484926321410509000933490330125849664844216966621898372849074206</span>, <span class="number">15273733259375332107091552084526951416159646708621190826219429490015</span>, <span class="number">34145117254940196604842578208457005181132408450899191627170638987883</span>, <span class="number">120825229084143066199868275091825674337472013226784591902132114229359</span>, <span class="number">387687667198606192147021527980207738864855944986764666796629571317797</span>, <span class="number">1461874344207808204456192497546273455901754164965322967295868406627707</span>, <span class="number">3258300231591322626530795072101331694347928535549768492906530809069244</span>, <span class="number">8874418273687545553519370439384854004509761935319681848589844232674343</span>, <span class="number">26555971104148502495508475192114409958713364020252024170586326291995544</span>, <span class="number">56653286369586527413345416396708661964062474995701742952261047069623359</span>, <span class="number">154383566127721041301459355493059400704799197964228029280865862358894596</span>, <span class="number">341393868848806018386217706353404785528207249510734290203621418976352706</span>, <span class="number">1171362524761660822765817023463786914069613269413196584856696440695273738</span>, <span class="number">4194882148022101614597714583113090146333385168895367467002069867303753334</span>, <span class="number">10081717223153632058965668126630772845024206141591578024505075742926631137</span>, <span class="number">39590555580101758090745061229221178837429140073072263518741551403983751377</span>, <span class="number">124978669991117804453179514660098523434116842472570073354436333226196401318</span>, <span class="number">285677744249355467333640461312079508294900634926466871637187648581093663108</span>, <span class="number">685643590088926190360498081484403342771108281930489395367499236756131358960</span>, <span class="number">2509513194338799699151211958956210034789618340347017416940796124375457114430</span>, <span class="number">7869725510782496795692771133398729561144872690341264618424961946628895219979</span>]</span><br><span class="line">l = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(s[::-<span class="number">1</span>])</span><br><span class="line">n = <span class="built_in">len</span>(l)</span><br><span class="line">m = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    m += s[i]*l[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="2023天融信杯——easybog"><a href="#2023天融信杯——easybog" class="headerlink" title="2023天融信杯——easybog"></a>2023天融信杯——easybog</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line">import random</span><br><span class="line">from hashlib import md5</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">rr = os.urandom(10)</span><br><span class="line">flag = &quot;flag&#123;&quot;+rr.hex()+&quot;&#125;&quot;</span><br><span class="line">flag_md5 = md5(flag.encode()).hexdigest()</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">m = bin(bytes_to_long(rr))[2:].zfill(8 * len(rr))</span><br><span class="line">p = getPrime(256)</span><br><span class="line">def encrypt(m):</span><br><span class="line">    pubkey = [random.randint(2,p - 2) for i in range(len(m))]</span><br><span class="line">    enc = 0</span><br><span class="line">    for k,i in zip(pubkey,m):</span><br><span class="line">        enc += k * int(i)</span><br><span class="line">        enc %= p</span><br><span class="line">    return pubkey,enc</span><br><span class="line"></span><br><span class="line">pubkey,c = encrypt(m)</span><br><span class="line">f = open(&quot;output.txt&quot;,&quot;w&quot;)</span><br><span class="line">f.write(f&quot;p = &#123;p&#125;\n&quot;)</span><br><span class="line">f.write(f&quot;pubkey = &#123;pubkey&#125;\n&quot;)</span><br><span class="line">f.write(f&quot;c = &#123;c&#125;\n&quot;)</span><br><span class="line">f.write(f&quot;flag_md5 = &#123;flag_md5&#125;\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>从<code>encrypt(m)</code>，我们可以知道$c \equiv key_i×m_i \mod p \longrightarrow c &#x3D; key_i×m_i+kp$</p>
<p>$\therefore 0 &#x3D; \sum_{i&#x3D;1}^{80}key_im_i + kp - c$</p>
<p>一开始构造</p>
<p><img src="/../images/Lattice2/16.png"></p>
<p>规约后$(x_1,x_2,…,x_{80},k,\sum_{i&#x3D;1}^{80}key_ix_i+kp-tc)$就是第一行的向量。	</p>
<p>理想情况下，第一行向量的值应该是$(x_1,x_2,…,x_{80},k,0)$，其中$x_i \in \begin{Bmatrix}0,1\end{Bmatrix}$</p>
<p>发现规约后的向量不符合要求</p>
<p>改成</p>
<p>​	<img src="/../images/Lattice2/17.png"></p>
<p>两个格的区别在于行列式不同</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">p = 85766816683407427477074053090759168259205489535331001301483049660772943816017</span><br><span class="line">pubkey = [58890813098389592716367918664418237809399998613202441049117852003453550490043, 255886907973292033549191761914277947638378726729170162403000263307778539588, 43666147543837562983744529128391108960442814393989688186615627619841168438881, 2289339843351034938706095739069649849491797527322909177303809837660115875707, 41213482604182795008139260226694469358720652561587117539105919206178583341309, 85123975988270149359269904030278272256150702593339117634318036869051474541673, 38499515653492727036642516425661144597669644770181333309684190745152037999340, 20485509602350760468364550436683434882775269798789922529010411809186809838027, 66201868699675751260618542402171897519442339400362102112029773068389836772496, 5928498980938052035989976608996334019121526162545586177960440867589564370967, 50886730626726574520144515855606763616811548330471900085065588158010347676677, 64024533350992434764550819938965710849249693930938822302806256939206336927327, 38725701074483250591450474606717766666514853596721960873869603150079957176979, 79217343443391443055559755031159399927770013676937883189341106207746097977107, 61550584018851036114215415812034871024308694207855706560554908679054705909070, 18943452821091669663831772224349497605704279324611723330470460453532875854668, 19589987578009659601683539978459498259975975776374959927024576839483511789830, 30455762424330442645213719258885752997650973641135913878741104126501286615202, 58949965807078946897782791856062155685595594220625894016492979510745067947620, 62055731853485887582338078878228949009560282473783423335829652944841334703073, 9968050471897160901950463089357618812125361692340159762344476181267684171496, 82879622776859731032127240994822860125030485017752550449574280896284319539559, 4801338348200265259854446071344823901330707085102509710655971928319789477063, 45731791006706217374257923546738746982354369452894895184784691821888225473116, 67249651561046962535594292263727781436622305014470811080407605464069397278541, 74549581000796086938735007821116567870037873934415647996983670510761843574950, 53927163931460713770577528602376533863752551014779597870421933008696943680646, 56674817179749773825254339411582187056553125580899575215919582277873475282705, 46486618405288541635832334168373891479516241585245833202819962034096805786948, 33438500041468604615663063367413201369385488295864836452725688027946579037027, 67664099966578778667405575319488959391557099474146663546553930271609270514413, 45447815671440655615043306804023843286416205143693188321756314646855229497538, 11725972638697133812198141962081533057131109523301554105107846876476492922863, 64289489702331472745122326714411510149286883423778995697545620572730495023564, 57994575257987111046854716965859364231330618527165005046088441624813910607490, 14668229647185139513680523686559656096579435616501772089580139136432744069528, 17932811002316804580991874481669739042847138206519622106023735880404179858139, 5331195663859739712428554823168168360812478289288952467823046758773036202890, 74552793814948855649083379813894922159371588934498467412076815493098565156965, 44935994020454630627073800850452460158487760266394408710221643505798360283738, 56729956460199305019441584184914729272661532037080935244087594435220086006307, 62039396792619765440106521363503635264208869754554560630026111496679072778122, 2393458745997765849524009470841489934632527663821258015836036776013536950950, 35915327454351624449823951016325751779776476237317012289496757290655725512173, 32606524479615026657452402620774183996842863618201886022072527830448469143354, 63235637104235763521471020678482591762365962539497201272446150774560661623146, 62208964066864651499810642926855154855961192109426476051220581622874074871556, 56823425142073561606336827683244447153122191299012994793162957373419782442861, 60885675233604760515790987357657130734130927344692532134660791434444881730069, 70128263220978378037998154126965802527577393332688627564386146841574995052881, 71018980922731664798406835410011497130959699315348431777949257381109611662531, 12143164079299710577697191074655687226341720767219380493916347970636555672200, 13508918371738967514239962849170666297725816564248068619597724335815422874867, 35455956156846758401498039994914987477656410741995261921339242861566953715810, 69980758495467248406706658186358315365421963514406314839633132920772753269590, 40780609781497584108689952068487274243081363044494223353377248536197342087646, 44867942499383360300066493293729414921480295687316596135570022888723461284905, 82725154870798626926322339306353417520587153667878451856611421219700157524903, 25126631681527477467395254546272084567454410334950820629891182857858739056234, 6951466886617047161399523857762365328179011042304277010521273986635895511090, 76348861623318422648322072872825713398471251831589343473949016976971223635877, 56205107190224957419682681113714452084261733562014707901087589292788540501506, 18117892543394976645523077630904329147251317704285881519049138075260678609853, 44808031105096301006447146332872279574072682041430481888991436113801413524922, 49253422883319286749223459668126849556879848229728760990408851547046135426202, 84189814930926817953967035166781168797567323089104013113646102708978330223462, 47137140069594189485896203757476808738350291684312377044596204628988007490802, 40801572088832002265546622948401731702850273201235765228409527972304470614013, 66031049946459598112632104872606456117378438456948859102185817862671625118362, 81720181560222737179789740743588444616843925127263616533094516919384531350798, 22799062566507850812703708400514738660780510100747243720001217935586864713536, 19636898235593770858368519750634152409107475396982151534080287393055054087250, 29019136605948188309201641456999919579306004440518777086603961225647602320689, 79880698495154758609432245210109366091585969807890967815410904513080769679673, 9333444307040962156247586346311311869921891214405652789959336947220586492578, 5389291816105059661723219597627983160117906098832235782666626188832333763452, 80140247201709476779769310874536378021073864035213177889595402673752593492257, 10265989744904418075184606188771633319731922237097882332727796873595806941649, 28947186543573208323555611612621027283989204690818732739083074045376664847781, 76665830939598023116888796550932971936723367285838797618563918377195976634315]</span><br><span class="line">c = 1381426073179447662111620044316177635969142117258054810267264948634812447218</span><br><span class="line">flag_md5 = &quot;cae8243e01090ccd03a66e3a4c52b7ee&quot;</span><br><span class="line"></span><br><span class="line">n = len(pubkey)</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,n+2,n+2)</span><br><span class="line">for i in range(n):</span><br><span class="line">    Ge[i,i] = 1</span><br><span class="line">    Ge[i,-1] = pubkey[i]</span><br><span class="line"></span><br><span class="line">Ge[-2,-2] = 1</span><br><span class="line">Ge[-2,-1] = c</span><br><span class="line">Ge[-1,-1] = p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">L = Ge.BKZ()</span><br><span class="line">ans = &#x27;&#x27;</span><br><span class="line">for i in Ge.BKZ():</span><br><span class="line">    if i[-1] == 0:</span><br><span class="line">        tmp = i[:-2]</span><br><span class="line">        for j in tmp:</span><br><span class="line">            if abs(j) == 1:</span><br><span class="line">                ans += &#x27;1&#x27;</span><br><span class="line">            else:</span><br><span class="line">                ans += &#x27;0&#x27;</span><br><span class="line">        flag = &quot;flag&#123;&quot; + hex(int(ans,2))[2:] + &quot;&#125;&quot;</span><br><span class="line">        flag_md51 = hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line">        if flag_md51 == flag_md5:</span><br><span class="line">            print(flag)</span><br></pre></td></tr></table></figure>

<p>这里使用的是<code>BKZ</code>算法，暂时没有了解</p>
<p>sagemath中的<code>BKZ()</code>可以设置参数，例如<code>BKZ(block_size = 16)</code>，指定了<code>BKZ</code>算法中的块大小。默认情况下是<code>block_size = 20</code></p>
<h2 id="第五空间-2021-secrets"><a href="#第五空间-2021-secrets" class="headerlink" title="[第五空间 2021]secrets"></a>[第五空间 2021]secrets</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random, hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag[:<span class="number">5</span>] == <span class="string">b&quot;flag&#123;&quot;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>:] == <span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">secrets = [getPrime(<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">a = [getPrime(<span class="number">511</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">e = [[random.randint(<span class="number">0</span>,<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    tmp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        tmp *= secrets[j] ** e[i][j]</span><br><span class="line">    c += a[i] * tmp</span><br><span class="line">    c %= p</span><br><span class="line"></span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(secrets).encode()).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">enc_flag = cipher.encrypt(flag).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(enc_flag)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">7920896218820943056702891053785968782942077704655549145065876361907786355057528237061821280280635146678227702121299090049267547565989625947956850127609879</span></span><br><span class="line"><span class="string">[5159988341992193282580685525745512910538614629527934692498086718630359717994948104271635300443062627349528208661883545208904466234606731357843882012950859, 6335284643679900918720817621948758994408045076082703123014899812263624185305268879304513104269749790342063146501376008458665966651095670658606928517201721, 6076126683981038494289949541335915228950649182831013867715530414744306299113418155691977393469353865827225836608438360416489035800225275307683760086087019]</span></span><br><span class="line"><span class="string">[[1, 2, 2], [1, 0, 2], [2, 0, 0]]</span></span><br><span class="line"><span class="string">2262305826865903827781721021939132022253239409560318732728105425007767005455109451147816015758855318893496902119172860305961200859254558917933621119030425</span></span><br><span class="line"><span class="string">99ff236d4f1e020e6c83cc154e20f71eb510913056d47344b44a87f98664efd3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>提取题目信息，发现有点类似于背包密码</p>
<p>已知<img src="/../images/Lattice2/29.png"></p>
<p>构造格										<img src="/../images/Lattice2/30.png"></p>
<p>目标是得到</p>
<p><img src="/../images/Lattice2/31.png"></p>
<p>根据$tmp$的大小，让目标向量各个元素的值差不多大，最后应该是构造出这样的格</p>
<p><img src="/../images/Lattice2/32.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">7920896218820943056702891053785968782942077704655549145065876361907786355057528237061821280280635146678227702121299090049267547565989625947956850127609879</span></span><br><span class="line">A = [<span class="number">5159988341992193282580685525745512910538614629527934692498086718630359717994948104271635300443062627349528208661883545208904466234606731357843882012950859</span>, <span class="number">6335284643679900918720817621948758994408045076082703123014899812263624185305268879304513104269749790342063146501376008458665966651095670658606928517201721</span>, <span class="number">6076126683981038494289949541335915228950649182831013867715530414744306299113418155691977393469353865827225836608438360416489035800225275307683760086087019</span>]</span><br><span class="line">c = <span class="number">2262305826865903827781721021939132022253239409560318732728105425007767005455109451147816015758855318893496902119172860305961200859254558917933621119030425</span></span><br><span class="line">enc = <span class="number">0x99ff236d4f1e020e6c83cc154e20f71eb510913056d47344b44a87f98664efd3</span></span><br><span class="line">enc = long_to_bytes(enc)</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,A[<span class="number">0</span>]*<span class="number">2</span>^<span class="number">300</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">2</span>^<span class="number">64</span>,<span class="number">0</span>,<span class="number">0</span>,A[<span class="number">1</span>]*<span class="number">2</span>^<span class="number">300</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">96</span>,<span class="number">0</span>,A[<span class="number">2</span>]*<span class="number">2</span>^<span class="number">300</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,-c*<span class="number">2</span>^<span class="number">300</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,p*<span class="number">2</span>^<span class="number">300</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        s12 = i[<span class="number">2</span>] // <span class="number">2</span>^<span class="number">96</span></span><br><span class="line">        s1 = gmpy2.iroot(<span class="built_in">abs</span>(s12),<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment">#s1 = 2328484063</span></span><br><span class="line">        s32 = i[<span class="number">1</span>] // <span class="number">2</span>^<span class="number">64</span> // s1</span><br><span class="line">        s3 = gmpy2.iroot(<span class="built_in">abs</span>(s32),<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment">#s3 = 2829061799</span></span><br><span class="line">        s22 = i[<span class="number">0</span>] // s1 // s3^<span class="number">2</span></span><br><span class="line">        s2 = gmpy2.iroot(<span class="built_in">abs</span>(s22),<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="comment">#s2 = 3354920123</span></span><br><span class="line">        </span><br><span class="line">        secrets = [<span class="built_in">int</span>(s1),<span class="built_in">int</span>(s2),<span class="built_in">int</span>(s3)]</span><br><span class="line">        key = hashlib.sha256(<span class="built_in">str</span>(secrets).encode()).digest()</span><br><span class="line">        cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        flag = <span class="string">b&quot;NSSCTF&#123;&quot;</span> + cipher.decrypt(enc) + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="参考文章-1"><a href="#参考文章-1" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://harry0597.com/2022/07/21/bag/">CTF·背包问题相关 | Harry’s Blog (harry0597.com)</a></p>
<p><a href="https://jayxv.github.io/2020/06/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bknapsack/">密码学学习笔记 之 knapsack | Van1sh的小屋 (jayxv.github.io)</a></p>
<p><a href="https://www.ieice.org/publications/conference-FIT-DVDs/FIT2018/data/pdf/A-022.pdf">A-022.pdf (ieice.org)</a></p>
<p><a href="https://ctf-wiki.org/crypto/asymmetric/knapsack/knapsack/">背包加密 - CTF Wiki (ctf-wiki.org)</a></p>
<h1 id="隐子集和问题（HSSP-Hidden-Subset-Sum-Problem）"><a href="#隐子集和问题（HSSP-Hidden-Subset-Sum-Problem）" class="headerlink" title="隐子集和问题（HSSP &#x2F; Hidden Subset Sum Problem）"></a>隐子集和问题（HSSP &#x2F; Hidden Subset Sum Problem）</h1><p>这个了解不是很深，接触的也不多，</p>
<p>只记得巅峰极客的Rosita有点关系</p>
<p>参考文章：<a href="https://lazzzaro.github.io/2020/11/07/crypto-%E6%A0%BC%E5%AF%86%E7%A0%81/">格密码 | Lazzaro (lazzzaro.github.io)</a></p>
<h1 id="容错学习问题-LWE-Learning-With-Errors"><a href="#容错学习问题-LWE-Learning-With-Errors" class="headerlink" title="容错学习问题(LWE &#x2F; Learning With Errors )"></a>容错学习问题(LWE &#x2F; Learning With Errors )</h1><p><strong>给定矩阵A以及带有误差的乘积</strong>$\vec{b} &#x3D; A\vec{x} + \vec{e}$<strong>，还原未知向量</strong>$\vec{x}$</p>
<p>即求解$A\vec{x} + \vec{e} &#x3D; \vec{b}$</p>
<p>通过线性方程组的例子，来理解这个问题</p>
<p>当我们在解线性方程组：<br>$$<br>3x_1+4x_2+x_3 &#x3D; 0\<br>4x_1+2x_2+6x_3&#x3D;1\<br>x_1+x_2+x_3&#x3D;1<br>$$<br>可以用矩阵表达</p>
<p><img src="/../images/Lattice2/24.png"></p>
<p>即已知$A,\vec{b}$的情况下，求解$A \vec{x}&#x3D;  \vec{b}$</p>
<p>现在如果增加难度，把这个问题变成$\vec{b}’ &#x3D; A\vec{x} + \vec{e}$</p>
<p>这个$\vec{e}$是固定数值范围内的一个向量</p>
<p>此时，我们能否通过$A$和$\vec{b}’$的值来还原最初的未知数向量？</p>
<p>利用格可以解决</p>
<p>由$\vec{b}’ &#x3D; A\vec{x} + \vec{e}$，可得$\vec{e} &#x3D; A\vec{x} - \vec{b}’$</p>
<p>则有</p>
<p><img src="/../images/Lattice2/25.png"></p>
<p>格基规约后可得右边矩阵，再求解这个方程即可</p>
<p>以例题带入该求解方法的应用</p>
<h2 id="SUSCTF2022——Inverse-Problem"><a href="#SUSCTF2022——Inverse-Problem" class="headerlink" title="SUSCTF2022——Inverse Problem"></a>SUSCTF2022——Inverse Problem</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gravity</span>(<span class="params">n,d=<span class="number">0.25</span></span>):</span><br><span class="line">    A=np.zeros([n,n])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            A[i,j]=d/n*(d**<span class="number">2</span>+((i-j)/n)**<span class="number">2</span>)**(-<span class="number">1.5</span>)</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line">n=<span class="built_in">len</span>(flag)</span><br><span class="line">A=gravity(n)</span><br><span class="line">x=np.array(<span class="built_in">list</span>(flag))</span><br><span class="line">b=A@x</span><br><span class="line">np.savetxt(<span class="string">&#x27;b.txt&#x27;</span>,b)</span><br></pre></td></tr></table></figure>

<p>根据给出的$\vec{b}$，可以知道n的大小，于是我们便有了矩阵A</p>
<p>因为A是个实数矩阵，而且里面的元素几乎是无限小数，Python的浮点数精度为17位，矩阵相乘后，必然存在精度丢失的情况。</p>
<p>就是说给出的向量$\vec{b}$ 并不满足 $\vec{b} \ne A\vec{x}$，如果直接求解矩阵方程$A\vec{x} &#x3D; \vec{b}$必然是不对的。</p>
<p>不过可以表示为$\vec{b} &#x3D; A\vec{x} + \vec{e}$，则有$\vec{e} &#x3D; A\vec{x} - \vec{b}$</p>
<p><img src="/../images/Lattice2/26.png"></p>
<p>即构造格</p>
<p><img src="/../images/Lattice2/27.png"></p>
<p>不过需要注意的是，这题中，$A_{i,j}$以及$b_i$都是小数，得先乘一个大数再进行规约</p>
<p>最终的格（利用的等式：$t\vec{e} &#x3D; tA\vec{x} - t\vec{b}$）</p>
<p><img src="/../images/Lattice2/28.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gravity</span>(<span class="params">n,d=<span class="number">0.25</span></span>):</span><br><span class="line">    A=np.zeros([n,n])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            A[i,j]=d/n*(d**<span class="number">2</span>+((i-j)/n)**<span class="number">2</span>)**(-<span class="number">1.5</span>)</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;b.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).readlines():</span><br><span class="line">    b.append(<span class="built_in">float</span>(i.strip()))</span><br><span class="line"></span><br><span class="line">n = <span class="number">85</span></span><br><span class="line">A = gravity(<span class="number">85</span>)</span><br><span class="line"></span><br><span class="line">t = <span class="number">10</span>^<span class="number">21</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">    b[i] = -b[i] * t</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A[i,j] = A[i,j] * t</span><br><span class="line"></span><br><span class="line">M = Matrix(ZZ,n+<span class="number">1</span>,n+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M[-<span class="number">1</span>,i] = b[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        M[i,j] = A[i,j]</span><br><span class="line"></span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">e = M.LLL()[<span class="number">0</span>]</span><br><span class="line">flag = M.solve_left(e)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag[:-<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>

<h2 id="参考文章-2"><a href="#参考文章-2" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://zhuanlan.zhihu.com/p/621070457">容错学习问题LWE - 知乎 (zhihu.com)</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/150920501">初探全同态加密之二：格密码学与LWE问题 - 知乎 (zhihu.com)</a></p>
]]></content>
      <categories>
        <category>格密码</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>随笔(一)</title>
    <url>/2023/07/04/%E9%9A%8F%E7%AC%94(%E4%B8%80)/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重试" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="8f9cb689a5768816bb69c2487b8f03966744eb88341775fdf7b991160520bc20">ee88741ea599eb54e0cde20fcde6e56c0bd7274f4b6aba8877f800ce610de20407fa639f13533f9a0091bd5cd830849344a1a5764f4e849f0c4cf4e5a55919c1e23b542b52c6e9db848e2ce91c33904e1b5701980f3f3d26c74b3bc9bde7288be4b0bd656761c49daff7394e789f8eb5539f8e83e945d5a98ccf19c5e115c20c2529fc4139a0c5e3f3e6044aa9cc96fe4713e74a976b51078a1fd6b7d75cc3622028f61f76207151450498709806d7591f92a6a81a2afcd11c28051dcd263702909534eece970375acbca20c5584acb168d215495840a848bf802636b3addf5c01108a75336c1a1ac4f1fb1f4bce9f00799482b7a7f9d72e2e8bf2c9cbe9fd52efda67490adc7126c241e607748a4d7c32ca46f1fc2b7a86a0944b59ee3f2589c87d6c4d28429a3d277d169e40c3ad12e1fed8ff802f473e3e6db12d7633b104da43f0a8fb71e45cb70268bb6ebd2e82d218dc38b05c9a50a83cec78d1e2456e55d7856ee2568eba626edbe964874f995aaa713b6139bd2fd4c2403aac3d63853a0fce7d182a9aaa3ec1d2a6187fdd19bc79d4fce5bbc53e99490d30483d64319b6fff7699732f78bfa6a1050d1e33c75da8b87dc8bac5e9a0ee17ec60be233e4881a6c7ff1901056af2b557453a8e34f737c84a97484caaffadd127dee599819809f184244ecde8a9fad522dfa134b0ab2a9fd9a7247365f3489e6b1db70d022ecb401aa03194231581b52d399cbc7cff8abda75cca9493cfdd7563c9babe3af17917f506198dc7daad465a337767b9b7ce0a10cb523f5831220a9b36d810b76ffff4ba59bb990d99cc2436933181d0c55a2b0d98c3435a151a240755d7e6551b989d90564df39d34631d5f421402d452ade5f284cca3ae82a65341d56dd625f8462c3b6906e4fbdd2e245182e03c4d09145ebfaae43cbf94636dd142108783e5e8dda65f02dd1c956e5410fcf02342009b26bc7d49c49b6cb4c113e527502f74b8cdad79e62597b7498b3381ab04a08f7aad3181eda28b226e953133d10b749fc7be784113909ab7c24eeb37b65eb56d9db2333c8e0efdf69b4357ec16c3dd742ad9af0c68be9d8dd48df2c3145f264f76bd1f331f52ccd585954235b8229e6f7829494c8308a8590bee69419232e53e4400ca4c0e1f36758f48712e8e82a59abea73139abf8ddb0887aa13d6b42b7f5fcb90576621abfe36ebf6b22b1600f546f9d4e439f099375b50edc2f61b625a2c814ac179070b2d77839932bc3699c9a56e37e3e4eded44734afb30bf2cf0b988e477f9f5d29a40ba0d6488eb3c39e388bf97c4dabf55de3bfdc7e7b8b929f04b6aafdfed7e9f857c74a5024823313aff6e326bb6b1438d3349142c3aab7b54199c20e766063687d101ce0a1ca3a15b041f967dfef82d9d5ddf20dfd623a9be1a39a392c7f05e8795f0420ccc706882b06fefc0ef95c48ca127515dd8067d13335b2b56b2daf875683541ba7919808a8f5c5cd06774c403c3dee556434324427ba34f44bd8620d151a1666fc4adb4ec171f1f900eb85b8024dd62e4ff44c530230383c41a4e76e9da81ae036ec1c2af0601744cb7fe6b21aa0628fca4c818f7899a1e8ee25545e8629d109e8f78f6323e16c12e25c30b428751912ba699f51f26921701fb75ee6627553997c842c549a4500d6a8cc791b57aedae0eeffcf39252e5f99a90a950afb14bcc69728a5446fd05bb5f7a631a28171300867e9aacc08667796fd9c9a5dac01ee31ef678a0828a08ec28c358618481f064e89a147418d745209e163def790167529e391017e83d43ce54e6528f66a5ad80b666b8808248600f7fd1f928c2e08ca5f538dfd35c021a7364cdd63e72d8dca35def9b08321553b88e48dea25543b7abd9b7b4139c89c28fa46ffb662266cce5b22a4b0d7020eee32bdd58a9bcfbe3984c69eb91202f81808e15c3deaa03386c6c3e07f0c96b93e42db4f508b34fe2f83fb0c9952228694ea7eaa3761b92c75c6199f523ad7bcd3af055d044a51ed60abbfd26931d2d6d01ff49f95397b32aee0ddee403e91a67f6b5b0c3ae012240a0ad3e63339160f630cddeaf2165fcdc6a3019354723e92aa2e81c423bebbc08ad9f876f1afc6c0d6a2037d7d3fa010a9c9e228c1433014f4fbe6e25889e2c2435b4becbc7f9078329314fad3aa3b0ad4a5e542778a292232eb26f951f86d20bbcab4ad9ace2ba73777d93eccc24b548e459ea28cbf02c08027fcecdf539e618373cec4466b97ae25ce0daa68a4ee645d84905bce2fc0108727012b5bbfa1f9d8012f1c3108b47f9d12a79c5c67225f4cc2ecfd4bdafe7b62dca72d577c622090112b11b197da7717c4f0f8d343d0080ddee66ced3cb19f1f92c658419437a276aab01aa46062532ed2fdaf6e4d44f18e2cd8781f24cd8d4f25a4273cdfafdf04e2289ca8eecb5d9c1f7435a9710520765d8352ee2d809bb886474d13cbedfa9deecfeedeb58fa980ccd04468cb6dab0f47133006417a87b79222e696a2e91516d0e358e680d6c67b98b02f90e704529bb78dcc5922fc228d3b81d86c042c1f1600351c8f951ba549f0ea73f9bb5a7da1f63b700627db0bc852f6a04c7889d2870280281592a9a8888b71f4ba0e0c04d05e98a586458d179e5ca3370657dcfaeee37f6f9d56ca5ebe22467a270636d0521098a49cf640fbd65eb57fcc6bad861bbd41410e63219073166b292ea460830269aebcbd8a0a0e32d393063cb337863197f02d2dea221574d73c8fe5feb8c58588265c8b6b74e094aba0df276527d6dcdf7f377b1a3d1f86ec7bf4e38a7992c36203326bfc29fd63696a16c78d060b43adaacacaaa9af56c293adfe674171099167fab3e255b723ae34711fff288b3a137fd4e012acad787739a09e2193eb8606d386020f0b232d262ce7aa0ff23d7af80ef23334f61112edbdd518ca027bf230aec3fc9a760fda3bc489d5221646f3b7bbe4a37f185878dbe70891fde83e82c9f82a12206488c88e2f6601bbe529828daf6517729aeaa2655dc117e6e033b4cd538fa4d9e39019a7c581cbf239624550532fea92ddd5965f35b99737edfe79a01227e6b245c156ebf6da4d7104818c7310a4dc264f1c5e297ddd08cdea125670462e4cefadf89628edab0e60ccc634a104d1922f748f3428dd241373bd94dd3c37cfa3320c3538483a47cb7693b51695b32afb7905c60f7cad70a81c972a4cae4460f4f3e79c6fee45adf79d27798a966cbb20dcdf93f172fddfe82913d32a1e455ff6e41f65388823a1ca285477c6dd3c1e898d7fcaccf2d939bb0cd4f5546cb862b66427f3aed2b115e96443dad4f6a4529d31f6c6b1c90600c243b44bbf4508b52af83a8b59b99f0f8744e77ab2eb46fe399dfd69d9771a4604a0af38352ddd0e2c9e289da714a22fa028cd64a4b8002b3f1bf31a69b995291cc0caa9c0fb07016d6eabfc474ad41426d4b530ab335678cc5be5dcc84a1f720fc8541646036a9e2d278787735994e2140e7d6283dd28360b93a7959036085de326f10615835c41806bacdfef23bebd4b5e69b671a86529dbd4ea96229ff56e5d180e0fcd36e6fcb1becbf3c2bcea694ba11948352178fee0f8a</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-up">
      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-up">内容已加密，请输入密码后阅读</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>沙盒逃逸</title>
    <url>/2023/08/18/%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8/</url>
    <content><![CDATA[<p>从HNCTF开始学习沙盒逃逸</p>
<span id="more"></span>

<h1 id="calc-jail-beginner-JAIL"><a href="#calc-jail-beginner-JAIL" class="headerlink" title="calc_jail_beginner(JAIL)"></a>calc_jail_beginner(JAIL)</h1><p>题目源码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Your goal is to read ./flag.txt</span></span><br><span class="line"><span class="comment">#You can use these payload liked `__import__(&#x27;os&#x27;).system(&#x27;cat ./flag.txt&#x27;)` or `print(open(&#x27;/flag.txt&#x27;).read())`</span></span><br><span class="line"></span><br><span class="line">WELCOME = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">  _     ______      _                              _       _ _ </span></span><br><span class="line"><span class="string"> | |   |  ____|    (_)                            | |     (_) |</span></span><br><span class="line"><span class="string"> | |__ | |__   __ _ _ _ __  _ __   ___ _ __       | | __ _ _| |</span></span><br><span class="line"><span class="string"> | &#x27;_ \|  __| / _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|  _   | |/ _` | | |</span></span><br><span class="line"><span class="string"> | |_) | |___| (_| | | | | | | | |  __/ |    | |__| | (_| | | |</span></span><br><span class="line"><span class="string"> |_.__/|______\__, |_|_| |_|_| |_|\___|_|     \____/ \__,_|_|_|</span></span><br><span class="line"><span class="string">               __/ |                                           </span></span><br><span class="line"><span class="string">              |___/                                            </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(WELCOME)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the python jail&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Let&#x27;s have an beginner jail of calc&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Enter your expression and I will evaluate it for you.&quot;</span>)</span><br><span class="line">input_data = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Answer: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">eval</span>(input_data)))</span><br></pre></td></tr></table></figure>

<p>了解一下eval函数的特性即可解决</p>
]]></content>
      <tags>
        <tag>jail</tag>
      </tags>
  </entry>
  <entry>
    <title>随笔(二)</title>
    <url>/2023/08/18/%E9%9A%8F%E7%AC%94(%E4%BA%8C)/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重试" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="e0c1cdf3f2a754627741425473fad1c26be1547dea9bb7b7ef765d0628f232a1">ee88741ea599eb54e0cde20fcde6e56cba589507f7ff0da0d480b14d337f40cd60cf6cab30187ee6b23ee18021922b179b4771428af5e0af71a9bfdefdcec8406b991c636bc2e28473087446d3ac2bf0e9f1ef415a3259261a30f0d126ed0ef009438a08e99a1f42b647be2b6f6eda95eedd444113b80832727888831087d798fdec26a593664d76e10ea291e310fb5740834b2a878a680aa16ef4240b475c89e3ff90f6df9221324502d816fe781b24889d21b3b134ec4d45cc5424ca296210c7ae5a71abb4143520561ce449dd5bf668454e03f2d63ada065991ef110ec5537d1b815a4c436cd53d68d1a57a7ff3d23b8a33397846facd1edd9bc5aaa8953b34588f6f6085ee718b2d8fff85b393be60e1184cd38e0ed259839e479c5353f3cc15e4b1f8f91c569a3d5902254292df4e0da5e7c9614be1f611996f327dcd4f4763d43277801c42944ad3e888db77b7e65733e70b299f1360d48d1130b0d906d1bc79b5a529a5a54330020c7ac2a4879e61d2a3e8696d4c4fd5da04f72da8c35e8ae1235b45f77ca5f01c16d2f66167cdd09ef190a3faf83f7428f29890ee3bc17b6fb56c1647b7fef90a0249b2a1e674b3934bdcd55b9cdca4b5b72ff679ac8756a6c212d6c8b43cd885aaa12cd14f79d3d2efbeef2e1fafc90f6b70e8cf9de8d096c2ed47db398a822670c5b1e63c45e9613a390940cb703f6bbb8cbc16ec850594843801a02839d751d3e30c86eb8eebdee5dcf608c3c368490fbe1951355569d8d964ae65c85c4a591ced679f79fe87447fbfdc7bc29ab2e967735d42d7d4601edc70d0df5bd32782ff1095cb47122090e3207a5eedb55c9bb476c75400427e9a40e2a2875018517017f6fc40270913562601689ec4fd39e6b4833dafe45e08e230bd72f646cc7bf45e4069e494e3cfbac0dcc459f9ee43813c14c5ba82c83f2ca54ccb20a85ea854f863d186b4b438f8231bb02a322c54ad508e6f36a7617d6decb3dd5a362b9ed1738979a37b7add9aafada2b27a803f59a0496eea5696dcf75372ca36fd5ab5d4a4ef70dd9a0414581d53f9f1dbdc3c45929ef32827fa650c32e0ffc4f98b20d54e2b94db61102d9b19ef8c92c842bec8d4d7ccf6ca984d8646b9cb74f4c1cc4309bc7d51556c8a66a7ffb44a7511221d4405f6682e3b723b77059e0079c0683faba5e54ec1a99d2cba212f80f63af2962e52a302099cd15805e21a54fb029124e8c376e65cb37702814f980ccd217fa9c03668cabdab3a7a75ed6eefacbaa55a9e511add716b7d8822342139dfb0db8852fbfd17c00c18dde2083f4a46a6e381b586f6bf11a383be8ae7d631f55c90f2fc79242931f5df4b3d667bcf82ab4bc5717cf37b809721b158ebfbd0d1bd94765148d3267b28af6120f360ee1e44d786684ebe73d6037ab70b313ec7eea438196dd3ab2b091bfc944aad9205a44993ce96200fcca2ac0880b5d3921a84783d3fa07787c099bf93e0844d711988f932fd5a88b608d9ef728f76fde8d8a61ffcc1fd6bfb5a1992042132099f3b140272789b570fdd8dccfee63fc23082b7d91380da04d88afd473c8da8261b6101906e6572ce862b49b959ac3df61c30cd36a729877ec6a29395610cdac5c4efd38006e6af805e602b0c65b789e977c6e59ea2576ad31c69df610d049cc77561abb4aed98d550f7fdaec72d799fbc94bdcfe8a1fea061daa129faf3101d1580ba9f0cc6bbb3c31a12281c8d9fb4d494d79827dbf4bb2ac57a9765e5d8bf24907b83f7a1677884617a8b50d5f9970cfeccef15c922d3f0be7b0b82bcfe12fe9164f54012570dfe62e15c61f5b3b62b82f2745eab204aff7d7be8442e46c254e8506156a45f73a02752b76512290f03be05b622b1c60a32a2aed37f0a810e59ff1b8f0bb2bf365998d79dc2277ca3eb86f07440bd4148e286b1351dc18d8f228857cf7660ee6d1b98449e7a005fc5d0c5a53199a06e80e06693f0db37cb4869c1f0fe5a78f1f5e8d7261636bc82f49db4fe0ccabcebc2ad6b883f5b6b12f0a0017771fe4288123732bf422ec2495b08fa59e4252778c823b2f398a422d06ae4ff3bcdcdba7c223b56c7137f017a8c150f7f0642eb3c0ec2969f29d0ac8e7946cb84333a589f15d092014c6d0d154f9f7118ecece8b83c2760d12768a3a11c8e0b0496f2dffb37a9216ed2dc6a75a04b2894ff325174dde6b37b67313b6f143ff66be81c33e9ffce98738aeb952584a63090c0501d302d30f12fd5b72ccbaabf985bf97d36fee3c5e6f156a11495043fdb442cde470bb69ba5338f830649dd31350ec5436f69479abce98e9565d1ff7969bd2a1fd46bfd51310d7db8094fe8854af7fa235db2ee4c142d73ba6afbf750eadd5e88e30fa0bd48886cf3c971a46565592a358ba6f0c491b1b4cbb1e639cea127c795cf97f9bf467007aeb9c37ec4501bbc1b2c2bd61292b3c62f17be0f9ed1e5280b89658172e0159e61edbfee199b56137ccd79ae6bd43375048285f596acc602496cdfde770562caa46d25ac18bc21eed6a23ecbed3678d2a86eb3895b372d4eb653e2f413a4e370979cd66f07f089904d632c4843e1e34f56fb4de5f72342ad031e31644ca0b0df026e5991f2e147c8636eb946c0ec13b3f5635ffd594a7cb39240ad8cad9bbe9632a98996cc47d6bba67e5295f5630c476113f53ed6eb322e9ba99f5b925a775aabe8456336fd08b33e3ddb2962fd761021051e04a42f63d5358c076bd40a83dfd1e07ec21ff98e999de282f0df286031bc3233653963f9cdc883d5dbc017c64def919704183dc917ee2b613498d70739284233d505a220805bcba7100d30b9d76ebcc898eb82a83bc3d50721a079f78d94a0286c4bba64ca7c0238cba10314f6cfe5904486c83f7d42a85a30335326b81a7473dafc3550f8cf6d0faec0c34bc9bde610d17d9c1273ff11d8ed56d66fcf781632e9c37a5b92caf248acfbea96e2223119c6d25c7e408b6ad648f718d9659d6010efec4eb1be1c46d57f284e40a9bbbfe7f0f192359354f535e377ca03938892d1e656afc0607fd4e073ff786114e580abcb9af59726455f8243d96f015cac266d6baf8820ea102b74b6206303ff6a3cf6e6475d742a44716904caca639b3c4281f0f78d172554c005fd839c26f65d5ab4baeedebb35f492c75d1f5c3eab7ed044034337d24a2e869f21fb815aea483e63db9b2e550da348f400e64521da7f0ded5c93f785d06d64e238e0ec858d78a997f8aa34adb83b83af81bcf48aa60db4fb8f412d343f57c537befd1741409114f276856b416e4a392a22a7a9073baaf1961b868964faf836ce6336806247192d33c2337fb75fbec7cdb7004b15072f9137092c8ff5ce651490a46207a73a40bdfef65349e46c3238cacbaf38790610c9d9e194aee7d33fae769fc8e0c226e2ad677eeb906f74cbbc4e9bd87d617283a6be9f02d4e24d7b1d0b019c9fd30a48a7f137fa880c6f54b7910de19e2b0597828e50c38d7a71c017ad5ea089223229ff72e3007a611fd4b16756347ffeed06b1a499e339c8a6666ad8963dbfd4dc239b5ba0d22e2d2e21c2a6545079167adb3aca9663eacda9f2061f4c85007e3e3090399cffd05e87713148ad89deb3683cf5028d53898ab6da62f57d7383e59d93f7d20d6643de592972f01d3020749dcf035a0d4e6c9d3d5a8574765ac020e66ac4d94f7344563c89c33168e50830fca873fae470388f8601e4bfdd4f92764134df61ce573940782509019f6f9eeaccb4ece44d6067b462b1e4caea1f5c20e91f92f2ebd83d072b6e8abf110a3242bd218a800759ddc34da68c5c9126e0f8ab0d873117d273171b70c969eb76a3096b141ed863b2128f8a38bd62cf7ddaf307ee5e72f4f3f75c7ff15e396098540bae06aa6bacadcf5b9fca2474e7104460eaa0e87a3e451e33e06f9e17c5a72efd7470ea8a690fd105a15ce8573ca0d86885c5ef047576a0cfad718d0a016fe877a2d043dd2a14cfd87f58e6284c1d4ca2d0f54d6f1c31919e9c2dd7ee1382a800165a04048f686a8e8a9c810bfd8633304bb91d7d3c836c30e2d535d826c6aac0951b6ca2191afaa730dcbf092a6270d10d8c1f746a8627473771689ab714182338a1c9d4d9f9857900d89858153dcbadf85c8be6402a9dd4ee93cc4174d43e3a55f3428648fa19572a26d9899c5446c545751b93c6e3821f1a5445528e9c3e0284fde08dbabf4cf3f704d101adc2a8f8d0579ee3591b1379d72ad8ee189022e5bf9095703f9a3d0a82552b95e8b45261a1865745ba3ef39469ecc90dccf4e849cf153e2d4540ec11e72b3923242571302a69ec647404876077b06925c5fe397d6ba3839d493f39aa34c9880cb368c5a29cb1b078e0c8bbb822fb79e0c9ef994ba5ab9d9eb5660f57f1e3f5649a728df354982bd551ba7bd01b6fdae26bab2014b2cde4575fbe66b065f186e9c6f0e98f0d719302b7300bd29bac82e0d7ec5abf10cbe60a2e02d1aa4cead3807de2d73ddaab4c12f57a4c2f71e1649d019c3f08c9d3560fed6c1974e48f4bdcebb0b51f712d97ed2e294ff2c2e72578c770c1009b8f7253f01c79c4f3166465deaa64f51cfa76639f9316a9bc77854392246cdd2bc08e30aa095a0e42f33c922b6e4adba1ce11673feb6792d1461665ae226b0e45de717e2538ab440da17791e1d9c9f1b9e0f96cb364056d65b77c5fcd9b93ddbee18d03f0dbf22db6dd6001e4c115a88e234ce22c692d4c17e484cfbc2bc6bcdfa9f9cf4f53ae4dec86f088cd0e4e51f0531a695b8bcd441a92f2711f77082451e8308d13b11e7a5fdf4cda1b47fbef229bda51d1407f19e9da34812c3216bccd286e243f5854520393b1e8c330f94599ad72af003d459b21c3dc19931ce8dd7911df6715592e2b376dd2e0319170b328ca9aa8cb3e74218abe8305cc392310000f88b3b60666866f5bea6a1b81be9eb4b724d40d41108f60035d373b7ea341b83d109e6ff0a70954dae9919a7047e81a43d74af69ec2f55725b004cdd8118d748c18b11b406ff58c66fde65403ae56e4ebf1fdeae0913f5eec220f3f2123da44ea5f8a73b1e7ab2121d0292a1aedf8cea6cf394c53ea908817c482432077880af495f4ac57296cc1ffb529c0e50cea1a01bcec05fb46fa9583af07ec2bd4b3372a077e923fc6806cc94862127ceb76ce0b37523a29f8a381106212e2d0c829980c6003dd868e4573c02fc31d97021de229c1fdf7232d26e1ee5f8dc3ea5e7e52db8a303fa23a72603e09685f83e9174366a9833661e2186e3808221ab4e63ffb65e26176a07c77b7b2ad961ac65fe562e74879e7bc9f8ebca4a43f01c00e00e8d1ab175c4453ffd058a5f315b61e58aea64531a72da443b9206d3843bf4c141c9a221b36c4349fe2c2a81674fd4776bcdee7d80281b32d27940ad8ccb6fa2175062b2435d86c66ce474b49d083f56babb2972eda9609f204d131d0db3db186e2e3433fa1b2cb2d582c5af3dd6a94fb8599509f7cfb95d14b931e6b2490ff727b3a35aa21dfb09dd71029e096d0005f366ae43e186d47aa0ec9b629d602a98b111086b11124586ed8069e34b21e9abdd694a70bb4c1238d87d84a89e03848d257f37799c0077a52c27aad438abb50036b1715a7e0c5e574fb41cdf117c3ebd9e589818dfa0d02dc1f439d74c766c002c20043cb665b7a5ad8c92b03cc057ac043281224f0a5530b849125e1a7ee786252236d7ec202367bd98d96091b12b863cff642192dfe665655a2f3069ac8d512e216a07b7166fa6feba9e7affdf94cd4572c15ee8146ebd38d750b37fe11a3d90b1cbb55d8d06e8c63254307b8586d4108759b1758eca63f73c4c015831a4478798a498716c5308c65a30d8ae2f539c021381fd4db0e40a020b5b70bf85b9e432d52cde9db86f943daa7c57979cf91cc211bed97a0d91c236397cbf77aefb1de05cb13bef15de9686fca01c4f36700f6b286b5f787919a163718b41b34f92ea8754ed08f9343a8c3fa3443083d2016906b1ad743f324249847845a53317886313bf6581026e6be1b60bed2c814afd990a9fce33c41b7d1a7fe162efff6c4a198f009e7cfdc43369c937b39c07a0c425a9bb3a63b7814ed8b5d6d1a5e4f23edfe4a9eb667e6104c3ad7ea2b795f4bd9038916b4220833e56e626092d760b84d152f1c2111fea863e274ae7a70d6abf09531067770e35f915a1867987f2d13aea6f346581302ad3693894d5e2994cddc8600e1267652801fccd4defdada2107569df6a2c8057262e5dc7758b93344ac45be09e926b267f20795d44da9728ad1837c9a191fd8bbce12c44948c526369c9f3ebcdd789926538f6c46dcb9995353732b9f437e0b06685140b5c05dbf4097cf259f5c8a5fefa2bb6a2a532cef5cc01cf43769789a3ba5db2f508cd06b719a0e97186e3c8584a55d84728378317997ff514eb5bd354789dd96798ff02c9c44613c4b8b8d4717a07ddb12c336c74058ed6902c24498b3a037abf9506ab2ba09c6b3c04c252d2549333b712a97d4651670c87cd0b59229463a6eecb4414a4085ddd8dbcf75611a7595a7920481f56e7a883e23f4bca578e660528851b9c4f593f8b088f706cad0f09fc18e7bc7ab5a23cce7acae763c7eeb92a6a50daed03fd9826ffe2c4a5c30add485d235764db2b9f19f595caf094a1173a31dea91545b2d6ce18c3a7cfb8e6a9d017348fa612056f1c9950af36cb34b777c7c4c221b8fa10971646d4f1811bdef6737f2f4c14fbb4c90c70210fe3b9476bbe434868203917809e73c90d7a492c61b0e572d37ac3284c0099e9d7ef74a353a2eb093c3efbb6755fd6a2270b1a7115b04555828d2ada7e1779789a09854e9ae569a6286d635bc2ac101f3cdbeac0c35755d4e5e61f1f98d397b04f91f1da2282455d5b4945c459230b1b1f16dcfbb097302e8f7e98403eebfc20287d03ec415420b5b9e3c51958b2e937c5fa743ab37e838023ca34dc42af4ec0fa12be5da7f01a4d0f0553ab92ba7a0c086e8d405b492de358733a10fc9a68109be28332e7065b6142587702f11b4c16f961a046db1966309c80c374fca3ed370e40ee29e37f3d283f22a1a46d90c5f0af0b82a3beb77f29c20aa3466d1804cd0ad75287bc29de0c6b8a675970cbfa909daa7a441dfca1f242ea1434a50e218727f702665fa990370df1385db325b44cd6f9c14bc590881b35318c271a764633f6a27d998ed83ba96121580318992b69f9a464e498e58265ca7634e0515b0cac6ed2067d59bd4a0b02ef0074ab61114a32e640311d3b2073a1729169891afb907de413a225f93b84fcdf21ab6237424a748468db26e7fca25b8d4408f5d77c0694a8c7544acd06124ab628aafd85e987aed4fd2c0be985b561a131e9036b9214ba2f61d90ac71824d8e8a44acd2f795c94d6c21babd94582e24a67d67dee94445928dae42b2436d5f99b794ae8cddc27cd74854c16c5d060753d48c10c028a89ccab62a9f0a5ee045e5bf05ec76c3c4d32d6146163af01816e163b2afc5bd68e39d4d95ce44d7f2a71960dd50c1fd8bf668373e0b8e88575f6293c54aadb5b3a1b8e75a85bd3b95117ea8f4547a551d4fd0bd48e6cddb8f3d3498ffd967fdeaffc52e8a6e3a3387bf826820b154d8d530dc726e5247337639b262c80ad0ee7d37fa83543f87a4e09a8304471cd800bf90fad863c69db915dea6ff543fa8ddf18eae1dcf5517c905cc9bc7cd2d0a1ed7c963d0746ff133482321dcd9ce1ebdc1790cd77a63427819190c4bb61ba27a6a688e5595677aad918c1f12063a7801b6dc3d0006100f42caa68812d2f006c0b53d5d4a6c67fb27aac898ed4061306fc41f476d6651c207272d1fb21fab640820ed3a6fe62df6d5a36f37b9c12afb42c4502e299696667428b14f91292ca8aee4fde7586e95bf3e52de891d5f4bf0b70cb3eaf121957df55dbd5ec7485ccee2b7ce1ec957c6572bdd41111634bc31549844f1d61b3ea08f1d0fca41da57ae43e60c14aeb46ba66b88e31422f3f7063f9fdd5e504ff740b285ec7dcb7fe73bf9bed7ec124d2a326c5a7e3dbc987188cc54f06c96a29cade278becbd1de50c0a95271d0337eb680ee10b7cf3402252c07a5a39f8a49869542c66ab639e6473d274e26f79fe22556f981d14edd7f0a14b23ba2ebd37977e7da7462a38acff5b512f350f83ee9580e68fabefd3c467d885275407b63407148e582c867363f6a30c2e13ac952bad741b58de867e4833ead7cf658ad0241294eae67e59e266f1bac9f8d9301cf8e128ce27ba21baa6346be23c5712ba9e4b6fdbe52ffad318dfaeb427f5c556a59a14b7db05ce31524dfd76da6f525289bc3a5e1ed3969fe997ce3bb487e01fe350b7a45918c9617bc279434c319c990818137f2ec0d6b17d116e487e6c74d507fff81fd4cf0657af5d4aed34457ed135d72c748fc7e7fd38399abc115a0112485b134598d9ebc153c9697698a2e09d2d67356d1835824788dcbd54a7978c05f8ed22cecfd5ea25011a37797a78afde4ce86955e5fb9155e0dda5b9ce6c1a77ef797aa5a6f19583d8a919687279829f5be155de364934713d1fb1a7484751b03bce19794be10c515ea2ca378bd44f0eef59aae45ec000f37116aaef76ef7d97870bc52b181052310150dfbdf05e472704d2d831628b6274142bc80e43b41ca63171c95059ac7044d07d76bdd1d1001937d9e3deecc44c874af7f9156cceef96d06b644fa0c35e54f84468fc69e7ac72823d7dc2c9a8dae39c67dc7079a2e673df252f57595f2a852d0b7dc018ab91f21144ff3d19d341c15dd3835fcb68b9be12cd985cf5f87c4121066369097edc4e3bab74d984de78942f8016b64e6b5bdabdbf12374d60a5a92dd367b93c7494c30c83f563faf9b7b80e981542d6b2fae7484b71d0e25adda9d446eb695e75442ea88ff05eefa6a766b9252a0f1704a6dcf2a2b61e32e1abc95b2b5e5aad0e89057c28380d1bb3185f756ac42ba02f2b79e10ad225c9be6c194134b5dbf917268762b6c71978eec222f40e3f3411ec7fd3ee2d5ceb5781d5791f2aefea4ea0b364a0ec5308de452b39a9da1099d8cdec80481c90e6da22687f9140564881bcdeee34b0813e2ee7814a121bf5eaa6a339cb96776de0aaef5440a1be8d79e245513c863584067e9fae2bb03497f919efbb32e220a53a91af75c14a0064c9a61b7909a1603fa65828c7f31216b6ab1ca39c390b5f875c4e317891f8b1485fc343dcb2595a64d89c0b937d832e8a8f1e2201be5436d1974624e77d0b6e9a32ff25ba4939ca82ddd7484d6acf717e9fcfbdcc16c6d267b38a3151b88aea5b78e0b8fc876c86bb50f98606084e23e78e01ff35ea9a52f51caa369e90036bc600aec6dfed3247f7db87f7d22cc0a45dfa5b64ae135e4099ae6cc5fb38440daaf30191a7c2520abc791f9c7cf1d08196c337fd46d653f65394e1ff4095c4aed665de47925bf335db7dd7bbf113e5f6433035ef1476b10fc1ae72260ff03271a9d7f141e206f38ca5882a48b0078291d17e12ec711a7379d938b14502636f11e3c0ac4d0e136e835fcd912e67726ca8b45affc73b7aca5e4e8d3fd038f55feb2ca0f210672b17210e36fbb73e5f7abbe31347e71420f2771a4267b9b0bf38331a827828bf6daca394c0ace634694a375e3d8e467d9fc8166e797982c0a4540beb77126e0b8ffc9d9ec5d0278adc92edbfbd957bf72ab9b00b7edc1834ba3078b45dc9837ee79d4d4bab185e30b6b38ac97a84b210f07b1dd873c9703f64b77f1f7d97a9ee50e7693a78e38dac47de7c5f20f7bed3ba1a590d5c13fd72ffc19a4e693dfbeb0be5762ef2aa91cf91d9e0bd1461022932e14242b911735b253afc1a0c66b3d91ed9d4511babadd8b81595331b7c390ed0e190e0c26428b81338d18234575d55b063f6f006849a66d1af05ab0afdc24f176feced8d8b35a74ba813b99c6f88bf8aa0c78db05383a4b864da50529637194368aef2515cce4ccfb89ed7403a64e702d2f88c6d0311b1fe14aa8ea5181f5541dc8f3392ce34e82866e446fe701bd3384e155f5f5c73a348f577249d28ceb54c8eb065310b4eaf1134721f1bf7e3120b76686c86c68eaf7847d8a5b858e285673e463764b5b7b0652b3a58e98f817112fce4b3577a6aa75a1997b5135bcae49f44476ef7cc9296430e221c656987e8406536068514b4d3cf520b17fce8e548d087de772f1ec94828d2da048773ae6852763e9e060756eb9b8f96bbfab4e5cb9bf6404961fbef79e69d18de6db7165a2e0c6a9bfef44bba46c30268f30e1b1bc099401efdd9fc6b137a200e830c51a5aac8da1d8c0b1f44666059293bc6bb01dbf666bbaa2a7ed30c4be595352062a8a6d59f628c31da8cf54f555eb1041e656393a9bd6601f08b2f7607eb5103983eb9051b003c72fc495a676d6aa1c539bfa47cd2eee8c5043499de707e0e4dfc59da349a002ae75c4541151d95d03263e3e66fdddaaaa2d9298210e970874c1fb2e45dd4da0ce1713ddc368b66753877bf9a82ca09f751d18be919adb9faffd9f5c1923e534a42538121c9ee71dffaa2cf1a54161c333fad862dcc7f4f399dc8f6748241042064244659f00788c50fe314cb6b3eda3413511e12bc30ebb858a21c1291df7cb1544703eb620b8eec073ef56189f492717959411a1e5a2122c5150ac76142dbc7c8e6da1227c352289c0ccf452a21160ac03dd800c179cd9ce82eb8655eecfef3fd71759674ec606d0c9050902943a6ce485a632ee99e33d32bb8c6d552e87681efe944daf1699d3bc1b2c54e6a6303d6b3a4eeb04dba2e234e9f9915e695180e25e2995e0473b373888f41f6fcaf04992c75512fe3b16610944c23f4087d602b0b03be40e15b0e462206d47266ea74ef6f26fd3bcd6980ea6c68a690e26bf418138f2fb4546b915030fe5075b81951afcb83c02e8579494891d1ea116d254e7cd06269e5a0e960facf74e3ab8b09e1b941256350af5690a0b3e365eb9ff62f73f2c0f44bc18e3845de562a14bf1a5825a8cd0ae8af4fcd19db0f9bbbeb37c817327520ea98e3e8e630e1929e22144ddaa6d726dc69d822eb90d56e324e260afcd2a1bdb68fe8cf1c741ff740bedda0d9ede379f0c2c45fb</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-up">
      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-up">内容已加密，请输入密码后阅读</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>背包密码</title>
    <url>/2023/08/02/%E8%83%8C%E5%8C%85%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<p>简述背包密码</p>
<span id="more"></span>

<p>在学习背包密码之前，我们需要了解什么是背包问题</p>
<h1 id="什么是背包问题？"><a href="#什么是背包问题？" class="headerlink" title="什么是背包问题？"></a>什么是背包问题？</h1><p>假定一个背包可以承重$S$，现在有$n$个物品，其重量分别为$a_1,a_2\dots a_n$，试问装哪些物品可以<strong>恰好</strong>使得背包被装满，而且每个物品<strong>最多被装一次</strong>。转化成数学式子即是<br>$$<br>x_1a_1+x_2a_2+\dots+x_na_n&#x3D;S<br>$$<br>其中$x_i&#x3D;0或1$</p>
<p>显然我们必须枚举所有的 n 个物品的组合才能解决这个问题，而复杂度也就是$2^n$，这也就是背包加密的妙处所在。</p>
<p>在谈加密过程之前，先了解一下超递增序列</p>
<h1 id="什么是超递增序列"><a href="#什么是超递增序列" class="headerlink" title="什么是超递增序列"></a>什么是超递增序列</h1><p>$\begin{Bmatrix}a_1,a_2,\dots,a_n\end{Bmatrix}$是超递增序列，指的是$a_i&gt;a_1+a_2+\dots+a_{i-1}$，即第$i$个数大于前面$i-1$个数之和，也即$a_i&gt;2a_{i-1}$</p>
<p>当明文和超递增序列依次相乘再求和时<br>$$<br>x_1a_1+x_2a_2+\dots+x_na_n&#x3D;S,x_i&#x3D;<br>\begin{Bmatrix}<br>0,1<br>\end{Bmatrix},<br>a_i&gt;0<br>$$<br><strong>我们可以通过依次比较S与序列中最大的元素大小关系，来确定该元素性质</strong></p>
<p>例如，当$S&gt;a_n$时，说明$x_n&#x3D;1$</p>
<p>接下来，令$S&#x3D;S-a_n$，再比较$S$与$r_{n-1}$</p>
<p>通过n次比较，我们即可获得所有x的值</p>
<h1 id="背包密码"><a href="#背包密码" class="headerlink" title="背包密码"></a>背包密码</h1><p>背包密码流程如下:</p>
<p><img src="/../images/Lattice/25.png"></p>
<h2 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h2><h3 id="明文"><a href="#明文" class="headerlink" title="明文"></a>明文</h3><p>把<strong>明文字符串</strong>转换成<strong>二进制数字</strong>，然后<strong>从高位到低位</strong>的$0,1$作为$x_i$的值</p>
<h3 id="私钥"><a href="#私钥" class="headerlink" title="私钥"></a>私钥</h3><p>选取一个<strong>超递增序列</strong>$\begin{Bmatrix}r_1,r_2,\dots,r_n\end{Bmatrix}$</p>
<h3 id="公钥"><a href="#公钥" class="headerlink" title="公钥"></a>公钥</h3><ol>
<li><p>生成模数$B$，满足<br>$$<br>B&gt;\sum_{i&#x3D;1}^{n}r_i,即B&gt;2r_n<br>$$</p>
</li>
<li><p>生成乘数$A$，满足$gcd(A,B)&#x3D;1$</p>
</li>
<li><p>生成公钥序列$M&#x3D;\begin{Bmatrix}M_1,M_2,\dots,M_n\end{Bmatrix}$，其中$M_i \equiv Ar_i \mod B$</p>
</li>
</ol>
<h3 id="密文"><a href="#密文" class="headerlink" title="密文"></a>密文</h3><p>$$<br>S &#x3D; xM &#x3D; \sum_{i&#x3D;1}^{n}x_iM_i<br>$$</p>
<p>其中$M,A,B,S$是公布的</p>
<h2 id="解密过程"><a href="#解密过程" class="headerlink" title="解密过程"></a>解密过程</h2><ol>
<li><p>计算$A$关于模$B$的逆元$A^{-1}$</p>
</li>
<li><p>计算$S’$</p>
</li>
</ol>
<p>$$<br>S’\equiv A^{-1}S \equiv A^{-1}\sum_{i&#x3D;1}^nx_iM_i\equiv A^{-1}\sum_{i&#x3D;1}^nx_iAr_i \equiv \sum_{i&#x3D;1}^nx_ir_i \mod B<br>$$</p>
<ol start="3">
<li>利用超递增序列$r$的性质，求解明文二进制</li>
<li>二进制$\longrightarrow$数字$\longrightarrow$字符串</li>
</ol>
<h1 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h1><h2 id="参数不当"><a href="#参数不当" class="headerlink" title="参数不当"></a>参数不当</h2><p>如果乘数$A$，超递增序列$r$的大小选取不当，使得$Ar_i&lt;B$，则$Ar_i \mod B &#x3D; Ar_i$，这就导致公钥序列$M$是个很明显的超递增序列。</p>
<h3 id="DASCTF5月赛——knapsack"><a href="#DASCTF5月赛——knapsack" class="headerlink" title="DASCTF5月赛——knapsack"></a>DASCTF5月赛——knapsack</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from functools import reduce</span><br><span class="line"></span><br><span class="line">def genKey(length):</span><br><span class="line">    A, B = getPrime(64), getPrime(1025)</span><br><span class="line"></span><br><span class="line">    Rn = getPrime(1024)</span><br><span class="line">    key1 = [Rn//2**i for i in range(1, length+1)]</span><br><span class="line">    key2 = [i*A % B sfor i in key1]</span><br><span class="line">    return key1,key2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(text,key):</span><br><span class="line">    Sum=0</span><br><span class="line">    for i in range(len(text)):</span><br><span class="line">        Sum+=int(text[i])*key[i]</span><br><span class="line">    return Sum</span><br><span class="line"></span><br><span class="line">def save(Ciper,Key):</span><br><span class="line">    f1=open(&quot;pub.txt&quot;,&quot;w&quot;)</span><br><span class="line">    for i in range(len(Key)):</span><br><span class="line">        f1.write(str(Key[i])+&#x27;n&#x27;)</span><br><span class="line">    f2=open(&quot;cip.txt&quot;,&quot;w&quot;)</span><br><span class="line">    f2.write(hex(Ciper))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FLAG = bin(bytes_to_long(flag.encode()))[2:]</span><br><span class="line">Key1,Key2 = genKey(len(FLAG))</span><br><span class="line">Ciper = encrypt(FLAG,Key1)</span><br><span class="line">save(Ciper,Key2)</span><br></pre></td></tr></table></figure>

<p>由于没有附件，只能自己一通分析，然后对照Wp给的数据</p>
<p>首先注意到这个$key1$是个超递减的序列，而且乘数$A$非常小。</p>
<h4 id="如何求A"><a href="#如何求A" class="headerlink" title="如何求A"></a>如何求A</h4><p>我们可以通过序列中两个最小值求$gcd$来获得$A$</p>
<p>因为$A$和序列中两个最小值相乘的结果很有可能小于$B$</p>
<p>如此一来我们就获得了$A$</p>
<h4 id="如何求B"><a href="#如何求B" class="headerlink" title="如何求B"></a>如何求B</h4><p>我们先假设最小的是$a_0$，$a_0到a_n依次增大$</p>
<p>如果能找到两个数满足$a_{i+1}&lt;a_i$，这就说明从$a_i$到$a_{i+1}$存在一次模运算</p>
<p>$A \times a_{i+1}&#x3D;A \times 2a_i \mod B$</p>
<p>如此一来，是否有这个式子$B &#x3D; A(2a_i-a_{i+1})$</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a href="https://www.anquanke.com/post/id/206493#h3-11">DASCTF五月月赛 暨 BJDCTF 3rd 部分WP-安全客 - 安全资讯平台 (anquanke.com)</a></p>
<h2 id="背包问题通解"><a href="#背包问题通解" class="headerlink" title="背包问题通解"></a>背包问题通解</h2><p>当密度$d &#x3D; \frac{len(M)}{log_2(max(M_i))}&lt;0.9408$时，LLL算法能通杀这类背包问题</p>
<p>我们构造格$\mathcal{L}$</p>
<p><img src="/../images/Lattice2/13.png"></p>
<p> 其中$S$是密文，$M_i$是公钥序列</p>
<p>这是一个$(n+1)×(n+1)$的矩阵</p>
<p>假设每一行为$V_i$，例如$V_1&#x3D;(1,0,…,M_1,0)$，不难理解$V_i$就是格$\mathcal{L}$的基</p>
<p>我们设明文序列为$x&#x3D;\begin{Bmatrix}x_1,x_2,\dots,x_n \end{Bmatrix}$，$x_i&#x3D;\begin{Bmatrix}0,1 \end{Bmatrix}$</p>
<p>很明显，对于线性组合$x_1V_1+x_2V_2+\dots+x_nV_n-V_{n+1}$必然在格点上面，因为$x_i$只能取$0$或$1$</p>
<p>则向量$\vec{t}&#x3D;x_1V_1+x_2V_2+\dots+x_nV_n-V_{n+1}$即$\overrightarrow{t} &#x3D; (x_1,x_2,\dots,x_n,0)$</p>
<p>而$||\vec{t}||&#x3D;1$,$det(\mathcal{L})&#x3D;S^{\frac{1}{n+1}}$</p>
<p>根据$Hermite$定理，$||\vec{t}||&lt;\sqrt{n+1}\times det(\mathcal{L})$</p>
<p>所以$\vec{t}$是格$\mathcal{L}$的最短向量，可以用LLL算法解决</p>
<p>理解不一定到位，大家可以翻看参考文章</p>
<p><strong>sage代码实现</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">M = []														#公钥序列</span><br><span class="line">S = 														#密文</span><br><span class="line"></span><br><span class="line">n = len(M)									</span><br><span class="line">Ge = Matrix.identity(n)										#创建n维的单位阵</span><br><span class="line">last_row = [0 for x in range(n)]					</span><br><span class="line">Ge_last_row = Matrix(ZZ, 1, len(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = M[:]									</span><br><span class="line">last_col.append(S)											#格最后一列为公钥序列加密文S</span><br><span class="line">Ge_last_col = Matrix(ZZ, len(last_col), 1, last_col)</span><br><span class="line"></span><br><span class="line">Ge = Ge.stack(Ge_last_row)									#在矩阵Ge下面添加一行</span><br><span class="line">Ge = Ge.augment(Ge_last_col)								#在矩阵Ge右边添加一列</span><br><span class="line"></span><br><span class="line">X = Ge.LLL()</span><br><span class="line">#print(X)</span><br><span class="line">for t in X:</span><br><span class="line">    tmp = t[:-1]</span><br><span class="line">    ans = [str(abs(k)) for k in tmp]</span><br><span class="line">    try:</span><br><span class="line">        flag = int(&#x27;&#x27;.join(ans), 2)</span><br><span class="line">        print(libnum.n2s(flag))</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">print(&#x27;0ver&#x27;)</span><br></pre></td></tr></table></figure>

<p><code>Ge_last_row = Matrix(ZZ, 1, len(last_row), last_row)</code>：这行代码的作用是创建一个矩阵对象 <code>M_last_row</code>，使用整数环（<code>ZZ</code>）作为矩阵的元素类型，矩阵的维度为1行和<code>last_row</code> 的长度，矩阵的行向量由 <code>last_row</code> 列表提供。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">M = []</span><br><span class="line">S = </span><br><span class="line"></span><br><span class="line">n = len(M)									</span><br><span class="line">Ge = Matrix.identity(n)</span><br><span class="line">last_row = [0 for x in range(n)]					</span><br><span class="line">Ge_last_row = Matrix(ZZ, 1, len(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = M[:]									</span><br><span class="line">last_col.append(S)	</span><br><span class="line">Ge_last_col = Matrix(ZZ, len(last_col), 1, last_col)</span><br><span class="line"></span><br><span class="line">Ge = Ge.stack(Ge_last_row)	</span><br><span class="line">Ge = Ge.augment(Ge_last_col)</span><br><span class="line"></span><br><span class="line">X = Ge.LLL()[0]</span><br><span class="line">print(X)</span><br></pre></td></tr></table></figure>

<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="MoeCTF2022——MiniMiniBackPack"><a href="#MoeCTF2022——MiniMiniBackPack" class="headerlink" title="MoeCTF2022——MiniMiniBackPack"></a>MoeCTF2022——MiniMiniBackPack</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">size</span>):</span><br><span class="line">    s = <span class="number">1000</span></span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">        a = random.randint(s + <span class="number">1</span>, <span class="number">2</span> * s)</span><br><span class="line">        <span class="keyword">assert</span> a &gt; <span class="built_in">sum</span>(key)</span><br><span class="line">        key.append(a)</span><br><span class="line">        s += a</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">L = <span class="built_in">len</span>(<span class="built_in">bin</span>(m)[<span class="number">2</span>:])</span><br><span class="line">key = gen_key(L)</span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):</span><br><span class="line">    c += key[i]**(m&amp;<span class="number">1</span>)</span><br><span class="line">    m &gt;&gt;= <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<p><code>gen_key</code>生成超递增序列。$c$由背包加密得来，题目把$c$和私钥都给了。</p>
<p>把$c$依次和序列中最大的值比较即可求解</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">key = [1928, 4648, 12352, 24010, 58760, 148406, 441469, 906294, 2347544, 4145527, 13246047, 33012060, 104677731, 233784625, 398671830, 1138569375, 3847891246, 7151230548, 17442630021, 46416620988, 118857237060, 363519789685, 661956375011, 1712300152639, 4761949150147, 8964540458636, 24746310311237, 62452210349278, 150016895989040, 453927852027278, 948923770773559, 3275343477577565, 5756783232753127, 13616706687879089, 26402320025439836, 91814578040763059, 211796919962932717, 385545413311588646, 742071895214889791, 2137385737378343660, 5820500440463297078, 15401185997444609852, 49206779920875282228, 101148479344021765606, 205390946600728256099, 593695571211967641654, 1163476540184124239753, 3920275177926640702128, 11188401781366603668803, 26452211702098700985776, 56612547941955968739356, 176511950177344415872304, 350456159524844834233165, 932655004294881661656249, 3077731648705646793828507, 9127653332576335535543235, 14107124912327219069005253, 53639235705342264540097281, 139903414487199921597126219, 377113327325865137005647964, 797007439689940464465071770, 2456373221352926158802602905, 4997725491122440484756502995, 17601885978368777637676626066, 27945705300453872028061217316, 70259455336271034962808380541, 241339934663279791843376677893, 565927167417896365819102921696, 1498269591024734505946670540129, 4476165672138335294342834148717, 8246962867693878472370951037335, 29609522845816295639745215494800, 71952214344473760246502727717474, 169361817288205588754741757159731, 390045301314759178244461824288458, 1337540279161737220902909199776611, 3221480198479784802709388960779700, 9670513515504338974817616478456700, 16261746247432868145400788404115430, 53594268392537203440232335914792279, 142627442102890550431018293710429426, 249683635647920776857130562696997561, 689878480570146636843962995034183967, 1647889244922264517646376201060969417, 4362391204795633804803911898013660682, 11983025462449787764688227594361812707, 19474005190319410527122673327870913310, 40950423948271412394664153066384954054, 139255978428478610787399242087880835737, 382133188700471370531564036246745271608, 618340037056166043673108074267387394368, 1728641328632513907826054966389623526131, 4246454964077064700888723109771772689322, 7526932088676669848792644586429545161503, 14761773428394206759829134632198244970685, 42336665776969730227150513015344171877811, 73191053942159553542196382411683917861300, 211549032502894704558541919050681697675397, 554709644259380577558971870420849574372151, 1251152425154260246544953154540513290303621, 2818798972367329802956936052623797403793942, 7638358444068983298092603686815486790113890, 24695143882440275994689721479314417528417480, 45729327569890326278523663568847218262894959, 129925286147414817076637512089880305727457533, 357058960265822950281886346091988882031910760, 870811282376277097902073516532006850342152858, 2399129617319427629796691807338852665469337085, 7522497498897836117435156411281203259743818186, 17703808279261898891912155690137638994014567408, 39174398341780347981624886777838524967209728446, 71626422074785376430650030090797947505033373583, 189453667691364649027951065496599754814571374684, 437295033677960022667168340703719574179513440159, 1105022320374390979035499970036715293235993540826, 2482140894382786914874701298953446381142900730227, 7941406921570365260066022237661009338911386179194, 13688077798315662160188528865690475378175919829521, 40118424472696130315297350323559766967889857978364, 105189379969045772302352882060687514329245824860122, 199293659238948607716187263853532082285127398693261, 499536111913922039437392654679505181047127518386152, 1265716378918935998920835568757397506132677689873802, 4251975766094131691018482661130820129953060977929504, 11152957210935036994690757763894857926461579995709364, 29243034751011001056721898400833781278921232465896703, 83127804731558215656517415813913013712630964732885793, 197287313991484123623412111326147421339126168589781103, 580348074469542880297800575176456597744257638809118170, 952848219059546044449261356813174361415872857630315510, 2114745453546299027601967135831843941629758587200332803, 6732303576367127091793491258707612535996916865106486930, 17969751578033370972927234837249484835783104974373526668, 50353964851880252824761483078317672020552394668185625845, 114792749147200000567884552573247130055515068451479473326, 344881289580954366545252182642967036273037618565165401985, 1028830458186445450162354520820201527695218769577051320473, 2074905233540761021629273629118215092544205899770047449244, 6827824489946353955926387525605200460781082737913381690336, 13024891552715019198360589788142658101822141014082307429749, 25961005268769363699702206141880105110265708699262059458918, 75403822308341240881775753922079349096463802345797378834029, 237384123451169596772029918832412849807327730438354057322622, 712646240930595428776240903619042913605109976371239636231758, 1858677703618066892165605509033944664007520745899837556768895, 4139395606166311238767981220233801698454319610253778363314838, 11051661045091733320416016319660914967058929654228453865287281, 29811585925705783247773137027702029276636378622129036803066195, 90685056735716951430085719312184849024248295771954003433442472, 157500945846011120649342030924242308092488581060888955520117740, 372901626023221848769914983494185928870895559258054416488096811, 768231028240804910809905945806694160784354754863882766743917789, 2779285901235347349512412519384436770411460171816095983145397440, 6374104945628711471675855561257403169698347988699930709009388571, 15606620797895735826222569176215400049549335070727802852935792508, 36407286542538484153926148252126040596266900628856973721204544487, 124345134443495254231144676818478910782759198180390061540449975329, 247113740493284619019931820393865652802499920117478290621711932786, 546250851448819627474782890078865878619982888424175090054606739349, 1708592433038733956978819431107564666115535756847903016488985258178, 3469784692808773680977989909012383598601318450115335667599446101916, 10923256812598128494335226092601900716551326610194937277684839542369, 21012491338240214838754959441277560200420746284908398093641375760080, 60889459302270258776558311240916612146241213106331686794170240374762, 163976015330661921425351604828688078789049035481531041973974028089785, 289037863251569623683823097040957275672420698243074506420157297827331, 757077203699594125515581476518783513279367742304415416466493229482750, 2419895647396662523171144180707701121877346566438572088091207837906226, 7355085337963583789485765997525070376210546183075717620390510384848601, 15051216064674860618341980616144084279926804604562228123313569479773613, 27941489504573067317849352242679271094163397351402254909630669501407776, 101620497919142332166787423172023060084593540312322612628746436809445674, 226881723516906947900548874100926330355595061853588440070446478001634192, 436083549067326238210237926429619818583468595956103126733614121273925302, 1114300762650958326100809843235006795980444078921364112608090634574957344, 2067630703150668695099956606446000647289440828791043320265352802856027353, 6184858091099126482135322120120464262653454412363734887325664168742191917, 20198724557091875844715800016163838909724718285368458520056089111628596330, 31016012035612935043240048944310566375654982913771972602093586083253422398, 120517928868495613278649932692310155587627278645665690072538147101563551766, 189853493819940791022006359464978248211780374156959402302888328075135559122, 709261139869078187523368280811328692680117587337216655356117972203528916551, 1494450926662311226674274795483402016068321469408932952124223720040234068030, 4833201522454078687541173754025375255160393643329610440001807389162022858137, 13065426763007211443646416727098859879614516619696845038342383829309179073982, 31498041121702214861734489217437935540479379421202405303460486717862084301294, 59291071262486212405215961522173655254987660557013973769285757104149711757459, 137325620971003240316895273046089454057536316983680621619104742603734626157973, 322033994335205758184753941417891767592538862759074152575171260357782006734442, 820082783566832754339608163235147685713597507674476057203654315048011026367219, 2282651344288337092906883083740075053173109353137863831730238422975306417325757, 5445119536937019732153059574137765564679350539463171899410036275958492350218676, 15640432491440562916581632653853505713511238255286321934711250830601955403677071, 41106883032429969859399906487019322357415120653637758039703350990320596875155176, 103754830954744065029443848605781937050053754534445990149281507972325774765844876, 234666834709268927734887936099822319961738129376455664521947726208265410000264742, 796501101363737180381507228150305361162624877853273443755457607681031102231623307, 1624552917282803716066319956956102765638808948119862597393339135995911391379123522, 4643272637840339310515026952678388354699825180379372281574901801196876030063101974, 12698618143562269391895747140398377495554004174836256597996901873500325652914287227, 35723733467261031422647885542793080310475947027099953899906182407397300154268828906, 66579759042299327879621766658030061118334921216187867761491910504181344451238684350, 239558348723378720363003224968080360385965369779814655734270075126998161979921905000, 674426340811237207208953232785934391016215462902095720638324651170969997400637801355, 1698823780061918718547756106555041994312203433347013142428193591099315938666752495147, 3485698669992831956608280816819201625859973318902236645999324294867314338271763576226, 11913442231481393917536601792582866930393303587594985248503741285895455503031416467367, 23070531945625150855016941245865388154950147453856685413887739256847410892916751249842, 63062109298026246794043518591814177894498277952179449322185515920851203385563000039545, 201500456854818387020432137947274011145636992031847792130877996231861744196691929847748, 386293027342088096708767070123592359264038177654678967794307420131436089009234887958085, 962652147623483170628478119235555226505070396879489339105090935822447174750045231232478, 3035935960793431917350036879195567655285637476975406683996240225461808984868014791791433, 6208746117115824715018162711918248788514776556569667609833722045497831346028332955531410, 11762322147658744239353552479176647603950873433079903790516674882105043434830328826675415, 22679200582127225664793559521091332878355319644677462980823198911465583443269858630893253, 73929710933006149888049977928677968518055319247626886667227984506656971966999436923186972, 122524349818395517581134493004049791722607446965559017459380345881157453828660236992049404, 412926833511789222428174650284405691872834629858851326844087117202853421601692502254318141, 1029385129423499530322969843276842783066057615497035785381633948646265964471244991407283657, 2374019900827890887681448469648598056064267661046120767421848772396302513783495423644064007, 7129046282305997419886465925038724574815350866486395082327924571694995543004421437396685163, 15553684426659575255143733092646126163883808844830770798803864550707886694317293166976752540, 36868510946091898479948303208447807989049331965479662439764899809218618486185846045349542501, 92245655628350120221629636214996850938258802134676165059052497372214318974743615511153118145, 186463470334970062582820387784350511557982560369498424617823476509363037536450250866616200018, 572967521502291777355369990006837729815084981232789335148124013079835565379339449250907380488, 1481745249132912511970258586968019679134485717661841452421417313959912906838055641721186578588, 3465571259266031075485176569236690543411907657240139447438094553546637617425088900258756309108, 8435925081032968505659480326132770316717891729208893135134645312992136104713045209348571379936, 20315655322325100095226141940419414017723560946817780337100296517956534785685937181001107745352, 43069115966613244938070771746304575880400024938295357246717079316564326270692925649165248799853, 154233412749662382894550506472683312102297703424057840129476320316144010040200771168572376219849, 352877164586305833533208196782157198192758667776588081344657867110512140773408077435261431699405, 731939874265903145518316019567169287035472945759023530855697163432627661288949769619402453516834, 2189452024672949178210645600969378516255080271308334836448144354429705327344143994347331957449853, 3896543605375761834186485166037278157701213968430616464967138263870727947226180820650265115757354, 9136364061744114854751740581900554472617621867814569413142650998411332183920873701211555172374338, 31182169589957210510416755511542482029989997938097777712995732237583051643250531461221140115798313, 76737932310662322563271317876920472434982416417386459109415811734811165935978744596464401289256365, 191657687539432627521287232027340814340762593718642860136243059179657356411665753239917046107562015, 530361069831754440835688500919172905456422674539149906219439563860239029311496751350136915275150864, 1387792997020024308183922178096461451972294935906886419345639014544739179094711431002567439046777688, 2286383934503119795216122706571707851067263586234080042542833733216757155431244141022301236049602882, 5217435832596475959525740735112831333306893965389666926215938837589313774349496690036610287629333005, 13857335145208908258169891019385567845284268412333112678215001155302498425490658878264656236992134935, 40163901018471004896425196956916864061977023091787666532481831101052032374062940939516719648018676594, 82892214529323438899501402117098988403652889186148588453800977258361448264060748670322604495661134167, 178956544188555415155972101504345380390695957167910254018903325710948594375512551321503428603501757891, 563888574268395325287659273510106617675959539240732287901035847602904779682730930207201257182213858543, 1616044303623257921514683914498983737627603891472634935907943748930280908786049272784565904600012939098, 2891229181345915888829785513242002484495784340354174828728993457272687483459059048534538302181816688976, 10207730272860940549823879515425309207636840459300447491903147067853625202918689426829904372421061677895, 17526621515916394607402562632381069779604072768221581075247386337947979364802058499395942689207299830365, 55864742839796343168209200305202648507682753148596246337408494037308856790224259497580631081634646188041, 165332196033938201434627346583990806851682965862702414330472648748014088812475559273855488926778988149883, 494729626554411141427744566730794748483202977845760867859438479405205853778032755546761473203576297889449, 773241724058457908926664671814549280391747757602041708672622636112281590651589333985868232639345426359863, 2643090721830219937871980242863893762864524580138013585975903383984399727700467749841537295988160882592554, 7602742125929529736410459828760559621377824926000865839917497433361558637433229365703421216832254559844712, 20298012813427893859751095024917906619591438637592000480476880613738608994530228331797315397345124353458048, 57138113294488937158388285440237932686091901290656714986248760196665994518443306993120321953623611701468826, 156180826248086652580528603931836069088833849466705801833826561589537926864487694377480227882717998855358198, 405091254840842081029125739284610173825182926000756067214428354197290398676973286834323853061720032954965963, 778366116109730017138034746329928058267161795656720444904686750506814152375884477590166274857108289313593118, 1796005150394618766778725965351985496132876507371048438760920669904977557456986675227521156526604287512648264, 3898444018773054695814825596014017751795964177961572987153324103751602074848254485225397417397654262390321944, 10703462078231223004197739814155717950000211259146027443753796966491790618726938276000128782966812980398530204, 18372321975824831177753464245580317968933119357879255869022769977852558056854497414886761863892673585456643891, 48317491803925955550053615386786484989034506042840366819980397407568791721238179125455458641299301269848666510, 158255568588301663954187011445643163738485858122034088577201324726783893231449209827193255340005164973552974453, 456823552578369748946561710072366945172148623875999657195033140013027572670231347304984109456384691884394301596, 707160118481884894551388234729179730915972581073118662214623842056893684770640844231508665861861467073743805665, 2706927376520605764276007802932993151885010075033345167172586198244735154579188535970342536626727165782495180134, 5524495123704893916572931697399108221354633312984253879509446961783982258828184219735409076305664075360213376822, 11902801828947547843316856179728603283371324186706149334180029898787026360919748804787239985463725865632928552507, 42817758358028425898228144386760814695029076486689089958556088081002352872886441780712721026897632438300836110665, 85341298053933033277929612803230545434450389443924565926372394273668666803233325131592974981823970679666528469082, 203545487666526735282497187348232067937848828434866343193810463204944901878674073018178572958556722616056919932826, 404490991972927610287798222030298357859147323959244483279529298622268125169109324278915340735214314234862449055448, 1015889532249910731454157235904076803563143859066636167138222193683905683535906365566683356226160720652109370999321, 2376026683785110886914732723263521678018967831673326233555377196140833492114241003132626058539164015299593970425136, 6462912523501528306439979574464826777892245783057732634021629306276087967421373795532316029843905278328516884883058, 16981441701453104471733297233747957918575727289870879189918428405182537334140409929337675754279869961515500536636176, 37605582989982272328044312175947277729400907856460324692248887357599456103017970584086153023793040540391945445989257, 91747039052675678105959960961981861389020215173307703983752122608163760292472703277085998681706298344337891404847646, 197976695213061406953734629818998754281337862490966315225432914015679415715157795368611025598068494075696354180224057, 407579734020903728451591407903624856111929215373480871243621182164970838186438777218257932637652562832905518769398262, 1192695842629740666007709455549699909835266353292608841275812622248241416280954865990629770667881078271433918923422731, 2356450454926316659685731978750584215969826513728852376452662114206102092287531644004469937748823746129670826796883901, 6606194810680818911726753398369719656427756109429906495763748359459974583720214056977960616895121295259675484772228900, 21238856384108665139068993634246013308212000660518883089302921531246892139968871926076965355331061987385136533519279525, 60431698017667972588320134967121949330864812114211557015977441929363675768812209839204671181454067749535515855713156763, 174665868422753780275604141699079697885219220210916384980421958910804651659162534153721798589901082858559767609552079345, 394230935137659132182806278870718863867754651145064639278806591391259891710009233085853984826856234290081395609225890238, 938316178783979725028510016300351906317832877618969965871296642973988528249289624189564279188734089982984293864940639663, 1690300816950917856165481180579373059665398098127346945618427499442023814975741786872721941536175836912500050716899314350, 4241040212750921734662543578806315663721700243000974307468609317605794291246764526126048318503818177838783905309400289117, 9899615703109749398438558898664002269482804539466079984631091253252047080143600618559486614511675282173378128689947106499, 19072918764217687057379877185516040357999863490449836492311841376572022870447983721729056895047026984202403660270528351362, 61457030295636043956746238914591148777316757448303861396901131680368800892725607851722251866187547310356464672462006792936, 130554685050076234706409249768453974245979757597714789262984612467812333642313018653001831006709360179701213479970689476759, 317707441009141362433020809851971219097475768762476580041791647909345575364794752462683617015215387354639266789655705355159, 766407353781281024676870262720057676902122989643223864583232810528888853102644816087185770633710024110065414129660560848818, 1378158372668635043591303404733183053913783647791091758022520799715774445178343987469574552089574912051263356050601448829569, 2849814783153826557775488037652012659704609417837692209372285071574038848736100379264094051217084360358380745456795092662367, 7761768442678261726960193678894950205212069061687767898603990098871593859918952089239031086652597614705182760193814143657094, 25797856998139398890116390239859835084629679432044893266362900315705828350899796936954893678013444560821963770721738841492762, 45230528787260219469707111504991583088449246785732739036848497764369166856369435663350796527642874763730890628636593210838634, 125595007654406839330037705158661517651788635482067500225344073216015649944944879970130124750959631685921435054581613709164822, 338747508849935686599681561847193572302329804892368313208731993174039023400358858978202514407262943107662339259004212857955666, 927842701337787263386928773903441275979399427379662460065544246411463087320044839262987027337743305220579800532826965270689250, 1974283905173053393614664395812743602970084360210384412934832566684934360366297764438728189449912704403685566054487439810857627, 6547791381850377804871914819409383329722364771877581519586671693693630274474320389311984387956647850854999536112540018330183809, 15709320907036538202306551117984227990557852089499582468594623629463507925701405510011304643762744267804282547349971254508845938, 40270138688478461945314017148044972001708543125646521974155404640273555509873235113536988809551924038925428913961013964565197607, 99168179703900580858922903603323807687115252977021819828415602208147447841271397891925410158445036111494543958823713690209285369, 269868178430265744761277563499719925184037917272176039027995896214226177897366881562687640385414521231482816048831046030643750903, 831659192392583336646613887566957000280656975320208034953861277421104038936580189145699653541798336705409469145595542460062434471, 2073476643694212471632333653958562004434818366225131771845046659755589302151344899589183197864077374128293181680576229954100550419, 4554149306780266313933686119966338774145476827044906188542821462680791576860383095025724314895890630857897398967476576259995321191, 14651118307465336327922062019691151414683570292038775511915021602908118951591926995520466221396947959539039452124967851254379010308, 32590352694473324794187157416677986187287003972605121693147144070229453983956761041980924463747749024664597601177994952136065984811, 81134631049823241301269776481475653931802229294857541846620286653857647735078830230944498091871440739749676625155855958593920070814, 185677119342066492911752180414903294080590111905381979357926969960006994207482364686831869137669282514024709390338951171955152686319, 611640161419871188028819133410469586343996954403636969815202842657504592966769167857498786484339404586484056783483882604337795700345, 1665805557476802274778809527131744615949426833045219219448282924298718975882034660815478936907356513550130652021165488275923832785881]</span><br><span class="line">c = 2396891354790728703114360139080949406724802115971958909288237002299944566663978116795388053104330363637753770349706301118152757502162</span><br><span class="line"></span><br><span class="line">m = &#x27;&#x27;</span><br><span class="line">for i in reversed(key):</span><br><span class="line">    if c &gt; i:</span><br><span class="line">        m += &#x27;1&#x27;</span><br><span class="line">        c -= i</span><br><span class="line">    else:</span><br><span class="line">        m += &#x27;0&#x27;</span><br><span class="line">        c -= 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(int(m,2))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

<p>笔者对这道题进行稍微修改发现，有的序列(数据比较多，可能会导致序列中的数据有一些奇妙的关系)经过LLL算法规划后得到的数据有0，1以外的数据。</p>
<h2 id="MoeCTF2022——knapsack"><a href="#MoeCTF2022——knapsack" class="headerlink" title="MoeCTF2022——knapsack"></a>MoeCTF2022——knapsack</h2><p>题目</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long,long_to_bytes,GCD,inverse</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bitlength</span>(<span class="params">n</span>):<span class="comment">#判断消息长度</span></span><br><span class="line">	length=<span class="built_in">len</span>(<span class="built_in">bin</span>(bytes_to_long(n))[<span class="number">2</span>:])</span><br><span class="line">	<span class="keyword">return</span> length</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">makeKey</span>(<span class="params">n</span>):<span class="comment">#生成超递增序列，得到私钥、公钥</span></span><br><span class="line">	length=<span class="built_in">len</span>(n)</span><br><span class="line">	privKey = [randint(<span class="number">1</span>, <span class="number">65536</span>**length)]</span><br><span class="line">	<span class="built_in">sum</span> = privKey[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, length):</span><br><span class="line">		privKey.append(randint(<span class="built_in">sum</span>*<span class="number">255</span> + <span class="number">1</span>, <span class="number">65536</span>**(length + i)))</span><br><span class="line">		<span class="built_in">sum</span> += privKey[i]</span><br><span class="line">	q = <span class="number">255</span>*randint(privKey[length-<span class="number">1</span>] + <span class="number">1</span>, <span class="number">2</span>*privKey[length-<span class="number">1</span>])</span><br><span class="line">	r = randint(<span class="number">1</span>, q)</span><br><span class="line">	<span class="keyword">while</span> GCD(r, q) != <span class="number">1</span>:</span><br><span class="line">		r = randint(<span class="number">1</span>, q)</span><br><span class="line">	pubKey = [ r*w % q <span class="keyword">for</span> w <span class="keyword">in</span> privKey ]<span class="comment">#将超递增序列变为非超递增序列，作为公钥</span></span><br><span class="line">	<span class="keyword">return</span> privKey, q, r, pubKey</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, pubKey</span>):<span class="comment">#用公钥加密消息</span></span><br><span class="line">	cipher = <span class="number">0</span></span><br><span class="line">	i = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> bit <span class="keyword">in</span> msg:</span><br><span class="line">		cipher += bit*pubKey[i]</span><br><span class="line">		i += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher, privKey, q, r</span>):<span class="comment">#用私钥求得超递增序列并解密</span></span><br><span class="line">	d = inverse(r, q)</span><br><span class="line">	msg = cipher*d % q</span><br><span class="line">	res = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	n = <span class="built_in">len</span>(privKey)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">		temp=<span class="number">0</span></span><br><span class="line">		<span class="keyword">if</span> msg &gt;= privKey[i]:</span><br><span class="line">			<span class="keyword">while</span> msg &gt;= privKey[i]:</span><br><span class="line">				temp=temp+<span class="number">1</span></span><br><span class="line">				msg -= privKey[i]</span><br><span class="line">			res =  <span class="built_in">bytes</span>([temp]) + res</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			res =  <span class="built_in">bytes</span>([<span class="number">0</span>]) + res </span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">privKey, q, r, pubKey=makeKey(flag)</span><br><span class="line">cipher=encrypt(flag,pubKey)</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;pubKey.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(pubKey))</span><br><span class="line">f.close()</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;cipher.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="built_in">str</span>(cipher))</span><br><span class="line">f.close()</span><br><span class="line"><span class="built_in">print</span>(decrypt(encrypt(flag,pubKey),privKey,q,r))</span><br><span class="line"><span class="keyword">assert</span> decrypt(encrypt(flag,pubKey),privKey,q,r)==flag</span><br></pre></td></tr></table></figure>

<p>题目已经很贴心给了注释</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">M = [<span class="number">8639902583677674310880931793028177280541434011292290504202065853840987502967193292082744312615700434593144813157877283996511132107220470301049233647133408049028266415548603044821875100911736779016733764651538561081471760073024901013269329030282540268057926893298880605006783804814169640893918174416684396473085843437738560093104518378524427428449369031845530695254533729875357632791209728472396631069254545688073527219830</span>, <span class="number">16412795671399200780410369416718200126247920664621109172347415680005387903489020995450209711828570735415943889363228088231729204296365628434015660102046415392160980472272559259705186844881452797719608700810640858964540124307963570631307965212179112567625375169247224532541645290209536697657292517320097861498807160219866672156203488965096062697707956833540149569006121676793811420684019155246005879602727894940460106460425</span>, <span class="number">1002483078449652086908127901165742700721575695431977944228135611564705696962544084765706920800603400348407970043674673111909948831677555786509139726134228930151292393556003965787320346201469741608940033259208434513230462286500445047749412928990508135782414968218031136356601029216877376563453734566125800306022631214791796995657970239075130824719419551039046131552320134110768030600558391775291997167887552475043961982479</span>, <span class="number">2238951719129102684908508004589371017508128103247447515477314623396874326632900138922634752384371309915247686376088188378411136513128697780426310438781294619639028237392912133929126286576611773410531662546965371159839695457500259703379712133530424987700108668317058486891872074268472615506849525949557819649248663298510166491366824248526632970988729421252090737838283604158996925358054184183912031175441649168801364477497</span>, <span class="number">5634843816732445026126467098373466021485769627903521660842347695720253281030482413552009914416263510962518645905534351024856098851613741584157560289954680322367708989388356896291579138242423737071936969416183795417059233168737593374557100712180960324956368186029307481493787661489262846069411165605826200576757012590288649575515313112890878467873797655979953750167348022896037285417957167761342222784479775154484055454300</span>, <span class="number">9186610770346409723100374171388664935178707704940676612563986340255427150913228007547473624373722376412452006509593871272640178049654772086095028603022475485769195013987324300619058730137213629241547292874688026607272301254060765768412491266856867815505612614998943264567979641302858974943094758843838673682824294909500855339786155131092900834359374160001259207411314769180927212657053081774058447428598226306560920557103</span>, <span class="number">20086923313584400496691602764043099251746628122644779399842432220366854165950153096939613947370676658491693142658541069764999486380151371297168776865169982649753241182524436613459151210953276528861607793419032177588079933942873702274888793149133043040881921816738144320494857431431348403935934220691400258374550028362585563810770890511960106477474196749665991783492371663595335417853709562030925255330540927197410589197346</span>, <span class="number">16344638306391326377686133680466529244247158645077173788183670515669569922257628136592428719458630174158247262608062501473710159252996556402841773688479781261071952868217032789112171578864311013133034166125522508960509753908661140291243310989744814838516658654858087285501428760026897645388510723360904014743591560741892432193065079183777716928931428528657537811530112798506687040813493577134938597056885544404165334440417</span>, <span class="number">2612829152363810360381140114448267548309487113451765642875771138774557011657898432249330366979748000196797448616557121603054240633550483300886876115997009072175661113374511516053173148943538562172144361976376460500609759755722891157667525246977951372954709581129289399522608993482768996162810200357621658110354562179066558050350148834136898974813148680250028733112017355078329753267780915289394014243208598474729032384564</span>, <span class="number">19064240755529577125292283074595989361230925740751604828791433834485710855856801533155956923513647433086102471927289219051556692578080054437968339223710189223092053257138547582773966036253443266822181812437558595870339679800887565183836282812813501470568462858382546100456455622835475204306486289729917538078517665215080886364990781487301918217104266484901312499340347150623781762028474648151175735340611348792151618766861</span>, <span class="number">3702565937757268048976391733125277066442618380743768416638899741455818391864276934809663789147326816784849214974228391513975011092043466189181524135072744668991818700123641118048186561731463987428008289526424894229838318750539451785156527758792285754054388512341416769819020768917817009268720412709209493639300206208469077070001276757631341988430056132551557700579907926834862070107929804804811568088452140366936341777345</span>, <span class="number">11502581665457615587254363930374727534860957412318365767186339391962456747857398825121846821211261108113447361990519412493867120624842707484788658261017505214188933491782380457717248447441244784000616729072274616859314952832500266181433915883265604874701734571473682998617103861022495595430816700108408197717973513190148901952092370293707843130828467727037293783684148539875615050978469354573967054299566840777623355696582</span>, <span class="number">10073083484226771776559359501269382896512475376861352563707048944846887937508361476948371289888897049589767849211355238137412974054578287303103882003280146530845186837491695691790335230428734898979480016209102240902149523701595231852831084035640546876424433409207622149923419358639246084622889479686948602188084403074936426671633324202401473825907348902812619313043234644293320117923314933945154795101196969895143521199483</span>, <span class="number">18992409093137046378732842744306503603860785524225852139724096390190053840935906726926035874997131679911084133508187235324077341016070148447808448470772128318056137717495126904574038547394615807743718419710808943840981025768473805273816544440631835254252102209159686821504850348775772310988837820388009691813555637320221225893184839014117064201469792554472415820296766165441072313200265279873167507641917097468147741179316</span>, <span class="number">12008203894395308866804419286918131211163695386800382803649167279012655799569753801988115828424417187344919188165247175430808022391086771474851545255339167112615263516693822036949280138705995693945006477452686019283850377188419366812168825267599287239756656176060444742334708935226087327402356564944368424241454091730626764098428899236088185072241508877992009374541429500266147060644167717198271648252572069852366770066941</span>, <span class="number">4038832885441543178685778998777010366178385846540652554740976864087276470059402915973964964623701441198410064422128360212066090056314261540125817743157487504771683739028804039509503547125770628097134761153720275162291365442343531369529592717402946253265532741567152583164953954964898610320442871432658088455178094417777512351495473972183676615716829056159421852585171139955117355872271110823592402383029525931751267792629</span>, <span class="number">19670194103573995335546778884365243181264524353822662897934014963532181109426494031783122562547168306646340318701174006591358124967291240381472860805618047808677531825042365670594937665873102378022268329092094697067984029740301822623602184731823873558795434660094128877563657141012814479754588351209580370149201870079338556937517586419874603443731575388938047952534772975732556105736933783615623583780757885995121940503338</span>, <span class="number">448587250547880364312998824100142781832002491807797554233277109625321555526950425023215743109760909527612986436313497543133603769113094218925472945334223939771684911674114594383329812680099071618542069490401164113149299269806494788678936049434267166672312670105320059285800764845917405038243022972683567686862055442132133699091060023879225704166728623235301057086116134392930454897470872517830183804157659700625445889830</span>, <span class="number">10930161231241723347656392354185186093279947414736961273749133046917264525983266922573827501912949183911557744485967859327719400057117437345731516339396700486673896394578991271601789139805337761538463364911028532947314087595485794633342964066494181066852782300122468958298766435768883484054954993425768743684068334128908076033268101822190508581559994522635605495674677985961570352022867982948658497701704571958572471959037</span>, <span class="number">8912625957861947176692856854564685913647250060559881612290601882706188054788510505473405766899729572895845562443591906130010557402952386484482517393552180643811875543260186615419673392566496124447912269542460226666482647910551668827648093182498966897648613164572222270243359702963101177490336287533554365928047224202986800381789195759761436787301775857956490336462761874360038594427862527456596260884381704781454223633779</span>, <span class="number">2306551289216069191130454513919221829895901755421732012054334929893242554080663470365833623647910595823559794161380381203244457273338204281828065815403836409342993408047475650247775548054870518506855112285782988053629107469383261669351486184529190835182475578503456288807168306057143062378581633799682759776120760924076418979302287358897599267369532373529226015751378954828919709070562305354324298101375251784620884529050</span>, <span class="number">4255339440978927655211913099708439239541744749715858205450532296135993491711072531673546488130525220452788120740747243665720666392815530093014478271039742032112194171931906319993753445172382189426854066713529003995100528854075591430543823563496149091625019122021620407298536429119275536878732816760877148779834810333996516623906435500182034146675214175983106767418866525349482073016790959017939121229158782423051437153215</span>, <span class="number">9873893139520117327959006627839041532640596084122498183275311439807583416537326867898240112497398037831103133225780536794667751621338906594306093907094491162973280124466357134326208711961138712559043474881854410281347249860558412201637927695809309506382983697195652836773807770471078146063769391274295604089026631661057995193996447578694999955394342030970191038699379802329038272700169720344712485611198818958034826301237</span>, <span class="number">4765089917604817672113377465925141955529222421516223531063923657154702433478270434880545390917216534893263025759911541042026110573924335888049100333952299835341171480017258706209901577677469866704411013270064823075970967687971507570610839591584275076452847872481076324238205066797040752210320592563122318631044755701635637739646416025765614160810641418286841779812770371444583299208365194975180768006212895673072116522386</span>, <span class="number">6112224947687945480280239711320637787918908433138683424770734756570826229243307796646495301320885785370269249822669591195293264920047304899609677414526321546201923169183273630074677571673196655278790073365810828842079110549121344560176457524241399552011885247148188807289668163473493287160336470378903648449586092642655607573691920693404111756416187219108551575656506522734845257486376035264495521946081148938719828033544</span>, <span class="number">195388411930456292659004793034783822168552894119815825793239515251988057168890947473241809393054966668062312553975721264016843250888334146134794233076452609281861146295329070151936139818953601652277333969475084082043879066015009690415217938561659533862830515140741722462773302261048996453107340978194386484615281173964478851257661832707168812221430391245333553374969697275213417090199524308016415986232808953337791233555</span>, <span class="number">1244720792234771369080092658020249943250558558858543228087410218998345534662117779763183654722069027909843499722901164419943926229796467885376166352837320116084647482129514330031374427777713274658505472735592998618829380710477875259621314494025610959270630909513767438377166574595122721020642680480636508393782145457915510494406492704624711370382819548311152206515088909451187140041316879980487624305109667331613444702397</span>, <span class="number">17420521136158610155456592286731848541982479314642855401677490675166753515234198487007423812022874870146225072931804869494964153944097179858754058711975536064958198128181259089930184414024073207404745484941865020376185583612084575830698697473861393413223317543665696780708006419160734997175211056844409117770896148029948413413830070992404759100435183372428243532877202421584255843340950511372816896926816072148853459897597</span>, <span class="number">706903708472011058848699822306335654841601117402541259992980291382595513869156934281756720925440180372041334909766487263157124536984532709278378467802794655209393786719712770166975275570907988257884089016583036566222245762906544594817287350363157701978129672388011595734906479201562800232080436561292648589995413689187423799267922779667354879432847963481081819133273312642100271608294867632390722051556035070483171016618</span>, <span class="number">13588117928036525396131036929216722140727623626773457297456804642287761920269285941755714752389926502053635244735082938908723844163590227890370507021161665584070634134943166185409041414310104540858882424783436357851264149321701932666540464732095496709151056094385506784810633450577104530541976191745761226361392054647950122452702677055536328206478865891505902190711023934956429659436170984452323755148142827783946983689170</span>, <span class="number">13035612161448099569620637080527976769991099967659035134135726157510271293484224205316460392491491142810512547489719500384339641597134042306613279002050232752593558311676343579221779534892019944116141753798217189420843176613961166129335180457416469246554334190776482345258322812060613256769751208473952032112714346919765236132411088975889482598477817665407310561133545838921580753339246754910148949146829091161220277523800</span>, <span class="number">5061468190653798738267114315103277995240484866758940466674688031109170357205008555147400605884432466490013550324043153140916286904706720594942806466313925952519739861008671389738724448491617803723488014434597761423015360791986220671348427679576702646137192962379221866734759953356438405870464423279037434471697115717040170596343588013833231257338815360451128669119488799203334539631159855944659628348586189260831916846349</span>, <span class="number">310519211081224360436038529767369886079208063233638857045321280938913013264485831500988519083286823510448024911412774486006384354093058665586412478745091555621093880910291350060806527846380258780481452221805321697545098807534406639559969270790330318763674434212070131506363658570473180232691446781542261978745471405470147422634838558227017494138965139937056188221867200916092073501864711946128579149564779783995131812764</span>, <span class="number">7765454929386860718098457667571027065776365809087712130247806423210057380994819419379356255913567513855445325193098721224960552359712259673134202556374845746328084939006183410638772980553376342740123581295433206004604779839814416843588103144731533226288767681739309033321761816241055963854560413354103299523850186399263379947122808750960631330918177463573091711382789330104148605172305241880223088742424771925359262276961</span>, <span class="number">21279920209240501229319113350331584665790430778846094897524930483118106031814634260802903045495829850399437278182329574699963138929930179421992737117248479197193414157068700951767757037252093980620859984584071460503299890187279597588828028508209377280155232780973353085622102108867131114851476798667397114731024315266211677829660093151838411660005343321511262290101904600206044359113839043382769572874124915349587253828026</span>, <span class="number">9404384361847700092017917497360922914422495675694955197107944898045656929107075851201447292136561925215747086463268855004949841022671138446351748131867439799577663701934862965438385718226937668810306608404586652755516424859810792109427278538957262669803852485387086606698225561320268174451728686271748237597096162506211489602963953896833644360026423773017344347726848234574166701592970696201428964781400031197865618239089</span>, <span class="number">11473536515781570615295467590180776005414036990843757506218537332857260548916287699656257748679485492923976380438772031340714031903195664536413478729735501964060575660816573010818951724268030300190364858009842520160469005602716000106343559079229134105037981332746560515786853914884397058119553354501751785487490141582378799261378484951808914485153056302334467726453053631816737123137188339174736559611576619507335456442065</span>, <span class="number">6658209986765214576523603095408925684859819107411400320441704339845709232148546095393111386992961430272770760133826876144536472235021040569911199220002850001682157274254019940107808579210365324279421587725318046615758025182034807320964209281952211101801085038313213267840401921768361130482812244634047647201542664623820862660431801687169272410840936474148169852200351846151154823648248871251508145387214557197530965990966</span>, <span class="number">3662147743842078783350403504385983360536988791880409841594842856902008843747184249906408091065206792255852486983899949749040441757153766073770174862371596437255143770762330535544930819336506298143363720373654482508230603611719528450050592020391695607369389318359724713540160798965029351305356511671756157832414716675860595439627182073770194023818550160188620097391401855031574633727321506854349395990238905940067612856696</span>, <span class="number">7933293379259371913947753225829182973440327166821331624782742813667530306183685142511569661517697089303221887502895505020874247160719683710997562072608556098407772048528722269678632972762531765385931704290441640393166153819226767175593692496736619644331844236704817294952000150386014066539732697524646127418982668700056812006011572693231332529972933598812433064570022253850176804351568177341485541235602653505364414768080</span>, <span class="number">14070615118184600860551882213714094275919094443487489248696755809883503918195587018270172984608205938888536939875430264012942369576596527716679396096608215568698430682346516654899828724942187624877959402757540416078645260766852866647428645421972345262477895972147694258806702534022844164408377042363711608742060536759496086945857809612633396792905136739597255654549008843569173238058444402641970915726989105904551420858546</span>, <span class="number">15342946815132442226042116907050674991277073193801523392169239948932666433020608630679091801966034372511342999029292508497887755004306581018004584285609282795773152090001950867971092852778256889890353738132730167551173577706777310439847369540286505119147781133148801979251138693701919045904692041106260141920375686688488149802396671219316061485675475896415179620183729993314843987100325425615893137781286754296462178178342</span>, <span class="number">3740152297282187181815345820098735405456007044475540504111210108524926232502982744404912884880365972432141621724673777802787744807157725980349110691844313336431011685019041193074796249612246618677944456394104745372829079160559888495080142311688681340347875401650358392693131033779246448214818537452437421066622719432500713770985665015229700477055550680052280279789072242114276313112192777540668840785267601183144210396020</span>, <span class="number">10185332676507104923693600244914563536350322909616212746220121432434723035761182080872998830142207437310309114085510373952850103117757585120341980926754941337344093553857422551961676140723291586487782410700709958292644147040988012341985875728853255609738370894663167840784046951024718142033286281019071858182773531406479425092563184020268791578909132566309388794626911391615731256258486251046314500831039355225743436984975</span>]</span><br><span class="line">S = <span class="number">28856686525748125802152914172483571798453880654624111179873716369801238646447969551927508246737816822527579725991046201801262381722186539084044859241033407568422008911415092147086235301286167536726137372507078079415577358704181165698320539751269992479349480281465975374187246799267369957964807679383646749609694064517591097971225234359495013928292239934008888234863117359059334395043146949808360202225171337210959511092044766</span></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(M)</span><br><span class="line">Ge = Matrix.identity(n)</span><br><span class="line">last_row = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">Ge_last_row = Matrix(ZZ, <span class="number">1</span>, <span class="built_in">len</span>(last_row), last_row)</span><br><span class="line"></span><br><span class="line">last_col = M[:]</span><br><span class="line">last_col.append(S)</span><br><span class="line">Ge_last_col = Matrix(ZZ, <span class="built_in">len</span>(last_col), <span class="number">1</span>, last_col)</span><br><span class="line"></span><br><span class="line">Ge = Ge.stack(Ge_last_row)</span><br><span class="line">Ge = Ge.augment(Ge_last_col)</span><br><span class="line"></span><br><span class="line">X = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line">ans = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> X:</span><br><span class="line">    ans.append(<span class="built_in">abs</span>(i))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(ans))</span><br></pre></td></tr></table></figure>

<p>很典型的用LLL算法通杀背包密码</p>
<h2 id="MoeCTF2021——BBBBBBBackpack"><a href="#MoeCTF2021——BBBBBBBackpack" class="headerlink" title="MoeCTF2021——BBBBBBBackpack"></a>MoeCTF2021——BBBBBBBackpack</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import*</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">flag = xxxxx</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">backpack = [1]</span><br><span class="line">for i in range(160):</span><br><span class="line">    backpack = backpack + [random.randrange(backpack[-1]*2,backpack[-1]*4)]</span><br><span class="line">print(backpack)</span><br><span class="line"></span><br><span class="line">backpack = backpack[::-1]</span><br><span class="line">l_list = []</span><br><span class="line">for i in backpack:</span><br><span class="line">    l_list.append(m//i)</span><br><span class="line">    m = m % i </span><br><span class="line">print(l_list)</span><br><span class="line">print(m)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">[0, 0, 0, 0, 1, 1, 2, 2, 0, 0, 1, 1, 0, 2, 1, 0, 1, 2, 1, 1, 1, 2, 0, 0, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 2, 2, 0, 0, 2, 1, 0, 0, 1, 0, 1, 1, 1, 0, 2, 1, 3, 0, 2, 2, 0, 0, 2, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 2, 0, 0, 1, 0, 1, 3, 0, 2, 0, 0, 1, 1, 3, 1, 2, 2, 1, 0, 0, 0, 2, 1, 1, 0, 0, 0, 1, 0, 1, 2, 1, 0, 1, 2, 0, 1, 3, 1, 0, 2, 2, 0, 1, 0, 1, 2, 1, 2, 3, 1, 0, 2, 1, 1, 2, 1, 2, 1, 0, 2, 0, 2, 2, 2, 1, 2, 1, 1, 1, 2, 3, 0, 1, 1, 2, 0, 1, 0, 0, 2, 2, 3, 2, 1, 2, 1, 1, 1, 3, 1, 0]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>已知$L_i &#x3D; \frac{m}{s_i}$，$m’ &#x3D; m \mod s_i$</p>
<p>我们可以从中推断，当$L_i&#x3D;0$时，$m$是不变的，当$L_i &#x3D; 1,2,3$时，$m’ \equiv m \mod s_i \longrightarrow m’ &#x3D; m - x×s_i$</p>
<p>而且最后$\frac{m}{1} &#x3D; 0$，说明最后$m&#x3D;0$</p>
<p>把$s_i$和$L_i$相乘求和就能得到$m$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">s = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">23</span>, <span class="number">81</span>, <span class="number">199</span>, <span class="number">670</span>, <span class="number">1844</span>, <span class="number">5535</span>, <span class="number">19547</span>, <span class="number">75437</span>, <span class="number">259056</span>, <span class="number">974664</span>, <span class="number">2399609</span>, <span class="number">7304021</span>, <span class="number">18537736</span>, <span class="number">38733276</span>, <span class="number">143785607</span>, <span class="number">300890806</span>, <span class="number">778420517</span>, <span class="number">3112554961</span>, <span class="number">9955080778</span>, <span class="number">34625138877</span>, <span class="number">103531993246</span>, <span class="number">294207209833</span>, <span class="number">632363887456</span>, <span class="number">2341888528510</span>, <span class="number">8736224869982</span>, <span class="number">33727228149167</span>, <span class="number">113026240109398</span>, <span class="number">334534210335245</span>, <span class="number">754812282783351</span>, <span class="number">2871232541211362</span>, <span class="number">7147990367228081</span>, <span class="number">16813142520913249</span>, <span class="number">62232346665698392</span>, <span class="number">132813746566508109</span>, <span class="number">436969187287191174</span>, <span class="number">1371311321857557068</span>, <span class="number">3465499917202578303</span>, <span class="number">10761115866584374884</span>, <span class="number">25998484366411649657</span>, <span class="number">81986464388691181616</span>, <span class="number">324842980726420787162</span>, <span class="number">1063428202306999892763</span>, <span class="number">3318046410585817603032</span>, <span class="number">12569059003729082352479</span>, <span class="number">29822650425811094387624</span>, <span class="number">89829868596281155601134</span>, <span class="number">207467076929560545986692</span>, <span class="number">424101883375592006882573</span>, <span class="number">1410057940679583010646572</span>, <span class="number">4795250448769489602371933</span>, <span class="number">12419955465903295439689190</span>, <span class="number">32127052925660652338148413</span>, <span class="number">121768246803017981541739592</span>, <span class="number">286293639144639999224246905</span>, <span class="number">876618562849333372078886060</span>, <span class="number">3495370549956845610130431964</span>, <span class="number">13777448384830441398471073019</span>, <span class="number">45339968634224370226443992856</span>, <span class="number">159636974047457043534720001443</span>, <span class="number">403806399587759901542286515690</span>, <span class="number">1190949464093267805434271517577</span>, <span class="number">2625636206558220580206955200643</span>, <span class="number">5447410189447132699195152662348</span>, <span class="number">13798370097217657917056458399390</span>, <span class="number">42652195271813913821236091812630</span>, <span class="number">87624112365004035907264763291796</span>, <span class="number">295833079631922620770335225824586</span>, <span class="number">717255284196409248439771704866883</span>, <span class="number">2119024457898120787521595829459142</span>, <span class="number">8097762744600097674390735606807128</span>, <span class="number">22990496332708170421088808438995636</span>, <span class="number">55268619563994680834441597248247582</span>, <span class="number">157779112538179073738464223501777499</span>, <span class="number">553561084981889545670380643023607621</span>, <span class="number">2094594867042850711386606235023415160</span>, <span class="number">7427564397983932982484534762285032864</span>, <span class="number">28541899514275079822011638819911534081</span>, <span class="number">59854615377110931361953157015440306520</span>, <span class="number">137071568336121640486639449884477676903</span>, <span class="number">434368553369190183317274206512577489165</span>, <span class="number">1607515956833802196435755021284640023303</span>, <span class="number">4247439813046769661567823675143526066989</span>, <span class="number">12252982336388472725165513300377051313644</span>, <span class="number">43586970358791422986656986286232849952290</span>, <span class="number">94754002216262928157061686798919700234151</span>, <span class="number">205403633516427560050027271636224615375855</span>, <span class="number">727922215919878343821825296552148942903123</span>, <span class="number">1541646353685774868780093433673052445519807</span>, <span class="number">5703469721749658936787093922654529457118594</span>, <span class="number">20762100689139896330208273986505541316962105</span>, <span class="number">80195197197818086812949239946286778357513961</span>, <span class="number">198522126001869063688321920177617046841212852</span>, <span class="number">719060816608760633741229682178956301630549900</span>, <span class="number">2171712751463320729665634385979825928332317622</span>, <span class="number">7968526190188064156742281507099763347000210904</span>, <span class="number">20302513556821857703528100337806260797703562338</span>, <span class="number">54967103106163860243927426134510653397499429384</span>, <span class="number">189866376897538250029834405810321956080892995934</span>, <span class="number">516088075785491414669664215795496674103100750375</span>, <span class="number">1531616665488077085604100033058238685259376456655</span>, <span class="number">4795563798371064843556375420641263389159268373753</span>, <span class="number">12715206263244537077480789152826620386135239585589</span>, <span class="number">45628223673569886022145657218662773486560769778049</span>, <span class="number">127988774487590162169660910342623736153210927472871</span>, <span class="number">429761810968391607465089641939438991272623610573254</span>, <span class="number">1694286408402338132220805654166083638884822137745848</span>, <span class="number">5577419986858786911316434594350519553014729018524982</span>, <span class="number">22146179230778265190752372551893625479326089828877879</span>, <span class="number">78983119075073724439850825731329386811892547014513513</span>, <span class="number">165805826557531832743325076551678254671357810872202277</span>, <span class="number">525687524776397669648788242907896052104054917192402349</span>, <span class="number">1596680185629512867035574394423929715498386636216930988</span>, <span class="number">3808351509446054183279144714875260973968494634290203802</span>, <span class="number">10792542598439044383994436390450612942036864538927761344</span>, <span class="number">31776077718298264756461043701077481610506447838959767949</span>, <span class="number">69483787236434708634666641366101673156349500969799745632</span>, <span class="number">212620878051727200345257734337176214877612639791408110401</span>, <span class="number">565705372069455623425268706185184158331866127768259060570</span>, <span class="number">2228971348185635371906791535156337404926063871528397270892</span>, <span class="number">4859328204121938264839760465087547752629065763656619388434</span>, <span class="number">14185348803209161448182653444177464165713091554806223414499</span>, <span class="number">44242932119616103779840255273986809836494122475150635493273</span>, <span class="number">156176016196847319874949580221731690886061627436916661422852</span>, <span class="number">472567672907289753186461661432798790751774534772655287936877</span>, <span class="number">1765317440470718113352833182911767208733594355879647245836603</span>, <span class="number">5835719030771522391675663002032404790451900100534570526468736</span>, <span class="number">14528961633147270325279483890277955669830128461595478399405580</span>, <span class="number">53503137764341373520101774208921450303897226002280491351371881</span>, <span class="number">153340302591307960181257267214621247064964249027062324798966650</span>, <span class="number">467036429085212303265974827129085622046910166509299763268535756</span>, <span class="number">1760478013800716951650816419888923889893355872867499404847043361</span>, <span class="number">4791886951911545137378952129838133145784256723738609871941913863</span>, <span class="number">19126760116038883506408830737976498053029475253123685318001466609</span>, <span class="number">51635927378821965754946959553487670084314385367430813170544188707</span>, <span class="number">203944552994591250724882161307279862158139878326498083669171922709</span>, <span class="number">718868928147325949276701359623063723395455731358210896767864810436</span>, <span class="number">2005627527854915017699090052821431775394584514441537184407714355949</span>, <span class="number">6108484926321410509000933490330125849664844216966621898372849074206</span>, <span class="number">15273733259375332107091552084526951416159646708621190826219429490015</span>, <span class="number">34145117254940196604842578208457005181132408450899191627170638987883</span>, <span class="number">120825229084143066199868275091825674337472013226784591902132114229359</span>, <span class="number">387687667198606192147021527980207738864855944986764666796629571317797</span>, <span class="number">1461874344207808204456192497546273455901754164965322967295868406627707</span>, <span class="number">3258300231591322626530795072101331694347928535549768492906530809069244</span>, <span class="number">8874418273687545553519370439384854004509761935319681848589844232674343</span>, <span class="number">26555971104148502495508475192114409958713364020252024170586326291995544</span>, <span class="number">56653286369586527413345416396708661964062474995701742952261047069623359</span>, <span class="number">154383566127721041301459355493059400704799197964228029280865862358894596</span>, <span class="number">341393868848806018386217706353404785528207249510734290203621418976352706</span>, <span class="number">1171362524761660822765817023463786914069613269413196584856696440695273738</span>, <span class="number">4194882148022101614597714583113090146333385168895367467002069867303753334</span>, <span class="number">10081717223153632058965668126630772845024206141591578024505075742926631137</span>, <span class="number">39590555580101758090745061229221178837429140073072263518741551403983751377</span>, <span class="number">124978669991117804453179514660098523434116842472570073354436333226196401318</span>, <span class="number">285677744249355467333640461312079508294900634926466871637187648581093663108</span>, <span class="number">685643590088926190360498081484403342771108281930489395367499236756131358960</span>, <span class="number">2509513194338799699151211958956210034789618340347017416940796124375457114430</span>, <span class="number">7869725510782496795692771133398729561144872690341264618424961946628895219979</span>]</span><br><span class="line">l = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">list</span>(s[::-<span class="number">1</span>])</span><br><span class="line">n = <span class="built_in">len</span>(l)</span><br><span class="line">m = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    m += s[i]*l[i]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="2023天融信杯——easybog"><a href="#2023天融信杯——easybog" class="headerlink" title="2023天融信杯——easybog"></a>2023天融信杯——easybog</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line">import random</span><br><span class="line">from hashlib import md5</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">rr = os.urandom(10)</span><br><span class="line">flag = &quot;flag&#123;&quot;+rr.hex()+&quot;&#125;&quot;</span><br><span class="line">flag_md5 = md5(flag.encode()).hexdigest()</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">m = bin(bytes_to_long(rr))[2:].zfill(8 * len(rr))</span><br><span class="line">p = getPrime(256)</span><br><span class="line">def encrypt(m):</span><br><span class="line">    pubkey = [random.randint(2,p - 2) for i in range(len(m))]</span><br><span class="line">    enc = 0</span><br><span class="line">    for k,i in zip(pubkey,m):</span><br><span class="line">        enc += k * int(i)</span><br><span class="line">        enc %= p</span><br><span class="line">    return pubkey,enc</span><br><span class="line"></span><br><span class="line">pubkey,c = encrypt(m)</span><br><span class="line">f = open(&quot;output.txt&quot;,&quot;w&quot;)</span><br><span class="line">f.write(f&quot;p = &#123;p&#125;\n&quot;)</span><br><span class="line">f.write(f&quot;pubkey = &#123;pubkey&#125;\n&quot;)</span><br><span class="line">f.write(f&quot;c = &#123;c&#125;\n&quot;)</span><br><span class="line">f.write(f&quot;flag_md5 = &#123;flag_md5&#125;\n&quot;)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>从<code>encrypt(m)</code>，我们可以知道$c \equiv key_i×m_i \mod p \longrightarrow c &#x3D; key_i×m_i+kp$</p>
<p>$\therefore 0 &#x3D; \sum_{i&#x3D;1}^{80}key_im_i + kp - c$</p>
<p>一开始构造</p>
<p><img src="/../images/Lattice2/16.png"></p>
<p>规约后$(x_1,x_2,…,x_{80},k,\sum_{i&#x3D;1}^{80}key_ix_i+kp-tc)$就是第一行的向量。	</p>
<p>理想情况下，第一行向量的值应该是$(x_1,x_2,…,x_{80},k,0)$，其中$x_i \in \begin{Bmatrix}0,1\end{Bmatrix}$</p>
<p>发现规约后的向量不符合要求</p>
<p>改成</p>
<p>​	<img src="/../images/Lattice2/17.png"></p>
<p>两个格的区别在于行列式不同</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">p = 85766816683407427477074053090759168259205489535331001301483049660772943816017</span><br><span class="line">pubkey = [58890813098389592716367918664418237809399998613202441049117852003453550490043, 255886907973292033549191761914277947638378726729170162403000263307778539588, 43666147543837562983744529128391108960442814393989688186615627619841168438881, 2289339843351034938706095739069649849491797527322909177303809837660115875707, 41213482604182795008139260226694469358720652561587117539105919206178583341309, 85123975988270149359269904030278272256150702593339117634318036869051474541673, 38499515653492727036642516425661144597669644770181333309684190745152037999340, 20485509602350760468364550436683434882775269798789922529010411809186809838027, 66201868699675751260618542402171897519442339400362102112029773068389836772496, 5928498980938052035989976608996334019121526162545586177960440867589564370967, 50886730626726574520144515855606763616811548330471900085065588158010347676677, 64024533350992434764550819938965710849249693930938822302806256939206336927327, 38725701074483250591450474606717766666514853596721960873869603150079957176979, 79217343443391443055559755031159399927770013676937883189341106207746097977107, 61550584018851036114215415812034871024308694207855706560554908679054705909070, 18943452821091669663831772224349497605704279324611723330470460453532875854668, 19589987578009659601683539978459498259975975776374959927024576839483511789830, 30455762424330442645213719258885752997650973641135913878741104126501286615202, 58949965807078946897782791856062155685595594220625894016492979510745067947620, 62055731853485887582338078878228949009560282473783423335829652944841334703073, 9968050471897160901950463089357618812125361692340159762344476181267684171496, 82879622776859731032127240994822860125030485017752550449574280896284319539559, 4801338348200265259854446071344823901330707085102509710655971928319789477063, 45731791006706217374257923546738746982354369452894895184784691821888225473116, 67249651561046962535594292263727781436622305014470811080407605464069397278541, 74549581000796086938735007821116567870037873934415647996983670510761843574950, 53927163931460713770577528602376533863752551014779597870421933008696943680646, 56674817179749773825254339411582187056553125580899575215919582277873475282705, 46486618405288541635832334168373891479516241585245833202819962034096805786948, 33438500041468604615663063367413201369385488295864836452725688027946579037027, 67664099966578778667405575319488959391557099474146663546553930271609270514413, 45447815671440655615043306804023843286416205143693188321756314646855229497538, 11725972638697133812198141962081533057131109523301554105107846876476492922863, 64289489702331472745122326714411510149286883423778995697545620572730495023564, 57994575257987111046854716965859364231330618527165005046088441624813910607490, 14668229647185139513680523686559656096579435616501772089580139136432744069528, 17932811002316804580991874481669739042847138206519622106023735880404179858139, 5331195663859739712428554823168168360812478289288952467823046758773036202890, 74552793814948855649083379813894922159371588934498467412076815493098565156965, 44935994020454630627073800850452460158487760266394408710221643505798360283738, 56729956460199305019441584184914729272661532037080935244087594435220086006307, 62039396792619765440106521363503635264208869754554560630026111496679072778122, 2393458745997765849524009470841489934632527663821258015836036776013536950950, 35915327454351624449823951016325751779776476237317012289496757290655725512173, 32606524479615026657452402620774183996842863618201886022072527830448469143354, 63235637104235763521471020678482591762365962539497201272446150774560661623146, 62208964066864651499810642926855154855961192109426476051220581622874074871556, 56823425142073561606336827683244447153122191299012994793162957373419782442861, 60885675233604760515790987357657130734130927344692532134660791434444881730069, 70128263220978378037998154126965802527577393332688627564386146841574995052881, 71018980922731664798406835410011497130959699315348431777949257381109611662531, 12143164079299710577697191074655687226341720767219380493916347970636555672200, 13508918371738967514239962849170666297725816564248068619597724335815422874867, 35455956156846758401498039994914987477656410741995261921339242861566953715810, 69980758495467248406706658186358315365421963514406314839633132920772753269590, 40780609781497584108689952068487274243081363044494223353377248536197342087646, 44867942499383360300066493293729414921480295687316596135570022888723461284905, 82725154870798626926322339306353417520587153667878451856611421219700157524903, 25126631681527477467395254546272084567454410334950820629891182857858739056234, 6951466886617047161399523857762365328179011042304277010521273986635895511090, 76348861623318422648322072872825713398471251831589343473949016976971223635877, 56205107190224957419682681113714452084261733562014707901087589292788540501506, 18117892543394976645523077630904329147251317704285881519049138075260678609853, 44808031105096301006447146332872279574072682041430481888991436113801413524922, 49253422883319286749223459668126849556879848229728760990408851547046135426202, 84189814930926817953967035166781168797567323089104013113646102708978330223462, 47137140069594189485896203757476808738350291684312377044596204628988007490802, 40801572088832002265546622948401731702850273201235765228409527972304470614013, 66031049946459598112632104872606456117378438456948859102185817862671625118362, 81720181560222737179789740743588444616843925127263616533094516919384531350798, 22799062566507850812703708400514738660780510100747243720001217935586864713536, 19636898235593770858368519750634152409107475396982151534080287393055054087250, 29019136605948188309201641456999919579306004440518777086603961225647602320689, 79880698495154758609432245210109366091585969807890967815410904513080769679673, 9333444307040962156247586346311311869921891214405652789959336947220586492578, 5389291816105059661723219597627983160117906098832235782666626188832333763452, 80140247201709476779769310874536378021073864035213177889595402673752593492257, 10265989744904418075184606188771633319731922237097882332727796873595806941649, 28947186543573208323555611612621027283989204690818732739083074045376664847781, 76665830939598023116888796550932971936723367285838797618563918377195976634315]</span><br><span class="line">c = 1381426073179447662111620044316177635969142117258054810267264948634812447218</span><br><span class="line">flag_md5 = &quot;cae8243e01090ccd03a66e3a4c52b7ee&quot;</span><br><span class="line"></span><br><span class="line">n = len(pubkey)</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,n+2,n+2)</span><br><span class="line">for i in range(n):</span><br><span class="line">    Ge[i,i] = 1</span><br><span class="line">    Ge[i,-1] = pubkey[i]</span><br><span class="line"></span><br><span class="line">Ge[-2,-2] = 1</span><br><span class="line">Ge[-2,-1] = c</span><br><span class="line">Ge[-1,-1] = p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">L = Ge.BKZ()</span><br><span class="line">ans = &#x27;&#x27;</span><br><span class="line">for i in Ge.BKZ():</span><br><span class="line">    if i[-1] == 0:</span><br><span class="line">        tmp = i[:-2]</span><br><span class="line">        for j in tmp:</span><br><span class="line">            if abs(j) == 1:</span><br><span class="line">                ans += &#x27;1&#x27;</span><br><span class="line">            else:</span><br><span class="line">                ans += &#x27;0&#x27;</span><br><span class="line">        flag = &quot;flag&#123;&quot; + hex(int(ans,2))[2:] + &quot;&#125;&quot;</span><br><span class="line">        flag_md51 = hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line">        if flag_md51 == flag_md5:</span><br><span class="line">            print(flag)</span><br></pre></td></tr></table></figure>

<p>这里使用的是<code>BKZ</code>算法，暂时没有了解</p>
<p>sagemath中的<code>BKZ()</code>可以设置参数，例如<code>BKZ(block_size = 16)</code>，指定了<code>BKZ</code>算法中的块大小。默认情况下是<code>block_size = 20</code></p>
<h1 id="参考-1"><a href="#参考-1" class="headerlink" title="参考"></a>参考</h1><p><a href="https://harry0597.com/2022/07/21/bag/">CTF·背包问题相关 | Harry’s Blog (harry0597.com)</a></p>
<p><a href="https://jayxv.github.io/2020/06/08/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bknapsack/">密码学学习笔记 之 knapsack | Van1sh的小屋 (jayxv.github.io)</a></p>
<p><a href="https://www.ieice.org/publications/conference-FIT-DVDs/FIT2018/data/pdf/A-022.pdf">A-022.pdf (ieice.org)</a></p>
<p><a href="https://ctf-wiki.org/crypto/asymmetric/knapsack/knapsack/">背包加密 - CTF Wiki (ctf-wiki.org)</a></p>
]]></content>
      <categories>
        <category>格密码</category>
      </categories>
      <tags>
        <tag>Lattice</tag>
      </tags>
  </entry>
  <entry>
    <title>古典密码-代换密码</title>
    <url>/2023/07/10/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81-%E4%BB%A3%E6%8D%A2%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<p>对古典密码学中代换密码做个粗浅的了解</p>
<span id="more"></span>

<p><img src="/../../images/Ancient/17.png"></p>
<p><img src="/../../images/Ancient/18.png"></p>
<p><strong>代换密码分为单表代换和多表代换</strong></p>
<h2 id="一、单表代换"><a href="#一、单表代换" class="headerlink" title="一、单表代换"></a>一、单表代换</h2><p><strong>在单表替换加密中，所有的加密方式几乎都有一个共性，那就是明密文一一对应。所以说，一般有以下两种方式来进行破解</strong></p>
<h3 id="1-凯撒密码"><a href="#1-凯撒密码" class="headerlink" title="1.凯撒密码"></a>1.凯撒密码</h3><p>凯撒密码（Caesar）加密时会将明文中的 <strong>每个字母</strong> 都按照其在字母表中的顺序向后（或向前）移动固定数目（<strong>循环移动</strong>）作为密文</p>
<p><strong>eg：偏移量为3</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">密文：DEFGHIJKLMNOPQRSTUVWXYZABC</span><br></pre></td></tr></table></figure>

<p>根据偏移量的不同，还存在<strong>若干特定的恺撒密码名称</strong>：</p>
<ul>
<li>偏移量为 10： Avocat （A→K）</li>
<li>偏移量为 13： <a href="https://zh.wikipedia.org/wiki/ROT13">ROT13</a></li>
<li>偏移量为 -5： Cassis （K 6）</li>
<li>偏移量为 -6： Cassette （K 7）</li>
</ul>
<p><strong>加密脚本:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_caesar_cipher</span>(<span class="params">plaintext</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">text, n</span>):</span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                shift = <span class="built_in">ord</span>(char) + n</span><br><span class="line">                <span class="keyword">if</span> char.islower():</span><br><span class="line">                    <span class="keyword">if</span> shift &gt; <span class="built_in">ord</span>(<span class="string">&quot;z&quot;</span>):</span><br><span class="line">                        shift -= <span class="number">26</span></span><br><span class="line">                    <span class="keyword">elif</span> shift &lt; <span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>):</span><br><span class="line">                        shift += <span class="number">26</span></span><br><span class="line">                <span class="keyword">elif</span> char.isupper():</span><br><span class="line">                    <span class="keyword">if</span> shift &gt; <span class="built_in">ord</span>(<span class="string">&quot;Z&quot;</span>):</span><br><span class="line">                        shift -= <span class="number">26</span></span><br><span class="line">                    <span class="keyword">elif</span> shift &lt; <span class="built_in">ord</span>(<span class="string">&quot;A&quot;</span>):</span><br><span class="line">                        shift += <span class="number">26</span></span><br><span class="line">                result += <span class="built_in">chr</span>(shift)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result += char</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;尝试所有可能的位移：&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;位移 <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;shift(plaintext, +i)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plaintext = <span class="built_in">input</span>(<span class="string">&quot;请输入凯撒密码的明文：&quot;</span>)</span><br><span class="line">    encrypt_caesar_cipher(plaintext)</span><br></pre></td></tr></table></figure>

<p><strong>解密脚本:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_caesar_cipher</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">text, n</span>):</span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                shift = <span class="built_in">ord</span>(char) + n</span><br><span class="line">                <span class="keyword">if</span> char.islower():</span><br><span class="line">                    <span class="keyword">if</span> shift &gt; <span class="built_in">ord</span>(<span class="string">&quot;z&quot;</span>):</span><br><span class="line">                        shift -= <span class="number">26</span></span><br><span class="line">                    <span class="keyword">elif</span> shift &lt; <span class="built_in">ord</span>(<span class="string">&quot;a&quot;</span>):</span><br><span class="line">                        shift += <span class="number">26</span></span><br><span class="line">                <span class="keyword">elif</span> char.isupper():</span><br><span class="line">                    <span class="keyword">if</span> shift &gt; <span class="built_in">ord</span>(<span class="string">&quot;Z&quot;</span>):</span><br><span class="line">                        shift -= <span class="number">26</span></span><br><span class="line">                    <span class="keyword">elif</span> shift &lt; <span class="built_in">ord</span>(<span class="string">&quot;A&quot;</span>):</span><br><span class="line">                        shift += <span class="number">26</span></span><br><span class="line">                result += <span class="built_in">chr</span>(shift)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result += char</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;尝试所有可能的位移：&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;位移 <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;shift(ciphertext, -i)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="built_in">input</span>(<span class="string">&quot;请输入凯撒密码的密文：&quot;</span>)</span><br><span class="line">    decrypt_caesar_cipher(ciphertext)</span><br></pre></td></tr></table></figure>



<h3 id="2-Atbash-Cipher"><a href="#2-Atbash-Cipher" class="headerlink" title="2.Atbash Cipher"></a>2.Atbash Cipher</h3><p>埃特巴什码(Atbash Cipher)，它使用字母表中的最后一个字母代表第一个字母，倒数第二个字母代表第二个字母。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</span><br><span class="line">密文：Z Y X W V U T S R Q P O N M L K J I H G F E D C B A</span><br></pre></td></tr></table></figure>

<p>加密例子：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：the quick brown fox jumps over the lazy dog</span><br><span class="line">密文：gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt</span><br></pre></td></tr></table></figure>

<p>工具：<a href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/">实用密码学 (practicalcryptography.com)</a></p>
<h3 id="3-简单替换密码"><a href="#3-简单替换密码" class="headerlink" title="3.简单替换密码"></a>3.简单替换密码</h3><p><strong>加密时，每个明文都有自己对应的密文，而且不是简单的移位，是混乱的。这也使得其破解难度要高于凯撒密码</strong></p>
<p>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文: abcdefghijklmnopqrstuvwxyz</span><br><span class="line">密钥: phqgiumeaylnofdxjkrcvstzwb</span><br><span class="line"></span><br><span class="line">a对应p,b对应h</span><br></pre></td></tr></table></figure>

<p>一般用词频分析破解：<a href="http://quipqiup.com/">quipqiup - cryptoquip and cryptogram solver</a></p>
<h3 id="4-仿射密码"><a href="#4-仿射密码" class="headerlink" title="4.仿射密码"></a>4.仿射密码</h3><p>$$<br>加密函数：E(x) &#x3D; (ax+b) \mod m<br>$$</p>
<p>$$<br>其中,x是明文通过某种数字得到的编码<br>$$</p>
<p>$$<br>a,m满足gcd(a,m)&#x3D;1<br>$$</p>
<p>$$<br>m是编码系统中字母的个数<br>$$</p>
<p>$$<br>eg:如果以26字母表作为编码系统，则m&#x3D;26<br>$$</p>
<p>$$<br>解密函数：D(x)&#x3D;a^{-1}(x-b)\mod m<br>$$</p>
<p>$$<br>a^{-1}是模m的逆元<br>$$</p>
<h2 id="二、多表代换"><a href="#二、多表代换" class="headerlink" title="二、多表代换"></a>二、多表代换</h2><h3 id="1-Playfair"><a href="#1-Playfair" class="headerlink" title="1.Playfair"></a>1.Playfair</h3><p>原理：</p>
<ol>
<li>选取一串英文字母，除去重复出现的字母，将剩下的字母逐个逐个加入 5 × 5 的矩阵内，剩下的空间由未加入的英文字母依 a-z 的顺序加入。注意，将 q 去除，或将 i 和 j 视作同一字。</li>
<li>将要加密的明文分成两个一组。若组内的字母相同，将 X（或 Q）加到该组的第一个字母后，重新分组。若剩下一个字，也加入 X 。</li>
<li>在每组中，找出两个字母在矩阵中的地方<ul>
<li>若两个字母不同行也不同列，在矩阵中找出另外两个字母（第一个字母对应行优先），使这四个字母成为一个长方形的四个角。</li>
<li>若两个字母同行，取这两个字母右方的字母（若字母在最右方则取最左方的字母）</li>
<li>若两个字母同列，取这两个字母下方的字母（若字母在最下方则取最上方的字母）</li>
</ul>
</li>
</ol>
<p>新找到的两个字母就是原本的两个字母加密的结果。</p>
<p><strong>exp:</strong></p>
<p>以 playfair example 为密匙，得</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">P L A Y F</span><br><span class="line">I R E X M</span><br><span class="line">B C D G H</span><br><span class="line">K N O Q S</span><br><span class="line">T U V W Z</span><br></pre></td></tr></table></figure>

<p><strong>要加密的讯息为 Hide the gold in the tree stump</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HI DE TH EG OL DI NT HE TR EX ES TU MP</span><br></pre></td></tr></table></figure>

<p>加密后密文：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">BM OD ZB XD NA BE KU DM UI XM MO UV IF</span><br></pre></td></tr></table></figure>

<p><strong>加解密网站：</strong><a href="http://www.metools.info/code/playfair_186.html">Playfair加密解密_普莱费尔加密解密-ME2在线工具 (metools.info)</a></p>
<h3 id="2-Polybius"><a href="#2-Polybius" class="headerlink" title="2.Polybius"></a>2.Polybius</h3><p>Polybius 密码又称为棋盘密码</p>
<p><strong>密码表长这样</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">A</td>
<td align="center">B</td>
<td align="center">C</td>
<td align="center">D</td>
<td align="center">E</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">F</td>
<td align="center">G</td>
<td align="center">H</td>
<td align="center">I&#x2F;J</td>
<td align="center">K</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">L</td>
<td align="center">M</td>
<td align="center">N</td>
<td align="center">O</td>
<td align="center">P</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">Q</td>
<td align="center">R</td>
<td align="center">S</td>
<td align="center">T</td>
<td align="center">U</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">V</td>
<td align="center">W</td>
<td align="center">X</td>
<td align="center">Y</td>
<td align="center">Z</td>
</tr>
</tbody></table>
<p><strong>eg: HELLO加密后 23 15 31 31 34</strong></p>
<p>另外有种变表：</p>
<table>
<thead>
<tr>
<th></th>
<th>A</th>
<th>D</th>
<th>F</th>
<th>G</th>
<th>X</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>b</td>
<td>t</td>
<td>a</td>
<td>l</td>
<td>p</td>
</tr>
<tr>
<td>D</td>
<td>d</td>
<td>h</td>
<td>o</td>
<td>z</td>
<td>k</td>
</tr>
<tr>
<td>F</td>
<td>q</td>
<td>f</td>
<td>v</td>
<td>s</td>
<td>n</td>
</tr>
<tr>
<td>G</td>
<td>g</td>
<td>j</td>
<td>c</td>
<td>u</td>
<td>x</td>
</tr>
<tr>
<td>X</td>
<td>m</td>
<td>r</td>
<td>e</td>
<td>w</td>
<td>y</td>
</tr>
</tbody></table>
<p>应用这种密码表的加密方式叫<strong>ADFGX加密</strong></p>
<p><strong>eg:HELLO 加密后得到 DD XF AG AG DF</strong></p>
<h3 id="3-Vigenere"><a href="#3-Vigenere" class="headerlink" title="3.Vigenere"></a>3.Vigenere</h3><p>维吉尼亚密码（Vigenere）是使用一系列凯撒密码组成密码字母表的加密算法，属于多表密码的一种简单形式。</p>
<p><img src="/../../images/Ancient/0.jpg"></p>
<p><strong>eg:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：come greatwall</span><br><span class="line">密钥：crypto</span><br><span class="line"></span><br><span class="line">先把密钥变成和明文同样长度</span><br><span class="line">明文：comegreatwall</span><br><span class="line">密钥：cryptocryptoc</span><br><span class="line"></span><br><span class="line">然后查表，cc作为横纵坐标得到e</span><br><span class="line">加密后的密文为：efkt zferrltzn</span><br></pre></td></tr></table></figure>

<p>解密网站：</p>
<p><strong>未知密钥：<a href="https://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx">My Geocaching Profile.com - Vigenere Cipher Codebreaker</a></strong></p>
<p><strong>已知密钥：<a href="http://planetcalc.com/2468/">http://planetcalc.com/2468/</a></strong></p>
<h4 id="GDOUCTF-2023-1z-Classic"><a href="#GDOUCTF-2023-1z-Classic" class="headerlink" title="[GDOUCTF 2023]1z Classic"></a>[GDOUCTF 2023]1z Classic</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> s</span><br><span class="line">s = s.lower()</span><br><span class="line">keyM = [?]</span><br><span class="line">l = <span class="built_in">len</span>(keyM)</span><br><span class="line"><span class="keyword">assert</span>(math.gcd(l,<span class="number">26</span>)==<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((<span class="built_in">ord</span>(s[i])*l-<span class="number">97</span>+(keyM[i % l]))%<span class="number">26</span>+<span class="number">97</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#..........</span></span><br></pre></td></tr></table></figure>

<p>加密可以看错是类似于仿射密码：$y_i &#x3D; lx_i + k_i\mod 26$</p>
<p>乘上$l^{-1}$得$y_il^{-1} &#x3D; x_i + k_il^{-1} \mod 26$</p>
<p>这就是标准的维吉尼亚密码了，题目给出$l$和$26$的关系</p>
<p>解题思路是先爆破出$l$，再网站解密</p>
<p>最后l为11</p>
<p>明文为：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flagwowyouareclassicmaster</span><br></pre></td></tr></table></figure>





<h3 id="4-Nihilist"><a href="#4-Nihilist" class="headerlink" title="4.Nihilist"></a>4.Nihilist</h3><p><strong>Nihilist 密码又称关键字密码：明文 + 关键字 &#x3D; 密文。</strong></p>
<p>首先利用密钥构造棋盘矩阵（类似 Polybius 密码），新建一个 5 × 5 矩阵，将字符不重复地依次填入矩阵 ，剩下部分按字母顺序填入 ，字母 i 和 j 等价</p>
<p><strong>以关键字 helloworld 为例</strong></p>
<p><strong>关键字导出的密码表如下</strong></p>
<table>
<thead>
<tr>
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>h</td>
<td>e</td>
<td>l</td>
<td>o</td>
<td>w</td>
</tr>
<tr>
<td>2</td>
<td>r</td>
<td>d</td>
<td>a</td>
<td>b</td>
<td>c</td>
</tr>
<tr>
<td>3</td>
<td>f</td>
<td>g</td>
<td>i&#x2F;j</td>
<td>k</td>
<td>m</td>
</tr>
<tr>
<td>4</td>
<td>n</td>
<td>p</td>
<td>q</td>
<td>s</td>
<td>t</td>
</tr>
<tr>
<td>5</td>
<td>u</td>
<td>v</td>
<td>x</td>
<td>y</td>
<td>z</td>
</tr>
</tbody></table>
<p><strong>将明文中的每个字母对应横纵坐标就是其密文，例如a加密后是23</strong></p>
<h3 id="5-Hill"><a href="#5-Hill" class="headerlink" title="5.Hill"></a>5.Hill</h3><p><strong>希尔密码（Hill）使用每个字母在字母表中的顺序作为其对应的数字，即 A&#x3D;0，B&#x3D;1，C&#x3D;2 等等。然后将明文转化为 n 维向量，跟一个 n × n 的矩阵相乘，再将得出的结果模 26。注意用作加密的矩阵（即密匙）在mod26下必须是可逆的，否则就不可能解码。</strong></p>
<p><strong>只有矩阵的行列式和 26 互质，才是可逆的。</strong></p>
<p>eg:</p>
<p><img src="/../../images/Ancient/1.png"></p>
<p><strong>在线解密工具</strong><a href="http://www.practicalcryptography.com/ciphers/hill-cipher/">http://www.practicalcryptography.com/ciphers/hill-cipher/</a></p>
<h3 id="6-Autokey-Cipher"><a href="#6-Autokey-Cipher" class="headerlink" title="6.Autokey Cipher"></a>6.Autokey Cipher</h3><p><strong>自动密钥密码（Autokey Cipher）也是多表替换密码，与维吉尼亚密码密码类似，但使用不同的方法生成密钥。</strong></p>
<p><strong>自动密钥密码主要有两种，关键词自动密钥密码和原文自动密钥密码。</strong></p>
<p><strong>以关键词自动密钥为例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG</span><br><span class="line">关键词：CULTURE</span><br></pre></td></tr></table></figure>

<p><strong>以用关键词开始，填充为与明文等长的密钥</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG</span><br><span class="line">关键词：CULTURE THE QUICK BROWN FOX JUMPS OVER THE</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/Ancient/0.jpg"></p>
<p><strong>和Vigenere同样的码表</strong></p>
<p>加密后的密文为:<code>VBP JOZGD IVEQV HYY AIICX CSNL FWW ZVDP WVK</code></p>
<p><strong>原文自动密钥密码，应该是密钥和明文一样进行加密</strong></p>
<p><strong>当未知关键词（也就是未知密钥的时候）可以用网站解密</strong><a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</a></p>
]]></content>
      <categories>
        <category>古典密码学</category>
      </categories>
      <tags>
        <tag>古典密码</tag>
        <tag>代换密码</tag>
      </tags>
  </entry>
  <entry>
    <title>随笔(三)</title>
    <url>/2023/08/24/%E9%9A%8F%E7%AC%94(%E4%B8%89)/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重试" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="36c779b3f79771e949bcd169a10afdc166d78d88356e2dbfc56bccf806688541">ee88741ea599eb54e0cde20fcde6e56c685a9ac8bc3a002c1098da3f619b90d0a9b13e23c1f456d4b565af59604e6987eb1f1c81aef5acbbfdeba1f07a02f1263dbc90da35ab1691f09750bb6a77099622337af724e545f00d52ba697fe7410e0c0d41f83fcaa38f354f367cb1f77ae4fd5f70e335eaeb0ed5a75f94ba155c2575ac5d39217059d9754760a8393a4c2cee747bf4ee820724f18ac603700ce5876350c128d740e8ca585fae6e5797a9be62bdf2c71fbd6707ed78aaf7a5dd4c580dedd6ba89cc87ddd7d5cc49df926f15887ead39913780976fb9bfb1b9b0d8018fae7fc75477752d1f3592ae4c8c8ca9e4139e512ff995e343b584d6155a74c8f0cd74ff4f30f0eb07318425ee78bd6d305d8d1a95772af3c93734296d095fdf2f102dee874f9de0ef34c07b0a39b6a67b40a131922bb9d43d64f7f49f68698663a880fdef3642f2d453448ff2cd8936b700a44b45636518ef87f677624202359ada9470eb91327e5d12591c921e6a19bd0778313f24cce7b29b008a2331923ce77a39bf89689c23aa83ea6137db4f0085c99804c6d30dd6f1d93e6c9f1b7f810c19c176c7c8ea2bbf5c1e2c884729f45a7af4f13257f254e9c86590d9e2e84f9b1919f1dc19343967c1b0ebd905cd83c039e20b3e4e728a1158ced0d444c39a5bfe9c228251c567dfbe9442dbfe61848896a6b3c92ff0f17e0913143897c9fb0c06efae78abe7869850aa078f4e2742b9cc0995a2804550bc719e5f656275f139cedfef9903442518aa62e1da7e3b1af7f10985ccf4edc70e46c0e664498d09040d79e1b3d16611d540fbe56e45a2c65697deba09ce7eac5fb4f4ada3f607880674bc75858ee8fb41c88b4ca00cb6ad19b741ee16288dc891b5329d40ae0486374e56fb8ff93ceb036dcf6788cacc906a03e60862a6cd94851317bb0f9f5f6f7c2c7449d92600af05a42b534df37eadf594a6a45774ee99af7e795c3b32ce60f30a3ac41ce3b4d4099f8a4d5e9463fc71711b6eaaccee80e934d721b1f400d5c2e4bf4ae2aa0ffb79bb0a9a8adffe01a3c93fac240dc1728dace9c78a40db443904e9e232275c52df8509f4ac6d9e493d6ea5a02cc0af90c68a39332a059a46826b105dd73d660ee05f1e7c25971c578443e2c96b5339d37395be8ce0269113efd59606fffbf8b439b401dd3b7fa7da5f976d28ef2ff4acb08bb126319361e575c70d21c57945610be74236b115e74ce42c8482274b57cbda9b3bbfded3d4ba2a1525a57e97bc71713bfb1e4bbc4ab67c0cb32aa27d419c16179b8d05280f548144f2b203466e74ef2f8d73396befc18b404c541f6db7b35a5aab14b0ef8ffc51894563bf492cf88ce896e41c4baa2af9437ac590115dd20a45c3b2aca04b65e7ff7ba89f7e9b684a84a523ae44d752a1f03db6b71363beb3e4b1cc39b1debcf5ef445fcfa0f55822094a07e9ebde3ccf9ae0d02f520e3a78321070d3eedfbd888c540b25ff06a6644013be3cca964a7f7f87856261cce0c138e5ea8f8a8e2af55177a05864378aedc0c9d9fddc172d14e6699c6406079c52c14e3eaadb4f6722a44d6e8543b0872e23594ae4437c3855937c6455b43b2357f3d6c3196d72fb4dc5686f5915c3673d77e8fe6c4ff91bba8d11436fbd4167cf49d6282e2aabfa6c1245dd304e9561fa79f8267fefd05a0c51d1a4442088ade83d44903de17cff0c63f36a0bae5afaebf7d7c2bb11392467cfc68b82d79d345bd58a029fa8c38698921b0b72ffa88c748a67f4dc667d8712ffc704098a05afe3bd2db760abb8c14546cfd59b23cb89aa8abad9b883c22dae13f427205f808ab192b9d31cde88eeee205d16c8b1db22875072821afd09c69fcf985d4380849faddc02e93f33934f2e4ecd7ffff6ccb8646a213105ff6e9886239894337d499839c6ac9f553acb523aa8001dc851cb8399e11a0e97f66447b21800854d2f1f14d37e0add7a7adfb475a14ec7a7fa7d7c2e0bdf29dc53b17edb7131b2f1697c697e658efcf6ca1dc5ffc16a219e70ca4144a5ae5850bb7436d9d11dbd994d149a027f1991915d216d60734b1cc66eec728764b69734ca57f30f78ac73d418735cafc95b236376804bb82053b466dfaef6b386362000e1f72b160ce777bee6a176fe296d500de50c84bec799a30bfc33bbc34337cf3ec7e33f28c11b81955af91451e78d4b6955a3ed3755471b94e60614c4c9b74a54c5830d91af847c774da956f119ceef6e1a9cb0767f360d2e28c2895a4ae558043167a3b7fff600e994761865d1d0e787dc1553be4dc3b59d9205600be9fff996fb115f09a8b74cd6ecc9189af9d149e67ae9c284d6a8b23228be149a024f484ac2c4fc5526c4c3b86f23e8a2f5e82526f977835132857bffcdef6472e992f6a6810fd3690602d4fe088a808a45135fbb14753ec4a1312684212bdf70fd56f777db3f122872496333495d99f5ea67b7203fe63ff7cd9c2a5d52956aba03b9ae1ab1a13142c37bc5237e5737e259337ae3ea90ee1443c290fbbe8b21c3d276154d56a2d9cde22e0ba3d062598ab5c9cb26b879ed7cd6e4d347497ca847ed8a6d12fc40459f3a206ee1538527fa6d5c118663baa698b30004d387971903025b984a5e06e04bec5052d24f4c88e8bbd5c9a04cad6c45fc18e7093c6e7515f28e08a1379d2afef819c82031afba950be37f52056cb0f6541fe1f3731766f8272be827fe4adf783e0ba72c7c46b1c98498b0ae84e85deff1b7dedf57465c1699dd3965365ebb98aa109a531b1c1cf51c23be866bb9e533e30c02ab352805a4bb330b32299232a8ba1937870e3e0e84f38176eab176345b9bfddc4305110f7e5aa08a91e9beece7544da1d4b4a17495be5ee33b23239de22a6d653801d1eb6ddcf7aa41e717c8c81224f0b2f047a2812bab01251ee354a462462169035bb5f26a32a1c4e9b2976ba96b949168f923799a1d9c5937422720d7cc13192dd2626e6326d864b33a4ec3e7b333856edbf226ec850b89facdd31ddf7a9e8f988e27f1cb2016454b10fe98c80f2ab92d33d02bd01b8d2ad1798a41437fadab318d3b56fadad79ac4275fd215485f2ac526bec7371244f5331d2a9a298a325e16497d01354dff60d31204f3d2d228be949858b78220861b3d820d6c5843047273ce6ab1396b62a5dbb07464f4c1c88310b2325e857d2c4ae41598e71440ab7a53a036d013e1d1d7909b89bb15309f1323c8608a58c82abe08a7b449414ad0afbfa87a2692633c9d891735f8a4c13653fe935d635d3c3e520d5e25e2eab5c95c0bbf2bcdd0e2f8c072f271e3289c749cb8c24e4d016d27e28241621e1e49b7ec2333340c30b20652e634dc102fb37c6beea90ec651db55c9e2664173b4e6fd8fdfe64ea129cfb1d0fdc4d63a0b8642a7e1d31f3065f5fbe759898369a52a7abb359b7beabd32407de6a3d1</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-up">
      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-up">内容已加密，请输入密码后阅读</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>随笔</category>
      </categories>
      <tags>
        <tag>随笔</tag>
      </tags>
  </entry>
  <entry>
    <title>古典密码-其他密码</title>
    <url>/2023/07/11/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81-%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81/</url>
    <content><![CDATA[<p>记录一些见过的密码</p>
<p>时间不语，但却回答了很多问题</p>
<span id="more"></span>

<p>从网上找了些资料，以及一些大佬的博客，再结合自己所学，收集了一些加密方式。</p>
<h1 id="一、培根密码"><a href="#一、培根密码" class="headerlink" title="一、培根密码"></a>一、培根密码</h1><p><strong>把字母用A,B两个字母表示</strong></p>
<p>码表:</p>
<table>
<thead>
<tr>
<th>明文</th>
<th>密文</th>
<th>明文</th>
<th>密文</th>
<th>明文</th>
<th>密文</th>
<th>明文</th>
<th>密文</th>
</tr>
</thead>
<tbody><tr>
<td>A</td>
<td>AAAAA</td>
<td>G</td>
<td>AABBA</td>
<td>N</td>
<td>ABBAA</td>
<td>T</td>
<td>BAABA</td>
</tr>
<tr>
<td>B</td>
<td>AAAAB</td>
<td>H</td>
<td>AABBB</td>
<td>O</td>
<td>ABBAB</td>
<td>U&#x2F;V</td>
<td>BAABB</td>
</tr>
<tr>
<td>C</td>
<td>AAABA</td>
<td>I&#x2F;J</td>
<td>ABAAA</td>
<td>P</td>
<td>ABBBA</td>
<td>W</td>
<td>BABAA</td>
</tr>
<tr>
<td>D</td>
<td>AAABB</td>
<td>K</td>
<td>ABAAB</td>
<td>Q</td>
<td>ABBBB</td>
<td>X</td>
<td>BABAB</td>
</tr>
<tr>
<td>E</td>
<td>AABAA</td>
<td>I</td>
<td>ABABA</td>
<td>R</td>
<td>BAAAA</td>
<td>Y</td>
<td>BABBA</td>
</tr>
<tr>
<td>F</td>
<td>AABAB</td>
<td>M</td>
<td>ABABB</td>
<td>S</td>
<td>BAAAB</td>
<td>Z</td>
<td>BABBB</td>
</tr>
</tbody></table>
<p><strong>培根密码不过是用A,B代替0，1表示其在字母表中的顺序（0——25）。</strong></p>
<p><strong>例如字母C的顺序是2，所以其密文是AAABA（00010）</strong></p>
<p>工具：<a href="http://rumkin.com/tools/cipher/baconian.php">http://rumkin.com/tools/cipher/baconian.php</a></p>
<p>找了harry师傅的脚本<a href="https://blog.csdn.net/qq_32284207/article/details/124771025">(59条消息) CTF·Crypto·古典密码大全_博多密码_0HB的博客-CSDN博客</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__autor__ = <span class="string">&#x27;0HB&#x27;</span></span><br><span class="line">letters1 = [</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;N&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;S&#x27;</span>, <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>,</span><br><span class="line">]</span><br><span class="line">letters2 = [</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>,</span><br><span class="line">]</span><br><span class="line">cipher1 = [</span><br><span class="line">    <span class="string">&quot;aaaaa&quot;</span>, <span class="string">&quot;aaaab&quot;</span>, <span class="string">&quot;aaaba&quot;</span>, <span class="string">&quot;aaabb&quot;</span>, <span class="string">&quot;aabaa&quot;</span>, <span class="string">&quot;aabab&quot;</span>, <span class="string">&quot;aabba&quot;</span>,</span><br><span class="line">    <span class="string">&quot;aabbb&quot;</span>, <span class="string">&quot;abaaa&quot;</span>, <span class="string">&quot;abaab&quot;</span>, <span class="string">&quot;ababa&quot;</span>, <span class="string">&quot;ababb&quot;</span>, <span class="string">&quot;abbaa&quot;</span>, <span class="string">&quot;abbab&quot;</span>,</span><br><span class="line">    <span class="string">&quot;abbba&quot;</span>, <span class="string">&quot;abbbb&quot;</span>, <span class="string">&quot;baaaa&quot;</span>, <span class="string">&quot;baaab&quot;</span>, <span class="string">&quot;baaba&quot;</span>, <span class="string">&quot;baabb&quot;</span>,</span><br><span class="line">    <span class="string">&quot;babaa&quot;</span>, <span class="string">&quot;babab&quot;</span>, <span class="string">&quot;babba&quot;</span>, <span class="string">&quot;babbb&quot;</span>, <span class="string">&quot;bbaaa&quot;</span>, <span class="string">&quot;bbaab&quot;</span>,</span><br><span class="line">]</span><br><span class="line">cipher2 = [</span><br><span class="line">    <span class="string">&quot;AAAAA&quot;</span>, <span class="string">&quot;AAAAB&quot;</span>, <span class="string">&quot;AAABA&quot;</span>, <span class="string">&quot;AAABB&quot;</span>, <span class="string">&quot;AABAA&quot;</span>, <span class="string">&quot;AABAB&quot;</span>, <span class="string">&quot;AABBA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AABBB&quot;</span>, <span class="string">&quot;ABAAA&quot;</span>, <span class="string">&quot;ABAAA&quot;</span>, <span class="string">&quot;ABAAB&quot;</span>, <span class="string">&quot;ABABA&quot;</span>, <span class="string">&quot;ABABB&quot;</span>, <span class="string">&quot;ABBAA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ABBAB&quot;</span>, <span class="string">&quot;ABBBA&quot;</span>, <span class="string">&quot;ABBBB&quot;</span>, <span class="string">&quot;BAAAA&quot;</span>, <span class="string">&quot;BAAAB&quot;</span>, <span class="string">&quot;BAABA&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BAABB&quot;</span>, <span class="string">&quot;BAABB&quot;</span>, <span class="string">&quot;BABAA&quot;</span>, <span class="string">&quot;BABAB&quot;</span>, <span class="string">&quot;BABBA&quot;</span>, <span class="string">&quot;BABBB&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bacon1</span>(<span class="params">string</span>):  <span class="comment"># 对应小写密文</span></span><br><span class="line">    lists = []</span><br><span class="line">    <span class="comment"># 分割，五个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(string), <span class="number">5</span>):</span><br><span class="line">        lists.append(string[i:i + <span class="number">5</span>])</span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    <span class="comment"># 循环匹配，得到下标，对应下标即可</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lists)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> lists[i] == cipher1[j]:</span><br><span class="line">                <span class="comment"># print(j)</span></span><br><span class="line">                <span class="built_in">print</span>(letters1[j], end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bacon2</span>(<span class="params">string</span>):  <span class="comment"># 对应大写密文</span></span><br><span class="line">    lists = []</span><br><span class="line">    <span class="comment"># 分割，五个一组</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(string), <span class="number">5</span>):</span><br><span class="line">        lists.append(string[i:i + <span class="number">5</span>])</span><br><span class="line">    <span class="comment"># print(lists)</span></span><br><span class="line">    <span class="comment"># 循环匹配，得到下标，对应下标即可</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lists)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            <span class="keyword">if</span> lists[i] == cipher2[j]:</span><br><span class="line">                <span class="comment"># print(j)</span></span><br><span class="line">                <span class="built_in">print</span>(letters2[j], end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    c = <span class="built_in">input</span>(<span class="string">&#x27;请输入培根密文：&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> c.isupper():</span><br><span class="line">        bacon2(c)</span><br><span class="line">    <span class="keyword">elif</span> c.islower():</span><br><span class="line">        bacon1(c)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;输入错误，请检查！&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="二、栅栏密码"><a href="#二、栅栏密码" class="headerlink" title="二、栅栏密码"></a>二、栅栏密码</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p><strong>栅栏密码把要加密的明文分成 N 个一组，然后把每组的第 1 个字连起来，形成一段无规律的话。</strong></p>
<p>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：THERE IS A CIPHER</span><br><span class="line">去掉空格</span><br><span class="line">明文：THEREISACIPHER</span><br><span class="line">取N=2，即2个字母一组</span><br><span class="line">TH ER EI SA CI PH ER</span><br><span class="line">先取每组第一个字母：TEESCPE</span><br><span class="line">再去每组第二个字母：HRIAIHR</span><br><span class="line">所以密文：TEESCPEHRIAIHR</span><br><span class="line"></span><br><span class="line">如果明文是THERE IS CIPHER</span><br><span class="line">分组：TH ER EI SC IP HE R</span><br><span class="line">照样2个一组，然后先取每组第一个字母</span><br><span class="line">密文：TEESIHRHRICPE</span><br></pre></td></tr></table></figure>

<p><strong>自己写了个加密代码</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">plaintext = <span class="string">&quot;THEREISACIPHER&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypto</span>(<span class="params">plaintext,n</span>):</span><br><span class="line">    array = []</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(plaintext),n):</span><br><span class="line">        array.append(plaintext[i:i+n])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(array[<span class="number">0</span>])):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> array:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                cipher += j[i]</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;每组字数&quot;</span>+ <span class="built_in">str</span>(n) +<span class="string">&quot;加密结果&quot;</span> + cipher)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="built_in">len</span>(plaintext)):</span><br><span class="line">    encrypto(plaintext,i)</span><br></pre></td></tr></table></figure>

<h2 id="工具："><a href="#工具：" class="headerlink" title="工具："></a>工具：</h2><p><a href="http://www.metools.info/code/fence154.html">栅栏密码_栅栏密码在线加密解密【W型】-ME2在线工具 (metools.info)</a></p>
<p><a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">栅栏密码在线加密解密 - 千千秀字 (qqxiuzi.cn)</a></p>
<h1 id="三、曲路密码"><a href="#三、曲路密码" class="headerlink" title="三、曲路密码"></a>三、曲路密码</h1><h2 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h2><p><strong>曲路密码（Curve Cipher）是一种换位密码，需要事先双方约定密钥（也就是曲路路径）</strong></p>
<p>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：The quick brown fox jumps over the lazy dog</span><br></pre></td></tr></table></figure>

<p><strong>填入5行7列的表格（事先约定填充的行列数）</strong></p>
<table>
<thead>
<tr>
<th align="center">T</th>
<th align="center">h</th>
<th align="center">e</th>
<th align="center">q</th>
<th align="center">u</th>
<th align="center">i</th>
<th align="center">c</th>
</tr>
</thead>
<tbody><tr>
<td align="center">k</td>
<td align="center">b</td>
<td align="center">r</td>
<td align="center">o</td>
<td align="center">w</td>
<td align="center">n</td>
<td align="center">f</td>
</tr>
<tr>
<td align="center">o</td>
<td align="center">x</td>
<td align="center">j</td>
<td align="center">u</td>
<td align="center">m</td>
<td align="center">p</td>
<td align="center">s</td>
</tr>
<tr>
<td align="center">o</td>
<td align="center">v</td>
<td align="center">e</td>
<td align="center">r</td>
<td align="center">t</td>
<td align="center">h</td>
<td align="center">e</td>
</tr>
<tr>
<td align="center">l</td>
<td align="center">a</td>
<td align="center">z</td>
<td align="center">y</td>
<td align="center">d</td>
<td align="center">o</td>
<td align="center">g</td>
</tr>
</tbody></table>
<p><strong>加密的回路线（事先约定）</strong></p>
<p><img src="/../../images/Ancient/3.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">密文：gesfc inpho dtmwu qoury zejre avxbh Tkool</span><br></pre></td></tr></table></figure>



<h1 id="四、列位移密码"><a href="#四、列位移密码" class="headerlink" title="四、列位移密码"></a>四、列位移密码</h1><p><strong>列移位密码（Columnar Transposition Cipher）是一种比较简单，易于实现的换位密码，通过一个简单的规则将明文打乱混合成密文。</strong></p>
<p>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">明文：The quick brown fox jumps over the lazy dog</span><br></pre></td></tr></table></figure>

<p><strong>填入5行7列的表格（事先约定填充的行列数）</strong></p>
<table>
<thead>
<tr>
<th align="center">T</th>
<th align="center">h</th>
<th align="center">e</th>
<th align="center">q</th>
<th align="center">u</th>
<th align="center">i</th>
<th align="center">c</th>
</tr>
</thead>
<tbody><tr>
<td align="center">k</td>
<td align="center">b</td>
<td align="center">r</td>
<td align="center">o</td>
<td align="center">w</td>
<td align="center">n</td>
<td align="center">f</td>
</tr>
<tr>
<td align="center">o</td>
<td align="center">x</td>
<td align="center">j</td>
<td align="center">u</td>
<td align="center">m</td>
<td align="center">p</td>
<td align="center">s</td>
</tr>
<tr>
<td align="center">o</td>
<td align="center">v</td>
<td align="center">e</td>
<td align="center">r</td>
<td align="center">t</td>
<td align="center">h</td>
<td align="center">e</td>
</tr>
<tr>
<td align="center">l</td>
<td align="center">a</td>
<td align="center">z</td>
<td align="center">y</td>
<td align="center">d</td>
<td align="center">o</td>
<td align="center">g</td>
</tr>
</tbody></table>
<p><strong>选取密钥:</strong> <code>how are u</code></p>
<p>按 <code>how are u</code> 在字母表中的出现的先后顺序进行编号，<strong>我们就有 a 为 1，e 为 2，h 为 3，o 为 4，r 为 5，u 为 6，w 为 7，所以先写出 a 列，其次 e 列，以此类推</strong></p>
<p><img src="/../../images/Ancient/4.png"></p>
<p>最后得到的密文是<code>qoury inpho Tkool hbxva uwmtd cfseg erjez</code></p>
<p>网站：<a href="http://www.practicalcryptography.com/ciphers/classical-era/columnar-transposition/">Practical Cryptography</a></p>
<h1 id="五、01248密码"><a href="#五、01248密码" class="headerlink" title="五、01248密码"></a>五、01248密码</h1><p><strong>01248密码又称云影密码</strong></p>
<h2 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h2><p><strong>使用 0，1，2，4，8 四个数字，其中把0当间隔，被0间隔开的数字进行相加，表示字母A—Z。eg：28代表10，即字母J</strong></p>
<p><strong>这里以2023HDCTF——爬过小山去看云</strong></p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">密文：ymyvzjtxswwktetpyvpfmvcdgywktetpyvpfuedfnzdjsiujvpwktetpyvnzdjpfkjssvacdgywktetpyvnzdjqtincduedfpfkjssne</span><br><span class="line">在山的那头，有3个人，4只鸟，19只羊，11朵云</span><br></pre></td></tr></table></figure>

<p><strong>先将密文进行Hill密码解密，然后得到的密文是：</strong><code>842084210884024084010124</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">842084210884024084010124</span><br><span class="line">把0去掉得到</span><br><span class="line">842 8421 884 24 84 1 124</span><br><span class="line">分别表示 14 15 20 6 12 1 7</span><br><span class="line">表示N O T F L A G</span><br></pre></td></tr></table></figure>

<h3 id="解密脚本"><a href="#解密脚本" class="headerlink" title="解密脚本"></a>解密脚本</h3><p><strong>自己写的解密脚本，可能有错</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cipher = <span class="string">&quot;&quot;</span>                         <span class="comment">#输入密文，密文由01248构成</span></span><br><span class="line">string = cipher.split(<span class="string">&#x27;0&#x27;</span>)			<span class="comment">#以0作为间隔，实现分组</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string:					<span class="comment">#对每组数字进行求和</span></span><br><span class="line">    <span class="built_in">sum</span>=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">        <span class="built_in">sum</span> += <span class="built_in">int</span>(j)				<span class="comment">#int的作用是把字符转成数字</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">sum</span>+<span class="number">64</span>)				<span class="comment">#数字转对应的字母</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="加密脚本"><a href="#加密脚本" class="headerlink" title="加密脚本"></a>加密脚本</h3><p><strong>自己写的，可能有误</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">message = <span class="string">&quot;&quot;</span>                    <span class="comment">#输入要加密的字符串</span></span><br><span class="line">cipher=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">    <span class="built_in">sum</span> = <span class="built_in">ord</span>(i)-<span class="number">64</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">sum</span> &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">sum</span> &gt;= <span class="number">8</span>:</span><br><span class="line">            cipher+=<span class="string">&#x27;8&#x27;</span></span><br><span class="line">            <span class="built_in">sum</span> -= <span class="number">8</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">sum</span> &gt;= <span class="number">4</span>:</span><br><span class="line">            cipher+=<span class="string">&#x27;4&#x27;</span></span><br><span class="line">            <span class="built_in">sum</span> -= <span class="number">4</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">sum</span> &gt;= <span class="number">2</span>:</span><br><span class="line">            cipher+=<span class="string">&#x27;2&#x27;</span></span><br><span class="line">            <span class="built_in">sum</span> -= <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="built_in">sum</span> -= <span class="number">1</span></span><br><span class="line">    cipher += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">           </span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br></pre></td></tr></table></figure>



<h1 id="六、JSFuck"><a href="#六、JSFuck" class="headerlink" title="六、JSFuck"></a>六、JSFuck</h1><h2 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h2><p><strong>JSFuck 可以只用 6 个字符 <code>[]()!+</code> 来编写 JavaScript 程序。比如我们想用 JSFuck 来实现 <code>alert(1)</code> 代码如下</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">[][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]][([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+([][[]]+[])[+[[+!+[]]]]+(![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[+!+[]]]]+([][[]]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]((![]+[])[+[[+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]+(!![]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[+!+[]]]+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+[+!+[]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[+!+[]]]+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])()</span><br></pre></td></tr></table></figure>

<p><strong>这个一点没理解</strong></p>
<h2 id="工具：-1"><a href="#工具：-1" class="headerlink" title="工具："></a>工具：</h2><p><a href="https://jsfuck.com/">JSFuck - Write any JavaScript with 6 Characters: <a href=""></a>!+</a></p>
<h1 id="七、BrainFuck"><a href="#七、BrainFuck" class="headerlink" title="七、BrainFuck"></a>七、BrainFuck</h1><p><strong>一种极小化的计算机语言，下面链接有详解。本人只是浅浅的了解了一下</strong></p>
<p><strong>BrainFuck用</strong><code>&gt; &lt; + - . ，[ ]</code><strong>八种符号替换C语言的各种语法和命令</strong></p>
<p>其含义如下:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; :指针加一</span><br><span class="line">&lt; :指针减一</span><br><span class="line">+ :指针指向字节的值加一</span><br><span class="line">- :指针指向字节的值减一</span><br><span class="line">. :输出指针指向的内容(以ASCII码的形式)</span><br><span class="line">, :输入内容到指针指向的单元</span><br><span class="line">[ :如果指针指向的单元值为零，向后跳转到对应的]指令的次一指令处</span><br><span class="line">] :如果指针指向的单元值不为零，向前跳转到对应的[指令的次一指令处</span><br></pre></td></tr></table></figure>

<p>详细可见下面文章：</p>
<p><a href="https://zhuanlan.zhihu.com/p/44091850">Brainfuck详解 - 知乎 (zhihu.com)</a></p>
<p><a href="https://blog.csdn.net/nameofcsdn/article/details/110231730">(59条消息) Brainfuck语言入门_bf语言_csuzhucong的博客-CSDN博客</a></p>
<h2 id="工具：-2"><a href="#工具：-2" class="headerlink" title="工具："></a>工具：</h2><p>[Brainfuck&#x2F;Ook! Obfuscation&#x2F;Encoding <a href="https://www.splitbrain.org/services/ook">splitbrain.org]</a></p>
<h1 id="八、Ook"><a href="#八、Ook" class="headerlink" title="八、Ook"></a>八、Ook</h1><p><strong>Ook和BrainFuck类似，也是用了替换，Ook只有三个不同的语法：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ook.   Ook?    Ook!</span><br><span class="line">用这三个语法即可表示多种含义：</span><br><span class="line">Ook. Ook?表示：指针加一</span><br><span class="line">Ook? Ook.表示：指针减一</span><br><span class="line">Ook. Ook.表示：指针指向字节的值加1</span><br><span class="line">Ook! Ook!表示：指针指向字节的值减1</span><br><span class="line">Ook. Ook!表示：输入内容到指针指向的单元(以ASCII码的形式)</span><br><span class="line">Ook! Ook.表示：输出指针指向的内容(以ASCII码的形式)</span><br><span class="line">Ook! Ook?表示：如果指针指向的单元值为零，向后跳转到对应的]指令的次一指令处</span><br><span class="line">Ook? Ook!表示：如果指针指向的单元值不为零，向前跳转到对应的[指令的次一指令处</span><br></pre></td></tr></table></figure>

<p>可参考下面文章：<a href="https://www.cnblogs.com/WangAoBo/p/6373318.html">Brainfuck与Ook！编程语言解析与解密 - M4x - 博客园 (cnblogs.com)</a></p>
<h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>[Brainfuck&#x2F;Ook! Obfuscation&#x2F;Encoding <a href="https://www.splitbrain.org/services/ook">splitbrain.org]</a></p>
<h1 id="九、猪圈密码-含变种"><a href="#九、猪圈密码-含变种" class="headerlink" title="九、猪圈密码(含变种)"></a>九、猪圈密码(含变种)</h1><p><strong>根据码表</strong></p>
<p><img src="/../../images/Ancient/5.png"></p>
<p><strong>其来源于</strong></p>
<p><img src="/../../images/Ancient/6.png"></p>
<p>变种</p>
<p><img src="/../../images/Ancient/6.jpg"></p>
<h1 id="十、舞动的小人密码"><a href="#十、舞动的小人密码" class="headerlink" title="十、舞动的小人密码"></a>十、舞动的小人密码</h1><p><img src="/../../images/Ancient/1.jpg"></p>
<p><img src="/../../images/Ancient/8.png"></p>
<h1 id="十一、键盘密码"><a href="#十一、键盘密码" class="headerlink" title="十一、键盘密码"></a>十一、键盘密码</h1><p><strong>键盘密码就是用手机键盘或电脑键盘进行加密的密码</strong></p>
<h2 id="手机键盘密码"><a href="#手机键盘密码" class="headerlink" title="手机键盘密码"></a>手机键盘密码</h2><p><img src="/../../images/Ancient/2.jpg"></p>
<p><strong>关于手机键盘加密还有另一种方式，就是拼音具体参照手机键盘来打，例如：「数字」表示出来就是：748 94。</strong></p>
<h2 id="电脑键盘棋盘"><a href="#电脑键盘棋盘" class="headerlink" title="电脑键盘棋盘"></a>电脑键盘棋盘</h2><p>这个感觉挺怪的</p>
<p><img src="/../../images/Ancient/3.jpg"></p>
<h2 id="电脑键盘坐标"><a href="#电脑键盘坐标" class="headerlink" title="电脑键盘坐标"></a>电脑键盘坐标</h2><p><strong>用字母在电脑键盘上的坐标来表示，比如B表示为35</strong></p>
<h2 id="电脑键盘QWE"><a href="#电脑键盘QWE" class="headerlink" title="电脑键盘QWE"></a>电脑键盘QWE</h2><p><strong>用QWE代表ABC，依次推下去</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">QWERTYUIOP表示ABCDEFGHIJ</span><br><span class="line">ASDFGHJKL表示KLMNOPQRS</span><br><span class="line">ZXCVBNM表示TUVWXYZ</span><br></pre></td></tr></table></figure>

<h2 id="QWE包围"><a href="#QWE包围" class="headerlink" title="QWE包围"></a>QWE包围</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">解密方式：每组密文所围住的按键上的字符</span><br><span class="line">例: yujnbg, 观察键盘发现这六个字母围住了h，故明文为h。</span><br></pre></td></tr></table></figure>



<h2 id="代换"><a href="#代换" class="headerlink" title="代换"></a>代换</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">q,w,e,r,t,y,u,i,o,p,a,s,d,f,g,h,j,k,l,z,x,c,v,b,n,m替换成</span><br><span class="line">a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z</span><br></pre></td></tr></table></figure>



<h1 id="十二、古埃及象形文字"><a href="#十二、古埃及象形文字" class="headerlink" title="十二、古埃及象形文字"></a>十二、古埃及象形文字</h1><p><img src="/../../images/Ancient/7.png"></p>
<h1 id="十三、宝可梦图腾"><a href="#十三、宝可梦图腾" class="headerlink" title="十三、宝可梦图腾"></a>十三、宝可梦图腾</h1><p><img src="/../../images/Ancient/4.jpg"></p>
<h1 id="十四、精灵语"><a href="#十四、精灵语" class="headerlink" title="十四、精灵语"></a>十四、精灵语</h1><p><img src="/../../images/Ancient/5.jpg"></p>
<h1 id="十五、古精灵语"><a href="#十五、古精灵语" class="headerlink" title="十五、古精灵语"></a>十五、古精灵语</h1><p><img src="/../../images/Ancient/1.webp"></p>
<p><img src="/../../images/Ancient/7.jpg"></p>
<h1 id="十六、夏多密码"><a href="#十六、夏多密码" class="headerlink" title="十六、夏多密码"></a>十六、夏多密码</h1><p><strong>夏多密码又称曲路密码</strong></p>
<p><img src="/../../images/Ancient/9.png"></p>
<h1 id="十七、圣堂武士密码"><a href="#十七、圣堂武士密码" class="headerlink" title="十七、圣堂武士密码"></a>十七、圣堂武士密码</h1><p><img src="/../../images/Ancient/10.png"></p>
<h1 id="十八、盲文"><a href="#十八、盲文" class="headerlink" title="十八、盲文"></a>十八、盲文</h1><p><img src="/../../images/Ancient/11.png"></p>
<h1 id="十九、外星人密码"><a href="#十九、外星人密码" class="headerlink" title="十九、外星人密码"></a>十九、外星人密码</h1><p><img src="/../../images/Ancient/12.png"></p>
<h1 id="二十、音乐密码"><a href="#二十、音乐密码" class="headerlink" title="二十、音乐密码"></a>二十、音乐密码</h1><p><img src="/../../images/Ancient/13.png"></p>
<h1 id="二十一、标准银河密码"><a href="#二十一、标准银河密码" class="headerlink" title="二十一、标准银河密码"></a>二十一、标准银河密码</h1><p><img src="/../../images/Ancient/0.webp"></p>
<h1 id="二十二、天干地支表"><a href="#二十二、天干地支表" class="headerlink" title="二十二、天干地支表"></a>二十二、天干地支表</h1><p><img src="/../../images/Ancient/14.png"></p>
<h1 id="二十三、摩斯密码"><a href="#二十三、摩斯密码" class="headerlink" title="二十三、摩斯密码"></a>二十三、摩斯密码</h1><p><img src="/../../images/Ancient/15.png"></p>
<p>在线解密：<a href="https://www.matools.com/morse">在线摩斯电码 - 码工具 (matools.com)</a></p>
<h1 id="二十四、玛雅数字"><a href="#二十四、玛雅数字" class="headerlink" title="二十四、玛雅数字"></a>二十四、玛雅数字</h1><p>这个是自己在做题的时候积累的</p>
<p><img src="/../../images/Ancient/16.png"></p>
]]></content>
      <categories>
        <category>古典密码学</category>
      </categories>
      <tags>
        <tag>古典密码</tag>
        <tag>其他密码</tag>
      </tags>
  </entry>
  <entry>
    <title>OTP(一次一密加密法)</title>
    <url>/2023/07/05/%E6%B5%81%E5%AF%86%E7%A0%81/OTP-%E4%B8%80%E6%AC%A1%E4%B8%80%E5%AF%86-%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<p><strong>简述一下OPT</strong></p>
<span id="more"></span>



<p><strong>OPT又叫一次一密加密方式</strong></p>
<p>简单了解一下该加密方式：<br>$$<br>密文C &#x3D; 密钥K \oplus 明文M<br>$$<br>显而易见，解密方式即是：<br>$$<br>明文M &#x3D; 密钥K \oplus 密文C<br>$$<br><strong>需要注意的是，密钥是一个和密文等长的二进制字符串</strong></p>
<p>这里给出一道例题，来自LitCTF2023——隐晦的消息记录</p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">出题人:6c73d5240a948c86981bc294814d</span><br><span class="line">某不知名收件人：收到消息attack at dawn</span><br><span class="line">出题人:xxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">某不知名收件人：收到消息Monday or Thur</span><br><span class="line">已知出题人和收件人手中的密钥相同，请解出出题人第二次发送的密文呢（16进制，字母小写，解得的结果记得要加上LitCTF&#123;&#125;哦。）</span><br></pre></td></tr></table></figure>

<p>根据题目提示，知道这是OPT加密，了解一下原理之后就知道该加密方式是通过异或实现的</p>
<p>只要把密文和密钥进行异或就能得到明文</p>
<p><strong>首先把 <code>attack at dawn</code>转成16进制，再和<code>6c73d5240a948c86981bc294814d</code>进行异或，即可得到密钥，因为两次密钥相同，所以把<code>Monday or Thur</code>和密钥异或，就是我们要的密文</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ciphertext1 = <span class="number">0x6c73d5240a948c86981bc294814d</span>    <span class="comment">#   attack at dawn转16进制后</span></span><br><span class="line">plaintext1 = <span class="number">0x61747461636b206174206461776e</span></span><br><span class="line"></span><br><span class="line">key = ciphertext1 ^ plaintext1</span><br><span class="line"></span><br><span class="line"><span class="comment">#   key = 0xd07a14569fface7ec3ba6f5f623</span></span><br><span class="line"></span><br><span class="line">plaintext2 = <span class="number">0x4d6f6e646179206f722054687572</span>      <span class="comment">#  Monday or Thur转16进制后</span></span><br><span class="line"></span><br><span class="line">ciphertext2 = key ^ plaintext2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(ciphertext2))</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;4068cf2108868c889e1bf29d8351&#125;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>现代密码-流密码</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>流密码</tag>
        <tag>OTP</tag>
      </tags>
  </entry>
  <entry>
    <title>AES</title>
    <url>/2023/07/23/%E5%9D%97%E5%AF%86%E7%A0%81/AES/</url>
    <content><![CDATA[<p>浅浅学习一下AES加密的几种模式</p>
<span id="more"></span>



<p><strong>AES加密只能加密128bit的块，如果明文长度不足128bit，那就需要进行填充</strong></p>
<p><strong>CTR模式不需要填充</strong></p>
<h1 id="ECB模式"><a href="#ECB模式" class="headerlink" title="ECB模式"></a>ECB模式</h1><p><strong>电码本模式，ECB (Electronic Codebook Book)</strong></p>
<p>ECB模式加解密流程：</p>
<p><img src="/../../images/AES/ECB.png"></p>
<p><strong>ECB模式首先要_把明文分块，然后用相同的加密方式和密钥进行加密，这就会导致同样的明文加密后得到的是同样的密文</strong><br>$$<br>设明文分块为x_i,密钥为key,加密函数为E_k,解密函数为D_k<br>$$</p>
<p>$$<br>\therefore 加密后的密文c_i &#x3D; E_k(x_i)<br>$$</p>
<p>$$<br>解密：<br>$$</p>
<p>$$<br>m_i &#x3D; D_k(c_i)<br>$$</p>
<p><strong>使用Cipher库里有加解密ECB的例子：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = random.getrandbits(<span class="number">128</span>)</span><br><span class="line">key = long_to_bytes(key)</span><br><span class="line"></span><br><span class="line">aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">m = <span class="string">b&#x27;abcdefghijklmnop&#x27;</span></span><br><span class="line"></span><br><span class="line">c = aes.encrypt(m)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">plaintext = aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br></pre></td></tr></table></figure>

<p><strong>值得注意的是，明文m和密钥key的长度必须是16的倍数</strong></p>
<h2 id="SWPU2020-ECB"><a href="#SWPU2020-ECB" class="headerlink" title="SWPU2020 ECB"></a>SWPU2020 ECB</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">BLOCKSIZE = <span class="number">16</span></span><br><span class="line">flag = os.environ[<span class="string">&#x27;FLAG&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">data</span>):</span><br><span class="line">        pad_len = BLOCKSIZE - (<span class="built_in">len</span>(data) % BLOCKSIZE) <span class="keyword">if</span>  <span class="built_in">len</span>(data) % BLOCKSIZE != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> data + <span class="built_in">chr</span>(pad_len) * pad_len</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unpad</span>(<span class="params">data</span>):</span><br><span class="line">        num = <span class="built_in">ord</span>(data[-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> data[:-num]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">data,key</span>):</span><br><span class="line">	cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">	encrypt = cipher.encrypt(pad(data))</span><br><span class="line">	<span class="keyword">return</span> encrypt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">data,key</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">		encrypt = cipher.decrypt(data)</span><br><span class="line">		<span class="keyword">return</span> unpad(encrypt)</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task</span>():</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">                key = os.urandom(<span class="number">16</span>)</span><br><span class="line">                <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                        plaintext = raw_input(<span class="string">&quot;Amazing function: &quot;</span>).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">                        yusa = plaintext+flag</span><br><span class="line">                        <span class="built_in">print</span> enc(yusa,key).encode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span> <span class="built_in">str</span>(e)</span><br><span class="line">                exit()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">        task()</span><br></pre></td></tr></table></figure>

<p>通过输入几次数据判断flag长度大概为44</p>
<p>根据ECB加密的特性。</p>
<p>输入<code>b&#39;00&#39;×47</code> （服务器把16进制转成byte数据，2个16进制数据变成一个byte），服务器会返回<code>b&#39;00&#39;×47</code>+<code>flag[0]</code>的密文</p>
<p>我们多次输入<code>b&#39;00&#39;×47</code>+<code>chr(i)</code></p>
<p>如果获得同样的密文，那么这个<code>chr(i)</code>就是<code>flag[0]</code></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;node5.anna.nssctf.cn&#x27;</span>                  </span><br><span class="line">port =  <span class="number">28632</span></span><br><span class="line"></span><br><span class="line">sh = remote(host,port)</span><br><span class="line"></span><br><span class="line">n = <span class="string">b&quot;00&quot;</span> * <span class="number">47</span></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">44</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Amazing function: &quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;00&quot;</span>*(<span class="number">47</span>-i))</span><br><span class="line">    c = sh.recvline().decode()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x11</span>,<span class="number">0xff</span>):</span><br><span class="line">        data = sh.recvuntil(<span class="string">b&quot;Amazing function: &quot;</span>)</span><br><span class="line">        sh.sendline(n+ <span class="built_in">hex</span>(j)[<span class="number">2</span>:].encode())</span><br><span class="line">        m = sh.recvline().decode()</span><br><span class="line">        <span class="keyword">if</span> m[:<span class="number">96</span>] == c[:<span class="number">96</span>]:</span><br><span class="line">            flag += long_to_bytes(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            n = n[<span class="number">2</span>:] + <span class="built_in">hex</span>(j)[<span class="number">2</span>:].encode()</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>





<h1 id="CBC模式"><a href="#CBC模式" class="headerlink" title="CBC模式"></a>CBC模式</h1><p><strong>密码分组链接模式，CBC(Cipher Block Chaining)</strong></p>
<p><img src="/../../images/AES/CBC.png"></p>
<p><strong>在CBC模式中，每个明文块先与前一个密文块进行异或后，再进行ECB加密后得到密文分组。对于第一块明文，引入初始向量</strong><code>iv</code><strong>这个概念</strong></p>
<p><strong>每个明文块应该是128bit,或者128的倍数</strong></p>
<p><strong>python实现</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line">iv = random.getrandbits(<span class="number">128</span>)</span><br><span class="line">iv = long_to_bytes(iv)</span><br><span class="line">key = random.getrandbits(<span class="number">128</span>)</span><br><span class="line">key = long_to_bytes(key)</span><br><span class="line"><span class="built_in">print</span>(key,iv,sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">m = <span class="string">b&#x27;abcdefghijklmnop&#x27;</span></span><br><span class="line">c = aes.encrypt(m)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">key = <span class="string">b&#x27;\xd4\xc5\x0f\xf3\x89\xd3[\x94\xbc\xde\xacds\xae\xf3\x1b&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;\xf0\x90\xd1\x99\r\xb1\xa7\x81\xa8\xae\xbbQ\xec\xaa\xef\x10&#x27;</span></span><br><span class="line">c = <span class="string">b&#x27;\x95&#123;\x80\xffS\x14L^\x9e?\x08~y\nH1&#x27;</span></span><br><span class="line"></span><br><span class="line">decryption = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">plaintext = decryption.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br></pre></td></tr></table></figure>



<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">import os</span><br><span class="line">iv = os.urandom(16)</span><br><span class="line">key = os.urandom(16)</span><br><span class="line">my_aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">flag += (16 - len(flag) % 16) * b&#x27;\x00&#x27;</span><br><span class="line">c = my_aes.encrypt(flag)</span><br><span class="line">print(list(c), list(iv), list(key))</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">[137, 163, 60, 145, 236, 127, 76, 5, 212, 171, 46, 211, 161, 172, 41, 198, 117, 247, 140, 226, 169, 248, 208, 245, 214, 44, 180, 9, 170, 59, 205, 234] [138, 237, 90, 59, 60, 190, 103, 179, 137, 128, 10, 206, 237, 10, 183, 174] [170, 90, 227, 119, 123, 155, 185, 38, 148, 37, 159, 42, 221, 36, 2, 57]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>这里已经给出密文，初始向量，密钥。只需把他们先转成byte，然后再按流程解密</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">iv = [<span class="number">138</span>, <span class="number">237</span>, <span class="number">90</span>, <span class="number">59</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">103</span>, <span class="number">179</span>, <span class="number">137</span>, <span class="number">128</span>, <span class="number">10</span>, <span class="number">206</span>, <span class="number">237</span>, <span class="number">10</span>, <span class="number">183</span>, <span class="number">174</span>]</span><br><span class="line">key = [<span class="number">170</span>, <span class="number">90</span>, <span class="number">227</span>, <span class="number">119</span>, <span class="number">123</span>, <span class="number">155</span>, <span class="number">185</span>, <span class="number">38</span>, <span class="number">148</span>, <span class="number">37</span>, <span class="number">159</span>, <span class="number">42</span>, <span class="number">221</span>, <span class="number">36</span>, <span class="number">2</span>, <span class="number">57</span>]</span><br><span class="line">c = [<span class="number">137</span>, <span class="number">163</span>, <span class="number">60</span>, <span class="number">145</span>, <span class="number">236</span>, <span class="number">127</span>, <span class="number">76</span>, <span class="number">5</span>, <span class="number">212</span>, <span class="number">171</span>, <span class="number">46</span>, <span class="number">211</span>, <span class="number">161</span>, <span class="number">172</span>, <span class="number">41</span>, <span class="number">198</span>, <span class="number">117</span>, <span class="number">247</span>, <span class="number">140</span>, <span class="number">226</span>, <span class="number">169</span>, <span class="number">248</span>, <span class="number">208</span>, <span class="number">245</span>, <span class="number">214</span>, <span class="number">44</span>, <span class="number">180</span>, <span class="number">9</span>, <span class="number">170</span>, <span class="number">59</span>, <span class="number">205</span>, <span class="number">234</span>] </span><br><span class="line"></span><br><span class="line">Iv = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">Key = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">C = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> iv:</span><br><span class="line">    Iv += long_to_bytes(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key:</span><br><span class="line">    Key += long_to_bytes(i)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    C += long_to_bytes(i)</span><br><span class="line"></span><br><span class="line">DecryptKey = AES.new(Key,AES.MODE_CBC,Iv)</span><br><span class="line">flag = DecryptKey.decrypt(C)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="HNCTF-2022-WEEK3-AES"><a href="#HNCTF-2022-WEEK3-AES" class="headerlink" title="[HNCTF 2022 WEEK3]AES"></a>[HNCTF 2022 WEEK3]AES</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cbc_encrypt</span>(<span class="params">msg: <span class="built_in">bytes</span></span>):</span><br><span class="line">    msg = pad(msg, <span class="number">16</span>)</span><br><span class="line">    msg = [msg[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg), <span class="number">16</span>)]</span><br><span class="line">    key = urandom(<span class="number">16</span>)</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> msg:</span><br><span class="line">        cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">        <span class="built_in">next</span> = cipher.encrypt(block)</span><br><span class="line">        out.append(<span class="built_in">next</span>)</span><br><span class="line">        key = <span class="built_in">next</span></span><br><span class="line">    out = <span class="string">b&quot;&quot;</span>.join(out)</span><br><span class="line">    <span class="keyword">return</span> key, out</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key, ct = cbc_encrypt(flag*<span class="number">3</span>)</span><br><span class="line">    <span class="comment"># print(f&quot;flag = &#123;flag&#125;&quot;)</span></span><br><span class="line">    <span class="comment"># print(f&quot;key = &#123;key&#125;&quot;)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ct = <span class="subst">&#123;ct&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">ct = b&#x27;\x179\xb8l\x97\xbew\xc2\xd5f~\x8e\xdc\xf2\x9b\xabR\xa9a\xd2\xf4\xde\xd6|\xd1\x9f\xe9q\x1d\xfcm\xfbj\xe9\x9e\xab\xf5fL\xb3\xb5_\xa5\x16\x8e\x7f\x9fV`\x8b\x16\xa1\xa6)\x08\x97\x91\xbd3\x1d\xeb\\\x86\xa2\xd6\x94&gt;\xf3\xfdt\xd9\x14\xf3\xfc\xe2\x02\xd6\xc4\xcfq&quot;\x1a\x14~2]4\x9f\xc9\x88\xf8\x12\xb6\xa2\xd7\xec\x0b\x7f\xd4d\xdc\xc6\xb4]\x10u\xc6f\x97m\xccA\x82\x02\xa5gh\x85\x85Wz\xd9.\xff\x9bx\x99J\x0e\x86\x16\x90\xad\x1e\x17\x86\x95\xb8S\x17\xea\x93v\xd0&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>msg = pad(msg, 16)</code>，将msg填充为16的倍数</p>
<p><code>msg = [msg[i:i+16] for i in range(0, len(msg), 16)]</code>，将msg分为每组16字节</p>
<p><code>    key = urandom(16)</code>，随机生成一个16字节的加密密钥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for block in msg:</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    next = cipher.encrypt(block)</span><br><span class="line">    out.append(next)</span><br><span class="line">    key = next</span><br><span class="line">out = b&quot;&quot;.join(out)</span><br><span class="line">return key, out</span><br></pre></td></tr></table></figure>

<p>对每组明文进行ECB加密，并且将加密后的密文作为下一组加密的密钥。我们除了第一组密文无法解密，其他密文都可以解出</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">ct = <span class="string">b&#x27;\x179\xb8l\x97\xbew\xc2\xd5f~\x8e\xdc\xf2\x9b\xabR\xa9a\xd2\xf4\xde\xd6|\xd1\x9f\xe9q\x1d\xfcm\xfbj\xe9\x9e\xab\xf5fL\xb3\xb5_\xa5\x16\x8e\x7f\x9fV`\x8b\x16\xa1\xa6)\x08\x97\x91\xbd3\x1d\xeb\\\x86\xa2\xd6\x94&gt;\xf3\xfdt\xd9\x14\xf3\xfc\xe2\x02\xd6\xc4\xcfq&quot;\x1a\x14~2]4\x9f\xc9\x88\xf8\x12\xb6\xa2\xd7\xec\x0b\x7f\xd4d\xdc\xc6\xb4]\x10u\xc6f\x97m\xccA\x82\x02\xa5gh\x85\x85Wz\xd9.\xff\x9bx\x99J\x0e\x86\x16\x90\xad\x1e\x17\x86\x95\xb8S\x17\xea\x93v\xd0&#x27;</span></span><br><span class="line">ct = [ct[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ct), <span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">plain = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(ct)):</span><br><span class="line">    cipher = AES.new(ct[i-<span class="number">1</span>], AES.MODE_ECB)</span><br><span class="line">    plain += cipher.decrypt(ct[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure>

<h2 id="安洵杯-2020-easyaes"><a href="#安洵杯-2020-easyaes" class="headerlink" title="[安洵杯 2020]easyaes"></a>[安洵杯 2020]easyaes</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> key</span><br><span class="line"></span><br><span class="line">iv = flag.strip(<span class="string">b&#x27;d0g3&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">LENGTH = <span class="built_in">len</span>(key)</span><br><span class="line"><span class="keyword">assert</span> LENGTH == <span class="number">16</span></span><br><span class="line"></span><br><span class="line">hint = os.urandom(<span class="number">4</span>) * <span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(hint)^bytes_to_long(key))</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b&#x27;Welcome to this competition, I hope you can have fun today!!!!!!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypto</span>(<span class="params">message</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(message)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(binascii.hexlify(encrypto(msg))[-<span class="number">32</span>:])</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">56631233292325412205528754798133970783633216936302049893130220461139160682777</span></span><br><span class="line"><span class="string">b&#x27;3c976c92aff4095a23e885b195077b66&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>求初始向量</p>
<p>首先注意到$key$和$hint$的长度不符，所以给的$hint$中有一半是原来<code>os.urandom(4)</code>的值。</p>
<p>可以通过这一特点恢复$key$</p>
<p>然后依次求前一块密文，最后求得iv</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line">tmp = <span class="number">56631233292325412205528754798133970783633216936302049893130220461139160682777</span></span><br><span class="line"><span class="comment">#print(long_to_bytes(tmp))</span></span><br><span class="line">hint = <span class="string">b&#x27;&#125;4$d&#x27;</span>*<span class="number">8</span></span><br><span class="line"></span><br><span class="line">key = long_to_bytes(tmp^bytes_to_long(hint))</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b&#x27;Welcome to this competition, I hope you can have fun today!!!!!!&#x27;</span></span><br><span class="line">cipher = <span class="string">&#x27;3c976c92aff4095a23e885b195077b66&#x27;</span></span><br><span class="line">c4 = <span class="built_in">bytes</span>.fromhex(cipher)</span><br><span class="line"></span><br><span class="line">msgblock = [msg[i*<span class="number">16</span>:(i+<span class="number">1</span>)*<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(msg)//<span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> aes.decrypt(c)</span><br><span class="line"></span><br><span class="line">c3 = xor(decrypt(c4),msgblock[<span class="number">3</span>])</span><br><span class="line">c2 = xor(decrypt(c3),msgblock[<span class="number">2</span>])</span><br><span class="line">c1 = xor(decrypt(c2),msgblock[<span class="number">1</span>])</span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;&#x27;</span> + xor(decrypt(c1),msgblock[<span class="number">0</span>]) + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>





<h1 id="CTR模式"><a href="#CTR模式" class="headerlink" title="CTR模式"></a>CTR模式</h1><p><strong>计算器模式，CTR（Counter）</strong></p>
<p><img src="/../../images/AES/CTR.png"></p>
<p><strong>在CTR模式中</strong><code>COUNTER</code><strong>是整个CTR模式的核心所在。它是由IV经过一定的规则之后生成的一段数据，长度与数据块的长度相等</strong></p>
<p><code>COUNTER</code><strong>通过ECB加密后得到一个</strong><code>COUNTER</code><strong>的密文，再和明文1进行异或得到密文1。在加密结束后</strong><code>COUNTER</code><strong>的值加1，然后再次用ECB加密，依次加密</strong></p>
<p>加密example：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"></span><br><span class="line">data = <span class="string">b&quot;secret&quot;</span></span><br><span class="line">key = get_random_bytes(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key, AES.MODE_CTR)</span><br><span class="line">ct_bytes = cipher.encrypt(data)</span><br><span class="line">nonce = b64encode(cipher.nonce).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">ct = b64encode(ct_bytes).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">result = json.dumps(&#123;<span class="string">&#x27;nonce&#x27;</span>:nonce, <span class="string">&#x27;ciphertext&#x27;</span>:ct&#125;)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line">&#123;<span class="string">&quot;nonce&quot;</span>: <span class="string">&quot;XqP8WbylRt0=&quot;</span>, <span class="string">&quot;ciphertext&quot;</span>: <span class="string">&quot;Mie5lqje&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>解密:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># We assume that the key was securely shared beforehand</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    b64 = json.loads(json_input)</span><br><span class="line">    nonce = b64decode(b64[<span class="string">&#x27;nonce&#x27;</span>])</span><br><span class="line">    ct = b64decode(b64[<span class="string">&#x27;ciphertext&#x27;</span>])</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CTR, nonce=nonce)</span><br><span class="line">    pt = cipher.decrypt(ct)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;The message was: &quot;</span>, pt)</span><br><span class="line"><span class="keyword">except</span> (ValueError, KeyError):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Incorrect decryption&quot;</span>)</span><br></pre></td></tr></table></figure>



<p><strong>这里给道ECB和CTR结合的题目</strong></p>
<h2 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from Crypto.Util import Counter</span><br><span class="line">from hashlib import sha256</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def padding(msg):</span><br><span class="line">    return msg + os.urandom(16 - len(msg) % 16)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msg = b&quot;where is the flag? Key in my Heart/Counter!!!!&quot;</span><br><span class="line">key = b&quot;I w0nder how????&quot;</span><br><span class="line"></span><br><span class="line">assert len(msg) == 46</span><br><span class="line">assert len(key) == 16</span><br><span class="line"></span><br><span class="line">enc_key = os.urandom(16)</span><br><span class="line">initial_value = bytes_to_long(enc_key)</span><br><span class="line">hash = sha256(str(initial_value).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">aes = AES.new(enc_key, AES.MODE_ECB)</span><br><span class="line">enc_flag = aes.encrypt(padding(flag))</span><br><span class="line"></span><br><span class="line">ctr = Counter.new(AES.block_size * 8, initial_value=initial_value)</span><br><span class="line">aes = AES.new(key, counter=ctr, mode=AES.MODE_CTR)</span><br><span class="line">enc = aes.encrypt(msg)</span><br><span class="line"></span><br><span class="line">print(&quot;enc = &#123;&#125;&quot;.format(enc[-16:]))</span><br><span class="line">print(&quot;enc_flag = &#123;&#125;&quot;.format(enc_flag))</span><br><span class="line">print(&quot;hash = &#123;&#125;&quot;.format(hash))</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">enc = b&#x27;\xbe\x9bd\xc6\xd4=\x8c\xe4\x95bi\xbc\xe01\x0e\xb8&#x27;</span><br><span class="line">enc_flag = b&#x27;\xb2\x97\x83\x1dB\x13\x9b\xc2\x97\x9a\xa6+M\x19\xd74\xd2-\xc0\xb6\xba\xe8ZE\x0b:\x14\xed\xec!\xa1\x92\xdfZ\xb0\xbd\xb4M\xb1\x14\xea\xd8\xee\xbf\x83\x16g\xfa&#x27;</span><br><span class="line">hash = efb07225b3f1993113e104757210261083c79de50f577b3f0564368ee7b25eeb</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><code>flag</code><strong>是用</strong><code>enc_key</code><strong>再用ECB模式加密的，我们的目的就是求出</strong><code>enc_key</code></p>
<p><strong>而</strong><code>enc_key</code><strong>和</strong><code>counter</code><strong>有关，所以我们需要求出</strong><code>counter</code><strong>的末值，再往前倒</strong></p>
<p><strong>先把msg分组，msg的长度是46，分为16，16，14三组</strong></p>
<p><strong>通过msg的后14位和enc的后14位进行异或得到加密后的</strong><code>enc_counter</code></p>
<p>这里需要注意的是：<strong>counter是通过ECB加密的</strong>，<strong>解出</strong><code>counter</code> <strong>之后，减去2就是初始的</strong><code>counter</code><strong>也就是</strong><code>initial_value</code></p>
<p><strong>解</strong><code>enc_counter</code><strong>的时候要填充，因为他只有14字节，要填充为16字节</strong></p>
<p><strong>得到</strong><code>initila_value</code><strong>之后就有了加密flag的</strong><code>enc_key</code><strong>，然后就是解ECB得到flag</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;I w0nder how????&quot;</span></span><br><span class="line">msg = <span class="string">b&quot;where is the flag? Key in my Heart/Counter!!!!&quot;</span></span><br><span class="line">enc = <span class="string">b&#x27;\xbe\x9bd\xc6\xd4=\x8c\xe4\x95bi\xbc\xe01\x0e\xb8&#x27;</span></span><br><span class="line">enc_flag = <span class="string">b&#x27;\xb2\x97\x83\x1dB\x13\x9b\xc2\x97\x9a\xa6+M\x19\xd74\xd2-\xc0\xb6\xba\xe8ZE\x0b:\x14\xed\xec!\xa1\x92\xdfZ\xb0\xbd\xb4M\xb1\x14\xea\xd8\xee\xbf\x83\x16g\xfa&#x27;</span></span><br><span class="line"><span class="built_in">hash</span> = <span class="string">&#x27;efb07225b3f1993113e104757210261083c79de50f577b3f0564368ee7b25eeb&#x27;</span></span><br><span class="line"></span><br><span class="line">enc_counter = strxor(msg[-<span class="number">14</span>:],enc[-<span class="number">14</span>:])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">8</span>,<span class="number">2</span>**<span class="number">16</span>):         <span class="comment">#因为差了2个字节，就是2的8次方到2的16次方之间</span></span><br><span class="line">    pad = long_to_bytes(i)</span><br><span class="line">    Enc_counter = enc_counter + pad     <span class="comment">#填充之后再解</span></span><br><span class="line"></span><br><span class="line">    aes_ecb = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    counter = aes_ecb.decrypt(Enc_counter)</span><br><span class="line">    initial_counter = bytes_to_long(counter) - <span class="number">2</span></span><br><span class="line">    hash_counter = sha256(<span class="built_in">str</span>(initial_counter).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> hash_counter == <span class="built_in">hash</span>:</span><br><span class="line">        enc_key = long_to_bytes(initial_counter)</span><br><span class="line">        ECB = AES.new(enc_key,AES.MODE_ECB)</span><br><span class="line">        flag = ECB.decrypt(enc_flag)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>现代密码-对称加密</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>对称加密</tag>
        <tag>AES</tag>
      </tags>
  </entry>
  <entry>
    <title>MTP-多次加密</title>
    <url>/2023/07/24/%E6%B5%81%E5%AF%86%E7%A0%81/MTP-%E5%A4%9A%E6%AC%A1%E5%8A%A0%E5%AF%86/</url>
    <content><![CDATA[<p>简述多次加密法(MTP)</p>
<span id="more"></span>

<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p><strong>MTP(Many-Time-Pad)，其加密方式和OTP是一样的，都是使用简单的异或操作。</strong></p>
<p><strong>不同之处在于OTP是用不同的</strong><code>key</code><strong>异或不同的</strong><code>明文</code><strong>。而MTP是用同一个</strong><code>key</code><strong>去异或多个</strong><code>明文</code></p>
<p>详细见：<a href="https://www.ruanx.net/many-time-pad/">Many-Time-Pad 攻击 (ruanx.net)</a></p>
<h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><p>先附上脚本:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line"><span class="comment">#这里传密文</span></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;Problem.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line">know(<span class="number">10</span>, <span class="number">21</span>, <span class="string">&#x27;y&#x27;</span>)	<span class="comment">#如果需要修正， 传入所在被改字母所在行和列，再输入替代的字母,例如alwa s 改为always</span></span><br><span class="line">know(<span class="number">8</span>, <span class="number">14</span>, <span class="string">&#x27;n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line"></span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure>



<h1 id="例题-BUUCTF—AFCTF2018—你听过一次一密吗？"><a href="#例题-BUUCTF—AFCTF2018—你听过一次一密吗？" class="headerlink" title="例题 BUUCTF—AFCTF2018—你听过一次一密吗？"></a>例题 BUUCTF—AFCTF2018—你听过一次一密吗？</h1><p>例题中改动的数据来源于<a href="https://www.ruanx.net/many-time-pad/">Many-Time-Pad 攻击 (ruanx.net)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">(原题有bug, 笔者有少量改动)</span><br><span class="line">25030206463d3d393131555f7f1d061d4052111a19544e2e5d54</span><br><span class="line">0f020606150f203f307f5c0a7f24070747130e16545000035d54</span><br><span class="line">1203075429152a7020365c167f390f1013170b1006481e13144e</span><br><span class="line">0f4610170e1e2235787f7853372c0f065752111b15454e0e0901</span><br><span class="line">081543000e1e6f3f3a3348533a270d064a02111a1b5f4e0a1855</span><br><span class="line">0909075412132e247436425332281a1c561f04071d520f0b1158</span><br><span class="line">4116111b101e2170203011113a69001b47520601155205021901</span><br><span class="line">041006064612297020375453342c17545a01451811411a470e44</span><br><span class="line">021311114a5b0335207f7c167f22001b44520c15544801125d40</span><br><span class="line">06140611460c26243c7f5c167f3d015446010053005907145d44</span><br><span class="line">0f05110d160f263f3a7f4210372c03111313090415481d49530f</span><br></pre></td></tr></table></figure>

<p>$$<br>上述的每个字符串C_i都是某个密钥key\oplus 明文M_i得到的。<br>$$</p>
<p>我们的目标是获取这个<code>key</code><br>$$<br>\because C_1 &#x3D; M_1 \oplus key<br>$$<br>$$<br>C_2 &#x3D; M_2 \oplus key<br>$$</p>
<p>$$<br>\therefore C_1 \oplus C_2 &#x3D; (M_1 \oplus key)\oplus (M_2 \oplus key)&#x3D;M_1 \oplus M_2<br>$$</p>
<p>这表明，两个密文的异或，就等于对应明文的异或。这是很危险的性质，高明的攻击者可以通过频率分析，来破译这些密文。</p>
<p>我们来看字符串 <code>C1</code>异或上其他密文会得到什么东西。以下只保留了英文字符，其余字符以 <code>.</code> 代替</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">....S....N.U.....A..M.N...</span><br><span class="line">...Ro..I...I....SE....P.I.</span><br><span class="line">.E..H...IN..H...........TU</span><br><span class="line">..A.H.R.....E....P......E.</span><br><span class="line">...RT...E...M....M....A.L.</span><br><span class="line">d...V..I..DNEt........K.DU</span><br><span class="line">.......I....K..I.ST...TiS.</span><br><span class="line">.....f...N.I........M.O...</span><br><span class="line">.........N.I...I.S.I..I...</span><br><span class="line">....P....N.OH...SA....Sg..</span><br></pre></td></tr></table></figure>

<p>可以观察到，有些列上有大量的英文字符，有些列一个英文字符都没有。这是偶然现象吗？</p>
<h2 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h2><p><img src="/../../images/MTP/0.png"></p>
<p>对照ASCII码表</p>
<p>因为<code>空格</code>的ASCII码值是<code>32</code>，再观察大写字母和小写字母</p>
<p>我们可以发现小写字母 <code>xor </code>空格，会得到对应的大写字母；大写字母 <code>xor </code>空格，会得到小写字母！</p>
<p>所以，如果<code>x xor y</code> 得到一个英文字母，那么，<code>x,y</code>中某一个很大概率是空格<br>$$<br>回头看上面C_1 \oplus 其他密文——也就等于 M_1 \oplus 其他明文的表<br>$$</p>
<p>$$<br>如果第col列存在大量的英文字母，我们可以猜测M_1[col]是一个空格。<br>$$</p>
<p>$$<br>哪一列英文字母越多，把握越大。<br>$$</p>
<p>$$<br>\color{red}知道M_1的第col位是空格有什么用？<br>$$</p>
<p>$$<br>\because 一个数异或0还是等于本身,即0 &#x3D; a \oplus a<br>$$</p>
<p>$$<br>\therefore 	M_i[col] &#x3D; M_i[col] \oplus 0 &#x3D; M_i[col] \oplus M_1[col] \oplus M_1[col]&#x3D;M_i[col] \oplus M_1[col] \oplus 32<br>$$</p>
<h1 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h1><p><strong>攻击原理还是没理解很明白</strong></p>
<p>攻击过程显而易见：对于每一条密文<code>Ci</code>，拿去异或其他所有密文。然后去数每一列有多少个英文字符，作为“<code>Mi</code></p>
<p>在这一位是空格“的评分。</p>
<p>上面的事情做完时候，依据评分从大到小排序，依次利用 “某个明文的某一位是空格” 这种信息恢复出所有明文的那一列。如果产生冲突，则舍弃掉评分小的。</p>
<p><strong>下面附上大佬写的脚本以及思路</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line"><span class="comment">#c = 密文           </span></span><br><span class="line"><span class="comment">#c = [codecs.decode(x.strip().encode(), &#x27;hex&#x27;) for x in open(&#x27;Problem.txt&#x27;, &#x27;r&#x27;).readlines()]</span></span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br></pre></td></tr></table></figure>

<p>执行代码，得到的结果是：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Dear Friend, T%is tim&lt; I u</span><br><span class="line">nderstood my m$stake 8nd u</span><br><span class="line">sed One time p,d encr ptio</span><br><span class="line">n scheme, I he,rd tha- it </span><br><span class="line">is the only en.ryptio7 met</span><br><span class="line">hod that is ma9hemati:ally</span><br><span class="line"> proven to be #ot cra:ked </span><br><span class="line">ever if the ke4 is ke)t se</span><br><span class="line">cure, Let Me k#ow if  ou a</span><br><span class="line">gree with me t&quot; use t1is e</span><br><span class="line">ncryption sche e alwa s...</span><br></pre></td></tr></table></figure>

<p>显然这不是最终结果，我们得修正几项。把 <code>k#now</code> 修复成 <code>know</code>，把 <code>alwa s</code> 修复成 <code>always</code>. 代码如下：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line">know(<span class="number">10</span>, <span class="number">21</span>, <span class="string">&#x27;y&#x27;</span>)	<span class="comment">#这里传入需要改的字母所在行和列，例如k#now在第9行第15列</span></span><br><span class="line">know(<span class="number">8</span>, <span class="number">14</span>, <span class="string">&#x27;n&#x27;</span>)	</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br></pre></td></tr></table></figure>

<p><strong>注意：空格也占位</strong></p>
<p>结果得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Dear Friend, This time I u</span><br><span class="line">nderstood my mistake and u</span><br><span class="line">sed One time pad encryptio</span><br><span class="line">n scheme, I heard that it </span><br><span class="line">is the only encryption met</span><br><span class="line">hod that is mathematically</span><br><span class="line"> proven to be not cracked </span><br><span class="line">ever if the key is kept se</span><br><span class="line">cure, Let Me know if you a</span><br><span class="line">gree with me to use this e</span><br><span class="line">ncryption scheme always...</span><br></pre></td></tr></table></figure>



<h1 id="例2"><a href="#例2" class="headerlink" title="例2"></a>例2</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> secret, key</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ENC</span>(<span class="params">m, k</span>):</span><br><span class="line">    c = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m) // <span class="built_in">len</span>(k)):</span><br><span class="line">        tmp = m[i * <span class="built_in">len</span>(k):(i + <span class="number">1</span>) * <span class="built_in">len</span>(k)]</span><br><span class="line">        c.append(strxor(tmp, key))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ENC(secret, key))</span><br><span class="line"><span class="comment"># [b&#x27;sO$\x03T\x10\x02\x10SR\x03\x0c\x11\x08B\x0c\x01\x00\x01\x0cGET\tE\x1dM(L\x08O\x1dF\x1aD\x10\x15\x1d\x17MI\x12H\x04\x02E\x19\x1c\n\x1e\x16\x00\x06\x04\x12\x0bG\x0f\x01\x15G\x01\x1d\x01K&#x27;, b&#x27;CT \tN\nAUf\x1e\x04\nE\x04\x11E&lt;O\x1a0gN\x1b\x1f(:pg\x00=\x00\x1b\x07\x17H\x02\x0f\x15\x00\x00\r\x0fR\x00\x15\x11\x1b\x16\x01N\x07U\x11L\x07\rEF\x1c\x13\t\x01\x07\x07A&#x27;, b&#x27;RMi\x05H\x18\x1c\x10SR\x1c\x02\x10CB&lt;\x1dUM\x11YR\x1aH\x04\tA NHO\x0cR\x00\x00\x17\t\x17ES\x1d\tR\x08V\x04\x16\x13\x1a\x1d\x11SKL&lt;\x13E\x14O\x13\t\x01T\x1cX&#x27;, b&#x27;ERi\x1fO\x0cO\x05L\x13\x1cM\x11\x05\x0b\x16RO\x18\x11\x00\x00\x18\x01\x0e\x0b\x00:O\t\nNH\x19I\r\x0e\x07\x16\x00\r\x07N\x06\x13E\x05\x10\x1b\x06ED\x00\r\x07\r\x00\x0c\x1a\x01\x13E\x16\x16H&#x27;, b&quot;OR,FD\x18\x18\x1b\x0eR2\x05\x1cRB&#x27;\x17C\x0c\x10_ET\x1c\r\x07SiS\x10\x00\x1cJTI\x10\x0fU\x11\x00\x1a\tM\x00\x02\r\x1b\x17\x08N\x11H\x04\x18S\x07L\x03\x18R\x0e\x0bT\x15\\&quot;, b&#x27;OMi\x00A\x0bO\x14W\x13\x1cAE\x1e\r\x08\x17T\x05\x0cBGT\x1c\r\x0fTiH\x05\x1cNI\x1bT\x0b\x08\x1c\x02\x00\x1d\t\x00\x01\x19E\x05\x10\x1b\x06EY\n\x19]Et\x0e\x06\x01G\x16\x00\x1c\\&#x27;, b&#x27;M\x00 \x15\x00\x00\x00\x00\x0eR6\x02\x08\x08\x16\r\x1bN\nEEN\x07\x01\x01\x0b\x00&amp;FD\x16\x01RZ\x000\x0eR\x04L\x05FY\n\x03E\x11\x18\x01N\x01OE\x05\x00EG\x0f\x19\x17G\x0c\x1aSZ&#x27;, b&#x27;O\x00 \x12\x0cY\x1c\x01E\x02E\x1f\x0c\n\n\x11RI\x03\x16ED\x11H\x11\x06EiS\x10\x00\x1cJX\x00\x00\r\x1d\x16I\x07\x01\x00\x1c\x19\x10\x00Y\n\x17\x00SE\r\x1d\x01\x00\x16\x03\x07\x00\x02\x1d\x1dI&#x27;, b&#x27;\x00U9FY\x16\x1a\x07\x00\x17\x04\x1f\x16M\x11\nRT\x05\x00\x0cS\x15\x06\x01ND&amp;E\x17\x01ISTG\x06\x15R\x0cNEFA\x0b\x12E\x05\x18\x03\x05ET\r\x1e\x1c\x10G\x0eO\x1b\x13IT\x00Z&#x27;, b&#x27;EPi\x04YY\x1c\x01E\x02KM1\x05\x07\x17\x17\x07\x1eEBOT\x1b\x10\x00\x00=H\x01\x1d\x0b\x0bTN\x0cA\x1f\nO\x07J\x00\x0b\x19E\x16\x10\x1d\x0b\x06T\x0c\x03\x1dI\x00\x08\x00R\x14\x00\x1a\x00K&#x27;, b&#x27;\x00O/FT\x10\x02\x10\x0eR/\x18\x16\x19B\x03\x1bN\x08E[H\x1d\x1c\x00NS(N\x00O\x1dP\x1dR\x0f\x08\x1c\x02\x00\x1c\x16\x00\x0c\x18\x11\x1dY\x1b\x06\x00\x00\x16\x07\nEL\x0f\x04\x17G\x15\x01\x1fX&#x27;, b&quot;ER \x1cE\x1dO\x17O\x1c\x00\x1eKM6\r\x13TJ\x16\x0cT\x1c\rE\x05I&#x27;DD\x00\x08\x07\x07A\r\x05\x01\x11O\x1b\x0b\x00\x1c\x19\x10R\x17\n\x0b\x01\x00\x11\x03S\x0cM\x07\x08\x1b\t\x00ZSo&quot;, b&#x27;NDi\tN\x1a\nUT\x1a\x00M\x16\x19\r\x17\x1f\x00\x04\x16\x0cO\x02\r\x17B\x000O\x11O\x19H\x1a\x07\x17A\x00\x00M\x0c\x0bB\x00\x04E\x1a\x16\x18N\x1cO\x10L\x1e\x04D\x03O\x1b\x13E\x00\x1b\\&#x27;, b&#x27;OU.\x0e\x0cY\x07\x1aWR\x1c\x02\x10M\x0f\x04\x1cA\n\x00H\x00\x00\x07E\x1dU;V\r\x19\x0b\tTy\x0c\x14R\x12O\x07ATE\x13\x13\x17\x17O\x0c\x00\x00\x16\x19\x01\x00\x0cF\x18\x1a\x02\x11\x1c\x16\\&#x27;, b&#x27;\x00T!\x03\x00\n\x1b\x1aR\x1fE\x04\x16M\x10\x00\x13L\x01\x1c\x0cO\x02\r\x17@\x00\x0bU\x10O\x01I\x11\x00\x17\t\x1b\x0bGI\x0fSE\x15\x00\x00\r\x0e\x07\x0b\x0eE;\x1b\x00NF\x16\x1d\x12E\x17\x1cC&#x27;, b&#x27;E\x00&amp;\x13TY\x00\x13\x00\x06\r\x08E\x1e\x16\n\x00MAEUO\x01H\x12\x01NnTD\r\x0b\x07\x00H\x06A\x01\x04M\x0cFP\x00\x04\x16\x1d\x17O\x19\rOE\x1b\x12\tK\x03\x0bR\x0e\x0bZSz&#x27;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line"><span class="comment">#这里传密文</span></span><br><span class="line"><span class="comment"># c = [codecs.decode(x.strip().encode(), &#x27;hex&#x27;) for x in open(&#x27;Problem.txt&#x27;, &#x27;r&#x27;).readlines()]</span></span><br><span class="line">c = []</span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line"><span class="comment">#know(10, 21, &#x27;y&#x27;)	#如果需要修正， 传入所在被改字母所在行和列，再输入替代的字母,例如alwa s 改为always</span></span><br><span class="line"><span class="comment">#know(8, 14, &#x27;n&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#key = xo.strxor(c[0], &#x27;&#x27;.join([chr(c) for c in msg[0]]).encode())</span></span><br><span class="line"><span class="comment">#print(key)</span></span><br></pre></td></tr></table></figure>

<p>这里是未修正的结果:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sometimes fate is like a small tand6torm that keeps changing dir1</span><br><span class="line">ctions. Flag is NowUKnowMTP. Yor ch$nge direction but the sandst;</span><br><span class="line">rm chases you. You turn again, eut 1he storm adjusts. Over and o&quot;</span><br><span class="line">er you play this out, like some&#x27;omi+ous dance with death just be2</span><br><span class="line">ore dawn. Why? Because this stoum i6n&#x27;t something that blew in f&amp;</span><br><span class="line">om far away, something that has&#x27;not-ing to do with you. This sto&amp;</span><br><span class="line">m is you. Something inside of yhu. o all you can do is give in  </span><br><span class="line">o it, step right inside the stoum, &amp;losing your eyes and pluggin3</span><br><span class="line"> up your ears so the sand doesn t g t in, and walk through it, s </span><br><span class="line">ep by step. There&#x27;s no sun therb, n* moon, no direction, no sens1</span><br><span class="line"> of time. Just fine white sand twir)ing up into the sky like pul&quot;</span><br><span class="line">erized bones. That&#x27;s the kind oa sa+dstorm you need to imagine. </span><br><span class="line">nd once the storm is over, you pon&#x27;1 remember how you made it th&amp;</span><br><span class="line">ough, how you managed to survivb. Y*u won&#x27;t even be sure, whethe&amp;</span><br><span class="line"> the storm is really over. But hne 1hing is certain. When you co9</span><br><span class="line">e out of the storm, you won&#x27;t bb th  same person who walked in.</span><br></pre></td></tr></table></figure>

<p>修正后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Sometimes fate is like a small tandstorm that keeps changing dir1</span><br><span class="line">ctions. Flag is NowUKnowMTP. Yor change direction but the sandst;</span><br><span class="line">rm chases you. You turn again, eut the storm adjusts. Over and o&quot;</span><br><span class="line">er you play this out, like some&#x27;ominous dance with death just be2</span><br><span class="line">ore dawn. Why? Because this stoum isn&#x27;t something that blew in f&amp;</span><br><span class="line">om far away, something that has&#x27;nothing to do with you. This sto&amp;</span><br><span class="line">m is you. Something inside of yhu. So all you can do is give in</span><br><span class="line">o it, step right inside the stoum, closing your eyes and pluggin3</span><br><span class="line"> up your ears so the sand doesn t get in, and walk through it, s</span><br><span class="line">ep by step. There&#x27;s no sun therb, no moon, no direction, no sens1</span><br><span class="line"> of time. Just fine white sand twirling up into the sky like pul&quot;</span><br><span class="line">erized bones. That&#x27;s the kind oa sandstorm you need to imagine. </span><br><span class="line">nd once the storm is over, you pon&#x27;t remember how you made it th&amp;</span><br><span class="line">ough, how you managed to survivb. You won&#x27;t even be sure, whethe&amp;</span><br><span class="line"> the storm is really over. But hne thing is certain. When you co9</span><br><span class="line">e out of the storm, you won&#x27;t bb the same person who walked in.</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;NowUKnowMTP&#125;</code></p>
]]></content>
      <categories>
        <category>现代密码-流密码</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>流密码</tag>
        <tag>MTP</tag>
      </tags>
  </entry>
  <entry>
    <title>LFSR</title>
    <url>/2023/07/12/%E6%B5%81%E5%AF%86%E7%A0%81/%E6%B5%81%E5%AF%86%E7%A0%81-LFSR/</url>
    <content><![CDATA[<p>浅浅学习一下LFSR(线性反馈寄存器)</p>
<p>一分耕耘，一分收获</p>
<span id="more"></span>

<p><strong>记录笔者学习LFSR过程</strong></p>
<p>首先了解一下流密码</p>
<h1 id="流密码"><a href="#流密码" class="headerlink" title="流密码"></a>流密码</h1><p>流密码它是以最小单位<strong>比特</strong>作为一次加密、解密的操作元素，利用加密算法进行加密与解密</p>
<ul>
<li>流密码的密钥派生自一个较短的密钥，派生算法通常为一个伪随机数生成算法。</li>
<li>流密码的密钥长度会与明文的长度相同。</li>
</ul>
<p>需要注意的是，流加密目前来说都是对称加密。</p>
<p>伪随机数生成算法生成的序列的随机性越强，明文中的统计特征被覆盖的更好。</p>
<p>流密码加解密非常简单，在已知明文的情况下，可以非常容易地获取密钥流。</p>
<p>流密码的关键在于设计好的<strong>伪随机数生成器</strong>。一般来说，伪随机数生成器的基本构造模块为反馈移位寄存器(LFSR)。</p>
<h1 id="伪随机数生成器"><a href="#伪随机数生成器" class="headerlink" title="伪随机数生成器"></a>伪随机数生成器</h1><p>伪随机数生成器（pseudorandom number generator，PRNG），又称为确定性随机位生成器（deterministic random bit generator，DRBG），是用来生成<strong>接近于绝对随机数序列的数字序列</strong>的算法。一般来说，PRNG 会依赖于一个初始值，也称为种子，来生成对应的伪随机数序列。<strong>只要种子确定了，PRNG 所生成的随机数就是完全确定的，因此其生成的随机数序列并不是真正随机的。</strong></p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>目前主要的伪随机数生成器有：</p>
<p>目前通用的伪随机数生成器主要有</p>
<ul>
<li>线性同余生成器，LCG</li>
<li>线性回归发生器</li>
<li><a href="https://en.wikipedia.org/wiki/Mersenne_Twister">Mersenne Twister</a></li>
<li><a href="https://en.wikipedia.org/wiki/Xorshift">xorshift</a> generators</li>
<li><a href="https://en.wikipedia.org/wiki/Well_Equidistributed_Long-period_Linear">WELL</a> family of generators</li>
<li>Linear feedback shift register，LFSR，线性反馈移位寄存器</li>
</ul>
<p>这里学习一下LFSR</p>
<p>以下学习都是建立在他人博客的基础上</p>
<p><a href="https://blog.csdn.net/xiao__1bai/article/details/120392307">(9条消息) CTF中的LFSR考点(一)_lfsr ctf_沐一 · 林的博客-CSDN博客</a></p>
<h1 id="LFSR-线性反馈寄存器"><a href="#LFSR-线性反馈寄存器" class="headerlink" title="LFSR(线性反馈寄存器)"></a>LFSR(线性反馈寄存器)</h1><p><strong>在学习LFSR之前，先了解一下FSR(反馈寄存器)，LFSR是FSR其中一种，另外一种是NFSR(非线性反馈寄存器)</strong></p>
<p>FSR是<strong>流密码</strong>产生<strong>密钥流</strong>的一个重要组成部分，在<strong>GF(2)<strong>上的一个</strong>n级FSR</strong>通常由<strong>n个二元存储器</strong>和<strong>一个反馈函数</strong>组成。</p>
<p><strong>GF(2)指的是有限域2，所以在GF(2)的元素只有0和1</strong></p>
<p>FSR如下图所示：</p>
<p><img src="/../../images/LFSR/0.png"></p>
<p>**如果这里的反馈函数是线性的，就称它为LFSR(线性反馈寄存器)**，此时反馈函数可以表示为<br>$$<br>f(a_1,a_2,a_3,a_4,a_5) &#x3D; c_na_1 \oplus c_{n-1}a_2 \oplus…\oplus c_1a_n\\<br>$$<br>$$<br>其中，c_i表示0或1，\oplus表示异或<br>$$</p>
<p>eg:<br>$$<br>假设一个5级的LFSR，其初始状态(即a_1,a_2,a_3,a_4,a_5这五个单元格里面的值)为<br>$$<br>$$<br>(a_1,a_2,a_3,a_4,a_5)&#x3D;(1,0,0,1,1)<br>$$</p>
<p>$$<br>其反馈函数为：<br>$$</p>
<p>$$<br>f(a_1,a_2,a_3,a_4,a_5) &#x3D; a_4 \oplus a_1<br>$$</p>
<p><strong>整个过程可表示为下面的形式：</strong></p>
<p><img src="/../../images/LFSR/1.png"></p>
<p><strong>之后，会将反馈函数计算的值作为a6放到a5后面，并且把a1输出</strong>，如图：</p>
<p><img src="/../../images/LFSR/0.jpg"><br>$$<br>而a_6 &#x3D; a_4 \oplus a_1 &#x3D; 1 \oplus 1 &#x3D; 0<br>$$</p>
<p>$$<br>由反馈函数我们可以推出<br>$$</p>
<p>$$<br>a_n &#x3D; a_{n-2} \oplus a_{n-5}(n&gt;5)<br>$$</p>
<p>$$<br>通过该函数，我们可以推出剩下的值<br>$$</p>
<p>$$<br>经过计算，发现从32位起，之后的数据和前面数据成周期性变化<br>$$</p>
<p>$$<br>发现5级LFSR的最大周期为2^5-1<br>$$</p>
<p>$$<br>\therefore n级LFSR的最大周期为2^n -1<br>$$</p>
<p><strong>以下例题是建立在理解别人博客的基础上写的：</strong></p>
<p>原：<a href="https://www.anquanke.com/post/id/181811#h2-5">深入分析CTF中的LFSR类题目（一）-安全客 - 安全资讯平台 (anquanke.com)</a></p>
<h1 id="例题1-CISCN2018-oldstreamgame"><a href="#例题1-CISCN2018-oldstreamgame" class="headerlink" title="例题1 CISCN2018 oldstreamgame"></a>例题1 CISCN2018 oldstreamgame</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flag = &quot;flag&#123;xxxxxxxxxxxxxxxx&#125;&quot;</span><br><span class="line">assert flag.startswith(&quot;flag&#123;&quot;)</span><br><span class="line">assert flag.endswith(&quot;&#125;&quot;)</span><br><span class="line">assert len(flag)==14</span><br><span class="line"></span><br><span class="line">def lfsr(R,mask):</span><br><span class="line">    output = (R &lt;&lt; 1) &amp; 0xffffffff</span><br><span class="line">    i=(R&amp;mask)&amp;0xffffffff</span><br><span class="line">    lastbit=0</span><br><span class="line">    while i!=0:</span><br><span class="line">        lastbit^=(i&amp;1)</span><br><span class="line">        i=i&gt;&gt;1</span><br><span class="line">    output^=lastbit </span><br><span class="line">    return (output,lastbit)</span><br><span class="line"></span><br><span class="line">R=int(flag[5:-1],16)</span><br><span class="line">mask = 0b10100100000010000000100010010100</span><br><span class="line"></span><br><span class="line">f=open(&quot;key&quot;,&quot;w&quot;)</span><br><span class="line">for i in range(100):</span><br><span class="line">    tmp=0</span><br><span class="line">    for j in range(8):</span><br><span class="line">        (R,out)=lfsr(R,mask)</span><br><span class="line">        tmp=(tmp &lt;&lt; 1)^out</span><br><span class="line">    f.write(chr(tmp))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<h3 id="分析已知条件"><a href="#分析已知条件" class="headerlink" title="分析已知条件"></a>分析已知条件</h3><ol>
<li><strong>flag包裹的内容为8个16进制数字，就是我们需要求的初始状态的值</strong></li>
<li><strong>反馈函数已知，需要从代码的形式理解为“数学”表达式</strong></li>
<li><strong>已知输出</strong></li>
<li><strong>已知mask</strong></li>
</ol>
<h3 id="分析代码："><a href="#分析代码：" class="headerlink" title="分析代码："></a>分析代码：</h3><ol>
<li><code>output = (R &lt;&lt; 1) &amp; 0xffffffff</code><strong>先把R左移，然后和0xffffffff进行与操作，其作用是把R的最高位抹去并在最低位补0，并保留低32位，再把该值赋值给output</strong></li>
</ol>
<p>假设$R$的值为$\color{red}0\color{black}1101010\quad 11101010\quad 10010001\quad 1011101\color{red}1$</p>
<p>在这串代码作用下首先变成$\color{red}0\color{black}\quad11010101\quad 11010101\quad 00100011\quad 0111011\color{red}0$</p>
<ol start="2">
<li><p><code>i=(R&amp;mask)&amp;0xffffffff</code><strong>将R和mask进行与操作，并保留低32位，再把该值赋值给i，这里mask已知</strong></p>
</li>
<li><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">lastbit=<span class="number">0</span></span><br><span class="line">   <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">       lastbit ^= (i&amp;<span class="number">1</span>)</span><br><span class="line">       i=i&gt;&gt;<span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>先看<code>lastbit ^= (i &amp; 1)</code>，和<code>i = i &gt;&gt; 1</code><strong>两串代码作用是把i的每位和1进行与操作，再和lastbit异或</strong></p>
<p>这里假设$i&#x3D;1001$，取短一点也能看出规律</p>
<p>$i和1$进行<code>&amp;</code>操作：$1001$<code> &amp;</code>$0001$</p>
<p>得到：$0001$即$1$，再和$lastbit$异或</p>
<p>还要把$i$右移，变成$0100$</p>
<p>再和1进行与操作：$0100$ <code>&amp;</code>$0001$</p>
<p>得到：$0000$即$0$，再和$lastbit$异或</p>
<p>其实就是从i的最低位向i的最高位依次和1进行与操作(不影响值)，再和lastbit做异或运算，</p>
</li>
<li><p><code>output ^= lastbit</code><strong>将output变量的值和lastbit的值异或，再赋值给output</strong></p>
</li>
<li><pre><code class="python">f=open(&quot;key&quot;,&quot;w&quot;)
for i in range(100):
    tmp=0
    for j in range(8):
        (R,out)=lfsr(R,mask)
        tmp=(tmp &lt;&lt; 1)^out
    f.write(chr(tmp))
f.close()
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">​			最后对flag做了100个循环，每次输出一个字符，这样key中有100个16进制数字</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 找寻规律</span><br><span class="line"></span><br><span class="line">1. **因为mask中只有第3，5，8，12，20，27，30，32位是1，其余都是0**</span><br><span class="line">2. **mask与R做按位与运算得到i，当且仅当R的第3、5、8、12、20、27、30、32这几位中也出现1时，i中才可能出现1，否则i中将全为0。**</span><br><span class="line">3. **因为lastbit是i从低位到高位依次和lastbit异或得到的(i中的0可以忽略不计，因为0和任何数做异或运算，得到的结果还是原来的数)，且lastbit的初值为0。当i中有奇数个1的时候lastbit的值为1，当i中有偶数个1的时候lastbit的值为0**</span><br><span class="line"></span><br><span class="line">4. **又因为i是由R和mask进行与操作得到的，所以当R中第3，5，8，12，20，27，30，32有奇数个1的时候lastbit为1，有偶数个1的时候lastbit为0**</span><br><span class="line"></span><br><span class="line">5. **因此我们可以得出结论，lastbit的值取决于R中第3，5，8，12，20，27，30，32依次异或的结果**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 得到结论</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">lastbit = R_3\oplus R_5\oplus R_8\oplus R_&#123;12&#125;\oplus R_&#123;20&#125;\oplus R_&#123;27&#125;\oplus R_&#123;30&#125;\oplus R_&#123;32&#125;</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">这样就得到了反馈函数的&quot;数学&quot;表达式</span><br><span class="line"></span><br></pre></td></tr></table></figure>
0b100000111111011110111011111000101001001100100111110100000010000011111100110011000111011010100000100011100010101110010111101101000010000011110111110000110010110000111001111010100000110011010101010110100101100011010001011101111101000100110101111100000110000110110000011111010001011001101111001110000100110101111100011101101101101100011101100111011101011101010111011100101110101011011110100111100000111110010010001010001000000011110000011001110010100010010111000010001011110110000010101110011000101011001101111101111010001110010000000101011110001110001110100111011110000111111010110100001010010111001100001101100101011100100111100001100101000100001010001000111010110011111000101110011101000111110110000010000101101010010001111000010101010000011110100001001101111011010000010011110011010110100100001100
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">**因为这里除去0b只有798位，所以把前面两位换成0即是800位二进制数据，也许是这样理解的吧**</span><br><span class="line"></span><br><span class="line">**当即将输出第32位lastbit时，此时R已经左移了31位，所以此时第32位就是原来的第1位**</span><br><span class="line"></span><br><span class="line">$last_1 = R_&#123;1,3&#125; \otimes R_&#123;1,5&#125;$</span><br><span class="line"></span><br><span class="line">![](../../images/LFSR/2.png)</span><br><span class="line"></span><br><span class="line">**这样我们就可以求出R的第1位，**</span><br><span class="line">$$</span><br><span class="line">如果求第一位，应该先是这样:\quad </span><br><span class="line">?0010000011111101111011101111100</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">再变成key=00100000111111011110111011111000</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">根据lastbit = R_3\oplus R_5\oplus R_8\oplus R_&#123;12&#125;\oplus R_&#123;20&#125;\oplus R_&#123;27&#125;\oplus R_&#123;30&#125;\oplus R_&#123;32&#125;</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">\therefore</span><br><span class="line">R_&#123;32&#125; = R_3\oplus R_5\oplus R_8\oplus R_&#123;12&#125;\oplus R_&#123;20&#125;\oplus R_&#123;27&#125;\oplus R_&#123;30&#125;\oplus lastbit</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">即</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">? = R_3\oplus R_5\oplus R_8\oplus R_&#123;12&#125;\oplus R_&#123;20&#125;\oplus R_&#123;27&#125;\oplus R_&#123;30&#125;\oplus lastbit</span><br><span class="line">对这里求解?0010000011111101111011101111100</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line">$$</span><br><span class="line">所以R_1 = 1 \oplus 1 \oplus 0 \oplus 0 \oplus 1 \oplus 0 \oplus 0 \oplus 0=1</span><br><span class="line">$$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">**同样的方法，先右移，我们可以求出R的第2位**</span><br><span class="line"></span><br><span class="line">![](../../images/LFSR/3.png)</span><br><span class="line"></span><br><span class="line">**exp:**</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">key = &quot;00100000111111011110111011111000&quot;</span><br><span class="line">mask = &quot;10100100000010000000100010010100&quot;</span><br><span class="line"></span><br><span class="line">R = &quot;&quot;</span><br><span class="line">tmp = key</span><br><span class="line"></span><br><span class="line">for i in range(32):</span><br><span class="line">    newkey = &#x27;?&#x27;+key[:31]</span><br><span class="line">    m = int(newkey[-3])^int(newkey[-5])^int(newkey[-8])^int(newkey[-12])^int(newkey[-20])^int(newkey[-27])^int(newkey[-30])^int(tmp[-1-i]) #这个tmp[-1-i]是求第i位对应当时lastbit的值</span><br><span class="line">    R += str(m)</span><br><span class="line">    key = str(m) + key[:31]  #这里得到了第1位，求第二位就需要更新key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot;+ hex(int(R[::-1],2)) + &quot;&#125;&quot;	#逆序回去</span><br><span class="line">print(flag)</span><br><span class="line"></span><br><span class="line">#flag&#123;0x926201d7&#125;</span><br><span class="line">#把0x删了</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ol>
<p><strong>总之，理解还没有很清楚</strong></p>
<h2 id="疑惑"><a href="#疑惑" class="headerlink" title="疑惑"></a>疑惑</h2><h1 id="例题2-强网杯2018-StreamGame1"><a href="#例题2-强网杯2018-StreamGame1" class="headerlink" title="例题2 强网杯2018 StreamGame1"></a>例题2 强网杯2018 StreamGame1</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flag import flag</span><br><span class="line">assert flag.startswith(&quot;flag&#123;&quot;)</span><br><span class="line">assert flag.endswith(&quot;&#125;&quot;)</span><br><span class="line">assert len(flag)==25</span><br><span class="line"></span><br><span class="line">def lfsr(R,mask):</span><br><span class="line">    output = (R &lt;&lt; 1) &amp; 0xffffff</span><br><span class="line">    i=(R&amp;mask)&amp;0xffffff</span><br><span class="line">    lastbit=0</span><br><span class="line">    while i!=0:</span><br><span class="line">        lastbit^=(i&amp;1)</span><br><span class="line">        i=i&gt;&gt;1</span><br><span class="line">    output^=lastbit</span><br><span class="line">    return (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R=int(flag[5:-1],2)</span><br><span class="line">mask    =   0b1010011000100011100</span><br><span class="line"></span><br><span class="line">f=open(&quot;key&quot;,&quot;ab&quot;)</span><br><span class="line">for i in range(12):</span><br><span class="line">    tmp=0</span><br><span class="line">    for j in range(8):</span><br><span class="line">        (R,out)=lfsr(R,mask)</span><br><span class="line">        tmp=(tmp &lt;&lt; 1)^out</span><br><span class="line">    f.write(chr(tmp))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>关于这个key的获取，有点疑惑，从<code>bytes_to_long</code>输出之后除了0b是95位，自己手动在最前面添了0</p>
<p>然后根据题目要求的只有19位，所以取前19位</p>
<p>这个lsfr函数和前面CISCN的一样</p>
<p>再根据mask1的位置，写出反馈函数<br>$$<br>lastbit &#x3D; R_3\oplus R_4\oplus  R_5\oplus R_9\oplus R_{13}\oplus R_{14}\oplus R_{17}\oplus R_{19}<br>$$<br>然后求解就行了</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">&quot;0101010100111000111&quot;</span></span><br><span class="line">mask = <span class="string">&quot;1010011000100011100&quot;</span></span><br><span class="line"></span><br><span class="line">R = <span class="string">&quot;&quot;</span></span><br><span class="line">tmp = key</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    newkey = <span class="string">&#x27;?&#x27;</span>+key[:<span class="number">18</span>]</span><br><span class="line">    m = <span class="built_in">int</span>(newkey[-<span class="number">3</span>])^<span class="built_in">int</span>(newkey[-<span class="number">4</span>])^<span class="built_in">int</span>(newkey[-<span class="number">5</span>])^<span class="built_in">int</span>(newkey[-<span class="number">9</span>])^<span class="built_in">int</span>(newkey[-<span class="number">13</span>])^<span class="built_in">int</span>(newkey[-<span class="number">14</span>])^<span class="built_in">int</span>(newkey[-<span class="number">17</span>])^<span class="built_in">int</span>(tmp[-<span class="number">1</span>-i])</span><br><span class="line">    R += <span class="built_in">str</span>(m)</span><br><span class="line">    key = <span class="built_in">str</span>(m) + key[:<span class="number">18</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+ <span class="built_in">str</span>(<span class="built_in">int</span>(R[::-<span class="number">1</span>])) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;1110101100001101011&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>还有一种爆破的方法：</strong></p>
<p>用010打开key文件，提取每个值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp;<span class="number">0xffffff</span></span><br><span class="line">    i=(R&amp;mask)&amp;<span class="number">0xffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output^=lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"> </span><br><span class="line">key = [<span class="number">0x55</span>,<span class="number">0x38</span>,<span class="number">0xF7</span>,<span class="number">0x42</span>,<span class="number">0xC1</span>,<span class="number">0x0D</span>,<span class="number">0xB2</span>,<span class="number">0xC7</span>,<span class="number">0xED</span>,<span class="number">0xE0</span>,<span class="number">0x24</span>,<span class="number">0x3A</span>]</span><br><span class="line">mask=<span class="number">0b1010011000100011100</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">19</span>):</span><br><span class="line">    R=k</span><br><span class="line">    a=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    judge=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            (k, out) = lfsr(k, mask)</span><br><span class="line">            tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line">        <span class="keyword">if</span>(key[i]!=tmp):</span><br><span class="line">           judge=<span class="number">0</span></span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(judge==<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">bin</span>(R)[<span class="number">2</span>:]+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h1 id="例题3-强网杯2018-StreamGame2"><a href="#例题3-强网杯2018-StreamGame2" class="headerlink" title="例题3 强网杯2018 StreamGame2"></a>例题3 强网杯2018 StreamGame2</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flag import flag</span><br><span class="line">assert flag.startswith(&quot;flag&#123;&quot;)</span><br><span class="line">assert flag.endswith(&quot;&#125;&quot;)</span><br><span class="line">assert len(flag)==27</span><br><span class="line"></span><br><span class="line">def lfsr(R,mask):</span><br><span class="line">    output = (R &lt;&lt; 1) &amp; 0xffffff</span><br><span class="line">    i=(R&amp;mask)&amp;0xffffff</span><br><span class="line">    lastbit=0</span><br><span class="line">    while i!=0:</span><br><span class="line">        lastbit^=(i&amp;1)</span><br><span class="line">        i=i&gt;&gt;1</span><br><span class="line">    output^=lastbit</span><br><span class="line">    return (output,lastbit)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R=int(flag[5:-1],2)</span><br><span class="line">mask=0x100002</span><br><span class="line"></span><br><span class="line">f=open(&quot;key&quot;,&quot;ab&quot;)</span><br><span class="line">for i in range(12):</span><br><span class="line">    tmp=0</span><br><span class="line">    for j in range(8):</span><br><span class="line">        (R,out)=lfsr(R,mask)</span><br><span class="line">        tmp=(tmp &lt;&lt; 1)^out</span><br><span class="line">    f.write(chr(tmp))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>和StreamGame1类似，换了flag的长度，并且以16进制的形式给出mask</p>
<p><strong>先求mask</strong>,mask &#x3D; <code>100000000000000000010</code></p>
<p><strong>因为mask变了，所以反馈函数变了</strong><br>$$<br>lastbit &#x3D; R_2 \oplus R_{21}<br>$$<br><strong>输出key之后，除了0b就是96位，所以直接取前21位</strong></p>
<p><strong>exp1:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">key = <span class="string">&quot;101100101110100100001&quot;</span></span><br><span class="line">mask = <span class="string">&quot;100000000000000000010&quot;</span></span><br><span class="line"></span><br><span class="line">R = <span class="string">&quot;&quot;</span></span><br><span class="line">tmp = key</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">21</span>):</span><br><span class="line">    newkey = <span class="string">&#x27;?&#x27;</span>+key[:<span class="number">20</span>]</span><br><span class="line">    m = <span class="built_in">int</span>(newkey[-<span class="number">2</span>])^<span class="built_in">int</span>(tmp[-<span class="number">1</span>-i])</span><br><span class="line">    R += <span class="built_in">str</span>(m)</span><br><span class="line">    key = <span class="built_in">str</span>(m) + key[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+ <span class="built_in">str</span>(<span class="built_in">int</span>(R[::-<span class="number">1</span>])) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;110111100101001101001&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>exp2:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">R,mask</span>):</span><br><span class="line">    output = (R &lt;&lt; <span class="number">1</span>) &amp;<span class="number">0xffffff</span></span><br><span class="line">    i=(R&amp;mask)&amp;<span class="number">0xffffff</span></span><br><span class="line">    lastbit=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i!=<span class="number">0</span>:</span><br><span class="line">        lastbit^=(i&amp;<span class="number">1</span>)</span><br><span class="line">        i=i&gt;&gt;<span class="number">1</span></span><br><span class="line">    output^=lastbit</span><br><span class="line">    <span class="keyword">return</span> (output,lastbit)</span><br><span class="line"> </span><br><span class="line">key = [<span class="number">0xB2</span>,<span class="number">0xE9</span>,<span class="number">0x0E</span>,<span class="number">0x13</span>,<span class="number">0xA0</span>,<span class="number">0x6A</span>,<span class="number">0x1B</span>,<span class="number">0xFC</span>,<span class="number">0x40</span>,<span class="number">0xE6</span>,<span class="number">0x7D</span>,<span class="number">0x53</span>]</span><br><span class="line">mask=<span class="number">0b100000000000000000010</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">21</span>):</span><br><span class="line">    R=k</span><br><span class="line">    a=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    judge=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            (k, out) = lfsr(k, mask)</span><br><span class="line">            tmp = (tmp &lt;&lt; <span class="number">1</span>) ^ out</span><br><span class="line">        <span class="keyword">if</span>(key[i]!=tmp):</span><br><span class="line">           judge=<span class="number">0</span></span><br><span class="line">           <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span>(judge==<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span>+<span class="built_in">bin</span>(R)[<span class="number">2</span>:]+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h1 id="例题4-2018HITB-XCTF"><a href="#例题4-2018HITB-XCTF" class="headerlink" title="例题4 2018HITB-XCTF"></a>例题4 2018HITB-XCTF</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flag import flag</span><br><span class="line">assert flag.startswith(&quot;flag&#123;&quot;)</span><br><span class="line">assert flag.endswith(&quot;&#125;&quot;)</span><br><span class="line">assert len(flag)==47</span><br><span class="line"> </span><br><span class="line">def lfsr(R,mask):</span><br><span class="line">    output = (R &lt;&lt; 1) &amp; 0xffffff</span><br><span class="line">    i=(R&amp;mask)&amp;0xffffff</span><br><span class="line">    lastbit=0</span><br><span class="line">    while i!=0:</span><br><span class="line">        lastbit^=(i&amp;1)</span><br><span class="line">        i=i&gt;&gt;1</span><br><span class="line">    output^=lastbit</span><br><span class="line">    return (output,lastbit)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">R=int(flag[5:-1],2)</span><br><span class="line">mask    =   0b10110110110011010111001101011010101011011</span><br><span class="line"> </span><br><span class="line">f=open(&quot;key&quot;,&quot;ab&quot;)</span><br><span class="line">for i in range(64):</span><br><span class="line">    tmp=0</span><br><span class="line">    for j in range(8):</span><br><span class="line">        (R,out)=lfsr(R,mask)</span><br><span class="line">        tmp=(tmp &lt;&lt; 1)^out</span><br><span class="line">    f.write(chr(tmp))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p><strong>lfsr还是没变化，变的是flag的长度和mask</strong></p>
<p>根据mask求出反馈函数<br>$$<br>lastbit &#x3D;R_1\oplus R_2\oplus R_4\oplus R_5\oplus R_7\oplus R_9\oplus R_{11}\oplus R_{13}\oplus R_{14}\oplus R_{16}\oplus R_{18}\oplus R_{19}\oplus R_{22}\oplus R_{23}\oplus R_{24}\oplus R_{26}\oplus R_{28}\oplus R_{29}\oplus R_{32}\oplus R_{33}\oplus R_{35}\oplus R_{36}\oplus R_{38}\oplus R_{39}\oplus R_{41}<br>$$<br><strong>呜呜呜有题目没附件</strong></p>
<h1 id="例题5-强网杯2018-StreamGame4"><a href="#例题5-强网杯2018-StreamGame4" class="headerlink" title="例题5 强网杯2018 StreamGame4"></a>例题5 强网杯2018 StreamGame4</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flag import flag</span><br><span class="line">assert flag.startswith(&quot;flag&#123;&quot;)</span><br><span class="line">assert flag.endswith(&quot;&#125;&quot;)</span><br><span class="line">assert len(flag)==27</span><br><span class="line"> </span><br><span class="line">def nlfsr(R,mask):</span><br><span class="line">    output = (R &lt;&lt; 1) &amp; 0xffffff</span><br><span class="line">    i=(R&amp;mask)&amp;0xffffff</span><br><span class="line">    lastbit=0</span><br><span class="line">    changesign=True</span><br><span class="line">    while i!=0:</span><br><span class="line">        if changesign:</span><br><span class="line">            lastbit &amp;= (i &amp; 1)</span><br><span class="line">            changesign=False</span><br><span class="line">        else:</span><br><span class="line">            lastbit^=(i&amp;1)</span><br><span class="line">        i=i&gt;&gt;1</span><br><span class="line">    output^=lastbit</span><br><span class="line">    return (output,lastbit)</span><br><span class="line"> </span><br><span class="line">R=int(flag[5:-1],2)</span><br><span class="line">mask=0b110110011011001101110</span><br><span class="line"> </span><br><span class="line">f=open(&quot;key&quot;,&quot;ab&quot;)</span><br><span class="line">for i in range(1024*1024):</span><br><span class="line">    tmp=0</span><br><span class="line">    for j in range(8):</span><br><span class="line">        (R,out)=nlfsr(R,mask)</span><br><span class="line">        tmp=(tmp &lt;&lt; 1)^out</span><br><span class="line">    f.write(chr(tmp))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p><strong>不同之处在于反馈函数不一样了</strong></p>
<p><strong>我的理解是第一个lastbit一定为0</strong></p>
]]></content>
      <categories>
        <category>现代密码-流密码</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>流密码</tag>
        <tag>LFSR</tag>
      </tags>
  </entry>
  <entry>
    <title>题目收集</title>
    <url>/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/</url>
    <content><![CDATA[<p>记录一些长知识的题目</p>
<span id="more"></span>

<h1 id="easyrandom"><a href="#easyrandom" class="headerlink" title="easyrandom"></a>easyrandom</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">rng = Random()</span><br><span class="line">leak = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1250</span>):</span><br><span class="line">    leak.append(rng.getrandbits(<span class="number">16</span>))</span><br><span class="line">m = rng.getrandbits(<span class="number">64</span>)</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+<span class="built_in">str</span>(m)+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">flag_md5 = md5(flag.encode()).hexdigest()</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;leak = <span class="subst">&#123;leak&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;flag_md5 = <span class="subst">&#123;flag_md5&#125;</span>\n&quot;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">leak = [<span class="number">47945</span>, <span class="number">50431</span>, <span class="number">10861</span>, <span class="number">5794</span>, <span class="number">26338</span>, <span class="number">2641</span>, <span class="number">58647</span>, <span class="number">52422</span>, <span class="number">35384</span>, <span class="number">50426</span>, <span class="number">58144</span>, <span class="number">2744</span>, <span class="number">7864</span>, <span class="number">25333</span>, <span class="number">3500</span>, <span class="number">59273</span>, <span class="number">38075</span>, <span class="number">38630</span>, <span class="number">18760</span>, <span class="number">19660</span>, <span class="number">54418</span>, <span class="number">53538</span>, <span class="number">20251</span>, <span class="number">25758</span>, <span class="number">4500</span>, <span class="number">14384</span>, <span class="number">40765</span>, <span class="number">43841</span>, <span class="number">62662</span>, <span class="number">64548</span>, <span class="number">6468</span>, <span class="number">8997</span>, <span class="number">20572</span>, <span class="number">9920</span>, <span class="number">64146</span>, <span class="number">49443</span>, <span class="number">32054</span>, <span class="number">56082</span>, <span class="number">21773</span>, <span class="number">38390</span>, <span class="number">14905</span>, <span class="number">47230</span>, <span class="number">43126</span>, <span class="number">37449</span>, <span class="number">1016</span>, <span class="number">23685</span>, <span class="number">48461</span>, <span class="number">13070</span>, <span class="number">58381</span>, <span class="number">51813</span>, <span class="number">48909</span>, <span class="number">10953</span>, <span class="number">31195</span>, <span class="number">1703</span>, <span class="number">33439</span>, <span class="number">54463</span>, <span class="number">63977</span>, <span class="number">29188</span>, <span class="number">44901</span>, <span class="number">53588</span>, <span class="number">32843</span>, <span class="number">9923</span>, <span class="number">2188</span>, <span class="number">42503</span>, <span class="number">53555</span>, <span class="number">44818</span>, <span class="number">55094</span>, <span class="number">40544</span>, <span class="number">25787</span>, <span class="number">34965</span>, <span class="number">65151</span>, <span class="number">37069</span>, <span class="number">6342</span>, <span class="number">36889</span>, <span class="number">51214</span>, <span class="number">58386</span>, <span class="number">34925</span>, <span class="number">9558</span>, <span class="number">33552</span>, <span class="number">29554</span>, <span class="number">30350</span>, <span class="number">20166</span>, <span class="number">4221</span>, <span class="number">61353</span>, <span class="number">50656</span>, <span class="number">7337</span>, <span class="number">1001</span>, <span class="number">18279</span>, <span class="number">27268</span>, <span class="number">49581</span>, <span class="number">37870</span>, <span class="number">54591</span>, <span class="number">12438</span>, <span class="number">13649</span>, <span class="number">42007</span>, <span class="number">33542</span>, <span class="number">18118</span>, <span class="number">48407</span>, <span class="number">34338</span>, <span class="number">12147</span>, <span class="number">19178</span>, <span class="number">8925</span>, <span class="number">31109</span>, <span class="number">12296</span>, <span class="number">52419</span>, <span class="number">392</span>, <span class="number">9296</span>, <span class="number">16055</span>, <span class="number">64775</span>, <span class="number">46394</span>, <span class="number">58494</span>, <span class="number">24157</span>, <span class="number">62237</span>, <span class="number">16211</span>, <span class="number">23935</span>, <span class="number">10368</span>, <span class="number">48440</span>, <span class="number">60061</span>, <span class="number">47813</span>, <span class="number">49032</span>, <span class="number">50836</span>, <span class="number">18404</span>, <span class="number">30552</span>, <span class="number">7142</span>, <span class="number">44142</span>, <span class="number">44549</span>, <span class="number">36078</span>, <span class="number">63112</span>, <span class="number">28345</span>, <span class="number">39821</span>, <span class="number">10004</span>, <span class="number">32221</span>, <span class="number">16021</span>, <span class="number">32152</span>, <span class="number">53113</span>, <span class="number">13857</span>, <span class="number">49328</span>, <span class="number">11817</span>, <span class="number">27777</span>, <span class="number">43088</span>, <span class="number">43453</span>, <span class="number">29962</span>, <span class="number">16338</span>, <span class="number">44353</span>, <span class="number">27974</span>, <span class="number">25145</span>, <span class="number">56050</span>, <span class="number">34129</span>, <span class="number">39236</span>, <span class="number">46167</span>, <span class="number">64639</span>, <span class="number">54581</span>, <span class="number">33004</span>, <span class="number">35652</span>, <span class="number">16294</span>, <span class="number">11109</span>, <span class="number">19396</span>, <span class="number">51476</span>, <span class="number">30332</span>, <span class="number">24701</span>, <span class="number">43628</span>, <span class="number">44507</span>, <span class="number">27688</span>, <span class="number">37172</span>, <span class="number">61339</span>, <span class="number">9893</span>, <span class="number">45217</span>, <span class="number">7969</span>, <span class="number">33523</span>, <span class="number">2495</span>, <span class="number">15578</span>, <span class="number">55444</span>, <span class="number">48564</span>, <span class="number">5055</span>, <span class="number">16048</span>, <span class="number">8512</span>, <span class="number">1819</span>, <span class="number">19702</span>, <span class="number">13388</span>, <span class="number">41099</span>, <span class="number">30256</span>, <span class="number">10592</span>, <span class="number">46063</span>, <span class="number">30881</span>, <span class="number">8338</span>, <span class="number">41214</span>, <span class="number">55255</span>, <span class="number">50060</span>, <span class="number">65028</span>, <span class="number">9114</span>, <span class="number">8417</span>, <span class="number">43767</span>, <span class="number">62760</span>, <span class="number">49830</span>, <span class="number">50660</span>, <span class="number">19358</span>, <span class="number">22142</span>, <span class="number">53025</span>, <span class="number">37930</span>, <span class="number">49155</span>, <span class="number">2150</span>, <span class="number">56194</span>, <span class="number">36251</span>, <span class="number">49654</span>, <span class="number">32395</span>, <span class="number">33677</span>, <span class="number">48743</span>, <span class="number">12627</span>, <span class="number">30575</span>, <span class="number">64001</span>, <span class="number">60220</span>, <span class="number">26908</span>, <span class="number">44207</span>, <span class="number">23532</span>, <span class="number">18430</span>, <span class="number">45511</span>, <span class="number">33553</span>, <span class="number">62631</span>, <span class="number">55155</span>, <span class="number">58715</span>, <span class="number">59152</span>, <span class="number">20864</span>, <span class="number">14790</span>, <span class="number">32774</span>, <span class="number">48679</span>, <span class="number">24325</span>, <span class="number">54109</span>, <span class="number">2747</span>, <span class="number">17046</span>, <span class="number">19083</span>, <span class="number">60413</span>, <span class="number">11773</span>, <span class="number">42188</span>, <span class="number">17011</span>, <span class="number">13361</span>, <span class="number">2105</span>, <span class="number">23067</span>, <span class="number">45439</span>, <span class="number">1122</span>, <span class="number">54117</span>, <span class="number">31435</span>, <span class="number">49692</span>, <span class="number">59556</span>, <span class="number">51893</span>, <span class="number">24342</span>, <span class="number">11073</span>, <span class="number">52326</span>, <span class="number">23237</span>, <span class="number">22930</span>, <span class="number">12691</span>, <span class="number">38125</span>, <span class="number">36714</span>, <span class="number">54043</span>, <span class="number">34880</span>, <span class="number">53599</span>, <span class="number">18609</span>, <span class="number">36631</span>, <span class="number">24367</span>, <span class="number">49135</span>, <span class="number">26821</span>, <span class="number">64486</span>, <span class="number">12154</span>, <span class="number">37534</span>, <span class="number">14100</span>, <span class="number">33744</span>, <span class="number">37183</span>, <span class="number">7652</span>, <span class="number">26403</span>, <span class="number">42166</span>, <span class="number">12290</span>, <span class="number">32315</span>, <span class="number">19153</span>, <span class="number">55490</span>, <span class="number">4558</span>, <span class="number">60768</span>, <span class="number">44149</span>, <span class="number">26258</span>, <span class="number">38676</span>, <span class="number">31228</span>, <span class="number">43610</span>, <span class="number">39357</span>, <span class="number">36475</span>, <span class="number">29434</span>, <span class="number">41437</span>, <span class="number">64762</span>, <span class="number">5251</span>, <span class="number">33641</span>, <span class="number">43819</span>, <span class="number">29769</span>, <span class="number">38136</span>, <span class="number">8348</span>, <span class="number">33123</span>, <span class="number">17571</span>, <span class="number">18343</span>, <span class="number">50569</span>, <span class="number">55502</span>, <span class="number">7371</span>, <span class="number">14515</span>, <span class="number">41553</span>, <span class="number">12979</span>, <span class="number">1276</span>, <span class="number">45454</span>, <span class="number">56057</span>, <span class="number">51518</span>, <span class="number">30382</span>, <span class="number">30678</span>, <span class="number">60443</span>, <span class="number">58274</span>, <span class="number">50882</span>, <span class="number">64918</span>, <span class="number">34569</span>, <span class="number">58195</span>, <span class="number">34410</span>, <span class="number">47490</span>, <span class="number">13676</span>, <span class="number">37502</span>, <span class="number">61987</span>, <span class="number">7616</span>, <span class="number">11528</span>, <span class="number">13577</span>, <span class="number">51098</span>, <span class="number">5435</span>, <span class="number">51972</span>, <span class="number">63061</span>, <span class="number">55995</span>, <span class="number">21627</span>, <span class="number">2439</span>, <span class="number">47554</span>, <span class="number">6891</span>, <span class="number">53790</span>, <span class="number">62563</span>, <span class="number">38921</span>, <span class="number">30600</span>, <span class="number">49498</span>, <span class="number">49671</span>, <span class="number">38844</span>, <span class="number">42840</span>, <span class="number">49982</span>, <span class="number">16503</span>, <span class="number">13854</span>, <span class="number">63825</span>, <span class="number">25195</span>, <span class="number">41078</span>, <span class="number">36872</span>, <span class="number">36288</span>, <span class="number">63461</span>, <span class="number">29293</span>, <span class="number">28630</span>, <span class="number">23547</span>, <span class="number">57332</span>, <span class="number">43051</span>, <span class="number">49205</span>, <span class="number">14579</span>, <span class="number">23897</span>, <span class="number">944</span>, <span class="number">47223</span>, <span class="number">6819</span>, <span class="number">61851</span>, <span class="number">57886</span>, <span class="number">10858</span>, <span class="number">14380</span>, <span class="number">35796</span>, <span class="number">4509</span>, <span class="number">52576</span>, <span class="number">47112</span>, <span class="number">44349</span>, <span class="number">56553</span>, <span class="number">45075</span>, <span class="number">31505</span>, <span class="number">2779</span>, <span class="number">17216</span>, <span class="number">47395</span>, <span class="number">15024</span>, <span class="number">26498</span>, <span class="number">25299</span>, <span class="number">26548</span>, <span class="number">39954</span>, <span class="number">33242</span>, <span class="number">65187</span>, <span class="number">33291</span>, <span class="number">38861</span>, <span class="number">6956</span>, <span class="number">4371</span>, <span class="number">11762</span>, <span class="number">41126</span>, <span class="number">54447</span>, <span class="number">56384</span>, <span class="number">34835</span>, <span class="number">595</span>, <span class="number">52198</span>, <span class="number">13324</span>, <span class="number">38653</span>, <span class="number">21103</span>, <span class="number">34301</span>, <span class="number">20781</span>, <span class="number">64650</span>, <span class="number">17773</span>, <span class="number">1921</span>, <span class="number">46490</span>, <span class="number">37683</span>, <span class="number">27720</span>, <span class="number">7812</span>, <span class="number">49737</span>, <span class="number">20423</span>, <span class="number">16452</span>, <span class="number">52475</span>, <span class="number">27896</span>, <span class="number">49613</span>, <span class="number">60121</span>, <span class="number">54986</span>, <span class="number">30680</span>, <span class="number">37740</span>, <span class="number">8407</span>, <span class="number">30833</span>, <span class="number">29431</span>, <span class="number">62841</span>, <span class="number">27957</span>, <span class="number">57755</span>, <span class="number">59153</span>, <span class="number">44802</span>, <span class="number">42423</span>, <span class="number">28202</span>, <span class="number">54075</span>, <span class="number">3879</span>, <span class="number">25261</span>, <span class="number">57958</span>, <span class="number">53266</span>, <span class="number">22806</span>, <span class="number">64334</span>, <span class="number">34962</span>, <span class="number">57708</span>, <span class="number">20653</span>, <span class="number">17925</span>, <span class="number">59244</span>, <span class="number">38640</span>, <span class="number">31264</span>, <span class="number">7962</span>, <span class="number">5234</span>, <span class="number">16995</span>, <span class="number">35712</span>, <span class="number">39263</span>, <span class="number">33764</span>, <span class="number">9168</span>, <span class="number">59263</span>, <span class="number">6297</span>, <span class="number">28879</span>, <span class="number">54753</span>, <span class="number">31041</span>, <span class="number">42448</span>, <span class="number">57238</span>, <span class="number">52395</span>, <span class="number">61412</span>, <span class="number">29370</span>, <span class="number">52297</span>, <span class="number">21906</span>, <span class="number">36837</span>, <span class="number">62511</span>, <span class="number">13185</span>, <span class="number">53251</span>, <span class="number">47459</span>, <span class="number">47320</span>, <span class="number">24874</span>, <span class="number">5152</span>, <span class="number">63178</span>, <span class="number">20614</span>, <span class="number">808</span>, <span class="number">6789</span>, <span class="number">37043</span>, <span class="number">9713</span>, <span class="number">31692</span>, <span class="number">18319</span>, <span class="number">60295</span>, <span class="number">9628</span>, <span class="number">1053</span>, <span class="number">54874</span>, <span class="number">26808</span>, <span class="number">28046</span>, <span class="number">27964</span>, <span class="number">7534</span>, <span class="number">43316</span>, <span class="number">51573</span>, <span class="number">51143</span>, <span class="number">41954</span>, <span class="number">16366</span>, <span class="number">19618</span>, <span class="number">23676</span>, <span class="number">63245</span>, <span class="number">28329</span>, <span class="number">25170</span>, <span class="number">55118</span>, <span class="number">49376</span>, <span class="number">22296</span>, <span class="number">41638</span>, <span class="number">42595</span>, <span class="number">49291</span>, <span class="number">51001</span>, <span class="number">21173</span>, <span class="number">17098</span>, <span class="number">11956</span>, <span class="number">33292</span>, <span class="number">28909</span>, <span class="number">63160</span>, <span class="number">63480</span>, <span class="number">32649</span>, <span class="number">49809</span>, <span class="number">24112</span>, <span class="number">59503</span>, <span class="number">38840</span>, <span class="number">22914</span>, <span class="number">17473</span>, <span class="number">51978</span>, <span class="number">25420</span>, <span class="number">64060</span>, <span class="number">58894</span>, <span class="number">35793</span>, <span class="number">57163</span>, <span class="number">59038</span>, <span class="number">58787</span>, <span class="number">64067</span>, <span class="number">55780</span>, <span class="number">61906</span>, <span class="number">1696</span>, <span class="number">156</span>, <span class="number">25499</span>, <span class="number">57706</span>, <span class="number">47842</span>, <span class="number">47243</span>, <span class="number">14668</span>, <span class="number">17052</span>, <span class="number">57195</span>, <span class="number">53288</span>, <span class="number">49178</span>, <span class="number">2557</span>, <span class="number">31221</span>, <span class="number">17492</span>, <span class="number">11560</span>, <span class="number">23012</span>, <span class="number">9147</span>, <span class="number">44260</span>, <span class="number">22094</span>, <span class="number">53197</span>, <span class="number">40404</span>, <span class="number">21209</span>, <span class="number">30940</span>, <span class="number">18586</span>, <span class="number">48011</span>, <span class="number">60631</span>, <span class="number">8838</span>, <span class="number">13044</span>, <span class="number">5480</span>, <span class="number">19584</span>, <span class="number">20231</span>, <span class="number">15078</span>, <span class="number">58154</span>, <span class="number">8305</span>, <span class="number">55680</span>, <span class="number">49974</span>, <span class="number">2861</span>, <span class="number">58626</span>, <span class="number">61041</span>, <span class="number">47937</span>, <span class="number">42776</span>, <span class="number">35207</span>, <span class="number">39418</span>, <span class="number">12989</span>, <span class="number">1507</span>, <span class="number">5082</span>, <span class="number">23278</span>, <span class="number">26969</span>, <span class="number">10328</span>, <span class="number">18480</span>, <span class="number">34160</span>, <span class="number">55965</span>, <span class="number">59869</span>, <span class="number">197</span>, <span class="number">38066</span>, <span class="number">17097</span>, <span class="number">49306</span>, <span class="number">12749</span>, <span class="number">21846</span>, <span class="number">9946</span>, <span class="number">12323</span>, <span class="number">39813</span>, <span class="number">19141</span>, <span class="number">14950</span>, <span class="number">15987</span>, <span class="number">33630</span>, <span class="number">14715</span>, <span class="number">52499</span>, <span class="number">15978</span>, <span class="number">24078</span>, <span class="number">60217</span>, <span class="number">32262</span>, <span class="number">11645</span>, <span class="number">1649</span>, <span class="number">50062</span>, <span class="number">21979</span>, <span class="number">30545</span>, <span class="number">1450</span>, <span class="number">48657</span>, <span class="number">41697</span>, <span class="number">23357</span>, <span class="number">17880</span>, <span class="number">27613</span>, <span class="number">38277</span>, <span class="number">54988</span>, <span class="number">11074</span>, <span class="number">57591</span>, <span class="number">183</span>, <span class="number">62803</span>, <span class="number">8532</span>, <span class="number">61133</span>, <span class="number">26944</span>, <span class="number">63400</span>, <span class="number">53095</span>, <span class="number">8663</span>, <span class="number">59702</span>, <span class="number">19325</span>, <span class="number">24726</span>, <span class="number">51297</span>, <span class="number">21286</span>, <span class="number">2373</span>, <span class="number">38774</span>, <span class="number">20677</span>, <span class="number">29443</span>, <span class="number">24693</span>, <span class="number">20621</span>, <span class="number">14031</span>, <span class="number">45485</span>, <span class="number">34645</span>, <span class="number">9926</span>, <span class="number">12620</span>, <span class="number">1406</span>, <span class="number">41462</span>, <span class="number">50338</span>, <span class="number">25841</span>, <span class="number">61724</span>, <span class="number">41722</span>, <span class="number">11520</span>, <span class="number">48377</span>, <span class="number">34111</span>, <span class="number">50805</span>, <span class="number">23351</span>, <span class="number">64363</span>, <span class="number">50091</span>, <span class="number">35487</span>, <span class="number">49978</span>, <span class="number">41001</span>, <span class="number">37117</span>, <span class="number">17133</span>, <span class="number">54868</span>, <span class="number">58918</span>, <span class="number">17295</span>, <span class="number">16857</span>, <span class="number">45165</span>, <span class="number">5732</span>, <span class="number">46277</span>, <span class="number">54359</span>, <span class="number">64982</span>, <span class="number">2336</span>, <span class="number">61929</span>, <span class="number">40501</span>, <span class="number">18901</span>, <span class="number">39938</span>, <span class="number">949</span>, <span class="number">45839</span>, <span class="number">7519</span>, <span class="number">36935</span>, <span class="number">55287</span>, <span class="number">21096</span>, <span class="number">44443</span>, <span class="number">12240</span>, <span class="number">16160</span>, <span class="number">28355</span>, <span class="number">42275</span>, <span class="number">27747</span>, <span class="number">13398</span>, <span class="number">12395</span>, <span class="number">33973</span>, <span class="number">17137</span>, <span class="number">60697</span>, <span class="number">37064</span>, <span class="number">27782</span>, <span class="number">45671</span>, <span class="number">22264</span>, <span class="number">505</span>, <span class="number">20989</span>, <span class="number">57585</span>, <span class="number">4283</span>, <span class="number">43110</span>, <span class="number">28497</span>, <span class="number">25900</span>, <span class="number">16383</span>, <span class="number">13961</span>, <span class="number">24192</span>, <span class="number">29296</span>, <span class="number">34776</span>, <span class="number">36286</span>, <span class="number">18398</span>, <span class="number">55882</span>, <span class="number">28748</span>, <span class="number">54021</span>, <span class="number">673</span>, <span class="number">22723</span>, <span class="number">23699</span>, <span class="number">48463</span>, <span class="number">17316</span>, <span class="number">55309</span>, <span class="number">54229</span>, <span class="number">28342</span>, <span class="number">11147</span>, <span class="number">16132</span>, <span class="number">24344</span>, <span class="number">53367</span>, <span class="number">45597</span>, <span class="number">42843</span>, <span class="number">27078</span>, <span class="number">4034</span>, <span class="number">16975</span>, <span class="number">18534</span>, <span class="number">29674</span>, <span class="number">36962</span>, <span class="number">60773</span>, <span class="number">8030</span>, <span class="number">17118</span>, <span class="number">7392</span>, <span class="number">41627</span>, <span class="number">44768</span>, <span class="number">51104</span>, <span class="number">10876</span>, <span class="number">16293</span>, <span class="number">54589</span>, <span class="number">65082</span>, <span class="number">62573</span>, <span class="number">2679</span>, <span class="number">23869</span>, <span class="number">61905</span>, <span class="number">52526</span>, <span class="number">51584</span>, <span class="number">57063</span>, <span class="number">27294</span>, <span class="number">51821</span>, <span class="number">9070</span>, <span class="number">30961</span>, <span class="number">38741</span>, <span class="number">36309</span>, <span class="number">57422</span>, <span class="number">58231</span>, <span class="number">32775</span>, <span class="number">57469</span>, <span class="number">2306</span>, <span class="number">43632</span>, <span class="number">6110</span>, <span class="number">17478</span>, <span class="number">3399</span>, <span class="number">60718</span>, <span class="number">23947</span>, <span class="number">21488</span>, <span class="number">41712</span>, <span class="number">43552</span>, <span class="number">34154</span>, <span class="number">35374</span>, <span class="number">17522</span>, <span class="number">16603</span>, <span class="number">53459</span>, <span class="number">52136</span>, <span class="number">49823</span>, <span class="number">21443</span>, <span class="number">35049</span>, <span class="number">4854</span>, <span class="number">25769</span>, <span class="number">63782</span>, <span class="number">21355</span>, <span class="number">11189</span>, <span class="number">17330</span>, <span class="number">41173</span>, <span class="number">6620</span>, <span class="number">24475</span>, <span class="number">40910</span>, <span class="number">26100</span>, <span class="number">34752</span>, <span class="number">10491</span>, <span class="number">39327</span>, <span class="number">561</span>, <span class="number">24612</span>, <span class="number">36253</span>, <span class="number">41875</span>, <span class="number">1589</span>, <span class="number">44536</span>, <span class="number">64133</span>, <span class="number">37260</span>, <span class="number">24719</span>, <span class="number">21955</span>, <span class="number">40847</span>, <span class="number">8529</span>, <span class="number">12294</span>, <span class="number">22158</span>, <span class="number">31784</span>, <span class="number">32185</span>, <span class="number">18438</span>, <span class="number">9983</span>, <span class="number">9362</span>, <span class="number">46554</span>, <span class="number">8294</span>, <span class="number">11447</span>, <span class="number">38253</span>, <span class="number">32008</span>, <span class="number">44252</span>, <span class="number">14392</span>, <span class="number">36259</span>, <span class="number">40422</span>, <span class="number">53018</span>, <span class="number">41387</span>, <span class="number">61549</span>, <span class="number">43601</span>, <span class="number">24082</span>, <span class="number">64942</span>, <span class="number">50817</span>, <span class="number">18470</span>, <span class="number">52024</span>, <span class="number">19769</span>, <span class="number">38618</span>, <span class="number">54451</span>, <span class="number">44579</span>, <span class="number">48552</span>, <span class="number">52967</span>, <span class="number">3546</span>, <span class="number">13047</span>, <span class="number">19986</span>, <span class="number">752</span>, <span class="number">25560</span>, <span class="number">33608</span>, <span class="number">55220</span>, <span class="number">35170</span>, <span class="number">17378</span>, <span class="number">3632</span>, <span class="number">7932</span>, <span class="number">12764</span>, <span class="number">28016</span>, <span class="number">51153</span>, <span class="number">42067</span>, <span class="number">22380</span>, <span class="number">11170</span>, <span class="number">35549</span>, <span class="number">14546</span>, <span class="number">6725</span>, <span class="number">50718</span>, <span class="number">40157</span>, <span class="number">54482</span>, <span class="number">45086</span>, <span class="number">50180</span>, <span class="number">44396</span>, <span class="number">19469</span>, <span class="number">48734</span>, <span class="number">9003</span>, <span class="number">32234</span>, <span class="number">4973</span>, <span class="number">19031</span>, <span class="number">32744</span>, <span class="number">15216</span>, <span class="number">11167</span>, <span class="number">31666</span>, <span class="number">50585</span>, <span class="number">28017</span>, <span class="number">56213</span>, <span class="number">23276</span>, <span class="number">62789</span>, <span class="number">19240</span>, <span class="number">52247</span>, <span class="number">51360</span>, <span class="number">23933</span>, <span class="number">2117</span>, <span class="number">23909</span>, <span class="number">20136</span>, <span class="number">11108</span>, <span class="number">55792</span>, <span class="number">10848</span>, <span class="number">42772</span>, <span class="number">52949</span>, <span class="number">20973</span>, <span class="number">49997</span>, <span class="number">20027</span>, <span class="number">26803</span>, <span class="number">34251</span>, <span class="number">18768</span>, <span class="number">1273</span>, <span class="number">21372</span>, <span class="number">57638</span>, <span class="number">43004</span>, <span class="number">27339</span>, <span class="number">51671</span>, <span class="number">4505</span>, <span class="number">7193</span>, <span class="number">64268</span>, <span class="number">15856</span>, <span class="number">9038</span>, <span class="number">63520</span>, <span class="number">62076</span>, <span class="number">41936</span>, <span class="number">27929</span>, <span class="number">23469</span>, <span class="number">55533</span>, <span class="number">25007</span>, <span class="number">31555</span>, <span class="number">15349</span>, <span class="number">11603</span>, <span class="number">51345</span>, <span class="number">44304</span>, <span class="number">49007</span>, <span class="number">35765</span>, <span class="number">50361</span>, <span class="number">48434</span>, <span class="number">41407</span>, <span class="number">41415</span>, <span class="number">27322</span>, <span class="number">45767</span>, <span class="number">56009</span>, <span class="number">17808</span>, <span class="number">36797</span>, <span class="number">55785</span>, <span class="number">18842</span>, <span class="number">27904</span>, <span class="number">55984</span>, <span class="number">54213</span>, <span class="number">25742</span>, <span class="number">30451</span>, <span class="number">13819</span>, <span class="number">37675</span>, <span class="number">23224</span>, <span class="number">18337</span>, <span class="number">63137</span>, <span class="number">40370</span>, <span class="number">39116</span>, <span class="number">53931</span>, <span class="number">7352</span>, <span class="number">5724</span>, <span class="number">14040</span>, <span class="number">13609</span>, <span class="number">34023</span>, <span class="number">39058</span>, <span class="number">59660</span>, <span class="number">20699</span>, <span class="number">5752</span>, <span class="number">594</span>, <span class="number">53440</span>, <span class="number">58700</span>, <span class="number">58977</span>, <span class="number">11902</span>, <span class="number">11358</span>, <span class="number">54271</span>, <span class="number">52581</span>, <span class="number">63883</span>, <span class="number">4496</span>, <span class="number">65446</span>, <span class="number">8092</span>, <span class="number">32955</span>, <span class="number">1788</span>, <span class="number">7547</span>, <span class="number">30827</span>, <span class="number">42738</span>, <span class="number">51248</span>, <span class="number">13433</span>, <span class="number">52570</span>, <span class="number">45277</span>, <span class="number">4811</span>, <span class="number">59546</span>, <span class="number">17021</span>, <span class="number">32981</span>, <span class="number">6168</span>, <span class="number">45440</span>, <span class="number">41446</span>, <span class="number">43907</span>, <span class="number">44327</span>, <span class="number">22960</span>, <span class="number">48214</span>, <span class="number">53682</span>, <span class="number">39618</span>, <span class="number">65392</span>, <span class="number">31131</span>, <span class="number">36083</span>, <span class="number">31230</span>, <span class="number">15227</span>, <span class="number">1530</span>, <span class="number">21222</span>, <span class="number">11049</span>, <span class="number">27763</span>, <span class="number">5251</span>, <span class="number">56978</span>, <span class="number">12249</span>, <span class="number">55352</span>, <span class="number">54216</span>, <span class="number">24824</span>, <span class="number">65111</span>, <span class="number">21374</span>, <span class="number">42945</span>, <span class="number">57027</span>, <span class="number">3920</span>, <span class="number">32541</span>, <span class="number">65155</span>, <span class="number">12251</span>, <span class="number">19929</span>, <span class="number">19866</span>, <span class="number">58236</span>, <span class="number">22788</span>, <span class="number">54575</span>, <span class="number">53449</span>, <span class="number">16521</span>, <span class="number">55829</span>, <span class="number">14990</span>, <span class="number">8653</span>, <span class="number">55846</span>, <span class="number">6198</span>, <span class="number">24332</span>, <span class="number">28673</span>, <span class="number">50260</span>, <span class="number">60726</span>, <span class="number">55293</span>, <span class="number">35325</span>, <span class="number">4142</span>, <span class="number">28883</span>, <span class="number">19302</span>, <span class="number">31711</span>, <span class="number">10833</span>, <span class="number">62836</span>, <span class="number">27199</span>, <span class="number">14853</span>, <span class="number">21172</span>, <span class="number">61281</span>, <span class="number">43290</span>, <span class="number">23364</span>, <span class="number">62192</span>, <span class="number">58280</span>, <span class="number">64481</span>, <span class="number">40708</span>, <span class="number">17966</span>, <span class="number">54004</span>, <span class="number">1651</span>, <span class="number">1008</span>, <span class="number">12674</span>, <span class="number">54156</span>, <span class="number">48976</span>, <span class="number">60163</span>, <span class="number">47799</span>, <span class="number">14781</span>, <span class="number">37556</span>, <span class="number">58786</span>, <span class="number">14677</span>, <span class="number">16666</span>, <span class="number">22398</span>, <span class="number">41273</span>, <span class="number">22312</span>, <span class="number">49859</span>, <span class="number">4327</span>, <span class="number">54222</span>, <span class="number">52527</span>, <span class="number">35043</span>, <span class="number">35462</span>, <span class="number">33939</span>, <span class="number">30396</span>, <span class="number">17371</span>, <span class="number">10883</span>, <span class="number">42056</span>, <span class="number">31285</span>, <span class="number">7486</span>, <span class="number">33758</span>, <span class="number">62824</span>, <span class="number">58144</span>, <span class="number">19003</span>, <span class="number">17210</span>, <span class="number">28590</span>, <span class="number">39138</span>, <span class="number">20818</span>, <span class="number">58339</span>, <span class="number">7397</span>, <span class="number">30592</span>, <span class="number">54635</span>, <span class="number">33004</span>, <span class="number">6524</span>, <span class="number">54578</span>, <span class="number">21592</span>, <span class="number">33877</span>, <span class="number">37330</span>, <span class="number">51484</span>, <span class="number">18861</span>, <span class="number">26317</span>, <span class="number">426</span>, <span class="number">6365</span>, <span class="number">34363</span>, <span class="number">21922</span>, <span class="number">33037</span>, <span class="number">22209</span>, <span class="number">63283</span>, <span class="number">6463</span>, <span class="number">22503</span>, <span class="number">32397</span>, <span class="number">54053</span>, <span class="number">8538</span>, <span class="number">37449</span>, <span class="number">39658</span>, <span class="number">34111</span>, <span class="number">49684</span>, <span class="number">27364</span>, <span class="number">55762</span>, <span class="number">2892</span>, <span class="number">64875</span>, <span class="number">17558</span>, <span class="number">45202</span>, <span class="number">37747</span>, <span class="number">61781</span>, <span class="number">39006</span>, <span class="number">5</span>, <span class="number">55444</span>, <span class="number">4965</span>, <span class="number">65360</span>, <span class="number">45810</span>, <span class="number">23739</span>, <span class="number">51172</span>, <span class="number">37274</span>, <span class="number">39909</span>, <span class="number">58863</span>, <span class="number">28111</span>, <span class="number">449</span>, <span class="number">14406</span>, <span class="number">62190</span>, <span class="number">13688</span>, <span class="number">57145</span>, <span class="number">23653</span>, <span class="number">56791</span>, <span class="number">4065</span>, <span class="number">13079</span>, <span class="number">59309</span>, <span class="number">57940</span>, <span class="number">59317</span>, <span class="number">17968</span>, <span class="number">28037</span>, <span class="number">27233</span>, <span class="number">53242</span>, <span class="number">30901</span>, <span class="number">10758</span>, <span class="number">57188</span>, <span class="number">9100</span>, <span class="number">51760</span>, <span class="number">16566</span>, <span class="number">20555</span>, <span class="number">50514</span>, <span class="number">35271</span>, <span class="number">59680</span>, <span class="number">24646</span>, <span class="number">14768</span>, <span class="number">13335</span>, <span class="number">30246</span>, <span class="number">39364</span>, <span class="number">51795</span>, <span class="number">5031</span>, <span class="number">38107</span>, <span class="number">32158</span>, <span class="number">443</span>, <span class="number">10384</span>, <span class="number">6774</span>, <span class="number">47929</span>, <span class="number">15499</span>, <span class="number">50368</span>, <span class="number">51827</span>, <span class="number">54022</span>, <span class="number">18908</span>, <span class="number">2157</span>, <span class="number">9827</span>, <span class="number">14658</span>, <span class="number">16901</span>, <span class="number">40891</span>, <span class="number">5884</span>, <span class="number">51302</span>, <span class="number">10387</span>, <span class="number">10960</span>, <span class="number">16761</span>, <span class="number">26793</span>, <span class="number">55085</span>, <span class="number">35673</span>, <span class="number">35137</span>, <span class="number">13497</span>, <span class="number">28211</span>, <span class="number">60579</span>, <span class="number">60497</span>, <span class="number">47403</span>, <span class="number">9106</span>, <span class="number">59526</span>, <span class="number">10327</span>, <span class="number">8063</span>, <span class="number">41945</span>, <span class="number">5754</span>, <span class="number">57621</span>, <span class="number">26709</span>, <span class="number">22739</span>, <span class="number">25547</span>, <span class="number">24703</span>, <span class="number">20746</span>, <span class="number">3895</span>, <span class="number">44111</span>, <span class="number">51320</span>, <span class="number">42212</span>, <span class="number">59781</span>, <span class="number">29064</span>, <span class="number">44610</span>, <span class="number">16431</span>, <span class="number">39515</span>, <span class="number">18156</span>, <span class="number">14210</span>, <span class="number">27507</span>, <span class="number">47206</span>, <span class="number">41530</span>, <span class="number">44123</span>, <span class="number">29499</span>, <span class="number">47242</span>, <span class="number">50363</span>, <span class="number">3339</span>, <span class="number">57490</span>, <span class="number">36566</span>, <span class="number">48636</span>, <span class="number">49784</span>, <span class="number">10942</span>, <span class="number">64447</span>, <span class="number">26791</span>, <span class="number">52829</span>, <span class="number">53204</span>, <span class="number">55163</span>, <span class="number">32261</span>, <span class="number">32157</span>, <span class="number">58261</span>, <span class="number">41129</span>, <span class="number">60614</span>, <span class="number">30034</span>, <span class="number">55489</span>, <span class="number">55576</span>, <span class="number">25052</span>, <span class="number">4263</span>, <span class="number">32514</span>, <span class="number">1419</span>, <span class="number">22605</span>, <span class="number">56589</span>, <span class="number">48192</span>, <span class="number">44655</span>, <span class="number">61295</span>, <span class="number">8855</span>, <span class="number">42987</span>, <span class="number">26448</span>, <span class="number">33214</span>, <span class="number">46651</span>, <span class="number">56194</span>, <span class="number">28472</span>, <span class="number">12965</span>]</span><br><span class="line">flag_md5 = f5accae4111e6f6db6d4342a7662b970</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">prng = Random()</span><br><span class="line">length = <span class="number">19968</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myState</span>():</span><br><span class="line">    state = [<span class="number">0</span>]*<span class="number">624</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i&lt;length:</span><br><span class="line">        ind = i//<span class="number">32</span></span><br><span class="line">        expont = i%<span class="number">32</span></span><br><span class="line">        state[ind] = <span class="number">1</span>&lt;&lt;(<span class="number">31</span>-expont)</span><br><span class="line">        s = (<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">yield</span> s</span><br><span class="line">        state[ind] = <span class="number">0</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getRow</span>():</span><br><span class="line">    rng = Random()</span><br><span class="line">    gs = myState()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        s = <span class="built_in">next</span>(gs)</span><br><span class="line">        rng.setstate(s)</span><br><span class="line"><span class="comment">#         print(s[1][0])</span></span><br><span class="line">        data=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">16</span>):</span><br><span class="line">            data.extend(<span class="built_in">list</span>(<span class="built_in">bin</span>(rng.getrandbits(<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">16</span>)))</span><br><span class="line">        data=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">        row = vector(GF(<span class="number">2</span>),data)</span><br><span class="line">        <span class="keyword">yield</span> row</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildBox</span>():</span><br><span class="line">    b = matrix(GF(<span class="number">2</span>),length,length)</span><br><span class="line">    rg = getRow()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(length)):</span><br><span class="line">        b[i] = <span class="built_in">next</span>(rg)</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    prng = Random()</span><br><span class="line">    originState = prng.getstate()</span><br><span class="line">    <span class="comment"># 这里都是用的MSB,如果采用不同的二进制位(如LSB)最后的矩阵T 也会不同</span></span><br><span class="line">    leak=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">16</span>):</span><br><span class="line">        leak.extend(<span class="built_in">list</span>(<span class="built_in">bin</span>(prng.getrandbits(<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">16</span>)))</span><br><span class="line">    leak=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> leak]</span><br><span class="line">    leak = vector(GF(<span class="number">2</span>),leak)</span><br><span class="line">    T = buildBox()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Matirx&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> trange(T.nrows()):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(T.ncols()):</span><br><span class="line">                f.write(<span class="built_in">str</span>(T[i,j])+<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">    x = T.solve_left(leak)</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x.<span class="built_in">list</span>()])</span><br><span class="line">    state = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        tmp = <span class="built_in">int</span>(x[i*<span class="number">32</span>:(i+<span class="number">1</span>)*<span class="number">32</span>],<span class="number">2</span>)</span><br><span class="line">        state.append(tmp)</span><br><span class="line">    prng.setstate(originState)</span><br><span class="line">    prng.getrandbits(<span class="number">16</span>)</span><br><span class="line">    originState = [x <span class="keyword">for</span> x <span class="keyword">in</span> prng.getstate()[<span class="number">1</span>][:-<span class="number">1</span>]]</span><br><span class="line">    <span class="built_in">print</span>(originState[<span class="number">1</span>:] == state[<span class="number">1</span>:])</span><br><span class="line"><span class="comment">#     print(state)</span></span><br><span class="line">    <span class="keyword">return</span> state,T</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> build_matrix <span class="keyword">import</span> test</span><br><span class="line"><span class="comment"># 根据文件中的信息，构造矩阵</span></span><br><span class="line">length = <span class="number">19968</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildMatrix</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Matrix&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> f.read().split(<span class="string">&#x27;n&#x27;</span>)]</span><br><span class="line">    m=matrix(GF(<span class="number">2</span>),length,length,data)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># X = Z*(T^-1)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recoverState</span>(<span class="params">T,leak</span>):</span><br><span class="line">    x = T.solve_left(leak)</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x.<span class="built_in">list</span>()])</span><br><span class="line">    state = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        tmp = <span class="built_in">int</span>(x[i * <span class="number">32</span>:(i + <span class="number">1</span>) * <span class="number">32</span>], <span class="number">2</span>)</span><br><span class="line">        state.append(tmp)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据题型2,还原state,有两种可能,这时候可以用暴破</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backfirst</span>(<span class="params">state</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    tmp = state[<span class="number">623</span>] ^ state[<span class="number">396</span>]</span><br><span class="line">    <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">        tmp ^= mask</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">        tmp |= <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; <span class="number">32</span> - <span class="number">1</span>) | tmp &amp; low, tmp &amp; low</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    _, T = test()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;构建完成&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;T完成&quot;</span>)</span><br><span class="line">    prng = Random()</span><br><span class="line">    originState = prng.getstate()</span><br><span class="line">    leak=[<span class="number">47945</span>, <span class="number">50431</span>, <span class="number">10861</span>, <span class="number">5794</span>, <span class="number">26338</span>, <span class="number">2641</span>, <span class="number">58647</span>, <span class="number">52422</span>, <span class="number">35384</span>, <span class="number">50426</span>, <span class="number">58144</span>, <span class="number">2744</span>, <span class="number">7864</span>, <span class="number">25333</span>, <span class="number">3500</span>, <span class="number">59273</span>, <span class="number">38075</span>, <span class="number">38630</span>, <span class="number">18760</span>, <span class="number">19660</span>, <span class="number">54418</span>, <span class="number">53538</span>, <span class="number">20251</span>, <span class="number">25758</span>, <span class="number">4500</span>, <span class="number">14384</span>, <span class="number">40765</span>, <span class="number">43841</span>, <span class="number">62662</span>, <span class="number">64548</span>, <span class="number">6468</span>, <span class="number">8997</span>, <span class="number">20572</span>, <span class="number">9920</span>, <span class="number">64146</span>, <span class="number">49443</span>, <span class="number">32054</span>, <span class="number">56082</span>, <span class="number">21773</span>, <span class="number">38390</span>, <span class="number">14905</span>, <span class="number">47230</span>, <span class="number">43126</span>, <span class="number">37449</span>, <span class="number">1016</span>, <span class="number">23685</span>, <span class="number">48461</span>, <span class="number">13070</span>, <span class="number">58381</span>, <span class="number">51813</span>, <span class="number">48909</span>, <span class="number">10953</span>, <span class="number">31195</span>, <span class="number">1703</span>, <span class="number">33439</span>, <span class="number">54463</span>, <span class="number">63977</span>, <span class="number">29188</span>, <span class="number">44901</span>, <span class="number">53588</span>, <span class="number">32843</span>, <span class="number">9923</span>, <span class="number">2188</span>, <span class="number">42503</span>, <span class="number">53555</span>, <span class="number">44818</span>, <span class="number">55094</span>, <span class="number">40544</span>, <span class="number">25787</span>, <span class="number">34965</span>, <span class="number">65151</span>, <span class="number">37069</span>, <span class="number">6342</span>, <span class="number">36889</span>, <span class="number">51214</span>, <span class="number">58386</span>, <span class="number">34925</span>, <span class="number">9558</span>, <span class="number">33552</span>, <span class="number">29554</span>, <span class="number">30350</span>, <span class="number">20166</span>, <span class="number">4221</span>, <span class="number">61353</span>, <span class="number">50656</span>, <span class="number">7337</span>, <span class="number">1001</span>, <span class="number">18279</span>, <span class="number">27268</span>, <span class="number">49581</span>, <span class="number">37870</span>, <span class="number">54591</span>, <span class="number">12438</span>, <span class="number">13649</span>, <span class="number">42007</span>, <span class="number">33542</span>, <span class="number">18118</span>, <span class="number">48407</span>, <span class="number">34338</span>, <span class="number">12147</span>, <span class="number">19178</span>, <span class="number">8925</span>, <span class="number">31109</span>, <span class="number">12296</span>, <span class="number">52419</span>, <span class="number">392</span>, <span class="number">9296</span>, <span class="number">16055</span>, <span class="number">64775</span>, <span class="number">46394</span>, <span class="number">58494</span>, <span class="number">24157</span>, <span class="number">62237</span>, <span class="number">16211</span>, <span class="number">23935</span>, <span class="number">10368</span>, <span class="number">48440</span>, <span class="number">60061</span>, <span class="number">47813</span>, <span class="number">49032</span>, <span class="number">50836</span>, <span class="number">18404</span>, <span class="number">30552</span>, <span class="number">7142</span>, <span class="number">44142</span>, <span class="number">44549</span>, <span class="number">36078</span>, <span class="number">63112</span>, <span class="number">28345</span>, <span class="number">39821</span>, <span class="number">10004</span>, <span class="number">32221</span>, <span class="number">16021</span>, <span class="number">32152</span>, <span class="number">53113</span>, <span class="number">13857</span>, <span class="number">49328</span>, <span class="number">11817</span>, <span class="number">27777</span>, <span class="number">43088</span>, <span class="number">43453</span>, <span class="number">29962</span>, <span class="number">16338</span>, <span class="number">44353</span>, <span class="number">27974</span>, <span class="number">25145</span>, <span class="number">56050</span>, <span class="number">34129</span>, <span class="number">39236</span>, <span class="number">46167</span>, <span class="number">64639</span>, <span class="number">54581</span>, <span class="number">33004</span>, <span class="number">35652</span>, <span class="number">16294</span>, <span class="number">11109</span>, <span class="number">19396</span>, <span class="number">51476</span>, <span class="number">30332</span>, <span class="number">24701</span>, <span class="number">43628</span>, <span class="number">44507</span>, <span class="number">27688</span>, <span class="number">37172</span>, <span class="number">61339</span>, <span class="number">9893</span>, <span class="number">45217</span>, <span class="number">7969</span>, <span class="number">33523</span>, <span class="number">2495</span>, <span class="number">15578</span>, <span class="number">55444</span>, <span class="number">48564</span>, <span class="number">5055</span>, <span class="number">16048</span>, <span class="number">8512</span>, <span class="number">1819</span>, <span class="number">19702</span>, <span class="number">13388</span>, <span class="number">41099</span>, <span class="number">30256</span>, <span class="number">10592</span>, <span class="number">46063</span>, <span class="number">30881</span>, <span class="number">8338</span>, <span class="number">41214</span>, <span class="number">55255</span>, <span class="number">50060</span>, <span class="number">65028</span>, <span class="number">9114</span>, <span class="number">8417</span>, <span class="number">43767</span>, <span class="number">62760</span>, <span class="number">49830</span>, <span class="number">50660</span>, <span class="number">19358</span>, <span class="number">22142</span>, <span class="number">53025</span>, <span class="number">37930</span>, <span class="number">49155</span>, <span class="number">2150</span>, <span class="number">56194</span>, <span class="number">36251</span>, <span class="number">49654</span>, <span class="number">32395</span>, <span class="number">33677</span>, <span class="number">48743</span>, <span class="number">12627</span>, <span class="number">30575</span>, <span class="number">64001</span>, <span class="number">60220</span>, <span class="number">26908</span>, <span class="number">44207</span>, <span class="number">23532</span>, <span class="number">18430</span>, <span class="number">45511</span>, <span class="number">33553</span>, <span class="number">62631</span>, <span class="number">55155</span>, <span class="number">58715</span>, <span class="number">59152</span>, <span class="number">20864</span>, <span class="number">14790</span>, <span class="number">32774</span>, <span class="number">48679</span>, <span class="number">24325</span>, <span class="number">54109</span>, <span class="number">2747</span>, <span class="number">17046</span>, <span class="number">19083</span>, <span class="number">60413</span>, <span class="number">11773</span>, <span class="number">42188</span>, <span class="number">17011</span>, <span class="number">13361</span>, <span class="number">2105</span>, <span class="number">23067</span>, <span class="number">45439</span>, <span class="number">1122</span>, <span class="number">54117</span>, <span class="number">31435</span>, <span class="number">49692</span>, <span class="number">59556</span>, <span class="number">51893</span>, <span class="number">24342</span>, <span class="number">11073</span>, <span class="number">52326</span>, <span class="number">23237</span>, <span class="number">22930</span>, <span class="number">12691</span>, <span class="number">38125</span>, <span class="number">36714</span>, <span class="number">54043</span>, <span class="number">34880</span>, <span class="number">53599</span>, <span class="number">18609</span>, <span class="number">36631</span>, <span class="number">24367</span>, <span class="number">49135</span>, <span class="number">26821</span>, <span class="number">64486</span>, <span class="number">12154</span>, <span class="number">37534</span>, <span class="number">14100</span>, <span class="number">33744</span>, <span class="number">37183</span>, <span class="number">7652</span>, <span class="number">26403</span>, <span class="number">42166</span>, <span class="number">12290</span>, <span class="number">32315</span>, <span class="number">19153</span>, <span class="number">55490</span>, <span class="number">4558</span>, <span class="number">60768</span>, <span class="number">44149</span>, <span class="number">26258</span>, <span class="number">38676</span>, <span class="number">31228</span>, <span class="number">43610</span>, <span class="number">39357</span>, <span class="number">36475</span>, <span class="number">29434</span>, <span class="number">41437</span>, <span class="number">64762</span>, <span class="number">5251</span>, <span class="number">33641</span>, <span class="number">43819</span>, <span class="number">29769</span>, <span class="number">38136</span>, <span class="number">8348</span>, <span class="number">33123</span>, <span class="number">17571</span>, <span class="number">18343</span>, <span class="number">50569</span>, <span class="number">55502</span>, <span class="number">7371</span>, <span class="number">14515</span>, <span class="number">41553</span>, <span class="number">12979</span>, <span class="number">1276</span>, <span class="number">45454</span>, <span class="number">56057</span>, <span class="number">51518</span>, <span class="number">30382</span>, <span class="number">30678</span>, <span class="number">60443</span>, <span class="number">58274</span>, <span class="number">50882</span>, <span class="number">64918</span>, <span class="number">34569</span>, <span class="number">58195</span>, <span class="number">34410</span>, <span class="number">47490</span>, <span class="number">13676</span>, <span class="number">37502</span>, <span class="number">61987</span>, <span class="number">7616</span>, <span class="number">11528</span>, <span class="number">13577</span>, <span class="number">51098</span>, <span class="number">5435</span>, <span class="number">51972</span>, <span class="number">63061</span>, <span class="number">55995</span>, <span class="number">21627</span>, <span class="number">2439</span>, <span class="number">47554</span>, <span class="number">6891</span>, <span class="number">53790</span>, <span class="number">62563</span>, <span class="number">38921</span>, <span class="number">30600</span>, <span class="number">49498</span>, <span class="number">49671</span>, <span class="number">38844</span>, <span class="number">42840</span>, <span class="number">49982</span>, <span class="number">16503</span>, <span class="number">13854</span>, <span class="number">63825</span>, <span class="number">25195</span>, <span class="number">41078</span>, <span class="number">36872</span>, <span class="number">36288</span>, <span class="number">63461</span>, <span class="number">29293</span>, <span class="number">28630</span>, <span class="number">23547</span>, <span class="number">57332</span>, <span class="number">43051</span>, <span class="number">49205</span>, <span class="number">14579</span>, <span class="number">23897</span>, <span class="number">944</span>, <span class="number">47223</span>, <span class="number">6819</span>, <span class="number">61851</span>, <span class="number">57886</span>, <span class="number">10858</span>, <span class="number">14380</span>, <span class="number">35796</span>, <span class="number">4509</span>, <span class="number">52576</span>, <span class="number">47112</span>, <span class="number">44349</span>, <span class="number">56553</span>, <span class="number">45075</span>, <span class="number">31505</span>, <span class="number">2779</span>, <span class="number">17216</span>, <span class="number">47395</span>, <span class="number">15024</span>, <span class="number">26498</span>, <span class="number">25299</span>, <span class="number">26548</span>, <span class="number">39954</span>, <span class="number">33242</span>, <span class="number">65187</span>, <span class="number">33291</span>, <span class="number">38861</span>, <span class="number">6956</span>, <span class="number">4371</span>, <span class="number">11762</span>, <span class="number">41126</span>, <span class="number">54447</span>, <span class="number">56384</span>, <span class="number">34835</span>, <span class="number">595</span>, <span class="number">52198</span>, <span class="number">13324</span>, <span class="number">38653</span>, <span class="number">21103</span>, <span class="number">34301</span>, <span class="number">20781</span>, <span class="number">64650</span>, <span class="number">17773</span>, <span class="number">1921</span>, <span class="number">46490</span>, <span class="number">37683</span>, <span class="number">27720</span>, <span class="number">7812</span>, <span class="number">49737</span>, <span class="number">20423</span>, <span class="number">16452</span>, <span class="number">52475</span>, <span class="number">27896</span>, <span class="number">49613</span>, <span class="number">60121</span>, <span class="number">54986</span>, <span class="number">30680</span>, <span class="number">37740</span>, <span class="number">8407</span>, <span class="number">30833</span>, <span class="number">29431</span>, <span class="number">62841</span>, <span class="number">27957</span>, <span class="number">57755</span>, <span class="number">59153</span>, <span class="number">44802</span>, <span class="number">42423</span>, <span class="number">28202</span>, <span class="number">54075</span>, <span class="number">3879</span>, <span class="number">25261</span>, <span class="number">57958</span>, <span class="number">53266</span>, <span class="number">22806</span>, <span class="number">64334</span>, <span class="number">34962</span>, <span class="number">57708</span>, <span class="number">20653</span>, <span class="number">17925</span>, <span class="number">59244</span>, <span class="number">38640</span>, <span class="number">31264</span>, <span class="number">7962</span>, <span class="number">5234</span>, <span class="number">16995</span>, <span class="number">35712</span>, <span class="number">39263</span>, <span class="number">33764</span>, <span class="number">9168</span>, <span class="number">59263</span>, <span class="number">6297</span>, <span class="number">28879</span>, <span class="number">54753</span>, <span class="number">31041</span>, <span class="number">42448</span>, <span class="number">57238</span>, <span class="number">52395</span>, <span class="number">61412</span>, <span class="number">29370</span>, <span class="number">52297</span>, <span class="number">21906</span>, <span class="number">36837</span>, <span class="number">62511</span>, <span class="number">13185</span>, <span class="number">53251</span>, <span class="number">47459</span>, <span class="number">47320</span>, <span class="number">24874</span>, <span class="number">5152</span>, <span class="number">63178</span>, <span class="number">20614</span>, <span class="number">808</span>, <span class="number">6789</span>, <span class="number">37043</span>, <span class="number">9713</span>, <span class="number">31692</span>, <span class="number">18319</span>, <span class="number">60295</span>, <span class="number">9628</span>, <span class="number">1053</span>, <span class="number">54874</span>, <span class="number">26808</span>, <span class="number">28046</span>, <span class="number">27964</span>, <span class="number">7534</span>, <span class="number">43316</span>, <span class="number">51573</span>, <span class="number">51143</span>, <span class="number">41954</span>, <span class="number">16366</span>, <span class="number">19618</span>, <span class="number">23676</span>, <span class="number">63245</span>, <span class="number">28329</span>, <span class="number">25170</span>, <span class="number">55118</span>, <span class="number">49376</span>, <span class="number">22296</span>, <span class="number">41638</span>, <span class="number">42595</span>, <span class="number">49291</span>, <span class="number">51001</span>, <span class="number">21173</span>, <span class="number">17098</span>, <span class="number">11956</span>, <span class="number">33292</span>, <span class="number">28909</span>, <span class="number">63160</span>, <span class="number">63480</span>, <span class="number">32649</span>, <span class="number">49809</span>, <span class="number">24112</span>, <span class="number">59503</span>, <span class="number">38840</span>, <span class="number">22914</span>, <span class="number">17473</span>, <span class="number">51978</span>, <span class="number">25420</span>, <span class="number">64060</span>, <span class="number">58894</span>, <span class="number">35793</span>, <span class="number">57163</span>, <span class="number">59038</span>, <span class="number">58787</span>, <span class="number">64067</span>, <span class="number">55780</span>, <span class="number">61906</span>, <span class="number">1696</span>, <span class="number">156</span>, <span class="number">25499</span>, <span class="number">57706</span>, <span class="number">47842</span>, <span class="number">47243</span>, <span class="number">14668</span>, <span class="number">17052</span>, <span class="number">57195</span>, <span class="number">53288</span>, <span class="number">49178</span>, <span class="number">2557</span>, <span class="number">31221</span>, <span class="number">17492</span>, <span class="number">11560</span>, <span class="number">23012</span>, <span class="number">9147</span>, <span class="number">44260</span>, <span class="number">22094</span>, <span class="number">53197</span>, <span class="number">40404</span>, <span class="number">21209</span>, <span class="number">30940</span>, <span class="number">18586</span>, <span class="number">48011</span>, <span class="number">60631</span>, <span class="number">8838</span>, <span class="number">13044</span>, <span class="number">5480</span>, <span class="number">19584</span>, <span class="number">20231</span>, <span class="number">15078</span>, <span class="number">58154</span>, <span class="number">8305</span>, <span class="number">55680</span>, <span class="number">49974</span>, <span class="number">2861</span>, <span class="number">58626</span>, <span class="number">61041</span>, <span class="number">47937</span>, <span class="number">42776</span>, <span class="number">35207</span>, <span class="number">39418</span>, <span class="number">12989</span>, <span class="number">1507</span>, <span class="number">5082</span>, <span class="number">23278</span>, <span class="number">26969</span>, <span class="number">10328</span>, <span class="number">18480</span>, <span class="number">34160</span>, <span class="number">55965</span>, <span class="number">59869</span>, <span class="number">197</span>, <span class="number">38066</span>, <span class="number">17097</span>, <span class="number">49306</span>, <span class="number">12749</span>, <span class="number">21846</span>, <span class="number">9946</span>, <span class="number">12323</span>, <span class="number">39813</span>, <span class="number">19141</span>, <span class="number">14950</span>, <span class="number">15987</span>, <span class="number">33630</span>, <span class="number">14715</span>, <span class="number">52499</span>, <span class="number">15978</span>, <span class="number">24078</span>, <span class="number">60217</span>, <span class="number">32262</span>, <span class="number">11645</span>, <span class="number">1649</span>, <span class="number">50062</span>, <span class="number">21979</span>, <span class="number">30545</span>, <span class="number">1450</span>, <span class="number">48657</span>, <span class="number">41697</span>, <span class="number">23357</span>, <span class="number">17880</span>, <span class="number">27613</span>, <span class="number">38277</span>, <span class="number">54988</span>, <span class="number">11074</span>, <span class="number">57591</span>, <span class="number">183</span>, <span class="number">62803</span>, <span class="number">8532</span>, <span class="number">61133</span>, <span class="number">26944</span>, <span class="number">63400</span>, <span class="number">53095</span>, <span class="number">8663</span>, <span class="number">59702</span>, <span class="number">19325</span>, <span class="number">24726</span>, <span class="number">51297</span>, <span class="number">21286</span>, <span class="number">2373</span>, <span class="number">38774</span>, <span class="number">20677</span>, <span class="number">29443</span>, <span class="number">24693</span>, <span class="number">20621</span>, <span class="number">14031</span>, <span class="number">45485</span>, <span class="number">34645</span>, <span class="number">9926</span>, <span class="number">12620</span>, <span class="number">1406</span>, <span class="number">41462</span>, <span class="number">50338</span>, <span class="number">25841</span>, <span class="number">61724</span>, <span class="number">41722</span>, <span class="number">11520</span>, <span class="number">48377</span>, <span class="number">34111</span>, <span class="number">50805</span>, <span class="number">23351</span>, <span class="number">64363</span>, <span class="number">50091</span>, <span class="number">35487</span>, <span class="number">49978</span>, <span class="number">41001</span>, <span class="number">37117</span>, <span class="number">17133</span>, <span class="number">54868</span>, <span class="number">58918</span>, <span class="number">17295</span>, <span class="number">16857</span>, <span class="number">45165</span>, <span class="number">5732</span>, <span class="number">46277</span>, <span class="number">54359</span>, <span class="number">64982</span>, <span class="number">2336</span>, <span class="number">61929</span>, <span class="number">40501</span>, <span class="number">18901</span>, <span class="number">39938</span>, <span class="number">949</span>, <span class="number">45839</span>, <span class="number">7519</span>, <span class="number">36935</span>, <span class="number">55287</span>, <span class="number">21096</span>, <span class="number">44443</span>, <span class="number">12240</span>, <span class="number">16160</span>, <span class="number">28355</span>, <span class="number">42275</span>, <span class="number">27747</span>, <span class="number">13398</span>, <span class="number">12395</span>, <span class="number">33973</span>, <span class="number">17137</span>, <span class="number">60697</span>, <span class="number">37064</span>, <span class="number">27782</span>, <span class="number">45671</span>, <span class="number">22264</span>, <span class="number">505</span>, <span class="number">20989</span>, <span class="number">57585</span>, <span class="number">4283</span>, <span class="number">43110</span>, <span class="number">28497</span>, <span class="number">25900</span>, <span class="number">16383</span>, <span class="number">13961</span>, <span class="number">24192</span>, <span class="number">29296</span>, <span class="number">34776</span>, <span class="number">36286</span>, <span class="number">18398</span>, <span class="number">55882</span>, <span class="number">28748</span>, <span class="number">54021</span>, <span class="number">673</span>, <span class="number">22723</span>, <span class="number">23699</span>, <span class="number">48463</span>, <span class="number">17316</span>, <span class="number">55309</span>, <span class="number">54229</span>, <span class="number">28342</span>, <span class="number">11147</span>, <span class="number">16132</span>, <span class="number">24344</span>, <span class="number">53367</span>, <span class="number">45597</span>, <span class="number">42843</span>, <span class="number">27078</span>, <span class="number">4034</span>, <span class="number">16975</span>, <span class="number">18534</span>, <span class="number">29674</span>, <span class="number">36962</span>, <span class="number">60773</span>, <span class="number">8030</span>, <span class="number">17118</span>, <span class="number">7392</span>, <span class="number">41627</span>, <span class="number">44768</span>, <span class="number">51104</span>, <span class="number">10876</span>, <span class="number">16293</span>, <span class="number">54589</span>, <span class="number">65082</span>, <span class="number">62573</span>, <span class="number">2679</span>, <span class="number">23869</span>, <span class="number">61905</span>, <span class="number">52526</span>, <span class="number">51584</span>, <span class="number">57063</span>, <span class="number">27294</span>, <span class="number">51821</span>, <span class="number">9070</span>, <span class="number">30961</span>, <span class="number">38741</span>, <span class="number">36309</span>, <span class="number">57422</span>, <span class="number">58231</span>, <span class="number">32775</span>, <span class="number">57469</span>, <span class="number">2306</span>, <span class="number">43632</span>, <span class="number">6110</span>, <span class="number">17478</span>, <span class="number">3399</span>, <span class="number">60718</span>, <span class="number">23947</span>, <span class="number">21488</span>, <span class="number">41712</span>, <span class="number">43552</span>, <span class="number">34154</span>, <span class="number">35374</span>, <span class="number">17522</span>, <span class="number">16603</span>, <span class="number">53459</span>, <span class="number">52136</span>, <span class="number">49823</span>, <span class="number">21443</span>, <span class="number">35049</span>, <span class="number">4854</span>, <span class="number">25769</span>, <span class="number">63782</span>, <span class="number">21355</span>, <span class="number">11189</span>, <span class="number">17330</span>, <span class="number">41173</span>, <span class="number">6620</span>, <span class="number">24475</span>, <span class="number">40910</span>, <span class="number">26100</span>, <span class="number">34752</span>, <span class="number">10491</span>, <span class="number">39327</span>, <span class="number">561</span>, <span class="number">24612</span>, <span class="number">36253</span>, <span class="number">41875</span>, <span class="number">1589</span>, <span class="number">44536</span>, <span class="number">64133</span>, <span class="number">37260</span>, <span class="number">24719</span>, <span class="number">21955</span>, <span class="number">40847</span>, <span class="number">8529</span>, <span class="number">12294</span>, <span class="number">22158</span>, <span class="number">31784</span>, <span class="number">32185</span>, <span class="number">18438</span>, <span class="number">9983</span>, <span class="number">9362</span>, <span class="number">46554</span>, <span class="number">8294</span>, <span class="number">11447</span>, <span class="number">38253</span>, <span class="number">32008</span>, <span class="number">44252</span>, <span class="number">14392</span>, <span class="number">36259</span>, <span class="number">40422</span>, <span class="number">53018</span>, <span class="number">41387</span>, <span class="number">61549</span>, <span class="number">43601</span>, <span class="number">24082</span>, <span class="number">64942</span>, <span class="number">50817</span>, <span class="number">18470</span>, <span class="number">52024</span>, <span class="number">19769</span>, <span class="number">38618</span>, <span class="number">54451</span>, <span class="number">44579</span>, <span class="number">48552</span>, <span class="number">52967</span>, <span class="number">3546</span>, <span class="number">13047</span>, <span class="number">19986</span>, <span class="number">752</span>, <span class="number">25560</span>, <span class="number">33608</span>, <span class="number">55220</span>, <span class="number">35170</span>, <span class="number">17378</span>, <span class="number">3632</span>, <span class="number">7932</span>, <span class="number">12764</span>, <span class="number">28016</span>, <span class="number">51153</span>, <span class="number">42067</span>, <span class="number">22380</span>, <span class="number">11170</span>, <span class="number">35549</span>, <span class="number">14546</span>, <span class="number">6725</span>, <span class="number">50718</span>, <span class="number">40157</span>, <span class="number">54482</span>, <span class="number">45086</span>, <span class="number">50180</span>, <span class="number">44396</span>, <span class="number">19469</span>, <span class="number">48734</span>, <span class="number">9003</span>, <span class="number">32234</span>, <span class="number">4973</span>, <span class="number">19031</span>, <span class="number">32744</span>, <span class="number">15216</span>, <span class="number">11167</span>, <span class="number">31666</span>, <span class="number">50585</span>, <span class="number">28017</span>, <span class="number">56213</span>, <span class="number">23276</span>, <span class="number">62789</span>, <span class="number">19240</span>, <span class="number">52247</span>, <span class="number">51360</span>, <span class="number">23933</span>, <span class="number">2117</span>, <span class="number">23909</span>, <span class="number">20136</span>, <span class="number">11108</span>, <span class="number">55792</span>, <span class="number">10848</span>, <span class="number">42772</span>, <span class="number">52949</span>, <span class="number">20973</span>, <span class="number">49997</span>, <span class="number">20027</span>, <span class="number">26803</span>, <span class="number">34251</span>, <span class="number">18768</span>, <span class="number">1273</span>, <span class="number">21372</span>, <span class="number">57638</span>, <span class="number">43004</span>, <span class="number">27339</span>, <span class="number">51671</span>, <span class="number">4505</span>, <span class="number">7193</span>, <span class="number">64268</span>, <span class="number">15856</span>, <span class="number">9038</span>, <span class="number">63520</span>, <span class="number">62076</span>, <span class="number">41936</span>, <span class="number">27929</span>, <span class="number">23469</span>, <span class="number">55533</span>, <span class="number">25007</span>, <span class="number">31555</span>, <span class="number">15349</span>, <span class="number">11603</span>, <span class="number">51345</span>, <span class="number">44304</span>, <span class="number">49007</span>, <span class="number">35765</span>, <span class="number">50361</span>, <span class="number">48434</span>, <span class="number">41407</span>, <span class="number">41415</span>, <span class="number">27322</span>, <span class="number">45767</span>, <span class="number">56009</span>, <span class="number">17808</span>, <span class="number">36797</span>, <span class="number">55785</span>, <span class="number">18842</span>, <span class="number">27904</span>, <span class="number">55984</span>, <span class="number">54213</span>, <span class="number">25742</span>, <span class="number">30451</span>, <span class="number">13819</span>, <span class="number">37675</span>, <span class="number">23224</span>, <span class="number">18337</span>, <span class="number">63137</span>, <span class="number">40370</span>, <span class="number">39116</span>, <span class="number">53931</span>, <span class="number">7352</span>, <span class="number">5724</span>, <span class="number">14040</span>, <span class="number">13609</span>, <span class="number">34023</span>, <span class="number">39058</span>, <span class="number">59660</span>, <span class="number">20699</span>, <span class="number">5752</span>, <span class="number">594</span>, <span class="number">53440</span>, <span class="number">58700</span>, <span class="number">58977</span>, <span class="number">11902</span>, <span class="number">11358</span>, <span class="number">54271</span>, <span class="number">52581</span>, <span class="number">63883</span>, <span class="number">4496</span>, <span class="number">65446</span>, <span class="number">8092</span>, <span class="number">32955</span>, <span class="number">1788</span>, <span class="number">7547</span>, <span class="number">30827</span>, <span class="number">42738</span>, <span class="number">51248</span>, <span class="number">13433</span>, <span class="number">52570</span>, <span class="number">45277</span>, <span class="number">4811</span>, <span class="number">59546</span>, <span class="number">17021</span>, <span class="number">32981</span>, <span class="number">6168</span>, <span class="number">45440</span>, <span class="number">41446</span>, <span class="number">43907</span>, <span class="number">44327</span>, <span class="number">22960</span>, <span class="number">48214</span>, <span class="number">53682</span>, <span class="number">39618</span>, <span class="number">65392</span>, <span class="number">31131</span>, <span class="number">36083</span>, <span class="number">31230</span>, <span class="number">15227</span>, <span class="number">1530</span>, <span class="number">21222</span>, <span class="number">11049</span>, <span class="number">27763</span>, <span class="number">5251</span>, <span class="number">56978</span>, <span class="number">12249</span>, <span class="number">55352</span>, <span class="number">54216</span>, <span class="number">24824</span>, <span class="number">65111</span>, <span class="number">21374</span>, <span class="number">42945</span>, <span class="number">57027</span>, <span class="number">3920</span>, <span class="number">32541</span>, <span class="number">65155</span>, <span class="number">12251</span>, <span class="number">19929</span>, <span class="number">19866</span>, <span class="number">58236</span>, <span class="number">22788</span>, <span class="number">54575</span>, <span class="number">53449</span>, <span class="number">16521</span>, <span class="number">55829</span>, <span class="number">14990</span>, <span class="number">8653</span>, <span class="number">55846</span>, <span class="number">6198</span>, <span class="number">24332</span>, <span class="number">28673</span>, <span class="number">50260</span>, <span class="number">60726</span>, <span class="number">55293</span>, <span class="number">35325</span>, <span class="number">4142</span>, <span class="number">28883</span>, <span class="number">19302</span>, <span class="number">31711</span>, <span class="number">10833</span>, <span class="number">62836</span>, <span class="number">27199</span>, <span class="number">14853</span>, <span class="number">21172</span>, <span class="number">61281</span>, <span class="number">43290</span>, <span class="number">23364</span>, <span class="number">62192</span>, <span class="number">58280</span>, <span class="number">64481</span>, <span class="number">40708</span>, <span class="number">17966</span>, <span class="number">54004</span>, <span class="number">1651</span>, <span class="number">1008</span>, <span class="number">12674</span>, <span class="number">54156</span>, <span class="number">48976</span>, <span class="number">60163</span>, <span class="number">47799</span>, <span class="number">14781</span>, <span class="number">37556</span>, <span class="number">58786</span>, <span class="number">14677</span>, <span class="number">16666</span>, <span class="number">22398</span>, <span class="number">41273</span>, <span class="number">22312</span>, <span class="number">49859</span>, <span class="number">4327</span>, <span class="number">54222</span>, <span class="number">52527</span>, <span class="number">35043</span>, <span class="number">35462</span>, <span class="number">33939</span>, <span class="number">30396</span>, <span class="number">17371</span>, <span class="number">10883</span>, <span class="number">42056</span>, <span class="number">31285</span>, <span class="number">7486</span>, <span class="number">33758</span>, <span class="number">62824</span>, <span class="number">58144</span>, <span class="number">19003</span>, <span class="number">17210</span>, <span class="number">28590</span>, <span class="number">39138</span>, <span class="number">20818</span>, <span class="number">58339</span>, <span class="number">7397</span>, <span class="number">30592</span>, <span class="number">54635</span>, <span class="number">33004</span>, <span class="number">6524</span>, <span class="number">54578</span>, <span class="number">21592</span>, <span class="number">33877</span>, <span class="number">37330</span>, <span class="number">51484</span>, <span class="number">18861</span>, <span class="number">26317</span>, <span class="number">426</span>, <span class="number">6365</span>, <span class="number">34363</span>, <span class="number">21922</span>, <span class="number">33037</span>, <span class="number">22209</span>, <span class="number">63283</span>, <span class="number">6463</span>, <span class="number">22503</span>, <span class="number">32397</span>, <span class="number">54053</span>, <span class="number">8538</span>, <span class="number">37449</span>, <span class="number">39658</span>, <span class="number">34111</span>, <span class="number">49684</span>, <span class="number">27364</span>, <span class="number">55762</span>, <span class="number">2892</span>, <span class="number">64875</span>, <span class="number">17558</span>, <span class="number">45202</span>, <span class="number">37747</span>, <span class="number">61781</span>, <span class="number">39006</span>, <span class="number">5</span>, <span class="number">55444</span>, <span class="number">4965</span>, <span class="number">65360</span>, <span class="number">45810</span>, <span class="number">23739</span>, <span class="number">51172</span>, <span class="number">37274</span>, <span class="number">39909</span>, <span class="number">58863</span>, <span class="number">28111</span>, <span class="number">449</span>, <span class="number">14406</span>, <span class="number">62190</span>, <span class="number">13688</span>, <span class="number">57145</span>, <span class="number">23653</span>, <span class="number">56791</span>, <span class="number">4065</span>, <span class="number">13079</span>, <span class="number">59309</span>, <span class="number">57940</span>, <span class="number">59317</span>, <span class="number">17968</span>, <span class="number">28037</span>, <span class="number">27233</span>, <span class="number">53242</span>, <span class="number">30901</span>, <span class="number">10758</span>, <span class="number">57188</span>, <span class="number">9100</span>, <span class="number">51760</span>, <span class="number">16566</span>, <span class="number">20555</span>, <span class="number">50514</span>, <span class="number">35271</span>, <span class="number">59680</span>, <span class="number">24646</span>, <span class="number">14768</span>, <span class="number">13335</span>, <span class="number">30246</span>, <span class="number">39364</span>, <span class="number">51795</span>, <span class="number">5031</span>, <span class="number">38107</span>, <span class="number">32158</span>, <span class="number">443</span>, <span class="number">10384</span>, <span class="number">6774</span>, <span class="number">47929</span>, <span class="number">15499</span>, <span class="number">50368</span>, <span class="number">51827</span>, <span class="number">54022</span>, <span class="number">18908</span>, <span class="number">2157</span>, <span class="number">9827</span>, <span class="number">14658</span>, <span class="number">16901</span>, <span class="number">40891</span>, <span class="number">5884</span>, <span class="number">51302</span>, <span class="number">10387</span>, <span class="number">10960</span>, <span class="number">16761</span>, <span class="number">26793</span>, <span class="number">55085</span>, <span class="number">35673</span>, <span class="number">35137</span>, <span class="number">13497</span>, <span class="number">28211</span>, <span class="number">60579</span>, <span class="number">60497</span>, <span class="number">47403</span>, <span class="number">9106</span>, <span class="number">59526</span>, <span class="number">10327</span>, <span class="number">8063</span>, <span class="number">41945</span>, <span class="number">5754</span>, <span class="number">57621</span>, <span class="number">26709</span>, <span class="number">22739</span>, <span class="number">25547</span>, <span class="number">24703</span>, <span class="number">20746</span>, <span class="number">3895</span>, <span class="number">44111</span>, <span class="number">51320</span>, <span class="number">42212</span>, <span class="number">59781</span>, <span class="number">29064</span>, <span class="number">44610</span>, <span class="number">16431</span>, <span class="number">39515</span>, <span class="number">18156</span>, <span class="number">14210</span>, <span class="number">27507</span>, <span class="number">47206</span>, <span class="number">41530</span>, <span class="number">44123</span>, <span class="number">29499</span>, <span class="number">47242</span>, <span class="number">50363</span>, <span class="number">3339</span>, <span class="number">57490</span>, <span class="number">36566</span>, <span class="number">48636</span>, <span class="number">49784</span>, <span class="number">10942</span>, <span class="number">64447</span>, <span class="number">26791</span>, <span class="number">52829</span>, <span class="number">53204</span>, <span class="number">55163</span>, <span class="number">32261</span>, <span class="number">32157</span>, <span class="number">58261</span>, <span class="number">41129</span>, <span class="number">60614</span>, <span class="number">30034</span>, <span class="number">55489</span>, <span class="number">55576</span>, <span class="number">25052</span>, <span class="number">4263</span>, <span class="number">32514</span>, <span class="number">1419</span>, <span class="number">22605</span>, <span class="number">56589</span>, <span class="number">48192</span>, <span class="number">44655</span>, <span class="number">61295</span>, <span class="number">8855</span>, <span class="number">42987</span>, <span class="number">26448</span>, <span class="number">33214</span>, <span class="number">46651</span>, <span class="number">56194</span>, <span class="number">28472</span>, <span class="number">12965</span>]</span><br><span class="line">    leak1=[<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> leak[:<span class="number">19968</span>//<span class="number">16</span>]])]</span><br><span class="line">    leak1 = matrix(GF(<span class="number">2</span>), leak1)</span><br><span class="line">    <span class="comment"># 恢复state</span></span><br><span class="line">    state = recoverState(T,leak1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;state恢复完成&quot;</span>)</span><br><span class="line">    <span class="comment"># 两种可能</span></span><br><span class="line">    guess1, guess2 = backfirst(state)</span><br><span class="line">    <span class="built_in">print</span>(guess1, guess2)</span><br><span class="line">    state[<span class="number">0</span>] = guess1</span><br><span class="line">    s = state</span><br><span class="line">    prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;first&quot;</span>)</span><br><span class="line">        prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        now =  [prng.getrandbits(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1250</span>)]</span><br><span class="line">        <span class="keyword">if</span> now == leak:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(prng.getrandbits(<span class="number">64</span>))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    state[<span class="number">0</span>] = guess2</span><br><span class="line">    s = state</span><br><span class="line">    prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;second&quot;</span>)</span><br><span class="line">        prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        now =  [prng.getrandbits(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1250</span>)]</span><br><span class="line">        <span class="keyword">if</span> now == leak:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(prng.getrandbits(<span class="number">64</span>))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>







<h1 id="CTF2022——ezRSA"><a href="#CTF2022——ezRSA" class="headerlink" title="*CTF2022——ezRSA"></a>*CTF2022——ezRSA</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime</span><br><span class="line"><span class="keyword">from</span> gmpy <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">q=next_prime(p^((<span class="number">1</span>&lt;&lt;<span class="number">900</span>)-<span class="number">1</span>)^getrandbits(<span class="number">300</span>))</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m=<span class="built_in">int</span>(flag.encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">assert</span> m&lt;n</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(n))</span><br><span class="line"><span class="comment">#0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(c))</span><br><span class="line"><span class="comment">#0xd7f6c90512bc9494370c3955ff3136bb245a6d1095e43d8636f66f11db525f2063b14b2a4363a96e6eb1bea1e9b2cc62b0cae7659f18f2b8e41fca557281a1e859e8e6b35bd114655b6bf5e454753653309a794fa52ff2e79433ca4bbeb1ab9a78ec49f49ebee2636abd9dd9b80306ae1b87a86c8012211bda88e6e14c58805feb6721a01481d1a7031eb3333375a81858ff3b58d8837c188ffcb982a631e1a7a603b947a6984bd78516c71cfc737aaba479688d56df2c0952deaf496a4eb3f603a46a90efbe9e82a6aef8cfb23e5fcb938c9049b227b7f15c878bd99b61b6c56db7dfff43cd457429d5dcdb5fe314f1cdf317d0c5202bad6a9770076e9b25b1</span></span><br></pre></td></tr></table></figure>

<p> 考点是高位攻击，不过没那么明显</p>
<h2 id="高124位"><a href="#高124位" class="headerlink" title="高124位"></a>高124位</h2><p>因为<code>q=next_prime(p^((1&lt;&lt;900)-1)^getrandbits(300))</code>，异或并不影响高124位，所以$p$和$q$的高124位一样</p>
<h3 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h3><p>第一种方法是把$n$的前248位进行开根号得到$p,q$的高位</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line">x = <span class="built_in">int</span>(gmpy2.iroot(n&gt;&gt;(<span class="number">2048</span>-<span class="number">248</span>),<span class="number">2</span>)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h3 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h3><p>第二种方法是解方程</p>
<p>先是令$p &#x3D; p_{h} + p_l$，$q &#x3D; q_h+q_l$，$p_h &#x3D; q_h &#x3D; x$</p>
<p>于是$n &#x3D; pq &#x3D; 2^{1800}x^2+2^{900}x×(2^{900}-1+c) + p_lq_l\longrightarrow n &#x3D; 2^{1800}x^2+2^{1800}x + t$</p>
<p>$t$相对来说比较小，可以忽略，解$n &#x3D; 2^{1800}x^2 + 2^{1800}x$就可以得到高位</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">n = <span class="number">0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line"></span><br><span class="line">var(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f = x^<span class="number">2</span> + x - n//<span class="number">2</span>^<span class="number">1800</span>					</span><br><span class="line"><span class="built_in">print</span>(solve([f],[x]))</span><br><span class="line"><span class="comment"># x = 20226195070633070235386534147535171929</span></span><br></pre></td></tr></table></figure>

<h2 id="中间600位"><a href="#中间600位" class="headerlink" title="中间600位"></a>中间600位</h2><h3 id="思路1-1"><a href="#思路1-1" class="headerlink" title="思路1"></a>思路1</h3><p>对于中间300~900共600位，是不受后面一个异或影响的，p和q每位都是相反的</p>
<p>于是$p+q \approx 2(x&lt;&lt;900) + \color{red}2^{900}-2^{300}$</p>
<p>根据费马分解$n &#x3D; \frac{(p+q)^2}{4}-\frac{(p-q)^2}{4}$</p>
<p>所以有$\because p-q &#x3D; \sqrt{4n - (p+q)^2}$，</p>
<p>$\therefore p &#x3D; \frac{(p+q)+(p-q)}{2} &#x3D; \frac{2(x&lt;&lt;900)+2^{900}-2^{300}+\sqrt{4n-(p+q)^2}}{2}$</p>
<h3 id="思路2-1"><a href="#思路2-1" class="headerlink" title="思路2"></a>思路2</h3><p>已知p,q的300~900位是相反的，将这一段设为极端情况——p全为1，q全为0。</p>
<p>根据基本不等式，p、q的差值越大，积就越大</p>
<p>当$pq&lt;n$时，表示这个位置的数正确</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line">x = <span class="built_in">int</span>(gmpy2.iroot(n&gt;&gt;(<span class="number">2048</span>-<span class="number">248</span>),<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">p = x&lt;&lt;<span class="number">900</span> | (<span class="number">2</span>**<span class="number">900</span> - <span class="number">1</span>)		<span class="comment">#低900位全是1</span></span><br><span class="line">q = x&lt;&lt;<span class="number">900</span>						<span class="comment">#低900位全是0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">899</span>, <span class="number">300</span>, -<span class="number">1</span>):</span><br><span class="line">    cur = <span class="number">1</span>&lt;&lt;i</span><br><span class="line">    <span class="comment"># 下面的操作是把p的1变成0,q的0变成1</span></span><br><span class="line">    <span class="comment"># 如果改变后的pq小于n，说明是对的</span></span><br><span class="line">    <span class="keyword">if</span> (p^cur) * (q^cur) &lt; n:</span><br><span class="line">        p ^= cur</span><br><span class="line">        q ^= cur</span><br></pre></td></tr></table></figure>

<h2 id="低位"><a href="#低位" class="headerlink" title="低位"></a>低位</h2><p>最后就是用copper</p>
<p><strong>疑惑点就是这里，两种思路求出这个近似的p之后，不是只差低300位不知道了吗？</strong></p>
<p>为什么<code>small_roots(X)</code>的X上限不是$2^{300}$</p>
<p>最后我觉得的可能应该<code>small_roots()</code>的应用前提是已知576位，然后差了(1024-576 &#x3D; 448)位，所以把上限定在了</p>
<p>$2^{450}$</p>
<h1 id="三胞胎素数"><a href="#三胞胎素数" class="headerlink" title="三胞胎素数"></a>三胞胎素数</h1><p>题目来源[TSGCTF 2021]Beginner’s Crypto 2021</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secret import e</span><br><span class="line">from Crypto.Util.number import getStrongPrime, isPrime</span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    flag = int.from_bytes(f.read(), &#x27;big&#x27;)</span><br><span class="line"></span><br><span class="line">assert(isPrime(e))</span><br><span class="line">assert(isPrime(e + 2))</span><br><span class="line">assert(isPrime(e + 4))</span><br><span class="line"></span><br><span class="line">e1 = pow(e, 0x10001, phi)</span><br><span class="line">e2 = pow(e + 2, 0x10001, phi)</span><br><span class="line">e3 = pow(e + 4, 0x10001, phi)</span><br><span class="line"></span><br><span class="line">c1 = pow(flag, e1, N)</span><br><span class="line">c2 = pow(flag, e2, N)</span><br><span class="line">c3 = pow(flag, e3, N)</span><br><span class="line"></span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;q = &#123;q&#125;&#x27;)</span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c2&#125;&#x27;)</span><br><span class="line">print(f&#x27;c3 = &#123;c3&#125;&#x27;)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">p = 167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span><br><span class="line">q = 130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span><br><span class="line">c1 = 2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span><br><span class="line">c2 = 9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span><br><span class="line">c3 = 3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">assert(isPrime(e))</span><br><span class="line">assert(isPrime(e + 2))</span><br><span class="line">assert(isPrime(e + 4))</span><br></pre></td></tr></table></figure>

<p>满足这样条件的$e$只有$e&#x3D;3$</p>
<h2 id="一些定义："><a href="#一些定义：" class="headerlink" title="一些定义："></a>一些定义：</h2><h3 id="孪生素数"><a href="#孪生素数" class="headerlink" title="孪生素数"></a>孪生素数</h3><p><strong>指差等于2的两个素数。</strong></p>
<h3 id="三胞胎素数-1"><a href="#三胞胎素数-1" class="headerlink" title="三胞胎素数"></a>三胞胎素数</h3><p><strong>指三个连续素数，使得其中最大的一个减去最小一个的差不超过6</strong>。</p>
<p>事实上，除了最小的两组三胞胎素数：$(2, 3, 5)$ 和 $(3, 5, 7)$，其它的三胞胎素数都是相差达到<strong>6</strong>的三元数组。除了以上两个特例以外，三胞胎素数分为两类：</p>
<p>A类三胞胎素数，构成为$p$，$p+2$，$p+6$，相差2的两个孪生素数在前面，例如：$(5，7，11)$；$(11，13，17)$； $(17，19，23)$；等等。</p>
<p>B类三胞胎素数，构成为$p$，$p+4$，$p+6$，相差2的两个孪生素数在后面，例如：(7，11，13)；(13，17，19)；(37，41，43)；等等。</p>
<p>当素数p 大于3时，可以证明形同$p$，$p+2$，$p+4$的数组不可能是三胞胎素数。事实上，这三个数对3的模两两不同，所以必然有一个能被3整除。然而这三个数都比3要大，因此一定有一个是3的倍数，从而这个数不是素数。</p>
<p>详见：<a href="https://zh.wikibooks.org/wiki/%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0">三胞胎素数 - 维基教科书，自由的教学读本 (wikibooks.org)</a></p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>知道$e&#x3D;3$之后就已知$e_1,e_2,e_3$，然后共模攻击</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = <span class="number">167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span></span><br><span class="line">q = <span class="number">130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span></span><br><span class="line">c1 = <span class="number">2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span></span><br><span class="line">c2 = <span class="number">9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span></span><br><span class="line">c3 = <span class="number">3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span></span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="built_in">pow</span>(e, <span class="number">0x10001</span>, phi)</span><br><span class="line">e2 = <span class="built_in">pow</span>(e + <span class="number">2</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line">e3 = <span class="built_in">pow</span>(e + <span class="number">4</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line"></span><br><span class="line">ee = [e1,e2,e3]</span><br><span class="line">cc = [c1,c2,c3]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            s,x,y = gmpy2.gcdext(ee[i],ee[j])</span><br><span class="line">            m = <span class="built_in">pow</span>(cc[i],x,N) * <span class="built_in">pow</span>(cc[j],y,N) % N</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">           </span><br></pre></td></tr></table></figure>

<h1 id="以下是有关论文的题目"><a href="#以下是有关论文的题目" class="headerlink" title="以下是有关论文的题目"></a>以下是有关论文的题目</h1><h2 id="N-ma-2-nb-2-mc-2-nd-2"><a href="#N-ma-2-nb-2-mc-2-nd-2" class="headerlink" title="N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2"></a>N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2</h2><p>论文：<a href="https://www.jstor.org/stable/0b4b4e65-c7fc-3c15-b716-723b58ec2b20?read-now=1&seq=1">A Note on Euler’s Factoring Problem on JSTOR</a></p>
<p>另外一个链接：[elementary number theory - A generalization of Euler Factorization with $N &#x3D; m a^2 + n b^2 &#x3D; m c^2 + n d^2$ - Mathematics Stack Exchange](<a href="https://math.stackexchange.com/questions/4712807/a-generalization-of-euler-factorization-with-n-m-a2-n-b2-m-c2-n-d2#:~:text=John">https://math.stackexchange.com/questions/4712807/a-generalization-of-euler-factorization-with-n-m-a2-n-b2-m-c2-n-d2#:~:text=John</a> Brillhart discusses a generalization of this method,%3D ma2 %2B nb2 %3D mc2 %2B nd2%2C)</p>
<h3 id="题目来源-NSSCTF-Round11——-ez-fac"><a href="#题目来源-NSSCTF-Round11——-ez-fac" class="headerlink" title="题目来源 NSSCTF#Round11——[ez_fac]"></a>题目来源 NSSCTF#Round11——[ez_fac]</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,a0,a1,b0,b1</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a0=&quot;</span>,a0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a1=&quot;</span>,a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b0=&quot;</span>,b0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b1=&quot;</span>,b1)</span><br></pre></td></tr></table></figure>

<p>论文大体内容就是：</p>
<p>如果$N &#x3D; ma^2 + nb^2$，且$N&#x3D;mc^2+nd^2$</p>
<p>$N$即可分解为$N&#x3D; (N,ad-bc)×\frac{n}{(N,ad-bc)}$，括号就是最大公因数</p>
<p>所以$p &#x3D; gcd(N,ad-bc)$</p>
<p>本题还需要推导一下e</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c= <span class="number">34007465638566836660852768374211870538357285529060206826620688555044780516477877596651414637089490522614456532732711803500304737160162560168303462221485961593760966240770414498297915175227814336224871400766371471776600674705757656616409870237891336752248110367865552469248343708419900511716030176178698949179</span></span><br><span class="line">n= <span class="number">70043427687738872803871163276488213173780425282753969243938124727004843810522473265066937344440899712569316720945145873584064860810161865485251816597432836666987134938760506657782143983431621481190009008491725207321741725979791393566155990005404328775785526238494554357279069151540867533082875900530405903003</span></span><br><span class="line">a0= <span class="number">8369195163678456889416121467476480674288621867182572824570660596055739410903686466334448920102666056798356927389728982948229326705483052970212882852055482</span></span><br><span class="line">a1= <span class="number">8369195163678456889416121462308686152524805984209312455308229689034789710117101859597220211456125364647704791637845189120538925088375209397006380815921158</span></span><br><span class="line">b0= <span class="number">25500181489306553053743739056022091355379036380919737553326529889338409847082228856006303427136881468093863020843230477979</span></span><br><span class="line">b1= <span class="number">31448594528370020763962343185054872105044827103889010592635556324009793301024988530934510929565983517651356856506719032859</span></span><br><span class="line"></span><br><span class="line">tmp = a0*b1 - a1*b0</span><br><span class="line">e = (n - <span class="built_in">pow</span>(a0,<span class="number">2</span>)) // <span class="built_in">pow</span>(b0,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(tmp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="n-p-r×q"><a href="#n-p-r×q" class="headerlink" title="n &#x3D; p^r×q"></a>n &#x3D; p^r×q</h2><h3 id="题目来源-D-3CTF-2022-——d3factor"><a href="#题目来源-D-3CTF-2022-——d3factor" class="headerlink" title="题目来源[D^3CTF 2022] ——d3factor"></a>题目来源[D^3CTF 2022] ——d3factor</h3><p>论文：<a href="https://eprint.iacr.org/2015/399.pdf">399.pdf (iacr.org)</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long, getPrime</span><br><span class="line">from secret import msg</span><br><span class="line">from sympy import nextprime</span><br><span class="line">from gmpy2 import invert</span><br><span class="line">from hashlib import md5</span><br><span class="line"></span><br><span class="line">flag = &#x27;d3ctf&#123;&#x27;+md5(msg).hexdigest()+&#x27;&#125;&#x27;</span><br><span class="line">p = getPrime(256)</span><br><span class="line">q = getPrime(256)</span><br><span class="line">assert p &gt; q</span><br><span class="line">n = p * q</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(msg)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">N = pow(p, 7) * q</span><br><span class="line">phi = pow(p, 6) * (p - 1) * (q - 1)</span><br><span class="line">d1 = getPrime(2000)</span><br><span class="line">d2 = nextprime(d1 + getPrime(1000))</span><br><span class="line">e1 = invert(d1, phi)</span><br><span class="line">e2 = invert(d2, phi)</span><br><span class="line"></span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">print(f&#x27;N = &#123;N&#125;&#x27;)</span><br><span class="line">print(f&#x27;e1 = &#123;e1&#125;&#x27;)</span><br><span class="line">print(f&#x27;e2 = &#123;e2&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c = </span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="论文内容及证明过程"><a href="#论文内容及证明过程" class="headerlink" title="论文内容及证明过程"></a>论文内容及证明过程</h3><p><img src="/../images/paper/0.png"></p>
<p>论文大致内容就是<strong>对于</strong>$N &#x3D; p^rq$，<strong>当两个解密密钥</strong>$d_1$,$d_2$差值不超过$N^{\frac{r(r-1)}{(r+1)^2}}$</p>
<p>即$|d_1-d_2| &lt; N^{\frac{r(r-1)}{(r+1)^2}}$的时候，可以在多项式的时间内分解出$p$</p>
<p>其证明过程如下：</p>
<p>$\because N &#x3D;p^rq$，$\phi(N) &#x3D; p^{r-1}(p-1)(q-1)$</p>
<p>有<br>$$<br>\left{\begin{matrix}<br>e_1d_1 \equiv 1 \mod \phi(N) \quad ①\<br>e_2d_2 \equiv 1 \mod \phi(N) \quad ②\<br>\end{matrix}\right.\<br>$$<br>把①式乘$e_2$，②式乘$e_1$再相减得</p>
<p>$e_1e_2(d_1-d_2)-(e_2-e_1) \equiv 0 \mod \phi(N)$</p>
<p>根据论文，把$\phi(N)$用$p^{r-1}$替代掉</p>
<p>则有$e_1e_2(d_1-d_2)-(e_2-e_1) \equiv 0 \mod p^{r-1}$</p>
<p>$d_1-d_2$就是$e_1e_2x - (e_2-e_1) \equiv 0 \mod p^{r-1}$的根</p>
<p>可以用coppersmith求出$x$</p>
<p>然后计算$gcd(e_1e_2x - (e_2-e_1),N) &#x3D; gcd(k×p^{r-1}(p-1)(q-1),p^rq) &#x3D; g$</p>
<p>利用这个g<br>$$<br>p &#x3D;<br>\left{\begin{matrix}<br>g^{\frac{1}{r-1}},\quad if\quad  g &#x3D; p^{r-1}\<br>g^{\frac{1}{r}},\quad if \quad g &#x3D; p^r\<br>\frac{N}{g},\quad if\quad  g &#x3D; p^{r-1}q<br>\end{matrix}\right.<br>$$</p>
<h3 id="本题解答"><a href="#本题解答" class="headerlink" title="本题解答"></a>本题解答</h3><p>根据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">7</span>) * q</span><br><span class="line">phi = <span class="built_in">pow</span>(p, <span class="number">6</span>) * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d1 = getPrime(<span class="number">2000</span>)</span><br><span class="line">d2 = nextprime(d1 + getPrime(<span class="number">1000</span>))</span><br></pre></td></tr></table></figure>

<p>可以判断出$|d_1-d_2|\approx 1000bit$，$N&#x3D; 2048bbit$，所以$|d_1-d_2|&lt;N^{\frac{r(r-1)}{(r+1)^2}} \approx 1344bit $</p>
<p>满足论文条件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">2420624631315473673388732074340410215657378096737020976722603529598864338532404224879219059105950005655100728361198499550862405660043591919681568611707967</span></span><br><span class="line">N = <span class="number">1476751427633071977599571983301151063258376731102955975364111147037204614220376883752032253407881568290520059515340434632858734689439268479399482315506043425541162646523388437842149125178447800616137044219916586942207838674001004007237861470176454543718752182312318068466051713087927370670177514666860822341380494154077020472814706123209865769048722380888175401791873273850281384147394075054950169002165357490796510950852631287689747360436384163758289159710264469722036320819123313773301072777844457895388797742631541101152819089150281489897683508400098693808473542212963868834485233858128220055727804326451310080791</span></span><br><span class="line">e1 = <span class="number">425735006018518321920113858371691046233291394270779139216531379266829453665704656868245884309574741300746121946724344532456337490492263690989727904837374279175606623404025598533405400677329916633307585813849635071097268989906426771864410852556381279117588496262787146588414873723983855041415476840445850171457530977221981125006107741100779529209163446405585696682186452013669643507275620439492021019544922913941472624874102604249376990616323884331293660116156782891935217575308895791623826306100692059131945495084654854521834016181452508329430102813663713333608459898915361745215871305547069325129687311358338082029</span></span><br><span class="line">e2 = <span class="number">1004512650658647383814190582513307789549094672255033373245432814519573537648997991452158231923692387604945039180687417026069655569594454408690445879849410118502279459189421806132654131287284719070037134752526923855821229397612868419416851456578505341237256609343187666849045678291935806441844686439591365338539029504178066823886051731466788474438373839803448380498800384597878814991008672054436093542513518012957106825842251155935855375353004898840663429274565622024673235081082222394015174831078190299524112112571718817712276118850981261489528540025810396786605197437842655180663611669918785635193552649262904644919</span></span><br><span class="line"></span><br><span class="line">a = e1 * e2</span><br><span class="line">b = (e2 - e1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(N))			</span><br><span class="line">f = a*x - b</span><br><span class="line">f = f.monic()</span><br><span class="line">res =  f.small_roots(<span class="number">2</span>^<span class="number">1000</span>,beta = <span class="number">0.4</span>)		<span class="comment">#根据d1-d2大概的范围确定上限</span></span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">int</span>(res[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">g = gcd(a*ans - b,N)</span><br><span class="line"><span class="comment">#print(g.nbits())</span></span><br><span class="line"><span class="comment">#g = 1534bit</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(g,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line">q = N // (p^<span class="number">7</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">msg = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;d3ctf&#123;&quot;</span> + md5(msg).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>$\because g &#x3D; 1534bit$，$\therefore p &#x3D; g^{\frac{1}{6}}$</p>
<h2 id="RSA与格结合，且多组n-e-c"><a href="#RSA与格结合，且多组n-e-c" class="headerlink" title="RSA与格结合，且多组n,e,c"></a>RSA与格结合，且多组n,e,c</h2><h3 id="题目来源-NUSTCTF-2022-新生赛-——lattice"><a href="#题目来源-NUSTCTF-2022-新生赛-——lattice" class="headerlink" title="题目来源[NUSTCTF 2022 新生赛]——lattice"></a>题目来源[NUSTCTF 2022 新生赛]——lattice</h3><p>论文：<a href="https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf">IJCSI-9-2-1-311-314.pdf</a></p>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import randint</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">d = getPrime(randint(370, 390))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def enc(i):</span><br><span class="line">    print()</span><br><span class="line">    p = getPrime(512)</span><br><span class="line">    q = getPrime(512)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    e = inverse(d, phi)</span><br><span class="line">    c = pow(flag, e, n)</span><br><span class="line">    print(f&#x27;e_&#123;i&#125; =&#x27;, e)</span><br><span class="line">    print(f&#x27;n_&#123;i&#125; =&#x27;, n)</span><br><span class="line">    print(f&#x27;c_&#123;i&#125; =&#x27;, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(3):</span><br><span class="line">        enc(i)</span><br><span class="line"></span><br><span class="line"># e_0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line"># n_0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line"># c_0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line"># e_1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line"># n_1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line"># c_1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line"># e_2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line"># n_2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line"># c_2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br></pre></td></tr></table></figure>



<p>令$M &#x3D; \sqrt{N_{max}}$，$M$是一组$N$中最大的$N$并且开根号。这组$N$满足：$N_1&lt;N_2&lt;\dots&lt;N_r &lt;2N_1$</p>
<p>又$\because e_id \equiv 1 (\mod \phi(N_i))$</p>
<p>这里把它写成$e_id &#x3D; 1+k_i\phi{N_i}$</p>
<p>假设$\phi(N_i)$可以写成$k_i(N_i-s_i)$的形式。其中$|s_i&lt;3N_i^{\frac{1}{2}}|$</p>
<p>则$e_id &#x3D; 1 + k_i(N_i-s_i)$</p>
<p>化简得$e_id-k_iN_i &#x3D; 1-k_is_i$</p>
<p>所以我们有$r+1$个等式:</p>
<p><img src="/../images/Lattice2/10.png"></p>
<p>写成矩阵相乘的形式</p>
<p><img src="/../images/Lattice2/11.png"></p>
<p>因为最后的目标向量满足LLL算法，所以我们可以得到$dM$</p>
<p>求得$dM$之后，我们可以求得$d$</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line">n0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line">c0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line">e1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line">n1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line">c1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line">e2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line">n2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line">c2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [n0,n1,n2]</span><br><span class="line">M = isqrt(max(n))</span><br><span class="line"></span><br><span class="line">ge = [[M,e0,e1,e2],</span><br><span class="line">    [0,-n0,0,0],</span><br><span class="line">    [0,0,-n1,0],</span><br><span class="line">    [0,0,0,-n2]]</span><br><span class="line">Ge = Matrix(ZZ,ge)</span><br><span class="line"></span><br><span class="line">dM = Ge.LLL()[0][0]</span><br><span class="line">d = abs(dM) // M</span><br><span class="line">m = pow(c0,d,n0)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h2 id="cve-of-RSA"><a href="#cve-of-RSA" class="headerlink" title="cve of RSA"></a>cve of RSA</h2><p>论文：<a href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf">The Return of Coppersmith’s Attack:Practical Factorization of Widely Used RSA Moduli (muni.cz)</a></p>
<p>如果p,q是以$p &#x3D; k×M + 65537^a \mod M$的形式产生的，M是个光滑数</p>
<p>攻击脚本：<a href="https://github.com/jvdsn/crypto-attacks">jvdsn&#x2F;crypto-attacks: Python implementations of cryptographic attacks and utilities. (github.com)</a></p>
<p>根据结论调参</p>
<p><img src="/../images/paper/1.png"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kbits = <span class="number">37</span></span><br><span class="line">abit = <span class="number">62</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    k = getRandomNBitInteger(kbits)</span><br><span class="line">    a = getRandomNBitInteger(abit)</span><br><span class="line">    p = k * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, a, M)</span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    l = getRandomNBitInteger(kbits)</span><br><span class="line">    b = getRandomNBitInteger(abit)</span><br><span class="line">    q = l * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, b, M)</span><br><span class="line">    <span class="keyword">if</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="comment"># N = 10375505512698590697230540440656541719204263636911186773264796164624307537559854575146689396086897683887657357280574643827597720286007334491967184402911331</span></span><br><span class="line"><span class="comment"># c = 9452671754308991307639149928469686004498992794878178108851267184995226471125632100149955622693448809888842182351036616823747409631021412523576720606919605</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> Zmod</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> factor</span><br><span class="line"></span><br><span class="line">path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.realpath(os.path.abspath(__file__)))))</span><br><span class="line"><span class="keyword">if</span> sys.path[<span class="number">1</span>] != path:</span><br><span class="line">    sys.path.insert(<span class="number">1</span>, path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> shared.small_roots <span class="keyword">import</span> howgrave_graham</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_prime_power_divisors</span>(<span class="params">M</span>):</span><br><span class="line">    divisors = []</span><br><span class="line">    <span class="keyword">for</span> p, e <span class="keyword">in</span> factor(M):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e + <span class="number">1</span>):</span><br><span class="line">            divisors.append(p ** i)</span><br><span class="line"></span><br><span class="line">    divisors.sort()</span><br><span class="line">    <span class="keyword">return</span> divisors</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Algorithm 2.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_max_M_</span>(<span class="params">M, ord_</span>):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> _prime_power_divisors(M):</span><br><span class="line">        ordp = Zmod(p)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">        <span class="keyword">if</span> ord_ % ordp != <span class="number">0</span>:</span><br><span class="line">            M //= p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Section 2.7.2.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_greedy_find_M_</span>(<span class="params">n, M</span>):</span><br><span class="line">    <span class="built_in">ord</span> = Zmod(M)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        best_r = <span class="number">0</span></span><br><span class="line">        best_ord_ = <span class="built_in">ord</span></span><br><span class="line">        best_M_ = M</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> _prime_power_divisors(<span class="built_in">ord</span>):</span><br><span class="line">            ord_ = <span class="built_in">ord</span> // p</span><br><span class="line">            M_ = compute_max_M_(M, ord_)</span><br><span class="line">            r = (log2(<span class="built_in">ord</span>) - log2(ord_)) / (log2(M) - log2(M_))</span><br><span class="line">            <span class="keyword">if</span> r &gt; best_r:</span><br><span class="line">                best_r = r</span><br><span class="line">                best_ord_ = ord_</span><br><span class="line">                best_M_ = M_</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> log2(best_M_) &lt; log2(n) / <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line">        <span class="built_in">ord</span> = best_ord_</span><br><span class="line">        M = best_M_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, M, m, t, g=<span class="number">65537</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus using the ROCA method.</span></span><br><span class="line"><span class="string">    More information: Nemec M. et al., &quot;The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli&quot;</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param M: the primorial used to generate the primes</span></span><br><span class="line"><span class="string">    :param m: the m parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param t: the t parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param g: the generator value (default: 65537)</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    logging.info(<span class="string">&quot;Generating M&#x27;...&quot;</span>)</span><br><span class="line">    M_ = _greedy_find_M_(N, M)</span><br><span class="line">    zmodm_ = Zmod(M_)</span><br><span class="line">    g = zmodm_(g)</span><br><span class="line">    c_ = zmodm_(N).log(g)</span><br><span class="line">    ord_ = g.multiplicative_order()</span><br><span class="line"></span><br><span class="line">    x = Zmod(N)[<span class="string">&quot;x&quot;</span>].gen()</span><br><span class="line">    X = <span class="built_in">int</span>(<span class="number">2</span> * N ** <span class="number">0.5</span> // M_)</span><br><span class="line">    logging.info(<span class="string">&quot;Starting exhaustive a&#x27; search...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> a_ <span class="keyword">in</span> <span class="built_in">range</span>(c_ // <span class="number">2</span>, (c_ + ord_) // <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">        f = M_ * x + <span class="built_in">int</span>(g ** a_)</span><br><span class="line">        <span class="keyword">for</span> k_, <span class="keyword">in</span> howgrave_graham.modular_univariate(f, N, m, t, X):</span><br><span class="line">            p = <span class="built_in">int</span>(f(k_))</span><br><span class="line">            <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> p, N // p</span><br><span class="line">      </span><br><span class="line">N=<span class="number">10375505512698590697230540440656541719204263636911186773264796164624307537559854575146689396086897683887657357280574643827597720286007334491967184402911331</span></span><br><span class="line">M=<span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">m = <span class="number">5</span></span><br><span class="line">t = <span class="number">6</span></span><br><span class="line">p,q = factorize(N,M,m,t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个脚本我是在sagemath跑的</p>
<p>得到p,q后有手就行</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">85179386137518452231354185509698113331528483782580002217930594759662020757433</span></span><br><span class="line">q=<span class="number">121807704694511224555991770528701515984374557330058194205583818929517699002107</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">9452671754308991307639149928469686004498992794878178108851267184995226471125632100149955622693448809888842182351036616823747409631021412523576720606919605</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="有限域上的不可约多项式RSA体制"><a href="#有限域上的不可约多项式RSA体制" class="headerlink" title="有限域上的不可约多项式RSA体制"></a>有限域上的不可约多项式RSA体制</h1><h2 id="TCTF2019——babyrsa"><a href="#TCTF2019——babyrsa" class="headerlink" title="TCTF2019——babyrsa"></a>TCTF2019——babyrsa</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pubkey <span class="keyword">import</span> P, n, e</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = GF(<span class="number">2</span>^<span class="number">2049</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">global</span> n</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(m) &lt;= <span class="number">256</span></span><br><span class="line">    m_int = Integer(m.encode(<span class="string">&#x27;hex&#x27;</span>), <span class="number">16</span>)</span><br><span class="line">    m_poly = P(R.fetch_int(m_int))</span><br><span class="line">    c_poly = <span class="built_in">pow</span>(m_poly, e, n)</span><br><span class="line">    c_int = R(c_poly).integer_representation()</span><br><span class="line">    c = <span class="built_in">format</span>(c_int, <span class="string">&#x27;0256x&#x27;</span>).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ptext = flag + os.urandom(<span class="number">256</span>-<span class="built_in">len</span>(flag))</span><br><span class="line">    ctext = encrypt(ptext)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(ctext)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> GF, PolynomialRing</span><br><span class="line"></span><br><span class="line">P=PolynomialRing(GF(<span class="number">2</span>),<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line">n = P(省略)</span><br></pre></td></tr></table></figure>

<p><code>R.fetch_int(m_int)</code>：把整型数据转化成环<code>R</code>上的元素</p>
<p><code>R(c_poly).integer_representation()</code>：把环<code>R</code>上的元素变成整型数据</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = GF(<span class="number">2</span>^<span class="number">2049</span>)</span><br><span class="line">P = PolynomialRing(GF(<span class="number">2</span>),<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line">n = P(<span class="string">&#x27;x^2048 + x^2046 + x^2043 + x^2040 + x^2036 + x^2035 + x^2034 + x^2033 + x^2031 + x^2029 + x^2025 + x^2024 + x^2022 + x^2019 + x^2018 + x^2017 + x^2012 + x^2007 + x^2006 + x^2004 + x^2000 + x^1999 + x^1998 + x^1997 + x^1993 + x^1992 + x^1991 + x^1986 + x^1982 + x^1981 + x^1979 + x^1978 + x^1977 + x^1975 + x^1970 + x^1964 + x^1963 + x^1962 + x^1961 + x^1960 + x^1959 + x^1958 + x^1955 + x^1954 + x^1952 + x^1951 + x^1949 + x^1947 + x^1942 + x^1939 + x^1938 + x^1936 + x^1934 + x^1933 + x^1932 + x^1930 + x^1928 + x^1927 + x^1923 + x^1922 + x^1919 + x^1918 + x^1915 + x^1914 + x^1913 + x^1912 + x^1911 + x^1910 + x^1908 + x^1903 + x^1902 + x^1900 + x^1899 + x^1897 + x^1893 + x^1891 + x^1890 + x^1886 + x^1881 + x^1880 + x^1879 + x^1878 + x^1875 + x^1874 + x^1873 + x^1872 + x^1871 + x^1870 + x^1869 + x^1865 + x^1863 + x^1862 + x^1860 + x^1856 + x^1855 + x^1853 + x^1852 + x^1845 + x^1841 + x^1839 + x^1837 + x^1836 + x^1835 + x^1833 + x^1832 + x^1829 + x^1828 + x^1827 + x^1826 + x^1824 + x^1823 + x^1822 + x^1821 + x^1820 + x^1819 + x^1818 + x^1817 + x^1813 + x^1812 + x^1810 + x^1809 + x^1808 + x^1807 + x^1803 + x^1799 + x^1797 + x^1796 + x^1794 + x^1792 + x^1790 + x^1786 + x^1783 + x^1782 + x^1779 + x^1778 + x^1776 + x^1775 + x^1774 + x^1772 + x^1767 + x^1766 + x^1765 + x^1764 + x^1763 + x^1762 + x^1759 + x^1757 + x^1756 + x^1754 + x^1753 + x^1752 + x^1750 + x^1749 + x^1741 + x^1734 + x^1730 + x^1729 + x^1726 + x^1725 + x^1723 + x^1722 + x^1721 + x^1716 + x^1714 + x^1713 + x^1712 + x^1710 + x^1709 + x^1706 + x^1705 + x^1703 + x^1702 + x^1700 + x^1698 + x^1693 + x^1692 + x^1691 + x^1690 + x^1683 + x^1682 + x^1681 + x^1680 + x^1679 + x^1677 + x^1672 + x^1670 + x^1669 + x^1666 + x^1663 + x^1662 + x^1661 + x^1659 + x^1655 + x^1653 + x^1651 + x^1649 + x^1648 + x^1647 + x^1646 + x^1644 + x^1643 + x^1642 + x^1640 + x^1639 + x^1638 + x^1634 + x^1633 + x^1628 + x^1620 + x^1619 + x^1618 + x^1616 + x^1614 + x^1611 + x^1610 + x^1608 + x^1605 + x^1604 + x^1603 + x^1599 + x^1597 + x^1595 + x^1594 + x^1590 + x^1588 + x^1587 + x^1585 + x^1583 + x^1580 + x^1579 + x^1577 + x^1574 + x^1573 + x^1572 + x^1568 + x^1566 + x^1565 + x^1563 + x^1562 + x^1560 + x^1555 + x^1554 + x^1552 + x^1550 + x^1549 + x^1548 + x^1545 + x^1544 + x^1542 + x^1540 + x^1538 + x^1537 + x^1536 + x^1535 + x^1534 + x^1533 + x^1532 + x^1531 + x^1528 + x^1526 + x^1525 + x^1523 + x^1522 + x^1521 + x^1519 + x^1517 + x^1515 + x^1510 + x^1509 + x^1506 + x^1504 + x^1502 + x^1499 + x^1498 + x^1497 + x^1488 + x^1483 + x^1480 + x^1477 + x^1472 + x^1471 + x^1469 + x^1468 + x^1467 + x^1466 + x^1464 + x^1462 + x^1457 + x^1456 + x^1455 + x^1454 + x^1453 + x^1452 + x^1448 + x^1446 + x^1444 + x^1443 + x^1442 + x^1441 + x^1440 + x^1436 + x^1435 + x^1431 + x^1428 + x^1425 + x^1424 + x^1422 + x^1420 + x^1415 + x^1414 + x^1411 + x^1410 + x^1408 + x^1406 + x^1405 + x^1403 + x^1402 + x^1399 + x^1397 + x^1396 + x^1395 + x^1394 + x^1393 + x^1391 + x^1388 + x^1385 + x^1377 + x^1376 + x^1372 + x^1371 + x^1370 + x^1369 + x^1367 + x^1363 + x^1361 + x^1357 + x^1355 + x^1354 + x^1349 + x^1343 + x^1339 + x^1338 + x^1337 + x^1336 + x^1335 + x^1332 + x^1329 + x^1327 + x^1326 + x^1324 + x^1321 + x^1315 + x^1314 + x^1312 + x^1310 + x^1309 + x^1305 + x^1304 + x^1303 + x^1302 + x^1299 + x^1298 + x^1296 + x^1295 + x^1293 + x^1291 + x^1290 + x^1289 + x^1284 + x^1283 + x^1282 + x^1281 + x^1280 + x^1278 + x^1277 + x^1276 + x^1275 + x^1272 + x^1270 + x^1269 + x^1268 + x^1267 + x^1259 + x^1257 + x^1254 + x^1252 + x^1251 + x^1249 + x^1247 + x^1246 + x^1244 + x^1240 + x^1238 + x^1233 + x^1232 + x^1229 + x^1222 + x^1219 + x^1217 + x^1211 + x^1209 + x^1208 + x^1205 + x^1204 + x^1203 + x^1202 + x^1200 + x^1197 + x^1196 + x^1195 + x^1193 + x^1192 + x^1189 + x^1187 + x^1186 + x^1185 + x^1184 + x^1183 + x^1182 + x^1181 + x^1177 + x^1176 + x^1173 + x^1170 + x^1167 + x^1166 + x^1162 + x^1161 + x^1160 + x^1159 + x^1158 + x^1156 + x^1155 + x^1154 + x^1153 + x^1151 + x^1146 + x^1143 + x^1141 + x^1139 + x^1138 + x^1137 + x^1135 + x^1131 + x^1129 + x^1128 + x^1125 + x^1124 + x^1122 + x^1116 + x^1115 + x^1114 + x^1112 + x^1111 + x^1107 + x^1106 + x^1105 + x^1104 + x^1103 + x^1102 + x^1098 + x^1097 + x^1095 + x^1094 + x^1092 + x^1088 + x^1087 + x^1085 + x^1077 + x^1076 + x^1075 + x^1072 + x^1069 + x^1068 + x^1061 + x^1060 + x^1059 + x^1057 + x^1055 + x^1054 + x^1053 + x^1050 + x^1047 + x^1046 + x^1044 + x^1043 + x^1042 + x^1036 + x^1029 + x^1025 + x^1024 + x^1023 + x^1022 + x^1019 + x^1016 + x^1013 + x^1012 + x^1010 + x^1008 + x^1007 + x^1006 + x^1004 + x^1000 + x^996 + x^995 + x^993 + x^992 + x^989 + x^985 + x^983 + x^978 + x^977 + x^975 + x^972 + x^971 + x^970 + x^969 + x^967 + x^963 + x^957 + x^956 + x^952 + x^950 + x^948 + x^945 + x^942 + x^941 + x^940 + x^938 + x^937 + x^936 + x^935 + x^932 + x^931 + x^930 + x^928 + x^927 + x^926 + x^923 + x^921 + x^918 + x^916 + x^914 + x^913 + x^909 + x^906 + x^905 + x^904 + x^902 + x^897 + x^895 + x^892 + x^889 + x^888 + x^887 + x^886 + x^885 + x^884 + x^882 + x^881 + x^879 + x^876 + x^870 + x^868 + x^867 + x^865 + x^862 + x^861 + x^859 + x^858 + x^856 + x^854 + x^848 + x^847 + x^846 + x^843 + x^839 + x^837 + x^836 + x^832 + x^831 + x^830 + x^829 + x^826 + x^823 + x^821 + x^820 + x^817 + x^815 + x^812 + x^809 + x^808 + x^805 + x^803 + x^802 + x^800 + x^799 + x^797 + x^795 + x^793 + x^792 + x^788 + x^786 + x^784 + x^780 + x^775 + x^774 + x^770 + x^768 + x^766 + x^764 + x^761 + x^760 + x^753 + x^752 + x^751 + x^750 + x^747 + x^744 + x^742 + x^741 + x^737 + x^734 + x^732 + x^728 + x^727 + x^724 + x^722 + x^721 + x^719 + x^717 + x^715 + x^714 + x^713 + x^710 + x^709 + x^705 + x^703 + x^701 + x^698 + x^697 + x^695 + x^690 + x^687 + x^685 + x^684 + x^682 + x^681 + x^680 + x^677 + x^676 + x^674 + x^673 + x^672 + x^671 + x^670 + x^669 + x^665 + x^663 + x^659 + x^652 + x^651 + x^650 + x^649 + x^648 + x^647 + x^646 + x^645 + x^642 + x^640 + x^638 + x^632 + x^631 + x^630 + x^629 + x^627 + x^626 + x^623 + x^622 + x^621 + x^620 + x^616 + x^615 + x^610 + x^605 + x^602 + x^601 + x^600 + x^599 + x^598 + x^596 + x^594 + x^593 + x^591 + x^583 + x^581 + x^579 + x^578 + x^577 + x^576 + x^575 + x^573 + x^572 + x^571 + x^570 + x^569 + x^565 + x^563 + x^562 + x^561 + x^559 + x^557 + x^555 + x^552 + x^551 + x^546 + x^544 + x^542 + x^541 + x^540 + x^539 + x^538 + x^537 + x^535 + x^533 + x^530 + x^527 + x^523 + x^522 + x^520 + x^519 + x^515 + x^513 + x^511 + x^509 + x^507 + x^505 + x^504 + x^503 + x^499 + x^497 + x^496 + x^495 + x^493 + x^492 + x^488 + x^486 + x^481 + x^480 + x^479 + x^478 + x^477 + x^472 + x^470 + x^468 + x^467 + x^464 + x^463 + x^460 + x^459 + x^455 + x^454 + x^453 + x^446 + x^445 + x^444 + x^443 + x^440 + x^438 + x^437 + x^432 + x^431 + x^428 + x^427 + x^426 + x^420 + x^419 + x^416 + x^415 + x^414 + x^413 + x^412 + x^411 + x^405 + x^404 + x^401 + x^396 + x^393 + x^392 + x^391 + x^388 + x^387 + x^383 + x^381 + x^380 + x^377 + x^376 + x^369 + x^364 + x^362 + x^358 + x^357 + x^356 + x^355 + x^353 + x^351 + x^349 + x^340 + x^339 + x^338 + x^337 + x^336 + x^335 + x^334 + x^332 + x^330 + x^328 + x^327 + x^326 + x^324 + x^320 + x^318 + x^316 + x^315 + x^309 + x^302 + x^298 + x^292 + x^291 + x^290 + x^289 + x^287 + x^286 + x^285 + x^284 + x^281 + x^279 + x^278 + x^276 + x^274 + x^273 + x^272 + x^271 + x^267 + x^266 + x^264 + x^263 + x^262 + x^260 + x^259 + x^256 + x^254 + x^253 + x^252 + x^251 + x^249 + x^248 + x^247 + x^245 + x^244 + x^241 + x^239 + x^235 + x^234 + x^233 + x^232 + x^231 + x^230 + x^226 + x^224 + x^221 + x^219 + x^218 + x^216 + x^215 + x^214 + x^209 + x^207 + x^206 + x^202 + x^201 + x^198 + x^197 + x^194 + x^193 + x^192 + x^191 + x^189 + x^188 + x^183 + x^182 + x^181 + x^180 + x^179 + x^178 + x^177 + x^175 + x^172 + x^169 + x^168 + x^166 + x^165 + x^164 + x^163 + x^158 + x^157 + x^153 + x^152 + x^149 + x^147 + x^146 + x^144 + x^140 + x^139 + x^136 + x^128 + x^127 + x^126 + x^124 + x^123 + x^122 + x^121 + x^116 + x^115 + x^113 + x^112 + x^109 + x^108 + x^107 + x^106 + x^104 + x^103 + x^102 + x^101 + x^100 + x^99 + x^97 + x^95 + x^94 + x^93 + x^92 + x^87 + x^84 + x^83 + x^82 + x^80 + x^79 + x^78 + x^76 + x^73 + x^70 + x^69 + x^68 + x^67 + x^66 + x^65 + x^63 + x^60 + x^59 + x^57 + x^55 + x^52 + x^51 + x^47 + x^46 + x^45 + x^43 + x^42 + x^40 + x^36 + x^35 + x^30 + x^29 + x^28 + x^27 + x^23 + x^20 + x^17 + x^14 + x^9 + x^7 + x^3 + 1&#x27;</span>)</span><br><span class="line">c = <span class="number">23931938409134006846469410550487073743925192650755116938225541794524723083910240603620279453298714584321800170326063144616472531553643627071552202613402950579120189960424183462876292590831564884347025119938858471788053191321980663696621632084753893732784657023312407591768406322125753947265987815937165961039424015628319982913336402297718720925447102042668906173729998301139577468193468132305331072754842771657432484688590927575895743853584931297836925498250475231655832566787366689988158399203844420168837827423836936015638932385609040452870954522482255864355639427304567768665723098741671323173831781775755570779256</span></span><br><span class="line">c_poly = P(R.fetch_int(c))</span><br><span class="line"></span><br><span class="line">p,q = factor(n)[<span class="number">0</span>][<span class="number">0</span>],factor(n)[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">phi = (<span class="number">2</span>^p.degree()-<span class="number">1</span>)*(<span class="number">2</span>^q.degree()-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">m_poly = <span class="built_in">pow</span>(c_poly, d, n)</span><br><span class="line">m_int = R(m_poly).integer_representation()</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m_int))</span><br></pre></td></tr></table></figure>



<h2 id="watevrCTF-2019——Swedish-RSA"><a href="#watevrCTF-2019——Swedish-RSA" class="headerlink" title="watevrCTF 2019——Swedish RSA"></a>watevrCTF 2019——Swedish RSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag = <span class="built_in">bytearray</span>(raw_input())</span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line">bits = <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Prime for Finite Field.</span></span><br><span class="line">p = random_prime(<span class="number">2</span>^bits-<span class="number">1</span>, <span class="literal">False</span>, <span class="number">2</span>^(bits-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">file_out = <span class="built_in">open</span>(<span class="string">&quot;downloads/polynomial_rsa.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Prime: &quot;</span> + <span class="built_in">str</span>(p) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Univariate Polynomial Ring in y over Finite Field of size p</span></span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Analogous to the primes in Z</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_irreducable_poly</span>(<span class="params">deg</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        out = R.random_element(degree=deg)</span><br><span class="line">        <span class="keyword">if</span> out.is_irreducible():</span><br><span class="line">            <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## Polynomial &quot;primes&quot;</span></span><br><span class="line">P = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span>*length))</span><br><span class="line">Q = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span>*length))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Public exponent key</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Modulus</span></span><br><span class="line">N = P*Q</span><br><span class="line">file_out.write(<span class="string">&quot;Modulus: &quot;</span> + <span class="built_in">str</span>(N) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Univariate Quotient Polynomial Ring in x over Finite Field of size 659 with modulus N(x)</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Encrypt</span></span><br><span class="line">m = S(flag)</span><br><span class="line">c = m^e</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;Ciphertext: &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line">file_out.close()</span><br></pre></td></tr></table></figure>

<p><code>out = R.random_element(degree=deg)</code>，作用是从一个给定的环或域 <code>R</code> 中生成一个随机元素，并限定该随机元素的次数（degree）。就是会生成一个环R中次数不超过deg的多项式</p>
<p><code>is_irreducible()</code>：作用是判断一个多项式是不是不可约的，如果是不可约的就返回<code>True</code></p>
<p><code>R.quotient</code> ，用于计算环或域 <code>R</code> 的商环或商域</p>
<p>先把N分解了，得到一个65次的多项式和一个112次的多项式。</p>
<p>然后重点是计算$\phi(N)&#x3D;\phi(p)×\phi(q)$</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line">对于整数n来讲，欧拉函数<span class="built_in">phi</span>(n)表示所有小于或等于n的正整数中与n互质的数的数目。</span><br><span class="line">对于多项式<span class="selector-tag">P</span>(y)来讲，欧拉函数<span class="built_in">phi</span>(P(y))表示所有不高于<span class="selector-tag">P</span>(y)幂级的环内所有多项式中，与<span class="selector-tag">P</span>(y)无除<span class="number">1</span>以外的公因式的其他多项式的个数。</span><br></pre></td></tr></table></figure>

<p><a href="http://www.diva-portal.se/smash/get/diva2:823505/FULLTEXT01.pdf">这篇论文</a>指出了欧拉函数的计算方法</p>
<p><img src="/../images/RSA/51.png"></p>
<p>本题中，$p$，$q$都是环R上的多项式，而且$p$，$q$都不可约</p>
<p>$\therefore \phi(N) &#x3D; (p^{65}-1)×(p^{112}-1)$</p>
<p>然后就是常规RSA解法(我表示很震惊)，而且最后 flag的提取也很奇怪</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">P = <span class="number">43753</span></span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(P))</span><br><span class="line">N = <span class="number">34036</span>*y^<span class="number">177</span> + <span class="number">23068</span>*y^<span class="number">176</span> + <span class="number">13147</span>*y^<span class="number">175</span> + <span class="number">36344</span>*y^<span class="number">174</span> + <span class="number">10045</span>*y^<span class="number">173</span> + <span class="number">41049</span>*y^<span class="number">172</span> + <span class="number">17786</span>*y^<span class="number">171</span> + <span class="number">16601</span>*y^<span class="number">170</span> + <span class="number">7929</span>*y^<span class="number">169</span> + <span class="number">37570</span>*y^<span class="number">168</span> + <span class="number">990</span>*y^<span class="number">167</span> + <span class="number">9622</span>*y^<span class="number">166</span> + <span class="number">39273</span>*y^<span class="number">165</span> + <span class="number">35284</span>*y^<span class="number">164</span> + <span class="number">15632</span>*y^<span class="number">163</span> + <span class="number">18850</span>*y^<span class="number">162</span> + <span class="number">8800</span>*y^<span class="number">161</span> + <span class="number">33148</span>*y^<span class="number">160</span> + <span class="number">12147</span>*y^<span class="number">159</span> + <span class="number">40487</span>*y^<span class="number">158</span> + <span class="number">6407</span>*y^<span class="number">157</span> + <span class="number">34111</span>*y^<span class="number">156</span> + <span class="number">8446</span>*y^<span class="number">155</span> + <span class="number">21908</span>*y^<span class="number">154</span> + <span class="number">16812</span>*y^<span class="number">153</span> + <span class="number">40624</span>*y^<span class="number">152</span> + <span class="number">43506</span>*y^<span class="number">151</span> + <span class="number">39116</span>*y^<span class="number">150</span> + <span class="number">33011</span>*y^<span class="number">149</span> + <span class="number">23914</span>*y^<span class="number">148</span> + <span class="number">2210</span>*y^<span class="number">147</span> + <span class="number">23196</span>*y^<span class="number">146</span> + <span class="number">43359</span>*y^<span class="number">145</span> + <span class="number">34455</span>*y^<span class="number">144</span> + <span class="number">17684</span>*y^<span class="number">143</span> + <span class="number">25262</span>*y^<span class="number">142</span> + <span class="number">982</span>*y^<span class="number">141</span> + <span class="number">24015</span>*y^<span class="number">140</span> + <span class="number">27968</span>*y^<span class="number">139</span> + <span class="number">37463</span>*y^<span class="number">138</span> + <span class="number">10667</span>*y^<span class="number">137</span> + <span class="number">39519</span>*y^<span class="number">136</span> + <span class="number">31176</span>*y^<span class="number">135</span> + <span class="number">27520</span>*y^<span class="number">134</span> + <span class="number">32118</span>*y^<span class="number">133</span> + <span class="number">8333</span>*y^<span class="number">132</span> + <span class="number">38945</span>*y^<span class="number">131</span> + <span class="number">34713</span>*y^<span class="number">130</span> + <span class="number">1107</span>*y^<span class="number">129</span> + <span class="number">43604</span>*y^<span class="number">128</span> + <span class="number">4433</span>*y^<span class="number">127</span> + <span class="number">18110</span>*y^<span class="number">126</span> + <span class="number">17658</span>*y^<span class="number">125</span> + <span class="number">32354</span>*y^<span class="number">124</span> + <span class="number">3219</span>*y^<span class="number">123</span> + <span class="number">40238</span>*y^<span class="number">122</span> + <span class="number">10439</span>*y^<span class="number">121</span> + <span class="number">3669</span>*y^<span class="number">120</span> + <span class="number">8713</span>*y^<span class="number">119</span> + <span class="number">21027</span>*y^<span class="number">118</span> + <span class="number">29480</span>*y^<span class="number">117</span> + <span class="number">5477</span>*y^<span class="number">116</span> + <span class="number">24332</span>*y^<span class="number">115</span> + <span class="number">43480</span>*y^<span class="number">114</span> + <span class="number">33406</span>*y^<span class="number">113</span> + <span class="number">43121</span>*y^<span class="number">112</span> + <span class="number">1114</span>*y^<span class="number">111</span> + <span class="number">17198</span>*y^<span class="number">110</span> + <span class="number">22829</span>*y^<span class="number">109</span> + <span class="number">24424</span>*y^<span class="number">108</span> + <span class="number">16523</span>*y^<span class="number">107</span> + <span class="number">20424</span>*y^<span class="number">106</span> + <span class="number">36206</span>*y^<span class="number">105</span> + <span class="number">41849</span>*y^<span class="number">104</span> + <span class="number">3584</span>*y^<span class="number">103</span> + <span class="number">26500</span>*y^<span class="number">102</span> + <span class="number">31897</span>*y^<span class="number">101</span> + <span class="number">34640</span>*y^<span class="number">100</span> + <span class="number">27449</span>*y^<span class="number">99</span> + <span class="number">30962</span>*y^<span class="number">98</span> + <span class="number">41434</span>*y^<span class="number">97</span> + <span class="number">22125</span>*y^<span class="number">96</span> + <span class="number">24314</span>*y^<span class="number">95</span> + <span class="number">3944</span>*y^<span class="number">94</span> + <span class="number">18400</span>*y^<span class="number">93</span> + <span class="number">38476</span>*y^<span class="number">92</span> + <span class="number">28904</span>*y^<span class="number">91</span> + <span class="number">27936</span>*y^<span class="number">90</span> + <span class="number">41867</span>*y^<span class="number">89</span> + <span class="number">25573</span>*y^<span class="number">88</span> + <span class="number">25659</span>*y^<span class="number">87</span> + <span class="number">33443</span>*y^<span class="number">86</span> + <span class="number">18435</span>*y^<span class="number">85</span> + <span class="number">5934</span>*y^<span class="number">84</span> + <span class="number">38030</span>*y^<span class="number">83</span> + <span class="number">17563</span>*y^<span class="number">82</span> + <span class="number">24086</span>*y^<span class="number">81</span> + <span class="number">36782</span>*y^<span class="number">80</span> + <span class="number">20922</span>*y^<span class="number">79</span> + <span class="number">38933</span>*y^<span class="number">78</span> + <span class="number">23448</span>*y^<span class="number">77</span> + <span class="number">10599</span>*y^<span class="number">76</span> + <span class="number">7156</span>*y^<span class="number">75</span> + <span class="number">29044</span>*y^<span class="number">74</span> + <span class="number">23605</span>*y^<span class="number">73</span> + <span class="number">7657</span>*y^<span class="number">72</span> + <span class="number">28200</span>*y^<span class="number">71</span> + <span class="number">2431</span>*y^<span class="number">70</span> + <span class="number">3860</span>*y^<span class="number">69</span> + <span class="number">23259</span>*y^<span class="number">68</span> + <span class="number">14590</span>*y^<span class="number">67</span> + <span class="number">33631</span>*y^<span class="number">66</span> + <span class="number">15673</span>*y^<span class="number">65</span> + <span class="number">36049</span>*y^<span class="number">64</span> + <span class="number">29728</span>*y^<span class="number">63</span> + <span class="number">22413</span>*y^<span class="number">62</span> + <span class="number">18602</span>*y^<span class="number">61</span> + <span class="number">18557</span>*y^<span class="number">60</span> + <span class="number">23505</span>*y^<span class="number">59</span> + <span class="number">17642</span>*y^<span class="number">58</span> + <span class="number">12595</span>*y^<span class="number">57</span> + <span class="number">17255</span>*y^<span class="number">56</span> + <span class="number">15316</span>*y^<span class="number">55</span> + <span class="number">8948</span>*y^<span class="number">54</span> + <span class="number">38</span>*y^<span class="number">53</span> + <span class="number">40329</span>*y^<span class="number">52</span> + <span class="number">9823</span>*y^<span class="number">51</span> + <span class="number">5798</span>*y^<span class="number">50</span> + <span class="number">6379</span>*y^<span class="number">49</span> + <span class="number">8662</span>*y^<span class="number">48</span> + <span class="number">34640</span>*y^<span class="number">47</span> + <span class="number">38321</span>*y^<span class="number">46</span> + <span class="number">18760</span>*y^<span class="number">45</span> + <span class="number">13135</span>*y^<span class="number">44</span> + <span class="number">15926</span>*y^<span class="number">43</span> + <span class="number">34952</span>*y^<span class="number">42</span> + <span class="number">28940</span>*y^<span class="number">41</span> + <span class="number">13558</span>*y^<span class="number">40</span> + <span class="number">42579</span>*y^<span class="number">39</span> + <span class="number">38015</span>*y^<span class="number">38</span> + <span class="number">33788</span>*y^<span class="number">37</span> + <span class="number">12381</span>*y^<span class="number">36</span> + <span class="number">195</span>*y^<span class="number">35</span> + <span class="number">13709</span>*y^<span class="number">34</span> + <span class="number">31500</span>*y^<span class="number">33</span> + <span class="number">32994</span>*y^<span class="number">32</span> + <span class="number">30486</span>*y^<span class="number">31</span> + <span class="number">40414</span>*y^<span class="number">30</span> + <span class="number">2578</span>*y^<span class="number">29</span> + <span class="number">30525</span>*y^<span class="number">28</span> + <span class="number">43067</span>*y^<span class="number">27</span> + <span class="number">6195</span>*y^<span class="number">26</span> + <span class="number">36288</span>*y^<span class="number">25</span> + <span class="number">23236</span>*y^<span class="number">24</span> + <span class="number">21493</span>*y^<span class="number">23</span> + <span class="number">15808</span>*y^<span class="number">22</span> + <span class="number">34500</span>*y^<span class="number">21</span> + <span class="number">6390</span>*y^<span class="number">20</span> + <span class="number">42994</span>*y^<span class="number">19</span> + <span class="number">42151</span>*y^<span class="number">18</span> + <span class="number">19248</span>*y^<span class="number">17</span> + <span class="number">19291</span>*y^<span class="number">16</span> + <span class="number">8124</span>*y^<span class="number">15</span> + <span class="number">40161</span>*y^<span class="number">14</span> + <span class="number">24726</span>*y^<span class="number">13</span> + <span class="number">31874</span>*y^<span class="number">12</span> + <span class="number">30272</span>*y^<span class="number">11</span> + <span class="number">30761</span>*y^<span class="number">10</span> + <span class="number">2296</span>*y^<span class="number">9</span> + <span class="number">11017</span>*y^<span class="number">8</span> + <span class="number">16559</span>*y^<span class="number">7</span> + <span class="number">28949</span>*y^<span class="number">6</span> + <span class="number">40499</span>*y^<span class="number">5</span> + <span class="number">22377</span>*y^<span class="number">4</span> + <span class="number">33628</span>*y^<span class="number">3</span> + <span class="number">30598</span>*y^<span class="number">2</span> + <span class="number">4386</span>*y + <span class="number">23814</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line">C = <span class="number">5209</span>*x^<span class="number">176</span> + <span class="number">10881</span>*x^<span class="number">175</span> + <span class="number">31096</span>*x^<span class="number">174</span> + <span class="number">23354</span>*x^<span class="number">173</span> + <span class="number">28337</span>*x^<span class="number">172</span> + <span class="number">15982</span>*x^<span class="number">171</span> + <span class="number">13515</span>*x^<span class="number">170</span> + <span class="number">21641</span>*x^<span class="number">169</span> + <span class="number">10254</span>*x^<span class="number">168</span> + <span class="number">34588</span>*x^<span class="number">167</span> + <span class="number">27434</span>*x^<span class="number">166</span> + <span class="number">29552</span>*x^<span class="number">165</span> + <span class="number">7105</span>*x^<span class="number">164</span> + <span class="number">22604</span>*x^<span class="number">163</span> + <span class="number">41253</span>*x^<span class="number">162</span> + <span class="number">42675</span>*x^<span class="number">161</span> + <span class="number">21153</span>*x^<span class="number">160</span> + <span class="number">32838</span>*x^<span class="number">159</span> + <span class="number">34391</span>*x^<span class="number">158</span> + <span class="number">832</span>*x^<span class="number">157</span> + <span class="number">720</span>*x^<span class="number">156</span> + <span class="number">22883</span>*x^<span class="number">155</span> + <span class="number">19236</span>*x^<span class="number">154</span> + <span class="number">33772</span>*x^<span class="number">153</span> + <span class="number">5020</span>*x^<span class="number">152</span> + <span class="number">17943</span>*x^<span class="number">151</span> + <span class="number">26967</span>*x^<span class="number">150</span> + <span class="number">30847</span>*x^<span class="number">149</span> + <span class="number">10306</span>*x^<span class="number">148</span> + <span class="number">33966</span>*x^<span class="number">147</span> + <span class="number">43255</span>*x^<span class="number">146</span> + <span class="number">20342</span>*x^<span class="number">145</span> + <span class="number">4474</span>*x^<span class="number">144</span> + <span class="number">3490</span>*x^<span class="number">143</span> + <span class="number">38033</span>*x^<span class="number">142</span> + <span class="number">11224</span>*x^<span class="number">141</span> + <span class="number">30565</span>*x^<span class="number">140</span> + <span class="number">31967</span>*x^<span class="number">139</span> + <span class="number">32382</span>*x^<span class="number">138</span> + <span class="number">9759</span>*x^<span class="number">137</span> + <span class="number">1030</span>*x^<span class="number">136</span> + <span class="number">32122</span>*x^<span class="number">135</span> + <span class="number">42614</span>*x^<span class="number">134</span> + <span class="number">14280</span>*x^<span class="number">133</span> + <span class="number">16533</span>*x^<span class="number">132</span> + <span class="number">32676</span>*x^<span class="number">131</span> + <span class="number">43070</span>*x^<span class="number">130</span> + <span class="number">36009</span>*x^<span class="number">129</span> + <span class="number">28497</span>*x^<span class="number">128</span> + <span class="number">2940</span>*x^<span class="number">127</span> + <span class="number">9747</span>*x^<span class="number">126</span> + <span class="number">22758</span>*x^<span class="number">125</span> + <span class="number">16615</span>*x^<span class="number">124</span> + <span class="number">14086</span>*x^<span class="number">123</span> + <span class="number">13038</span>*x^<span class="number">122</span> + <span class="number">39603</span>*x^<span class="number">121</span> + <span class="number">36260</span>*x^<span class="number">120</span> + <span class="number">32502</span>*x^<span class="number">119</span> + <span class="number">17619</span>*x^<span class="number">118</span> + <span class="number">17700</span>*x^<span class="number">117</span> + <span class="number">15083</span>*x^<span class="number">116</span> + <span class="number">11311</span>*x^<span class="number">115</span> + <span class="number">36496</span>*x^<span class="number">114</span> + <span class="number">1300</span>*x^<span class="number">113</span> + <span class="number">13601</span>*x^<span class="number">112</span> + <span class="number">43425</span>*x^<span class="number">111</span> + <span class="number">10376</span>*x^<span class="number">110</span> + <span class="number">11551</span>*x^<span class="number">109</span> + <span class="number">13684</span>*x^<span class="number">108</span> + <span class="number">14955</span>*x^<span class="number">107</span> + <span class="number">6661</span>*x^<span class="number">106</span> + <span class="number">12674</span>*x^<span class="number">105</span> + <span class="number">21534</span>*x^<span class="number">104</span> + <span class="number">32132</span>*x^<span class="number">103</span> + <span class="number">34135</span>*x^<span class="number">102</span> + <span class="number">43684</span>*x^<span class="number">101</span> + <span class="number">837</span>*x^<span class="number">100</span> + <span class="number">29311</span>*x^<span class="number">99</span> + <span class="number">4849</span>*x^<span class="number">98</span> + <span class="number">26632</span>*x^<span class="number">97</span> + <span class="number">26662</span>*x^<span class="number">96</span> + <span class="number">10159</span>*x^<span class="number">95</span> + <span class="number">32657</span>*x^<span class="number">94</span> + <span class="number">12149</span>*x^<span class="number">93</span> + <span class="number">17858</span>*x^<span class="number">92</span> + <span class="number">35805</span>*x^<span class="number">91</span> + <span class="number">19391</span>*x^<span class="number">90</span> + <span class="number">30884</span>*x^<span class="number">89</span> + <span class="number">42039</span>*x^<span class="number">88</span> + <span class="number">17292</span>*x^<span class="number">87</span> + <span class="number">4694</span>*x^<span class="number">86</span> + <span class="number">1497</span>*x^<span class="number">85</span> + <span class="number">1744</span>*x^<span class="number">84</span> + <span class="number">31071</span>*x^<span class="number">83</span> + <span class="number">26246</span>*x^<span class="number">82</span> + <span class="number">24402</span>*x^<span class="number">81</span> + <span class="number">22068</span>*x^<span class="number">80</span> + <span class="number">39263</span>*x^<span class="number">79</span> + <span class="number">23703</span>*x^<span class="number">78</span> + <span class="number">21484</span>*x^<span class="number">77</span> + <span class="number">12241</span>*x^<span class="number">76</span> + <span class="number">28821</span>*x^<span class="number">75</span> + <span class="number">32886</span>*x^<span class="number">74</span> + <span class="number">43075</span>*x^<span class="number">73</span> + <span class="number">35741</span>*x^<span class="number">72</span> + <span class="number">19936</span>*x^<span class="number">71</span> + <span class="number">37219</span>*x^<span class="number">70</span> + <span class="number">33411</span>*x^<span class="number">69</span> + <span class="number">8301</span>*x^<span class="number">68</span> + <span class="number">12949</span>*x^<span class="number">67</span> + <span class="number">28611</span>*x^<span class="number">66</span> + <span class="number">42654</span>*x^<span class="number">65</span> + <span class="number">6910</span>*x^<span class="number">64</span> + <span class="number">18523</span>*x^<span class="number">63</span> + <span class="number">31144</span>*x^<span class="number">62</span> + <span class="number">21398</span>*x^<span class="number">61</span> + <span class="number">36298</span>*x^<span class="number">60</span> + <span class="number">27158</span>*x^<span class="number">59</span> + <span class="number">918</span>*x^<span class="number">58</span> + <span class="number">38601</span>*x^<span class="number">57</span> + <span class="number">4269</span>*x^<span class="number">56</span> + <span class="number">5699</span>*x^<span class="number">55</span> + <span class="number">36444</span>*x^<span class="number">54</span> + <span class="number">34791</span>*x^<span class="number">53</span> + <span class="number">37978</span>*x^<span class="number">52</span> + <span class="number">32481</span>*x^<span class="number">51</span> + <span class="number">8039</span>*x^<span class="number">50</span> + <span class="number">11012</span>*x^<span class="number">49</span> + <span class="number">11454</span>*x^<span class="number">48</span> + <span class="number">30450</span>*x^<span class="number">47</span> + <span class="number">1381</span>*x^<span class="number">46</span> + <span class="number">32403</span>*x^<span class="number">45</span> + <span class="number">8202</span>*x^<span class="number">44</span> + <span class="number">8404</span>*x^<span class="number">43</span> + <span class="number">37648</span>*x^<span class="number">42</span> + <span class="number">43696</span>*x^<span class="number">41</span> + <span class="number">34237</span>*x^<span class="number">40</span> + <span class="number">36490</span>*x^<span class="number">39</span> + <span class="number">41423</span>*x^<span class="number">38</span> + <span class="number">35792</span>*x^<span class="number">37</span> + <span class="number">36950</span>*x^<span class="number">36</span> + <span class="number">31086</span>*x^<span class="number">35</span> + <span class="number">38970</span>*x^<span class="number">34</span> + <span class="number">12439</span>*x^<span class="number">33</span> + <span class="number">7963</span>*x^<span class="number">32</span> + <span class="number">16150</span>*x^<span class="number">31</span> + <span class="number">11382</span>*x^<span class="number">30</span> + <span class="number">3038</span>*x^<span class="number">29</span> + <span class="number">20157</span>*x^<span class="number">28</span> + <span class="number">23531</span>*x^<span class="number">27</span> + <span class="number">32866</span>*x^<span class="number">26</span> + <span class="number">5428</span>*x^<span class="number">25</span> + <span class="number">21132</span>*x^<span class="number">24</span> + <span class="number">13443</span>*x^<span class="number">23</span> + <span class="number">28909</span>*x^<span class="number">22</span> + <span class="number">42716</span>*x^<span class="number">21</span> + <span class="number">6567</span>*x^<span class="number">20</span> + <span class="number">24744</span>*x^<span class="number">19</span> + <span class="number">8727</span>*x^<span class="number">18</span> + <span class="number">14895</span>*x^<span class="number">17</span> + <span class="number">28172</span>*x^<span class="number">16</span> + <span class="number">30903</span>*x^<span class="number">15</span> + <span class="number">26608</span>*x^<span class="number">14</span> + <span class="number">27314</span>*x^<span class="number">13</span> + <span class="number">42224</span>*x^<span class="number">12</span> + <span class="number">42551</span>*x^<span class="number">11</span> + <span class="number">37726</span>*x^<span class="number">10</span> + <span class="number">11203</span>*x^<span class="number">9</span> + <span class="number">36816</span>*x^<span class="number">8</span> + <span class="number">5537</span>*x^<span class="number">7</span> + <span class="number">20301</span>*x^<span class="number">6</span> + <span class="number">17591</span>*x^<span class="number">5</span> + <span class="number">41279</span>*x^<span class="number">4</span> + <span class="number">7999</span>*x^<span class="number">3</span> + <span class="number">33753</span>*x^<span class="number">2</span> + <span class="number">34551</span>*x + <span class="number">9659</span></span><br><span class="line"></span><br><span class="line">p,q = factor(N)</span><br><span class="line">p,q = p[<span class="number">0</span>],q[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">phi = (P^p.degree() - <span class="number">1</span>)*(P^q.degree()-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = C^d</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(m.<span class="built_in">list</span>())</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> m.<span class="built_in">list</span>()])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><code>m.list()</code>是把m这个多项式中每一项的系数按照次幂上升的顺序进行排列</p>
<h2 id="2021强网拟态——OnlyRSA"><a href="#2021强网拟态——OnlyRSA" class="headerlink" title="2021强网拟态——OnlyRSA"></a>2021强网拟态——OnlyRSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># c = </span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">digits = n.digits(<span class="number">11</span>)</span><br><span class="line">f = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i, each <span class="keyword">in</span> <span class="built_in">enumerate</span>(digits):</span><br><span class="line">    f += each * x ^ i</span><br><span class="line"></span><br><span class="line">factors = f.factor_list()</span><br><span class="line"></span><br><span class="line">p = factors[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">q = factors[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">p = p(x=<span class="number">11</span>)</span><br><span class="line">q = q(x=<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">d = inverse_mod(<span class="number">65537</span>,(p-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>







<h1 id="coppersmith"><a href="#coppersmith" class="headerlink" title="coppersmith"></a>coppersmith</h1><h2 id="恢复OAEP私钥"><a href="#恢复OAEP私钥" class="headerlink" title="恢复OAEP私钥"></a>恢复OAEP私钥</h2><p>题目来源：[蓝帽杯 2022 初赛]corrupted_key</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">key = RSA.generate(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&#x27;wb&#x27;</span>).write(PKCS1_OAEP.new(key.publickey()).encrypt(flag))</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;priv.pem&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(key.exportKey(<span class="string">&#x27;PEM&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>priv.pem:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXgIBAAKBgQDXFSUGqpzsBeUzXWtG9UkUB8MZn9UQkfH2Aw03YrngP0nJ3NwH</span><br><span class="line">UFTgzBSLl0tBhUvZO07haiqHbuYgBegO+Aa3qjtksb+bH6dz41PQzbn/l4Pd1fXm</span><br><span class="line">dJmtEPNh6TjQC4KmpMQqBTXF52cheY6GtFzUuNA7DX51wr6HZqHoQ73GQQIDAQAB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yQvOzxy6szWFheigQdGxAkEA4wFss2CcHWQ8FnQ5w7k4uIH0I38khg07HLhaYm1c</span><br><span class="line">zUcmlk4PgnDWxN+ev+vMU45O5eGntzaO3lHsaukX9461mA==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>私钥文件缺失信息</p>
<p>上网找pem文件的解析</p>
<p>PKCS#1的私钥文件包含以下信息：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">RSAPrivateKey ::= SEQUENCE &#123;</span><br><span class="line"> version Version,</span><br><span class="line"> modulus INTEGER, -- n</span><br><span class="line"> publicExponent INTEGER, -- e</span><br><span class="line"> privateExponent INTEGER, -- d</span><br><span class="line"> prime1 INTEGER, -- p</span><br><span class="line"> prime2 INTEGER, -- q</span><br><span class="line"> exponent1 INTEGER, -- d mod (p-<span class="number">1</span>)</span><br><span class="line"> exponent2 INTEGER, -- d mod (q-<span class="number">1</span>)</span><br><span class="line"> coefficient INTEGER -- (inverse of q) mod p </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>标签头：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3082025C# 标签头</span><br><span class="line">020100 # 整型</span><br><span class="line">028181 # 整型 长度 为 129 字节 (0x81)，内容：模数 n (modulus)</span><br><span class="line">0203 # 整型 长度 为 3 字节(0x03)，内容：e (公钥指数)</span><br><span class="line">028180 # 整型 长度 为 128 字节(0x80)，内容：d (私钥指数)</span><br><span class="line">0241 # 整型 长度 为 65 字节(0x41)，内容：p (素数)</span><br><span class="line">0241 # 整型 长度 为 65 字节(0x41)，内容：q (素数)</span><br><span class="line">0240 # 整型 长度 为 64 字节(0x40)，内容：d mod(p-1)</span><br><span class="line">0240 # 整型 长度 为 64 字节(0x40)，内容：d mod(q-1)</span><br><span class="line">0241 # 整型 长度 为 65 字节(0x41)，内容：(1/q)mod p &lt;即 invert(q,p)&gt;</span><br></pre></td></tr></table></figure>



<p><img src="/../images/RSA/49.png"></p>
<p><img src="/../images/RSA/50.png"></p>
<p>把priv的内容base64解码，再转16进制，并且根据标签头提取信息：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">0xd7152506aa9cec05e5335d6b46f5491407c3199fd51091f1f6030d3762b9e03f49c9dcdc075054e0cc148b974b41854bd93b4ee16a2a876ee62005e80ef806b7aa3b64b1bf9b1fa773e353d0cdb9ff9783ddd5f5e67499ad10f361e938d00b82a6a4c42a0535c5e76721798e86b45cd4b8d03b0d7e75c2be8766a1e843bdc641</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">dq = <span class="number">0xc90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line">inv = <span class="number">0xe3016cb3609c1d643c167439c3b938b881f4237f24860d3b1cb85a626d5ccd4726964e0f8270d6c4df9ebfebcc538e4ee5e1a7b7368ede51ec6ae917f78eb598</span></span><br></pre></td></tr></table></figure>

<p>即已知$dq \equiv d \mod (q-1)$，$q^{-1} \mod p$，需要注意的是这里的dq不是完整的dq，而是低120位</p>
<p>$\because dq \equiv d \mod (q-1)$，$dq &#x3D; d+k(q-1)$</p>
<p>$\therefore dq × e &#x3D; ed + kd(q-1)$即$dq ×e &#x3D; k_1(p-1)(q-1) + 1 + kd(q-1)$，可以写成$dq ×e &#x3D; k(q-1) + 1$</p>
<p>$\therefore dq ×e + k-1 &#x3D; kq$</p>
<p>两边同模$2^{120}$得$dq×e+k-1 \equiv kq \mod 2^{120}$</p>
<p>$\therefore q \equiv k^{-1}(dq×e +k-1) \mod 2^{120}$</p>
<p>$\because dq &lt; q-1 ,\therefore e &gt; k$</p>
<p>于是我们便能求出$q$的低120位的可能取值</p>
<p>$\because inv ×q \equiv 1 \mod p $，即$inv×q -1 &#x3D; kp$，两边同乘q得$inv×q×q -q &#x3D; kn$</p>
<p>即$inv × q×q -q \equiv 0 \mod (n)$</p>
<p>于是可以用coppersmith恢复求得q</p>
<p>区别于$inv×q-1 \equiv 0 \mod p$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">0xd7152506aa9cec05e5335d6b46f5491407c3199fd51091f1f6030d3762b9e03f49c9dcdc075054e0cc148b974b41854bd93b4ee16a2a876ee62005e80ef806b7aa3b64b1bf9b1fa773e353d0cdb9ff9783ddd5f5e67499ad10f361e938d00b82a6a4c42a0535c5e76721798e86b45cd4b8d03b0d7e75c2be8766a1e843bdc641</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">inv = <span class="number">0xe3016cb3609c1d643c167439c3b938b881f4237f24860d3b1cb85a626d5ccd4726964e0f8270d6c4df9ebfebcc538e4ee5e1a7b7368ede51ec6ae917f78eb598</span></span><br><span class="line">d_low = <span class="number">0xc90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line">q_low = []</span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>,e):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        q0 = invert(i, <span class="number">2</span> ** <span class="number">120</span>) * (e * d_low + i - <span class="number">1</span>) % <span class="number">2</span> ^ <span class="number">120</span></span><br><span class="line">        q_low.append(q0)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(q_low)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    f = inv * (<span class="number">2</span>^<span class="number">120</span>*x + <span class="built_in">int</span>(q_low[i]))^<span class="number">2</span> - (<span class="number">2</span>^<span class="number">120</span>*x + <span class="built_in">int</span>(q_low[i]))</span><br><span class="line">    f = f.monic()</span><br><span class="line">    root = f.small_roots(X = <span class="number">2</span>^(<span class="number">512</span>-<span class="number">120</span>))</span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        q = <span class="number">2</span>^<span class="number">120</span> * <span class="built_in">int</span>(root[<span class="number">0</span>]) + <span class="built_in">int</span>(q_low[i])</span><br><span class="line">        p = n // q</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>,q)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;d = &quot;</span>,d)</span><br><span class="line">            key = RSA.construct((<span class="built_in">int</span>(n),<span class="built_in">int</span>(e),<span class="built_in">int</span>(d),<span class="built_in">int</span>(p),<span class="built_in">int</span>(q)))</span><br><span class="line">            newkey = PKCS1_OAEP.new(key)</span><br><span class="line">            flag = newkey.decrypt(c)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://zhuanlan.zhihu.com/p/461349946">(PKCS1) RSA 公私钥 pem 文件解析 - 知乎 (zhihu.com)</a></p>
<p><a href="https://www.jianshu.com/p/c93a993f8997">RSA密钥格式解析 - 简书 (jianshu.com)</a></p>
<h2 id="comedy（先搁着）"><a href="#comedy（先搁着）" class="headerlink" title="comedy（先搁着）"></a>comedy（先搁着）</h2><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2, libnum</span><br><span class="line">from secret import flag1, flag2</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag1)</span><br><span class="line">assert m.bit_length() &lt; 200</span><br><span class="line">B = gmpy2.next_prime(libnum.s2n(flag2))</span><br><span class="line">A = (2022 - 2023 * m) % B</span><br><span class="line">leak = pow(2, 2023, B)</span><br><span class="line">print(A)</span><br><span class="line">print(leak)</span><br><span class="line"># 493275281479560936332761096886786925792234184811353209227551802099268192839677496844153534128991899414803550843408607188612593757622064753867565869035222715177143938385039508273050267347710495512806264863554858016145161165422812554800693811328453743229819656381224407015421235005940088439590887928051969351426291843586132741521121351667152673680122929827805479163871436776753859965413192837591532468372</span><br><span class="line"># 238829196127128263156194898141748280130190920343265228257398802867203846004703877952990524473329125233083096275276064071930416561616135910190674099345267027039386328203653489152769309498199556401574021633071022874689081585677578010276529507102304828451681000682208089162940529052283763507244593173690786957816545746540436261888398732172965945762569416702401859253725696471593023885944262561159982327952</span><br></pre></td></tr></table></figure>

<h2 id="高位攻击"><a href="#高位攻击" class="headerlink" title="高位攻击"></a>高位攻击</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secrets import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n = p*q</span><br><span class="line">e = 65537</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&#x27;n =&#x27;, n)</span><br><span class="line">print(&#x27;c =&#x27;, c)</span><br><span class="line">print(&#x27;p0 =&#x27;, ((p&gt;&gt;128)&lt;&lt;128))</span><br><span class="line"># n = 12722276084782012506939748218137061976694333623308770803193278921311358642857520720238223717188895787376761058057320570031791633540549052360890626849683959794619430207976509336964838302913532815872846936103400538093765972176693960613553754981804951861018999147210521057815783304998144581807982126753283124281516688846477783545704858051397854514128591265938874177108889498151756070102637171159497913559176230984485047937009449456335164657258487948113487961895079102836099947427765851897399603733885367848305266219390271858890481731238036781050541110612526113637880146841891893392904381138771618976655066294938275191591</span><br><span class="line"># c = 7016802271682704586027412586496213357494728781654536670879262263911645812024904159932204545849316301445405237966933240237035426118442003499546014556123485534516682277683392394418823209992176414301314576069643211825678886511259850322068086838470004809816539278374905405029448429356654864943156018053547494263664714952593505357117355251742922245508277007069593675629222770814317602710615647062020095140444497647478051326857816298790397174877223117345612840890905447851689835046066164443064435495141117872095457539285213399905708851752673701650986197704683439495235659865937503527178246189185724246027890778434827868479</span><br><span class="line"># p0 = 121612618057439377491893234820394610861816815559052233952438700644930219565204914707604533201740057532331014637555250302342831261394993528125583478630623993361944114671033382653887624385660705353904988324932092635052885387222723368916634052933090217574600695084708857274271614116870074627080278200070403260416</span><br></pre></td></tr></table></figure>

<p><strong>p高位泄露，未知位是128bit</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">12722276084782012506939748218137061976694333623308770803193278921311358642857520720238223717188895787376761058057320570031791633540549052360890626849683959794619430207976509336964838302913532815872846936103400538093765972176693960613553754981804951861018999147210521057815783304998144581807982126753283124281516688846477783545704858051397854514128591265938874177108889498151756070102637171159497913559176230984485047937009449456335164657258487948113487961895079102836099947427765851897399603733885367848305266219390271858890481731238036781050541110612526113637880146841891893392904381138771618976655066294938275191591</span></span><br><span class="line">c = <span class="number">7016802271682704586027412586496213357494728781654536670879262263911645812024904159932204545849316301445405237966933240237035426118442003499546014556123485534516682277683392394418823209992176414301314576069643211825678886511259850322068086838470004809816539278374905405029448429356654864943156018053547494263664714952593505357117355251742922245508277007069593675629222770814317602710615647062020095140444497647478051326857816298790397174877223117345612840890905447851689835046066164443064435495141117872095457539285213399905708851752673701650986197704683439495235659865937503527178246189185724246027890778434827868479</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">high_p = <span class="number">121612618057439377491893234820394610861816815559052233952438700644930219565204914707604533201740057532331014637555250302342831261394993528125583478630623993361944114671033382653887624385660705353904988324932092635052885387222723368916634052933090217574600695084708857274271614116870074627080278200070403260416</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = high_p + x</span><br><span class="line">x = f.small_roots(X = <span class="number">2</span>^<span class="number">128</span>,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> x:</span><br><span class="line">    p = high_p + <span class="built_in">int</span>(x[<span class="number">0</span>])</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;W0W_y0u_rea1ly_go0d_at_us3_s4g3!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="在异或基础上夹杂移位"><a href="#在异或基础上夹杂移位" class="headerlink" title="在异或基础上夹杂移位"></a>在异或基础上夹杂移位</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = getPrime(1024), getPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">p0 = p ^ (bytes_to_long(flag)&lt;&lt;444)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m, 65537, N)</span><br><span class="line">print(len(flag))</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line">print(&#x27;N=&#x27;,N)</span><br><span class="line">print(&#x27;p0=&#x27;,p0)</span><br><span class="line"></span><br><span class="line"># 54</span><br><span class="line"># c= 6187845844052645335477666563187579997555293403110620879123121166924703361821847984760733842049752886698011561451715570810292323756091403783920480396052120046379755571530451812078574368413924390017994278703794257118954968480994077586245800902748815905644287545189605031883291488844527496906890127546594960138582150272568163575590734246290813150131949296550974206595456421136190026954855755623761557179760444906148376433584795779131477110538212742401420633087881506416368853221110426491868881029814841479615979710066371796507692025126150957315754738584387325388998533227577023142894876376702128870643448600352603905149</span><br><span class="line"># N= 14195810221536708489210274086946022255792382922322850338983263099316341767896809249586174293795778082892237356582757544364274847341220303582304283372889068290282580493623042441421715338444710303281638639785784613434328659529884972238348336971186339482788748316527376410510261228354155806341136524162787121212184386900663470590652770503564816948407257603737938414126069053610568675347826390537145556511048774030823322301932088595499671755944744816524811272617200683384649389274196659297432212847319503330409792704612575414010711158873031786577877685578976140462539734553598745329712188216200905451774357282278403189943</span><br><span class="line"># p0= 111984935426070810628244029907949697819351004665202173622240566580193974673163315128983603277856218378729883402496424467491406698035050254407170555432448523469880166015507303737468316933545613178461925283040643344197452758878116752692499745309765526523083790825015522124083482964296662782850606081657447935191</span><br></pre></td></tr></table></figure>

<p><strong>看到异或就想起LitCTF那道Babyxor，但这题不大一样，因为把m进行了左移操作</strong></p>
<p><strong>因为m左移444位，这样子m后面444位都是0，所以异或之后，不影响p低位444值</strong></p>
<p><strong>而且54长度的flag转成int型数据是432，左移444位后是876位，异或之后p高(1024-876)&#x3D;148位也是不变的</strong></p>
<p><strong>所以考点就是p部分高位和部分低位泄露</strong></p>
<p><strong>先取了444低位：<code>plow = p0 % 2^445</code></strong></p>
<p><strong>然后得到148高位：<code>phigh = (p0 &gt;&gt; 876) &lt;&lt; 876</code></strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p0 = 111984935426070810628244029907949697819351004665202173622240566580193974673163315128983603277856218378729883402496424467491406698035050254407170555432448523469880166015507303737468316933545613178461925283040643344197452758878116752692499745309765526523083790825015522124083482964296662782850606081657447935191</span><br><span class="line">c = 6187845844052645335477666563187579997555293403110620879123121166924703361821847984760733842049752886698011561451715570810292323756091403783920480396052120046379755571530451812078574368413924390017994278703794257118954968480994077586245800902748815905644287545189605031883291488844527496906890127546594960138582150272568163575590734246290813150131949296550974206595456421136190026954855755623761557179760444906148376433584795779131477110538212742401420633087881506416368853221110426491868881029814841479615979710066371796507692025126150957315754738584387325388998533227577023142894876376702128870643448600352603905149</span><br><span class="line">n = 14195810221536708489210274086946022255792382922322850338983263099316341767896809249586174293795778082892237356582757544364274847341220303582304283372889068290282580493623042441421715338444710303281638639785784613434328659529884972238348336971186339482788748316527376410510261228354155806341136524162787121212184386900663470590652770503564816948407257603737938414126069053610568675347826390537145556511048774030823322301932088595499671755944744816524811272617200683384649389274196659297432212847319503330409792704612575414010711158873031786577877685578976140462539734553598745329712188216200905451774357282278403189943</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">phigh = (p0&gt;&gt;876)&lt;&lt;876</span><br><span class="line">plow = p0 % 2**444</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = phigh + x*2**444 + plow</span><br><span class="line">f = f.monic()</span><br><span class="line">root = f.small_roots(X=2^432,beta=0.4)</span><br><span class="line">if root:</span><br><span class="line">    p = int(phigh + root[0]*2**444+plow)</span><br><span class="line">    print(&quot;p=&quot;,p)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    print(long_to_bytes(int(m)))</span><br><span class="line">else:</span><br><span class="line">    print(0)</span><br></pre></td></tr></table></figure>

<h2 id="高位攻击结合加法"><a href="#高位攻击结合加法" class="headerlink" title="高位攻击结合加法"></a>高位攻击结合加法</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    flag = f.read().encode()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_Prime(nbits):</span><br><span class="line">    cnt = random.randint(1, 50)</span><br><span class="line">    a = 678649776854118956235519899207445775941738710575390362283588104409625449204123832879</span><br><span class="line">    b = 782005138760169933127526591821947364276106050094468540051784488164681554419515591399</span><br><span class="line">    n = 959495185099860764003383321572335140174084694495020493292570101529012627928646710561</span><br><span class="line">    if nbits &gt; n.bit_length():</span><br><span class="line">        n = n &lt;&lt; (nbits - n.bit_length())</span><br><span class="line">    seed = m</span><br><span class="line"></span><br><span class="line">    while cnt != 0:</span><br><span class="line">        while not isPrime(seed % pow(2, nbits)):</span><br><span class="line">            seed = (a * seed + b) % n</span><br><span class="line">        cnt -= 1</span><br><span class="line"></span><br><span class="line">    return seed % pow(2, nbits)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = get_Prime(1024)</span><br><span class="line">r = get_Prime(256)</span><br><span class="line"></span><br><span class="line">leak1 = p * q</span><br><span class="line">leak2 = p + r</span><br><span class="line">print(&#x27;leak1 =&#x27;, leak1)</span><br><span class="line">print(&quot;leak2 =&quot;, leak2)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">leak1 = 1726975620674482360213233806170947389541096108697994658733084655845389659114785301178576637466986314063371421235058595065888582231342820140568936192868977804603369486433318090941058139588565791324218134357184323086216185739954390473991279905043631888896016473122377727070109213645260572190927015695514811455255973089661406134295506499664743661249339253830939615669712520262820531049038976606781161641581457130675569478698323490748401496084828842168678572095280512663203781775164764035921218962082539851900388875197643683923415508978600441502826319004922595635629466742721341100368916333951643193549875170423774879551</span><br><span class="line">leak2 = 112318855182255283836167471766806168213410186797367822915324918687801558224308427598350852972681526722686984900181855405532137931103674353513321543274324576313279396633244245181304978516377298223713109442863413211695328144733089915971055510790022499917701465412122183985372344800810303472010586670294890532292</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>先从p,r入手，因为p(1024bit)的比特远大于r(256bit)的比特，即p的前768位(并不一定是这么多)并不受到r的影响，可用coppersmith恢复p</strong></p>
<p><strong>得到p后，看定义的函数，就是一个不知道多少次的lcg加密过程</strong></p>
<p><code> n = n &lt;&lt; (nbits - n.bit_length())</code><strong>这里保证了模数n足够大，因为再加密过程中，如果n不够大的话，会导致明文的数据丢失一些</strong></p>
<p><strong>再用q解密，需要注意的是用q解密的时候，这个n已经是移位过后的n</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">a = 678649776854118956235519899207445775941738710575390362283588104409625449204123832879</span><br><span class="line">b = 782005138760169933127526591821947364276106050094468540051784488164681554419515591399</span><br><span class="line">n = 959495185099860764003383321572335140174084694495020493292570101529012627928646710561</span><br><span class="line">leak1 = 1726975620674482360213233806170947389541096108697994658733084655845389659114785301178576637466986314063371421235058595065888582231342820140568936192868977804603369486433318090941058139588565791324218134357184323086216185739954390473991279905043631888896016473122377727070109213645260572190927015695514811455255973089661406134295506499664743661249339253830939615669712520262820531049038976606781161641581457130675569478698323490748401496084828842168678572095280512663203781775164764035921218962082539851900388875197643683923415508978600441502826319004922595635629466742721341100368916333951643193549875170423774879551</span><br><span class="line">leak2 = 112318855182255283836167471766806168213410186797367822915324918687801558224308427598350852972681526722686984900181855405532137931103674353513321543274324576313279396633244245181304978516377298223713109442863413211695328144733089915971055510790022499917701465412122183985372344800810303472010586670294890532292</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(leak1))</span><br><span class="line"></span><br><span class="line">high = (leak2&gt;&gt;256)&lt;&lt;256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = high + x</span><br><span class="line">x = f.small_roots(X=2^256,beta=0.4)</span><br><span class="line">if x:</span><br><span class="line">    p = high + x[0]</span><br><span class="line">    print(p)</span><br><span class="line">    q = leak1 // int(p)</span><br><span class="line">    seed = q</span><br><span class="line">    n = n &lt;&lt; (1024 - 729)</span><br><span class="line">    while 1:</span><br><span class="line">        ani = gmpy2.invert(a,n)</span><br><span class="line">        seed = ani*(seed - b) % n</span><br><span class="line">        flag = long_to_bytes(seed)</span><br><span class="line">        if b&#x27;flag&#x27; in flag:</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>



<h1 id="二元copper"><a href="#二元copper" class="headerlink" title="二元copper"></a>二元copper</h1><p>参考：<a href="https://www.cnblogs.com/11YEAGER11/p/17269139.html">二元coppersmith - 顶真珍珠 - 博客园 (cnblogs.com)</a></p>
<p>代码:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br></pre></td></tr></table></figure>

<p>其中m为移位（shifts），d 为多项式中的最高幂。</p>
<h2 id="CISCN-2021华南-small"><a href="#CISCN-2021华南-small" class="headerlink" title="[CISCN 2021华南]small"></a>[CISCN 2021华南]small</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import random, hashlib</span><br><span class="line">from Crypto.Util.number import getPrime</span><br><span class="line">from secret import x, y, flag</span><br><span class="line"></span><br><span class="line">BITS = 70</span><br><span class="line"></span><br><span class="line">assert(2**BITS &lt; x &lt; 2**(BITS+1))</span><br><span class="line">assert(2**BITS &lt; y &lt; 2**(BITS+1))</span><br><span class="line"></span><br><span class="line">m = str(x) + str(y)</span><br><span class="line">h = hashlib.sha256()</span><br><span class="line">h.update(m.encode())</span><br><span class="line">assert(flag == &quot;flag&#123;&quot; + h.hexdigest() + &quot;&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">a = getPrime(510)</span><br><span class="line">b = getPrime(510)</span><br><span class="line">c = (1 + a * x * y ** 2 + b * x ** 2 * y) % p</span><br><span class="line">print(&quot;p = &quot; + str(p))</span><br><span class="line">print(&quot;a = &quot; + str(a))</span><br><span class="line">print(&quot;b = &quot; + str(b))</span><br><span class="line">print(&quot;c = &quot; + str(c))</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p = </span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line">c = </span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>题目给出$x,y$都介于$2^{70}$和$2^{71}$之间</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">p = <span class="number">8813834626918693034209829623386418111935369643440896703895290043343199520112218432639643684400534953548489779045914955504743423765099014797611981422650409</span></span><br><span class="line">a = <span class="number">2817275225516767613658440250260394873529274896419346861054126128919212362519165468003171950475070788320195398302803745633617864408366174315471102773073469</span></span><br><span class="line">b = <span class="number">1763620527779958060718182646420541623477856799630691559360944374374235694750950917040727594731391703184965719358552775151767735359739899063298735788999711</span></span><br><span class="line">c = <span class="number">2298790980294663527827702586525963981886518365072523836572440106026473419042192180086308154346777239817235315513418426401278994450805667292449334757693881</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">R.&lt;x,y&gt;=PolynomialRing(Zmod(p))</span><br><span class="line"></span><br><span class="line">f = (<span class="number">1</span> + a * x * y ** <span class="number">2</span> + b * x ** <span class="number">2</span> * y) - c</span><br><span class="line"><span class="comment">#print(small_roots(f,bounds=(2^70,2^71)))</span></span><br><span class="line">x,y = small_roots(f,bounds=(<span class="number">2</span>^<span class="number">70</span>,<span class="number">2</span>^<span class="number">71</span>))[<span class="number">0</span>]</span><br><span class="line">m = <span class="built_in">str</span>(x) + <span class="built_in">str</span>(y)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;NSSCTF&#123;&quot;</span> + hashlib.sha256(m.encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>





<h1 id="P，Q产生方式由拼接而成"><a href="#P，Q产生方式由拼接而成" class="headerlink" title="P，Q产生方式由拼接而成"></a>P，Q产生方式由拼接而成</h1><p>这里只是做个记录</p>
<p>原文：<a href="https://ctftime.org/writeup/29693">CTFtime.org &#x2F; Crypto CTF 2021 &#x2F; Hamul &#x2F; Writeup</a></p>
<h2 id="Hamul"><a href="#Hamul" class="headerlink" title="Hamul"></a>Hamul</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p, q = getPrime(nbit), getPrime(nbit)</span><br><span class="line">    P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(q))</span><br><span class="line">    Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(p))</span><br><span class="line">    PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">    QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">    <span class="keyword">if</span> isPrime(PP) <span class="keyword">and</span> isPrime(QQ):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = PP * QQ</span><br><span class="line">m = bytes_to_long(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> m &lt; n:</span><br><span class="line">    c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 98027132963374134222724984677805364225505454302688777506193468362969111927940238887522916586024601699661401871147674624868439577416387122924526713690754043</span></span><br><span class="line"><span class="comment"># c = 42066148309824022259115963832631631482979698275547113127526245628391950322648581438233116362337008919903556068981108710136599590349195987128718867420453399</span></span><br></pre></td></tr></table></figure>

<p>注意到，PP,QQ的产生方式：</p>
<p>令$x&#x3D;str(P),y&#x3D;str(Q)$，于是能把P,Q写成这样的形式：$P&#x3D;10^xp + q$，$Q&#x3D;10^yq+p$</p>
<p>再令$x’ &#x3D; str(PP),y’&#x3D;str(QQ)$，于是$PP &#x3D; 10^{x’}P+Q$，$Q&#x3D;10^{y’}Q+P$</p>
<p>$\because N &#x3D; PP×QQ$，这个N可以写成$10^{x+x’+y+y’}pq+…+pq$，每一项都含有pq。</p>
<p>因为$x+x’+y+y’$很大，所以存在$str(N)[:?]&#x3D;str(pq)[:?]$，$str(N)[?:]&#x3D;str(pq)[?:]$</p>
<p>测试发现$str(N)[:18]&#x3D;str(pq)[:18]$,$str(N)[-18:]&#x3D;str(pq)[-18:]$</p>
<p>也有出现前18位，后19位一样，前19位，后18位一样的情况</p>
<p>因为$len(str(pq))&#x3D;38或39$，可以爆破两位的方式求得pq</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_RSA</span>(<span class="params">c, e, p, q</span>):</span><br><span class="line">    phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">low = <span class="built_in">str</span>(n)[-<span class="number">18</span>:]</span><br><span class="line">high = <span class="built_in">str</span>(n)[:<span class="number">18</span>]</span><br><span class="line">pq_prob = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i) + <span class="built_in">str</span>(j)+ low))</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">    f = factor(x)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">        p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(q))</span><br><span class="line">Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(p))</span><br><span class="line">PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">N = PP * QQ</span><br><span class="line"><span class="built_in">print</span>(N == n)</span><br><span class="line">decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br></pre></td></tr></table></figure>

<h2 id="HamburgerRSA"><a href="#HamburgerRSA" class="headerlink" title="HamburgerRSA"></a>HamburgerRSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line">nbit = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p, q = getPrime(nbit), getPrime(nbit)</span><br><span class="line">    PP = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p) + <span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">    QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q) + <span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">    <span class="keyword">if</span> isPrime(PP) <span class="keyword">and</span> isPrime(QQ):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = PP * QQ</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br></pre></td></tr></table></figure>

<p>类似上面那道题</p>
<p>不同的是爆破位数变成了1</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_RSA</span>(<span class="params">c, e, p, q</span>):</span><br><span class="line">    phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line">n = <span class="number">177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span></span><br><span class="line">c = <span class="number">47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span></span><br><span class="line"></span><br><span class="line">low = <span class="built_in">str</span>(n)[-<span class="number">18</span>:]</span><br><span class="line">high = <span class="built_in">str</span>(n)[:<span class="number">18</span>]</span><br><span class="line">pq_prob = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boom1</span>(<span class="params">low,high</span>):    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i)+ low))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">        f = factor(x)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">            p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">            Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">            PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">            QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">            N = PP * QQ</span><br><span class="line">            <span class="keyword">if</span> (N == n):</span><br><span class="line">                decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boom2</span>(<span class="params">low,high</span>):    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i)+ <span class="built_in">str</span>(j)+low))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">        f = factor(x)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">            p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">            Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">            PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">            QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">            N = PP * QQ</span><br><span class="line">            <span class="keyword">if</span> (N == n):</span><br><span class="line">                decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boom3</span>(<span class="params">low,high</span>):    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i) + <span class="built_in">str</span>(j) + <span class="built_in">str</span>(k)+ low))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">        f = factor(x)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">            p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">            Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">            PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">            QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">            N = PP * QQ</span><br><span class="line">            <span class="keyword">if</span> (N == n):</span><br><span class="line">                decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">boom1(low,high)</span><br><span class="line">boom2(low,high)</span><br><span class="line">boom3(low,high)</span><br></pre></td></tr></table></figure>

<p>根据题目改点东西</p>
<h2 id="黑盾杯2020-Change"><a href="#黑盾杯2020-Change" class="headerlink" title="黑盾杯2020 Change"></a>黑盾杯2020 Change</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = <span class="built_in">int</span>(gmpy2.next_prime(random.randint(<span class="number">10</span>**<span class="number">399</span>, <span class="number">10</span>**<span class="number">400</span>-<span class="number">1</span>)))</span><br><span class="line">    q = <span class="built_in">int</span>(<span class="built_in">str</span>(p)[<span class="number">200</span>:]+<span class="built_in">str</span>(p)[:<span class="number">200</span>])</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_prime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(c))</span><br><span class="line">    f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(n))</span><br></pre></td></tr></table></figure>

<p>记$p$的高位为$ph$，低位为$pl$，易知$ph$,$pl$都是$10^{200}$左右的数</p>
<p>则$p &#x3D; ph×10^{200}+pl$，$q &#x3D; pl×10^{200}+ph$</p>
<p>于是$n &#x3D; (ph×pl)×10^{400}+ph^2×10^{200}+pl^2×10^{200}+ph×pl$</p>
<p>因为$n$大概是$10^{800}$大小的数</p>
<p>记$ph×pl$的高位为$pph$，低位为$ppl$，都是$10^{200}$左右的数</p>
<p>$pph &#x3D; \frac{n}{10^{600}}$，$ppl &#x3D; n % 10^{200}$</p>
<p>求出$pph$和$ppl$后，即可求得$ph×pl$</p>
<p>再联立$n &#x3D; (ph×pl)×10^{400}+ph^2×10^{200}+pl^2×10^{200}+ph×pl$</p>
<p>求解$pl和ph$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = </span><br><span class="line">n = </span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">pph = n // <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">600</span>)</span><br><span class="line">ppl = n % <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">200</span>)</span><br><span class="line">phpl = pph*<span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">200</span>) + ppl</span><br><span class="line"></span><br><span class="line">n -= <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">400</span>)*phpl + phpl</span><br><span class="line"></span><br><span class="line">tmp = <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">ph = symbols(<span class="string">&#x27;ph&#x27;</span>)</span><br><span class="line">pl = symbols(<span class="string">&#x27;pl&#x27;</span>)</span><br><span class="line">s = solve([ph*pl-phpl, tmp*ph*ph + tmp*pl*pl - n], [ph, pl])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    ph,pl = <span class="built_in">int</span>(i[<span class="number">0</span>]), <span class="built_in">int</span>(i[<span class="number">1</span>])</span><br><span class="line">    p = ph*tmp + pl</span><br><span class="line">    q = pl*tmp + ph</span><br><span class="line">    <span class="keyword">if</span> p &gt; <span class="number">0</span> <span class="keyword">and</span> q &gt; <span class="number">0</span> <span class="keyword">and</span> gmpy2.is_prime(p) <span class="keyword">and</span> gmpy2.is_prime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, p*q)))</span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>2023DASCTF暑期挑战赛——Crypto</title>
    <url>/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023DASCTF7%E6%9C%88/</url>
    <content><![CDATA[<p>复现2023DASCTF暑期挑战赛Crypto方向赛题（没做完）</p>
<span id="more"></span>



<h1 id="EzDHKE"><a href="#EzDHKE" class="headerlink" title="EzDHKE"></a>EzDHKE</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from hashlib import sha256</span><br><span class="line">from random import randbytes, getrandbits</span><br><span class="line">from flag import flag</span><br><span class="line">def diffie_hellman(g, p, flag):</span><br><span class="line">    alice = getrandbits(1024)</span><br><span class="line">    bob = getrandbits(1024)</span><br><span class="line">    alice_c = pow(g, alice, p)</span><br><span class="line">    bob_c = pow(g, bob, p)</span><br><span class="line">    print(alice_c , bob_c)</span><br><span class="line">    key = sha256(long_to_bytes(pow(bob_c, alice, p))).digest()</span><br><span class="line">    iv = b&quot;dasctfdasctfdasc&quot;</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    enc = aes.encrypt(flag)</span><br><span class="line">    print(enc)</span><br><span class="line"></span><br><span class="line">def getp():</span><br><span class="line">    p = int(input(&quot;P = &quot;))</span><br><span class="line">    assert isPrime(p)</span><br><span class="line">    assert p.bit_length() &gt;= 1024 and p.bit_length() &lt;= 2048</span><br><span class="line">    g = 2</span><br><span class="line">    diffie_hellman(g, p, flag)</span><br><span class="line"></span><br><span class="line">getp()</span><br></pre></td></tr></table></figure>

<p><strong>flag被ECB加密，已经给出了iv，我们的目的是求key</strong></p>
<p><strong>而key是关于DH加密的一个值</strong></p>
<p><code>getp()</code><strong>要求我们传一个1024bit——2048bit的素数p，之后会返回DH加密后的密文</strong></p>
<p><strong>既然模数p是由我们决定的，那我们传一个很光滑的素数p使得下式可以很快解出来</strong><br>$$<br>g^{Alice} &#x3D; Alice_c \mod p<br>$$<br>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造一个很光滑的p，即p可以分解成许多小素数之积</span></span><br><span class="line">p = <span class="number">1</span></span><br><span class="line">i = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span>  isPrime(p+<span class="number">1</span>) ==<span class="literal">False</span> <span class="keyword">or</span> p.bit_length()&lt;<span class="number">1024</span> :</span><br><span class="line">    p *= i</span><br><span class="line">    i = gmpy2.next_prime(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p+1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 接下来就是解Alice的私钥a</span></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">p = p+<span class="number">1</span></span><br><span class="line">A = <span class="number">6497613672285956425201511287597625030386480108672286755480826112363203245642148151212994725377254666591461004877010242830011793120730597548153751505160757772485565892716879723968695533469583944347775896608532625158303921475557511270608379047178615651278485591942635948967376062201899549648208278357029126731213145007749394102828405131490762093895807059008547765574826356405482971857911257856639902792877504986919307035949726</span></span><br><span class="line">B = <span class="number">6892121088985539176550813556605471863390995273766116635861764749041016271848611822954736310722897673081939505093515966422841748844230466887689109451140120941395556326881049077033545866417480327268932777262530024548392468111847291103142479432094000792091679519431359554583970331286677886683961473976144527513383303092681236504569767664611631709120184944129897975070357015740122424467791475504388327118892471415926469637241282</span></span><br><span class="line"></span><br><span class="line">enc = <span class="string">b&#x27;`&lt;\xad\x93e\xeez\x8e\x1b\xe2B\xe9\xc7\x166\xc92$\x1a\xda\x86\x12m\x07\xb2\xa5d\x0b.\x13\xee\xa7.y(1\xd0\xf8\xc5\xffL\xf1\xb6_m840&#x27;</span></span><br><span class="line">iv = <span class="string">b&quot;dasctfdasctfdasc&quot;</span></span><br><span class="line">a = discrete_log(p,A,g)</span><br><span class="line"></span><br><span class="line">key = sha256(long_to_bytes(<span class="built_in">pow</span>(B, a, p))).digest()</span><br><span class="line"><span class="comment"># print(a)</span></span><br><span class="line"></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = aes.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h1><p>题目:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import secret, flag</span><br><span class="line">def encrypt(m):</span><br><span class="line">    return pow(m, e, n)</span><br><span class="line">assert flag == b&quot;dasctf&#123;&quot; + secret + b&quot;&#125;&quot;</span><br><span class="line">e = 11</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n = p * q</span><br><span class="line">P = getPrime(512)</span><br><span class="line">Q = getPrime(512)</span><br><span class="line">N = P * Q</span><br><span class="line">gift = P ^ (Q &gt;&gt; 16)</span><br><span class="line"></span><br><span class="line">print(N, gift, pow(n, e, N))</span><br><span class="line">print(encrypt(bytes_to_long(secret)),</span><br><span class="line">    encrypt(bytes_to_long(flag)))</span><br><span class="line"></span><br><span class="line">N = 75000029602085996700582008490482326525611947919932949726582734167668021800854674616074297109962078048435714672088452939300776268788888016125632084529419230038436738761550906906671010312930801751000022200360857089338231002088730471277277319253053479367509575754258003761447489654232217266317081318035524086377</span><br><span class="line">gift = 8006730615575401350470175601463518481685396114003290299131469001242636369747855817476589805833427855228149768949773065563676033514362512835553274555294034</span><br><span class="line">pow(n,e,N) = 14183763184495367653522884147951054630177015952745593358354098952173965560488104213517563098676028516541915855754066719475487503348914181674929072472238449853082118064823835322313680705889432313419976738694317594843046001448855575986413338142129464525633835911168202553914150009081557835620953018542067857943</span><br><span class="line">pow(secret,e,n) = 69307306970629523181683439240748426263979206546157895088924929426911355406769672385984829784804673821643976780928024209092360092670457978154309402591145689825571209515868435608753923870043647892816574684663993415796465074027369407799009929334083395577490711236614662941070610575313972839165233651342137645009</span><br><span class="line">pow(flag,e,n) = 46997465834324781573963709865566777091686340553483507705539161842460528999282057880362259416654012854237739527277448599755805614622531827257136959664035098209206110290879482726083191005164961200125296999449598766201435057091624225218351537278712880859703730566080874333989361396420522357001928540408351500991</span><br></pre></td></tr></table></figure>

<p><strong>首先注意到</strong><code>flag</code><strong>和</strong><code>secret</code><strong>在转成long型之后是有一定差值的，所以想到了相关消息攻击，但是相关消息攻击需要</strong><code>n</code></p>
<p><strong>已知给了</strong><code>N</code>,<code>P^(Q&gt;&gt;16)</code>,<code>pow(n,e,N)</code><strong>的值，想到把P求出来再解</strong><code>pow(n,e,N)</code></p>
<p><strong>这里通过爆破的方法求P</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">sys.setrecursionlimit(<span class="number">3000</span>)</span><br><span class="line">gift = <span class="number">8006730615575401350470175601463518481685396114003290299131469001242636369747855817476589805833427855228149768949773065563676033514362512835553274555294034</span></span><br><span class="line">N = <span class="number">75000029602085996700582008490482326525611947919932949726582734167668021800854674616074297109962078048435714672088452939300776268788888016125632084529419230038436738761550906906671010312930801751000022200360857089338231002088730471277277319253053479367509575754258003761447489654232217266317081318035524086377</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 低位往高位爆</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findp</span>(<span class="params">p,q</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">512</span>:</span><br><span class="line">        pp = <span class="built_in">int</span>(p,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> N % pp == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>,pp)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>,N // pp)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        l = <span class="built_in">len</span>(p)</span><br><span class="line">        pp = <span class="built_in">int</span>(p,<span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(q,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> (pp ^ (qq&gt;&gt;<span class="number">16</span>)) % (<span class="number">2</span> ** l) == gift %(<span class="number">2</span>**l) <span class="keyword">and</span> pp * qq %(<span class="number">2</span> ** l) == N % (<span class="number">2</span>**l):</span><br><span class="line">            findp(<span class="string">&#x27;1&#x27;</span> + p,<span class="string">&#x27;1&#x27;</span> + q)</span><br><span class="line">            findp(<span class="string">&#x27;1&#x27;</span> + p,<span class="string">&#x27;0&#x27;</span> + q)</span><br><span class="line">            findp(<span class="string">&#x27;0&#x27;</span> + p,<span class="string">&#x27;1&#x27;</span> + q)</span><br><span class="line">            findp(<span class="string">&#x27;0&#x27;</span> + p,<span class="string">&#x27;0&#x27;</span> + q)</span><br><span class="line">            </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">17</span>,<span class="number">2</span>**<span class="number">16</span>,-<span class="number">1</span>):</span><br><span class="line">    findp(<span class="string">&#x27;1&#x27;</span>,<span class="built_in">bin</span>(i)[<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>

<p><strong>因为不知道Q的低16位是什么，只能爆破一下Q。</strong></p>
<p><strong>得到</strong></p>
<p><code>P=8006847171912577069085166877758626954304824756138758266557706391662987806065132448544117840031499707938227955094109779732609035310252723066470330862622641</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">N = <span class="number">75000029602085996700582008490482326525611947919932949726582734167668021800854674616074297109962078048435714672088452939300776268788888016125632084529419230038436738761550906906671010312930801751000022200360857089338231002088730471277277319253053479367509575754258003761447489654232217266317081318035524086377</span></span><br><span class="line">gift = <span class="number">8006730615575401350470175601463518481685396114003290299131469001242636369747855817476589805833427855228149768949773065563676033514362512835553274555294034</span></span><br><span class="line">c = <span class="number">14183763184495367653522884147951054630177015952745593358354098952173965560488104213517563098676028516541915855754066719475487503348914181674929072472238449853082118064823835322313680705889432313419976738694317594843046001448855575986413338142129464525633835911168202553914150009081557835620953018542067857943</span></span><br><span class="line">secret_c = <span class="number">69307306970629523181683439240748426263979206546157895088924929426911355406769672385984829784804673821643976780928024209092360092670457978154309402591145689825571209515868435608753923870043647892816574684663993415796465074027369407799009929334083395577490711236614662941070610575313972839165233651342137645009</span></span><br><span class="line">flag_c = <span class="number">46997465834324781573963709865566777091686340553483507705539161842460528999282057880362259416654012854237739527277448599755805614622531827257136959664035098209206110290879482726083191005164961200125296999449598766201435057091624225218351537278712880859703730566080874333989361396420522357001928540408351500991</span></span><br><span class="line">e = <span class="number">11</span></span><br><span class="line"></span><br><span class="line">P = <span class="number">8006847171912577069085166877758626954304824756138758266557706391662987806065132448544117840031499707938227955094109779732609035310252723066470330862622641</span></span><br><span class="line">Q = N // P</span><br><span class="line">d = gmpy2.invert(e,(P-<span class="number">1</span>)*(Q-<span class="number">1</span>))</span><br><span class="line">n0 = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(n0)</span><br><span class="line"><span class="built_in">print</span>(n0.bit_length())</span><br></pre></td></tr></table></figure>

<p><strong>解得</strong></p>
<p><code>n=8410363083727227985204019150296233995423906412694890252698371563789022268553444336554986979907257458547381598181369620318848637391220240378808211998052306324620364339595355706922325759625785590466818309839146408927226283350419069859849879835884942537531811470537915106995685907400782213608736735862576031042 </code></p>
<p><strong>检查一下n的位数发现只有1020bit，理论上n应该是1024bit，所以我们手动加上N</strong></p>
<p><strong>然后就是相关消息攻击解flag</strong></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">def GCD(a,b):</span><br><span class="line">    if b == 0:</span><br><span class="line">        return a.monic()</span><br><span class="line">    else:</span><br><span class="line">        return GCD(b,a%b)</span><br><span class="line">    </span><br><span class="line">n = 83410392685813224685786027640778560521035854332627839979281105731457044069408118952629284089869335506983096270269822559619624906180108256504440296527471536363057103101146262613593336072556587341466840510200003498265457285439149541137127199088938421905041387224795918868443175561632999479925818053898100117419</span><br><span class="line">secret_c = 69307306970629523181683439240748426263979206546157895088924929426911355406769672385984829784804673821643976780928024209092360092670457978154309402591145689825571209515868435608753923870043647892816574684663993415796465074027369407799009929334083395577490711236614662941070610575313972839165233651342137645009</span><br><span class="line">flag_c = 46997465834324781573963709865566777091686340553483507705539161842460528999282057880362259416654012854237739527277448599755805614622531827257136959664035098209206110290879482726083191005164961200125296999449598766201435057091624225218351537278712880859703730566080874333989361396420522357001928540408351500991</span><br><span class="line">e = 11</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">for i in range(100):</span><br><span class="line">    f1 = (bytes_to_long(b&#x27;dasctf&#123;&#x27; + b&#x27;\x00&#x27;*i + b&#x27;&#125;&#x27;) + 256*x)^e - flag_c</span><br><span class="line">    f2 = x^e - secret_c</span><br><span class="line">    if (GCD(f1,f2).coefficients()[0] != 1):</span><br><span class="line">        print(b&#x27;dasctf&#123;&#x27; + long_to_bytes(int(n - GCD(f1,f2).coefficients()[0]))+b&#x27;&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>解释部分代码：</p>
<ol>
<li><code>f1 = (bytes_to_long(b&quot;dasctf&#123;&quot; + b&quot;\x00&quot;*i + b&quot;&#125;&quot;) + 256*x)^11 - flag_c</code></li>
</ol>
<p><strong>因为</strong><code>dasctf&#123;</code><strong>在高位，所以要补上一些</strong><code>x</code><strong>代表</strong><code>secret</code><strong>的值，因为</strong><code>bytes_to_long()</code><strong>之后是256进制，所以乘上256</strong></p>
<p><strong>判断条件为：</strong></p>
<ol start="2">
<li><code> if (N-GCD(f1,f2).coefficients()[0]) != N-1:</code><strong>是因为如果填充的</strong><code>i</code><strong>个数不对</strong><code>GCD(f1,f2)</code><strong>返回的是1，则</strong></li>
</ol>
<p><code>coefficients()</code><strong>返回的也是1了</strong></p>
<p><strong>值得注意的是</strong></p>
<p><code>coefficients()</code><strong>这个函数返回的值是多项式中每项的系数，但是是从低次幂往高次幂</strong></p>
<p>eg:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f = x**3 + 2*x**2 + 6*x + 6</span><br><span class="line">f.coefficients() = [6,6,2,1]</span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>print(long_to_bytes(int(N-GCD(f1,f2).coefficients()[0])))</code></li>
</ol>
<p><strong>为什么返回值要在前面加上</strong><code>N-</code></p>
<p>翻阅大佬博客：</p>
<p><a href="https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/">密码学学习笔记 之 Coppersmith’s Method | Van1sh的小屋 (jayxv.github.io)</a></p>
<p><strong>自己弄了一些简单的数进行测试，我的理解是：</strong></p>
<p><strong>假设</strong></p>
<p><code>GCD(f1,f2).coefficients()[0]</code><strong>返回的是tmp，而我们要求的</strong> <code>x</code> <strong>和</strong> <code>tmp</code> <strong>满足</strong></p>
<p><code>x + tmp = n</code></p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>2023PolarCTF</title>
    <url>/2023/09/27/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023PolarCTF/</url>
    <content><![CDATA[<p>六道密码，五道是古典（讨厌古典）</p>
<span id="more"></span>

<h1 id="天干地支"><a href="#天干地支" class="headerlink" title="天干地支"></a>天干地支</h1><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">小李某一天收到一条微信，微信中写了几个不同的年份</span><br><span class="line">          丁丑 丙子 戊辰 壬午 丁丑 丙子 戊辰 壬午 壬辰 壬辰 辛未 丙戌</span><br><span class="line">          微信的后面还写有“+甲子”，请解出这段密文。</span><br><span class="line">flag格式：flag&#123;XXX&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/Ancient/14.png"></p>
<p>把这些年份转为数字，分别得到：<code>14,13,5,19,14,13,5,19,29,29,8,23</code>，加上甲子，就是加60</p>
<p>然后转ASCII码得到:<code>JIAOJIAOYYDS</code>，套上壳:<code>flag&#123;JIAOJIAOYYDS&#125;</code></p>
<h1 id="全世界都在说中国话"><a href="#全世界都在说中国话" class="headerlink" title="全世界都在说中国话"></a>全世界都在说中国话</h1><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">663867570008258541046114143248220132000152072143</span><br><span class="line">时代在进步 中文也可以被翻译哦</span><br><span class="line">得到flag用MD532位小写加密并套上flag&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>中国电码转一下得到<code>这都不会的话就给你一脑拍</code></p>
<p>md5加密后再套上壳：<code>flag&#123;679384ffaee1e8145a52408ac7ad6bfd&#125;</code></p>
<h1 id="low-encryption-exponent-RSA"><a href="#low-encryption-exponent-RSA" class="headerlink" title="low encryption exponent RSA"></a>low encryption exponent RSA</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf-8 -*-</span></span><br><span class="line"><span class="comment"># @software:PyCharm</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;***********************&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = getRandomNBitInteger(<span class="number">2048</span>)</span><br><span class="line">e = <span class="number">5</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#n=18049146130359556157811138499355569967231668855528566823643376144155931993553424757354835027829037263429007310779886281743425186527415596058004878860570474866413182148724803537036078612785180550377667299555519230603647447077725080756322343538156406080031959768393145744701092093127752647143419553963316375696232038952573236311522683541862835602321038621904842874356522524316864553501304106884213097353522958546518042728628006318129608745487662533959888992223736595503203451378533217004433230837006796341055201266431153548000348148960250455415972226546646460918890401484239320725539304914347952245606818833495867312063</span></span><br><span class="line"><span class="comment">#c=377041108412334062897923100149371833160065752130578483588828849399791858197434981428466047315212724764223394695011882740933537996983126187094472520344493047769519118482187945467176598341785927269390299847888131061799861412055502165865052720513992259109503509827127768615772091500352075827289290029872935215672798059068944088543667111296361405639896493856695176145088430237388172420390881291650155157688737470414069130558367036786376549227175617218017578125</span></span><br></pre></td></tr></table></figure>

<p>小e，开个根号就行</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n=</span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line">m = gmpy2.iroot(c,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="眼见非实"><a href="#眼见非实" class="headerlink" title="眼见非实"></a>眼见非实</h1><figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">1111011111111011000110010101111111110010111011011110000110001101101110101110110111001100011000111100</span><br><span class="line">得出的结果用md5加密后套上flag&#123;&#125;</span><br></pre></td></tr></table></figure>

<p><code>1 -&gt; A</code>,<code>0 -&gt; B</code>，再<a href="https://wtool.com.cn/baconian.html">培根密码解密</a></p>
<p><code>flag&#123;68e5987347d955690d9782edc531ddf3&#125;</code></p>
<h1 id="小精灵来咯"><a href="#小精灵来咯" class="headerlink" title="小精灵来咯"></a>小精灵来咯</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">结果用MD532位大写加密并套上flag&#123;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/2023PolarCTF/0.png"></p>
<p>啊，密码题搞个压缩包加密</p>
<p>把右边的密文<code>eag&#39;expxwxj</code>，<code>key=itsme</code>，维吉尼亚解密得到<code>who&#39;stheelf</code></p>
<p>docx文件里面是<strong>古精灵语</strong>密文</p>
<p>码表来源<a href="https://blog.csdn.net/Amherstieae/article/details/111134283">misc学习笔记2-图形密码-CSDN博客</a></p>
<p><img src="/../../images/2023PolarCTF/1.png"></p>
<p>对表</p>
<p><img src="/../../images/Ancient/1.webp"></p>
<p><img src="/../../images/Ancient/7.jpg"></p>
<p>得到<code>herec0mesthee1f</code>，MD5大写得到<code>flag&#123;08460AE514ACCC54E5D8D4B690A75D29&#125;</code></p>
<h1 id="round"><a href="#round" class="headerlink" title="round"></a>round</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">这里有两串密码，来找找flag在哪吧</span><br><span class="line">（听说阿拉伯数字全世界通用哦）</span><br><span class="line"></span><br><span class="line">和谐民主和谐富强和谐民主和谐自由和谐富强和谐民主和谐自由和谐富强和谐文明和谐富强和谐民主和谐自由和谐富强和谐爱国和谐爱国和谐民主和谐富强和谐爱国</span><br><span class="line">和谐爱国和谐自由和谐文明和谐民主和谐富强和谐民主和谐富强和谐爱国和谐爱国和谐自由和谐民主和谐富强和谐爱国和谐爱国和谐文明和谐富强和谐民主和谐富强和谐爱</span><br><span class="line">国和谐爱国和谐自由和谐文明和谐富强和谐爱国和谐爱国和谐自由和谐文明和谐民主和谐富强和谐爱国和谐爱国和谐自由和谐文明和谐民主和谐富强和谐爱国和谐爱国和谐</span><br><span class="line">自由和谐文明和谐民主和谐富强和谐爱国和谐爱国和谐自由和谐文明和谐民主和谐富强和谐爱国和谐爱国和谐自由和谐文明和谐民主</span><br><span class="line"></span><br><span class="line">lqbehgfdajmopcikn</span><br><span class="line"></span><br><span class="line">将找到的字符串进行md5加密后套上flag&#123;&#125;即可</span><br></pre></td></tr></table></figure>

<p>社会主义核心价值观解密得到<code>1014014020140881088421010884108820108842088421088421088421088421088421</code>，只有<code>0,1,2,4,8</code>，判断为云影加密</p>
<p>云影解密后得到<code>AEEBEQWAURAVWWWWW</code></p>
<p>再看另外一个文件</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">BRUEIFYRGBEUNVUICRHFU</span><br><span class="line">FYURGUAROINNIEURYVYRU</span><br><span class="line">E3BYUGDUWRNYUTFSRDE5W</span><br><span class="line">FURYGRUTGUTUNAWGDUIEB</span><br><span class="line">UYGIGNGIHFYBFYURGFURB</span><br><span class="line">TFRUBYFUVOVNERTWINDUE</span><br><span class="line">HUGRURBIGGNSUITIMTQEI</span><br><span class="line">GBUTNGUIJTINGIEGFURYU</span><br><span class="line">TYVCTYSAIBYEIFWIRHUGF</span><br><span class="line">TRTUBGUYTRGSONIUONRRI</span><br><span class="line">6YMUYTNYTIUWABRWBTESS</span><br><span class="line">BRUHGUFGTJNUBAFDEGTEF</span><br><span class="line">DHYEUBFYEYFTYUEBFIUBA</span><br><span class="line">CTBRTNUKMIWGRBEHSDDVC</span><br><span class="line">RUEBFUIRGFRBVXUAVTYEF</span><br><span class="line">YUGRTFBUKCZUIWEIHUEFB</span><br><span class="line">FRVRUIYUFRLNRUYGQEBYE</span><br></pre></td></tr></table></figure>

<p><strong>托马斯杰斐逊 转轮密码</strong></p>
<p>原理：给你一个密码表，n行的26个字母，key是 1 - n 的数列， 密文是 n 个英文字母，根据 key 找对应行的密码表，然后在密码表上找密文字母，以这个字母为开头，重新排序。</p>
<p>官方wp（B站搜PolarCTF就能找到）有解释这个解密过程</p>
<p>先把<code>lqbehgfdajmopcikn</code>转成数字得到：<code>12,17,2,5,8,7,6,4,1,10,13,15,16,3,9,11,14</code>，密文是<code>AEEBEQWAURAVWWWWW</code></p>
<p>比如说第一个key是11，就要把第11行变为以A开头的串</p>
<p><code>6YMUYTNYTIUWABRWBTESS</code> –&gt; <code>ABRWBTESS6YMUYTNYTIUW</code></p>
<p>以此类推</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import re</span><br><span class="line">text=&quot;&quot;</span><br><span class="line">code = [</span><br><span class="line">&quot;BRUEIFYRGBEUNVUICRHFU&quot;,</span><br><span class="line">&quot;FYURGUAROINNIEURYVYRU&quot;,</span><br><span class="line">&quot;E3BYUGDUWRNYUTFSRDE5W&quot;,</span><br><span class="line">&quot;FURYGRUTGUTUNAWGDUIEB&quot;,</span><br><span class="line">&quot;UYGIGNGIHFYBFYURGFURB&quot;,</span><br><span class="line">&quot;TFRUBYFUVOVNERTWINDUE&quot;,</span><br><span class="line">&quot;HUGRURBIGGNSUITIMTQEI&quot;,</span><br><span class="line">&quot;GBUTNGUIJTINGIEGFURYU&quot;,</span><br><span class="line">&quot;TYVCTYSAIBYEIFWIRHUGF&quot;,</span><br><span class="line">&quot;TRTUBGUYTRGSONIUONRRI&quot;,</span><br><span class="line">&quot;6YMUYTNYTIUWABRWBTESS&quot;,</span><br><span class="line">&quot;BRUHGUFGTJNUBAFDEGTEF&quot;,</span><br><span class="line">&quot;DHYEUBFYEYFTYUEBFIUBA&quot;,</span><br><span class="line">&quot;CTBRTNUKMIWGRBEHSDDVC&quot;,</span><br><span class="line">&quot;RUEBFUIRGFRBVXUAVTYEF&quot;,</span><br><span class="line">&quot;YUGRTFBUKCZUIWEIHUEFB&quot;,</span><br><span class="line">&quot;FRVRUIYUFRLNRUYGQEBYE&quot;</span><br><span class="line">]</span><br><span class="line">print(code)</span><br><span class="line">codetext=&quot;AEEBEQWAURAVWWWWW&quot;</span><br><span class="line">codenum = &quot;12,17,2,5,8,7,6,4,1,10,13,15,16,3,9,11,14&quot;</span><br><span class="line">codenum=codenum.split(&quot;,&quot;)#把这些数字都弄到一个里面去</span><br><span class="line">#print(codenum)</span><br><span class="line">a=0</span><br><span class="line">print(&quot;解密后的：&quot;)</span><br><span class="line">for i in codenum:</span><br><span class="line">    index=code[int(i)-1].index(codetext[a])</span><br><span class="line">    a=a+1</span><br><span class="line">    code[int(i)-1]=code[int(i)-1][index:]+code[int(i)-1][:index]</span><br><span class="line">    print(code[int(i)-1])</span><br><span class="line"></span><br><span class="line">#完成了变形了</span><br><span class="line"></span><br><span class="line">print(&quot;下面是每一列的&quot;)</span><br><span class="line">for i in range(len(code[0])):</span><br><span class="line">      str=&quot;&quot;</span><br><span class="line">      print(&quot;第&#123;&#125;列的是:&quot;.format(i),end=&quot;&quot;)</span><br><span class="line">      for j in codenum:</span><br><span class="line">          str+=code[int(j)-1][i]</span><br><span class="line">      print(str.lower())</span><br></pre></td></tr></table></figure>

<p><code>flagisvucuuub3ayr</code></p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>2023MoeCTF</title>
    <url>/2023/09/25/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023MoeCTF/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重试" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="4c153479f52f15825d79e53e96665df0f9d03cd35ff1abe8794d2722d93fb0cb">ee88741ea599eb54e0cde20fcde6e56ce8a05d54462545974532051cc69ce0a777d01f8e279a73a0c4ef4ccc02a3a69d303227b736b98a19639a960ba06192d81777cc07fda00f2f8781ecc1dd501f49f1eaebdc083cf2d62b64916e581763df18023f3b4a07eb6c3cc33055fc81dfcd60569e377dbfe1610ff363731272711f50e1df397a2a0e2b871a64dbc338b80f67078f4c9fc8fd24852e47a471dc33245133cea31f4a9cd1df0161db7f8dc44f7f0a175646426258dc0cceae1bc24802ef1fbe2787af9599aa343eced5c38d32b7eff96fd4b9905c0f13e3391bbd2c0d6af874d9a0181105f9e19ef46f8cf0df80619c53fff03b4a1c0f99378c0a0c27b3f2e687619acc858a33dcf294a44fa750338d7b75642360a0e649166921b9d2fb196a4e2c66a3cfe4038dc2f580b0a3badc3ec803e8e82789c0a2342a71e2840a1dc797627085d66f279453fe3daa345eb5fc57ed0da4c28851a6fd764f46a9d2ddaed4d3962e42afa6150889fa8504ac1d0b26b12094921f0348bf8d3224df84346cfcf80abf0a7b0805193d7a05bfc04e9b996ee0fe35f2316a29c61d8d0b364fcd89552259835872c2ac5064b88592a0f86f021da85d6c108a1d7ee360177d49a93da4b74e1386c8f6fde1f73da839e85869340c7a04f07fa7b72926bac044fd9c123e09e106bcc70084b2ebffd76519465872f979b68bd6f8797bc517f3783d0e905d60b69086a3c7b998537762f37a664ec2c92191469153a94fe88ec6e4baf9187bb54f4dd7b5e4d8867018bf2cdd0fdf49fc5e054c851c98ddd626e5d0720fcbda2785211e8da320a9444e6e1535133a648f39c3c959ce3ef1e48261bb731a3e40323e3f4360808fdd17159a5fd92a0afcc16b0358c7b093a15117989947b787cc553046be8f609e47a2d161ade27a97d8d5238103d2d5d3158dcd6c4e3ab70117c1eb91eebd1f122ba1b17d4e2fe79b3988d5f177f10a06324671563d79b2f02bdf866cc56be22b2e34fb15edea45ab4bc15a8157e5d1e53d9ca3a72f45ccd31dab8e5bce21adb9735d1721742330a9565d47a69b35531562190356f2b914154cab09a502e3ab092fd535378a579c1f0cf78b03dc080edc2a756b691e81779f905bb9178be323abbf90a03a0daad879cb10f72dff0d116c1e3388f1991af2f585046f549f12c9f3768548bcbc6b2ffaaef63b696bb0a5b1f2e02849d76779f27b947f6b9f452a9b7ab72b06cd8c6213b2f456a945ff555a4239604d814d709bc058edace9e9fe5ff68c8a9205d11735245c53a71826fd9b6169b546e73857dcdf613252a9d148f320c9359b0befafe559159f1729875de0a77012436b8249171fc649fb9566a2f89fb5e8ae56e537e656362d5685e8dc344ee4b5671a544cbdc82210eac27517e67d12ff8e8af67f4f80e08a06c7ce8c52c53c7af33e7c8990ee605d48aa8114ba37b745f0f1cbe280106b512dc37ddc93ad3e7a80ad60f5c2ed4cf6dd70bcef0ed60a793a5e03327f1ffd19c985d4f183d14f26582cc95e532f73c41fb54104423842047e2926e6839ae73d464cf2aad0323a66114575966a1d34874b071674488da61650a402080ca8a4f1524c09308c52ff63181356dcad8078797e952f2606f264b7234fc3e077780bf3c7981263fb78517baa52af02170c6b580b5e99c2d1d085965d3a85b7721a45a6335b7fa80880996cc98a9d1a3d2b748afe895bf0d37d1476edc5e70f5ba01b7e5781deabdddfc13584ea9000d4419aa4fbe6646c1ab0cb1455458a39ebf3f9ea95a3084d7f717803895fae526aa96d2099e1c2082cadfe14686fecfbe5caa6c5c90af2f5ac3925c1f38c43a9c7dbc98bd8bceca0dfc2056d08f1f2565be3475fe5b9548279884a871fd467cf9b4946973d344edfe6440a48024fd864ca0403bee16b47d0f5add1e87261ae12001343bbe600c24b0ed76bf0f188358628ea7f240a46356c599520f3aff61b56434994b48248d36c4dbeff558dbae709b23e48a5bb2b6e846683532aee6ea90c658cc3467b5c6f36ed2dab40508ef4c6b62020b3268e710c12dfc3708991c00002a01a8315f9d5f4c20557e0ef8ed21aad0a1984fdec054320421b7cffb65a20829e725525b7e9b9875536e3d0b57bc7eb90c0b54d23c037bdf2a2de29d1c939774ff3f4b54d0658dc1575ecba9307bd301d02d1062a9a32a56d92c23f79c217ee85693a54169e90e0d2c6cf4e78cdf40531b87dbac09b351d1b9fba3b2a3330cb6245ec515f9a9837a2e6661fe5b6dcf5d36a43389754db3ae5a03fd1c03ff290fd2bbe32205a00ed2690dc5db2eb37c6133031bcf53ee5db90e64ea0727cccf70668d3eddadc0ed509091508266fc7195a095f37dbd885a84b529db2994ddae91839b337749c68b5d9585d969f1d6a51babf513ea34dbad6bc3be568a245f054818e392731360d99ddb6104a27ef8a4266ce6bcc5e062c278b579acf783c65dc058c7ca9fdcfacaa3ad11b50ccd38e3dce739d9ff17fd053f527a0e85d27835b98dc469a374819bd70cb9ba5613bb17fe6aa26dfe1a94b91a2f66895f3c53f485b842119cc93b4bfc67ecf6882cff71758fa51185892bcfd8e79c07f41d9fc74876916670f5b22ea5cbc24a5033c0a777981f4b01dda8c4765cdbced84497fbfd31b9b850b555174ca1459d1184fdc21b9967f35b8773cb62bf51d98d462f16cbe948a65e62ff4446841e2ccf5e26ff0baba09a9a49da483b21333a8eb55dcbecadec11473463b83d81a8e37fef63a246053d922cef9719b438999d333379e6a13f04568d5c369b9e1a247460bfeab9facc204f034adf5888f8ab559dedc9d503983b22817371a8f43f670dd6081ebdc9257839eae31afef4fdeed70efa6739b90705375c72c4037b403e483c67399b7ab466e07b066fc66f7857006e5eaf1b59b992415c85d30c2edac8ca6299582a2713250e767289c3350f618aced5bb45aa1a3735d3a44c73bd922389a209f9cd273af0bf81c851e0feeaeb9c630e9e97afc92544318387bb58e6603bd774f11b07ef4e719c7e7eaf9d918b6e1a0b2a576905b4d28a6a4971a6b94050d80b8c4d22a504b52a551f8d84d62a154f447cbd7432f52d2e5b3331c0092de2ae76f96c6d6d4643c65acaf0191e844d585a64d62ee05de3e0ee591eb9c7d63fe06cedc7fb09fc812c6af940236a530d7d5632b32649b7694e47913f97838407b1bd6a1471d79348f0c438407b3513b965656b98ef2efd16bd220496634ae7b147364f64e85c4947ff7354dd15fe68e7c1062c31acbf5ceac78252ccef30972b53bfdf629bf34c3daae7def10a2508d58a9774fd24440b7adf348d5b29190388d60e672dd39363b02c9d8503c4486c3a9a7a585784386b154a6acfcb8b6db3eff71e4cb0dad17f5cba254f55655cdafb03ceee9b5e2f9448e0f09aed60690cd69d42f6f55d7146857f63a789c8db1c34f30e04b71513f395c5db34035edaf69249e0b5668f9045db40fc8527f6b8a9a08780917df85bab9cfed67f4820ee776318cb837f0e8846d3687a4827972acdd0a15ce1148d4a7accd299406b60946c744d5f87730889c74899fb1785723d660d0717802eb16c6bd6b0af874396efa5a2c1523895d8b91f7c951f2673f04e88286ea426d0027e3c5c3e4dad2b6dfd260bd0199ab783572f27cf010b6fee988dc76bc9e59869f814b7cc213db032ff4a0fec4e69abdb1739ced3b493f2df75db3ed3aed7e9be7764d58f57e9944c531fb0f7d7a64c7a69b9c070f3e9868e575d056e96dcb348a77fffc52fee61aecc88f277cf63cfd7cd8b0881833d78102ba1e16f0c4280df0040714cebab96bfea68135a58cafa95944240ba88dcf9883f8020049587092e0c39b7b536b0ef070e88f1854174ecdadf959d002533ef9efc08a11785091c8af2bd884b267d93b58f41cab777d4ad0af229e04ef3113125f8370fefedbd0f3aa300a91ca6b2cebe72b8d69f1061148ec8675198e6aea06e5c50ab88e475fe6ce279caae6f84da8604c1d5e472e4868b0d785b53847ce948f00fe9783bebd9620266a7156b8541ba73db68a832d513737d0afae1fadcfeef00d0430392ecab15a8767bd3ec632cded2d8387b0f7cf7bfa642aa9c4a8c4be55e29eb6a5ca00cd2b5cd40dcc051ea079876accce007ef3bc2f7376f369f7d6f47979e718e21783414c5beea1fbe50da4c7a79951d0f5423a0a5340b7ebf315548061c51115068d7fbb53d924efc56bb89fda6c403da3c53bcf626f1565279caa1ae03dd7128631d5981e1dbba07155604481b66a65cad6c5249d1fa0da75312bc58cb61fd07a3a1f56a0572dd30e9ab0232fa670af8f403148bc0a6fee9592fbb2589fb30b4a801ac974d009615cf5472fb39f83227d228037891e9163ed4d35ec4db6849cafc773eb7e5739b99b2f81f4dd757794e64be340c44bfbed3170f5c4b90c66aceb09b75c06d9d7b6b01dd5313b91a518f4cc50f14f5f808a88a9b54e8b445f5474a2f8068ac3128ef5e85b07de94c081776ce43848029bbcecddafc03d20adb2579a1cd4c1cfcab85e02363093e8b89cfef0ebb899165cfe35531c0424749ff63b9db9b16bffa1254a266ae02f14a460e4826fa01b62aad0a20b27b3f20fd37c59f528b0d2c31980469fec8ca0271d215371dec6b2701280b3722e9c312321de70dce1b0a30b7d99742914ece60e4e22eac89561aa46cab8054c61ccf0f2297585c5c6e3c93f2c0112ee03cf301140f18fc303255bf01c3b1ab2da9b25acd531e0f23c21222424f42ddc85b04a211a7e7e19cc499beef0658e6863da196134d0890ff9fb2a58c1e153ed564db09a01174b96df3debde535330de95068bc7fa90b559547b9a9cbf66999b068894e5e5a33ceb320342019b58ec9cc525ddae1409c36791d79a883bdb4828315052c033adbf02ae5e4d541dd8e7fa60efdd4d03e814ff2a6b3a553c528232188c84802608aada227fd44b75ba63a396b3405f5e509bcf0b2f66dfb46db5ddaedfc843d5b7f808650eaf9622d062fb87a25ce7e6aa21b8fe1fbf3c6c5f3fc11443c9f43ea6fa477f00ac97a1b75a26871259e2b27bfe397cf060be43c031664b6b1b253c2de98c2fd808882a6da7926d136d816ccb65b726661398d896702b5a140e6d56ae6822d9823d1d6581306028b1e3191b38808fc3cbf862ebc54d0d3a6199fa92588069264d803341e612bd06fc8722414a3ca9b9a07576e9a400b85ba45b60d634488309e7f281d8f50adc43440ed94dcc3a08f8eb95e08174a2ba06a41791974ebeaee0d57ea20d7273c3a70b7ab16be9eadf7be1860f9f19935add037878dd87b1a385edbba6330067bd609d4f0b9089f0cc1e0df19904f3b2c7d5d4f5803db0236a4ec13561dfaf799274eda081f47e89865f31ecd294fd64d206d6c3f247c07794fe4f1afccb37e4285c31029f740792a1e58958b3d1562e0449761893212bb29373dc30a0f4f7b8693b5a2f0d8ea99a123275721f7c519cab1b1ad26cb1baa034a9e305a8a81653a48c66019aef896adc5d8f8633452252039cb724599f16623e1bc802ff5122336c9061bde9854f53e08cd701e5f8e5e04b87c0b0a9700961e8503e072e3ccf32a100c2e7a56f0ac225808696041658fef9b9f2d52b5b4eac502c1603b1ab71fca2801e721cbb31ece38a340034a9ee0057d65d905a7205bf3433e822d3a2916c82ce087bca6430d581411805d8facbb08d707e35f464a0bce224fd37f4de4fb562646ca665edfe3a792507ef8028789668572cd9dc9637721a591e43d223c5c2d4f161f3d7884a849294e6daf1cf3278226760c97fa9b566428ad4672d8a80e11659ceb08f322997756260fa9f293c7e9c8e0b8e8a7c8b48b93acf5d0949d96572c0c42624b2cf4560ed9521701f606b985fec9685b92b3b2c95ce73ead689f02d37c5c72c1f0f415525746c67d800425b2a8692d74aa943ebde258085dc3e787bf4f9e9f371f6b7b2bd1afb3809c98f9767b1cb75e5f3afe9709d2a4710331987666fd45049e919b43ce6452adbf11df4e85737c7719c08b72889a04af70dbd8cfe468cb21c97b509e463d84a2e6f0fddd18b19f4edce976132de30b926d4abefa3d8e726e1ff1e9e24f26bb68cafbfb7a5edec5e44135faf8bf8ab508f18fe25c853065f061a8e603dd83149a3ef838692c1b576f0dfd7a14b5b204837ce386362fa85ce94a3933c4236838d03e72a70a03c3e0ace11065f3aa24d837d079fa110b313a68861979d5cfd2f56b0428715f3e0e3dbabe341dfaad343595a3285c869d04b1636bc720dc30142a7fb20cca513002b4e19c8f5361c890ead4d24b24ce6f01d9cc0016717a7f5922ec0869f0772da76acb8069324ad28765f65209dbbd22149c1ec8e68d3625a2be7c028e9ebf1213059a30fb14f7c5d384ecb919d3a99ad761207980dfb0abddc31f95b51bb4575919c81f41a8557b13c29d3c62afb10aa39297b66960e85fe2618b76a24e788bf1d189f2eebcbc491cdf8441f0a9c126e5cb330633791147bebd53f94f68c7a7017621260a5571d987eae29a524933841f87b5d062181faa064f1627886f99eb78851d369eab99a44733788238bfee1e24813bc667fe28397367e0eca66a575b190dfedf1aa3f677f66a69836f581e349b6564fb9086dc3a2afa260d62ba98181427f8d6d45eaaeac2822064d256569d3c147bd1d1b47c067f2cd14b9adddf6bb56d90b552621c061b5a622c12ae39ffdb775e3669bfa3479c5456b912669f410d3956919fb7b805ee395ec950843c0b56778464d9b110955832483963aa78f3d76ac40d5d20e01e7831ba08e8e3399f1a212cec9978316d99467593761bf166a3eda2947c9ccd83787dd1ef00f3c76b5d58683a652905651a086cdf6ef3857d609e173a0e6bc370b3bdb1843a0113e06cadf1f2de754bc553b62c1376b8352ea440012496d20bd4fcdfe1872fcc7dea9ee967bc7e3080952c536a39eb9c07a9cd8fc38e87962b27343d687e605cbf0dfae13e4a5af94255fb15ea79f2a4b8fdc53c7a917b40adb2005135ff53461df9dd318f778bff79d12ecc8b442defb866e122f28f0b22d0a8e1b544f64038684133dc629a6ff9167acba9cc38a3e0cc59efc869ef6f3902e1da53a945ffbdf51d6f84ad6105f9e1592d04dcafd5163967e7378d9b2a9e12180d15d7dfef31413b0c50ae4f75bb68a809f81f091acb28e06dcfae935e9e31fcf9c2311f531eb5ee0ddb9e1adde40945ae425cbf5592c2ab0be07420559a5cbb0b171b7d864fd25b5b2cb107b5a261a85f6aa788f61770399d6211b22ccb2963356ad8d2bf6254ea929fb106b0c276cdf644d5a077edffb12554be8b25461183c59c6ede1741e497eb0457c3bef6a897d7b8fff8769baeca5aca1e2b711df465a1678f4ec9e8fe31c8fce47b7dba0f62d05508aaed8e8fabf8aa1d98dd19ca37d53136641df499b6cc565b46ecfbaa8106a277a1633b11519495ba2250c3bc4ce71e9cf16c33df9bcde411d53f72580cc25c676285baa41f2ce6179132b95f072d286acff8bde91b17fdf4e4f10767814ed7d91de9fbe01566349b70398dde1b62c4b6d4e56a76605332603a8677d5b4909c6e1781531f573372a8150dcb69fb0341fc93a421297913cf33bcdd706d4f4117826cb0e3f41c59b9c7426ae669ea58ac919ce080670c61ba67f83b52654fbb0f816c98ea73176815c5b133982b0aeacc13c923e4c7fb3f0dc00e627a5d415bcb600f3e6cdce8b99c11ba1cce8f0a709a95bf28a82357e68127aed54383bcaf17aa4623ad685d05876727859f3ca23b62bca89d5610956056249f27fde6e070bfaaf729509663a4d15ab893d5a222a7ddeac6fc499f829b1c71034713727b4ccd6be1de1b076f8dde70099d7ec78b6916b224c9ac085e520df21476dc6ad99ff70f29cf96834d4d79098526f0e1b13403dd7bfcbf9ad62bfe99b0d8e99d57710b919cb8785ffa239bed5433257ab19bb45babbcc09bee23d6cc67b3624aef4c97ac168f55b5c865a3c8e3d86f709ed6e8edfe01639e966fa79c5b192afc7500f79156039e2d479ec626eb623debe709dc9dc4a3ded872782ff14fea7c3cc6477d13ceb4be9cc33afb05040eba0093cafd8cb56cdb39d891a7a6788f60cf83de6a2ac3c8a417a5d682e939ffe862f1f795299f3655db5680cfd231b6e7a51877fc5c0e45d285acd50140ff9a9764ec8d4de1dce6d04f772c9732a0164c650f05920e89ab222cffa169767dbaa244acee284f0440ffba5e512a27846dc2b94deb2ed57bf06b39449c9ad9492fa8404d126d07258752bf2e5fc20b74c856e4db22e75711087ffe550a11fc37e7d975a758afe8ac3dbcb183fdad9fb69f1a221892c617f125cecbf00a708cf1f6b252fba3113873242c8b799d769ba11bdd6aa8e6c7d642a0418e15a69ffb5a2af4579ce5e29164802fa3f8ecc523481e8b7a99e02456b44c4fd89be63887ad5bb679ad666ef70d6807467f8781d21e1e2569791a50fe3b43f28295555ab7fe129f8f174897d12268baadc5c9d8f7a1b6d1c36e9ad7eb1ae01a79af3944cc0e1131023bbbd974f155ddf1a2e6e6b499122f12c262393c657bdb90ef6a343654dd5d3037a04cf1973e77523bd869f08ababef4129fc07a96cf315ca7f04d7584037c41765009eebf6e37b350dc912a996e4a15f746f7970f967c43e4ac1425ca3cb505c80afef55ed667b8b566bbcf862c892a114e3276f3b8da8962fec4de4fb2d0dbc95c66ec0b1ab6edba824f0a7adabd070602155cb1df7b617464fd749b8f2dc364366551315caa340de22900e607c3a9120cea0aa4c61cc92f8f54d5cb29e6a807a5f72e72c9c7f8be22869394176d3baad04daa0f51bce36b831788e2fd08b1b1b569ffebfc7dbb7b6ffa34f14f76c8863322bac255d28ed1b192829b2108e3b5625e039cff33aadf5381562b07f78222e5b63771cf3d6f5ebfd59bbe301ea55b5d0cdff56e689264aba7ca2f970934161ec0edc5329ac7214c2f07afb170ef5f4cd9bfae799be35939c2c26e21293ad1eea140668a50ce6d0dc78a243d67fd66b31d0b0cea011ab6ce4cea392b43035f16c85f82ce6f97d37db7096900795962c77ebfa53b400a58156a6ba19c50c68dfffb79616ca3436bfe05af50730dac15eb05aa7873f19aa912d01004b9d900b2e0881908c4d85383ec296a9527c6c7b6c2fa449321d949ae4f4b3b8d5b253a79e06568da37ee9941702259752e7ae549ef86cd789459a8c614351b65cc7964e72f610235f64c3eff234cfd4e45699091f4517f2df7d441a985f05b6410e7a931a054d793366450a83bef813891dda65dbb7b187f423ff611d78e08f30e63f947e258ebc07587c9c02d61d11149bad1a0ecd5314ccc42d1bae1a4445367b45e56872e55e9204f4ab67cd4b4c7fe4f16fccbd404117560e88e1deb909791f693ed98181970ab4a00c976541651104fb640a138171120132dc25425c4c51c746221ac4cea156549b9d7cc3d8f9ed8d2e6c543c58869c91bf8fa83d200edfee18e3126025430fcf31fd4e9adbe7845a8b15b394856f68c0bab16ec02696207d78fc1c06fc28930249c70a234f79ec437936e24885589f6b684c18ad4c5e9636e120723b4f4b708c2658a7c9f97a9c010f927bea794ac70917b857644b6aaa4a21d0ee7312dfa34488bb431c5339a56d78bc9c5ccbaebd9d831e36b86b6602c04fb4b77f18b2a5a685eec67f5bb662b4d386d6dc738773ee8d492aabc061f3268fc189423914ebe36964e49b0d63b8c2665e267fb6880c4588eaf080c0ec230849ea74c362ea7fb3996f4050900f3571979cfb086214b13020fe392e8bc8557f773cc7a45a92f7ffb69ee1d60bddc6d491a6f213c3e27bf8dd4faa35ccb3d9f82fe49847c94bb3b776bf0409123611d1225a2c38a13a1af39e32b74120d28629722919a42d336570ed2a1faeb03c4b6e7d15b7fd2eda59e84198594b109cd1292d0858c2783b76bb6e126367e2e0fb601739921654896ca0aa3011126d2fbaa61aa301909e91614072ae054918ff40594d8cca4ac0b474257b9ee03b6dd68fc34a0e076c0705fc41a843d8fe37d96fe6610eca9b9d6b58fd6419061d2542743af9ae9b691039b230f0befd060d502f19676422a9b47ad19c8a6db0b474cd273792b62ba3346bd34f70d5c833a1577a5283c0c7c725fd7daa41e237f5664ce921aa3ed5682a9cd0b336f1f9a8670d79440581d730072a9b600cc6a6488d1c37131b87d686f1f88a260383384cb3bceb71f74f9f3c0c38e5941359541c40b5f242c58879e10af645786ed469ef5b0cc56258125bda7314569720b64dab8683d4e6497d01674874ca90daefc16a45098eff0a72354e96613229791343a794bb48e14b78898fdeb323b66ec99bbacca7aef40328b94916a778af3664c0e782cca5dfd8be4675b657a1c17a286cd9e1fc1a621da0f5424cec960a460e528200d273ca86d0e94bad11fbd5d0a554f8ee11b35fdad4329efcda55ee4a56a5bd65df6f80da8f00b9c093209279f1f2aa071e8fd265391e3ee10cb9ce0253ca0e412777845d4811674345ccec7e8c3e619920c0c90eeb0b1e50ee3fcceca963edf301fc15d446b2f6085a6bffc42a04c8a5df3373f5ab164f5a7250ee28b373a97163a69afa88b9ffb29b58382575caf1e6834d0db6610a6b46be2de510dbdb6c36c651cd8a13112bbbb2508b5ee0a1a3800db3a175a3c25d5d5436ae1e3f2e506614fa075cd0c8389de1129d2c712281279306e2c139b25690b15503ec57521127d273e35a291ea5e0fe392dd61578f14f4987df9e7acce5185e129105b92aadcb1621bdacc0ddb3d7042537509c5ed8a160e292b5613f95f76be3c5ad34bb63da8f0b88af7820660c9156c25fb6c3e888c15644c3c4b64e38195cea0bd8ff00369528596e031c00902ff0646a7341bb8f57003271f9ad64cd5b057d55822c292a4157ea728a59c09abb7f90a491e4fda9389861156129ab1fe123653835922e053d8605576e18961933bb3891074815a630fbd87765acab425dd29fba9beff5c145674fde9a5b96f1538bcce2e4382b11ae2b9252acb7d1c244da5e9450432b8813d356ffb46da67969dd776e442cbbe77b18c26110b58e1f7c5b7a0eb25e107859bab5e679e07452dfba1bab30ce83473f7a8b74c2c4cd1142763b07c086698e28410aa32f232a6d396707b40fa67722f808ba6043f18fce0321fe2e1062718d355d2891bfdc1f6cc99c0dee2ec08f9a35030f34f204edb7bc915bf5f46b06cf994045676ccd224a95940cbc4e085ee0559e22f6397dd5badc1dc0d9011d4dee789f3e4dbd06a40893db84fcf06c8f50362b708ef2cc17c9a4a396d1e4bec10fbfe10a83d639df4597e0cf86600b2af8c55282782590e69b7142a2038489881e018045a9b0122db6d053d5f4e57a1c1b0a6bde934fcbb7029019f972b43788937e82e4ffe0e1a6a10394bc0995fa024c0db66f59628838c750f6a92b6bddbf1982cad0ef62e6992adf87e56bcba71d54ce31c3b16eba2a29d93d86698287f468acce676a50e1caacec5ac83c64cbdb6a36ec5709a03de811a61639c6ff54f3c77a8b09328668c6654900410cfb7e38209c426fae009e33e3f77cc476473e12b0baf5670e056567fc934ca7469df89042fb484de93f9a73ef4f83a405e25d250384e5231f3d896862813bf9228e6b039c90a561a921b40e3ae7e8b88637b45e67892666365ecabdc1e741b3b9038b5279f94c16cf7de1ae4c238e23e6c1e18fa6d8fee19b11cac5e9280dd98f0b81b27394063c6d4da9cef3b4f0cc34e1583b34360da6a226b08e8c14384635cd9cbaa107b33f40bcc25e04dd6e3f852cc1e2f5dfff98eab83bb6ddbc8967d195d6ebca0ce31b0e4f74ebd0676d8ce6b27b9ba76836443f0f99c91f8161491f9cdae8fa62800a6c5e42d36594ad3307d70a665d61a32f5d9e64504290733b9eeb0d1518711ca965f69b3255f828f70aaf201bd91be344fb9d61659ffc4c0ae680e1f7717c205e46ac0701a727539393515a947f3a50bee16fa879d358ca2e48b528ae019e6b403c53156c0d2b6d625ade1ef5059beabe46e12ef9366bda32e3849a19e8c82f02ee5efffc383cf13b9c69bd089d1bd0f33df0e4582b6606b656353e31ff75801dd4e217871bced6d4dc8ed58a9bc8585ff09599bb8b3fc19376481f753904bbf0ee6ebf6fcadb8186e13926a1fc7933b62e128fc514bbf13ccdf8b5e78dd04c881798893b61c7d8542240992dd10713f785d33092f2f2976eba2574125f0161c7b0232a3079a72ef1a4e635f37979666ff4f188a5260d3e3900b644b47f4312e498018c1be99e458a7351e43d123d19967ec1168800674b2d82558443b71427b0de44c4e26674277f443a840671c05151c12391ea5667558ebf53669a59108dbcaa3d27945122f414f8ff630b14c8daeaff0fbb672bf7e2390d46e8a90080a13f0a0432d07b2929c8bcc43846d817a255614342e78d450a06c26424240f26fd4420034546ba31edf0ad8cb2fed4df1dadb090c10abe0e872815029741e3a55e43c483cb3918aee6dfe71f4a4a6c87df858adb92ee43fc3b506a01e68d48f5175bcedf0350959870ecf108efeb63eb1e6daf20e7f4a96caf2b9c5531a16a7e231ecc96c8b12365d10532314355ffd07e8eee6cfca5360b3702ec83c74d9c601860c038b9899b358bab4ebaaac667b7f793cb5cc1cc6f59be0d9707d3a13f599b8083377d06748de12374bb8b4efc9e4f81a1686454a7356ec6b7bdab1902b482be115a7ad21f3eb4352578e3cd03253e171a06dfccf03a9c0c4bba5e3da42338b5820880e2d9a6e99d186e577a87601e17cf9043951ad77ba242a0369e54620061ef95f582cfc21d277d9b83b98a696e9fbf86d8bf640be8e8b124e34eda8c44295790943821e5a1660ec08c733127bb829ea880a1d1c24b1e19235c046b34e4618801eea88cbefb3eb9a849a43dd16484d98f35961331a73229bf009cc78f3882b5e7790b513b2760e761758bf6fb4d0bfa7e7090035cbd40c948f2cc0dde68cc0538ed51f1c772ba3c07c3ab46fe8804c8bc54c253b4408e6f803f80ac07d11284630ba239d0e9431b81058eddf53db7778f268c106f63605ce5b817728f6da77fc3d54b8a55ca7db53a0ffc0dedeedef5abd331fe0d7e2282daee5bc72e1bb691d73777fcae142388b0e9557a8fd8d1912929507b5540e635c599a75bcad636298ff2e5c0a81bcff6f6b6d40efd52490ef5253cf853fe1dc4a243c115455ba1166ae8b7ab532e515f668f41c2cc603c511f72d83101ff95c637ee909e484cfd8d393e0432546e9a8842e3bbc5df02512dc50bf947bdf02e83a8c8f6ef16adb04246e103a825e8914fdf6e3ad12642e02ef16ca09e962f88f1cc79fbfcf90bac0ef69f4e4a701490d876dd9983964079ef1d9a20943cd1097c70c66dfe5dca8ddb652dbdc23caa123be252cb846dddc43dcc1d0fac67ac84667aebcb11d97832ac01e96853af3e4cf65b520f16a2b8c8ce1457a53222d56f30cac8a8a0c0dda87454294c54bd84d994bae7682878b1c21c3a795d151c275a70d709a06d079a800f7fb4de90cacc61f69773aa267b904345f3958762f3b1bdc5c6fd09b00143e5655fba6ec858ec69e81886c90285b86b463840b9aa292cdb3e2d8ab7be8135aee8830e9437b41f06384b560c070977d0f3e36763099029915aa9ca6352923bdbc80b44cd447d3f9744d37df019d15d601271a56751166be5d69005cf8b064e54805c6cb1c51cee76075c5edecb7a17859f33df850053431d853bd09a95c60620f3359b6d40f67470319a28d60d65f8d1ed65603e6a18c741294fe2e39856c8387e9d9ff73f72a9c4253d44c1e4e8cf53a1d1f41878653d456e7ba351d4d9a2078a8c0bf11c241c96cce661e6a63ecee733f1c194a7bb0b4e9cdb3a33217be15a04f2becdb9351ca621676c76cd4763cf118ba64c4b1871cd12cbe60f23b1ee8e778e13945654f5f4592644cf31b20d9f5dace5302333a5458c4da600d3040445a6468f2f78a2fb4ba064049e6a3d9a5cd7a84cb407d0044786397c574c3906f2d0d9674beb46a4a51259080527981e1a57d2209d2046c37ef183adac69dc3a83abd693841cd5b7ab0cb3a121eee2f7136da1ba80f9ef4d70872195d21692ba6c98065c4dbe46faa68d140860c524f11d32441b52f7f761de28318c48670f5973b8cd1179d091bdff17264831662dd1c5321f45b8bd9d89a2b37395ead56e98dde206431ca5c42a3780511023eeac414e9d3652f41efc002f98ad153362c14a32661c0b44fab0ced94608002d281add83448304b504600562ea3397614a442f8cd8b2d2cacda6e84cebd23eb697806d1f9a36db039755e2a0897a515f708f6468dc69d8ac407a66b2fb740722ecda932187914a3a2fa8cfdacf6118c1c563f52b8646edaa838dad851ae3e70bca749fa53147012026606c4fc45e796914d05bb4379a48719fc0554ddf85ff7d8b2f0798b0931d9b3e72d5460af98bacf765edc6f85edd8e292af36473e9ef0275e4423726eae46948243a9b9d860a446a848bbca6116cbe82861bc27bfc038946deb26ca8639fa99526b65c651443fb35629844f6213430f632d751d3b8c09ca4e76b4687e531b03ee3899cafbd7d33eee70612e5f5d5a3b688f1a160d3dfa413dd6b106fcf1152639fa94595a5592154abc563ff7cacb08c453ef5ff0075f2d50a2e3f6558963f67526ff0af15c577595053249010e65066aacffe458dd4666dc938d984931a5ee0fdc028470694f7dacc39e16945e8db1a74a8d73469449709d4748596bb39b4fcbccc96f3faa0e41c8129c0aa4e8d75650c25e45ff1fcba6d39c9f063155d9c298a691bb4137ae7f7f0a614e093562e93a219da891c5e19b274d809c530b305d0bd77eeb190dcf2a458fbd2718e218b9ef6aefe50b8c8914de5e36d0e52d9e860faa62aab0bbb63372640d449e8b12dd52bead8fdbadad25cd1beb397b8e2bf904d147a5564ec34e7da2c79f59f1bf339f3b59ac58e8f2d6fd218cb61c3271d38fa270acc50ee96bed2a74df411aa7ce755447b4fc6484da56a3452445fa06b8243157f2dd8ad72a57c81e6571d28931c059ebdcaf55f5c93e69fda94cefbbe873e1285852b22b98a611abbfda4e5edc0522a6968bce56217298b65017f2e92889a48d43fee07c1fd987310e13c320ff5071c392c73eb07e08801d933d4024f7ebd6e64b1b77b5df1cda362a33724d1457e5551e8dc6747efaf98100e4962e1e056dbedfd0d317b4c00a14c446afbc02222d3787ebcc460df9c9340910e5847013dde942f1f6e538c13b9fb9a623ab20e77d3918d81c86c7204cf9c1480d4e24bf531771bf0f22ef74b1914693b0ab87cb7124d2b054924e6911b676bd762aec7d49b4ad4a19d6e09c97bb7ea3b7030ca246aea79030b16bb628c7b18775e5ac30244f4ddd2ac25b980cedf3b28425f72dccf555d366ef3238ab93ce317f4b6f31ca26672c8f2c6dbac9f6d56ce464df9c1c4b2d7a9b12f66b32c9b6e4f19dd60713beea93b4ea3e0a946775f7ea93ce3a96dbce8b0d6ce200457c51e275d7d3bc5233aaac4b875c37647f20819907f4cb9c1516ead30c920967b861fcfff1c5ae206750f6ad36b2b6757e64f56c5cf27e79e059dd50824024283f160e8e2a22247ee72bdc5e00a9488781641cb25fc62cf42cb24c24e1ff54e1dd982932170995faab31333f2d48146a9369a882d08bed3e831c12f50cde96604e6d83b1d179ab04afdaa56e852064125b99814b9268df2e9b8008de123e0a8cf5b5e9742246f4657d556abfaef4ea1115f33340fda2824dd4ad953df46f1eb090f8377521e6bdd5906010d1aa0aa9f368ec8c4b234aa8598d40a9c3d8d5ab61992de309083cd98f4fdf9136e3c08f82d78b45c03a4a264722f1bb0a3bc5f487fddb1a468725975902072238ae893ec28e2007707c03b9a31600597d490fc398ac994521c0c8a6b8e7020e98cb6d0a7b984e5a18724ae41d09d5ec8dbec58e0646a8e5da8d835672b81105a7521d1d14706656a4c5ea41494036ca867d8bc6fc153e4b0655ff658677bc9d4041d05602382f3628e3c36726e736b9814ec7f00fa559c95a7838738eabb2e42060f6e391d912940b7edc0aa69dbb0f17b3d3b81d1cc0a7d700a5a840701b1706061d17140e4e42e406b5e0032b5eba9b6043a5c8df3d51df46df94696fe545f5d4d33521b279ca396b6eda74d219ace6a5f6364b0402e32a402de3e8d3333569f9068b5a3d7155ee49b3e6053709c80d9d8e9fb3e1be61caba138e4340947aeacf08da264e54f7d4ba936bba4455faca5d0e7f83e522f7ddca9f22a913e9f3f9ec4e0c2bff4b67f9e9c4c75686905c0e1c34b8bd26a9f74c86867ef186354fa455cf45fd06be79b53db8d37baee71255fac0194b7adf2361c1c0ec630e5d4dbc68e3b31e889b1b91b3e92b83c1d63a9cfcd12ddc843b841cec6f8bbffa5d06828c74a10dffcc66de1a99a88670bea7c6cbc975809d614ee1df04fd6cdb033aa74ddb43410c15749a2e2632776a669a430ae12a548b7c78cb4f8b456793b0fb58c8fae55178302fbbd475b6349ec8517edc9417255e030269d9d2c9815dc94070f2e88f08f0d9a529894fbce84dd478e3b54d79c79974e9cd3758a6705bdda7a03dbb13662f790c85d973ba937b5a8390d0d744b382b44f0c40aed5e2bc37aaef5efe90cbd2bf1557065328e429cbac0eebf9de44e2bed1a8e4e8d7807c7cfc5aa32107c3c0f07fce21146804f1cd94627b745a8d872bd80c6f0e03edbdcd20df3f07fdb8f49e8f7c57b6f6f085ed4383cdb6e8663d9cbe20d947c67f77cf089f4ba59c92026bb2b1e8fd3efa8e578b681a7ccdfbe5ef14fc6a1e173d6290f804bb776c37773d15d5190068cea254b7ab20e90bda3b2c467149d3fc344b3a15730e097dbe811ffc52405ca62d1a16431210988f99a2d4cc243c71a5c821392647aa10dbd28daf1ff4b3c403b32422f075f9cd5ae2837e347d87c7ebdd83a9863ad04f143a90dbca4b5f12af563ac8253bc7afe8f90e9079e42cebcdde34a08193370c428835dc315846ca8b3bfaa2e159fcabf4cca0374d79cbdefc007d287223c72f2b4b1da62a42d863c1b314e9f6f2a034c27943d1cf4ec22115231a27d7f5f8509e5a5d325cbc66ee4f56d7fb5eb4a3d64411f8285caf19aeda188a00feefadd341bd8b2b05bf76e4aa967d811ed183652503bfba4c3a9c1aa1f63f63a4a7c6526e1084ef573dadba0c3c87960c2dda688e903cae183990e0de85659f0fe5cffb8ab4d35347b313a7615a77a9fc2c4afc09fd8e7eaf3828ceaff1c2909f79ec1a9677ac1d0943e753d2f65b667d3c990b459ea20f4e53493c5c46f1dcbfeff6559c6f800aeb0d558a88c6ee8da6917e5511b71795075590e5df26573d49a55740f130a5cf3817d94d8d12dc4da7b9d36fec668cefd92c44fc833bdbd6583cd0d6a4c77e6b36d9c42c309085770e278b9aab24bb122fb62d3a336255dfbf8a70bcc5806b0a3bf3a1cf319247264da6e65cec861e2ca825eac88bc0a7ab2cd0f17a1905befae99318e73878005b9599604988a3e75ec19a9003c0ae3067db54f014ea188b082603b4c960e16ffa6f801a84849fb538a82a69370b8fedc5c03438acc051da5d565a3a60e3d4644772cc049241de93bf8473065075f7a7c03a7f1b02ef2a5d0dce311ed04d9d53ce43df36d59ac48ec3fa5f7b829bffcce6dbba538fd8d0658c3f264b6dcbed72581fd49de3f2ae51bf1daf89b0421ea56ea0208db7e08c380990c76e040d3e92101222f09a177d9b103713dd4241431e6759a971f7f40446fffdfffb9f4a9ecd372273e3bdea7ace55549d728f7ff2ac4a5d82230dd984c825eb62bd3f2d128434adc56917ef3f7aceb1d04d171f776c31990842e9ab7a6f03ab75c1aa96f38db89afd9884fff802c560f2c179c91fcb395d09e1a27e53107e9104539a9580286fc2236d77a3270877a893fc18542bf996757e4004c57f33f941cfce28d454d133a94bb52f14823a3cf17a074eddab29ca6aa295519dee7e699fb44cbd6914483e11cf5bacbbe94311ece63f25779762058255ef9bc7555f9398f85459dabebf3307156c0aab208ded6ee06efd7be100b28ea6fb5b9d12cf3527a3839c750dfd305664436755baea22524f394740cb8533ddaff018d87957278a4a5dc081e21869e23931ffd21db928ac610385d7ba9cc241e45a636cf8df53224fce5745f2844fbef18efb52258e804ce9c374c65555953806bc59f45e9ba571660245e7eafad95774e6a4a51f3016a6dbd1e415c434c5c98176951eead4e146feaab22297a07eaa3d6d736304ed9189c7f46fa9924f5bd95989b9a58e4f113f131deb5d9edf0b54c789e1d0a6f9d6df1bcc7b7e8061aa3f1f794bcc33ffa37d8d3c50a7510fe855e03b4756e72f27a60b36aeb7b4baa320f82e3d9db3bc02cdbff3dc7217ed5f5ce00f151127d2c7c821a1cd6b0ae3872be213d754bd0bc29c971522bcf32a759311a9908d219d2f20edea203dca9d321c9fbcb6b4cff2b073230a78f61fbae999b53b62c1c51fe52f187a6ddc58ea6db6ee38463f3284b0f5b47b4f9f18a49ce55441918d40e5f6eac0e2278fe31a4157230c597c0fca7a46e9743beff91ef6951d1f24ebf2fa78c4dd2d40acde03daaaffe45fa762d2b7ac8f27183f6b910a0639608eee7a3f88211825bd885effeb0e815ac6a6e42c50be6a7a73d26474c6d7fe2fa2a65860b9c7729cef01f8c4f8b851c5e00062d0b3447604c4f586ef99ad7b6880d24849b147f57f166b955d7d3b11fded785e22e106b2627ccfff23f7282995452bb572817c51f6d352dc0ad44750636fa95ebb26c3122fdb5d0c40847d8d4230c82d36bce0cc638ccded40e0fc5203f95439b92b72fa23be7d1a597d6124296971bb637434787fcd1c328d56c2c1a27a6c73202f9a6d00cb1f6fb6dcd1f84af148d328ff5244f9f3530d9471cc18bad7897c291dad690e97efd3441a337aa18a4eb393cebfbf134f721b24e3d66b7a1680d1b2cae18451a478d619758170d4ff31eeb2d8f64c7c33064b96c70cc3e758d7b7cee921ef69aac5c5409b493e68a3007f5c788b3ee523e5df88bcdd8c10cc2e58f3a3ab3d7089a2a386be4fd8783d1e063e4768f962f051aaa416aa62f9d802c9530aa881ae4214dba9aa89077f91adfa1b110158325fe061f7d311a3a53e53358438fd792501c53a6c1571c131cd9caddffda0040dff86039e3201ffa22bbdf67241e1ffad239b98943a685559be9a84c99ddd39b86787cce79359cbbbb86b0b9e802eec9cbac06b1e2444888d1d25a90730ead13b333d182c2e91591f756113c16e2ed936173c83ff504ef4839be3630310af05bf4429d357606909e7008c7c0306c74deba8a1eaa0f0692bfb7b25c4feb28d06ef9ca256b2b7e31ff84fd69881ae12ebbd3bd447d10eecd307bd2c455094ac710dfb3cca02c261bbcc56c6d45977a817ea42fc033865682986a70fdcab64e4f4965ad6da758be4452d5215084affe39fb5f6e2f6f67b7aeb57829e67cf320d822b8fab589eb52a73ebb40ed446fd28ea6251e3259f15bc326562ae9c8f90485ceec1d99202567409623f9b727af332a787a1365919b2c347d7eaa7a607ae449e4b2f365da07f9df66b302923bb70c3a4ec492551ac99c29b79df8474b96214d1288daa2a20093b723e0f829384c9ce193d997843174780697683fd547e7e12d9def0780865f204c63e8eb19c6604f774693bde1949292abdae59326942861134141f4b27d5b8b85ff1fed7760fe63d763164fb80273c5135632af1dd001cc2e2ef6eda1c69921e6f81ac5f7fbc72b703b7b7391eba185d98c24444e580a3347e5373894428f12f3b9f70c78b2a78ad646ddc3642bbaade31d2157a2af2dda024a7746e048a0fd10fe0f40de4aabdd6fb6d6eacf3e57199e8997edec88ce034b54fc0c74023f6816917d1e5612d7ce1afedd80dbd2141f93dbdeb6c74a3b902a2bdea212d066a6b343ce73377493f9a8e1eae34dc0d1c98bcc7593138ec27782dd0c18cd0e3fc9bf53355a2f4824c8e89996cdee265905e1e86a1c5ced90fca0f2a2a4a34d5070b26b6c5cdd2ebbee5eb85f3fcdac383aaaeb14921bb63dcfffc887f38024a7171e6a9c38419f5cd46598672bd2d2d53085fdb1352f41701589c4e3ebb03c5b70139521c4bd02e19f37f311012d6d04cc52f74c0bd034b97729197b83478947bab38600ee26b184a152e0b326d02acd5f4af678daf6e2b17ecc059757bcedce0f49e06b86fbdd5c32fa9bd6f73a96b8f4550c027640418395a51658f87a1a7fd0e580e6f7a447d2807e4b5ce39e5b73a4ce4ab0ea642a349e9371c194f06d11a340c6c25cfb64abe59ab8d6643bd05c9ea1fed4b3a82f79454f1b4eaaa32b4d81e8e4534a99d336ee8833d09d94dc286b03750e9323128d8aa8732c7cba9e459816d9ccfe51f4eae441b311ffe5ea2780e419a651c6048b232e314bc1fcbea299c46d20443a441a54c6e255e8031df6b1515563c3ea5fdf7f371e6795429184ae8a3c01950638cf43f23ca5a73dbf6f95bb42ed2426a252b5a51d95589da190190d09cf64387d8fe75457648a4dfa612a0870b7c6da92e07e88d3f2efe9de3135484ce267da76243ef2f18f9ef97a54f5be6880bfced123279adbd955d3cacf3b4cde68c41617f9e6528167a12576e18d63a7c7e8c2008fbc4c487b7c3b4a3e511b9276ce49d37e54a8c7b1757bbcaf559b1ea20ab73b2e610266a0ca43d08b47a9612b2fea5a96e5c5b317cb6f3cf4766f2724244424e3161c52bce76ef888dd5f148787dc9a6773e9ddc9172152e8ce276e6b6f448b7ee290716d2535115eb761cee767255c21fc31d146bf3261f4ef84e3a4942efa714f31a35e6a69d254433cf10841bc16e1455fcfce9bfca3ea7763959d25d3309b4ae0e1aa891e79dbf1ae1f58ff5bb13b1391fd4ab20698e0e0bbc975ce47ef94874481110a5f322e80bbe76540cb23179c49f3887dd32766f4ee0b23b627abb2fd0462165a04c8ec1b81a819a9776cc401e2cf105ecc6a5e191b998b1d24cbe656436635530d40b4d84431708fef07d0f08aa0fe173dea23ed4382c730c48770cc3d980eba23756f1d5cf40cfa8bf7f556bf9a886e54504407077b530317e72356db60cc7615cbb282db23a734206c8f5444b75ae51d2919669f622d94dcdefcb4e4cbc8cbcea1236ae1323478daad3a235c81057ae2628418dfd31db613a381a5e7c27dbf8c83cc441955079d7c24f721a4439c5a57cf21b2175d76f78dffe94b8adb578a5d77fd24da5318dedf62a65bfdb44435748a345ece640dc30e3c3b1afc6bfd07e42224b00a2e72b358ef740d9b65b2f2ab2d1b05aac5802c8d49c1ea25b652a18250c441bec1570f26079e9becee7563a809e2631ba88b9438730eb9f11b59cd37ff84acf194cffcc0754a5d82d1a3bffb4b5da17b0bd3437a548b30fcbf2dcd55c43ec47a38e13ae8202ccc1a53a6184e006076fb5c32ddf4365782ed4e1a6090b06f3d5525f433854818b661f069b91ed448b56d8c0a51d56b40e83c305248993e19ab603729d92a7d7b94c98bfcce2f9bfb1481cc2c193f3ca9f14008d80e43d485407b37de1036b1bbe913aaf25861c97bb4f06197870d2a89e40ae167a812b280981d813a3cccd361dc859dd9126d9aa3154a228a6ec2be70af9dbee4d0c39f86d77ca0996e9eb25b3458a3ad6f2dcc87603097221fba7842ef45ccb6a192e78c592170283cdbf4a56a4aa140e355197e2bdec2c81a02d2d2f579fba37773b604b7bca3bba205f7044be3f75a79312a70490a4c48b7b3d64fe6ac6569d8224dd8c0bb5a17c09504962342cb50af13bb64cee8c12f8fc5da33dc5665ce31ceb655336cefdc87b933617b283763232207ee17afc57432572e4e4ffb49c980313b96cdb205678d841ef465e8e619ad363dbf515c8b3d374bb980a4ebc1b735a6c1f519592b86ec90e75a3fe378e272a84b9efa3d5de5c19cbfdb3f42be51beec776fdfd17c7fd60dac145412df12ea54a4449b8ae40dba9beac2eeb44e1ba3cb43da7d61644504ca72065f37be3af38afa55867dd91f8c9dae974f5d38e71e0741d3a463eb7d45586c8b21e054d60c4ec61c016f10c811c2529e48c26be0d6a90e4926ee14c7939cec70d761b87eb6a256d6c643340ee140062b5be65e17ee2fbb9e7d774c6ea1610e71731aac89e8e10e68638d15f7e1e04701f68797cdc77166c5aa5b2c6a5cd8a2079b329a4962c6f57ccb56f2f59a20e3e0f4e347a1a25a0f756c084da43c5617914677c1f3329a294d2429a030cdabe35234c0d25de11cfe8ea725ada31db26b915936982c958d3349e77bae1d9e692c2a97230f19aa9a724b7548220387d7e4e5050b77093af74c8d5999d75b0b44b6dd25c55f735dfa41025ecef946d3f952059a4531011895bdbda3a7568ceb9430846c5e81223d23d4d3857cf3cd9d8b08d6da95e91b74bcd5af4bcd7d75fcbd6dbe9d48e175d612c5b795fbbd61b399d9ff294c819bae1d3a5d1703fa5abef8ce35b0a67c392a6f40800c4c48bface63c7e36bda792d5e0263b1d567473d21314ba4404478630f79da649eb225433cfd1b2f7c86add6cbb453cfc18acef7cb730babf7fe4e2dd7244813166f1cc8d1610404a1ee119a3583650ad0899f2ff680eff7adfe89f1cce6edc6437f358e61a7d0439267575bea7f78325b9fc00c381e9967c945a44a179218a2f1f369acf3180b28da1f67d68941c2f75b4fde8320fb1116461c828e0f4a05ede4ea244ff1d294292f3852c74612018d39dfb297a074b486a24e291144c691c24d3e93b56a6282df57663c27f4158a2ea30dcd73218f81c418a6fad3e841ad74e7db4978c97a6c48428f23c33b6d2925539f7e1831ccc90f66920d2444844d9108f3e37b939243d0e47774fe90e2dbef8d0248fe6c7da045a1b1eeeb94b0a24506656de82bbaf843a1f632f6d1ba43484ba37f8eaff738f91463de9eb60e208baf5aa6f3fc2e8f2de57d1e0a9a109da60cec8eb543ab969919364c0896c3c32b5a3941c8f9874d64eab2dc24e8ecf00e8237da8e578f8865e2faf92f4125d4bcfbd99cdfdff0b6b282514ced15fd738dd2ca4bca241d582282386e4cadf9dcd1a0badd35ba0156f0c0e46252813542cc1bc448c712494530e2d033ecf1f71b41d6eba4d0fed0379bec1bf590ac61e5066e7e526e07cbd1cae654771418c10f97f8ecb0d0ffdc3594ccd2cba0aa4afbf267c4ec4d2f9891d680a3e2f6b80117e6953e00bfcdfcc499dd15e309fe3608d42cc8de2d22c00cc53913ebf5d3160378c170772262f31aac43d349b3dd6ce492efc2ca813bb10326bfbc531758d15aa8d851a894abc1d98680597428bdf3f4b49c0a547188c5d0854ea3b256d2e6e1bf712df351f680848f6327a4f9181c0904dfe6574124e603b5a44f81ecb498b14a0cc1e5122645c77d65a2b652568beff81e451bb3a92f0c3050c3ce047026686de72e209eb124febfc5cac15a8ab3fd63d876f2d12b3f62a0bbfee8e6d47810cefbcd27ffd16d51389c822062acef4a0f375e259f490792c140ec340cbb5121de155bb8e2d63b9a20087404b162dd68908e9919663a8b0e882ec70bfde7bb9edd1673ff2b040a7de3461ae9fc13479cbcb7a82f44c2a239895d39d9a95868201eebd9ac44361a8cb1963e6afcd5b161e550c2a4c5cc01a5a75aa0a0d442413a169048281e0992af9ed681ecf630c3768b4f03d2eee081718745debc755cb017deed7819b4396572c9031ed9106c18b7b111fd42f00cffd1001776503d6ea321967998ae72024ff3a7cc9ab99c678fbd825d819c756585e8d3d618c26c4aace7d70d683e1ab2e049af1477eba075152e147bb2c8903d453530c66bf3aa47017328ccb15444bc439b62b9d40cf60c0ef8c7f3f050011981c9b94344fa68cd5c351a7b442aee0476d4ea9b08508c65fd19e0b82d776c07b346b075be537fbffd45fefc860bdacb824ecb4ccdb86ce3c9cac87fc1dad7bde00a596fa136f46ba31d6027e9e4cc63afdfeebaf910446de36272494f22dcd6a30d9f01f517083446b49e2f71972a72929f4c7826e48840c623aaab962ab4dd60f2559df4fc3fc57dc841cb0e85409f8308b94c2383c1edb87d845fddde45bb39f2e3932cf2c49fc735a9f54eb4bb64c5aaaf28cafb47253d03a357d164cf3e8fda167b543a37dc543a3a696dcb135ec064f528b51caff6235c19af602d80a363c82652a206e8d0e70c01a72a36d7ac4aad891f7755b22d677cbe8a750c913f5459a8054880802d3f37ec3f71061d1053a2a234407fc4c1f3d7829ca136eea2d60cb676ad207863c7d9a21a6c14c7efc9424efdf5c7f68515ad17f99c68295af1a11960d6861b93fcf2c8648fe8f6ab0fd999b3551e9bc4b3bbf399c4e01600400e3a4730e7a2e2ae1a13e5b6f1ab3896d0eb268b5c346fac5d1ea0dc10112b6748aa6f65f375d485f71e502b11abb88e6258d97172182c4883cb514c6f389385e064dc40c21775831c3198858244e2a802a9e288a86eeeef0ea1d6bfe8bd0174217a049d8f53a70c3eb35583308cd6f8d05ae4e143d1d6e13886af484a0320422a8c2d81c3daa05ea57d83557eb590c70381cdf30f5fe170ade0261ba7ca000aab09c21f95c50604ef4aa28a7785082aef0ac4b3e8f1812ac02db515cc7d800719b80e3ab4ca3e416c6e6cf19380e364e1f250d3e9e6446e445fa38a11f94aeb3d885d44693a392ff064a07e693d206bc8c260515c7cc7cab25ffc3f863ce5025b1381de20c9184edd43742b68e799c0a4b8ff2f4cb9705d9c79a7b74324d78fff6162d565bd63cdf8b0065726e473d62c155ceef3e4c02531ddbe85ed90db36d07e51833c97d5025f71bc93565bd8607c6de1f6758cc84b092475dd857cf8dce92d516fefa41611f71eec68e4224f7478c9d072c5a3b6aa7ce1ad6b0a7c618a90fef7bf91c616f26a67caca29779617e109fea35683dd790b66849a42b088ad55cb1c34860ee75f957110222c23383bba099a1d68827be87e3d3a60bbcb025dbed23fb2f20e99194e8d932db84263f731fea8f584d2d371257b25bb73476c4762696111f0880b09e829d2348536cbb60ab674572e77a2e89b38bd7225adeec8b4374f722c17c966d7264a6dad88346bd98dd6f54e082246596c3f693254a58b47b50cd52773f6301665b4e304c97a03ef5019d43b0e2d50305fc05a4105c61b97c26462174082b5e38e366eb3c4d368c429ef5df5d66cf2eccfd86e76684f19b52a522b6847781fa385552e7df0d997fff786b7e83882aad507abc1e8b1f5db5610b06d0d51a50887ea995f1bd778bf5a4b329931a1942e73835944e6971d2ffe5910fbdf7488ed43ec92449065e0b4f990faa4bd25793c6bc0711097a315de835dcae78af657febc6a2384a29a9a087bca2e3f59d6066887410a6e11143dfba591ad626dda00267ffa9a0ddbf121f52f9b1e57df99a634c1b480a117d87bc19c5cee37ce018ca3f59a2826d32cd0b400c8a1d4b47355e16370d9bb28990498c32acb72c813a7492dc0068cb250ba77ae479c2ef1642323b4b402795e4d944964d3dbe1d34925fb1daa56c503d2da106fd79c371d5d493418e877a62143cba8349ed798eb4f06536d17d9cc1b90ad6d3596bb7340773e1b98ce1cda11821b820e2cfa2373058653f0be5582e4ac719c15e793dc636434dd8019da078cfb7632f0d4e9595d0b2b1d808718c3243b0c1f929b2d1d04b64e1cfc9a6f120977d2f932527f042e6bf21d931f60c4d96a72a701fb3c23a44e04bc44cb99e046462c1870cc56bab6c532e7d61051bdefd32f4a4edb702c69ddb7352f66fa8601e47e74beedd4bf845869530d7a30b1bf46b3c5dda0101f5f90d16e41ff375dbd8470ea12a2b2a2ce9ff083069335bee0767a9355817b79f8e1432d47bede2ce9eef200f6061b4e5bc60f146b476fe19c6c8d10ead4f964e37e576db0ef96e78294a007731f7ebe10066445fa8bfe4fc1af966728ba70bd8d653ce85b7be7fad42de8cbe57654a5191415648a8f303b9e34f4849e7e75ae5dfd347ffcaddd1d2dba6467839bc68d0f49bd7cfbbbbcf2ed333047773126009a3684b743de55e4678222007746680a92a372a975e7f24689d9a5027c4cc013bebe264db7cc33d9ac43c094910497e653d9e39aac2bbda2eb85126eefcac61f386a20a5861dbf9b52a45414b83a4e262e4f39b7d7f54e6de998dd3f01d63bf55dafe470dcebd3ee10e4e1ff3a80e12d4fc35f040887954f277b1cb1231efb15b9bdaa739f5fadae762543a2126153ab9a2a70d5026797d16db893704a7e548a62493b0714f7df0ed56f4aa9ef54be93d486912057d08c65b4de417618c9fd03e235e58ce1cd1426906537f4489ee987ff9e14cc3b5dacf2a9ccfdf1efe36621e85fa9d1c9e9ad3acd2c91b2c693ecd72c2c5e20f45524ee3b0aedd399face18618f316b8a18e52dade722228aeb35581e1e83df15606abd6f091e4306d8adde7769c6d6fcb75606736a6f424385f70b6ea1dee701f59dd0e79fa339bbf9833e88449ac2db89f641269a75685af2110c287ba4610220218bc811d2ee81e15d99de4bcffb0ec680f99e593944eb03b6375a43887a06ff95af7f64fcb10eda2820aed43562d575448366069da99c3ea619e9ca9c9026a22cda975aa6208713849f3e1502dd90a42e4983ec6eac510d5c031ff58cc718c384d814f0f6b7426fa6b9b99bf43f5ea55a09d09abb9519a9bef3d91902f7a890b5b04d06242528f821423210108ec8f78f9522daa1dfefd514d187eedc62b0ec5d211930035e31caa9d42039e708111af2f9b768e6715dc2a67f5d066060bc7c68f06710919ad6ef4e49cc64ba6602899f997ff0727811dd7c1ee756c8495a84b30dfc9cb166bcd2bb597ebaaf3c9c4c078d1ca0706e895277962957f304d74aa17eaa992138e85ebaa31df496d45e37c3c60832e937f65eb6a845a60910b04981a4cc48a032572167cb6906fbdf8728d64bb35a851558c92708c670db015c37961a192b5d14adeaa0d8ec29409f64af76d450da0a59dca2e48a57f2a2abfe5eb9c7479f14e99357207c98ab9740dd6e45e588eac2f23343cbb119b667907185cef6e3874e17249d5455e4f7ea53f436e0d49d04ad0758087a1ef8c4e7ded6cd19101d7ef6eac0703a4506a9b362f4b9e09f29828237672930c8ad3fad87c83a82e6eb070117104856eb89690c5f78d00d78a15735f0279dc298930c9ed4f31273efd97363a55f9921846e7ca1098f6f68866234912360ce96d27d0314943f79f6f24c1a824485919d1f6c0cc4fd9c22c38d1209dbfa93d20ae249c69934abd092781fa8a2a28211da28a84ac9e0e59d87b676116172c0b042f4570b40352a0a5e129541447c1a5ae697bdf90b6541cbbbe0885cbd3ab9ad890a1475faf687ad43ada140ff44fb8c9a2eb6bd48c522b0c9d80b172bdc91f6973b94d570176d6c9e172230d3ce48ceccd161c3bf71e522705b053e1c067ce3e92a87364158d5a7d7b958ae53639b80ca6e9b0078e916a995e7b663d13642848f38d146a35fa5f87e374a6a721ed92d8d48f332e1592ff363382ff359bd461bc8c23c0081299eef2bc5a23851fa3998abbf1f11ed6c265ec8c6d6bad857621e1acb46293de6aef46dcc86f6d17489b8798bf51f9398e720ffc502be9a5749e983020d05c4ec7393c5e00f070b428fd31a3017a94590135ac49688c1c216a79299d289a0cfa7d21d4b96992177c1a6a2187073054a71af9ebf846493ad24f41d9319b144b100e05038171648f4d85c70d8e5930abd04bb8dfa81adc4ed511ab5b27c432558481747240a797c13410136a1518b0061e73457c3a759b3a8cecaf981384450c4dec2da312139550290e222cf2f85113215ec4547bf673d28982120a0b845e15d267fe13ad70d879892f69270ee9863a0a2cf6159e7b249f99d3846071547716d65184bc836edc17d5bc8ffe8653507e86034d9ef29273e1603f6bdfdbc3e63b722ffef2a8ac5cca11ff00a618900437d5ae3deb0fec539910d895658805cf11beb5e46ce06be2908185b2840505c6ead3610524b944732091f14af3972c289dc69225a87a4c3a674e0faf79d8e01a4959b7a2dac0e03c7f3c1a33761a4ef0aaace5455791a5c382743fd144a83bf43239fe4e7a075bd2738451c8bf864981f64f246cc961e315388a9ff1c7487c110a8c407461cdc9f98935eb4b930647b6d26ec31136a994016cb8afb9100be663f300c764928c6d6f51e44e8e8ba245c0e15be87b6caa2f7f4bbd03331cc57bc109981fe19805a5c3117862988b0521d56f3086dfe8df0d65eb804df273e24c8726c90e51b2f9b38d3de7a148e6f1e71c80537293ad10ebd729e0fe2548af41f9355b5814acec40a49a844396f4d9f25b2a30329048fd89772dafeba39e19e6da61ca948075028576d7850fbc827c717d87fa0d6129c226df5632b8b478b4d2c2f2e6f242947ef738d618ad1405ecc625fb80b72a33c575f3e271f977a4ef2ed45f96aa47d0d443f2c7f26f1e0de8786d3b86b7d675367d559f8f703085496933a113b8ad7c729f692b2cbd68882f4c7e64e7a87a9eda73629f5f1ed1dd757e71c3f12633e4c18b8aeac01a72f2f1b145781778fe106f32193dc5aeb94c16792736decd3be5daa18e979e24594351a5dc97a563f11b2edf149ac6e3cb911ca2489254e2f9869c1848acefdfb98e043f728f20cb25cd668c1f6dfcbf01f51ad7db77cc7c397636a25d406fd3f2dda882990bf1b9a7f3b24be8771a0d15872eaafe610d2c22290c421f9b075449a8309a421cfb5e0c9cf77ef64812cf4dcc4158a32541b445d4d5ab0637c0b5e56436d91b1963055b3652c26ad3c95ad1875083f22d0c0bcbcd8b1ba1dccc9af4d7f6ae599d7e740596bb7bf713af626754b2077de67cdc8b2ddd4d8d738302026d816ee08824eb9c0d449fabea98a7b464d3c5f8010725f2f043e0e8b03e013d5b8e3315ae3a6d34b7fe9035f80ce79479757e3ae207b555f59b81a5dcdf8d747183216f067ff39e579d8b50de8984c09ff552557e46908bb4838166424295396ef6da3afda41f5906a8f0190ba17440959c616429badea6fccada44961f8f791ee1bdacff5592a67733308c351353c8769cdf64bfa989bceb1bf798fb8c393500cfc606e0477915c0de01af2bd4967088c946d47168e912f00fcb98cedf35d53711e5cc106c82d7756d2c85fd603c12ddd2f9223b0ec686691d3a9b332e3bdc9bddfb8eb35d7ebc391de77d1d10033a9d577c965d2db560533b789170ba96575d00ba9c1f15ac20d482dbab8d687d7d544a41e40ae5ff648e2ffc6083bdee3838ec36fb4e6c9e167d2f1daa22d6f09151c113c7c5531b6648dfdbe687d0c24bdbc1c2b10084ee98a6109f83a215ec3eef8f513e62f4b30a90d5c0f0a40f8a29e3c103381e5bfc820007f858b2e125354d17f82a6c9401522451b68540f9a075f7fe6193897de6440b8e7e99efcb15546e3fe93a37f14e7b310568473abb02cfab7dc7f7fab4c2b7ff71cf2035bdff9ab8d16c322088ab1f4e8a16d56fc7f9544734c7fb3c9c987ede90349631c7432fdafacd0a8dd55d63d406b65bf2b9e7897f463a7a20e96bc021a6758084fc9e892c56bb6d84c9f8dc36fa232338d2bcbc26200a16e548d4c2704723f6d2504a9fcec5e5934a2d4b212467a028a1ec9be8c7aedfbfe57e8b01ed4c3b88e1a6a00f07eb436634276c34619448d8d31742cbfd5aea84e5eee9b34b67c4b78a98a5a336b5b89128dbee7333564f0e66c7d8014acaaa0e8235ba88cea812844307f0496761ba894d977a4acd74915925241b658ddfe927a11415ede57472d9cb31f79521370edaa102b6e790247ec4ab6bc605d613e049d2a7fe5ddf2c3eacc4f822aef47177fbba4b80535838eeb7fe5312f7a67d2b4d64dabb15fa22781770c981a70e84f0059e992bf64da012413068fd69a77c90e7a1e4755f4a9d33e057911985b35c073b811b1c19fb2b2c8a8772b0ad145d6690f9ed7f944fa95df32a2aedcac1ee1b466288a694be4cc7651e066282e26a2d334c394ec669b12bd9b75b9d1bab4efbfa43917c279f05be3ca6185826d1941af2c0a66f05c3b1538e504a06ac2abdaa4f44822925058e03ab1e24c100dffd234422a9ab158a0d38f950e94bc2db948c727ed4ce0c6e4d6ee6bd6655b1155e75f89298fd7b8bcf1cd85a8332995ba66ca68d73d6ecdf45e8b123cef9ce17e4ac39a7ee23bec6ba5a9c893067f1a58bc43ac648a304ba0e791df4da334d4f3cf260f3b5ec2a6a546b92d51e3486a2e910e73ba92d4274aceb84ed9e3395b9f9264c32dae9fb25195b1b03ae127d557ab85ffe14db4b20fec88029d57d58ba1efbc5212d41b0605401e3df7dacc2f0861170809ba7e3282e5b57615e60ab07fd1a51f6909adf5820360f9dee9817c138af9fc0c302a5a9d1755b0467501f320478a2b23e3b30a0bcd16cb881ff1ceefc2c7f5561f52225c0af7206e1b787c4854f5ee8971f64ff3dbaf3d01176194f3a801e2146c7fb31bfa3edbed7ae0648d6ee9fbc0a9ab656e1d150b02046d2c4f28fdfee33fbe6c94b301ac931224fce6ffae8ffc3b4927a3ffa6ebc9f9c6d377a93f0cff7b3de081b7a2b05e2675f5341ce6f8436671e3869206e0904addb3738b61f03fed5beb23c13f57dd3bd2b8ec0829e1731bdeeb3ae1483396b9fd4dee8c8982da97c4ee0e826bc4ebde4faa2c53f3182d73437be178e419f78a146c8517923b0663269b33e929d0e997cfddafce1fe279030cd33eb8f0be9891b18e0201288e2dbe9260cdba7174f88b22542d878889ddb98764d5b7b46360c1f36bf282b2bb0d52e3bd358b19bef8ebab4f3f523649e97220cc1da4912e2d5e8bf0d621ecdcb526c968c9b3f92654a6a58f6b7aa6bc261a87d0fa0492e152d2ca6efdf07a2772d47ae7409a19fe0331c31eb80b2a18e36a9898207de7a2106456a39ac81459d4e7b2961fa721428dbdf6da401ada207974eb1c3553a74a14f3b0883d6ece77f1da72ebb535c5760b289c6eb308968128246e9a3a330354df3c6af053577fc5ae9a0a59bd9113d683e5f443263c39dab9839c12df67619f16d8195489ee0dea82c33ff071d01907ef9b058aac8277517dd9522598bb0da9a7b1ba99a87bffc8cc49ddb447ac4a351da5369bbb2152f7d36eb61da3e0bcd89efedb99435d713442c6ca929aa9f1560dbc030fb005ab28b7a640aeb01576526a83ccf18c67be6d9b359703b5df4e32eb5087e5ae4b63218b9a465ea6c57d38ec05f1dcf400c280def2dfb5cd63c9be14fed0fce4a105956e1be43ed4c56cae0dbe68cb6224e2d2dff5f14d6dac150b659c7296762299d2b74b36dc161e42fdc561f23c55ee247e4b377d8f4d3c9b1208031d0a1883f70811dd176a7242d1fff849408b3101e1f4c45b0932df1d456b50445cc116085dac343c009c45cc01bf4d46a0eb6f89f0ef0eeb63b88d43b84bdf1cdbeca18655812e6b74dc488797aab12578680ac8c0fd917e55af8a2c583985ed1894de9b037aea84b622030c2c7bbaf56c1ef84c6822f95f944eafbe2e0897e2957c4a6590b4cabaedd36f63bd4b6e69e02ca698cdbee96ba93894b6a543f797cd9da0737192f22ff5b66544cd448c95245136340a8bd21ab7a3473195b05958f8ad94b6f965f012374563b883849a41ccadae69b0421557baa0672df622ea8d170e7a07ff8fee908647ddfe6ed7c9dae3052e4add2e84da81fc697846a76c4d47887f52d98d5ce86e43f86b50b004bf5caf13293276e25f48d3ca3f366cb46756010ff6e8c637c58f549dcaa0dae717c69d1346bc363e7d26d27a080eda5a43b85d5cc3b1ae1dde5e693f3d5c65b355edf42d0bca07e9a078d3372ec9d9a51084d27f96a858cb163cadb47928f0c3262e22efbc869c86ef290aeead2178e45032b59099d2fbfe08f80a6ebcefe318f35465cc993b08accd8fa08139cd4103aa06347c935219804dfa9b03a70b913e79b2dc3231d87f1f5c20ecc085df1513179e99b36a78518c3a897a21d79a3f4f9a5ce9d76b3113772a59a3d0af1c685b6d354ae17233429d9b261370f1939029a9f31e5be8fd81bfefc9bca2fb06d5675c5666f0b39682778afe6b2c0bea51a966b8e2773fba0ce096bd569e6ccc6ab7c6e1f47d46e6d8211cc42ca7658b30a202b02f771e07d2a398677a469acea17625d910ad81576f1b15517668e807441c4b0b873fcfc86f6feb9be65d3c7a3e5820c6c96d6eaf857e227111169bfb6014073447b65d3b1197de2db30a02d10b3ca88a95561c913258138f8c7dbb6274739a6ff404294ea8b79fa21c5ccc2a1bd97adb28248588bf03cad19b7d6bc8d1fec385e5760406a62c1403f29247befd608b8d8687a67a38c284e102eec6b9bd731698f6d7ac53b7da3b9a967c898365f4fb396895060f5208d14f37318c2dc3eb7e623a517a44753aeff4b493facc4e9d36a12ea53fef54fca2115c05f9a2405cdca8281cec4370753ddf5385bfa2bd183b7019c78fd9a227872fe52928a496c956abb7103b59c6af250e113073ea628a2ce718aa7d9f1851407b37514ded823cdc138de3545e7d85e0af915ef3bbb7ff808da851073e05615e602cc42757b62a90b79110273e48694b2cdbeb6b95ec42cc3193c0642761d65343e6de38d4c098f1516a3630eea0ccbffce2e87537d79b9b0a0664f5a509af28501e2d33f7ae695bcfb29916511df8c033e103e6b0170db512cdf2f9ef8f129e51e78f0aa60115f28bac25ee22f23df6b8538d02171aacefef3a3c1d31aaf7933b09226e5ced7ff25bf1da012ac9bae70d5de28954868d72dae5c9ce1c3c63a2544a6db9278ebecb65737b3cb510e2164cfc1ae5afeec30f82cfa2296650f3ec903496332476f673dffc1b48c4c6209c15095c7cf163abae7009240e7a5a049eebd02d6eaf37b30dc6b94d63757bcf3b4232b06a67cf5eed36a5c04e592913070111dcfcc8bbb06df17334e2517931ba4ab9d99f44ea984187211f62c7d17912894b9953dfabfd723f1f59ef222580741bcd8e4a4e96c5a8ef02aba25bc22990da4ddbd02521c837bf52e81a67c930e9755cfe3544f01990ae9a08c3369074a51612ecd2cb0237df4bf385dc76ea9675fe02fe0704b38289efab24107c5d8d8b30f3b1c5d1d8e04598760a76e94c6553339a2051216190afc9472b4dfadd3f85b28a456ef1d3bab03d3d16f671019a1b2ddaeca69e0500fc67102d81e31b6bb5485317d819cd94e2846f53d755fa122ce1dcc42b3de7ef7917b70e70a72e3cf716df3d3c18b347ed8253c8ac0ab4b2f2217417904b32a9c6f7ac5fd8633866f30b1921a88dc56f7464d76e3eb8c7a21e567459b9c5487beeb875475b4600d83e1777a3e9646edd3d124d16707471577ef3673fbb3b27ef1f68d36e0fb6d9278e06b8476cd8f67447353426b2053266bb421f5c5ec9d3cdbb07d39b542dee79545b55282e30d5c774f02f10c12be109f03c8d5f2685adf4eeaf11324612f89cf01dc11be3d7bef93fc9dc93ddcfb63ee3ac63274a619c0d2351fe8b60dfeeda78fde310b4cda4fa5a7d755d6edace42222253d6706abdb2caee3ee277c4f9af62ee32290dbdc4f299ea9d66323363eec66ee60afbb77ded692b06c0c1b3b615009f8c6f1c8594c78871cf021badc81a0eaa212fe0b514993f83ddf9586a52edb954be0cd176f42b1b01cd0155123d740409effcbf09f4d0f29017cb557c735530387fcee468d0db82183b0474057a723a84a4a8b698edbaa86f00f757f2c611438baa2a221b5a74d546201e44bd77142f396785af43db4a4dce22c652ddfa099c5ebc0b402ef3164d099b94a89b85e26fb5b8884b95d96354972ee0080617a36a3cf672b2a7b993e20c119111ab1de0c6c410940afc09b866b0618b01c63754ae6340cc6ba9c076ddf4cb9b0f1369a54f68b93ef20ac9a0d07e772d2129b9e7f59366a98ffbe51748e589f78df0cfa42514c2bf32065ee9bcd4f29c02cafc975e4c005fef8ce29483a30516a613871c032a93ee8ea3b976264ed81056646f24229c2d25b67f63adb806629e677094fecb7205bad370663363505751b756d33b952f55c915c82336f86e34fc249d11963923ede020c18e5c86deadb734b5879febb72b305c96d39c670873e91491521b9b53f6e47a4e4f245b3339f55dee52385e90fd66e851cef5cc603892287f59fb8832adda2ba9127941f03ddb16f6093513aae29b59056eec2677d9cc7bf19473eb888ea0b01278cb14b64de17d7cb32d3348eb617f54dc37e389f281dc440b2ffc4ca885e1db573be13903e9152d8535aa7c617244f82c2ac416bdd10f2ee13701a3041355d76025e3bad642d692b81eb10eea12b8f614134ec0057a7136eaf3ce1bd94d8095f0ac9f237d2531da1bcc9404c71abc5df781f41a45a501e4fccf7efa40291aadb23d9a1689c799daa05442a7d2a7dff3d367e492092a8df27c52718cb1d927d3e1e1e7017a8373c188558a1f49d0c3b3795aa55c6c1660bbfb7328e17c77e6492514b0aa635cc6a17cf46d76cc1b6be75a583de304081623c8a7a88a54ad3a2b1e52fb0ef4f0c99d9513bee6a446156236bd55f7659c88007842025cc10ce0409e2bfe20b0f7972148a5dba632d7afff138e17aa28970e28cd9eef3ee5b58ef1453efefa10c635dc27d52d6e318f74e6e3394ffed8ef30925a4942d07fe39d7b23706e85917d4e6f96eee05ea6323cd9774b6d09e937db80e634b13c0d6b42a2b6c1132ab2a4675fbee6b3facc81b099abda2b1e554c3e4ce1906b1246122c1479f8b62328d0231a6eeb3302ed9df8c9d10b47982a8447665df5d92b94a26301b8038f1dbd712b2a210ee084045ba100a01f792607aad5b0674a13b39e8fc80027ffe4b5a1f10b6c5187c3110b2cfba6fe43dd93257d1b99391fa33c16987f7e442ddab316e6cd881fa220e0e28434d56baf07231dc70b869f48524c9c1b08c6a7fcc1b7f2bae733683557e53339cf7a9fc6a5af9478482957d8bf2497ea812998d71c19ec28351e30cb2bcb1b5a7367a62630107f794171d3eb631b04be94821e6273ebf2c00988d60315811b3a54af3062f1dde976d7d09b8e708f4e56caa2536b239f98d3f93d00dbeef46aa514d1ec8c7bb45fa37a158d345c3eba62999af29a9b9c8755a77c2a29e83d0f167e6ac98943433ec4542bf164fcd0af8e67268149a31b0306e62644457b4357f0f458994d1492f4a3e8515df546ec37f572fdf2ce57915fe49b5c73757abc358f436d719db1037d86061b8c3c812029414019fcd52956fd98b7c3dbbfb2d16b8211e2978e994d055e1c0c16e56d60305a24c4115ec82542c442915f712b0c9e936c85229d1a15fd5c3b028d3a2ad27cf05ac1389a8a2b8a00a2a91383c7a9a26f05ea16e33d91d883cd838afe0f2582274b962f5b2dd635c8a1788a236de08a804ccb355e29283251c9369cbd8d3635d655876b94663c952f96a201f53a670f6fa3677ce5e297838066549372b981a2f3e4a8a353d299e5348bf2094b07984b3632f57a6ed8adca0cbf5df5cb44a4e89b394840f224d75c7ff208121eb38445d7eac780a042036aed6e4c26a9ba050a1c0da2ea8d59a469caad448339307a699f261a1894b9e77c58f7f32bb7bc56bb9bc13bd3e8bed04dc57db512d8f14a717304e8654a083238f3c7fe0ebd59b2181784dc5ef6b53e47b8ec1d1a0749d884f55523d695f1186a92800fd20d85030d38f32058eef7e68cfdf945496ce6f332a644e6c2499442767bffc52a6e3e5e21b1aa82aab0901960bcd1f747b9fa340836516f1731cbf7ebca718cb40cd69b1d753d0e1f9b9e6707b6d1024a57594ea34f7974faebe65f9e6f472d2bb4ea049940fe91860e4d9287377bf6cd309b79e1ac8e98669b7727aa09a9d0af77577397c40a0870534568531865f898e98ceeeb4eefbe9e44e58b906d179c3cbd6487198615d0f9937e2bb2bf04d65e3e7f80b52b7bb6a2b78b5902656578bf52b7f1a04985b24dc832107f1cc92b1d3f9313732a64fad2602048268c569e393e05a744087f5a12425ce0ada7c3c8f5f6d7a086722caa4ddaff9a4290e41094b7c02918e1b68327fa1555b392cebdacfb9b95bf69f8a25c18142292a70e5da0954e8022e6a2e5368983c01e770afcbd2bc3b38133df79223f1247958dc69fad14e41cde0f5202f2f4146b258bbda8d691f7a1bc41f9b3b8dcf55308402a24274238dfe9c12e07b53724d8eacddba33a5b59a5eb508bdc57e178d0c21fa8cadecbad713428b561f4413325f4837ddd2f97fc8c78c5c1a89763cf17749af1d2b86151e1891f96b54318741702d158ad64684d75f172434230e072d781309382a2e1d60bf47025d79cd0a10530f6441cefd95a938b557aa8cc0692a043e16f49ef0da6bb47239bb221ccd31144bc1c874b7777156e16c6b6377e9249deb639404c798bf5c3919010073ab9ea46a044ea9591dd46f966aaf61d85ca4adfa47bd9e2cbacf5ec48a723eabf3671b8899063c1e13dc8a3fd592ae810bfffb70a0359faf40c7afe16f6e279e7f497c1ac930fae0409f0b2e15df8b948321d69cc341283971ef9e1ed166abe4de3965b46b6be86795c170e7805e2fc2339e7027ebd76baa8c045e5d4afd038dfcb4ba81c83e971f2106503589651139bb6860ab420b4f1f0c79c678e3252b5fed77c15fcdfe2b57deb28618c1bca6ffff4316db55faa562a627c9cc03e22a3c7276ccc53002fcaa31f8708032342f5e93aa178a5d1b1a4024218afc755266cb717ff0ce297a0cd035cd0e2eff7f6dd55ebf7aa7c772760d53f9d63387756f33359acd1238f0c8924abff79f0234742fee8d42793a521c0b1ebc0becdf9a85763065e25bb82b659b93ecaa9c4f4fe2f4377a53c1edc36e7375ddeb3ed15bc231be68a1f5d1ad9dce3238d97593fe233e8a52b80ac5c2bd8213d916925563af2b0df6bb8261d90d1a4e25e097fd5f7b3ab4cb6d97a69fd0dde49274861ab41d4531cdaa94834347cf10d8b218b577c336925caf0c78d3f001376a83ae98c08e10b6e2cd2d6822bdfc575036b468ca9c21a931f6745a4d7667da7897e85b3b76a5b11e38056942e1f335562ef9dbf8ca4e090c5a12ce350d7b4062126449beff20b3c479682dfb37c4034a6c7790d04cd68b2afb952f42d1836d6e9e8805647121c1c49905120393aa0f7fb06cc31e781cadaabe1d0be34ac8d3b2aa1e60a1eb136191e61f3cd5fcf6d41b02143ade2ffb253467751e15c6d334e92ac9a08553b39e441443643351e1490bb300780666df81f0883117d34bbbb49a3829b5334d23c7c4d8c3692d4005ee961679db5e10cae5a3b6e8e4a85c7063f423853dfc7c1884594ebfc8a9815c1452bcca5aceda6700e3209ec8d1e355b38c106b1fb96b49be6c1e1284202d1dbecda4604b2fb675b05c60a0f9b7f5b83fe63f215b0537fa012e8346104f6f6c9a0289c9c887126efd6b75622dc874952a4d3e6821d872d76be63c9d8c2a4c591ace6f60c791a7794d00368ea5de76061293954b4b0480d56fb30e8b56a52db1dbda40f5af7fffd3e3a963fcd30d140e743f7eeef0cd6089a74471061f962f37bf7c15b61c521cafb46683b29285ebf99c9e874ebbf778050e63c54c6814b5f4dbee512255c88c03a88b7ce25de1d75e99c2ee48198aaa4ad5e8873fbad57c91246e5ca02d534f4191e8dea493d899fc76203df9d9c8ea76937294bf872db1cc20754c7bffb3a577713f1836698c995450dd622d8dea7d4b5605c282cb191339d5dbc9de148b4ba9828ef4dc177b7c4bc6f02251185745846b6579dbf09d3cf390b5222cc39bdada6587dc401428fac9a38f3395fa4aff78cddbea021b89184bd4625fd97f768793d25a5217857a825a09320b474292ff705bf96f0eaed414e3c1294d056baa139df22c345932ac09068ca647c7d55b870b8ef8365f06eff6d93793e6ef6387edb8b33c9c5b66de11ba5c8a20c3384f200b9eb18f8fdd517bb0304b1ed7a318cd5b0919cfd4ef5534a914410059dd345c47750d803b9d267b11086f9c04af385ea0b35ca3b3ddd78a6e5cc7f5c12b9d9a0fa9deb3ac50a833038b56057d2acd5fad15fc66c5cf94fd8f30b02b098434a484398345caf04b8ae5fd3a98fcda5c0f1dc59f136b78d4d787244e91f2e73eaff734dfd43215b85e72336d4bf97476a8c8822a4b474572c78d1aa08de6b589484ab6878a450dc31a76c233fb744c0389ee2ae1388df1d9957173cc0d395dc3c58240e76bf62794ea2154163c2a5f8d45ec8bbf27b4a0d8834ba874fd161626b5cbf73ac65901bb528e19efa9a8418ef591c07ee41aa88233d686e56f88bfd727fed6ab1f5ff0b689cfb1ada77e9abe638794c45cd3e45c2b2de689598e92d4e65d42caecb8b447a088b0e1a0a04760ad07aa80066ae36614c4ea1a1828db9e57571b79876fae44153399f78f336318f6aceb6eb8634ff7e8315b2e03fd9fb6dcce1f2a9c672161daf84b1b5a0f15a5d2446ca376d77b003bfc1731b75068285aae224c99210f09fb75d64b219c99806accaa3698db140c0ae182f8aeba4d9e6bd70cb42af68018b26adf46ec2f040c2e3e5ee6d27aa1e9a895af5123d9cdcbd84dd152802a709b58ad12c3190a113df3fa596ae5d7a67fc1ac8c65ff925aeeddcb7252686421663059ca9c5d0f1d670f9128824ce765ad4770b79c2b63ee456479f739bc89f3e4297b98cb57ddd3e4276581d31ad091575d63f24afe94c27a665eb244fab1ef3259b7db55b573b551e7c82fb92f61fcabe2823a92e888efe94db05f25d30eecfb529e0e1c3059b3d830f04497bd1bfea68c5f33258ae3f5d29b139087d3708f425e44e7499b6cf16974b405eeb0d6ff4ad77497cfd10209942cf5b212dd4825af218ebf6f8e17cc6c2940ef39b561ab380b10f59d33072b6a673541aac67c126d6ddd41a1fd2a8da41995126b6e57509aeb4621df5e47830341878accba0392aed8c620e860475a6b441ab0c09d1c248e1ee7b6c3518477af8720c33e88d940622cd267c55237e1a1f9a388e6866ce80148d8ed5d2c407489ece868f4f4da4ce76da9bf50e141f96ac44d2bfbb71b82358fc153705bc7c1060c7ab96f1258c9a2268072f24df9519fffab306947aa14eb8cb7e1dc20c82799deb666d1fe8b6bc0b7c6f07662f525c6a29fc4934b0028ee1a924f348e2d3edd7a35cf3a853ada317df456288cae08452abcf01eae9468872ba0824c282231bddb8e3659b19024502a91fd0feb6f915bf6b224eff230f0f740e4638f414271b4e5a8b8fe90b6a93033c2223a2e4f6be7e831e3b2e11deb3dca73cb34fbe406099074568496a5f98f5c8853a3c6506ed4daf8fa00d5475d1af5e8af213a6e9668e862227cd96e620f3cfadf0b1d790c2f3177252b8af491909d9607efac331ad1414984a8beea68cd27fc9b2c3c3ecc68ecfd398e18e57704aa8a520dbc43001b39b45236fc8622092a44d76c265194518d87bb31838ebada5fc818cd6f61b7f897de86561cb2ad91178c9bc02403ddebeb62416ac02085605d51b7ff26279ee5547a638a31e12b5e7093ea87030199215fc5015ea4e8985c3b24e9f73eab5c41078e785f4d4016553e2107471432b92b16d869287e29eb0467b9ed544ef0382a16f3201530ed1a0a9cd842c1b457d166f50dfadc5b077cbab04acb0cd034e014185c6c0693516d9b7d7fba75c7cd3fef4f7fa0f6ff1f7778dabf0e86274151179a430afefe1a09f190cf653b973608af043d8b92e06f0a7ba7c1941e0b55edb2bf8535eaf9b51d88af7ee732cfa62025a39ff861534f9462a7abd0ab0b0a711c8fc23b83267bef99309cedf65f404dff3d1da13d32bd183799fb7e7ff29fa6ae75eba68ad4f45eecc28c5f5271f9ec7a6ce57a990e9858d31271f4a56dcdf55799a154be85cd42d8d81254f5372dc820c03a946c3a01162dc9b73a7f5c5b66f2aa44bf4da7321dbb219d006e02ff8f79029f0db84d9b166583ddeb700bc7338c8ba98dbd3001493ca27bf34893c168a3dbfe7b4f02c76b11b6ed8d60461d31bc7e881aafa733cb2fc6fb319ff8ebf69e723e8009997e56fd0646d90e4775d1e9e5a7df9f33d599c95d6aa804d80f10eeee003a8eb5308b0c7f4b8a7fccaf19ab4d5f947c03c100dc345e18463161367fc3f9a6dcb67c3c58fba9a05a58a684009d73ccd210a206f6ca5c0b0aeff34c780a56bfacaeac71dcccbb25ea8a3d52396c5c6b2ac42ee90828e7526173e24ad5e98f109e2976e88d43b46a55e318d3de62ff694637ecb4e34ac3bd7de0458482c2351b3793ce0ea9b4387b9b7f82227ee50e30c7ce25cd40aadc808c23594afd32c0a1fbbd200d8f670cfb7e3754dd2edc20ef34d403986c417ef0b294e43444a4b04b27ac638ea70f917075b5f5867d299b5117a5ee517f98797ad7361a5c813fdd087d849fec15943f15b008a22427f06c9739b7caac302c8769657994288fb80b7672772e15dd6121cfddf0506b6394b1d91ada228c64ad9f2a2439d9c9358fca056dae0c5858c7969d1f9478cd5c4b0edd060aca0838daa5ae2d926c93a1401afb2d7ab74f0b2fb39290b4055bc237e5b5ac2d478e972b8c681065cab72436e7a60a45c31874d25f5c475bf100ecd6aed0e41c70f9d215ad1151d26e0743bf748db0d3b5ac9ec131b7e73ec9edb05219c87846151ae7e845d17468616043b39707cf56af415bd8868d1a1eb2d88b61c706e03cc5715e791df71c5f558de9f8e9165b3f6ccb63a892964759a1b6331ecbc9fab85f7915f0f6fd4822edc85ae5fc816439183070d7eb681e8be30002ca4dd8bdbee8f1290170f955f532e77b7c2003f4cb5039a184fe0b915aef7ef347a6d569049121f6296106b15c783de23ac5962483ac1dbee2ea1fa572938ad47bbf45cefb3df8d8bdb942ec189c83cdccbaf5a700dc3ea960077014385ab87b49a4116c34791815364225a3194b24a23f664634332cfec7a828b82f73522c9e46ecf52cf8d4f3c13285648f06a029eaea43edb043e9e6790efb8710fcde11a25754d6dc4c98cdac1d607af8b527b070e62e5986216563ae538ebb1831581bb0afcecb15ef903c662827b4724b05b2a85ed38a70401d00cf0d034bf18672ccc90976050aa7f9adf5aea9e7a45b48c88fc245fec6540994d04b035dd5976e9065a0a2ffc81fb8800fc44e834ca97821f5d24a2cbf2204dbe157ec818ba2b7da116953ddf460d3642b93b91cf3e52f9e62e451261a031691017e50fddd5ab8cf3dfaf9068027bb615ab0d7bb17da1858e173f8b10edae2deb1ba9b014f0decda7c69981c71137c8bcd40caaea4063cf5765e80d4ed40778517d04ae475840174203927db348315b96be6b3a40fe5864eaf79927c18be4f3c22eab57cce7ba6d84f21a54343b3e53ed97dd714d7b4ca870490cab261354010a028fb27980ce726180b9e444023f787109f41a457ca3e14da430ea829a1fe26c9dc3473d61f9ce122a0c20bdc361d1ddd99ad0e78d224273f2cabec17342581783cdff2df07cd00e0291b645e67c5b7346c107fdd50219593edc9c9f14a0c974572e7fb0cb3b631b07ea2acfdc6982592300a0ab5389952d154055391fdda8f8fcb153468fab8448d91dc883b0d16e6546490dc6d0431a7650e0d6d36f1c8766dd7ff4662d245bf466d15966a254cee1a08ee4891bd1de28d8ecf5eafa502ecd5f3e74be0957b013fe7a069824de74705dddfcac2c1fc3ceb9e53b500b3984030a14afa68a66a85145644c99175705ef39d0eb760090f23b9c17df06eb4ad1516c9c151878c381341a47d1fdf3710c5e0dd8d634774bd9b3556fba2495a075ff24dafcc559ff3867382446b107e26d878a1850622bdb899f2531b30debfe3f0c983966319650e2acc33b0f56915b9d6c4ceae21cd2c79c11210abe847a7ed34a305ccdca50a735861728bc1dbd5ae0448439374698b685e07fa0a0faf3860a1dc827138fe66a084ee621f7675d22c1a4d30ce81aec89f57165e1837588c09f494b56a98d1db9f4700e871068defbd911ca3092c3fa13ebf214d99266949492430a00b0eb9edf042f99ce3ebefbd6f6a49e3e6dd6dcb0a40ba4c071fd63861c76b41bb8679dd21ff13b7e960ee3853154c8da509f9fdf2253d92bf6da189828ac8f6c569e6dee1577054cf9b2fcc917145234c50bdee2201fbe08a406cef91c13355c503f2c4f9ca29b89890e6c8b689006b55da37ee76c47e6cc546cc8e53163ef56a2a0ef98d7b1ca253fc10eb397e20c248392d557ab0b1309aee38f5e266b7ca5eedb7c665febc97e2ec9a4ff2d67d66ab2955db0a29fbb377e556c71cab9ab6aa040128c38f058b6036c3d38232dcaa1ea0553a07c29300020ca7f399cfe921742f89e5eadec6f7f5c5d8f4c9e2723f498e062715fe8ca9c1c20e652e4f827301def3ec98d40397161ab607abc1c613e4b9d4398326f0d6f138466269804298b535e3130de8f47e6963f1b6010588d5fa9155b1064498b6763dc42a5ca1a8b96e143afb2fa54f8e455f984cc5b57f325691e5d624edcc6ae0a05f32f468ec6534c771e70da81c0737a1bb20bbbf1e6a64553d6ceeb20cf29a5e43a83de6f2c5d3c4de85ce60daedd52fce894474e9373a46150aff6949758d127147ebbdf75af734e7ae5f6602669acbba7f7e1eaa40ad15b280fdf36bdb767b2939b85b69fd31b1afb965ee3272b1644a3da3c24cddb29831e868a28fc1e63a9f629b8d93c93d73b227ade6723c5f912b0fa5417834750f25b9923762b5bdd872ef9b072f3bc74f0841f82d4e6847079b003bac7026671f3c355f3def4a840b6073f57e6ed1ee641516454a0928b55116e7aa730e24a51ca3728a079873820a1749063c83b84aaaddac4f9ef48a75589e00f45a9d903c3eae55651d180762fc8f580563226c2e54ed2a9c0628c29919db51443c71081711f1479f9d0e1a6660cbc2694190adb954fd7c1b5e31ec72b89ffcab96ce68141e250e3c0754fd7527e8b18f927eecc7703445dae18d8736750e4ed879f3aad433d5ec4fd8ee8d2684d3c3fc49c9211e963cc0f910460746eada8461724302aa516b121c7a8f205915b8d2b7f777ecaf8834961232f0885c60b67f97849bcfd2bddca0a570666dda0146054da70cdb406573936645acfdaf6555428845324898ad3e1387349300cf369deafa1318fa88d2bfe333c9d7db6054aeae9d828f33bc59db558572c36aa2c6e2724c2f031876b9da83050cc90805a934dc1edb03d292d0ee378dc7dd7c254dcbb4217c92808e98a627641bf30e22eee99b3d9c42077f41ef1e14b55b7555e8bb60d02281002d91f44789491e54dd1a5c21a8531c2d52e7e63bdb2b47dafc8134d11b301b980b19025e6d9d21f02e17735c166b22a056261dbed5a6678d9aae9537c5fc1f84d46bcd5b86dad2d4df60998ffb24a28afbd0dfbcfd06f6dd5d73720f2301f08097598c350c9e2643dec9238c6fd126c754e60fcb33475fefc6ca8d32419252591f5c247414da50a280e9d8629fd10c48a04b381c06dff4ad66c653a3ba630ab9adbcecd33e0924009c30bc610342624b7a523c6068168754336f2c8ff3101b4d955d9a400a46e532d76424429ea5d417788e0bbad1079b26d8f7dc7cf2c6be004efb0e9ce572dcb113aefea3e4cb1bb68dbcbd077e49b1e70efd82f8ea2c5097a485fb143a6f9debacc5cd72b27900bdf6f6cf856770afb169ef335c36d3c189e65722b653bd15ec40ef0b59eefcc46c70daffd3a6ce5a603ab0516a9d0d3441c710896186d06fd910ff7ef4fa6539f3b4e3a5ec2076364a53dba0ea7b2c2defa7ce2b5330f2a261daf855395e639306b5986efccfa73b37e62fe345e53b94fb6edb654458cc1e51931ec80460c39abea3f69d78508eaaba081418af5ddccade45f0a3921a6bc8f115e9388a293ca46e2dfc44ceb6b4773ae9e75188f571a280c8dfdba81310c65b3ccf6ff178cff9ab377941ce18f789af4ca1f3f444e2152d3940c6d9b576113ff743bbe0a26749ed58e378f21094d8ce2d57bc8ba4df084a8b681c20625146ca034ceccc032b8a593b2cf25b8ac1b8c187bc2c0fffa4250ec8895d33ff7a57092c6a70755883bea2929aaea86cff3c74efa4c6ca88b01d609af0cadf3c7833455510cab689f736afd9b4842be8c1d562c8ad022150f5f5e92975f45224c90310d8b6790934c0b02a2b8dbc97de349f05981e796214f52f25b549ffeed16d60c9225731fb6e863abcc8f1154f2bf3bd840682c4d5559366be5b10ab4dd5285d728553e4382c8e11c8e7163a23b4274124f538a5d06f05c36d2b7bb51e136b07d3ff94676d480f6a34fea1c146c562f9416f3067d543542bd4ae021b2cd2bbe032e9467154fb198c3457fe420ebde720edd96ef222836e18585278a2a989411ddfa1e630e88552e02ef74a6fe6aaf4f80c1724bdbe29e8c09cb4eac2f8a1e69eb16704ebd46260d34d62c17fbabb366d392d532b6c9f3703273abebde671112c60aa48e7f8b31e1707c9f8f89536b83573175ace4150ec0ee96fb27276c71c94b7481db6746f8fadaeabb75e0d4f82a5c8d12abf8be3765b5435b0b363855eaedf994d25143f14917b31e97c6a7f9d1b414de808f7f29bf1109674219e908881fcf256c74dc0f308dbf53a33d4691bdee7d040dd3e545b691e9b25231af9646b7120bdb070c76bdaab4c89cedd22c73ba4e8c62b595fcf35630a06559338833d33aedf059fb506fc779692e0a22398ad3f6fa72a236e8721e8fc710c6c6442b960605f9248b5762a78113e6836c6fdc5ce8d97d1ebc0e90ca1f225bbb1f9730929076945a2796801913cdf15d5d3e7c825d5edc7c6b4966ce71fa902494ffa08012134a5a1736d3b9a2ada16578eb9f60860376b87cbe2dabcc97c9d5da8b181d39d52e7e48cdf49b086480f666c2fb885c946d4b6d9a91bb1bd79c17f90fc4c9297f7332848dbc6430f065786f7497b187b8a42bae40c2ee3140f40d8bf80e4b69caf844ad17e76e039b3172e1a1956bf46256f0fc9b36e0470f6d09da7ea189c250faf09da9c508c029edec0c16fadb8490b8ede89e967ebbb99ad2805871db36a8db4356e31caac6679099a60b0147456902b3e1da4b14bced53567ca9ab04c514e20645b84d955e46f62f020175feb83c60d927defcc475ec6692d3a480962fc77cdb6e8479a47a00834388bfe7d44f52956e7132645c88c442adaa27174f6afc7681d7ed875692c0e841ba07d76500643b0d671758368869343e98ae8e07e37d3c2d7b11a2b63fbd6612322a148b6af08f568dbc219f172d6b7046aa0b01156a4750c953c77edd4d88261c5433396e6e5fc7ebbbcea428fdea0c054947cc0b274b10b0f523a020a356275f8f66f416a334d2962aac2f9b582f03cd2cb37a7441b5da2b0822ab5cc82958a7c9354d6c026f10b75d3de4e183aebbac1dbea1186304632937b94bdd58e2cccb9688ae826816e51bbb57d05ca9b13f2bfd253bb6b69733983094fb2c908ec5e775a8636552ccb8ad2e705b7f384366de185e90fa32b3a0b1944a6a35628f4a1659e410e57986ce2d4758f198ed29f81c2e35e289a54920bc1b6881b916ab0b3d04a035028b168765c706742d7d23d88f06d16537669e9dba8e0cb187265dfbbe41d463a079b61db2ea5a84e8f43595a26b67950434e70cbac3a5b8cb6990f00b8a2d5802110e9dc99d24e343e181dcdb8bb6e5ee2f08190fb5e1412c8c6bc33ce46953c692526f5a5d5de93ed0c2efb83f95de8d33ce85038a933a5127ae45cee4025c68ae9f11a733af23698d94e590b6de07a76ed74ee11950496c573b89b384b7449aca4b5ad750bfeda9636add9cef6d0691dbf79abd4ed09d26e9911e18669b9ff22d3d270fd05ffbaa11f9b9016f0590acbf6c73a9ebc7972c580859461c88aee670cf6e5f757fd0de8c945c1fd075dcc63e1128e7728cc7617cce0f897b87c64d9c2e490f88c8e98da5eeaa8ca975c76ce93953c067c7903f7e5d0c795eef2220f14d376a5fec43aa18889880fdf47729724b145013b1b5272018d2e14bfd032d4c8afc68cf0784ee33e342857bd122b93128a4280f6d40403f8f2a357e39fb317d8838d628a9f4335f92b559811e76fca40ecd4e4cc0e1c80b46c1cbca2af09af145b29ed09d3d1d80d1f567c80f439943b4d256d6e5ac44abe6a00bc00ce70e031f0384b09a7557e7088d176436f2a6f67c324d68da2dbf2ea4912cfdb66b9c25313022ff5b1f74c84b7a9151ac05aeead1178ae0289b96fb1a109d8a1a213fb28fde5670bf34b967c7e1d47e9f0032ec83d5a924a2476a0d53480fa0ecbd0e5cb776f17c446fafaa661b63dff8ae31fb4f3cf1a60edbcd6d9b71d0a3990a3318ca1d3da83cb3dbcd9ee467ace28262de72ca88d3e2303e6b869c6ab5ffd5cc7f3bfa046299661dbe3fd634073df1b8441b1e42088f91ef21008541de5847b6651d52b2ae3588d8f295a690ddbe70de61210db61e733516ec97b8eaf1c748897e230b9e9637114433331aa54d430e08a516f80c5210a93303cc5eeafb1045b4e7c122959e8911258e3b1ec0a21c0d8dc81fab5badeb5cb378d9fe0d628e19c7cc54c7b335522c150536b02f308e9ee81d8c515a78ea5d8a32807a259fff048d61f3d58e2c01df330db01d6e6885524a2fb3f0c65504beeb2e387e224621e2a787d5b5bb13ab3d1e504b2c2d62af9006684f7199d79875cf1d3d046c99917e99c273d17e59bd1ebe50f7850f5c174758eddd344efb299b8ad4c2af48a8868b666691d449fe911dbc8ea52d486c42e6e0a51b6fd5c73a3fd925043f461e84851314e21e8aeec314b4068fea873bd84221727a4475f17e7d19c7057042108d0349d584108854b387843c7b79c81599eb9924a1efd110f131261d2e69a0a3a99c2b76e166669e6e919ebf4ff3b89be5f98bf2dc5049722a2914445bc576ccd21b5f62c281adbed0655ad8779ac71e36303c25d579ff4926cebfa72d79e49e8d278e0537e6967f57b9d2b478864983cf13f5f2e7a68d70f0528acb153f0c7b439184ad5ca584e271ca1df7bc4ae0fe335a34854a01601a3a196212559dab0674cc70d8fb472321053f5391d2007f89dbd0caa34d3629bb7577f1e6b49486f631882c494edf83bd4d26da11b4d22dbde7d387f3e23591b5a6e5334cc951cee3ddc10e12b8bd9925d8d9734a10dac26035e345017cf5595c690971f4b8760eb16becb96473b83be3e41b98d30c8b28abd2cda9daa9ee345c343fd54f7c45440629f3a45d3d995dda9e815e8f95a091ac1d30595f78a64c6bf6e43c4f7a091bf32f62a338a5a38a2b163df7e26fc2b894dd2df9cc6b1c2a58dd94eb731fe44537ff4796a01388772442bf3deb783e2dbae3b563e5dd878ee80bcef00c4ab618c2e01c2e938059a530dcbc71e56902b68d24a2dc13bd48a036fb262d20499bd99192d856a57db624bf2c9ad6b5a3d625d61a3fe681a093255ce59ea20302d86220264f5dcc3a6c6059b5645eefcdc0148ffec9b3ee1dcdfe33a36a0bacf2ae655f3233c1bf05c4af6da4f5d7a2c1441c4d23527c9b26f90061d9b33b1c08bcc22de8adae3bde0b5977ca09409dbc8b85dac002cad9a06ed0fd29cf98dad854e1eb10ce5930d4fe8bd49ea66f0d53087ca1510690d3df79cf54b5da4e8d00922f365d8259906d106c693e2c8a21e189d072192c7b852d51fcf6b2c889978d0d61ea14e2aa0c262f2d33d1dec58f30a13e1fec0c5a6bef047f63bde6ce8aa77ea993ae8567bd904c51e56b111df9c2cec7def9a80f5033087f71f71b174dad2849b37ef790cd90103f312c8983ff6a960b152b500b48ad30f742f2ebd5e34e6594d036d4b28fbc90c0b1fd218d19b5f9a15083b7c47a4a7632e714a89132fc3347d2d36ea0a57ed62a9e7942b18a8fc948ac5caa97b2714d383481d45d6792da72f7fd45321f77831b32ffab3213c9ff21b33c68a3c88311fc198fd5d8faaf7c88c19ecb07bb7c7abd81eec33f717a7347153fbe5aa511d26a661178142aefcd084813b42c9ff6297b267c2738b61975fd458e77b2493c1e586602b1acdb12d509121d6a2db75cd1cb0c0b46a6ddf6017e43880d9d69dbf7772d3dcf0ebe3d74498bc153dff531bb6761b8496ee4a1f1e6e150d7c1c9a110053a1c49dba18d4f3e34504bbaa00ed6e4e6adcafd0d8b4c036732941bc4969fe7ae7917369f27f4f99abcafdbb2954c09900619117c01a077b1344dc3cc55aefafe5e6d9681fb675697355a9975a295c5e49950d7f17e82b48f8fc6dfdcaed44bdaf51d8cba853d107d001e2a06e45db4074821653f67c3105c3bc8a671e975c7708835d236bf4cb713b522ce25a070a814f6e7753e636d5b3a5150c152bd066da64a70e4a372aa386258bd6df337950ff9bc59656d0019b085e11ca86526a6eaf6c983f39e4c4cd266271faaf229ef4ce596939598bc0bc3a19ee0b4995806ff7121507baf6090e094c7d0d3c008dc771ae9d690465bf92d67ccdd5264ba5bfe057c1a395df500e4149a86b144ae23a038f385b824c45ab7c9aba2518fa00639102a6f71c0ad8e0c9ff75be13273204d33d1e2bcdfccfcd60f1e29484fa7da6e1da5adf3d65feb6fc35de628e56eadad7bdf59c869f6fe0a36c57fd9ffb2bc5c4ea257e464e1deedac8d28282ec6702e1b3479557d409f9d5ad36cd9bef74bb5bc5e05a3390380f3c53d22e226ac073d3fc4cf64023bd4f053d1f3e419e92fb9803b50e523f97f64af335e70fd14bace63c33d508500e47fa9c242011215acd6f1906a5edf34259cfe8f2012cb0421f70a297f9f3a17f867cd26c0f99b768128108f1aba4a9262b674a8a5e88731d938ce94f9f08100d17b0dacd37692241025c44ea481a4658f5bc084bff4351f01fb99d50c475afa479900df074d7163e2ae4dccd4ed81a945bdc3f7b13a87e3d9114ae3157c645bc51c9855df3cbaad663894e6768cb927e49921397d3c368fd60643374fb4f34cdef9a4bfe3d7dfc45397428fd0cb2b653a1455d404d4aa8fc749f7396705fdabe5c3e3fd0fd8fc94415a4c04789d8f572728046736cb9d2883d34e33b79cd2f7cdf0092396f04f9c177ce188e436aee21e773ed7c0e27efe4670e25d1522810dad9fdd65e24fdd2797412c5defe1360bd3d9cfe09d63cba59c75630bf6c99aa06586ece8fd1a631834ef9c461217adc1d9056434ee705a6b1ea6b9d22eb794cf49ed954f5ae7e75137fbe9c73721097ebc2fd2dba3778dceba583a54ece147614e5e84459d57db309cb3e01932016faf1441b1e078b280b19491604a6b9c4ed7e277a223d91731d88f79761ccc2656e64a7d9fe79e61d987108d152176bbe6c5229f85e5d9a819ae8ededff8506a5d6885ec944816a3f3aa51a8eb8ba6a102a8e9367b39eea8efe33ed2bf53bcfd0bafab4778df7682209bdc1e8a629f4bbd1d550cfc72158ec1759c5dba2e925fc45c79c135af210ad4a418f4b6bad16d1bf2cacdc06d7436d483a01fb9fdcd120dc386846cae42593c7d46f7012da4eb707d89801b6b3b5d2bfb5d98d54ebf14ebc3abf2d9ad4bc64501c7c1a0b04c327a7f4977d8ffabbc1cfd0343b3b273989f9106b94b99cbe870a8a72c294a15f44499b320768a6c166607942aaad73af0b13d0c5431678c9bd0addd9434cffb56a5a9f5a1e7a9f701e754a31685352b70770692b487728938378ffe15244f3d1341c79a249de354a8227627a8170d9999883ea91ebffa0527ad8c264eb0fde8f274eaf1f981778295d491f48d4ee7ddeb53fec75091a4a9fd4454f711aed058f0a4a2fd3717615803c1e901be2ed29cb57140ac836c02cd48e6d57c7f786d4f984d52799397b3f8690df1ce86ba7643e60501a12814660e0e46d5ec248aab31840644c8fab78648691703865d8ec5a1ee4de99f8fb3bc4e28b689774723ffd98e240826d81edfd979a9cc64522eeb8361bb46e0347d8e46cfb9dc270834dd24746bb52853ace856c8d2b68af2d5600568de3ab50304618195ffa2be6435fb91e52d9a449a6fd9922547b0d1b922473cacc9465f75fdd1baafc1dcf78f2793ad7ba759c4b7c8abf6b073bf395854c176d21d5141ddd1eda99512b39d517492aaa54a87ff8a3d4890d96c539f3f6d7aa079a988378941c1d5506c2faf595b569a9fa803cef476ab2078b93b2d6df7d406bfdc96e683a72a7d45d44a4e58f9c008eb0f406802137eb6087629716115db513a4d5efcdc163edf614772f70bb68f65ddc81dcba1ad52379ae81b2bda7ae0b1dbb47e46126773402d8afa4dd449eb2cda335c52d525efda580ef1a5e1357431d48abcab5954d182e559e66eb3d4c45518e02c2dc63ccf5b25f170f4596fe28ebeeb0b39162f996bb0e73b16b06f7fcd898cd167a72e020685469c5653640e7fb60bd94934a6ef9d12922341e686229b6d327e8db8b701d266f12d8ed678ce0371e9a3dcb0fb958fafd281a095665c5f6f5aae2a8b639ec73404cf57364a3d002d8891288c15dd11e10cb1daafb5eb6e4ebcd4a551af68425bf2712d3e0469005ec587c54ed302a802d768140409893b821b2f289d9ed4b0fb00366e7a7da29a5e99bc7850e2e9526e72fc6612f5b5ed2601e5ee8aa4fcfca01bee7a55c912dbb4c9ceec9dd4f6a95c16ba50fd21cf3efc1a33710152996e19dddf9378096ab24cecebb2bd309660d9ad98810d0376e1e6acd8951e99bf1c272726a453ace2563cb9377be618118aed9420364eccb3c1310c426e3d5b1976dbed3ccd791bbb67ebe95e2a087bb606d85d8e63aea654d33b973c73f1e2b9fccf0ac664e361ce7911cfbb2df646099e4e428a35088724a578a2eabf71ae47fb315b662eefc04677f9fb5a607d2f034e7cfdc81f504a6bdec2509afac101ee24e5b9d1678ef2395e40b11fb4fdf28c76e233210d46331484303db050241f6e8a2c38a882658c23f591f4439f7b4f3043d46a557e02395f3cd7066ef6f654584b7016727a0d213fcf371b21e471f95bf07243e980da22c347fc0c5542fffaf9196576462f36cb1e0d6f6511151fe865cc38af81e14a5058e6b9238eabe2dc38d9aa5734eb0f47c38537a309a02d547021390d365af6194e7e424eb8640fe0e2c71cd29bbcfc0ccb460215882b8561fa4dc5136a9931a0b85982637fc1863aa96f960eb19d4d503e58b19a795dda0f7bbd2422c556dce4d24ffd819ebbb3141d0b0f72d6853004f2f15b29946331fd73a11aaa17fd113e4cad19622bbdc5b2992d875b071ddc4ecbfcccefe139eaea7d571765a6eea5432e1926cd031326bc1ddc7c0cedb833d15ba28bee5c75b210c57ae60a736fbe297505bda04d92b1c227ec907fbb583039b0b3e72e9403059bf7114c4d5cec36cdae349ea6c12b8c8a3b3889c5644a8b97f8b487d2e3609b99097f3a7dda17e5894679457adab537b38e9a4911b3bd6050715931393193aab66e90c1ae8eb87d591dd5a24790b81d94f3b7cabb82e3a40958e59f9083c66ce76308be80da9db7b2bced19193b0494edaa68476d5ef505aa5997ef79f59b4788dc8036a6e7abf3cefdfb1801578aba04ef01c13e1560936d46ea48580fcd14ba24829eaf227988ceb705c170ba3027c5573e8c69f1a8b4254acf5bbfd7fdca0e18c0081a95f8e6416f116fac34705c1e557ff4e43a23544e7ba05167fadf3d13249b868996fd9e1a7bb06cd9d36c5637447d33a36c15a55699aa917bd67e2ff017846dc64c27d0c36bc1a62a159d10bf51850bdc71663e74a392a1cecab465ac01229f3dabbb21aaa864732532dd39f83c9084f2fcf32827d22993b17b72b23aa85e08e7ff1191f92c472d3cb9456f6d543e689c44479b21c2d8b573726a116a685bacafb864a3e6d6816c38ae5b8565eb1fcc650a0b40c7287ae69b0667fd2c2e5f2f6f7eba7ca36b9f1b795fab03cd249454848a8f0ceb411b8eae3bade28166ff8212f773f0887fcec59bd861a7287df075b27e5517a318a91b0dbf7cbbc103e5c542963f2012f6e0bdcc606caf8f2413cdb60660c54d3320486f0cfc893826c63b33efa238bfff474d5bb26ba521124627d9f6b74377049a488f00f33f3bad7a7fff0d11fe96b79f8aef716f2460bd9f5d62ae2aa4646f3d9d506e19c02fd3792d168080230712313a4a1ff0ccfac33441335d5f81576f26236b04e7ef3d93dc77785098cf5d9c30b2b9595d73fe8a0b274350fcc48b85f8260b1cd5a91d4b1dfe8b17e9971c202fe2aa3cca29ea38cb698743699ad43ee57b289719d3573616a996fe9c66d7e27cde5dabff6cc368bd03eb4190ab6076f5b04476d8bbb1183b8cd05264807c4f04313743175b103f68fdac6770fde60eafe103a19fb2238b566c5bee4b7fb428ad5a7ae03439983e59aba5aa17f51179b3101a0e137fc2b5c76b0d564eb99ce5f1e675250400d26dc8620172542bb71615cec20568bcbb9575afb8495d037eef8d4311160f8c9fb4f09f626f46251974b9e50c288ce8c419687852c96296b98b2274e96eb6b603e33a93774f64647262d19b00ca6120ee8efb8d53ea979308d587afcb8b37eb7bc4ba54e0d112f3b170f4aebc0bd0b01033c83cc4a010e326eafb75c809872266afa2cfa871372a2fc0be70c9f32b2a297b738697f5e4bbad14005692f874d1534ed9bb790d676d6ee5cc7aaf7c174a6c3cbe6928ed8bf5a56159bf471052dad4a8429dbc36b63a4ed44e372a7eb8e7af538a62767f38b85c29f0f5955c504cad6b2b0d104e9267081531b2d5890a3adafaa1047b41c2242283a75a96459eee01c20aa47e331bcd30bb81aad680cebdad05ca812da3d1067187fe3457587f1e35e2535352d5e88b2e1191d1e4ddc203f82008b3ac1177f3ea966bc8ad22c2b03ab760b37af3e627e9763c840d9499086556b0dcac5714937806876fb0b64895da1c68e2dcca69e379dc63bef407b89965952d01013d971017841a849a007c7263bd0bd6768d4a8d5a9d8671091db5ca1a35bec32e2e66232892066cf9dbb5c9ca3472ef8dddd5d9b048c0ce7b90ec35bddb737fabc9f4facadaf0d7f1151d367d05d3650b4ada37ebde9e2d399bec981e0e1e626f2cb7b06be609e0ab950fc8ada25ef7d73d786917d0b6d0e351dd7686086e1167a920cf2b7d2b2c2ebd424a7cbc671021fde532d553664cee45602d785ba659d5de7654aa9a49ef92b0295b26fb9e75af3e9623202c42dee19e97a02b2daadbebd4dd40757c7822a95c829d0f174b2fc00b84c17ed29485e2b94db5ee7d5fab17eed75692986d983e1376f10158e2fbdcc69b83b5fd057df7b4be81c1dd4d88f348a43ba02dfd8af2e3898884e17df40dc5d0827d7aa1be798402fa4055873fc6459a88b2f35614c37ed67ee6f42ae89170a1da9c36766a524aad301d49b393b66fe77a3a6eee7f6672598d69a264d971eed45a32d82456e9b66237bfcbc5807210a4e057f8330c9dcbdb3ffc49f025a7f1c29b36a74396500301a0cd243a85e7b3879dde821b060e48fe6d43716bce7938e5d57f1c9cd354af89b45c56e12023f1d964530938931e840549d48887f2423fa067a8cfa44fd0846b062c1e857eb8c2e3ba0750a298179b4b0a323aec16aac4efc2534e4ba9417a1d2c7afe33b0ca9e205895b0d73972468b04a31188d66936c00a8cc3b204cb8395bfd527a941487ea85226c68882ca2c487090a1ab63f588b59799c478e60a5d2e1a43f4b5e7bc9a03c3688df88c7a3db3ef4964d4adbf630b166c62c86ca507c4e24436cb911f51807183be8e4829bde682b049242d75c82e0b3e944da6ee185b5ad032bc913b59bc26e38d73527158f354917ff71a658ac24a8af7bf5ddc5e3b808766526ad164b7a590be1975496739bbc340c6ac00a4a1944f98e45044f938143ecf87387a1fd10e175f503973e9a45e2bf90d4ca86310442ee1369a42cc5cf624aa808c7fa42f6ec0b3fc9a8780b560a8b074331a27b55b822cfa79e4e7caa830ab865c506e93dd10d532eb8ed16f8670d8aa318883299f8f46e5d174bfa46a24a0bbac0c50376e37f8774f369a2a61c81e485f2a7df3ff22c44bab430860a99c937f6c27c9b9f8d4c2eb5d436dc5159af4cf0b32fb39a7df2d8653c95281b177b6839d8f81f3da6ef154359f38841fc7b8be4f5678a50f4c7e830058b972d387d1cd4fde0507df17f1e36c6f2368d85ab456ca55cddb76cde5282e54ac2d07a64dc1eaa1d3ab8c47bd1db32c977df8c21b3d259592f11f1baf099874fe29aaa8e56cef4145d72d6f472ad0c7337d4984efa430cd08a65fbd9d4ca11d6e71ff298e5dd768196c8397439b75404fe49286d922e173e2505ed03a390a93e010fb056cbf4898c611b305d964e00f2381d806ebd45b9e60f6e54a3bb587e0dbb74e301a1822015ba9f060cc60b01a2d95b8bce9ec32b152fd64c6aa50c59492e211c505241a1fbeaf9c856f398d2ce1e2dad42cf65fcf404b7b6010c7359d182db5e2a19aad75f0c13a4283feae2d5382ef8ac344c7596f70205a595049a6d6d97601b4577971996b77acd111ea25543fa0d5be00f99002fa05617d23d2008889e33ba32fec77abc91331e99f0cde456cf3b745f9c731c170a8a62d6f7f017cbb933b8deec4a0607f56f9c908ffd5311f656e4b618a346d65a694134930e0b8cfc471fcdfca5fab44d8c72f3e89b084ae20686fa2fb15fb6503b931d6c0ebc693f152b232b179bdd8668c2fbbd7e5e326a27183911258b6cca9d1c4fdbbba524845bc2c686474cba4b04a67a34c62de35306e55747691f6aed6b23627070aa50e16dfe59ea313816e09bf8f1c73195b52055a65b1050dadcef4f40f2f3862db0a5612f84367e1bc01468ae9dae3d2e8f499e8d3d50abcfe631eef029ef9fb2aa0794c66806533fa197c7f0e601b8526006ea71724d0b07050555e4c97856f85dc48c47011147e21cbe05abbf59e01533569d30a7e1ba00de6f1acf7b1397a311c65c516c74ab99815a6bb07a85ac23f87f629a4aacf37cbe8498d556350812e0e3f22c7d8b2b9a5cd5240813374d993d7538b09db6954bb91935b192dd899b8361628350919f9f4f565b4b642dad32a2c8a0ce74876c3ed44f2e8a85bfbaa7371f8cbc74ab3d9d05a159f4db33b5cd49b473e7296f79a601b8ab0684d11bd82185a330ca9897383d3e46b166404e2d59ca4c793435a648387e5bfe7580203daa0a97abb72ce6bf3ee10eba286dffdca0448ab4546daa53571f79018584f9ffedac8d888a4510f89a4f2cb2775d98a2cce524b6e8e5bfd4317476c1f2f81589bb7772448d048ba8664bada032abcaf0ed466e0fb4a346b7c553af006d88212e87eab16cda31e79930a31f5e82bd35f731b1a3ff9b25be132537e30b1948c177292b9856e96b71f9efd828b937bef7556bbaf6e61eb955c2a09e246824acf7cf6f9fc6866eac106a7bc8d3e62d5324505e380c31ad173f60154658b039f0e22100611345ccd2f2aab05f948acf73b13c83003a686bbd273444629bea045a7d7fcd2338ced60b904e3d2b6d76f095601ff614dd600b198fd67fbcb463a5197ddbe3b723a3652a4e08e80fa02b419d67ff7fa8e5490101ffaeb56b65c6fa4918a0dcdbc2f643bd93d265c6444ad1ac06cf3d7d988bb5eda1cc503d6e05be9fd7dd7332d1881cc44e267310274e73114a8f5659bb66e84e688233b0e46f1dc37674a47a003fe799a94bc6b1fb15a0944d50b603a670d11a61470a4ea2da92443e39da1b61784d04bac04837a84d9939eb1d097126303c6690df45ba572b65bcaa62cb3dd5873da78eb61eaabe43e3fe8e5f8898d20dbada1ae9130a53685e551bb32a1f972c00070c772d1835bc62c1840a730dcd753efbf143dbada3047a6067399daa58a0dc65414e77bc7263414573f7fd3e2821aedfae7b45195b4b39a600129be98e67a89297a8cd11e6d7c70ebd32e3fc3d2219c2a50abaf8cb0bbabf43ade218f9e69817dd64417158fe220791b1cac04600a781b95baaaa5157c0dc0bc3a69b397cbc3722f88d4ec1434d348a566457f36c7d030cf86a9509f0ffa228ae72237247fe378035d7a084532590b45fde2554fe691c32132148e324e44998abe090a07d3b95a5a41f464493fe84e8bdc35173ac26d0ab96ab66279ec3b82fdc96eb835fd09c87a4d0a87608e824af039a9e7e4acf455aa42e7a9c5edde6a8c75da0025194d4bda6dc50df728528a1a16a0ae2e69fb53fd65a4a6cefe5fdea6548dcd0c038d3a076b3bbd7fcc8ad55f510a4edfba8d5a4eac151a3eb757cf0ea13948e82b38846fac30586cc5a1ee75fc49bf96549aefdf2d51478512b3bf828205eceda94122ab57111a49f5cd73362370abd98bce7fd93a221341ceb01b7f6d097cb2d10e4c96c851b7b4cff54567f71f205cbd6f0edf9e41636497ffcf86e59574a6fcc49bf270162d206566b0d3ca349d300356df3c9b6e16676ac680e8c50087ad6d1d849f1841e2ca199cc1a48e41c90aff1b52f82a4fab1945f360f05b658a7d29429d813f3d675e2fefe31ddc9262041922ab57a660e35c336890846b762894ce1e0dc0b6bf2b4e3a59957d2a5984d7cab03aaf31172efe11bd72ab980ab87ebbaf5def17d0b11df544a82b77a4057a375500937fcea8211b19df6f10f015d8da9c81a7a1c41f97b87dae13d3fce9dd627cacd469fde3e6840b7a2b39128781913f2d5819b3c1f97ba889acc878c31ed4bbff6610d3b2fd46dd77eb65e6dd542134bb1925c04281364e112d62eb3b49fab920a384950ab944bf143b0a1c402685c405af29df3de10486c9b212d931eed88a94ea68d4470ee4d61986e9910596715cc0c0a5713935e5f865405de20cbf58f9faff6077313ccb58d2318efa32291383cb3b3b43aaa93bc9c5b5d623717259e5bda246d79b25e44802f58c0e427a23d7c96b8e06e5c3a85f63692b40515538423232813ec41c3f7b665cc01e63c5e1188d1134d0d7b6f611c6716759e66466f35d2a9f1697b9fbba4dfd0f4fae233a239813cde6dc574cb390e4242fb89d7726212d29d9ea4c7574b0a39586fb2a4dd2dbae236ce71adf54480328227bb2cbd383d0e75546c9cd3dd1342387affa532c6c2aff6ca4fc8c6853a1e66ce52296fca460f2c6a95dce81783f4c696afeea2d0fad124f7c3598ff9b1867c2097442efb5e204e8038a23710e8a2c04ad2feb4cc52ff05c2e683d3f148b2f5a1244304484b34f7bd8cf131f217d53047fe31d0ed72b44e28dbd2f90a0c70273430b8aa354d36ff392d5a2d773de98e0d6e29f450818a272fc8a029e09528bf93c39ec2bf5de98ec79b3d54de571b49ff1f4fa34a6c8aa611dfe53e5c6894b83a17f41e47b1edc44d365faee3056af86ca2b4dd8408808db48d0c0e1fc149b88749834efb112da360c73c87df9d466d50b08405d803dffcc023e544e68c9e254ad964cc5af8e8e5611fa8c630d203826ee634743e641ad0e595c2a148946c3e8466e936b671a9451748a1c3992e0f225a204926884d03e4b5c228854b4e8c141991d0d0f27f8eb003432fbe9dba9ff00626ab0945accd637e7c627595515a7e77e0edb9a40dc853a7af1c8b95f75232dda670d54f66b978dd0e4cc18171e69828f402793b2c19ddb93c016947c75ff428a11876c7471c21b70b7cbb5f8a5cb5d373e5ba941f941ee85234137cbb055710ab226a9d0f63edee9a645cc9fbed2e2998804c670cf5fecfc3baef53dbf689a487a73a21c9cef426d79b7cdfd2a5b100da36393b15fdb04f9941a21150bf32b0e6b32415da06cadc14c576d1f336e1e3cac926cb3e9a7bf849785a0dc671b426d2ef04b6297cc1453503b6d2e5e485207a8e240d2cf201af9ba57f4f3484517a0c85d7859a934b1e64dd9cee19768de44ba6be48190fe7311ce50b3b39bfc2f8ff11217bc09d8f6fb3e934102e691f593ffdcfbe0fc9c08f1afc6462c2fa803cae624ca96fec22da69a2395f97193dc3bccf2cfbb0d01fc7fcdf6930b396fb56e2bbd2d15b2ff0f0cc37945f61446f33ccbb5d9f8bc564c96bf99f23c1e6b692ffd01f841ee66e2f26ccf03eae07db4c4f4ce1ab04973a2563d08ab09d4cf10274d7d127eb7e8b5c634dacbe8dbc12e4ae8e7c1ae5b766d945d603886c3935510ac21d96021e3e5e91ebf5ac18ddf7baafce5a611ec1252dd5b45e8182cccc3fb4736f41bbc787139930dd70a9f5057e8017a41cad4387fd41f4ba96d30726ff478e3e82f0f27265c2867cf738893b0ab0ae23e9bc12f12e159e0302fbc25b28055196b0453f87795eb198eb3afe7dd0d848c13646e268597eb6e90d8eaa38bafe4ada8101be74f0f59a3ee7b894a603ae73d5cd04eb9b92a745bd749c36cfed1e3087ededbf8106bc616be8fcddd06c0b010d84fa7bcedfead2acf9bea71bb6ffc1e535956c7abdbf49126aa12256c131f196f9ad163d54dc3599ea203be1a7802a49addc15ae5aa1feecd8f4aa538b3da3b82696925f700d76851ead480c66797c6af0f3aa83ad3ac160aae11ee701a17ef5b6d7d4489d5cebd3562d99802b75febed241c456e7cbe9d4ce2cbd172b7e5a71e5c4491dc9a27e8aa2351ea23a351f277322ca0438d485a9f994cdd6315352bf68dccf67cef911adb8f9297e86f8b539a187cf5939527aedfbeadcd888393aa7c00ee1f137124a29c4afff6c8660733012e5c1c65a4f2db67f75ed66bc8deb2ea32b02fc77f3e2dafc1d6ab8354e44dce527981d50805cd09b8816be26200c221273125273e236c4738092a187c39227d24db030b4d0cdc47f876e793d5dd95f1db996ef5beefc59fd39722dbd4f89e9492b2bc8c298bc5da8aedca9702f61b4debda39876690a5392149d202b6fedd86f8b60de708a312af25420eaa228c55826aac84a08ae242ca572089d58ee352db5f473a710dc3322156d0640f6915364d457ba3ba08e849555182e8b8da1bf46966fadf8fdd327a69bb7a162c390f08446168e7e38472e62d85127643a9692e378335adab6dea703f035a9223e974ca9c70d529c70d3993868216d89104c7875f59d7cbc3a3471307bb77367b0c1cb82d133f28b843ee1271d024d215bea80cce218f3885d50567eae8782089ee1f8135b33238f6dd4e56093986f8414c545c21374ada3e1fdca52595947f9238d0c7923d43465afd1375f746220734bbc8419fe3426bf697c4659037b84bae9cf24f5f0ca3b3567826a734857edc6e463b20f2c0fe0ece76a40f76130aa1ec7705504cb1ef5a1113b0fc241a6fcd4334e0cdd3fae91c9ddd5843c9f5e585e6cec3148272224ce45b9415de347672b9efaa31e8f993afe9e06b1ef94c1c5f883377609416d28973ce437be25033dc6d7d19d19e374c58129f6460c1c26189cbccbc61973a47d8c2331a589fb4919a5e700afc16d5d38a33f1b1e194535103ec124191a89fdbfe1cacacca46bb91802ca58edf1fffac8ce3213ff033427d576a38ffd23aed1d8fa789c8876b235c544c8cffba1e3804b1618a0ab8868d069445315ea90755d12be0a59be02017caf2a5e246d725cf2f5112b9772896444e82ea3799761f424152cee4ce06e67d8024f8aae929f4035e01c9b9f139551995bb23e1b9d60e8ee02b6d11ad76916946ac5059da722b01a8e1da155a71391bb158b5e80463dd09ec73f9f66a246fc21f27a288208b861dd9cfb15367843f9388de47eecc9ea4816ef1c262b98f63984cb6177e3dcbfa1386e14116919f2eac2d629adc6adf1b585edd788cfc34e8bd1507846009637b9a773f5e60586797d4089fbc2160e11c6e378e50f79bfa4e28358fe5d27f3a5d35acf014956ee4b5455cfff2adf2cd10e9d64fc477dd254ce3d3ec468d33c3537e35893c05e72b7272ba368b91272e8b371e57ac9f2f80be4f644581d4f1f585d26a388ae6452b02fd179ee55678444126c2c339287ca13c787c6024e0e82ecba2edc990af6466d2923e6fdc2b34862530c230ae2bcc1b800035d6498021187170c3c59615d988c8e0f608512f2a41e58e44b14665bd876444f9c979866819e32f18f5846a7528d118ef8656ee87a7d5eaab674af0b2ab218e5dcbd0714215e69f8cb0860deece5c98d37a9a54b0d11c9b99c71f5aae5cb68c2214d850f0875a4f967ada7b7918cdfe9436cb2ef56c5928e5b1d92121eb3b4666f86daa7679b46525dc903a3b118608cd287fa11aae6d8165f283bba74ec8f367dc608e03f0b641a407342b921adb08b2190d9b527373345067a3bf70d001bfcf47756e56313acf0d34950f1a5a2cee0e9bad1003c00a6a5d6d8163aefbc73b04ce4fb3acf00d890a4b626e7c525e2fe023149fda2a19377167595b373496ef75d3ca658470a81d9bce8f9763c4427ad56ef7048edcabe6fc4268b6e2273148adf8058b0e9a114c823a39cbc344ac8ad2ca8f2a9276e94495afda61c6d0ce3a3a0a9ea4148410bb0f164aa557b196813f44704ebcabc6977e5fed8c7955942f7e8900bd7ff1f532e0c7cf719a26bde6bafc3f30d7222f6c601d41eb816add9ccdb5f986497106239271c277b1548af735b16809459a331b435ec3830982cdfb3baacd0dd379b6cbd8589f459539a3f41d64cfc415e837943ad0bdd7e4d2212e407773b4db7ff5427d5f0d464e07e7d85fe17989e6d82d0d66d3c2d3466d49394b4524769c30ff129738be9e8ea9ef38840d3bbc343e98e999c08d9dd4f7d998820b0216f2a727f772502b1cda17e1a79e54388c9b0fe5a63c1e50faaaf0a0a650443443c04c57c37ffd28ae094a8fd145b1b54c66ba00ddc327b47fd86e7ad43de6046a8216612eb247890faed25123112f67d507a427d09c03a20fa2bc6ef3dbe7d79e88f7323c83267f0182255f7f0354ddf9e2063a1a5a1bfc24fdb6ca274e75bc1fef7323d0958427bb08b6fe472465435bd5be3dbf14da55b16e0f3764fefe99ec03b805c068ad11e897302461275233e009a55e1d9de363835f1022fa62b50236d81c3b32f04f7ab51fbbfd8f8063afccf91420c6970e0472f6ab32bb7f91458d006a88f59a5d89f1a9466b81b2cf663ce002a6ba18892d85fdaa1ca4028baf77fe72051c2a1d7a9481b2eff633ff63e136be7d097d421a5e3f0c34a4fd776544584013a99a67ec7136ccb0b70eb087d72afe22b5a76554c8e93a55836a758fd0cacb7b1bb3ce678c3c474fb5718838d8a346cbacad526e32889d20b21d284c133ad905ca674a10b535f952eb91b182b7fc9598595c6f0cb230a2f980523d8f2285d5f99530d65ea0bee48769a1e3d69834b7901a65ea5ca3ba3d8fd0bfffb1073ea6f48a9a6a5eaca1c17bd723464c2549133c37e56ad80d31ed7a7c775c58bca29477e33cdb0b2353c8fee1258273d072f31049b3079f300a0a6f7e915ab2f53a67d92cf528a143b83e5d00372097944672c572ab479ed61eb883d354dfac0622c05d220b01e5dd588af9d01969319b8d7354df163d6205c9b1c682dc08f419d713c9f171c3fe56bf21854673dcdb6e11510ebffb8ab27765b4f11aea258500b865289075d6bd117e9b0eb8913ac9d514f0d0c03f4b47e5241fc1eab622bc92f0121303e6b776512e4ca4bb8cec3e13e37a005cec81248adc4e24acd80cbbe5b584e76ddb5746b692c11a7246d22b107fc1513a9a958e59260c9a92b606c2979ff7bf2b0fab7f5e9a692e35535419932f8901ec136184bca0f454beee28e917c752dd3445b60924af684b9ea6bbdfeac5fb42cdd529986e13b8cd80230ac51d5a9ecb4347c2552f15de41e7e8e48082035e0c94b9e2de1467faf643488ef27975f4c09b4f44a1bd813bdf91e9df980473dde5c25475a697c75b0af62fb18c61abcfe37b8c52b3484d019fc772cf507f8879696a448273a2617635aae46735200214f2fbbb363832d685dad004bf0148ccc202bf0d7da372aee183aa880090310c248752dff7dd82da199de9eef341268881981586253754f90cdfa4153acb689526f60d9bc1a9a0afaa373abe6ace8fbc8cb54cb9a0ecf489ed11619c4356bade89ac877eba0362dbde3541492016fba3a07974f3bcd7e583b4323386486313d208154554ad3d588d5125953e5d4eae10a4dacb7fe9ba6f37571d9b8e9f5f673a8e638e0da83add23b6072edd5478f4f86deedebc9093664d8db2405386427f60c35a0cd4ca503c3e2ea9f5cf15926ca00046438220d6c16f9777a8a972fa60071e8726857ae9505412a309cebfcbfce147948631c3497b0fef189fce76179dd915fe0d0463a616948988f1abe8c238c94fa22f61e30e18f19b2b3770580afccbb127a796dc1aa9ff542dee9767893fe4cd07f17b40002def88270b5d4fa19ed904965a9d014e6ddc4d4ab0ce4ca50abadf6182ce9eea4c0773f18e40d571f1fec0acdbca648019b9fbe21fc81e9efc15c0643a8a7f1514911e998707e13dde43e99a89041a8a1dcf289ef17d14a0dca5df4370159610b672c9aeb7b943f861bd4268a91b51b042536b840fab5770e37ba4720e7dbf727602e464f769aaca5fbade0ac67fce2b6ff8bbc639975820669120793a9d505b5ba8d9541356d93fda20a122a0038d04c0880d9c10687867455b86ed2e4420c6123d5c46b8f2527caa685263f4a589cbc51875c2b69ae8e036a666c6d8b7c0b091047b7fb2a9a96aaa9b22cbff52c99bc823ec12b37c9e721d62834f22281da5f54d9ecd1ace6813f31969f66e154bf19b13d8a15577c6e58e193e2699ba2167a9bc48497c3c4ae6bc0697fc152508b8a533fb64e8fd170d4a9b9000887076c55edaadfa8a297f2bc9987eaa4caaeca274925d6005fadf3a466aec37349cba41f65255f75ccf1feffd324708d030bb06a4bc24eb1c4a6980cea0f2224f0e3a46e259ac35627ed8f6f2194fcf0f22203dee762cd3071bd4bf1ceb4baeac4c89165f874a44194e3f1f1264e5b2115d903806a982a6fb629638297fc3c0cd32ceb05be3c18e62dc90d2d60dca2b364906941210c61d95d38ab4f777e0c9356f189ddbaf6f09aab69ce95a0fe6c559bb6bc2ef8044201518fab2b31e39885c55310878452a8c5f9ce72cd987fbb2d02c9892a938835c43d8e4ee11f520263c55e4ce49e70ae209631f1540d2360663aaeb8ac31addd93b5ae5fb790156675d02694c6ef0747c6e0e22af364595e305dc6aa54ead694e532d5eef284a4bd870e0593eb372bd3afdd66e2c342fc8daeef70c14bebcbe45586466f0c489f279ca4d7d0ab8926b9b034f7b5485f0a3864c480bc3a17fda9fca01dc1dc910cce5899cf4d00388856ab653b029aa24127bf5df43048c9f758492207a65ac45f2697cf096ba3fac3376adbe16271ca71ff48322808b8ca782d13d70fc767c84e55942bd55c0c9e7a6936f33f5423a34f8821f6605eee11297ab5715d3d28142ccf15bac303f665526e954c941f2e77bbd376ef962c4d90217d66650269ffbd346face2b3ffbc90b8e3ba927ed41e6e69e62eafcf33f9795bd4eccbfe48dfccb791abd93470659162025f37ebe5c5596322040f73378acdf70132a132b433a529a2f8f64d69ce946ee5f8bfa0b26dda11ea7ccf401e9ede1801549e702c29eb2f327c5aacc0ea3dcd357514bcb7b098a8ae4c7de666fef01b863d0b20720ef176d08753fe9838d76dc76c892218ae8a62c719131e8596fe6a4b8f1073829c8abd37b081366cab180fcdd5249f4a0477f4fe537ef3a6524f81da60b7be1b50e65680eb2c77d9d2b6d1defc1914a31301a9efdce4ca3a01474029ccd5834936e594176f3d1eb356f6bd74f0b071a49ae61e4b2952fe63ae492bcf03dd0ce6c3f3f208c81c3f2b4ec0c3d556a900bc392f475207713ff536c1cb5f869e5cddec6ed21901f155cb40f78fbddb6eedf3f3a644180aa7a45570432d6bf08315e12aa8fb846341c56d4a42f98dba7c46d6f7bffb58dfde5fa59b5bc9198dac654ca43cd100b287bde49e3f10b828f735d564d031195f4f5860a56277010f018f5dcdfef5e4eb62c61b2d361f4b30971e79d6a25e44ec9eeab6e707c3446143b03516a2b58d0077fef97ed2e4b45c03e46b7d16f8b8d9e4c4f6269ad91d2e88711e6d472e52b42cd4fc02caa661c98122be3fe997d5d7960babfa51d10a52afe1a761d5b76a11ffdb52f3dd13899cc12aa6090731f2cb7858889fdbe1ed54c961c99dbd5ee380382cae5c47e30a8871d4f54293a946119113febb04e337d6177df1c7416b713bf39fffd9afb6ffdabdff45f73ccedf0ac898d7ba5154d70ea39af47f4ba05c3853e4be2bdafcc560d463e2db5d51119f21c2354ab1cd4601e392adbc975239c6cae6aca55cccca92d43d57e68a4d209bc7b75fc7aaa67a1ff357b6e8c87febef91995194f1862d3ddc80e89c0daea54728b8663295a90683a42dae8b13d9de47b1a50bab09ee4c3cfa5b31185aba043ec121f112b3c918cc6235609c9405159d8126b72cfe2fa314543490a8e635a24cacb7a829ed577dcfcfe5136b2b3fa82620a37e4df49c6273ce670b2fb1fe5a5e74ce8d5ef99703de0e6a8db7e0136f12fd2c69ae1a6bbe5aa567e371d6304c3063cf35e321913aad8d618e00315b8aded7821b838aea43c308d89eb658e8e8244cd31fe805863e01ffb787469fe35a95bfeaa8959a0d248961c5d329974234025ccf11574880b3792bc422d5b6aa19989a9a077d0030eeefae456d50cec7525417a29c40bfcf00e69e2a088fa84f9890f8eb631c92245bda265b8fac921a36cb8ebc8b042971d775f2635b8b741b82a1552a572dbffd2a3688edfa06a3c914e6c858571146b5a808a490e8a426b9c52e60f62886209a8cb5350461caee6f11964907e0665cf417cb62744669fb79b60e1a7d4a0e263ec503a73fc7d80e40a6c5afff860790ed92eab9718e4b32f3c6f5a6a9394048ae1d6ee19f017141700fc0e80173b90ff01734f5fbe5a58a38010ab34025be9af250777d1017059ca8b5ec2ea4765bd5c3926e3de815953c0d858c21eeed2304a6f9a765b77cae1af30f972d7bf73e276b5cea48e345f492fde20d479efb83b54e21ca73c8920bbc32b62f74eb614f7d5a8a02fc4373b9a7cee56de616959aa3866755f3f430fea2a15fe5f969a3b9e6effd042c9615b1a0068980f819264a8e4e3cd371e4657b1bced70d5e612e13d900529f147ca17e63ec6de45b57d2f69aef04ae058854cb799e4fa53849c036ba27dc5a44eda10d5cf2bf39788fa4eb85e24d0a9bf35e629d78723acc5b68762b89bec5e1fcb51423b8e3682229f1b7ac8929d202ad66574cd3bed623941b3720958f779130637b0b47064decbfb979806224e155b4c653eeb20f9bfaffdb7ee4f2cb1d1e19502df052e1c9aabee3267e81755a206d89aca56ceacfcd0d5fe859a07b3535bbe398051ca272ea20fa3492d7a0c9b752822fb89f92c6914268bc85d102ef9a93902fb414e38e93d97aea2fb02f39f4bd6f7c2ab057286bd59cca6b271c96178cf52c6e610d17776e1e3c448a8b815f63226bb3702a67c2fef478fbf07dbea55ae150fdbae10855832125e925f2fc03f5a87a2756186d53a0913b892d474367c4cccccecde39ed7ab5c7d9a31ed2f82a51bd13ca7b22ac2279844f7e5127708e20203271038f002f309297929872caa1aee6c685d04f3df506aab3358e5f11d4fcbff5ff6e37937916ebc3a430e4631ee498840838a7eee1e30bc28dd64c8b1c78f1a55ef5780ffaf003cf7c1bbe8c8abe24c12b5451dd0e3ba3fd246df0ceef2009c4c2e20f1a28497d6dd96cbc1d2188ef2b4599f088cabf4f8821c14238898c736a346006da9380f83cce66a5d0e837ab96db83f43d3cb175db97af19bad28b69817d1f72fdc879d1a764d3f215072634462688831da8516b6bb3d8388a290936dda218d42c06b8986d16e13a67a36344ba796610cde63351a0dfbb2b0159d1bc2cd74f6393fa1e52fd79a513331aca42f132e49c49f4e42e312e224a76108abed1a40e70cf085020aa9018e29c2011ea0cd8bf8cb199886977169ec9c6d8985ee61bf490049917bc7f511594de1b1fc5843b8265fc41f09c03774efc6a9fea987606985912738ad7c4063da8dc4b83fbd83e07029335c6100d229ee3e9982e582246838e2c366b1e906995f6d952a10776583475f7f8963880f6f77e17a1cf21b2fd8c105645f2cb5c80e9c31da3bbaa27e8a73aaa21f11ffceb0fe7be13dd40171d9fb0d6172e8734b5fda8a8187cd3db3ef29bc05b273769d8aa4352e8b2beba32ab42653c305ee549bcf2f48067aab39bfda351db594b9ade9df7c274e83345976a2cd0a5a27651f3aa76bed81278d850f08dfcac88e6b5da187d58123657b5e40a2f0e8d42e5d357984b0c32b3aa67b3c4beef916ffa89a18fe9b9fc88a2b4ac2956baf9bc520d0268e88eb6d6558d42f62623511d2cd806c116eb1970d86d4c5d6f6d95fdf979f365389183525fe0862ddef2df7c0cc5e703c3d80feefd74edfe2912037d47a3845d3685ac715a810c0f5e83db76ec7bcb21e1ff0fab6b39058a2cf8bb28c160f27a098262676845f1fa79e1148b599f0caebf7a9f6bb12792e47095716bc7d85d60ebcc863f8332701f9c6c2d1a128aa3bf9130fd4e457e3590237c15d88ec7f751ad1baba364e69271e84af4489340942c7f7d9186deb37f564839923551e6b68d86e6be5a92fa8ccf8b1c6b659f861bf12f942834e4c31f46bc3ffd92f225971e90e6e9b915bcd36abc4c1148ee18bdaee059c1490b705567b41e5d85e9482d98cdc7ccc68de617f83d4a7835e7aab90ef560992388ddd1ed0b13e64bc4a8263b771b0a513edc02b1770c680ee66365f544e0c9a81b381ba721fd7976567b7206db6cb552d1612f403e5a263face087de46a828365a7ac25a39c19f11e919edc59711bb054e398f6a72e093fdbdabd983cbc02902498a9b9c4dfb0ed064225193518b41e4c42062e890c2853d4a7a90032300df758042f0c2b58fe21839d9c3200efd7a6734f428b1af8fe560b56cd671994658ccbcfaac0558b57c5e4604c0e608b2af516faea2ad64345523feaa616022b466848e228c75e2dad4cbcd3722d67fb21ba06476a70b8486a6be6579be61ebe746e63c037ee470f96811510f2c302512157cdb01ef4e73958fb712d800b2929e5b0bcd5d1b335eba5e80454d67da3a4e3a80e6c4ab33594715d7b5cc4e0e5d8de6c0803062c979dd756c2a7e164175a2aa90eeee00afb6e2ee5ae0aa27cf55822deef34a67170eb0093368694f100204a76f60325d34b43980ab962cea858114d0cdcbd1e6bf95347fe9678ad57ab1797ca36a869b1d8792d52986ef3cc1113db106383bbe20316b50e8253ea15db9207361b9c828ebe053fb6d60b3e3891823f07c9ec9a4ca0643d9c92675145e542a7579e6b2af212eea2a52403c5e7b15aecc10a2948723546a92659f6604b4426af1be92573dd071178e8bf691396adb98153b8fdad3d6573423c760b603fc31c34b3abff219b4906f7d90a98564e7d3ebbaea9e7746f2dda8d788e1b99406509fcb01271e41dc6393e9b32e46fe0e87f75372703eef0ff75fd45667209c82309b68e1a28477babd584c66db86578649755bd652155ea13d3e325e9a259b0179a37fd48d0da715c2c1669ccdc51c535788f83f2f8c5c50d33794f4833d0ed595b84d99737d832a96eba4f030a6f1e270fb6f9cf1cc9167f803052b6117713a452e878636cc17d3b42b85c815f469e91119359c38024cf1f6ba71c91c69fed689385793ac553d2a36d5ff5475ed63af2fb12964b0a41c427bc074103f25f9d55f630d0a45952ef5da6cad1d50d0c1c5cd545b98c650b52970ba9b376651fedce345c4e033873d910b15d678defadaaf868b5be011d9f9cf7cdee2ca39fce383c06db1da52d249a1c3fed60a20b6b5a830747c43cbbabcbc8ee57ff03d1e169f150540566ba1a6e48987323fdfff87612547e7593ebc660e43f639199f8d61e8d5cb8105aa14e989a14e1cb8f83e01d2202056ed252848c6fddeeb0d438b9e0d552b710feadf2b1657c1afa40288087f5f83d1471c50035522e856e396ce666560a561907825d1ccf4cb86ce7b72de608982d8eb093c15cb28c7c3f10ffe74c62e3eee2e19ecfdddfd062a8d39fb141191646f643ff282e9fc81374fb5ed302a2841653ca5a20f10e6f31f21a752af15fb3e4a6d2d4436b299c3c3a80341e693195ad57d5ccc3aa7eaecc05a5ad2f71db0ff434193ba027f011fe36382e186237aa197c4e3d982ba3e4de3f21e1bbb0a8077e335eed9aae398c31519045fabd5bce070da6135a824d7dc10efdba1464c4fe564e2c90e1634560e09afe52617a5d64684af44c8c3f344a8303d4b74fcddf8364353f5644334b9c9c3fca396504cdb88555d570ebbf93fb967b7a1feac663ffdf0868dac9321e388414302e4fe6d050989fd8d973a8b10e937a6f1d4872fec3543e7c19dc2ba0e4cfd19bef915c73c423a4b877d38a3eaffcf8357ad8a64a85d099c7527328d344739d816e05cbf91b4ddc59438a1c15f8f5285361f367f1e3e379710f218b06a9f567ad3af4aabb6e3ebe465a4f1c9215729721fe72c43a30cc3215d5a8a6e8f6315bde8c41d6602338c8854bb97d993acd7f86239ef1b3cea17b119afb216e2004288ce966412c7a97eb85794aea6122403cdeaae999a374e19aaf9c3bee8c69a207982cb060db0a3649d8c6144f124036b5a6d37d662942016b2e570e1d5b8182a6e39bc5000068403f0e31d024d57a37e8f4c3e13a327ec8f965c15055b0d64c2509ba48a5e1dad3fb0f0aedb5460dc8414f9aca48b61f84eadf3e5599295b39f706624fdc5af46c932a35607d24cd9a0b19906a057486273cdcdd9731af22782a0797238d8e22aa46a63332225d7a5820548945d6ea423a282ae5f971950dd60cf7f6104ccae96619698866b1ede1733d8a3b2dc5aa3a36fdf617f7ecbec50e9fef4925b7d84f5540a774b9ef282e3bef66640589647a8d2109954f87c1772b9560f227f73e068c5937b31b748be0eb45d3e502ca92c3b764b96fa2c718a1d7c09c3bf9f62efb20c0352423a2a02427604766b9c38ded44b7a27036094201884183e55065019ee31622063b40e434711344dae718aae5c98d86e59f101f43a2395e2536f7faff65e87ab55551bebaa6933e61854e93f4006a6bb2dff512184ad3a5c6ca3120bd839e64316e7cd214e863a2ea2fcc4b88084f8288b976a26095763fb3d37fbb3d8f1f48230feb5ff7aab8e6348febda8d9c406862dc346b53ebef84d797c3790e75699bed5b5c4131ae38cd4a254a0abe8e3297a1464c4d084205a449d8f70db925433586266fc65f37f58af5561cb0ae259a6ed9eab50c18f56646e95dff98dbb2bdfa4e88326361268bc762646f7c7fe5dddcf8d1bd19b2178d110f045cc336b7e3029b5cded3ad5287338c78ee1d60c5e353328544499abeac927835efee3d8f7df076df61f5ac982daa7c6c92b312d1ba5356feb63e2520a891a2ee2ab6dcbf664c558af7cff0348fa2dd97cc6644cc93ffd52ff30caa2d78e6fe912f56a78e4193e56ea2116a9036d8d66707f9f13c60d9b76b521437f82ac793f09d0227684526121b71564300fb4ed8653804ffd3cce668e0c0359ab60059114164ef249e314dfde4355996e951157de683514232b99c0b677be7965850659bea837e77861cfc7868fcfd73685c8fb7cda4b721fae5696bd74894af6987aaa8315b9781ecd19496a4e5e9e7320efbce70cd4cdec88cc58032c5151bdd46a2ed160b19527bb629dbbd4278133b65bee9562297c15b003e1c12a8b83ebe8f4822769817f478147b68a121988aa229324a4607318e249c0b4b45cb6a1d769587a440fed4a80ce563c76c0d12ae0011abfe1bdd0e286e9b5699fb3fd208b4a9cdafe20fbdb47a54f7866d710b18265da27ed5cbbfffeaad941fbedac2ebe90381b003b6f109bedbe90f131b825cf3f0c8612147e34a977e934a1d0c0e323a55cd82ca3febe318d84ca2c35dd4b40e5a680fd0ead7e2a684b78402d7136db8e548eaf359bb14503c7a4ea456f3ae4513761437e3d32cd9650cfc0d6e31b8a29bfb66cd457b6b626a73d0370955c744a1f758d2c3dda49f2759e5bde6a576daca33c7b4ebd96b1cd48e8ecab0cd812676ba3bb0a6a1afae198d48fb48cc8737c6d319befd8b39b0d4f91066c1d6c40059be19eebaef75fe7b0a046d6ebad6b24aa5cc05f00ffbf9f8ab36ef74b46712c70805b5792f6945f0897bf175fbde6c67fc42e955cd58750751c2cb36952d6ad580794e1492eddd2cfa3118ffdbcb0278fcf1ac2fb99d9174967bca8028bbf1a425dfbe4c60b5b6749d86edd7da36955a0457e64b71feb9de99fc2f8239dbed50f4e55c6e6dc3316c0b58f63f7bcd83a17b94258871a2238ec04015531a29e0cc3a9f2dc518e613d2bf747db78476ae576bf6aa211805ab06d77f523f8aa7bb69e8069dc79aea8c60b2d3bdb52f57aa2926cdbad2bc044cd148906d60484ed0e462d71217482a5b5908a15b7d2867d8c56ec7ae533ec8d38c4fd4923c53ed452e36026a67dc4434ba842fc331c24fa4b7a30efae60870c93ffb1690d194ddfacc7d4139eb3213406c4a82d817e17bd2fb8780d5734fd0eec9632c2112bbf5325f7b44bf88b55514f18e9322a836d544edb01f66d05f2f409f324708782731ea54d972ac2a35c7ffaf839376fa5a46cf46034363aa5581d0263ff43e3f4f34c1375106f9839843dc83208ebf329aa095d1a39d3aa74804e59bc2d491f51bc4aede3dff52b61cf2b0408ef30ccd36d57cb54fda1f923e698e38d5de5cc2cfb66f08205060ec0ec18d9515226e079895361b2dcccabb2e914e83d898955d047e14ace6694682003ccca38eed3ec615e8cf4856c6a1a21919d83cae8eaa01f963d158cf0d2b986516317f110ae2ce01bf5c1230db1e67184c15f91c843a177e1a78338b9b2daf3007ad62625e1c16d81648f15e208bb1524c21cfef4b8af63fb0cbe96ee5a90b8dc2bbc4c9260caed2b5c3e1b256637b20f64f9acbbae8b584ca867a99f70bf2cf0a66977b888b929948c63c9a31dfcd7fc5565b41a6c35a780fea73f0b712ebba10c25e32e9d55ff9e727d62acf0bcdc91789a4e94ebf7841b23e5f55b5b03f29dd9712a42b2a1500eff2b51b8fe8615f0407eb88e0126fff2b3e596f9880b43759392425bab361468dd389d10b6222e0af824b8a240b014327fe36019c9a3b78c24f43fa807ef627ef22b0b4b1eda7f9c71fa1c95683bf1e5d832fafc7053ae371c8ce99b8831495611e4410b4838138c2ff3a44ce8a953cd612fd224d08417d318ea7583cb7c80215e5a280fa25b7f0db341712adaf41b94f0375df21227042c3ed902ce2b8555b6015402b60b012b57b635fb6bac539cd0deb9859dbce772551f6d64843c45937768f45a3de4c038a82d07be52c6da00d26e1dc4608f725d18cf012cc422b1f5a567b2813c06ae6b86123847b26de64b1dab733f4d36530b21b1f4aa19a25dfaa65f36acae1faee15d5fd090e21657e8bd6a8ce1d591b0c8d77342563a90c6a4f70cfa948e1c526161610891ce59b0a3f87b778e35dbef6c5caaed39de7f7d2d9a24749a09d59dcb97abed1e6a2fe64ac395e975f2d8b95929c19f3c8346a4cad8bd2eb8b1d623ee511e6319bb3b89e86b0cefeac73cdaca5257a55f53925a386eb6220c493bcb5d5c5a5449a0fe08886b600f7f93404aefaa5c466f721b31d907237c4e2c93c2c0b7e8bf9512702ba855a603165e05a1abbd4392ce5eabef965319d46380a1a1afef477e4aaf9474ee757e32e2135674e25f064524d1f001b4bec2edff50348110a79c73506672d39e081396fbabc55b650eac810e3b0233e2d0822e1b85c347b0fef45708e6e38340f85de4439c9032428d5521e5aece9198b4bf62e682650b30b9e0aa6887bda4eaa0c42088bddc346e8fa9564e87582f2d280e924588275b048bb941c14de0d506e033207a91ae243a1c57ce12104ac99b9575289da67f4e868a742635fbcf68f62393e0dc4d2e6f94a354b2ff9165d72a2a8220e61c55afaf421ddadbb89fddde37df8d74e5651a2f396b16e973799b53f9522f368246bb030913fea38a980279bf697d00bb68cb9458857a3f058d9d57044fe2b46abb9c44441b139efc9c64b327baaef228f80c5c68b8962ab2f1b78757297d3d59be9c60a8378585ac714c9a257f2666fec73662c762e8c0d8dd7fbc5707a34badf999dbb082120e3b084017d637279c4c4b7ae753b30a96b4ede64630ec918a807619e486a82f87fd24fb8a840574b1105d96d85b652582eabad94aa26a16d8e19f3710e25e6826011c84ab935511ec1f05d3757e80a60f3c916d3f892d11c75fbab9cbc5edb8a11cdc8cf6c8e19bf2301daf82a26e59b93b4c05d4f708d09cd7002104a28967cebf04aca96bf5607bd8d4daea26acd75ab53b8ac5618e35066168f900ac41b7cfb40a761de45a8333f2865ba156d17d9be8b4c5cde242e9b4704901896e55dfe42ef030d15ec180f328af5eef776aab8901bda748f6efe627ee40b9216f0b31069634caa8b2eae1aba96d50288a3880832a6541a7297aa8f69c4672e86082f5dab6e322fa137a78ec422631280f08cb9f168c81b7f7a8752dc5b8a334ee3f50227fdaa7e2f84028459dd89c07734a9d765ddf70938a83c761c0ec5dacc7d636998f5ebd27c211cf9dad8264f38bc981f67b8fc9b39f7a3b9b831c39a0749dfd4adcd88f6bbee22b3dd15e4ea711d9cfa22737476f022ad8a32c12058b1eea7186f85053653e177b3ea1f43cc2d142baac00e1be3ac7a2b3f9866656f30ffeb348039729948337b81725a4813368f5d6633b2efc47ace0c6aab9db760415b6868bea032f55c28155b3506f2ebf97cf8ec62deead7699c9dd5dedc50a27cc80e1e94315f03aa917d0a654dd882a5383e6bfc0fcf92005c4b80f027e50119748f335bff67df8ca342962c0979fc583247b5786e1e9e056e7e87123d3ea7244dfde761f22e16190e394fcea4b4c61d8b57431f20d3287d7e5f427f96ef3cc31c4a9f8977c7be7c93358b2286de3250473d117fbe0f8c7151473f8361af518afc36cf515fdae93b2e3235bd91f53a937ea2a5dac8746ef970c0cd2decf479bc7eddd59dbfe2019f45f00b915d426f377b29e80c2e9ae2863a0ce675aa6bb0604702197d89ea5fa361f39370b1daff6a9b10adc71f722ce8e41d04f143f535d0de9eb9c8a63d8d714eaa0c32fe79e7a6bcc8c5d31fe2b0217ae95f5c2e14fd12731c5ab26f62000befac403d1269fa3d174910444d297fadd54c852ec41aa459834080a6ede8fac4f6e7013f584aa6e7d87f8a92e084b6a6924641e1614810d4e74b9d0cbdef320901eb188088ccf7fc33ed482c4dc2612d539d5b119b819cd43cc7a2349b0a2c0ad17cf4da007889c7675fca8822578f5bde3fe69db0f7f7a4f18243828ab6fa547df949836a6f08502b03c2f6f652bf1915d20b4c3784affc6c2914f6aebf37e37385de4f7062635a4f384c75cef5cd7aac565402f38e03742ea9dc3cd73685f1de247358600392921495c52cb8a6805fdd4c1eb515f5a206331c8a6fc342c412a25da5015e61c9d4e6c6505f41923cd75888fbfe8424eb0490a3aeb74218a8c712d6e6821f1b91cd38d633b1e58b75f34035f44d6ddd94c61fa140fb4288538c1f829df916e764981f394bd9ffcd0b8b34083a4335331d0f63f6aa71e06a475070681e81940a19cb7514396a95d69422aaeaaa0abc09e14fd86201b13d8585cca3713f51688154fdf93ec01c179ae47e7f55ee26dd8e4747634c9bf1ca73ed6cfa56547cffb678a1bbdfd4c005fac1d83e44733a7bae85db5f78ea45b073155e34a1f73f1a301cfda25fd4ce126b9b3bc90bcd81cadd1b03a500d67619e7c0a15a673f428ce863f2d0d801967b21f9557246cfc25651b9a17a2a726dc1da7767d81a563531312f91850991d311e53ac9e6357487497f679b6cd003445c84fcc5e532f3a087321a50a5da330a322bc61a833613cd92b747b35249ddcd2173e05b90ca0c55bbed58d9c2cc3e9d342d9040c98798921a15b6e7f6aef92ccbe56226801764084d46906a641b9479a3415ab5cbd647662f717aa48ae3b7bd62028e0a465e174019f8fd308c937708f5b1f9699b969b4f6cfff4d7f476c34db622124fcd38a74681214814daad9f036cae2c0911918a80ba4b5940a095fce2d39da5f1253a4fb2c82cdf282c08e53c751e81b32bec303021460e3a065d624bedea63244339456866661d666805051fc608194701ccd83808ccf076d76a15d57598b8953feff6fad1830265ae28bd07e54d8e9ffe5707c2253432c3ca161084ec48c12dc61b5979ca7c70881eab48105d76407ae5ca1a49856e38a5a50b9221e7d302b22b7cc46cf4c51587f0b154be88143a60c686eb431504fe9836097566c0c6f10177c864a97ec0955eba4d938e7e07e659e0048848bdbdaf9f0da043b47b60096947b1b6d69c1bc25bffa6ad9889396fa6a3efa24d3500191513d3eb202e18ed7582ad223ddc12f42d63b66d9cac723d5fce80fc67f7f071a3b4d81d4fa33e78c5ba1e40f6c752260bcb1076c58a0724079588e657c54d0ba1a987e326d1a6cc7a35e700dae2b7b83a8cbf59fdf29ccaa55fbfa84c51b4f713ee8bc339335852e66965d53fb68ad663650919a621f33ebab0196096ccdb8ced5f13024f3b3db5e877e8b4b42ffe250f265255cfdee596b26bd2f168d846511a59e47928773874af40cdf56c39c5d49d7b37d4b0866b19d68876be7b162f30a075a2c71d527ea15034b7608fdc779e49c295d53bac377b5978339979e682457f02df95e09029e747504a12290730a2016eabbe93e91518dede1b167f7c53580a3083b58f9e06b1e7b3ee772d499c636dafe150ebc956ca91d5052429d45b25fa62550d07b835532320a8cd49b05cebb38e6dc8df5953460dc5ac294a0ed9b130c8c3d86a0efa80aeb787e98d06ab1db6904ecae7bce164488711e637be8e0fbd7cd1cf1757f66d937d2e7e2644e1a9fadf4fde271f0bf05702e84f5e9d00a3f68cb934d1207516271b5670ce30c6c2bb41af125633dcc045f8ef7e395689230bdb4f2cc3f8417ea33b999e437b55e12dcf99d25ab1bfe48dfbe4b222565e685e9144dd81033a56229a40805a741baa0f8004450eda387c5d08ed90679447a90d59e14386a3ed53a102bc08343b8250e67af0fb9b067afa517cb39d09e4896ed9437cb9218d9b03977a3ffd4e86e5c74f476d00036eea42449c1c2f0fcc1a6ac97c8266f808084b25facff632bdc25926d21a3b0563e539d104cac347913f9b5e3dd6bb7de21b3de726c186d2704c00ed309d8bf366fdc69c2c88278dcb42e435bc72aadbe5727739da2568b99cc3aa524996d73f456c065a3995e1997776ca0a9899767e370d92ee844ccc3d05ecf2457fd2206ce6ba4700d9046d76d31d336ba8307514cf6554ac7d0e8d78a41568b2918220a3e929274b32c1c49767cdcc8b285784c8186efcb475c8affb1684d95bb35104fa0baf731bb055300c227f4a31fa8dd2b47eae7ce1bc26e15976f151608e6f923e8a11c2675582d83ce425b45e84e32fbfc403f9c6f6048ed2a4f44045fe4efb5d87da306d75470e2f475b66df94bdf2d1bbd5f3f72b64702a8e12144f0667bf2271fb7e246b24a097f94ddcd62c2e8edd3e1055408a41b3d0fe6e95019d2ee4d484b65be507b8dc8d212e74dbf42052d3f9bf91d3f58d2614bfe4dfd3dc3bd8f26cd5a5af082db2f425fb71f4e918de0351033bd5446f4325590a92e4192ecc76d77682d5daccf66cd2c8b79eadf17763bef4913b8167e1e3393a58a7714b90724e0a98169a87fef697fd0feb87e0461ee4800bdf05ba77efa02b2ba25172850572deb29a31af17c008d6de22911549c185d8a56c03e36caa2a9b10cd1b9bd795d4ecdcc0cece95b4d3d29bba1b95c15e91088eb972e9f0f5accf4c30412265f4ad794a3b37a6bd2e0e03dacc858efcf7cd42105b27f8c0edbaa6be266998c236daf9861cf8564e7a88cdbd58128cf6f34c49c4ac406c68c9df286aef0aef03e553f681bae7facbe853466adf0b1f937697016ec9997d779b5c8f5e51a4e1cf1f5cd8d0f01a13d52b52fe76746104dc2c2fb944a90b66aafa82c0869bc1a7d5dd4c95f3aed3a7ec9e050db43cae24e037cfc8d0e377b4d4cf1ac08f1362df7e5ea964fc4a3bd7cdd086c162dfc3c499e8856c8f59fb4c55fb087aa926ca288a1dc3ad6198ae02259cc1d8f0a30455f25476077d77b981e1fd664598f6fe51587da3b19f2840515b6a37508f14d48b97a3cd5eecf12d3cf34f5466aee52dafd3691d26d1c4077c676e58bd80c1ffb37ba9246ae310478c9aa6348b823670e737e7031e8a2655e2e77e66617ba6d1532ea6668bea6550c5328a1a1273316f3c1f3f9c98f422ebd66f89f9d24f7cdbc099d9b392664602b991d302a8eaee699a9871d3f79c11a7575be27f06ec66de8213cd1cdf33fdbba5c863e3e6acea5f26a7f7bca17b2163ef6206d20c08229cf20e5f3534cb06c9f26a53040ca48c3797a7d1e1b49abf026f4e929ddae02b0ab7fbf0467273e3fa9137247294bede0f62d1a58db025ea71d07c7b21bdcebfc61f075c5dcc759b17896947c3208a422fd60eaaac220e70b5d3a2f9d754ad9b75fdf70b06994181e99a7441ae9ae375f02c9f20fb414316cb93d4b35142ebf1cbe4514b99ab6a85cbc4666f12a9ca7647a3f2469bfe2b324cad38e25ba0e61b45f559800c026d79221447a651930add976921b9e5f67697d7aea135d406d82d712c7c74f853ddcaa289d0d2925103818aef1d2bbca231b9b48382e02e091f2014ee29643b2f4b459c7ae967a013b4183eddc03d7d210fa4da9cc2063c7c17131818f9e46b44f9524b0b752552da22d0f19264fffdd11f18cb8b81b2591344340233fbaf0bd409dd5d5894a25f00c91c1e58e14ad95f0e0ef7a8345236a07bfc9fb8d48e5bf0d4188a73d8d69bff34d37996cb90c7a1157a22a226be658136130807b72595d13b1f2e26e847f2a1d5843e6d16429266a64e2589865812f3483ff505c00100d91819c4263e42f23ac87669f7da923bd386f359e6d858afaec2c0f218eccd94e2a6ebc00e897b6d26adfa7cbbf5b8acf82fb74ebc4e294449acf0a5864f1f063014e96197b8b6052d5ab476e15410090c194182e6ce2ca9242d7e42cc5c8fc6d419a154626c29691bbfd320dccabf7ecb003bab2ae36e39e908406873ca1b109f19921f82c4565ab9db66049649960a85218aae6c29038fd910902829eaa0b1352727cb9d80ac3e496ad2fa8054a132541c26b6f91c4f9efcc67cd343c16df118265c81ff58572577177fd1ff3c832f9f6f7748597b021526bd89a8c9c79ebaf33f12dadfd70e294bb6fc768649a82bdd81949446a877eb19ea80a4d4cec66ffdd3ae8284c0a0c9d6a921df73c05034470482ecf3d1c2673c630fce569f4284807b77f945d48744b05ca23c5ad0aa55638af90ff6af06ff5f7883b6b56ae664879331df0879904338e9c254173aca54637090eef3aa2eecf84c55ea7c798e858933c0d64c3df655ae2e231abaa6f447c1b7252574dbfd9293fa25a18ea7579f651a127d1458716e813e9ed48b837c35a3ae04ad01be66caae6d45b570fc1787bca1556541eabe3e15a47818a7e6121180fc422c7463448ef4f4b4d74e59448b3461c3b26c1e04a592fc431f1a78c6463a4eb8129a587d7f7927d600d64bfac4eddc30b0b30ca34cfd92c2178b34e87d177e5cdcbd39f47471d6f20d50618a8e75f97bbfc6cba7d06d59d4576c4ea116a9ee062302eeec661118797ef54afeaa7c9056bd374b21da02ab685d3f628bb00cd2822d25ce180bc8b256ed6369ac16e2b1285c73b6ed316d13db8b67e7f5d493bea6c548cc7951daafc49d72c206bfa566e72d74ca07a29a7b0eaa992c0144f9e1b063db7cfadf1c06e5d21c6923014a24469b8444f787e548a2f22c672a91bec1657fee3907d3633b4db66d0f2f5dfb40fc413c5df0a9a3c2722f53f2443c4846deb0b518f8c095ae81a15c85132e74660f3a8faeab6b2dd1c1f66205144673190d5e97edea04b90160fc2b96e1c9eb10878539fb2aee7d56b4057574c46d933f5e27d86053cf0e6a3e6214615aab973136759912919f3de39b0d47b281ed58b70d167c4a9180ffc08756b2f4abdf612bb28a0fe7d39aa9676eb401393b317c979c6b0b11e9197b40386d5a4f9f33350cc59a28b0d3f21d60b5c52ca309c5c642048c8450a557377ed2655d335be11d619e8767e972a6091d48ec0213bd10f231c09204078052f66ece0a1bb22efa59a086fe49e120b3d2a6d645a71a5c249f9cd0af3f0fbec3dac03888e3286a6f4753855bd6655c729de45189fa4210c3f22dca1b344e63ecc2d8bc2fa7af903bc40fd84402815f46d91dd62a50ac654c79869fc191c5477a06067e6d828eedd5fa47248e511d4c9556197767ee20133af03d444b2d9e0531492d9b3b88f2d599addaf2d38e4429133a0bd20c06cc77452e5d21b480677f3c8df89fc443fbcf0648c0032587abf976e02f6d0055781cad4fa93d8434d6011e152ee6c16157b45c5ee788668d5382ff66d7017063089e54b302c10201e7c563602b7077254a94bba4b736e828dc8731d964fe5240588862cd7f4e8036aa73e35cac3d413e0395b89530fbee91796684a33054540654c9efea10927b6f5f7560cc80342a7644c0872f8e1e8ce3afc0adb9fca9e08f6b7ba8cdb97bc9f4ff6d72ba999b0ff817ffbf452bd1ec8e44cf309db10154c93f38fcd6e091dcf799487eb633887d3324d440eb392f6e9c2ba8e70c39bcac88d337e65228989375032aa73c3cef5f6bcff7b2f02dc6e36f5d83d9040dd4f160abf781a0b34148c4dc0209f3da3a6e0754249fa896f4e02228ae9eec802b8cac0cda01ee04253f56f26606679e25c2ce1d5dc0e371589c6c0aad5a4dc67a068c565d7e9acf79d973286e30743764c2d3ed0df3b98bad5f7717c609b888d954af23bdc1fbaf649df5abd9cba044938759cd8ce88d17bd273a09b1a703e30914d4b26f214faca661343cf2e508e86f0fda0a5befe5dcea13a0369e967e32f15a67b7d988f7951dc955f6e1d31e2b4054b0298dc39a09e5d26eb66a18b01f79b5766a519ef36abb971fd1141e9219cffa2fec4e9f0dcaebbee322b36e3c10478264eeb728758f50e483abd48260dd8f131cdcba0e8b0b23cfca4e8fa6c832c065e80f84762ce82d03b82f251127810e3737bed9fae1e45db21ab8f77221ec62ff78c7bae44cfe95a7426b72570c8172585803918b83afb09da90ab68bc2f909a0cf8761832ed89c5a89fb6db01ef3543bde7a7c52e1c72664a8ee75d7e6294e884db6aad0a666bb49f7385a9f6c35dd7737c11f5427d5f2a524c1116728f98b529d665003135d3a1af01f809a7c801b5e6654703fe9eaaf48b9f8f3c617a5df3f0a59ad2c780d9d637c655c536afe3a623d157181c1e2a4db8c793d3bc852fb35a8fde7e8837b01ec9cc5f4070504eaa6ac751ee1ed856315548e0c9783c35420b5747b37d4fa0442c38ca8f4ce86feb7146c15d2fa5236f1d6c050c197ea3246837f1c69b286f4791f6aaa7e6982a8cda194c736f7132b817ac465011f00647e864ae319cf6ac3ccc445b99d0c12744d36dccd3f36ffddf76e38e215d6a155cf36eaa2c15a764d39f4daeddfa241a8a3e1029e25fbf39603fc47b03bd3863d264488c90482c968062d68b5cc5a08c859baa60766d7254e4c6359f9c8adb83aea40a6253f713825c79a759ef8909265647b518bd30a1c6714c34d6f7a25eddbaf50ed3d497bb7f2e2427073ce534105f5ea4e5244390db5a16f97e3acc91f842c00a93e0f524a4f38070ac791d573280dee035da7e40ccbdad256ca89edb8727652994b7c3b95ad2d1a4d8b4209023aafdd8ed4e4e051c34fe175166aac20557228d5c59b1d8b25756c474e6eddf6853b329a47378c0af6e5549e6970a76510283ddfa76a666da4e47a566807ba9a19346249a2f84bd724e564b98b66c53e093dae9bc9192f2349146e18a8418e15a25697983e67dcd723cab2f3398cb8dc8f87ce27d5bfc3e976d492a6fdbff72e8a35b3b9efcbb2280c3b25c4223392e90876c0f2f891c2b2488652ceeec7245dd28afe05408049fb48d5c8dc1baf0fb87603c23b4aedb04ddbcca3c536a73b48b50f5c89f1f356ee011ccc6036cc4281e2e9f460948c2ba27bc4e77a65099e894034b0a6f10d2e78f86467adeef7a3333e67030272d55a0364362e430ecf51f699d4a4d66aaffa696852a8649bb8ea00910ae64d8fcbf7f35636654616345c4ae132c0c5224ba81b045a906104fd78e46edb91bc50e41bc299c06846b2b1af6dc104003b548467a06188c847ecc1db87ba7305ddcfd006a2949cd02ab5f9c97b72cb4019edb6c3f526762c953f109b9121e623d2d7bde7d65d0bb3582eb91cae9f957a5ef4f33cec8a543092ad8b52d4dbc25e35d44d569c3340e29e5fc4cdf64fbf778aedcc02fea2064ce664db9d4cc5c613d8ba895d46c7826b0427e1e72dc241b69a9d20b63239de31d637cd77a86c8742ca095fc5cc88089d6d3ccf7437e416f1ac6507255ce2c2317185d6ee9c8bc84eda8ed8de8299f3f475275ab63bf363cd0eb3f1794967bcc23686b715f579404e87f8de1a883054215d40e999884f2be524709fd4e7f04ed8705c551ca54e7755a97c845fa415f6aa0c3cf3ce54c5a07456aba5f5a1cb10756398d33bf789f7156bdcdb1514a03ea7c9c8c3531994111fdc57a346c58180ec2cf1538b8792e8d29f5419871d3d59f097851fae6be7db0e7a669361ceb28721915f67c535de021bab90ec2a7b4c27986ac1bb17f20e09cefc321f619435342addc840f1a2c34bcb3a8ac1c616fd629f639870dce457166d789659225b9f8c570b71e9936be168d86ddf31b4c810a5b4302bf4af4c93b64fce471fa3b09a33c385ccf2afb8d51afffe18b1adc54ae1181bd32f2d102b4a8ad096dbf78123694e86d394e485534e2f06520b182a15f79d3eebd369ac39ec0278a29b5c49531f1d8b420cb438200e2e7363d3101dce55ceb5723be258137b0232e153cc20a775c820500c85a3a5a9c309b8eefcfc63bdc96930b64fe016b18bbc37e3237eaca0ffd610f11dc472f388c252acb9efbb1721284e93db125db471c45ca9588923e4b81d5a1dad9845070142ea3ff1b7367238e4fbe24d7ebbfd473a3744753de7e041b0eef2d0b4605e7e4e349e1191a838f5356bb6cf2ee8bd6987f01c7aa26e26047b548c3fedbe7690fcfed9ba40a6296b6027be0ffa5bb78f60d91691ac7dd24605d8d5a38ca33570f8dbcb829c575143b741d7ed213a3a30f0b5eddb3f8c63d6787ceda9f695aadc80de85889e56e3c42be1f8b226ac3bd26f5cbe89ba1a3bcdd8279f5d6776ce629204d9317cbd451d4e22f617ec35d0d056eb0cdd7f947289b7b1693dd26103998e6e6ec60fadf339a196f701fa93821039111dad2ab2c862f87f2c3039252aea8a1424e2b611c6393a941eb9d94563e450e001931c9179e82939b3c66fef73c6021492bd2cc28b31b018a0c40c8c68302e1b46951c9f1e59d41f2903ac58a5bb5d191acf4fb24157d9b1a6ae96125896801102a712c209302034d0d72adee3d857545202fee17ddf98730049c9dc02e4f4ceed943d01be839e050350306f8f1ede60126c6a708057f040b483aa09b2a406bb45c3d5dd0bb6c000d8c51481f85a0c4a523cca4bb4aa6fc740ffbfe5b10c6da00dba80b42bbdf60b0c601e486f1b1402e5fd12b6a69a807fba430927ccaf7c87403edc05b246e891daa4b2e16de07ddfc243c87a42b402e298afdcd00079488f9bc20e23a70e023b9d47b48bc98b5bb8a16b1e60ad888c6942d2469ac5b8757258bad6bf856368257c5a5dc8661f49cae61150b0b39268fb7cc3b61a795385a08255fb099c2463bcfc49bb94aa11037604648cd2cd2fef21b91d1d3d2de5f8baf67472db169abe60556de86fce1edbda78c76bb7d0f2ef93f18e2a436bd4c4c0c596181d136e2bda6315bc771d5ce5485b34772863600a73e356d7f14c83222631fa3cb97d43b72d82cbbe586cef895865a96817190383b7dc4ec65b279a36e491aba9013182354c9a4d11684103cefd30e611610b0508bca92a5c4a4b6ea86b2526ecb091df716eb0df9329ec1f0f35343394414a224ebe988036538670dcd39aa2686dca96286182eb3dc56455c80de1ace12aec972e17552aee532cfb59425e1fcaee4536023ba27f8260a07bd6c03fae04c89bc93bcb8624b53bc25f4c867f6fdbaae9d584738190e151483882b959d6925ba4ff9118ca247e714cdad99e8b1b2c5237ddbce8b0547efcee22d808fd5d3017b084efa79d786f0442250e4440f6d7347fbf38fb8cc171a8ae03800e8669cc76e2bc95c290c503ce7db8968591ffe0d5cfd31dec544f091e392f4ffcc1488cf638ca4973ab0f42150f4146d553c88d3d04a8fbf46c1620bf35663892a51fd521c173fe2d7a010e94af43dcaae4eeb22734f1d38243bcdd80a2dc10b6dadb4f1916a52810dbb3760051057e0076530d1d813da8f10c1dd087d80c634f507c5df720a1fe251055b14b47ed38fdb551263775e43a81a0e9ff367913fd0bdf076a265d0df0bd0b6e8b8ffa60df311e79a15f4e3fb7b50628fe58e7c0baab5faf96d1c2cb797c6aa6b2f16ebeccd28c0a3381755961d3d104cfb52f292ecd4ef2912a2a6e4c688dce72ed6fbb70d6689afe8f8358dee94107b70cc0ceec115ffa13dd1bca9b587f5c9d78d8a82a8e28149eb19561370a036a31449a85ad9f0e1f5afae84b614ac303f3690f8ed0b77ecef43a8f59ed2e4bbc09f8211745bf15c5f3fe6d8526a98f2487ccabd209ab81da88af6c334cc5dff544cf5bb3231db535d283dbcb9f06e1ea5775e77a9cea9988cbae1aa0a435011e00df53e83f63360e5dd958ee0a317a9d622e10703e8d29ec44dd042fc716c68c0f0477feab7e813a571cad7f94eb946a1b7fec6ba3f20f60f2fd898b2d130bfc535e89964dda65f2fbd1c750b14a8ea2a2029a55925c4b7a6a3ead4bb15f6eff7f256f33d0fb29cda87fb2b2cc1837d5e97e4f10aa2cd0f7da38754b3e735444527859adc8b6b4e411d9398441816f7fb37a1c50061e68c8bd5488cc3d517079eb53db4c6db52ca12d53153b581c296cb9ec75dd73f9cf66fa5d955b1aa549bc10bb0a1e3bde04dd4213b16668b6578bb9924c03960acc7c5a812cdf286e84bc93f2562bb36771bb0fb6fdf9d45437714d79ffea3f5dafedec36b1abc2bfa6b8ab69caee16eb6d0952ebf156ca7b6c0f0df3b11ac33ae50661c5b72b2d71b02aa0f90fc439d4a96109f3cf2f9bb4f8d1f47067c3508143b0591c17ff012304dbd3d137fbb90e2d975312a0ef7ee9f6d4235cc5c6fafc5e1ce9cf1bd04522438962d119f1712c8329d163d3a3c5c4e1e0be6f129141a9001a7505ef3463378a88fdb28bc56c922ddfefa4034862189011756c3f5add810b50021e36dd844b978280677dbaad75fa126839866bb4df1fce0b6bea1d94ae7084512983b58d52ce794b76944a68c76b78d17b47307f29c8783ba80e623df818cd05f3953f103454465afd51c6779ab012ea0395eff9ea51482a8b763dde3071de270848336078dd4d3ac1b5f1a42b9be4e396fdc796a72ac9da09de17d4d4200c078d3a29b878eb033155068471dabeb4156588ee21ada773833af3d5d1e2062fd11e26ff1d33fb0650ad9624484d6f79896c7ada37dba8b9753a7855216ac247e4c29b985712a7599780f3c53f1a769d09fa45597cfc49d47d2f4027b571be52a9e41f407ba7633cf104c3e2abcd0492ae5ee499b852092ec3942dd28d205349b53efd054e40dbd2c793e0d209fb1f0d2261f21decc44d20e7aff76bfad3374604f6bdcc71a2e9d2211e33dfa672fb6757ec2d0f7fed48cc4082bdb203ad16ee2446ac6114ff743347882be8c609e67b9fa2adc736b9a53164a854652e300158d5b75bb8d9bd4e21aa3e1d89861cf89c97e16d2c89c6ca66431f9efc178cbedcfd6c006cd8fc1932b1efd329e14d21eaaec8e0e23e3a03dc208a00992ac4442706f40cf8d84ca18f509aeda206424f0d0d8fd15afef72e31f761b89adcd3d23e967b5f82e46959421a079daac51b5b7c240b2de904461a8e33aff7e8afc67cce577363f2860a8f3e169b125fec00cf6ec8c6adaacdbd0e6f551094f82cb5c9e2a86a952361f0befc29a62d18be50b99d82680ac9f2184c68cbca51054af05a2dd905552b7da95a91049b69897784a5e9e42c095eff2d2c30b3b34067379d14f1af56df58830d53c5a9e0e8ddf8f0153316a22b6de139c44fdf5fa48a785458455e545323d0d6f3816b5a2afeb5f09e0d56f8b325cea1d8b2e3c4247928c05249ee2f78c2343464ed0caea3473669b2cc19b48457608e90bfa3a58148d250f867fe1fe2fcf65b7ef76446f38a31c20b0bdf4fa7887c677da2bb3ec6de10f68f314f06c334f30c504eee35cf20ad6591cf617b30aefac816446faca19d0b5dc1c57664a709af6c438dd4ab69679c62a1cc626384acec2db774e7549e874351497f893407b170caab23bd5dddda4876595920206a9a1ef753905c5765f7b8ada2aa403725a7bd2dad172d7d1ec689149ea6917f4681578081b327fcb433c8843ed706ddf9c4c4c634387a953d47a41fe1c07060ab53d27597b3e94704c3d9eb03d52981256986eccfd34514e320109dbc8ec3a37a5905c66456f1ed21165410b5ee766fd740485f80d26305fa8e271770b5c78d1a39cb2ac9a8d1cc0856f4e61832229c2c63a5f62afb7e93f6af5182af116981c76261b4ae78ad622505a1ff3aaee2114ccd2a235c2d2a01327bb4fac6188a9b996295f4f7f0fb8763ba4b97a0cc11f30acecb566df72e52bd24ed1cd1d2cd27e9c80bb8c4cc4e1fd5a051c44b460e39f0c402d9803a7ea4eac77bb314a9605d79de9da5cebb58706f57b879fff0ec025c231c99ff2a374de4f3fa5f53da07505ac1e46e7c9b0b8d50a545de5c9a1fe8151a0d83dadad15ef97fc87d9002f7ce50cad32d915934abc3aa2983a06c68bcb2a8665443ff650b2c3c9986e595e3a3821774b5cdb989860c65c30d20082c22ecb0789a6829d4a123bcdc032fa7ec3d93bab6407594b4da206317d8edf63180ba3fe5df315617a643345edccef61a2bd9b0c22a1cd82e98d8c26cfbd77d78bbed8215f924e93d6ca6460c24840388cc55def7375c3e0c6dd43ae25939de8a61f72f0aa06c9320b9ab419a85cb0d7246f022b6e578a4f954ad641e8c1eec05f3e0eeac1bb63c748c0c386a3c1f101eafc74c2566c94c32667fe782199ecc4543c0b1eed92278a5a712574c556be908cc0eb20bbcda7a767ad14ee1be5bb5f887c66d48e954d6ddc208ccf9a108c37e41fd3293b90600a3bbbd77eafdd818ff1c45f47a9741d37780ea175d26577ee586ead4a6fcc88411a8b41a7b630e08ed614a662bca30241d7c5741ad890cbfbcfb62b377211c1a96c7ec22bb9cc25be79849e1b73819eb65268b41d992e3adc43ce5247159b2b93c824cf07b084b06ee5884826c110ec5b6787dbaa843c629ab849d4dc11bb0c1e04345ded2b8cbc238ccc90dab1c3229fec6f5cefba4fc1640f248cf9723c9d8cf7f93e96f9ecf58d2a7d4aa7393baeacb027cf1338a7035f8f3854227aba96eee59a174cfabc32d4c3a114fc7cd3de62028ed6165f4c1562aca26b7d909d9e8b2295255078d252cff730a2e0347cc57c0517128fb29fdf64c47efa21e123e6499a2dfe9cc37de9a57615a3f8cbd800881673de95d810b79b608b166fd7822c63b23e50aa0ec032a47332b8067213ecbf8033d07b9830b782e9313833ca6e8457be584986abce2f93a43b9a44a716a7894e128da5a9ebe2b5a65fecd26ea738cc07a00e8d59880ae859bdb1f31eb1b9a884dc3a2b6e6bbaf9aa80ba3403c4fdc6b8faf34bab2627fe81362acfff851555c9ce93c0a7dd27d32e5add00a6ec6db915428756a3036efc2a5f89ad18bc8dc482e92327625d19de736a48846a7738dd81d1ee95a4f1552f636953256778d7fac1789719ac0a21abb2f3da867ed9b552f888d7c1d58becc93e65480dad721d57f3999b364305d35a725fdbb5ee439e2ca54633a925ab3d08097d1c764d4028e0992324b04ac1ce4c770eaa6e07a247541b8c73a4e5b613dbc29a567671493b7fe29b468868f04ef647afdb28a89e88fe6c24796129df69010eed0f1cb4e0e925fb4299bc065ac2a9cb5eb17a644688adb8dbdcf94e4c5fb03b06ea9db874cf057bd01a3634bffd603740e97480f3f4683a94b1465d16b1f45cb9ee742d54f45aeddb20e70015c72fa9f38648b5ca7aa2dfe2df3ef12519c28c90b0df1167e4c8b7a519ad00e6d4db8c235cd79a8a980061cdfbc84a806934684cbc5f3407d39b9f3ea7a885a123db4fa28779c7f2941402352d060f065711bad37f8a3e42279927fa29f54859b97599291d28c256909e46e37d42d31c1a9821ca1dd5bc7f7ce920651ca0dde9f15adef8ff23a514173f67153482b9897e545b24dfe21dd6831c27917d90a9ec9a63a23c7a8a46cb7fb37a0e396e5101700c3c30a4b2940cf31c16f0ffa087c1c073da1f3cbd9cff35da2ece34dc32c933ae77b20d031fffc9a9b427039df11648012a551a8834d0fa3c806d1525786f9e3cc6b51e7f0f46cecf378f1efe9547b794b81421b353049312875c786acbfafc2c949811836e2e7a7a80c4a0457327b31e84094b476ed5eee127ea7c337c96a5b0585e2beb5e2c164c4cda4a8650f5219cce9ae80496388e045a6eb2b8c6a388e80771f7e452d437df89afc1b1e65d2f452851f6a65cb228e4b558559ccb7ba08df3eee0518821ae91f6217d637f95a9733844952127ddebfb67326bc3a62f3cfabf20f5138e2cb9bdf678d23e6427a8856c5abfac631d785b0453f2f01dc0f6e59a8278eaa5b3e190fd1f8f390e2e3944bc5cb0eb8a5699e8baec163d6d353f49fc491d28843ac3d5a026bbf6e4d55a85cf5e98d42f90dfa1b96560e842b3bf98c4d06cc8a83ffd39c5ccbe51caf1b617fb957aa67d22cc8c7a588beff814fa1cc3efb60dd40db99d6fab2d2e8e7f3fb27cab84df9a851c5aeaf6004877caba805d8e708abc840808c53fc52e1dcddd260a60da128c96cddc840f92a82ff0954d95e8108e99967a432df2eb85b2bc0e2ac83c6259b1a7799be056504c8560ad40054527442dc639130bc6f8e8c2dce7cfd585a50e09ad27b3bcd2c76e83cc289706b862e6ce28607bba0076cd5f0d28ec386ba26796c1207600ccf522df18e3dc8faaa25e9a7d4344a666b1b78afb28a3de352e84149933ef99d3680ee472a544562ff72528ffca66d0731e34c56315da5bf4f2801edbb65a01ee799fbb254219d5ce3eaf4496f206bf2952763db872bb527f3d1104a81d88430e66b4763a6552329fa858d27e43670c1288098639d393b3b1a98ae0be8dec0642813cec0ade6aa7c2e549d01a527015cf8d01325bfc8e6fd4d701c89a93614c811786500e85591b3424035b665e52245cc90b61145e0f47b64409a14f5de1d417e7735872943e4876bf2932aa7bcb8dccd2afea627a9c3119ffbb93f1c2815dfe997ed6e85f7b804053488f8511e160b161821e8d6efaaf5d9e81cb044e8f235504ce16c8c97999dbf3397ad6787a54672d80dc091fea5a5dd61c28848c8f2980c676470450f907a2a6cbfc3d69fca6579aa5a5d3b84a6fac18b34cb89be30a89da4ea94fb03528c17cb7f7c85d6f1b285f5eabf40406cfef922bb486f8d80c40d6d114b17fdf285e25fc861da36075d5f49fb40f072d361ad5bbbcb96d561ffce3db258a82f25467aa07801e310b655f40e885946383ab7e6fb55d6fdefea437b5248771b78643b924f365bfcbab780b2f131b362c33cb589f05f7a1a630ed194e74139d314c70cf7f294e5575cb1745fce0c01e2d856fc32dfc124fc9d53caf00aca2745f29d967f56185b0363e91b7d9bd08650733001df02dc643e22a76dea249bfcb50a7c151a8e31ce31061a0e3a755ce15b118fa8847c5ddec6e2c6db5c4c017213d497fe7f608662bf2fbc11aff9c6a395ec7fd573defa77d793c0a2299af8d96b318143c22ca2192e39d83b26be8735a8a2a10681fbf055d59885e4f0bf29e48b6727e52f68e9ec466c65d587cb72f4c45f70193b1761fbdb89b3f334b8cf7b242fcf81e17a20c899e5ee7b7bb9c919ec8a12f47dd9b76a2ff6b840c1f83bbf3d2d1573152c00ea34f2ede5feee7a2527f814d83dce577c8cd915487738107bd434028cde7dba3931fa70d6f0b149a12a7645177180091a707bde3ed41a7e368ef5d3acaab830c390930d94834805e65342327d7519892d5c703f8f71cd82db484a6f57a4b23642a1740918ce8a2b5422a70c6c76c5c684dba67961418f678dded7a61e4f167adaf4c1d1e09085bd58cb9c764b25f132bf093d7520f7aef52490e682864aedf3e1f909f02abe994549445619cd8a8b3fb54cea177d336ae0e3a86d8099c68b9848599dafde0fbdc31b1c0e9188264f0eb1e71e50cb65d43c5dd1dda819b2b83c9db48c05c26d4051b915af6eb90a96a98a175fa4b2548d585e83afef7bd0020060f326f02db60e2f0708d022946f1eaf59ac1cdcdc8b0c816b66a97bdfb5a9438107b03c8fda62790275291a6e8f9c991f94b32cc617b973b53dcf30cf06327eed55c5427cc490f9247b62aa2cd7cd64381c6d655e672dd002578144248c783409ea8744c5a9d0c0f0c2bff79af2da79d13e27c98f26d20a36e2476c545828070f8825039389b5a0ee01374473b130ed1a1a80faec24d745e233f2aa6ac8304e8448bd8e7bae6c804924805aa039a25b3463613f5ec8bb8692781df67972a39e0f7adbd89d53ddd8a2b3981dab8c1f8b4501173694c0daad3176744b6064f62f042258062b3d2d979ba27a130ba0e45717b3757bf0aa06376b43c6d9b7cbc353fec2c7622775e756da9c9ed920b245a37599083dfe7fd4e12148c3ab4867a0662b0f3bf0e67a2fee4271aed186b50af891bba1147213619cad41df608132192a137d9ad3a33ec12a1b165838523cabe2bbccf09e7d40a94bb8a0f571fe137e798cecd82477ffe390914c80ae478c4db787056bf1450b6732b8685f31080d5ef277d4d264d90e8f740ef9bbb128af8c8686d60a8c119e7b9175733252afca4e6b225a8628706b3537ea016f94fb5beff3f1a1133778597bf6ab176c75f56c81a45688856b617121945b6eb7054f63b3bb8a7482c1441242417c71ed837f728b148f4468b9de035384823a15c7c916a67ddeee25b4675d53ac9f18a45d075afdddd0b79a261e4412690017aa506cc250e08f20e8dea119d86b1a220658fca4e95d7306ee590a5056e0382a2de0b7d2a4c2b13a5b4e86b6b4ea6c0b0089e8738d6f8d24bd9a25b63a356156732234f2a46caf260a30522cefda9b07fefe3a61883d306877a0ec9398277fb59ddcce7401a5843be090c726fede981bd21eb57613d30c8add39482f1411cc303d1e75eacf1bc13e1e7c71325cf5db9ec0933eb651d03123a8a8959e6fadd2b2814a5847bcbd2e904110f7691edd0afc4c882d38cf7dbe5cc65608103132795843b745fc754694cc8da0f49aa5e50ca25a89cd2974ec6793365dd30e50004d39dcffe022cfc29c426d27564528196fce9f5af1a93ca72976a940b3ea71d5b604367c882f9b7809479e3cc67cc4f7ec2d182c88b5d68293e0d6d18dfe513fed4755f91d0d7c8a0a537a64f506b24131340a6f01378d5076864bd9700718c4397a717ac9d9c608279925f2f5e8def2f8c91ca206173355c4996e57ab221b31e9837045390d8107c18630d0ef74752ea823d2222e9afe4a6602a7be6a925ca46c28430276428144a09c60862d5471b46def71aced5097c239f112180e0eccf5bcc3acdf47f3a5441cf9495f57eed5a2570723e797bdb0615e8bf1618de92607d15d41b4775bc90916c1dd204c1b5828165b7da8441a557d1772fe0114b69ba5853d8ab162c0bb85f5d4044ecdc3f851f67c2298fe3336cc8ce9328fe318eb347dc9d73250ce9470444d67812dc7d9778d3085897f1b832418c472fc30db43548364b424e9dfca2cb65ff430de17da9ea502618c616f34de93b9944886f0d3aade65bc62b7db3f366b3b689fb519f6bd871c269e3a0080e0523038180b5d0589e2e4f5e39760376feccd7abb0ea9f2aa8673d6ebb7d6f02b10665a0e2621de9505b3da0305f7b2b5531d188c62719facabe810acd2c99a6081e32668067c837d152c41f52c9021b560efabac28a740055f7f8a5669a96d57a2b964e32d7944844468bd10abd7f1ba7353c012e1cfb686e2193d262c49fcf1c3dd002273725013f8e878c4575387678d884eeaa299a3df1e1d141326cc77d051174d081b8295cc7fda325e6dd70fe0ec09938b74e306cd0e416bcae2cfa91b65d3476cd3bd4f61694db2e91c80954b03bfa923782920db29d85ae23c83f94ebf20e8aa80198aace22f473460b1bd79f61740897586703778da4deb2565d00a64400d2c908aebdc341023715535e9e286f2d92d47b0bafb5d5238d1fcf14948562402201fc465eae86f9f7c8954a9cd408252244f6856dd735dcb0a324943bee1ac0df77e653e8e98571ad83523d01cda122e731c93cd4c5cc1dbab74d39bf85e59b940870ddc7f2176ddbd8006ebb8a8bbce8be41319157753c3ea17d1e974455046d9e255e371fa67ae276cc80cf535834d660b0954db7ef6ca380172f5d1b28bed2773c24525cd745a3f215eb11f6e90e7b75a043d4f89a1a73e3c0408eed4738b9ff21d06b7a0630a7afa07286ef6d2a0fc5888c7c17c369f2af1f19aca23b8ee43d95bd0b9bbca2f95b4101bdedcdddf4263afca7484efcbda294737babae73a78beedc78a26b3e826e3933f4143af41f2843123f1c1bf5eb28ffbb744b2aaf742a67dbdaf3a8cf3a278680d12d7d6eecd506e69531487e2fb9ccb8e532e3faad603d903a8eeb342e9a287ff30c76a45efb0877209e35149903d4852c586651cfe26a8f8bf3b294b1a58858a75bd91282a82f031941eb23db03eb64814b5290f999a11589a85be9478473d95a681f1c99dc4646d8e40e0338aa96209fa12f2e5fa14c3c4e0096aac30a38824db39e702634fb937d4a40980f93b555ca4984e73ba6aac6f8fa366737ac7063681dc8d540a621c17d592770980dd128b49a4ba812f5655340e88af2e00c1f8bcbc794aefbbce1a5ab10de91c0ca5a6ee2181e5d31f9c76fa214afb8424750a399f7e326e8c322f33e81b1a928d6ecd5a236b0071b4b93cc2322b222654c77ce89f58f6311b9bdc2efe95a78c87377b55f319e95789928c829bf01d45bbf51a076f81acc4a74e98f6265cf1a66891101579b462c2ccce7f3db8cfa942bb902e5996eaf92daa31dce28413bee7e88a86e1ea86bc6ee24bf6c98892cb2a92f65bec0eb408c2dc852977803704b3967da485950c1db4a46ef914c95f3231144301c58378f384e61e997f41916afa61824179d40e4cda1ec7309ab5d3d520787c2712fe61609d3cb7cdc0e418c4706204d109221c7c5bc48d8ed40553544d2e8c5ec0b5a4ec3e327d23443b5e277fff6e609da3b98bff4fc7326f0db4a519fe76778dc956d3d89d4dccaa7c27001f2e5085bc6cedb6cc76a172921ee3aa1e28145e40b0d4c4a87adcee9067970e3fe517ef80a05960bc8da070d7cdab901e4583e46580e264ff62831c2492eafd6aab1a8c0e4d5947dc5ed062039885bd974d56180d64ec768f37d22470728868217df6a953b164de9264884b85780cf15f39982fdf6632acc420e76335b3a0a15fc79df45ea800033e0eceeb53faa7eaa3c8f2ad1e88517b7fa3962e892a1183d88304f5c0c2fb7c2168f0115a64c4cb00509cf470070febe1e47ab40c16af3b0d305fdcf96944a9e7d66c8f70927b1f8c21001e9d8d9884163a1a7466033c967c95589371fb785cc5d65a9d0eec438c68d02d4bd48074f498fa0ec4def6d91de02111a5f73a0951db7200f719926193446b09da1eb4956666e2e2790fde8c4b0136873fc8b9b838a13371ae4c0e942e43bd97fa472ae22b05d20cbf96df92c4f57cfd5159f34cf2031620d26c6f941a9f26d01b2da953016366d3012bb5add2794f47a1c336974e6d24be2464da823388069210f84b7ced10a2af021932f5de33ad86bc6e0c2a83ed4919846d45e04bf1774662b6f70fa1b3e91ec5fe57e1aa5545a45366068f6182b261d74ca71ec5dfc3d9ee1dcd2bae04cfc9b08532e60680cd3ba4e1dbb4077cd93fb7d7d43158cea00d195a060acee6ef7f94a0ee9433b2e100d0b2429bbea9197d24ce68aba733f2dc4f23d2fc79a39d1ffe31493d17154a4e2b2f075e75f1d85fa86ed7424d30cf7e5962f55185c7f3c5873095e295a5356861b72ae8f242f4be7bd187bc3766eca3aa49ff413f8b9c873e66d4be1a61af60db782af11a280aea439f0e61dcbdf454ff716617e42f728022c4cbc49a62c526fe6e83bf01cb9859e9887b1980f9d690ef99aca980ddd9bd2f9e0e0e4c4b3f4a83e1bca3afd93e693641e47ff5a06024d18b2552c3c33925f15e4c65062acc4d7beb74cb0bc30416f61ab08367c3dbe5bc67f69f99a8be8ce6f8eb50732896c9585768aa4c14b783e4dd1b1ca3813161f4d3454124463898f9a7b15df04e5ab1b676157a7b52c0599eebb15c12af1915d3d68aa4842df015455c106d02cc2bedfd6a7974be6cf4c203a180f7e0701a0744e47d32f9a9c78cfd68e2bfcedd66deb30e9c9e5265c6740406aaa0f43a31df1946bddfe55e9a016b5d06faf7036642d1ce2880e3439e5bd8d13223d589fa8ef89d4e4abdc579ba122bed2cae91a0c2f02cff6609316d2dd5f3fa5f03c828c684f9a44dae934164504c639451669830490ddf8a6dbfb98616110c43a70f01a3b067de102b02ca4b39a8331c0e158741a0825d8681898e8d300c89cd66a9470c0c76d39e725a3346bcf0afc98e41969e4dc2c83b93010e5ad0b1cd0129c40e52bd8f5dc8ef35b3df20dcaff5191183ff381e2ba63ba0eadb49a25f38322762cc87c2f8f036263d713ea83706210321a2dd855eefe1213b7401bcb8f15ec13be96e3a0bb42dbdab19ec2a9d4bddad7be99b06184debd34ea9369e164e91944877c8b3f77e75799d198606bec338741f843ea7386e5aa927376ae16e6fa94e5631704d7b2fc2d21fedc7d67c4aef323665ed5b9aca1047b1c3ec257556b04c39f6a8411f9b0bf98763678a111197d5acf156b17c33f869084362a16d4ba79fec34f109783acf495fbd1a78df374a19965edaf2a203b5ae7318e24ea6985e03ed9859f0296281437d0b7cf3811b8684d7ede42ed652ff1b550503d4b2b6bc206cbadbaaa97cb44d6e1e2fbdfad6eea1a3ff6ba12a03a23226716a03eed96117b4718d226ab23624f1ffbec539a95e9f369b9757232cdfff5ea1d803b0f8ba88db78120f7fc9034e7306ece997fd2dd7eaa2e9868278dc2bd0c9897f617e6462df655ba9ac6739492b03dd769d4dd28d36b1fb5cc7ed80c24b4a09bf87a8a4026ecf72c9f5081d9c64981fd58b80d2938f60e45b65c4f41dbcdf104908bf0c7748d1dd627eee8410f4e38b18508eb70322a2931368196f4d7421b7d9806348a521ef1514e90706ff546dfdb29b25acadde59bd20ddfe5ee95feaeb97b5a320dcf1af552c7b37a1db710f8db2046695d7f10c3e53a950112d49263a3ae567ff9196a15a6404f19456dc2908ef3c2d946e5d0904778c627bfd2298c71f0f38fc4d8d91ffba32090bf2fec19e174a74870f5e7b5b7b5a1a15b73076c625a7d37a882966ccffa393feba5dac26a3de2d96479b0d322ac90ee651b99dc37c83ef85f6747b9e959264db97bc80e6df712c3a91d4ea068523829817ef909662379a0bd1ed915cc8549d8f282967c1c7feedaf2a4f1be13bdf17af08c44a41fa532dee9eb9c89415625fe1b04d3dc63ebdd851f26afaed7d015b827053aecca35394ebb6c7416c98035e7d8a834405b0dcca651e11caf533dcc3d1dde5233855790a0b27cba88962c34472d15f8f1364a18264bd5fe0b644be28f5f0efbe42265b33976de62003c47502137843aec390ed63a0cd7675960e853b4a3176b7b0d524a12854143fba8beae70f7068ec5775e910b6069b1dd9ad91ac3f9931622a718f1aaa7c1c655f0d52dabf2476ccaea578d26d53d506afe21ca05e95cd1778a8c330117a2d320db8ea4c5e04de4739accc396d98989823aef39878d2a88cbbf23425d08fda730bf38cbd0dfca5fadf450191e4d23e4ed7c9fd920c3034299d1f8c99abdd513de549a91d5abc9eaa90101a9be109aba2e4cf12015b94f570764fad17b3dee22f725fe9a1ed54583431067da75fcbb74dc9f362743d31661f48eb20a74964213963040105f0cdfa66b9f6d1da931abfeb8aa69a3f7fed911ac1e4b86dde3ce426add225ec7e0c74996b95601db5a288ad1008a6d3725f7483bdcca562f88f7632ea9cb08f895567f659763448980157385764f0fa9af37ba2b7b8fdb4b4e8e999e7e47c62011dde85653ac7b74a1957dddd4d5db5a4ccbfb3aff340da194e3488a702eb8c0aa8eba37092a1ec93602cea222ab0037de413c5c3a9236aa1c85e4d8222c8a90252232819563dd59bd984e79da42dd56443c224a6fed042c9a3f0ef18d20c6cbbed6775cab835b57a3e177b59b94691657f3638f34b93240d4bb422f81c45fbd03e2551e803d4119357e020280af938bfae8316a8068e6f611456fc4ac577c758c72fc100e068745d55a53e8c5e4fd9f57e1cd92d1e6b1e33d2ca0ae5084103437be13d7ef85c155a6e876fbac478e0d36bfa4a3f8e6b5f97bfd87a737ca8e2d86f52a416eb09de5ada9e44e18d3476ae5fa871d7e07ed3650b27d0c042df4682b80830698811141b0150fafa260cf2653450c32fb7aeed21e2d0caf304a9b2c429fa7b022edb219048e1a15107e02ae48d977ce2b9bd59fbaf2c9e6723e5a6d5bc3adb3dfd97e2474c70a270adbe0df1e0f178f33984d4d59594ded33ffff638e5c60d87705d23da2d245784502bb3bec450a1be4520a8c5d2d7ba745d2597859152b21f11ea15810071ce464bf9739ea4c98eb19860fcdd11fb25238f47f1c6cefaefd772a9d642e00fb1ad827422d0032c052860852a1f1d4ffd8e4d5047ffe47320a2c7395f3c01a86e1adb05279277317f59220a4502a3a667a5bb8db879f2dddbf1922b9c87e72a27df0b7360f7fbdbbe2e0afd55404ff709a2470d9910a6538c94ecccf03a1ca29498ddd1de9478e30115c1f26631f9070234fd06a6dd616ae7c8e7c1f36ccb5226a84a6b82ba1945e12b22a0031a01678608e9d30d980e25cedfacc1338f82962a673ca63127e1e6de85fd25dae4bd548f82d9fe2b21cd3210a49e4ff6b1611d46da8ee1da826774b89a5385d494941756c7c217c450dafbdc08a39f6392072a04fa2c0d8b890d2ce0343ef0d58cac2b8799efb35990e68b57d5e6a7a2a88c36ed4f05b3b5240e0cd172e7978862981eb715b43815eb50db589ca251d42e83075cfea0faa98116f8acbd71fc4bf82f5540f6d7c1d232b1d985786a07fc12f12cdd99ca8d8c0abe53f9efe2b6fff39dd25fd834e35f2dc44e7cdc42fb24a78a40affb5417aed2182987f8a1cc394870987f67e1672449b8048d5140e38fad45a1c117a066738ae946a4cafbf8a1fc4472fd73d62dd65d5e57c7fab57dceedbabc3713339e5ac8c5a650161730a12047927bd16d29985650ae9b8cddf0cc8fb329302869c2ef3e4e0b64a10b6fffb3b16ff5cb060fb271823158f1dd10f69e5744cdfa9e4caa1864c00f5604ed304e5937033dbc2b5adaa05cb39c9bdb6b7c717ff319e6b9b4eeff93e4d3286f2d8f33a07762b08cd802692118ca057fa5193db92157c55ee71c0059c2ef11e7243cfc7afa23246df155d1392eb857239910869678bd572e91b216f2e6166bedeadd5e797848f21d41eef231690eb3bed038c2c3a28402f8e944866aa2de3c3fe3e8bbd31a1cfc7b71642683d622a4b328a52c326a7b6070367c752200838d6786008c27c91f4bea51a1c73f2d0643d724e12ca20ad500bb0b06c8751c10f651784518315dc7de7a2b7df623e161d9982f92fd325d7ade74812990004559ba75ebd5c8eb7b928602e0b7cd9311e3b2d9550a086d54c856c56dca7f4a424e6d012104fdca5d19428c6af302dd5e7861e2eaac3a939fb2c901af50783fe1f94856835f9110e0652d9c05f579878b1a0bbc3607ac675bd19ad055a6c4a64a099ebc40833d2a4746a9c1e8e7a50448fedec4d357873d0ebdc4712fc3b421426f2991c85ee22e2e901661c573861d19cd01b079925c5c95698f2ddf4039f5b740c6c8655fd362ef86413fe670026c7e42de31ac43ad77821894e6682032b755a374439cc907906156067d01b190107ca70dd0e6fa70aed25bd34b6aa09ff90f228cfc1525b93d35ea5970c0966cf7798a841bafc9c16144fded6a384a26505aaac76062c934b61608d65e6d5885edb963cbebb51b5967a31f06d1337e70b0f32fd0f9255e4a72b266b4ce9091fd6a05cb85681d29b0c8507bb598ac462f2ddcb80a12a28b27b6b660d9b0addacf9927cb13194a90dca6bc4a97bb58b0d71589f8a27e57f6522a281780289340b19e580f0c4ec070fc36228baaaeefda8845d709c5b6e9f8cbac13cd0541cbf5ce637b26649c42249405b1fc8ea81bea84880ed56922c8880626164a13edb0a587605c99b0248c4bccd8bbcbbe26f8760e24b3c56d9ee696ee04d719c0e5d925a893df000cabf1a3ada28611b0b877bfed4d8f1b8e8d98de3b404db7b654507da4fbf212f8ef8ce4e5dcb3436dd76c0877211eaddc0d5cef96497bdd7e9edded2ca2e38a4941f81d39995458ab6afce481e6efd59a5db5ee1d9b61f00469dc27a9591379c94197bb36d648e56e181d75b5abd70567316c9d41c937d552e6950fd3f460f00ebd153ac29592531f3d9e59de61c0215d943ac6dbd9426d54bf2b579b23bffad7f81195c2a59deb971a2e7d8a746fe1a5d2c1b58a5151883b14d6825cca8d551337060b3f65a3e7843257b5c92288e8448069e3cea088ace57280e5b67cb5f3cb5a01961d645f1f7929c5bad61b2d9cc66a938ad908f5d47bd8372e3c3a04029ba69302a6ae4fe40a1ef089f4cd38254a728be5087feaccca78a3cb458505a24681c0cc3cf6c5cb6144b15a133b551ace765cf5d04864954ec6adf9102a6847f33246e82415a30efcc5434cc0692d2b08032c33d9cf6c37b36117db6a6c47af9f2370ce9308ac3c7d78a2d6ef6259ae29797f8a3b88ad436ba15b9700014071f68a62ef2ede33cf90a5744dd375f2b2151d029d06d8df3aaca56f34b01cb26a70d0ed26650113eafe9deebbdb4ba1e90d060747b8670958e48a10643a9da390d171c2a7d7b82012c6c45e956b79dd5c96fb42f101cb6aeb6fcf021bb960ab6f7a2c5976e0661711a0d414c41ff9cdf29eb6c22f5afcd7edf5603ec2820b424e4185fdf06a35cc844c2cb9ca488eddde5da116dbfd2e34c6c8459620cfe450fcd2d240ba90a58f5cf6bf4c7deb4de97bb48793a69f484d3518de5034a04affd0ddc5a1eb900ce691be427495f46a667dcfa34a6a8deea81fd2a14f92f262e4e7575185bf4b04015265363efc5c1649d87fd68596211d990e364b4250f030b3b6256bf1966a20ffb06e7ae388227eb5ed07e56a95a328fc0b40c8b3de6438d1d2ce9e771fe3ea73c94c7b3a2b34a5e14736201234e0bf9d5a23c277366eaf00416b6d7d3731bccb9fb1f838d91163d16306418b68ab749bbea21c89afbe7d0ffea600628e982994639b595ce6513fee8144de5d9f7f9d94ca375e931b28192e12bcc73f5a619c333ee873a3872eeb9ce154ce3c75410340905472381f0715fa5ad79122a23c4af7e13cfaa941e5862056fca2beaa44cf44dc01ff519ea841ddf8eb3c4b52e392d105913284f1f770f66baa3768b0d16b44c762824387229ab88887a0bb8f5d5ccc45c40976c7e4ad58b896122b4c0e3086f84215892a28316aa2c516b4f5d37448422195e73f43c275bffab91271b3036a2b61ca5a77cea0cb25246b588a8ac558893437e88a4c3797fcfd5f4503d460bc65e07b882e0393ad93ee65133311b252d336293f1eadb45363b869435bd02fdf7f0f089c0279a0eded423f379d44bc7bd9b49a3741f532abcf296fa13f4a62525edb5acd3319a37b52939eddf47e417f327848e9862f9e179a75691aa4a3e65759c5bd14fd838cb95759684d8a1271f71d9cc2f10e261645c3eb59e5ab22f16a1a4b7d6861da4376891318fd60092d4d139cb2215bf8ea65e4de8c8702fa70324d71524df3c18d9bef426c69e441d0ed790806698e956fb0ba93f70b21cd8e9d9794d5bd6813165e2a5559e9d619796cc9f1c713ea2e288686e901995cf5c85eb750344f0f9fbc451a8139f6113b5cfd1f2bf739cb4addc35010b3f035db4d7259e27d634890264e77c615c9bd05c20c7399c8a67beb25ffa6506808641cbf7548537afca88fdd6874be6a92375d8a704e16f22509b402dedc230535a02a048bbbe5681f7f2434a22cec1fd22a42b04dc216146b845e524059ca7ec87233f038cf920162072882501f64775e60b0bc4dbce363119934ad3973015b60f920d626da5bc019a5221797e5abc96b3b45d61288f4f0f7dba634e5c90c2e4f93ed826487eadc87500a894cc363138c16ace3ecc5aaea6c4efe4a00d4d48b80ae0fac3865359b33633300500677ce01b218964cccb1ed132b375870173cfc4b9afe5c2500150e0b2a8fc97c849afb57912501629c82fcf607b3dcb58a95050752d3807c347fed6c0f464bc3ba559cea51aa13b99eff1da0ec3717b1caa78cc041f87a3b596b5620495094fd276df52cfacceed41a73469cd2acff1d09b421a3961e9d0401f50fab76d4a05926dc0bc467afef08de8f06830a4a32b041d852ef504d7d4575f68480a0695765abcc6d123032392fcb0c4dbdb8f0b70696e474b650cf85d5a0aaece10e478dba18cddf5fc6b0ecf34a6e33bb057eedeb10ab973210df1329bb1203375e285ba09afcdc5ec04a8110f691a02bf1c4790f9428932190af4590444a51e18de5b47f687231554541f92e7584a87a811b19d49278df2d1210145843f7c679bd351453b047630e62b969903af511a17e2fe8da415f5c63a679b6b4c777898ca98af9a6d5e11f3bdafdb2223e607ee371c1d8d493943e4e4ee0925eb87bd52a22a16b5067afa0352e92dd27934275020df7457441f1af2d76c54c554dbaa782f75bf729d3970426d67009ba61bdf47490de9cd4b35462adb70fa3d90a50e2c4d37c9b28e88d4ba67a8d725e40e1339d1799278f3f38e4c5f53f8141a1c6a1028ed2301b64270d4ef938875dbc04be2eecad0d6430b74bcfde5bfbdb76fb31c708909de0cca50b039468893a10763023c53c5ad8f27c11c1789ad09ca0e394927e9e9ac80994bc02013d4f9aafda562576c5fa6c77caa637295b136f3845fd3e5a38886ef56a131ab3b74bc46a0cca1b8ffdbf6dd6a0beb7bf72fe42c60eaddefbc8d6310d77e6ff2dd16057dcc5c711d8ea1941f614a7dcaf25d58a38d2118c0e82db4caf4a8f95226da2ea89ce9f88973bb491799f7acc4e279aee65d712b30caaef9ee248f0231c7f5648e2877614a15d4c2660fbc450d3ce144d2ed1d11ed488c222fd62911656bdaed039beba41a0325b4af2ae661eb0861b631d93a3085e6ddb8d3c851e4e4655009be29d7b14b3ca49e6b52eb027aa0f2ef398ab32accd390454b63d460a9a6b44d3ded2929cac8b1ecaed46b512db57e4b5c6c2e0065a32b826414a5527b510fe3663e11de9cadbb3d2992fd62ce21c12197ff1ba6529d53e9d02f00d6c867dcc9f94e8c974e908f40ea904fe6fbe07cc4ea0806b27582e84df4e8ddc61c495a2c6171db45b74b5ba53a780d0a0c925438b97a4e5e9354ae75190084077122e538d962833c7df01be0e9fcf7c22a008114ce7eba794add3999362add4fc4fcb0da9af097b6ce035235b274ce89baad065f5aa485744f9d267f3beb17fdaf76f2472efeb67b9a03f23a3603f7cb14614e502fe975ff8830a8bf995c0f8fc97c9977220ac7cce603c4c88f7b2b89b233216bc8e5e8630e6cff4555aafa87785eaa40f6babe746f70da49d8d2dc558da8351658b8b5e87a8e60202a7e2e506c3154ace68f4f9ef1ee43617c199d3789be9666af8b86c12317a5ccd208647be66dcf7d7450d969ecf1b770f6640bc08ee3f96bbecf04ab17d7a7050a51234c841341cbd584774fd8616c1297cdb2f46c6e5dc94cde1f01751aff583d70dba8cb8479037872b25003048ef60330461e59e565031d2cf0c4dec7e0d7634712b369031ae771df515105cc1515b8fd7c55555a7e72022bdf5a443c775589985c3b29b91b53ea14587fe29febe91243a50c356aa94cbb8506848bc63424d59af4e1bb03943f8c603da9f177ef7cf4df8f167d4bfd6daddf1e6aac54f75088ae78c7133c1b34078f09b372f13b63d4d2a94b44ec3129e2af66893ba40b0b2328bc14ce973b856a8c7c87fb25809c53348043a5f244733f5ab3d55b8bac04196371432185a8942c36dbfb44b708ef1a79c24aada988a7f89938faf1b20e7a7d2c6c7e6cbf3ec8f9e59e204d158382038e707363640a0b1b12449135c3f932ccfb20bf2dedc19654d17e5a86eb659b896b11bff64a27df7e5b50d4212ddcfec3351f71649422dd4b4f0cb83d0a8b7a41f8c24d0de91d411f0d3bdbf6ee0cfac8996b3219981b15daa6fca07b779124bb8009ecdf0a733876f8cbb83a74bc9963173f8e2e68f96910c85eea999b255bcb87a2a97517a99f4e3cad4af5da03ff979ef37b47eb65e0b60a4c2bdbf8661c93be597b9dad8aae64f38feb5a4241f325f154dacbc5e707f81bcc044cfeb4243e9f836fee4e135129f7f997fede41737f22494355a919fc2ce387b25d0b7ca1e82971ac8e85b6c051c683171f3f14ed5045816be787e2bf7bb33898a158bd3e29590fdbb724f25b654b55a7b5749d0bda6665725bf479314a08b16627b050467d003cbf62219a66955509a1163983619537436389c708d1a563b8e269d56fee681dc3844ad8cadaa01680edd82ac99e865252907ad9008949fdf33f8afd8861ab5a5e1e8ac7bbfcdd4f2aac423016b6b65dc4cc79912332e892c81c6f686e9602b304bc8c5cb8784c9a4d002f5e1418e3ef2957944862af74c21670cfcd5bdafbeddcb29adbce14a6ffb6a598d8a1440abbba5d80895232fe1b27079129be4308d12e448e3beae5f986bd84b0851612a758a1975674366b96e71e230f6b57dded46a436f379f399057ccdb05174dba4bfd9b6f59f575871782444c9919f96ad3f55e6d7c4d0ab6fb5b7dcd4202072739a587729eb64697e220e5197cceaaf200c038d32a6aac815354fc178907d35345f7f969fb736217013d25bda6e9e8c4e5476e5ce61fb3be6dbd9925ad9979763970c0d250619fe1b9c763219b858fab05563ace49d95cf2f2a89bf5f16c7a2fc66b565e9d4297e279254c84b789c6ff7b875b9de120e90a975b8227dc919466ab6098d7555d71afe468cf1277c4eb0c06767d90bf531aff2bebd5415e30d350c759befe37b23ade427da72d40c0c9149b5743cec8705212d9ab88a3bed0c0e7076f0102dfb23f2049d65b533c519e165baa960d45c4221541ebd8684461811389ed02c100363a4e30d5b37af9308321b54884baceb3466b3567eabd7ffec8f6222e1ecc2943f598f424bed8e3de86af2dbe6cfa6e2ab64b4a80af87301382ef6b5bbd1cfa1d93db41906f9de01bb53705e2703c80eb76be411306779ba4f90f27d863e06bb4ae68e096b8983fd820343ea6086ccd35a4359120ad427ebd8b8bbad3d9a2bcef47ef25ae751775979c5cf68deffd8cafbc1369560aeffa76ffa22b5b43393096877df79ae5703cc3015eea959abc49f36b2ad148388c17b87cfc2afce9b8cb47a6ad390dda5c04112cbfc85a7597b593474affca76843ef2b2a01d9215403a6eeda0e00698b4c2bf0bf3e2e0635d7afb909baee027d055599a0f8fc6e571d9055e708794229ea68190e4154f10af9a384a5ccde02975942c77cf0b164a6ae8719c714916f592605615f0f2c6dfaa8c40ecbddfd5f27c99f9c09e81f78c9b43adf8bb3d6ae6f6f8e67a0e3ac29d15222f3305b07d50408032376472aee5277f9447521a5019b6a209d2802615fa7b17e4980da4b3214cb8661773a099bb873bdf08ed582cd42c6c033bd9dfd08fd6165c914dce9ba25a5159b4a407a3cf36d0c4b6eb96ffc4c13c973e39fa8d9ebf61cb4c387e07a484c541084fec3ec9456b725665b16014a73c3571bb051e8038ec7c7854c2f2020dc70d7cd4355a36a182d6364d2740df0eeb20a86104e955252d9e9f29314d43a2af1af98e56fce75cc6d28236d09488ff921efba90dd71236709738d18b83f87ef9b42cc1f810ac54010c8ffbdb53daf4c0bb7e72e181fb9a24e237cbf149b3e6b476271c9281e353f6105bc31765ad8a08eb6de896e249c8672f418f0fff38de551a6609a878eb8bfb83c5735b42ff4f9e54ddc4e862240da5ea2e31b1652870108a6492cceb6300fe1af1b169c8fe213fe47ec1463121981fe9476d218828b05b74c549bc58ead59a39816844e4dee1a3eb5cc536b687d458356d1fd8cfc401ae3600855ad32dff3e88f6426b80fe815d5dac585dc41936576d0bba3565e7934df782370f131450d7d8f80132ca8500af2b4904eaf68b32d05b78921cc8c907ebb6dc49bb30c91f81217db133a3c2b85b28f452c2d232eaad6e6cb4952b00d951ea942ac1ed50825d151ddb1852f33ded38a2b529229296539da0da94131434566eddb769768e41f2cb6c3b0fa50653275dbd80429c4f3cc147531c5c701460a11b8ce109224918ca05f39d57146364275f6f6a1d5139cf10797130980c514a1dc9463431dbd6c8b8feb3843e4bc7b816f1e2d866b5c03f0bf9df00eeb258eca7a92f116076eb4ac9b00244ad0c9d61abe1c4456a7b4d96e280f5ffbffbaedd66e14595b766023909b6b7c9f7d4768c9a46133647e79c87c544581b3af780cb84fcfedde7e1f80ad4e5e4f4bbc49be79d1f4cff383078a2876e0f46c0a5231881965c09f49d2f775fa0c2bcdad9a8f341b18936f8117d808b79761c16d1d7e09fa2194c6c3fa6c07918ed2da4eaf9c6afc9f811746df1e43442297023546e8a5d707f765aad71b7def07cd2f9d812cbdecbd80b4fa6e06217462e507411480d5d97fa119dc4c3170cf9979f6ec23f8658de3acc265ab1046ef299f79cb1712b3308d4059858cf9361e43007dce340d7a968a8ae6cc0f37bc87e6fb51365d98d4fd63fd535cfb1daf5aad2c383d6e336b62bcd134ee650142e046e947f78c47e19ca5c55bd688b3c3ae0f825d8236aaa5b1b745e3c4f6200b43b5fc2695e14d87ccb364209c23fbc6ab4675d80bdc18276b361c02804783692195bb9813d8aa4f2193365d4f6476d356669758355be5021bda110ffeefeb0aeee4fa04d131a1ec93435def2d1091ad3df168a6f7003fb86437e56eec32ab141fb75ef5241d16a830a23c41073d522c278dfe9f48555a7f28abe14bb4e67d0385e6acdef9ceda1ae3b73d4f51f36cdd8542b89685e92786b58b62461808364c5d3d22d3222beca4bf9b8b72c0df6e564519ffe2981f09950120ffc24668e700e5950f0a1b5ad3902809c07a3c3876d30d0da1c558b2f12e1ff1bd19d98ccaacb95598a71dee64c9c49c92abdd1e7ad2c134837a7d2feb740ec0342b6a14a610e5f778b5f53f6ee243a284544269c10b0fcc32e260d64ab4236d42f3ff06c1b93fadb9c968904f04c4f50a8fcfbdd36adc07588623a49b2d767f1df9837b874c340ac3227af827a852cc72d320d374ad470fe02570a59ddf5d1e28ddc266e559cfffbdf2430cbd01896cbfd7ff194a7a6d166f2430bbb79beeea9166433e32d24ddbc2caca84bb8f865a632650eb4ab07ac7f1c369938ade1323f98c7f77ba01a62e82de19d353a9b594f48f1092bf0316b9a432c17459d6c894104f6e977e764b98f61bfb81f397863f7df481ca935addf232540f32552d69706f5f1e5a8e49a0fb186176c24a04598fb8dcd87d6fe42ce797cabf70a87be64b4dc3a77d05e186879b7f9888bb554150893a5cdfca31e31dbd07802cd5283bff5c102f9a6968dce1a45bbc55ee0b3afe4e90c96d9736c14dd0d21fb9ac29afe1f7da669eb1c39a7a4e258e9428d354b9b96b0b63da691e980d0bdd9817039c39be7a76b870669e2340f97345bfefdb54dc47028b8217cc0ec7c58cb1d28a65953e6feeebadc96f565f0f7fed5b9cfadf6e164d73bbe4824431c264d50bde1c9745d543204df666da2630d346c00f7ab9ae5beb4548ad4d69fbbf73aa4718ac960d159fc2123c2011df92faddeb3ae48dbb6119457cfbc43e7a95d016bc837a56e9a51751c346f90a268adde92cbbee8aa2f73c5afd07a0a372713d3413deb7c82af16af222cb5d77871102b745436d3dd15fdc10234a4d0fff2d221f4662d2f367c16a1746b6758fa4d3f09fd57989a9f47733e703cb4e48b15dc95ff88089ef5f0d4bef17de5718e4a6b43c37cb0fb0639febb50c5069c2b9180acb9ad7da9c138aced83f46c17219aa3c02c35de0a81fcb04b193b5d9a95c80f193a211645222ffef92aa6dd01753a42b36e3bf412d24fd2d09df50bae1466da8d01649cd84d6a3180a2ec4d595b51b66ebebb686cd9e9d82c5daf6b5e6c48d296950d128ef947b545d85d747f5e4cebfda91c8b4529992bec356699d2ec944b39caae834b163c03f1b886fce843c4ae829fd5bd89be9f5ce7ba4e08929ee4690072a4537a8634ec34ea2d421a89bd1dce6d768231c5a172f6b76146a1b8cf0af8587fb41446a69b46127408cbeadf177203f3516c3a42b4115b49a737766fe5d546826da4cfe4a254dbfe33372fc5a0b1ff59629e0741d484dcc1d0966331d613574c5f50e7885940921c5a5421e6f377b8b2ccdb40601ecd48d6ed1609dc54f965c1bae66c02b747a152b12b630b172aa7fe0df109f2888f1fcf6159deb0587b0fbd2c3a160df0b69dabc3061d4a6d4ff20e12eec0acb728937f3dbf6b4b51eb1ceee8ff496e15fc6001bbc0a16d67afe80f99cadfd705c88309ca9180ada629ca6fe5b20d91c4320ea628d7bfd32785b4dc5eb7c7832c7fac43645312508a6309277c5a4a183c8bd8adf54bc1711fb2031c2189f8f1ccd0957794204bf2a75b372442d4a7d5eb74172929e73f63e83642fe7d83d3016a33468719cd2207429b91c4e7bd91e93c3f6feee50ee067ba20b156410dda0bbdc7113109d10e891255f0718b1b7593517267d32b25f9292a0f5e5c16a1544f1a76c10e1e9e08bcb8c62ac28cb42a8a783c0968aadbd8834ccc8d9eac9fb6b4eb35a471f0b8727e91e1e274a5e90eec19fd9729ef17c11dcaf27c31b72a247d9f4a6665b60bafc746d708c82a4bf74be5ee5d52502facd591ea362b8ba8424b2fc9b2f148ac7257b13a11e8d594f5a8d4e6049fc0a03f527c95e70f27a2059b6fce199462e7187e879fc09dc9d6099647216c4e0f9ce74f9624080a1049c08cd3cb1b6b3f1ff0b5a59d991882089f2530a886fa564c2e4347b83aaca7a349eecc77757e5aece448b05fd3d03b32a32330b4c57e95f0fa5d3d8c6500ae99f19d2ed60029f967e6ef94c47d404dc09892dbcf4bf71a96cc19c2828cb0e89a59a2018a92f810f5caef3e204401c4ef676f39ff8f38c1caa5696fb034f29fc141bfb36d710d60e33c8801e1ff31bace462b959626b12ac1934ed8c75799480b00df6d3538c630236fff38dad887515ee2032dd559fcf3bf97779fb9df66fb942b722d03fb7285e644b344c9f812b6bd99a279e13867f2e578767827cab4c7e600792227e10b2ff890e2b121d5c13206cfc81b5e444bd3965539bc56eee9f3a39dd516e644da1b632a4cda98b52190214fca829dca9b232b03608e5844969ea76159b10f6f17833ad8aeeae911426593cb13f216dcbe1a2053e00e9d0ff51770d88e4982cb78c93ddf6a6198529c3962be83e06104c51c06079dafae98e8852920c976a3036f4d3cad94b50e79fd033a801aa503c859575ae5b8792f75f3c693303ffdf22317479925425709b83916e28a3f0ad7178d611e01177e37b03afafd06fb5fbedc0f4f061845525776038fb18a6877956697eb568750f6f2009fd1714a691c8491efcd25d05a222587c3befa1982a359945cd1ffca69650fe15a928d5a04b1738ad463d614d5a57e845c968428a6720f09363b892973fca7a169de38d329cdc94c43f07f52dc26c1b915e1707f0a5729a2d406ec6025fa21c509f40ac87dc87e7164b055ed0b24d352e7e76c616f5421adfb4d5fbd67b9fa1096c6d4fac6a28c033b720079058f456c1daae78dc21e6b7417145b85b784cd600542e2c8af271f2ae139b04fca61b9c1d82ff39108f41812242ad067243109a3fc9fe4372fe79db66f63b7159ce6b3754b847a2f0414db9b3c852afb35c268726511ec69d402aca266fa182c901dc7393e0d62547b1d52332e17a1978952e6802aafc654b8133e76cb3135c728ac89e30a0bfa43dc245a77b7f3ea5f0310f4775973d06a979a507f993e06ff9e4189d72d6d625656db4999e7f5301a4e9bf5a8b58c5c27afbf5d1b5c7c28d6c00b4d10e9e7a75ba709cd22e30d55b60a808e9294bfa2e4c7b41394099bac690ae6417622281b25717c5f55323b75c751046f2f11f1ce2e005d67f6d87058c6af989594f6e45fc8724c5f3af91e6bc623662d3b1b684d0df728de2f2e1885e5815abd9ed75da095d07b8b0508c8418b695ba3d460422dc58490fd185948851052756819142ae66e476ba206cfb12b0db323eb6a7a6ba97ecffe3729f5936c12fa7a0f67ba625c33a223b870c0037761a41a55c2db4f93577ce1c02452fa4d7d6fdd5e7b7057db3148de8770ea284a589cd6777a58e8131789a621aac57ca708055ea69398e2b3f927ef2ebc7a12d65ae9e8507309915253585e1498ec819be41fe28fcd629cbe5e756bd606f9638cb83cc73a42003112bc1cc7f4532092bb4947a1aafa6ba0bd2d74caa9e6146d3da58ceba67139eabbd95f88dd3723a5f715862627ce9fa96d198494f723f28ee9a2e4988ba8a79afbc2f0962fcc1766e10bd6d6607bbca5efbfd9e360b664ca7fb480674fa71dc1f39516568a84cda92042257273292b324c9a03468603b98f2cf97024fb54cef10c5600dda35a53834b5a9cda5bb9bf2c48450f437b50363ada797d41c9ba08c86e4e01188c1096124c1cb76fac59fa05b025bcfc47beb2bbf3ee3a3917c324e7cebab880e97f720f4a3c48440eba2d2cc6293d1ae31962b3b145a57f95439b5ff02821cdf003fadf29ba1f18f66a76a6bc2089cb1c8055ac0cdbe96281def86eaa83e9c4fcc0dafbf5a0f1e1056335a0df2a4d9ce536b06b390db7029f018f91df778598a8dc0f466dc821534bbba4bd4899c2d366c10dd3b17108bb10f015b92b94915d4da38e1d0c1c84ba0319f1d3c44d6dfd0b96a3b1e6975daab48527cb80c2b0b4de3c2f470d2b9c3d9058a98d65cf4f7a7661e649aa7d4850d1e999a17c56bda83343702c04e9a4742aa9a48e878b8e8a1e88a0e02823056084095eb14688b06b6aebea9e202f8217b8db8b3ae8f128e902b7d37d0529496c01e0f363388a14746c5ba07937d9d49a6b04dc4dace8de9333bb9b1fdc8e9cea66a1171c7881f1345b75181e61842a890c1604c9f9bbdcea97c6bd43d881a5b150fb33f2cb18015c9e773a2e7283d14c12a697465689f451d6fb8dd00ed3d70fed105e42d791f1bab07a4c7b6dce65c1e5b3789f0cbf0be31c0763760f110ced924aef23f78a32efa8f3d9ee010642f2f009f781e6cebc309d828290a547b3b5091f26bf9e13a0566ee08cb93d0654fa229327bae145f5d6025e64353818397e5895e23dd9fa0c07474e2f7a4193a383b59747d3d9c37ac7b61d0ea07cd7aebb61583056decd6948e51e20ca1aed2e438be70dc2fccda9ff228ee329419b179586229f78ebcf46df3947609c4d004eeb3cff491cc4a5db7ef87fee710b7d92d73e491fcad3fc4a180722c85634096fb4c03787b04b0277c30a38c0c928567194ae891464f34a72ab9a8b4bb965b60e070c5245c0a36ee8b4b7011b91eea6d557a6353727364d1f1f809f71da510ebc09bcdc39797709985be617e47c8e2756b6e8fd8de8449b1fe902ce83a9ba72b44a87010cbe47a96abd321a4c80ddd74d57d5d6c7a872c170692d36fc31d26bad68eea7d815ea0046ebb93ef71d5cc06cac7a4bae13f3f511ed9102ee4008b7c14d823babe1453e594dab5987d20a9665a254837330ac972cfaa7c1254714e867823624ee3ebf82896f16b071e7d8a617e2e77ba40dd96147f6a3154b500068ce3f8d981dec8fab3e31aff97a73f3b110c2448766959e17260b4417b6ac4fce739cfd43d23e792e7cf8f523264b30fe1f2eaffc30404bc97733dda94bb0e9cac234d29c11288bd2746fa4cf492066f1c536aa27d3726855fce89f9cf5bdb4751207399a998be4998b6c92ab30be36181910a3f64e3d6e48ca9488a1cdfce2185392f3e0537a14a1685fe4aac7530bd491e3f773803a673465a48d7fd83461e871edc7f60926069eb3450857ef5276ce229b896a7503f243546e5a93d1658853f4595099b21c5dd02d10a662b06f5ca68665672c655146c984d1f3f2ddc5a2f2feb1d79049ed15968e64b3c48f9c1a51eddf855472c71ceaf0ab24c902819334f5efa452e0a6571199e00d9946e5c18feed54367768c7d1e38176c96ee0a91618bb720b9cbb963b37e0851fbc84fdef7a547cf93a11433659010f0899ed85b9f03d958a2212044ef48eedaddbf30c0dc2ddc3785ecb95445c75c40ca6f89830ef0233e2004f69de5aa69ac24f51619a75cfb33f3260b8c62ad69497e38bc36cdc6481e4154599f2772f87fe0943a2a0710b356968c203cd5fc8db5f7f73b9bf8ba5c6c578b62c9d366de081a5c96f75bd5f6056cf8b0e5d1d76b6f455e9d0f0d7623c72a15e01dbe8534eec0ad8e9c81f4afa6386e881e281eb14986f20f6bb4a682ec5d76b72a5580a21fbbc643157ce9ba807814f1b84a79fd0ea7ffc009c8884486731900f641c82ea66fb1a4d385aaa1a76c2b4e7f82a601178d8d41e1bf39df0f70c2e7b8ee55f3f9036c2e7bf0a7379b381cb038fe0fcfaf420d5bf60c1c1c03be33b37450a47d635fd5e63e3eb1d9102803b804c418bdb94b90bd03ad1d4009af0ba6d79d5498d8bcbe895dd597d7d28bf5c877970e2a2be42e5308541d054bedb3078f0d5219cb811fdc0e3ccd55580af3379acd77d07ebc466c0e0f92a1ddaf2b09ab1ea168f06a4b9380c8e087fe218da093dff7dd26a32242ade3df8bb3e4ab2ee22c5ca53bafdd2159f90dd61cd0f39e644cfdc04904158f739b0cf86151e50c815c8ebcb9297078f1917cb826b8ca73cf4d38c4d2ed56db6076a34a9642cf0c2e41811896a9f879f64c41c4dcc7c1c646c59f118986efeb6115745add6e6baa908caa83e1a1c15cafd2153745d293d41f152a9245b648812ce426022dff0686a5146535662671d07df9e35edb5c3f44bccb8ab0216733cce3fc9ce221cc588d78de2ee5d01e4bcd96325b74112b8428e46af7ccb84f9a2810ac61d6f3627127c2121d193bf2ff6f2e7a34ff8b99c8915b22344ce81ff1d8ba4c3603a657a58d1f47538cc2af2a91187f625df652da12c5462cc7998e37a339ced817df603ba578091f178f8ffb6ed5b6f6d09838cc34eb3fcc0901b556a6acde50aa12f0122ecb8356e9267cf1f0d6c216d0bc52f6210a344aed47ed9436a7dd7047a1a4ec1c425fa65cbc6ed35af28c4cd5f899a4a6e974f9e886d525a93b20171db2ba0ef1f06a5d087f91935399b62396e36ad5efc94d90a92a63fb4de3ddf05fc0f0742db0c0f91a1920ff2d094886eb882225d018595720dedb25842b6783ba52eebd3043207d662f86722c4951291a6746548754e020d65a4b69cff257b7acdee294d1676ab997cbaeb9e05bbfb168c6ff728b23019d460d65b9de8d38769c92d165c5353c68444dff55986b971b4db410464f715abb97beed738bf9d0ba520b3e1e7de0abb8009796eb51329e59d297a51276176743470948825fa461bb6a1bf33c78ce6b87c10a49603ea4eafeb996513c5d5d6dea91f790472489029c5cc9f84d329d503c08a1420bb09d0cc2e8001717d0c08d31dd0562e5785c1e9f2e5269c7cbdde9280f6439a60add8da26dcca0e56050e15ffeedb3b2c0fc22c8b3d75ead34304d49de644ca04d017182f0e4b73177a48a36feb40ec4b530d944bce4bc1d8df300b9ea5003f73a9c08f8e313e3ca4cd019185caf388853243828b01bda7736b90d2913d60cda263fbb760d21d6836f652f6d4e1cafbcaccc39ddf6ab8f8bb14dd470f33b389a615d9011a5e5a427f4411e391bb47277e1048098a3ebacf75c9ae1e5081fb83e89c0255d9819b795ac8572fc1811b4ae0c69dc0297982a9021eefebee8e7511fefe9c66bde914f06d6364bfde0eacdc3c874043322a22ff235362237aa6ee122f4c8df1da2f1c24d3c616110d5b3da7d7750832be215872119bb7cbf6931d9b4477c5b31a3019371dcf33fe776a707aaefe9a97fecca2107cf169f667d352e4b93bee47de5ecaab24e66d35743f9a23e4b67bd2f6976a3227487480fd6c4001e00b18f429aa51dccb08c01017ff48b15e91fda35df1f9128d4fcc17bd23c08c12fa3cfc47a0e96c60f44e915f954259d0ac4ec5fafc918f31db4208970bbbf68945473caf049c2bca92889fe253ffcd5238fdb9be1696225443329545f4cc303c0631211910040bc18025ff398c71a3765342930554fbd435b4557869897180f1ed11415628b5cae6f54e068d3302d25542cfc77e3fa5e2a367d6128975cec81357eaa012d45699252e1f68c9e65779db5e06ce0355ec3d3b8d59c11679e1f5e0e538c853babc2d41dafa7067a9dbcad78900b7c74ad3db02ae05a4408989fa43334f91f8750db2cb5714665a761f7539e6654fa76c8cd4a45d4b22706405e9da4d8ee07ac34564214a27f7616691531c616780f016d7d1f04b08410d5bba6ff1653703293a264b0036307747d0a87c4bab30e8a4cd356d4051991610bcecda9f0917a36d29c7c9e82820d73e6cc963884e390dc2c6dbb49ce7128c5588edf4255866069a766d4e71d59b63e0820817f872d6e864671193659676b19cfd6b4fb6b00bbade72c4f05c732a7b32a52291effe756348b4c6a208156e961c1069eb6fc50149c199e0a59e2c4c76737fc57ffae7e6dae86121b52354f15b94fc87f3fe2339d27d954131e4bd345eaf5d73dffb23cfb2eee4ebb62f6f41d9ff7842bfa9a5977cd2d9c8f6567ca7264e3d884a0c3cc6e3f0f591354e15361c258d5295d11c4168a3506b302da3cd3774422a0a8bc36127a1419e5cc12935c849f889052fde9d186f87896b5abeeb102fad63bd4381ec04f320ab979718b0dcb64d359e36695daf3e3ebfd3a053a442ab761c0e93785a9d9ad449c72a37504953afc9fea0830b08121081643f0ae9c1d64ac627f3ccce284dd908f891d4d68e0467ac093274197ffac7348f56b6495d21741562f48d4f277f683880dc81339769bf0f7004ffcdf9f8872e438dc1917b584a1b5a4b675ddcad3d56361683891a43bdd1a7e2309a240a4ef8b9d0c6384d315cb1a14dd77d065038e7574e827bfdcc52fd071d84357d0e5d41faf06ae3593f7b812a4ff81fc8627dcb788d87f6d9170b64df428c421ad9a82c3c5ec9db910c655a6c7259d28985c339ab7ed6af22aa2126f86fd543cbbd5978423cf1029772ebfb669a6edb84a5c57763627da1b22360ece173522bea0237c7f564eb66f695f0028de0c01b854f1fd93b61d3a54de314e5068e3e4f4989265c0812d7a23ed70e1fcfcf7a6824f8640cda910af4da2fb1274cfa01fc74555fb906273b8866147e14780be3c071b829e0d015227df043bc284d6b71362e9e2adfab9cba6038c59fe4578f98c4f21b18d4b6c4e8a7ef2feafa54cdfc5d67e3cacb287ff3b91473c80764e02105072b724b21464e282dd3575192e408f43e13a18f53e69d8341d81228e3130023743c44dc9756541a8d2df2e9b6c6297f3035983f06c58267865d8aa3082b4f398a35c2d81c5e776b2bb9183fb33350c85aa672eb91a2eb8f52ef7c692ed6e1c47e5995411253f6f0d04920ac0e6f3aa8e47b0749a1246463a83f15191ba852e69e40afe87b381c7af9fee36375470663cf4b5d89be92322b6c28706fbeec9c15610b295f6e7694fb591d4b0c23dce9069364e5059389fdb334a348ca61addaab11bc8f21c22999af8cb5246f449612857d8bbff27da24a9dd21ce5a3179e85758143907a3a2b28aec16742924160b1b967564d4e46f32ac67a2c17b5766ee0f6f9be3a1f426765a70c0587839429e5f3e2ff406c4fb1874fedf3f694bd2cfca14f2d7df3701b02b67acd724d4341a73d8ed25d2286ea4320d14254d581f545cc2bc805c52044e7a90291a49e000d7376a802eaae84196b09e001fa07c35817a9f7fb7d85503e924c828f230dc44b09792ee168794846634d611f7d83f78c39426137e3ceaa887b9e2b4d4e0674debf98f7b72be8912334db51a2e9e36077c9c1492571a5a79d6f42d01538d73e7fe5c99d57ac5675cafcfcbaa4db754c8a8a3116e1d910c9a4650a4b35b59a1bd5915425704cac2f532ffb02237cba09757b52fe7809645eb8c9cb2b8d4992f92c5e8ea122c96bd59d5e5ade11b24efcb41e72c2815bb143a1de156dd7d32f1a7fdefaf3f36cd9a5edebe72d55e8e56e3a22a836b91050af712d49e454fde3755e49e94d4fedbd5459b39ffd0736e5e802beefb749887fb47babc9babfc5a0d4f165b8e96b06cfd26612867b6598cd93004f76b72ad49b5c12eeda6349ac0a31f01828e4de02027bbc644a90410e0fe32db31e2f82a549ec5d9eb6f894f2974552b42c7366a37bd9d34eb79f041c715b7d57614963a2228eecaa961fb2340228c0f8a53276b44795f0470f11d4c93ca69c997650c4c138c2f891b6d324dc4bc4e15177c9ce27c16cdd3690eb884752463d16ad62fded5b6255555e270985e45ada6ad6bb5efaa6e9b21f38232013d6b3f77dc610e899d72909ab8c30563ce6a1736851167b4f0cc5b8b15c189088aec5af7be4b4c32a06063f7b12946aef2a748cae137f6deb8ab6e2a0603c71ba55c16e3e946c14bc5e55b78f68dc3d81e8cbeb9b06f5419109173f3817c5d770c29469b9af5d5841845958524483ec56769ab8ba15968cdf2774d789ac5a87f25178dab9ba9be00dc433f86b5d590df35c8502bd5fc793709747d9785ed2ebe224d948007607c033559985465b6a905017de42eba2e576df9fa7c42d57a6001dbd499ff1677e596f8829e8f1e43444778625a5eb7be9fdaa5205a7d75d81cfb829e9b419c3a7fb60b5715c2eec4ed12abd6fc07bcd1975cd1c824c5bf23307821ddd37f63c29a5384e763473344984fabdae1eef9af92ebcb315522d7c0ea7c06231f634570a4a58085c8ac2b9165ab6869354395b06a9954e284d5a7dafef377cd5744471bf2e82666bd5481f186a32adeae5c8f297e5e99d9e50b412f49ad8bcb5a57254131dfd11e0a38b3039e7877401f010e21e79d33b2342dea3df12790161c3e524cbb35e8a857dfb93e8cddc29db60c8d493ebd5dd295aad74cf92bb64ad7ce3fa08dfd6a57b74b875ca06769b562c8f82b9811cfa82d586bcf0a4ce892727a0452646c9ee26d586fc48128d8e7401701fec2ac2275f6d8b24dbed5e019e1b0adec8f892aa1bf05fc41a0fff119972f7e0cef82cd93f9e7287092485077ad8ce484eae96f2205007039f110fb531c857c991a15f857b53d58a0dbf8f0dbdeae5ba91124a00c1f166bc9121c9e2b962bb831271711bd8fdb8a876a81d07b117185e48b74bc2e95c5abbbe5ab9604de777a62ec5e37b8625cf52fc5d53a684cd0acc407c07bbf242164854d6139087ecdd666fb3dcccf4f1a964d2e3945567500677bd41fe0ddb7179b2f46c782d679a398e443b887eb99375bacd082215605b0582a313b59fb3c1114f8b07a800bda745c4d1077db3dc9532d5bb6575f0a6a4c2c4eaa47957bde3e9240dcc4a7d1431506454de5641428b181a46fc4a323046201b2238be79234e7a3e288c2fba7343deda1ce60edd13ef6cdeae5cc6734636d842b320221a0881220038f1e5e87fe2594521f742738c66389ce0216642d4dbf5c60993b58e29c32872b4b344c6cd5ff6e1b03bad01d7753e797abcc806376c098dfc3e4463a6e63f32c43eaedd4e90de2da94d87f0199531dd0d82e19bce79935422ed86383e22952148d46edb88a5c0f6297cc59e67f961f84b7e3baf51c7ccb0589f55255b5413dd960021a7bab889de65fca304c8d00525b28c4f707decd2b513d2e42c40122618ed0ae5b2fe150daabe4fbd8bb1c5142789b1acf97c73b9f3b26333091193e3d1733023e64dbb8c484f79f1e4ab4ccb649386d8cde628b49ceba804214cbf1800d898de829740504c66a56395d9ce4a08624e2713d705b600eab6258e34ce126afc9fa11d0779c2ae372a732db6577c40ceac44a6d010e2c71cd48eef11690469f4da5e04af9d894dceca345052efef815fa1adee65d09b8888700ab9a310ede79b49d0fd994b4372e39dac74557e3de62971526cec6422046ffbb325f923abda23af2dc58eb15b2e01a32ebb95a270d4998560c573280b358fde8f5480cafcac1e87e56119e95f9f31f7f838194a2305a4aecc4772057394b1f69f15a4c1ccd8e9dbc20f74d2bbc7f4d75685c559d84856457c475597c070ef64b1a11709e6c96fee0d76110c48c674b8df5dbc23503a62e6d8e457420a8c785842bbe3b48dfdc77e34bd5582c4eb0b334a61a2d323d6a97cff1ed83e743bf930920ebdb5c94a31a48390ec92becdadc89d5d3808f6bb0e8b1fb703972f26cbf0ef4a7597eb49b6ead506a106d8a21cb51577e40ac5e5cd511a95bbf98b3b91cf8f6bd224cdd13bcd697bea0360897eee5ab457229d81dd42aabfb88a45fb19c8b4a71b2234fff7e706aa89325ca3c08190bf2abe459c88a7519b8d3c4f685bfe26f91a4584f0f35b614535c953e3bc862de2e198a7bc31d0c97b93d3d8f68297720922a171e9223a189f05d915c0f0717c6f255a610c0f409e76b7573226e13c5b2463366e8161f9e7fcdea9ab1016cad6e08e4959b9ae6450a8671bbce65d75c62611fbca11f1da0665570f1b5f7721b2665f023cc0fdff1e7a4fa5818292ba79f9fa43f1857587b3e773d9053118890caf9144e201991f987dbfde6bcaf5f8429ef261706b40a7728d3624edfb8ace99373baf5c0ed2f040532dfb49154d6781ec7e048e308291aca31145c25d3b34fe252a512bb771a6cdc9b9dd0a77b5f3b09ab42a3ba69e8d716c8ae2c603aed219d5c9820007736a4c4a09d5379cb66566ffd66e82d2e6acfb4ca91b8fb41628433f22ab2d4659b107526e4b90365467ab3b056fa6eae77867f69f3661e3e736089ffd882126c42e1340b6c64d77191f21393b4ef5aa1482492b5d20157c485b1a4552b32eff3cd6b64b6ada30dac818797322fc049734d36feb105d5fe14638b01229598f1851415e423cd2112d5d4d57874e5313ecabe15aa0facf69801d3156d28e4670d3bf98601004d1a57fd04afbdaee72721503e6613694abc61029ec4bfdc474fd21f39a765633be448a08ac7f2c6770c135690f083f59fe35b10d8a167da4d8146c2cbaab86314d6432ae903d23a19397ac539aea246805fb86772bb03e167c30045611c8a612b1d3936266e0f8ec40303df4c1efc67570355464c5a85a7d0529b0dc855265408d7e35451e8ccf9fe2a55d01f1e01e8479e206ef57587ed9ca1e41e75c412926a662e1768d7a3ed653cf7bce6f5e0808f31da5f07ab23d4f150f4b366b00572bb8c93a0121ffa3f8c1e1fdd529590ff7f632c7b6f7473e0d61544d36b6f1a50b8b00e277b99a5f67434e376c085e89ffc46f567a7e156ed700dd4c09eba4833a33f4d3906452e1d5472624be2fb0a5f343daa7ecc12e4f55724dcf1f2e0b1d1cc1269d7836368535de1919722e0ab38111ffebe7c181d8e760ccf11d7ca0a76aa16b0d3f5379ccf1818e89312bdd447f075376474ea7c62bea71bae454b7b53e8dc89eb8cb66c686e0cddfe4bc337f60cf50226883592b6246dce01b93647c5a729eafde931f193e2d88b499cc7c1a89e5afc7c5279f4448d1d4b9599a69d8dcf8d0df47c261529abf1acab99131f3377cbb096f32a95da0eaba52506bb9e065f1a69bc3078f8f206be2a74a930f1651593abed812dd26fc2a2cf25dcebd1a19a8f35e046ed0ed664363a7b7bf0efd00f665f3e7b3d0ed83e9bf37b21839f3e9d2f6c2b93d6392612c262984fb5e35021c37bff14228759931e3db2f385ce70c07bfe625a3bb711677a627b7f782b0785f7ca4fcd370f262d9c440de3ddb4113e528b13771553c8252319308521362e509f2d8c750e0199770130264f018201dd38d8738695ea85fea6fd88c90975e7e1354a9ab0a62542cf9ed632a84986416631a438b10d48625ac94c7a2c1f3b0bee9983daf799513e3618ae48da1d6e26141e4d9019defe63d055f8cbfaef2c1028439db430af5a6fe05481be5c87c0733f0a701425c2502a65ddca33660510a619d78e0034e72a20c731c117906cb94e82eed7932a297277b46c987eee097481bd3077bc7829fa6a4158d45504a188e1759f7a88a03d21e59dba8ce430483090850d68df7a2d77cc12e8b82b708cd5d89cd4e250c06b00c691252eba81451679d6e3515905d562073591f2a84316a77753e40ab4897464428914e588dfd758ca83c834489c9a77c5b389296187d7effe9e1cb4d141d58f4c9ade6e8d33465d6a8d9a37ea99d885a5ab536fbd9831941148762aabff9cb3172fa2ba178c03272a0009fa270b7742c9ffd4f6a28a8c1e068c524a9bf12db915ac2ea20a7a618aa174d75bafe43a473b135b82e720d756a342b98ed85b40fababf027f7a896926c33783d360951cd92b49ed34fe2b0a078b3226e4a07710a942079e48fe9c18a7a33f43dc1bf9b75a1367d6a7e528531c43325b942c3236f15301844c0ddb0fc97234efca428f022c211a8bed0c6dc2fdf6a331ddd1311a363d6c4887f7c5cbee2d71c59e3dfef1be87b30def374de0424a61cc1765f3bd239724271e35c073ab64e67feebd1bcb76f078eff1c3d7e46e1a11058a6eeca80dbdf8144806a65f2729ade296aa5a065b3a6a1d3e064126bbb26c7833d4ceeb93ff73f56f64e7416683fa4b56c5ed8615f8b37434051a3e728d01eb24b5d0ccd35ffc6fb33e085017d71978b6115ef3932cb60afe40dc0fc8e5928c04f0d60bee61dda844391bdc08c1e4016050d5151996b36ca70d1d990cc5640fded6b41933b0e7748edcb98d3bd1f7f9b3b3b2278950c4e5118525550b8377678437131cef568982f312dac62a60b93e2d5b60adb6607d4a5c64f8020f82d186b3bb0418a9db772ab265dea5721695ed982cfc712f4da304e77a085e444c4734c6d04ba16d72fbd4dbf61ee5d8b14099d0d7a88ef0b1305155c18f8f049c638433009721b44a93abbf703117abeb827944b86f62e76aff7facf689ba346823e3114fe079cd6e8bb5d7a7a86c2d02b13f11ca0774f7785ac9625082ef2cf57d6f83ce81be9b9b52eb607604bda7236bc3dfb3f10587c8b11e2f837a6e3c2c9646e0567298afe0cfae5808c9662de808b944925b7b7d1ef9a57d886c0066457d7f694286c06f45ea3dfd66c066cc6ad9ed64d33d880c0c5aaf3b70a29a1a6a72a51390fb031a316a76a995bdb3a8fff6237e20b07149ae2a4c2ec7289990ed007041410a829287c7847d50a0375b73604105c5e24504151f5770d429daba9dcae1872e6a41158703286a05c78eb6bc4580abc96c9d1600e7459420da118ccb67913bbd8ed1d80c67d9b58664004a59e148ca7b8067c05fc14c8fc224a1bab4bf951049f130acc7e9e9373adad65ee4256b8fe6e248a38e88c8a5e39067c872c12bdeeabd880d5a8c1ccfc3abd9ceb140c0a53bfe1a6154b78152c024a4a7c19c3c22bbc833566cc481c536e447ad6cce23edaa46b1db770f85265645611ab851fbdd843468e8b275771ef95c79e29f6d8f85c6b9cde89686ffaeee6c514a26256c77a63e5c38c12b194f056195e2d6cfe45f9212e54ce16d2dfc9748784035c4868261e9be213c04c3a0265d76602ce1aa24393d27434228c62dc5ca9dfbf0758b25ee457b822da6f8e9c27f4176606b3db2e44fe0f62da67665dd4c0350ca47b5dffd99d83ba6ceefd0cd35ed7ea630b5e6f6fd3c846fb2c4aac2a186f6e0d9d8cb8b0e8fa1465bb02c3f871566c09f4182c24925d06aee73712262289145077013b1a40bd48a30d1afeaf260f9e4f94715396558899dd7dd55ab0713180cfcdb54412bd092a053fe0bf507111a408bbf799ad5faf2d072a48f9e6b9913ef451f8de54c57f16927afba4525c1db756c4174261c0bd1824927cc3872601ef3556a6fbeee201077790b85e02e5878a760fc9a4fa4099d9b8c301b0efd74ef2c41dffbca0aac7c61fa532b019cb3b023792f68bcac76f3319cd36183892990c7a4ac9eb44a9a411e18b06afd053073c9209398ffba242f354100fba3b871491c05f986d8bf62cda5f830f7099e3b80f43e8b4908ddc1dc8be6161c2a7df8dd6a0ce6b6c0c0762d3f2add352a81165bc3d90c1010a54a7e70692932c9f3dbd4c69a729d5d20ee32222aebc54d0a357b36c88e0cdfa77d800647e8075dc3222b0597f8500c30614594b4e31ae3f4afec71c0eedd5f972aff07b38a8ece4d8ad9317b5bff858fa02b548dc21bae955f258c3b4e1b82ac9a7afceb6f1bdc5b686dac89a25fe35ce915fd25fbdd2e9ddc5c45dbea84879b558a37f4f3b981535afa50705bf16a2fecf09992d2232f43412e0fd096dcc2392c5e5c9fa341834358009121a5791b659aeeca07472abd6483b83744573e325473c7e926ab9a597e38cec5f94d602740f4650f616c983e39bcce94398d50f23a226f1ff86164a1f15dbb52869bea0b6dd3495429bed0adb15a3ae7ebd98c32dd3f51f53ac61c4d30026db194615620296a533449f622e11c3d68a7783d8bee81237353522d3a50b496cbcedea8e7bac56d603d4e08db0c5f214d4a6ed178da6e429a500b9ec7dc40cd2194f1bdb98e6382fe71818edda37bb462e9aa622d314e4b0ebc79994fff773443b8a36eee952a3c6ae0d5b193d1d8e242fc662017030a166c19aa906617a6a63a939de6d212d219eba6900bcbb0dc082e3354309b97e90021a2da7e17c3ced7059ad686cc2516303abe68f836b080cf04649f14065461b69cac76c7536d4f05c20fda104ed4bc32fa45cd172e9242dbe35e3216750c9ffa562bd47586c6a40b68eddfcda237a7a1530b44f0326fd43d36bfea678a340f52702abc397b9cfe76d5427859cdf622a5f42cb6e416e8785ee10f87b643415427656305a24f168d4d37359479457551650d5b88bae5f80e541b572cac161d823620b9a6ac2a5518978bf5aad9d00f00f7859d3fe1bc8e8871dc4b076a14c5fd913e1b50ac8fcafa0562d927ff465570fc106817bde679f07667a53db2d2a3a6e8b8d28cfd4f22830954ea3686a3bfc98af413f4b36ee2d0632269796983b7f7f8358fb4b157b07d99b121d24fd80727d2196afcd965cd8b5406afb8141ce2faee71abdcd93ae119d911314ff59f810716044852e357185c39f3faee4f0b7c1b93333ea1d8f518e4d586472e07a4b276d8823b88049d42e49acc5d102df3cb1ad43d8b474e6fe97e89010e54490987c5f6a41e91997b4d5a4b9359b6460b5b7ad2aaf0891092c892076bf739ea4e929311be561518630a19d617904b807a206378f9c294e109082dcfe2891295763422a6dcab610e7c998dc9e8bb7ce827e2320822b505bbce1cdf36f8454aa7a44f3ffa98378b9c5a0fdf0cd76d8695a7f8efc74ef8f14a6c951668df19a2f571bfee088d70e1f8ef77a3aee2a9ff64e11df27299b639d9cec974bb5c502d96025311048328888493c42b3adb862e7aeaebf4b725153aaf8f719393833e90597ecdd5e90ddadac78f536aa0f3090df46eddea51a9cea2af57c7538cb5c26a2d7025377321495d731af9530b8a25bb496756c4366d940928d4e7e9271e645422b6a5b8e4e4d56bd18099fa853e5800bacd7665bd1adc30bcc4fad4cddb0b7450bf58aa87dc0e9a06687043a91ee7b650376ec118553cbb5f9f5eb175dc89389477afd154f5acbd6f80fd122d8995a61464fffa8b00d99db4b53d2cf62c5e16b05448e2b318e7e6b0cb3784cc17da5653615d8944655a25dd36ae4be36f4a288c1cc361c8d202d7653681481c510015f79f9401002d2b0f1314a96b44b66098d436716bb640b8922e04c590f6762be0d56cf3c5450d8a56fe350846f67412071a453fb850d8845d3a1cdba382f4e5e42bce86e9ca0ae3bdae75fd4a9e2a96e7bd21e75b488dee8e268f263d7feeeb43262859e2e49afe3866f0d5612a2a2886202ea63640bd4fd7fa34717b3d5436cdbd722432ad9a77de0375d864de3ef3b6a952fc191748ea3764dc41f96536ae887bb52c40842b6ec477b94630965607a2add574ecc3d868a100db49e920258cb1ab780b0ff9d2d42332501d4dd7fe776857e71ffbe68d6a18e5267b5bf9820a99bfaeb64ec08a87b0fb95d06dc7fc09cacb1db4640b40ffd6e3df2ac5d074500e2a73d06ed6c8b60277ba46f8cb62b5c80464b4b10abbcc3e3d4ee40b2aa4e24e4d05230a3979d5a8d3352a07c251de5f713433b83024956531637e33dd56351e3b1d070a9e9a255bc8f94088fe2262fa462c56deec1387a39c32e4b61d002f821a51e17698ee8cb4691363f6499b3a4d73ceba5a32cf69972822925c4d3a7969e97f940b7ec2c26212181c81f4c1894c93358d76bdab048cbdb7d19f18ee87780a34ae76eb4f425b185c1b2a446b1c2da3e47b2d2fc00e8d4e320b6ba223fc4d0b0eabfed8c6731098ebeeea44743b275e07ea8602f47c3043194d2385920b3eafd50922304827a6884eeda888f76cb5e5b48ea62c9797dd2b777cf13a02f2d3e45194245751eab94e6ef57d6dde7a2b1b40610ef1c8a8da17fc0cd51dc2686ea0ee849e37d98247e54ad23f308c7c475e3615822b4f43a1440d2a5675caf3628332490812c705511aa1c738dbcaabb054acebb5d61c6a26078811da2047230dd895b44036aa3c3f4dc2b5da31d9e42c1a3315abcbadd2cdce7132be48b06be7b6285f8bcbdafaf92697b5e4c9808a70695bbc8e96402d0a5056f506d843535e9a3808b0409ccae3ae4bdcef7961328902ec76201bacad1de3711f31ee059fcba264facb3a7aab0d8462989af956800c0a18b85af2737db18c0fc619784734af26b461582aa4fc6ccd4da169528283b0ed9a28b134b3a2bbbe8ff50ac46882a4fc4a2269a66bf126b7b33810cc24c0b300abf2a17dde4dfe21b55aa0ba65236e550379570dc3c5e1f74f80835ce69254af0f3aa1aefc8a2f7b5e4b6728db10ecfcce737f985505506e4f46c187fafac200d0936f1d1ff627a42f59fa99deb8f7153edd25e37c5e389bf7877abe61da4779ec0f5be7ef18e99ec3525983e953cd39fe1c5f31e5ffc23f37285dbdaae6ef5fcdcd1e47c7776cfa86bfad8581ad11c1a93ad2c7fbfa35cf831e939abe340171f94f8455b10f7c4698c97fadac22393b0b3eda13e353997f4d5b0ac536588430237da581286b7b30852287d32ff6fcd91b433605f18e5c6fd03ba5352fdd1e8e666294e8a177a10424382ed38b19693981d15a6900683918b6049c815dc52ac0c514d23810c7f52ff91086b3b48d1ab933d77793decbcfcdcad30a1096e7f1565f065f029817ce31b3c1fc2c9986ec602168a4395a37d1904bdee69ee86dae36e909a203283a455c9049bcd36fc814ab412da69caad63fddcda1c17e832e7f607b601f323a658beadf44988329edb8336a40747d9e9676e3260f00269c121774027da127c565d259c7cbbe7f89084a759dd147c8baafa5b44fd94b182705807515cc8a407988fa9c6e5e914ca69c885cdf9bfc73218852a5ba59c21014f18e14ee44d933772fe496d55802ccfe550efa5b5c03a59ad444345085df0b72d8733696dfef48f79267fdb72c1ff5145cea06afd1920900c197139fd59d932bc389b23edad8876d2ab5e4477bef1dae3825d6fb64b590582292785b7dfd648b608cd62eab98723c93a6b4ecd2fd8183fc049dce1236d3f70458709bc8ad7166c663aecb4ee0807a73844ea9d398cce87ea5d466f3223f31451121e639147f15ca4ba0ea0d86f3610a99badf4fe9f660c463b9848afb2572edbc7ae759cb6b2bf8a3a67f35937f1da9190d54a0c01c12fba7c257d8c4c12a4558f429627f075c7f764a23fb7dc5107b64963cb37e56a67a4ffef511bb76eda6f4cd588e89800351b5ca565ffac985c857b1e2298a93a37b314945f6e1abfd07eea26547da60194752c46e475eda2d3f40619e092d2dda472a669f067125ef0ed1cae9691a514ae8e101e1bd9e78be04799120e3ea8cd1444d1ca5d5f68fb87307b8aa31d5f22862e959ad1fc192a941fd95fcb94b33e1c3d673e49dc7aab72f155cca73b2093789bc914340b4e50da99783bb695cea2662d46a7dc57aabd8381df558af9b35f846e6e5ee7adf9e536ec0d000f56c736b7331de914f5348c39d78d4d6d8c195d3c4919b8b129ec324e07b1ec1b270741152d2969b52e9630e8e2460d79ff717b92873b5b2cbb8db773c797a49d4f1778854c2f8cb048f147fecafa176a55271f711a33bec2f3aaee12fa33c5c9a456c9801bd267fc92eec3b0942358daa7e8c3a7b5a1804e923c5f78d91b2df0e4f820f75b8ce35c824dd975ae183e13550d9db495958f3115d43c168e12f3326ee9fcb84c72af049ddf83097dd95337f5542defa63c4b05ef4457324088abd69b04ef3d2b1bb661c1bd37559f9b7fbfeea846a5de2112bf5cb3596eeba2a163179da39219d804ac0d42dc074191eead65187554e85916ccf9b5787cfb5eeb8882c6ee9bd6632c5010bbcdf570ca0b6b95c377348378cfaf412e21e26855084e661cfdc6e642bd6133cb896864372e44c50337c522ab51387a6d45ff4580aa2f62ccc312d0904fec217d0fe02083e32a73911ca77aec5bacb670b2012f5bcf549ef3c3e78f97ed9d57f984d4431903a3e3fe5a6f5203ea02047f3d143c3c8cf1176a55c11f7d7e0ab02cc5a95f88d813784957ad269a17990c64048794b49dd6603f13ba47f550ac83406aa9adc53e48540e2cef7b74fedbe660dd44063c7cae4a7388b4ca5b44892fae39a1deb3649aa901edd108b496cfa5a053954aa058f888ce92e5d7392d8f1f57a3221fd8758bb02403430e696e615a72db35af780eb3354f2e326208e4696941a3ea717eb1ada4ea62928e5bd6f7594dcf7a6269f6ea52336f0cc1e1671842320ed85eac5540c6919804ff275b48376e85ff6a9293e6b04ddcf344056fe23cc9f88d089651e6e41c1977ccab7a16c6f6d2d7f1196dff5ce62c3b202b905de5b7610f6661afe773eb5a1e474d6bf331ddd6a8f42bb33023a7d5d72bf56fb8e6a4d0a9b7d66591bc283885da1af989b3db05211b14d8317bde2cab7ab0aac7fc997612cfbdc5ed4e9fa2d46c8e22c9a08c01b13ba5a896e9ca0eb8c814f6d46a1b81c91025448ea2750ce2fe32a48884f3b69014a4d023ef095e584c53014be0aed6688db6f4f8e80877be8ca0180fe6d260d3fc214ddd372cbadcf7adbd8b06f7d8c5e392546c254d5b85de11e62d9658ff67aba72d02c2a6304d771b2d107e17e0148d32b745e1d9855993f3dad59a8eb46b4a1bcf31841e251ded7d57f68aa3be907dd4e4dd3a1ac1c35b19279d533d4feed175e2a66f4ea0f02d3d3f6e20574ba22278b8bb73a84e2eccda166cb4d5c2fc0d2db2c621690c709fef3353a4bceeae6f8cb5d3f13041dd668eb209e004d231d802849e70e7921da1f403ec209c02f20f94db9b07afeded64e99f28cdc3696b94c7a28e7ef997b241b6928c8691727f3d78af319d1c12605f042e62e1f1e92ae022d1883e71a2944355e7cb6308200e59c9fc73baa5765a0bf0bb951e111ce4b3aaca08e6cad120982e309a612de60416213e44fc0089ac8c5200d6d520634528f261e95667084974ba374ebd9bb2d452ccace0978fa8a4b6722b238f86bea412e2439f675026d9a648769f3cde377348b37f48aa58619bb63eb82659c7124fa4453448ef8f9d323f802dc651256e395d456ea69fe28ad8434873c0617b692771500ceff9f9bdfb6a17c171ebef77d1958c4ad3db2e854a0f073e185e9555b02927e3872c637600f0476ec7aa125912552a61ae41387a55b481043754d4de7d26a2d08d1d7801a913a7a65a1e763cf585ed78a2d7902e7b8cdc9e5d9410c308314106891bceba90fa8c5e9977cabec1623d05e904a6ab00c5df712bcfe8b53b13572a708e3cf80ec9aff6106dde9d6547bdba94a9ee349fd697d821b675859a9add89d47239c21d845e74f2291f5c06d983a1faed446edf88d051f2aaab755d07ce4b668954a3ccefb0037fcae78decc9fc89a7d788b9a04f2b5258a6ef0f4f1d4ae8e84f28ac650b138d1d09d754fbc2dff98f37e2d504b1536a82d3a423c8a35ff2b4cf6215221f3b86ae00636fe2cb4a6c54056071622e3b86fe218a2c2835967f7d586ff435816217f8422865f7f11156d1b00d83ec344d660d6fa8721ef14e8556b6526ded6911dfe1fae275638d2d38de5ba67d4b69c59e26039b93ef72d907afeadcafcb964da80f54ba3888f0c7119b28e08747facadb4389ad1bb0fea25229a23c3b7c13d5aab2078b6e883d9ec1e9147db5ca2465d2744025d89b20a340ab51a733f7000811b10154f88896067a9f0a319168cb5fdf284c48985eb2d494cf522495364c23953ce7dd746de935d56b200dd9fbd5abf8c9a2abd9ebf30381f3c5de9d0452be5766e05c3d46dc311dcd114cfcbce3b041a4217b31cc6efa1452e3d2c266a288d5af7bccb97c773d545ec08e1a3d6a9ba0a73db4e3f606ed8efe86a84d8dd2ce646e4da9e3c9f5d406b6d652235e457e2fa1d74b1ce6ae3aff3fb434fbbe2f4c051944868600d3ccdd061b1d006a820093f62143452c8b729d9925274daf834e27a90c671cd6c1b758e611335e15b1ec6a79f69e0a284210ba161096c3586eb23ceb4ba8869339a93b2eee89eaac88d3472dcead63e95ebac5a7f50c400e437bb825eb5980cef6393da81770b55ac35a32ef408b922a074332257f06e88abd6f12b0260e3fd3109fba261b74ea93d247a4325dce0a685e4632e2e1710c9acd49f3c2c9b8d91d012e4b20a757bd2658adef384db87b0a79f32db108a95507f51a0d5e6f63bb1bbcc3db392e5e1716c692335f03b52a145f865937c95e253a0b1ebc40f9b3192736975e1ae6ece0d03ecf364938153301ade3127c9f1b417ccf90313f6929331679593dce91f7b364612bb85cc352adb1c307dc7391ccdd9c389556b5075daecced81b93f36b36007feee630b8688ede7ee648e6eec5dbfab1502adc3cbf5e5f76d5e6a841a946534fea55c2a88a7739fd80ccee437ad89e5b5cb8466cd1beb574a3a9d3537242b845b9b1734bb279695dbcfa20f641d9e7170cb021123e9f5d398a2d219135a3e9b448d1a46a89df378e4b03210adb6097fdfb9a174d43e93f0e24351a3f2a6686f380a7b3fe5a4a5648fc5822eb1c045a9da02f33801f6e603e6988692c4b3f6e92cfc2713c4a37ee8582506427d7f5f78962cddb7a94f77ba47e246d096727cfb192365dd474fb24a5c4b4d567c58064bf69ab9f8fcb7f92b8608bc4c401bf720d6dbf85cd86654c55c686a8c97f9913c8befd0da56bfce346c66780dd22420ea011115fd971a1bf9de117176937e2d57bdaba8df18841a683d7f62676cc184298608ce41f382e3979f18bda290dcd85ad111371140fdef9cf22c2b31642ad3bc3367ce56ec2e6067fe54b0e2c8b5b0a63e634e5b97e5678ddfd8c710625dea836d0b03517391e08388933b73a76f4f5668203da94c534d9d4f4f9dd0cfb04e3134e3f687d2934d57677810c87f91b178974583b817ce2d6ae37bc3d9d693b38b768bbc3e79ce34f305503ab941315790db6b9c7058476711ccf5f3ef74b87c0064186b3253655cdce1f6b718fa263ef6c753eca5bb92e1aa26c1b50b7fe893fa679759cbdd24267f80b24d5cf2e164ca2444ad3cc5349362c7aaee43fcf0d115bdda118eda014ab403849175c31e46f888cb232ef55d2631e000cb66bc76d0b55c3956fde35b797592a041fdd41894e209c4f7d6073a04bf445f9b40ddd3f7b4ef9021a275c83edb2f7906aa9d6ecc436265c5f758a2abc3aba73d754f3e63ee76906d5d415f452e8d8b538016606dc0e58530164098916657c0f3327860b254033b0e53188411c2f808bc96d4d62e5e3074b75683383598e28d7291034f07e141f60bad6e0a94dcde1b8f5552d65c415aa50669de497ba5829dccf2dad01b7330bff48e64ba017a095b5b64f20ffd559b1f0dee5dfad55818ff77bd689d94c8064e2b5d324e41342b54ba85f588a7611719baabfbff26b5ab5d4fe88aaa7c8a8f9a96d12680895c12559f0907361da7fcbffe4c638824b57c05f0bd9cf2219a538b9054aab44a942e4fb151e6a44868442e17c5393ef5c6272b27f85c5577a3aba773e724372fc326933adb64a111374d33392931e560972faf8642f90988f83d41e67f0500b8a005644015daa43cfb393c323075a0606c092cc1c8984eec894202b5dd56bf15935efbe5ca36fdd2e272788faa954dbae41eb49b94cbdebd090722f75cb29570cb625786768412d86210b93150b1ea86950084f2b4b7697dc2cbb272e93619c9fc0c56bf6f4858f62a5ca88716af6d0bcb5c6a744c83f5b9cfb9ad8dfaf92667e127a03d12f816bc8ce4610d463b678fcbee3d5b487e86643ae1ca5d3d12f53801773e62c312e0c7077bb5f4887c9673d78c98cdf3e48eecb2feae964e2d6fe77e505737489a9cab340ceee4599648e937f0af12ec61cae9ec967dcb66decd2e43ad5824e1424e7dc2a98cc86a84dcbaa6370ee7efd212eef5f1066abc2603466d8e1789a8dc1856338cf50a9489c23d79643ca78356ea900704427474346e63e625a4e7e0594094c3dd2a286ca7677ab69049151cda25b1676009dfda47b955f69594962494ac1d04122fb6408d04d03e7cf2e4c7e266e8c1feda0c4ca77a7f4c60e383502a5e99b41dde835777132c81aca5ab5880da5bac61c70ac05c1a2c3fe28962c80611dd81963911090f98ba58668de85e794daac1ba9959faa4e562891831fe6b65e6adf66a4fc0fc0f16d83c9ff061c64f166cb59ee7141d23d8018107fda41fc08c30481a66fec48701c53f231363b854cd5758d5c3920e6312ffc3030d33398c2fb55336aa83252f464de3ea58cf67095a8ec74e4e6f526c7a8a83d6934fbdee62e775cc25c144ca009657657978c140db0db5bdf544ce8b65c1a3535e5bb03715da537aa4ff9014703241d3d0773ef1e975df619fd00c5cefe4c317b2de4f7747e288d36f2a45edc7033549b60d3d8fd84b0060eb26510dd59e2e500b8dd76587e858d05cbdd88e33742a8a1a2439b9c5d8784a7a89d9d24365554e24eb0e2bc1ae10ec57c1960642c68599b96255c5f977dc5be5e14aac53d8ab1f4413799eaeb547c682c5e09db67e2e2f7edaae13540657fce4ad25cb9685ddcac878f19511a1fac11190e3c75547ed0658572988e0931527870e3a77d37f58c2899d21c3e5662122c7c51fb93b59e09161c2082de9322870c90449eec66d423e2c3c8a42dbce4f4b448b1702fc66b759548e5d9b145ec4e761c126b2a7639fa6b9d8e0f3fcb001d1319327b4916de39ffa01355a8b50e1892ac994c4611cd662ddacff1131eaf1a3cacab206376b33fe96799f0c131e48d74b2deb54016583ea478b6ef6581d62a5d57f09a2587c1b5a1a34a77726f6efe4a1650c82832a9372e8bb57c4f2b2b61ec04a318991d6e6bc5dd2fa7eec9d5922267ec793f606ce41d6ab566bdd391a92caf1459f8f576a51999bf11f8f693b2a0b5075b44c89b13e4c21d6138c39ae420d3b39fd73acb7b07520bd70fa6edbdbb952bf2186db37eae1517febb941dc2a6ed6c6180ae97f92e0d6c36ea5b71aab592367720a4f6d944bfd972fe6f8eaf055755b0173bda383a68480ae3f8f2a20abbc193eab14bad65a5eda95ea973921dccca5e3f3e7a8ffab54b125d731a3017f321d0995882858357ba6205463cfc3f1f6528eed84e2f998bbd05a1779e7642c17d30a124ea5fd3aef175c18ac5102072b9e06345babfe5bc617fa87f16266f930bab4124efe01cf65766070c16961057c96ba25247ac1056e571870cda07ccc87cd74c5e240f99e08272a02ca70027788d2b28a0e655b52fa072f3735153f7815394d5062f1fb265886c637445d7ee5ca14a42216c84dec0093f627dea4258d93bd2670fc14b370067052e5feb49161ff9d7cd11d657672703a486e691f8088c706ca1d4b8ee90881996c1ba7f4b8183b963620b1b32efa1ce2fb5788759a9e8c90a5b6884a87f88e29d57ec8443f07074832ca355cf6e43ea531657ec71a7abb2962beff06bdb3e666c853ff68c0448e8a3267f1926692cb135cfb09848805458c3826431c801623a32f0cbb4b64b12031ca9339c633e9e0f884d70e8302e99a067cc067de609ada474381acf7a22551d24de780a7f2f7365bd9d74ff82f203ec6da5f42620e5827bc901f4d2280880e835d99e1194bbc5f2319fe3248540d732b868d053e86a605f0e6c6ef19813e22247248c4f7d41e31a13af72263a3cdfe8f6e78c87884bc4de65c134db69a18893cba208994b2bc7bb0c50ec6c6a8a5b7b5551b0461a519a81123004f4c93a42bc1fdef0e92b969fff6e42a0fca6e2fae5bd4d48bd97590ef24c5791fa23ad14c0e12ff3832366bb06302464cd35b4ca23e4d73f537c8afd229b472fdc07d7e4c40af04af039a08008e35013504da233291de466acbcfb887d1fcbc3c8c365ef2f3e6d1438d2c54b7aedfd8924ea13ecd48b09f34bde1565caf90709047d6ffc63a0aee468985f9ceb9a63f1151ff809e01f63125b0bbd68b9c1a70d9439ce82def477fa871c63800d2d379524649e459b7ccc1841c7941f347675bfe15977ba33415d731f46c7b3628d20a614ac69a4df4c76495b647c1deb7f7b6dafe22dc8c6b152a06417e6f39809d0d9ba5cb6652bc6690cf1a9860573c2025cd7790997626fd633f73c93bf3a5b028547c7323136a359d73d9b47d905c12c6f9a2c3d689c29a13a792c6a8a0ee84167b03697898a55808d8adc3fb99bd4589e257139b9f203b544e7ddf830e0e674977fe18c24024394f5f5b89dba68ca614dff01a7db886fd9a8e1b73ebcccb19cf975603a9d54518a528594fc82b622e9c53842e37b73b5d0dca104e3b9dc54d901a0c3baca46672c2d3141adf06a196f6c1b42bc2c8581cc1d6aa717f0b7af9d3b4396e012fad2614fce7b0ddeed621dbb858ecefb7a5ae088313db88f68c9a0c120b27a3179bff5a7dec8b70ae52bbf93471098e61af5ef662d153be020d6f72183c57b1fdc480dbe6f6a138fdeeeecde3791e7bc38a47c85439367275eb24732aa17e57a47df56b6dff606bd22f977d4d5455dcc1795a670e61ceebc7f3459511bbf85422b8c6c1e4e4aff626fe00815a581240973fad033cee251bbe236b17809ae98ee0a804857f98e7e166a6ba35fa971d13474ea74594077fe615532a637c9daf11dca06aef8b3ab0b61c0b718b2db807c4c2ec02db1069333a1e5b21f0567f936425e6a06376f017c3ab92cd64cb146829b829bbfb1531e73c36bb7afa660bc0098268cc7f25dbb864f3581c7d7969153b6224c9240d411b14e03df0fcdd9f813dac307250ed6d4f798c36c2f237a3c25ec4dbbbfa52d5f2ccc37ae483cbb80a0bee0bb76ab82a037b88236517f261dab2b950bb32dd94b4c25c1485949898be7cc8cb7367f257dfb57a58726d346f2469602d577755ccf5ac7020dd97fa31d6a403940a26a5136d0ccd579c66ad2fc7260c5cd02d08592eb5e94bc4c11243a39f2dc31cd35e98867c9715f98a4d1687ab4defbec87b3d61a7d6978758a71388688db9453c2d78713b220d6755ee2abd5b0f0eb58a10d32d1f9f92352a57747d3104c30d580827c241b78030020a3c3352cb4daf54535f793928e0387a9d302db4083b3062de6c486e161b07eecec94d01ce12e32ee705fc00e68934ec8bd192ec928af0cded4e6fe2b483d7acf9e6bf818650981ea9ad36a7e77082c2ded9382b2ccb98280cd01a7e79b8d4f99ae67de6f558e0e13cde8a61e18ef8f7a1eaf3b22e1fed7723a04d58063312199a574fdca4ab1a00ad7677309461ee9f023a4b82939271ea4df97f72cd127fd284a06aac52cdee2ecffc78853e2379849197e735e8767296102b2959fe4698355ab2fb43cf32cc582f08905b10dba9abf395273ac776a9a4bfc2ee019ad0ca16e26a3ee3884ab09c823ff622a8b13c95d0280024e433d624b07ed6b3d5e7a4222b9a653ba36265240cf9a9af6142904fbd34489e561ae10efaf483f7c863c9f544fdf4cef1f836135a6096b1ccbceebe4594269af229f7ac2f250490c6b93aa3d665710aaded92dba8820a9eba06b0214697610c1edece578a29fa63bb3e49bf5e432ceaf282fef4e223521300083894220304057b2a280ab4658d14d7e5933c376bcb2d8458c49f46742eecd623c15696a2c4c01fc3bf18dfd450de12f9ef545f5699a9d70a1e1fe2f7ed5468454b98b42222aa06347a571b41c1efaf674eeee38de1738a28a2e547c373cba6dc8283f2c13c7d30d29d9ed257006a8acbe338d100ea5ca2f89ab66b1cf231d2e4c8123fe8800e496bca49a24ea556ed60f5c51da965b0eb600390f82a06612bd15db21ac270b13025788ed7ada6a5ab641b1fc9747af5caf548bbd1c93c6a2fb03cea4cdc4ea29e0def02130cb9a4a97171dfbf18a5b7131e65f5c9201120f414dfae9c8603ff03c4ad8af31180090937971bb6080381a31716cec0b965515d3e82183581bfff2b2d30f43c997cf5752f00513ea26ff73756bbf0b2e49b229742c918e1985501145191309bc5fe51d15360999bad6a4e79bdc10fe3a53c9a85f63c2e305ad520951ead33711d6f755bb352bc3d182046d1cb79ce93cbdd4e65047798c31ed6a19cd243b8a44ab6c6b66e7f7cc29947601964308dadcb33834b92841bca68f92e7f682cae23ddf8cca8710f6d837b452df2da82b315582b41914bec25bc66787d507061a616a34068430eda1bcb0abb101ae08279caa29585a9d0892bd956fbaa5351f44b1b1e4b6f47fb91f055474ebcc53f1c3c193769686279e0d0d9120214e4f0426da7e4f5253d096dd361e0e9e1854d9884e04b7d7a1415abbcec6aab1de71d159323015833e612c5bd56515f70e74db1900594fef6ec7b616571e1e3820c3fc27cbcd25ebdfe0749db3f7b090501a9500fa837c149e935ef048fec0d19cd8924ffd242c050d74d8c7018882ea8489f27db52e999c2987ecbfa4a898cb8a23d6b25e256746aae380587a36e836ebf891e80c194a4814771ec7fcd29e0f8f79b7b271df9ac3171fd15f614fe324dc0962502c687e046a4bb10fc3dd53707b063a82324007212aaec603fcdae6cfadf3b8420aa453fe2e3ee081319790f555d6a018c0975e6fc0a8106a89a133c0794b8890336ef324c963865b0b770100f9fcc9ba69690858f4e56b7f4f78330c17925c0aee2c6a04fff6e79b3f41e486daf77a989168055067b910030cb425017a3f5f5ad8c723d9e391bd87b8bc705aa5866f827e60cdae355e6e1ec011125213f39c7c42bb60a684954121c2699074886c3e910bce38d2757d8d7263a86e97ae40a662503302f5207b5b082dd76325d9bcfbca723ba1ebd9dd89a8acc10aa6da8caa396863831b2d4f5c4ade9d7a5fe5a0c1956797451e89e87a4945a39eb47f37061ce03f23f5697b5542be86015474d46b5f757748eeafeee9b8ad4752f86c41895d01f0bc08a71739215c0897a5c4620f3bfda4beb8c454e93f1b71607ee8146d5c5c834d3cba5ccf3781c5f7038ab3c46cae080b80f9d108edc86493e06db24dd4b932cc5420049b2738bbd92a004bcc6ed448be61170a94398b6b6648065f339fa958afbefbd1c8de5a8b939b9ccbdefb65766176b3820b149d87932d05b1da29a780de668be603c3908ab881a6a7998009dff369320e944405430ea7d687455ba5c1a54b61fa1762e638c9db4bd3f0f120f60e68677e11237b712c677a8bffd7b6bf1fa7cf35be3dca8db93bb03388b1322b1b080b980be50187026f703f5985eeb9f993aa97a2d5999481062df7a54b3656d0297debed194dd545f75781fedf73fb0939f81592410a9998f9a97c0aa9ce4c543cdd95883a8dcc61839eed8cc176ffa756349bf1c02f0de744edcf49356cdfecaa8f239db95763bfbef0deb35c9974b99e12aa5cba0f6c2fb7dbc81bad70a9e000d0004f1d15496b4a90c259efb719b7fb5ccdcfcb3a55a8c665cd0b4d9f9c6bc0af25d606ab51d03e05d43e1a2e9bc9c853af5312271a4901a43f29e02a25ab41961f5b266c5dbca8d234d1ce76249fc8e64ae3d5762c495ea6a4873bd8da7710bfce054550aad25c4705badc65dce8345ef849814ef492f63f7749659ecf77de36f05417f736437479845410900a6cea71efe915d0a4ed94b3569b40e17ac0309c073654319851b09e42008a99ba42f8552fab2f4319f6c076fabfadcdc0c18f178e1fae6389562bcb95f4191d47260ff74a05ccf88670e4711c742c61af82b8e74b18fabff764630fd7bc21c2bdb29936c4095f84cedbf7da9a3083cab88fe20e2382143e98f3aaa2b1ba5500bf43d2369c191336278535dae498121230d71f1614b5782b221b2d968bf78e5731b5ee4a7823ac86f636783c0648721df6573cf4a1018640bc6fc5298ccd4e1d8fe6b9f51e36b37621bbb1ce27dc2cf3a7c12bd07d71a60b410914a7715e0459d30ccfb5c3a088ce53d27f86c49397968eac4dfc72b7aeea18a8a741a635bea8cad521cf1525938ef5b8db85b69bacdc831c7a2d6abccb63d1b494f7841af2580255a1364c33066703420d64e331d09d8181eda5eab01b88ed718473b698bc423150aed7ce8a2d2836742570a9c204997cda4e9abe6154a130a4413c1ce2bada1f4d733f7cc5c4d98ee41f8d464988c6d9ac6dd2a51b8964d6f1d635d2890c6e8ce3e01d93a2ad3ac15d71f1cdf144adf52e70700dc4721789050ff16c696ac500634f52a50f5abfa0e69ad22ca0320061a94e4189740e77426f5a02491c3af450f4ecb8b601f6aff112b697994f8cf56a9f6caa659f173a0837ca67fe05a40d9c5d82728a7d1b9e978429c4a032ffd6ad276e4fccaf2e2bf594846b4bf1441dc63a90933653aca05b161b63f2d0b96e0db77b5716bd965e3a4046756afdc33b6ac310e82f3351512b7f6d9d315ddfbef35a012e4a9f3c340161bbb6dae3ea7180d9856a68fed91627ee55ba80a877fe47cb6343e8b016729813094cde4e1fa18f30c0b3e463605d2d3324248a1b526a7c12d7d810915485726e27790430ec46c6ee15de98171711340639da18f0513bcfc846bf78bf4a8dcf55862f5a79a93f458f44a0b1375b443ff8c0137a783b715a51c25684b0ff0658d2ebc4ecfa1b6eb1a26992523434da99d89660d2012d4bcf5ce1558e10cc77fa5bd0824d6936a419e8fada4ec18395f79e3d3a5f59ece57082893384ad09cc65a5070b9a3a5004788b09e732b40807d7de8b457045ec8791f4cdace0254be70debac0e933764102a3e99fb4e5c250a9ed152043bd001b43e8a738aff90111cb0c6114c91a617b74e066d55a855056eeab93026d3f156d1629db1fb5a1beaaf8dacaafba512ac6c398195e987c83a4a6a817eb6cb41f1d85a37b36a11b5ceaf73947ff82e39ff29749d77d6c373ef374896f091db32fdc5fac0c8bfe595d0847005717d1dfa3c34463532e161e3b7d0c0642ddbacaa98f47ca18fde0902dcab09280a9375d69601d5381af5e57127e41c2ad690465e73ee3887537e3768b06609e73dc52cc9a5adeda42aabc26b60b40b83f74ea7e31a9aa215f27c52141f502c0d1de64fe8d615a862c5460c100134e4ad85c49bbaea7b220bd6b21681cdd3ef75a4a288fe12b66c4af278737a3d392d72168f55fdf55063554ba4830a1927eb7daf4edd070f95059a0df9a11ac5008c1f393c94df201f7c2b8cf54cb24dd89bfce9f1d4978e01b1dc87cc213f3a1ffd90f94123165c5dfd2d5e324480d25693e7a7e56289c89a4b4c7640b27d4ccedfbbef8b0d363b78f652989ffa88517606198e9b840359ea9ce9b83d951fd40b7e52b5e9c30afc79d2750a778033029834385d9076a9211488c00864c9ac84e2d4bdbab289febdbf361abf57fe38e65f72181f5fce7dee6c942e7128f992e8a684c1f55d2a2b10b64ee9186eda09daa17a7847c96a76cc1c5b1cfb465bac4465fdbef1050772002e054e2c4965ad9b33d30e6aaab774d7ecbd709066cad0625d1b5655c5aa98c841a4b67dd8b0237299c6a698ade7d26df356635b80a3a84541792cba4d445bfc84df3724bcf96b41e619a7ba3101a8317bd8e586f2325400ecb34de81ba34be4d2daf85368aff853e27ab656d9eff4944d5c2b6cbcc93e5992109863ce2ea67b08c0081210f321b331dac2e4bc540f20ac4706ec74ff58a7d685e860c9fb00eea489e23dbee9cee93f30a968dcc847584980af30792940c1f03732222d4c46bd316f633c5c28604bfa24e981465eb30c83827fbaa9551e230db52aec8e9d5d7c7fc62be1db3c2a4509315b347a91500084bce1c87fd4ffdfabb27090b4008c866e755889f831caccaf56c9d2a9337a463b1154ee235e9f8111fd334042659822fbe46d6c53852ab3330effcd5bc4d3257cf9304223c7263cbc7acfc8ed0bb374b3c8c29b34f0097920a64c5eb7009ce691625af88cd1aeffd8262e8536ef1af379e2d537ece282a62c44f77dacd33dc431678f816fd2e67228f3d7b212dcad922b9f0905db78317e15e11fe337184fa66627d772dbce7e15680fcd4a0627aed9922b3dcdd44ca969c59c45476f2a9ef4636711af8562a1359792b6a2886704d2e5da858ecdb96a851aebd85aa7422263ea7a2b135962a67f7784e52dfadea94f0b8b4b539140e121cdb869bd2ba04b9cad64cd39c93dc339b8d8838197390fe7503290b57a7e23df5b54d31c6395d4743a73853c21109f1101a647e868b40d4fe67c8c848dd46c8aadb07cd896ea7bcdcfd2aacbea23af95b0f373773584539d14296bda4757ab97b3c6924097e988996d394b0bd48d3caa64226e5393c671d93292828c2dcd6d8d8068d213dde7fd79901e1314b4cc8debb996722ce84ad614dc5e003113a31a920aa90ded1bac2ff14ff5d064408a3cfe7e4d5c6bc1034f272f9077679d555b5b6d8dd1d4afc352f972eac4b7e5d5a06e9e1a4a2ece8d43c7663a51d8790ed14328ed267cd4df7aca7ea91b7c865b033a97ccf01006bae12a2ad9c71f967fa74979b21cf65c1c2bdb520f4074b637800068c7514769de289553ce7c62222d5994a0654063dacccad2d99ea08f66cb77fc8424d5b3309e6e1dad428c056a1d93ef333b40f797051820597b6fc6915aed8be972a29aabc2977f5012d48ccbe53c5957754c927e9ccd02d47eeae43e40569403acf9d3156398099173747b40bbb06cc57d91b92b2c93eba4676acd1b33123967b5467ffb1883f2fd0c759c092fa7106041be29e974a67a216f72914506366b047318b3c046330d69dd9ee15802cacf3df53ac7d0960519deb0f8eef8b2d3721477f682eadec4ed814eed31e030895e241a35f685414a4b7436ced0bb443db2a6d64568c15358c87540467408d5fed1d9473656cf7094371bce44953e1bf64bcfc612eda1f488a2f98376e819a0d53528ff832e4cc85dc42839248530e4bd74a2d0f0631b2fb0ef4ee1046144d0308f6384fd499c6d661f2aa0409aceaddb23531c3d4e84a482ce8c14cd25de49b25d56557fc2e1557b540f85b827669920cd3e184f7c7be10ab38c02489446745dd879e95bf7dcd787f551bd4ea84e03dcde1270eac975a8b4a803eb097856c9007eaa8878936796f008c1b10eb63f9c8b4c73d81c0b41cafc8498c3777593c93a8e154f667ec41ed5f8425f6816fbcc69bcd8856cf841187a840e31d748ab4a6ac8caa8f3c0d2587263fd389d1ef81e7441aad13e7872d6c53868e3fab5cac62c34f9170ab44e08ee83684f33da2002c08d81ab2cb2f1edd5998455b616f7061bf63f13aaf9340b586fc48ac1b7801ef554704d2946ff66fe07ec377cb875092f6ccad2850895f4c139e6bce906f5b79b10cc9a55f145e28aff7f921b631702d28a33494683b76ed87dd8cc7b61008df2d12610df3332ad90ab481cdcbcef27a2e1aed40cdf11d98e782924a23e6b3e3914c8bb5daf2ec6e01068af8536ecb6b9a13dc471ff333a95fe24f57f8b5e78932dec44c72e35a3b2334627144d571a8269cf2c8d8cd672dc442a33704be62c3638d03c9f0260e9028719893e7940b86ca85ac588201f531cf9326b18587e8a2490f5fbbd911a9d89af378afd1295761ad4ed9f11e27d1b1d6ed8f93b5b81cc27f4f0c0ff60088d00779eab89dfc4bbe8bf431331cd550e1f61bb5fd09fb8b573f115201a936f0cf6b6e2b49478e4a7cbc3eb1d96d9a33f2ea0729121596a4a83982cc215cd3bc29548ffd9c8b0b40f768db280105e3d27d28b3b1810ff9a55a7c180b303e09ea801861e33451a3462f9a2e92fa010b6b08d82e0df527db6276b9ff0c8c3568edd8f757de5c7f0671322e3fc304fa95aecba382b4610e08025a34cca3eba16a8cf69abf49a9c0985950e43fbcba25e2ac76cc66411db6c69798f6d3d3ce8f6e7cad0bc708e45ddde30b6cf08e716007882f347ddba37a2a0ccf6b43cc2fa96718ed3d1bada399d294dbdce1506be79649437fb283d833dd4cb6a0d7d8cc9474b8064072f64e95a65f77b743f66966a923a36985c7d9be9f20b5448f2588da6222e4182f46563039f214f694345061f33d6bcc442382a9b244f89b0c9b2974d7b1cab8850b5d0e9e9412a8aa0bebb7883fa5adeab275901adfa4635f29cf80eca5d3c14fbc96c5d6fa00d445fad305b4718ef0f2539ea6365d376519b473dc90ff9db1216f146483ad32712169ed3fe7d1df9b62a6f93fa1d45646ad5d3037a3fec64f0ae8fb15792f8ac70cc1c4361ef8d513904467bb8653eb87c6845d9f74194a48267c3d5bdd0b0552a0e4d0af2a5f89428b7a8a27870dc8b5110730ac2d8b303e84fae0e4bcc3119513c36199ace0859f8a46b5b44c1b6bd9eea54c9a64b36afad961dc807866997fa35bfb2b8eda94e37bb4b661c4f1c4ca6403607f894e60a124e8ea39f1d17eb4950ee1b3df18f403d79cc38ce385e4c719f3db5febb70497c8fa5d830d0884b4e79cbd87de2df8463bce64d98091085e59b751cd4c25e695cb16018aab7a26523d351f55e97bb125f6d5e3c8bf81e615fe9c439ce87df554dc786bc6dd99f2aba079d3998fde26b9d38482ca68d4be55d8839bec781b485eeb7791a870019f86ec4e68a6eeb95b1ff912fdd38dbe97c9b9469bd2e3a7acbe736ef2f24482a8569f4a20b54b15f13dc4b3216739a0d2546a220bc6ae407608b6842ffaf7092a3c79e460e528cc34719c637684d2d408a7065276a7e3e29a18dc83433d2d330adb46aa042e664b5bf3f54c22912047044373e8379f06a5d457deb3b065ac5d10d43ee7ecd411a8d53efc54e42eb857128d581e75f0afbec1afdec05617c36cb619b4d6e450d18d1c1e057ae2b8ad1c6730a66a812864fa043abd1936f96237cc408bcf467084e68cef5582edf43ffe8b3ffda1c22e4035f24789dca20fe4e8bf09feeeee0070060b67a8b6b7e3917a03a78328c46d270fab03041c4b764ad61e1139643bee0386ce1f062264250e1a04fd0957edb810e2acee72d012f79393f694ade0a610901faf71d67b685a30461f51e85d0176d8e7a64a7852b287fa07d75462e706dd7f1bbc0169f2b0c1c1a1682872530e3fa3b2031def587b05ef28d1a5d5df892d6d1d2f4f4637fe52f630b4711ae9dc0628aac9f85cd1564ebe9a6debb1e2bd79b38c0ddec49387ea4ba12ed0aedae723d882059487a0e282eb56fef86f7e13a046359a6a7aa7f4006cd71ccf363d24641fe5fb86875b4cee5e0bb98d88b76a5e41cb9056dadbba199102496eae3c62d57d75e7bdc134f6206f735771659b5c86049842715773aec25b13c71a0749face8669a8bab0add134e3d1b014c2f048678e472aaa8a8a7522779548931537c44e4a12d2a1cf1df1cbff17d567216d29522ee312b54d505ee29bb926635ac468f6c303be9f2d0cd241cce579acadeef501c61efcb3facf65ddf4cf05c3dc3d015ff04f78410859e42ba92fa54f6dfd4a8d46c75e35bdeab0b8b363dc41ee208d802bd987d87e25a9a86607567c42bfff101c76014bed92ea23df887934f674806a0f9d47e145d62f7abc231a1455f30d46fdeef4e79a0ba9596b4e926b4addec281e4ce0a6934405931b1c9b339be894241c1d4aec3204d51d28ea5fd3d381b830d9e61608356be80a633e9871d8a5087916823de1b580bdd6fcd4f7978f2593c1505f6eb5cc8e5ebeb7df2959bea80c919f28aaff73466b96516611d33858daf28c7610e042f0dbb7e359c416d518900886ffec2efd6d12f6fd0270f80f0837329d1f7b73a124bbf41111d6ec5a386a02ae15fcf38c198d0f2495a81c4d8b3bcba601bdf89178c310c43bf099ba0577523de49871966fe56c2c649868382393bdc35c7f67d9b2a6f406887664de75a359c5a4a96b5c8ac61273f78e9127356382026c5b0b06a6e50b2f4b87642428c59cc4e6f86cbaae544d5bccec3c13cff8c4065e4e4f6d6517bc3020d85c497ca10f98ac939c9fbf59bbffa601ede2a9f56f90c480665c430de35dfb11cf8de8a4cd5c27676c5fa5a78515f41d7aabde0b3d52cf4e8db1ad03a2b6b86362a243098224e3576d08cd449c923546548a12bac0f5ea4b73263f12df1762d00dc2aeff9d88263a9e42bf62ee10f5b6bbf80540acd8e95239e72d5d4dd8acb4c812fbaab027dfb88fcc7f17061387c5151052d0e501b3af0b6f759eb9a041a8c6f736809000774b20ba6da4e76cbe5fbc41c1850f418e889246d02d007c85d795edb51df9b468317760bdca37b1266fd18efe2104f924745728fe4dbcb0bea89c9a6a94117d021a90fc0927f56fc77d8f23f91c8ae1f0294885eeb610dde4796af7ebe9e2124c91fb38320e57475f45f35fa6c74f8239e368a3817cbbfec180c93d11b2ac3603802b1ef6c993c1dfb4b2df5c04bf4f81adff2587cce800647d7dd1b2adcce0c2d1db5c5ca5c56ef90b04deea40454b8885da3465c5b9df282debab7d259402fc61e74be4637f10a9e75aeb508920081fe74611a0359dbff3593993ea71eb71f18c9d22cf46715386c50c5fbde45cd99f129bd248eab00800f2b3713f6316f2617f8ee07df94ec1633f1ab351f66c7ba67e230b7f1c6ba99ac26ee16bc9d9939f826cc1215198a4aac0672a2623ee3506b2e42932da577fcec8ce908d5a3954719afbbedd2bca02a247f7a87b116183dd70e519c02740e050486d68c7ee6faba5d6e95a9c87a70c22eb9e627f89bdc9170bac30fd420c095848b9712b070cbea87eacd5aaaa08b39bfcd784b995fa18a94c5317a1d548bc694a200ce4817510c95975b4027617010830d84e8977e815a90d58c1103fabee0237a084ddda0621bbf601bccc70d38ee72b9b0cf37345b86c6570e22ca91f719cae2c3cfa020a52f415f4b9cb953a15b1bfa4a0709c2eb0c96e19192ebb94688b7ec474a5854353f552553c807787bdb028473778dbf1b36bcf1cddd77310695f1a606a19ee81fe994778118deafe145ae9062b9829090eed3aeeb3478034dd242c44a893b696a6147864a519536f1f0e8b137ba206b9bf731bd852d3e1d168a1c428b362d8136b2c37b18276a86c2183f7fea30ad3bac7a9d9b711f58725292535736c0999bee69f662872f59aa07b41e75b0558ece322f34d109f7931d40d6b30e451f1039d607dddb3b762b00719dab3fe8c72873724b855b474e2ab3368285c287d9e4f1e265c5389b3b61f7e71431d193a1529217952958d72b152e664048db8885829d70e97a5d59e16ba6eab177ca47b72c80119d81cdb3aea4ce4a2ecc2c718399d9a3bcea01cebee8381a9a33f06bb73821987060b21c9301363b9c1cc3cefcefbd02e969e6ee3412a234a677cb9c362a5bb9135fbf98390731b96f20ee817c7695d588bb3124ff307b7aa0aaf564bf63dae7d07595da49fb918d92f08882e675b588caa01900aa7230a022f88c963538fb4e6f03fa45f73a3256b6f43f530261c36f6b9f0c2433b88da73b8483a668eadfc49bb2b09084f70963d53e06cd56180f11f671c9fc1d887687cd5a803ea70226207ec3e417311da167f4196c9d09abac19d9f9e8b56497f572d0c03b6d46f8b5a436158e1b9bd65be495fbcdb2b9d2a4d454cd63e9243c68efa6c34f1e1c3bbe78f26fa184732a7832521e20b1df6dc22d3e2cea7e7151acf5a5c643a112c7fd359f082d2ae684b419daf756c9870a66e283ee91d03903ab751c3c842e9eda340189a5715c9e85a0b517fb5fb7b7cf9e339aa16d082a998b4efa1332142aeae997eb04fe56ebe9881abc65eca6fe7cc84fbdb7eb218f3307515952c7e1276e181dbcb6842ca4029cf9ffb629af800ea85680c8a41c58f9258d44c1ee78dce24e203ea62ce6335caa14edd8c7a05c8c0d934546c56d440a5b09f65a1cadc49b20097673d53aadcb1349931e39da4092bdf99ffb1afae191fc849b63fa8ec89b5db2d8e43141d181cd036dc5716e239182654f08dac3d0bf07ce3c265e7e7c04642bcf059b40d4bb304c529f0beaaa4d6d8b8cfda0c95b0537767b8a71e71b83a6858479cc0a0dc7b63b14559b1a19892e5ea45a72e3be825aa983ff33aaaba865c3ae2a397ec63ace59cf1b29002fa97c74aa07a0310aa2efd146542670d61a95b218adc93a5c5c7e76ad6b2a2da6de6a74ec0369ff3c05c3ad3198c7c008295a5a993e47af88d06a259d96d039011c26506a692c2b7447e6018e961e01e5e2c13e6c49720867ba40705c6381221026c7eb20d8cb7937e80fc5a1c59e3b5ccc5fd3a3001bbf30203c1c2050cad9a3e5a65a445fe9e4c343369249eb98d29f0467d2d78a7a3bfb1f3aa014e620ea8d8a0d87cd397ed821ef499f3b75a1e1d1570053c680d0796e382a3dafa20314f2e71e9e46f82580122abe0b86ca937947e4d5f24a166621109ecfa35bc9f4b294d247e5ed23adf2daa97712f4cac51fabe15ad71da51d10cf805b51646ee5c688ae94dc9d0ea042c3582f93be8cd228debc34ffe57225023a04993b1a43f93645aa60ca2916b8044491affc6da5b2cc50bcc4318c14352e88c86d57adafc632ce737d0ea3890530d1070696749e3d4610e2eccf38335bbda619ef98475c3037ed6c7bc3c4f23d6d9a4d355bb3bc51eae805362d616fe8e9cffb76508e0d1a26ada81ccf1d1f41597d01b0823d42d0279e7b5ad51dfba554ae44226f8507113b1dc4d220d8f5cad37eba2a4eed7ea67c71c07900a31b7fdcf1e2a44efb2afc595130c5383b620a5f081c1105758f281011d9c3fc406e92d6f7f5f78ea7a9c1acdd6fcb026a235f0d426b895309373a0fb83cb3179379d7fb640909d54cd404a5144a655be523822fc44306918a65b41d25c5e43e17381ee168cf485f79d298cada1a38926c586bc66829e3ef10c4e778803ac491db34ed8372da684521170062cf8c46b553ec030f10d83b155e3b5e48fedb4427687314d4d57c3ee9fa3dba4fbd879b79a2e724e74ee694f8fbd44837875a6e38aa4927cccc0dfde6a5272c4dd644127c33ba7a114a4fd78ab863d11648ec88092b062a602462cee97967d49cd79b25df6f9c463a9e28427fa848eab43051e22a717090b56a9f7fa76f8659b828ff99834fc91180f3073ca6b6e90050ea6151eda0f9b728e8a873f2390fdd8b8d1c80634b640675005ba9dd64bf9cbf17838e2ce8a4ef38cf59f5748ef3b18662453e7f362d5fc53c751aa20b6931d1dedb2e35ae7e5b4dc842e5448b78032611bdf80c01db8d19415ab122811999269ef08c7ebb34d5dca08eb82297d6ce91bb300504ebc519fbceeff9fd5d88e0591fb0c96bdb2ec841a64d4475987fe4a874558fdda42639211aeda81b51a6a538037e45e0cdb9db8930ab3a1199ad3bba4da7bce1c698a8a295b8629c9f74331c345c4bfd9c0f901f601c65d2054c783e29ba579d553dca64b04259c4f5e001ee2610fb8bb2776856258bb80a7b7e2837fa21af9cb2fbf27d592feea21029e9db5c7038baf5e2ffbe0cae6588d3837de69e8039801830c559c739b6c4a4c90e0e68c4c27a98982dc8f09f3e31f31c2a272fe69a88da32224721b5e9b71ffd5f4838d32b5cdfd1e103139aa29d7665ffa90443dbb3b53fe5df511ee2c220cdffefde7dcb744cf98997e23c87ee104af869124dc8c44071751050201817f78d6aab7b17a13876952b26d94af40bcae0418b7c120ae75616704cedf6f0c841b64025bc0fdddafb22db2a173140823cdb7b7cc4a0937c12d9aaf7a7f76d2577987df8383ddf626d76891f799b2bf7f7e06e17623004760c906d058f7f74cb1f6a010d5e8980133475b413bb0fc45a4ce697a8acbbd1863725635b6ab26d152738c774ba5498d1e18eade8cfb0da4f8f7351e296a65f2b700e3adc5d73de0b43dfc47b76e7078df62c2435094b01a3d1605218846c2a59411a5ac6338b949d3ea975ba6d140181802db8a7c334b4d060225ba126acb5ffe6c81aa63e392313c3158d92a1efc94958c8ae0c1c98ce78817f7734a9ad8ce9af1772ae04d206e3cfb3225cc7064d10ace2a03666f27363935442ac933030ef540ae51dbccd5b186df1c3f74b26cb49723584c9c7cb961543b928b9753ecd00ae62f8d170f8e0b80e042ec1ae0f52daa0ad96ea0701afad5bba583f03e22914220ff41befa1fa677c371eadceec24e31e31709a344db8daa28ba0475fbb8b9594f1f5bd0315424b7e2a0f3ffc3f8a3f817adb7e8e0e0be318a304aca64e169a20dd6abf5a9bee3e2240e21e5d8c000bc17ecc5b592a06cb0041ef7c1692c301e9e1dd0e8c5c1e9e94d6ccd133cc128d38ae44ac56d20731dfa76f3eceb186db37cd0fd213a4429950a872d758712d77c3ec283a276116e0d6ec666234d2b4dfa822a7e7a41d9fb7099d518ffd19ce6b475f6f9233def1189005f75e12cc1f97c164506a539bd1782ac3b7761a750443cc5641d43c2a906fff9a2f2f2a909b4195087c44dadd7871b43a76f0e05bb32fbfaff9df11dd726b13074f70d9c0f63be930b9e91b3c25a54b0d445e40c6d3c117c9dbe086a77f7d855bcd1ab716bce431332c3e42c29cf4be8aeeede49ed0c2226b0f1a61cec69ff79b99d1ea915ba1332042b3efb92d731c81b0c5c48a6ebfcbc09b7d5c0b46342c7b8abce66fae79dd02e6b9dd9e277b9a10fdca48e207b9084a7f98699d32338efd45e712d77ccbbabab28727889833b28ca5d9fff799cf8d82433de32a0b4ccfff1298eee2bd8bcf9428a135fb40cce5054208b768f4bf1d63311261508836aaf94dcd1890022cb3476c27b9c8fde5dbb4db90f4a9d33207d22d3f51a521855d8b0ec54bf89c04e7a3ba6c4a0098132d2c07dee3de4be82110c4609fd3913a43a92c047618ed70ec3cee2e0dad99c754df3163d438e3f2a30fdc2cc1b6e891ec57cdef26d4bee9f86396317ac8237cc73212621361488e4c58b6b27de4dd6ff17d7ef777a21206beca92ad288f5a5f9c96643e68e7e223064baa8af047245391b4b57db0f9bc09baa1a51d064f837c86b9af9bc321bb2bd7cf039430b0f20489bd84c4db499fbceccbd35f51baeb10e2fb9a826546cbb63611265bdfcecd390c8f636f3e4d64c54799deb7feae630ab86d97cf50f82b8ca7b9f09e1ecdf6808476a9d40b903ff65f6201299722cd7e85cebe70c3b776373d66442f4d17eb7801ab019f496ef19edb096aa338595efb804a21f90a131da80a0d7f1e30d89e24258904ffb0896ab177761ca14b15927f6943c6ca19fca3d017ff9c508f403de6f5f952c0da89c7628acdaa35f0caf4daf72b05a2a08c1e5cdb88e53419142a77d706920a895d7b0f925fd55d7f8e4e758c2df7c821b10ad7163bca1642652363c0baf3e61f3f4167f445bc7bf7e93a9a695b42bbf7be84c9203b44141b08567ea7a7025fdf32fcbb66c8ee8d15b98126f84b7bbd0434f4817370204111ab3bfffd63a25ec468910ac79a169e03ac975b3edb7c5e7d43e4bb3c3c996c5f09fa3f5bf44c17291f77dddd5b5eb4ac91a4f19106393f00efb797762de894c51050d70f3b27f3eebb85e5ff00f5b601074fadab4fabbab865b5818d69e00336009d2d4b7af247c8e4214707ced6eac06d5f997b499138d749e2f75db6e15f8a88de4c1549ea965bbea773d00a6c51fea05539e91203c6a52b8bd3196c68c496061ff7bdc8b7576b48077d7f6735ab436ddec566481e71ebd871e10d503a6f2800a43cda30f082a50a0b5b01a84413c6dd69c3825230de2b5bf864deefd33e3789eff3f342b28c335f396180f0c5f55b530155a2e4e656ea9846e9816e6e8b91f83f06b9abcf7e1c8cd6b98e30c1a0d15b3485f6d36c248d40a75aec1662f595e1ac4e300767be0edd95a976020d51631eaf993bf54a8171b44d20c296949cf6fcc4c65f01ec4c48e61c58f0f9b092574c9cf349ab4f7386b1a0d353aa03cbb860b1aa0c49bc24e2d429e20bf5d2e3fc8f48c2485448241a88ebf8b7b9af72f4979d496f7ed757fa1d040cb055990f02098cdf4730e97c895214156fc9b221e09ee188dca8b461253a9174a9b70cd094bfd7c6984a2013df0c4c8661f0a272e1abe9a643ae5d41657ece404fce29ef64c0b7fc4b7dfd1fff6183a4913d1d3ba4a63da8691a24d26a19b52aafa0ae50c205c7e7a3d24b3127004878e863f1f4bafd11eb7d0ee76f7be2d98888990086c455caad3c076f9f0fa65eebc9e8fa6c8eac2473466d975f25e1a8f387669888a8519681ce0bf1cade731ae59c71bc8c898c2328d26192e516ee8a722e15cfa647dbec92f4fc8c0ae98d7490c6b0d4ede69f24201bb96e093c33d02766f933d29ce9b22caf6a88c1254d015d5da489daad60b796e2e8765ac7ca13630fd7d6e8ff4a037354bd8577386f9f01865b454ab0266612320344c84bbaa75db9b60b8a19d181969ebcae3349e170a4888cfb22ffa6af76daf82350961ccbbf2ddad008169bb73c61465f6092774f83c97926cbf5d3a98816d471fc456692c86e5416bf8e304195d623c0e608651e7ae7f8b9460e4d02bc5035352ab7c02dd4ec72a56b3465a2b3c07cfa26868e8ec15a4602024b664f16d7892cf2f57bed931ab6538fdbdebed950319dcfe91a99c80e3e055c82a5a1686374e4b9a7c556b7ffc3bc570ee44221d8a88560c0e683649b279572e2dc3c9214ebb4d3b1bdfc6918687e2a479715e0934a2286527e844938cf8326566c8bcdb87433db138f83082536750bdbf81574588886774803a7e2d2242b3760292a4c3d2ff54ddada529d97687da8f413042e0990c1f55a35d9bd4ef785a20debfd18acd698bfb2001a197d5996f3ce8cd9b253b3c7401025303dd212f09fadb8a0ee5f6a772515173397bcf6618e832a712d3761b8a19626a996365b6f0dd09c3a352d31bb9e05a2f4ba16839fcbab21cd98767361cef56cbf9381ec2484728f1a9854a147361fbada312c19273522836fef4071cbe7dc69f1b8e6e83b2a90f637980268fa7b0bdf2578a546923dea7b2e99c8005bb59be6622f562f4b2051fbc5d5e6110a65e31d4658a246c4d28362b49525020f6c66cd108beef6505e8cecf6096c4322386e2ff83249670ebf2cb7dd283bdf1a54e05b03832b2c5fe5c7e9feb4b16c421690d547cbea0258d005a5ed572b299e30dd187872cdaf5c40f826331952a595c310404fa7049bc3cafb9245c394012db891cc29b23d67db7552c03e40ee3e9e0addae5cff7b5ef2af532e738797f2325c253567608fd2e2b22d449bc8dad3c0f1f33a77a857f840217e4bb3f4a47f641e4468aa285a90fc5f7f2867511eb82e7499f501fe53d1c56bc9e8e8359d8b84396d08c2477f2560c10516d4e2cc80fc402cd36a8bd118f8cf353df86f3a94b2f72a1c621e1f6ffa40ed788afe55668d201cd39857ec283717916260a6ef13e06483ec05bdc20dd335f2ae15c5fdf889f9cfde7e4b8be4e16f2b7e0c9f08577fa14be640fb8628f2b6c2f2a2a98d2bdefed10b5656d81b16fafae191740a9a348071ab62d774875a2e010e1e934641bbe304cd3277f883a4c668de014caecaa3c9074b6cd04d1f4882c7ad152365ce02d05ad657fb60aa3e75179acb1352343d161b95b42776898d8876c73ab1e4d254ff7b7ccbca31e16c9067a3697bc9c651ef0aac0546ad322fd4764ea0d7fa432437ddfbce0cb514ee0805c7d4c001217eeb62b83054c8387a731e4e9730d8483707ee44e6ba84a5f7646e27ed4a63cf35b863fef2c2493b17bf65565eeeeb65724a28b6c0ebccfe35fa94401af2b2cc8c73208f843a24234894d9a5c8874ab548c4f30d46e4cf9d570501dd661028d56c9ea9bb17bc177e97579d47c17f4462b7af44f4eef38d84d43eea27d53abbba176a47fef2c8aa685405822200a0754726065a61f13b105306af5b5eb39205ba5d1f07ca358a3f00b2c6c437797983bc3405b7b80aab676346d741c57df016b170be2f01762eaa39a80b928cc5de5e655cd4a20adda46d1d9b114e8eb7bd6519297ece1bf3e445343af6d88c5286d40a35fd1862730aafcc88fc2556e87bf48990024d9c8893e4f99b029b24c8fde5f52bad8ae48d7db213e0c6342f5f636d31e89aabefd596f5e50a5f5bfd88c3fc52ecca151be3231360b607ca2f9b3ab93751fffe68313e029178be0f47e76147e1c759c65d65692836deeda3e9c1fabfad21a08a362d3dbc0750951ef5e10abadb2f68a3efe3881d907976c5d69f4ec5fc0ffa3f518187dcc8c09ff95a549fb9e2253df76f0afd840d56e403dc884cc34d028d0977e50a8b62537b768170429261cda3bacd99ba152d962c82df511e3a25e556c2ab43c70c4d7454691ba8f17730b7ff896d3c406f13ab7495bbc8cf28b7332d4585c1068f32a29ec9770bcd3f75b772b437ec34ff31e78f0cf42559c53540cf583d76cffcdd8f657c3b7edd0d76555d0e34f6f1b72200fd4504ea01eeb485b9e390e646677e25d329d040575f6e3b14b8bf3ce06810990ab87e4e71d9703f9cadd494e64786ae8dca2d15fdd687c5f4680753362233e061ea0540c580bc6b5363abde2127bf01e90067b484479d9368d292019b8e125159bd2efa82acd22bd1d83773ae3353f4b1f0c9ee4b25da16fac414953932e69c88dfb9f23fc228a0e1bc362927b2691a03540a45cb88c44c64b6a5c7e046e64f62031b097c7a373e612a9f0a53b7c3f36309c7454e570975fa3bc275421353d1e970afa492b12509caa7bf692b1163975bb8a1e0bf7c94b0da8e3cc125955a94356a49012ba81d2cef46f98cd0017ae09cddc64d89cc3485829753d47e9854b486b425ecea7947f2ab6b94b67c388b083122b35f5f4e41538b211f6eca685cbacbb404ae79a09f8fbb8d928e6a975cae00b77b21a7edeb578fa9a0658caca8e5ec9ac514445d9b0fd793f9bda5865ebbac1b5b538ce1e7c488c04e20f4233c84bd2629e839f2ccaf56ce901ff0bccd10e8c0bb44f8970a103fdd7558d3fbeaaa5d65eb79cb4cbe0720d5bbe081021cc897adfd4f078403361f8fcb3f552265e1605d50317fdac76724244a48ec53eaaf03ff5ee1a806542ce61ca41d22f1ba904dfd30ea865fca6aba0830bae6bdb0a8f2263edcd2cc8fb29fd3aa13c728e672fe2a69559e532484a1fb99c80930995766225f2fd5defe16024e1a0b7c7259aab80cdfb59b37a955745f50241fbfa6fa128e864ae20ca096792f7baa5f1c0bad6192bb55ee1ce0832f5c839536c684f98ae0a11c3210d4c43e0231d3870e697fad94087b73d0528aa6b30096293ba3db1fca2b445696e3e09f0f0e2706bc817b08a95c132f8611f9bc0008cabca78aa293393ef5da7949aa17d58ad3cfc719978dd8f0702cdcd88e5bba07d12c55c57d8451a76e6bbaeaa77423acd95e4a7d3cd679670e50ef5d13726bee6c75a6248cc1a1a09b5e77889baf8d63dd51a5c4f90e6904424fec5eac1f5156e60ae9fdc5785192f41b26e78468a7096cfd402b2135b658e9b2f61400a3d7b75aa5b756db8f3f30915522ccf7e03f2de9c2d6729580913a2e5ff3e6add6cbbe60416b12b19e85506b21b18193c455b94176226a53faa11c37e8c4ed969b822636924b379922bcde5e6560e0272c64be6662f6b5295c37f305480cb93207dab99d9b64db69ab11f375e3a4fb15c40ccd4084558e2d43dbbf1cdc4b58fcd682b6cad65a730276e81849d0bf6a8e0a9915332cef2f0f7fcd7aa537deb668d9cc151647219ebe72d6037a4687ab28c208ed378a97afc76c6bdee10b7f9d5b85f97812f54b07a15558fd66e25aaef467c798b58f20b008b241cc44f3861f4e48a81e8f84b5555a1809147baa5aaeebd0bbfcffe177e990733cddbc631cac67e1300ac860bedf4cbabab779a2a53ae69e5f7c85ec0d6302e144e9ca2b4df39e51b273ac1bb98ca8be73b9149d00225af30b1aaf909aabcbf41b27c3a71109f94723607af86687823478efa6621e0d09d2acd496f079c51799b8ff178ebc19797b060c9c7200a4257babe748ebdd9ab4bff366c6a1e12b2198a66c933224486da4e44cd22fafd7be7a0df3300c3e16865e0ad7e569a4cdc527c458c061e1efd209b472cba079e22ae23b2a668340d917c6b307aa179b4829536aa892c2bb3118e68c44c53beeae31c1faffedaa54221c38e730996c244bfab472422612bc4f176bce9d0a13287f7d181130af294df579e5f328005838b2ceb13bcc35ea50c9d299e503478824d093c51c023f2b06d93bfac23d194dc82adc904b8a356cba8660e306387f1b8d4f1451c3397c65ded66200e1902c6135084af36ce7f18bdd001db59ac36838009f16c4f6083eb17e429953cce1be9bd0b76ee525380be604b2a1eceb86ba8dc890a6f68a6f1fd37373672e0fdfc4c9d51ed5b1318d1aa990886d3c45c7a48328a92134247dd139ae52c623b7e9135c6bd1ccf40aeb432f0d9babf5e9cb9e053c77c32f17bd12279cabf75265ab6d6a46e4bc1679ee5a36e2fdb440a0b29861c7d4814b56ab823d979d148233523c93934053fa939970183d47b3d946b48a8820887b4eef2cbc2711a81869e806d5fac3987f443a8e98d655fd4153f30e9bdfb82b56b8811a581db56f6a60f6e0562545e30bdb5a27a9d44d2bf24c7e6d689a70d5b58796c3b92c8316ea1776b2ab6db4b1cc424b7a549b2f2f2760492706fcca7aadf73eb8c27b152fdb3a182ce8195af2d767a8fccecc0e031a67d6b4b80c1c59ba822d6b20622b4e696b1c932a30d58679c4d7f5ff24bc902069506c5384c379a25c1720e9dcee2197c0d5a55749c837b2226c1e67e5d66d1a2ce4037103074dda43cd320e4114d8b19ec69cb361609399ca7a117f6268451c1662bdfcdc64f8a2feb64426f3eb6b9fffdb1f65385eb12880b150973a3734b6131e73b3c10077981bd5ac685291f5bf8c430bed7ab74e1f5d89541e307724ba5d4e6fdadb5d66cde059848d666a0936626c978cc29f3e18827be4a1fb0f1942c3a7817076c6a1a0dde4936c7d7b232da38896315adfb22fe5a767b0af89985133b37eeabfe25b230447bd99428383b11f42f5fad0977959c8bfac5c6f15d710d3bb8f298e549434cdcd6e24e26a6cf4e52d4c84ffda89e9515acbd656f5a41e20cd555eca03645bd5fe171306573a409302afc45859303622c928bf2c9e0ec85620e489f3a3110e494c748d5a6c917cc2f459078824342c17d05b4dab6a87b7bb3fa4621eeb7423ee15c15d17924c65d6ef7278b6a1c82c4e7d3898ea72d52ea26b1bf9f769a28affc535da55f36ad21c1e823ea519b5702246d4d311c1fc3be31b207a365ead6dbf02890714dab9b540d26acf7f9350e585968daa4d9b90ca6173d6948ea3f8d30f02ae15bf30af7e559ec71685859d510e347c743ce9825b0bd4cac35e6f6b359d4e5a956404edd87f0540188d366d872181c5b3cc4a22aeabafc2b70ebebba1009150017bf127e3ff7f94d73c9a94034da94383021b9d213345e42ab86ecb8e8c5445761eaaada8bc270e101e3a53c1e894bfae029f344f36ba317ff341c0069b117f0bbe768ac2451c7a48469c7dadab3ab8806e8bee29fdeaced09751ce10adb091ff3975ac2f887c716fcea766ba57681af2265fdf314e1e300a3142e0c35183f9753f75e73c69b41d2e4813fd4d9043e349010c812920946d2f1f0e877d626e8206d266630756159b808f890d2a70e9732337bbb2feb29cd5cf0b9cd2a5b49f43efc9107521c77c67935f3bf53fda3854cf8460fbf1e86ebf33aed8640b83cdd43907836ed7b7d10e906ad3cc3fed1b660eab307f8741add9e454201d2b933886f8e0e22335873752915ebbb7b8995bb3499f957c006207b1704df9aa2d370705614781548f21c863602c90e0156fa9bbf0d3b5ef48d35416eb4a02fe05175fef0940f931bf64383fc856bfcc575a2882b3d148bf1cffca336678965e2e526ec1215607251ca16d87d252d04615a4dd7745d64c54c0f418a1443892d6175749562161ed26d39980648312eb75187521271832ccca4aca6254d99ec30499d6a2c7def9626e54728cc1067048b00c0c33f83cd3048ec5c31d95f64b6d5b51979089745c97971f29824ecbb89407878bdd39efd51fd60b03f854db27be560b9efcb78aced5c091bdfde9e05ab2a6a182dd93e507b0565dcc73f904ca4c89156c87daa86ea3fe4209ec4b2368fec3e4393e2987db0e5f9ae9150c1008094d112e30d34dec658179b4eca71d8d8d4b4357e228adf2a676674b49b6462b8b564b0d81e78f197c2c8d70f1b4cfdc140227290da993ca13088c1b877bd801869c483793e16bce77ba9d0d455a7dcc7199213b8e3ffde30abcd6cac8465397dd41469cec39cc80c95f907e21bbfd213fabfb6b943903f8ed7d3d6bea3ee369d5a0ac7535707d24b8744115d460b6ab22dcfb4163e5aa7ac6fb695f3d6506f5a20dbec17199c3ec917b4ca1e4d4221d5729680f225dc898a9a9a1fe85d5110c43b6d41777f6b193d9f9783775149674ad134d01314d7f8054e1427070326474d75c088f1493bc0b7d0e2130bbabeb715a1208a4d573c988fc25a7408c9c932896c2d234d58faa0527a457d45e63cacb7750afc558cb1ef2fa53149ac0b5827ef79a5a72a46571b1d7e43d279efa25436479943242848d5c5268b403f19a64f3e807dccea3b0518dc3b8c7c97fb21fc236c562cbb9577f70660f7376255298cbf8c0a0ae3e322ca34e0ea3cc01d9d4f7e7424a3652221b58be49f68486c0fb961145199b2fb4418d1a5f009e63dee9853a17fb371d094680578b91725f804613113a45e798d58bb592edef1af1c3f94eba8bd42674ec48ea43cc1286c1a65cc857752b184cf645c58aef7e5f2e2ed62b49734433729d467845ea0d39a2869049bb81de1088ca54aab03b08951d1f6e23e7cd59f682d83e94ecdbca134a0f5fe55ca39f403756a293e793fbeecb4412699c338c23bb0dc8adafd6b8cacf498a77385ee895d9915a59b7b38fe081d78ce2d94c0e510ce9651a799b38e51a557d998b3db2ce5760fa3b86f19d39f8180a7714c7e186868b53dbec93693dc0e9afed24fc613434e671f3b143a2b14977f2850ec25fa71f6ea3cae5887e2fffb669ea838299a46506397a22f50c58c1844d0d584583447f1c774dd22376d4ceae6b931219b437033b85b7316c38c492ab66a1f3906381e3601629c4857836649c43dd5787051507ba1ad2d10dbda2dbedd692643b825089f3fdb383a8aec4291a665308fda0ebfee9bffe2fac4642fe52aeed4320fc0e02409f3f29f4722c1bf9bfa5f99603396062ecd15e32c2542a567d1981415fba0b8d1390701c6561348b551df666e2073b64c0728eb733df645c1ae501e001bb05f930654e289391442a75e584b1f0a453d1833ae6a6416252cc2c7f75d9c51b4ceb6685faeedb764ce1e807f260f7f01959c1c798afe839382ee2d8ab132e7b7d0949ddcd372506411557e9c85173ec828e8bebc06de75e097e15ed0b40394d509e0b8149411c8e9f315de465bfba68245b58ea95d95458ba94d3268a357bc3dd7677bc4751d0707339e8b4fd99726057a263fed2f3e8a1602dd8f88c059f5489ed19c076883906db65ba49f8a471bb7466ff90b5e6743864312cac8db278955a3642d8eba4a6ea83464eedcfc85b4d5e0528e14b81484a0e8aa3e19c4a9c13bfa2fc9c13c7281c62489560129560c84f7cd5eb2d3e030a69cb9570b7e69a7b84c62188c9a9f87db8232f65272faf29b08368d515614afc981d3b36356e82291fa71d4aad0e7671201e78154d95b8924507817a8b8cc3ce416a74206e82fd3c4d51b0ba1e4ebdbacf52f7a504887db3280120adc738a2d4ed250a3728b2ec3752a9d6ad95ffa7cd289a2d45886c9096421cfa18fd18d596b893822a45254817b5b65be858480625f7d2b2add133eb197bd2f39e1e3e5b46a6334d13ccbcda0edd4e69082ba5deed40cbae17d82835a553e7e5990a6eedac2c0f8af808eeac9d7c88801cccb9b449060c116df3350bebd03c89f9bba174ca85317c1f1699ef2d6b23c8c6e2ff57ec1b886092a6a935abfe59a74ff1ab91a7a39d3556dd2a6507770dfa74296f1323e9542b0f869b4e5d827692ce177b21c827940a7809bdb6f580afffc1b8539a125ccde7aaa1687aaccf2a7b66c1a715ab8a5b9fc361cf1e5b5ab12344d0f6517c4f4a5efd9088dcbf7c2e40482cbefcadcc02399f91e627beebab691a7ff78448ca996331e436551d759532c5c18e7645ebbe6f6833cb8c37c4b6518f798c81c2e258c816c9c4cffc36b5f13b62fecaadea7a3c1cda20570c69e9694ff286aa48b31ef7ee134d7e1013c7945902e8a933d862e6add14d221d8c945d508eb4a8d3da5c932a5a20a88ea16696ad8d9d38cd11826b1a7adda6857515406664c569b85b3a4cebe82db8e12044edda90cdb1c4890b865a9ea86700f1aa7970ee6b443c6431659959218800f0f418620fe351b20af24c92d04c7b12c8974559411cddcab310b8a779b9f9c936acc35234dcb545cbb74b6ccd6aec4b7cc5b6fe270e002fe354da7bd745d3ed293e405f9ac1cd41dc1a539d8357187399462b5ae48e3cfbb4fd87cc2d4c4e5a18376a532017922ec95b823c6f62ecee1dd427137c6d22ba9dfc085d79b6cc121752990bebf41105204002be938893ff68c2f26079d1c00eb7fee3331fa2892c7f6913876f66317bb4a4af3bd23dbcc7455c629c6441fded1bc24166fd6212d132e8aabee04a1bdf98642cd2d1c74b2abfb54e5bfa377fade2ec833578c8514d661cee86276d83aade9d2882ca64af864dc86180e7b8094082b98622f0ecf0867b1ed413ecccb6776ced4ffd6d79fa2e8571e34dd0021a953dd5fdf57e987a6de9feb94e514ca8fdb63faf0cd8ebfabdab64537e95156f5d6202b1b6a4529f7ee72c25d292f92bee620211a8cdfa950cc8fcfa123414024160701a5dd99783b8ead9a206f3074fa42a6a41291a4716998f520e9efef126b1620425e78b2b76dc455a42bb4f2d23006968cf5dc6bacd518c963c113bc4e5d9200be0c724a5f50cc164021b60e8eab1e46f659a0e5043b7e8902ba9321dd6d4a39db07168653c654cd817669c3efc362eae377b9a38e9ceccccee4ecb8cecef3b96c51092be70e50e560083ee91bf7fba6bb261910b9b20ecb1f0866906d2e7d2f7885bea2e2d324e96f0d73db4e95096786547047610d17f605a68a9f633c4b45cd8b0d2406c701ac9744e4a12582a2077da57768429a4810f5e0568cc41bcfeafd3b504ded79edfab7caf3e92cc3cdf6d0fdb5ea5ce0413185f121cc8e1f16666c995ff0fc2217747f66c93d8ddeaf43ca6c48d3cc05813ada33932d19e6d33a5ddf0c610f06283877c476c626d9daad88abef5e6e3f774e794dcb7f804de3fcf757054a0c83ed50d0989e37804720e3022a8ba73d1a6c5f3aff2a2aa354e8ca25a8dfaccb42aa5d12ded1df1323a01e352fabe608c1daa18237c403137ac3b40ddb7d80709fbda6e697eacfd00ecfd188e17d574e26376a1d3e5e1bded4564382417d477c6511d58f054eeb538ff7c882594bfb33b98d8fba2154a11250df527ac4c0adaf058fe6ae3e3539b0978d1b3353123739029f6b1ce5aac79ce2b8f3f9e320e9e14d5f7b38805582c5efe530830363c64924342e4bc102b5520ea65aa970cc3c76a3d5253e746d0b55629a97944b1ebfc8dc883b49744ff15279228419f69d9feca5c76135e4ea55c40796bdd93092dbb58e2bd6a0d6f9c1e6beb2950739c06df3e664efd5528d0248423c0d33a1fb6948ff774c5bbe3cdd20f1cc3a555b7e8caf3179fa9d6bfebfdbc19c74d158709590ce439f3122d0339f96e6416b406c6c55fe63514f9516a04a484ae70cdd2f63ab5415c1124c5502914acd5eb0fc9466fd4e125346263a06dece664f95f2f95f4dcd1024f1a988e5d373da6ad60bc67f91033ea23b21ab0604279759ca969cb00f1980c82ff682b33395ec073b5a711e1a69d643827410e6fa651515a971101f4be387a75e56854f21bd45ca42ba49008d53a75b56c06885bec40b19085a26852426219483eb76e697e21376614e6cbffc42207037f247298b3b54f9856ba89f2b83dde6c2f3e52e8a47aced726ff77f6dd8fd898c03c9f30ace2547114fa4dc104f4beef6928c5c20b24e2ded0d3ea5d8a9234d35cc10fe67197c32dcf80f07b5efd2ed9104add13fffe8a3be70f0a860a9e74881713638edb1d458b0388b6489ca29411967918a69c1d7cd7ca64b43a779214c4124a45a046205acdbfe8311894d5c33a7b56a49a43732c876d031eee54c6628fe6615018704358034bade840d2a8fd25cfca1591f88cf8f89244712562e84a1bb390043ef794815b8a22a8839af6269f1540fbd4bfec64ebd77562b39a82bff695341e6768cf09e618bda394e5e43b0ed7040d7736d1e886978a8929644f775ad11489a535190c1c80633cbf2d44da8ab048a4fc827dc6dd60c21af3bc56077c835e301ff42f15ff89a5d5006220431743aa8fd410d4a09b9c797347cf46084510e8a3577dffc7af9c41c902538e6525455dd8fde7add781b07c9d9a286bc1d6ebf7d7cee48dc2a244c97bb8a4f52743a78764806e21ac7186fb37764c7c91a128dc019508cf8240d9237b158c18ac18730f5c4599bbc6a6bffbdfbe6a98dd0cc1d3aa7a8cfb54de5824b4bad959de81f8d59e98e261951e943dcbf29c5b8aaa6316fdfc0295894c1ee96dceecbbc882ac1c1606773b9decda9a0ad496f3a67e1b3d96718a41327a39993730fd13ad95e16c9a302328f62e357526e28c2aa547e4cbb11b78b7896746297f23635e3b8d4cf11ee3cc3170b6db4848d78328c2dda70f05cbb85f104d608a24c5f0566ad6687585642686b0325ad8327bd9f530268bd4d8cafcc04a5d187a77f79c9b2d46d94bb378fb0bb2e02c21454bc1da72f74df28e93d2a182cc7f15040da0723339e9088702e1b903b47656421911a2cc1c51f2f2a6f426eacc137ae23f937cc6c950ad66cb2e9849f174b17889922b6974b5e79580b570bf65bd132e7b749ee97da7a56a198a1f6eb98cc0f060cc020ab68db5e8b20da0ed8a433a6c06afa24b11b690ef68aa5b52bde462f74663cbcbc9a4772ba5345d062e7d54bed5b3609bb89f66ce79fae09484645674aee2bb39ce25a3cf0bc1f68a91192df03f34dd85375c606330eee1af47d94fb09044c1f18d4a7d9eb25a80ca0685c37faf637b23ef3117fbccb99d5a634c7100d71415601d54b1fed39356561d9869cab9dd001578930d5590a312599037f678d8e3c37a81df140b87470faee8f59e506e54bbce2488f3d5c1d8aac44a37d025cf87421378a1c97caaf6f10584f7f74fef841bb8b8d020a5989abf59e1e77295fdb9f2cf06e5f937f9073be8781d179edb753d5e430e1fac1557e7bb64bfb842d98b19c45741551fe3c5da3e3b048d5e11516f8b7095b60b5c153007056bcf979793270d3cfa090278a28fe6ec9985fb241301fbba8bbc3d41d4007be00d73060c79c7533d77a81a51416ba44710d0e73b1d7c7df066478211ba11da2110ae51db23bbed9641e775aab832bba4bcb4cea7b176180d865366a4b2b19122a9810430b263db73bbd27e9fc6ffbf892831b3898f63fe0cb63bcac369b0c8e9fa38f37013d245f736cd74aa8150ae6727c00507991cfe85dd136e856a26e57850b59cd5ceabfe22c9ba60f5cbbdda4fc4c1ab8cf844597916d090704e7028681c6f07204d84a451428dcea3712569d741ccfe758d69852f05e5685d0e16f3a081315dd4300d841dd2ffdf1ccb5510ceb418862e68ee75ad761d391bdc7b4469545507d53bd21392b5dc649865b4e193d4600fe149fa856569ba2b3ab4ec2d8e0b3656adc810f877a4bcf43aad644dfbd2fc4b35e79c09c235bc2243b7261edb3de88068b5611636d3c93f419b23fed97b243bec67debc035c1a075a8e41797073ec1a1d9781ea43250c2114e9ca99abe727a3be725b2b73fa475dc43d88bd029f9700c91ad3dd5f8ad41b77b5c9550b2f1818f012d5624058eda44061848b71dfe9b33ada2a81603b34ef910b76656d7cd39b548660f971d33eb3402f186ad8ad1edbd0f96c38f62457545f3bbaf9fe451dce805dcce9c4b16da8f8e3a7375065782927cdbe8425f1ee3ba22d624724543f3edfee7a32899a9f91b518314942ecb3fc59d322c191092d38086a9099af2806375eb11f066395d3704348ac12cbc63ae8dd8da38c41de2eb79cc09e9ffe6cc87c2e033a55841eaa1bcec607a4743c80db7ab76f7fd5b43d12f10c63cd4be03031d4d53b624ca8d28c6e95c46e7fca31b5169dfd9f33313fda43567865c603a5d2fd683ce98237328a42031627acd90feafd221ca239d600343bb621ed5d9fd8f32bde865bcc627800f89fed104e0936705b72dd4997212620a60ed5d55c032fc9fd8f2c75a92523b053a6b7ceeca57c66c680406b5fdbf4b84a49ae71ea6a777644c24c26b661c428e070df3115cd27ed7af8da2c1be902f1ad0b1a4428cbed5a086b7b0ef7fc63a513fda6939240c306df48804370fd28db8646d16af2b0e8fb83be2e9b56727087dc14a4981a2ca30fc8b79e021b163ae98fac220f5176be7feda4884a5a502237d4a869feb0b57d7a1b88cac490015583fb88738f7af5bbcbe79bf23d94625fd217c11397c35c74fa4808cbf880251eda9f17db6758a9160e02bc98dcf8192611642b789f2a52ea3666c509cdd5ecbeee352c0afee6421d976b9fc04d8e1ebad8e62270f4f958065f703437e58c12f15dbd9324b7c137f8f7e0cca89a0f95044f0a3421de446fc8c061b7edb9c89d2296faff15026c88942d602c79342226cdae863c6918d9f38febaca6939fd6730b0b26fd8c23436fd7134b8983cd84005a74e17318d67f251f93fe94129d29e6997cb5b5d57d99995b51a3c38f3824675bbaf5a9814307178f9773e86913914820905f9f9516fc4d4053179356439a13d288c479f8f5ee0b45d1ad058854508bf3f1662673cc7950c7193b1bd0a7aae96325293e6372a44c4aa3d2a61010f076d0d310b9e76166cb9ea63e6eaef1ba88fefa700918b81c1b577078833c22af5a7743c229a2bc78772619e06825cdd4ad632a7aab616436aa9eaac035ffec34eb1e512b9513b2e328749ee95c29ee0cfdc3b697b05bcb8efa6a87b11ea65fd4368a919934bf55ef8743d370481b62f5b4569e7f902c92a0d5d8b6f9656abff3df2d0b400ee63a83c4f01f16c576dcf018b45da9d0584469f99c6e7d15fbe28a16f042c7e83c216ab66827dbdbb8d512a971dc5ad1692f6dc94aace3da2435395440c5b06967662d8fadabf309aaa92a0a722dc60ef833342048ac991c9de0d23bc9f81706433c4c3bb233d133f10dd248ec2489aa93000da9936a3498d303a715f64ea8a5d91ad5566a61b4ee824ccf6b0eb32e81f1b68546ee5f4d38000b6ae136efe3cc7a398fa1b2295863228ee3409f46b19ef0681ee71bb85121e5a011ce2ff6330d4930ccef95406e85f60d88eec0103972c219f896425b6035a145f612ac26076bca6ca2b90decf6d41c6a347485f05d2251ad36c42eb0ad9b80011955ea280c30fc9aa85c36a3acf447ca73e0aa25f66eee17296189747525d781762ed44e56c5cdcff53f1bb13136bf3e1346509b84cf530ee8703ea674ce794eeede86dbccf7f676701c963207b66fc8ef3bf263a48ddc65249b8518d3ca8b494630eb5a83e1ca4177e6afa8667825704e9ad0d6d5aeade7fb1626466df62180a600593a1d6897ac880a1f415a0ced3f0b911494a390a15ca314f5cebbed5b92e3d8ba69bd4f2fd644ea6ad2534c7705cbcfcf46faf7131522c7c05c3f1f75081c6cc053bcf22c6fa56a170c6b7816278143fb84e56443afdfae257042cba0e52f24d32717c2574da110d2c9ee87ff526308bd9aecde4b7a07e594f022c28eea9d0159d5b35917fac23dca7290ef8c15786e009303223df2d35afbe7ab06aa8714d0aceed4ecbc69ff42b173543ca41186ca335c38b26074501d428aa398b8327cec30ab544f97f57e0c88248b2314b07eea96d6eaba33758103eddcc9f49565e1ecc6fcab8c8e966401809442425256853e101c08e725e2c4dd8850bf80d08596e7bc0dc8e099643f5c7031c7d598118ead4bb1d8595112853b16f1753b1a5611055f88a1e472815f9c3f8d29808fdaa5d41747f9c64a6fce35fb84f1c61a25eee7f30ee86e1500be5c8e913061d724d825830616ee1784f08f879e86bc16cc060dc337a3dbe3c2cfa9c029d7d25ed452239c631756a1fb501edff875781edda9e4ba881005a20211bd23ff99898b829c7284fc567bd30025ef80644b2253b11ba16ac3ce2840032c778accf3ce8368ec607ccdbe97872b905e7ac56b3036d5266b94eb0d9fd14a708d60e5a0ecb6fe5a6033686d241e13a1cb08bf015e74d47c6155031b4cbdd8a73311556f0d63598731f7a6fad04bcea54aaba95981a3e4817105beb82de682ee5406cfe4270d2a94403ad41688551ed3ea30ad669eabdc64caa794d5026f12a67b952ba393438580113251239ad1bdee71dd30c8203ef3dc573a1708dc04c91cdaf09dc1a80e0b6cd1a84b7414b20bd109fd769d3f7a1d6da3f8281a8eb6b949e734728a631597e182415a8ade7e6899f1cf7ef8d3b4046e031aa2bb1597f80ae15bcb5abaf30b4d67926f4f0bca44a684f67d37dcfe4843d88981ac8937fb7a65cbed5d23a2cac38be3460b8241e32914bc6e2740da896d45db332cfd49ab4aa6b36789b8066f880da81d7319dab7a0046ac7898e5cf33fe3609673fefc9b21369bad4544e1b173c16a76eb77209baf603c5fc144e1fb388d379db369323d02afb80189f51dba86df1a95d51ee12292eae36f9c4ee559618eee443e98c7978d01db37a3624e42b4a8143b01cfcc404a8b87cf8232d6a07e92de3601ffa675951a0517a94e7bd73fdf8d593e1337318412633b0352704f207e52797d2b9a30907c5e3e43ba96a057a38e54f1d4b3c19b939cfbfe4942a7fc204da780bf46448fbd2aeb254b09a2decefb70e6f60a4b3db19bb462a1910418fd45a19277981e6587fb55381fe910260a7c98854d2f35fdd9b29d361d6f50778d8ec216fbd38ebb74eaa96503256083aa7daa577369be53dbcc87d4db01f08e8b456fe46c8cb7f2d217b495cd7064d286f4c25b08650ebd7a778cacc395dd5330edd304cc0fce5595d2c7a4bbdee940a4e1687760a907a6bc6ef65a7ce84eeb2edc67382c6527ef70798ae4352186745aec189ca68b9810bbbf056a893b1d2911609e26cd9a016ae47d45bf0c4a12066ae29ed0a1e63fcf9340c58b0fbb8cf1b8195cc93261ce9cc086e105801b18a4b8d02c30324623a946618fb0087be89a0dc295f56f058e44ba201f2f80d4fd7e9a49e49f83d6d5a0abd7617ffdb6afdcf0875cd784b160fb98883c01c4dbe439577054a7b6700664d7385d04b1189e243e6efed297ae52ba1476de7d12df8c4966c42b9db2fc422020590a3d1f61c94236065303a1c3fac14858855b09bbd2e4107b593f9e5f51be7c13e512cdbaf996f61acf689d38029b09b29e02468168e5e6fb601cf893e3ad53d29ddd51f5919b945a07949bc4cebcdc1168c55a9edf9dfba33c73bcb3853c9ef94c6d09e306395c6217dfe8dcd98d085a322f8f8eb61c67304742cfcf1a6873a01a4189cac13f01e9aecc7a1eff61695cc62cc0d4887c3f98ea725e70c0537750092ff6dea520a6000463e590f0fcd1f7846909b925e91c1b52e119879c07900410855a603b70e1242cc89578b013aa3c6c14e86d5fc7668f5c4a359bdec3071083f253a29736706433ac91e8013612027662badc39955019cff4e60027efb3f865ee75136b947b0b30925ffefbfdd908884ce68f238d574a49051df653d4786a4b70fc57f6220414502015bd5ad49ff0993f3f8ee92aad70d094dd62ac9fa088ea5b9c3dd007800b893d78c673a544297518b62111cedbae1ea1f8d284b1bf577240107a99c76323e183bdfb9953d39820ae4f899a044b1ee38d3c3e3e8e2fc00c3943f67ece80102719b9ff96242ec7730009e6a5b0656df62d9a685a34cbb7c4685121d1a4f406445f212a3ccb4a59bdadefcd76ccbbbea8843169162e59d78b796535eef7e56416b00e01db4e1555d6fec8bc182fb2756d90418497434bbdb42cf3104c2ee17720ce5de30e02f19112378ad0913d034337c60c318444453d8cd1041c0196de77ebb00a6df34ffe4fc10e7f11a27e3f61a2c6f0960795385257b81a02eb50c62eba1affe3c51fb55a7956b6c24e611c6799aa88a47e49fb93d0ea102e542183d9d068a896adacc6f4c841a72ee470204399d69fb2850bcabad0fa52f23e8a2c73ec75c2416bfda0b1dc3ba226e1bacf1986c78c46f626efadc338098d0cc0af69ae565d42c3738b395ac33304a29dc715e811a20e96dcf7e95ef102143df20cb6c72bc673308ba5f702c4089367059bb3d18447d5821f416f222edbbb48799a20ff1c0990d18853ce9e7f1b32ec5db2b324e27ced0ff954050cc918ff95d74c7d3ee5fd1d38dbad6753dad6814be5915fa3166ee31518f785ef0fa8fe0ba3a8c529202157befafbe2983f5248c4700de6387ab4ec2c026fa0ec7c2a4ca3d6886d1d3fc7851c75e957c4f5809d3b2803fc1b2c54044b91a93bc99bdccc751d14d6cac862eeaa5aecb394bd5697c004d8caeda0ba785d78fe353456903987dca89f6d48bdabbb2654aac2f0e999feae1d6470b53f69881e696de255a7df1cd1fceb9209e7df9da790560a068ef57c940107c6009efcfec0816670e017569d8f16cd917170f954fde0df85da0f7bfc41ab273bc3386cffc18a84caf477f6ea884656962b50563e03e09fe31bc73fc6e6c0b7fdc6cde162c05fc5159a2d8f0fe39e5810209518292bb003acab9be4bc8fa1dcdfd719d6825fc33e8b81ff46fd2fbc8169f98421a3e53f99bd7373d1feecb0d414f76845f092bc6c99d3ad52a864a64abcf220ed3767db1c4981d1b4d10b1ccc60cebbfa1401e351496cb74cc2bbcdcf175f4a22316120dfac0496ef587c897609173044a38555a8de1534b8d5ed9eb9261b84aa302f6c44215833fe0184e19626b09d09a5508468cbda763c39d685979bbf18a4d3f2900d1fe2ef6b381ef162c1037d1710eb35385b9bdc0ce83c30ab543da9f0a5f338a45d4532ff3267369542586239d62768f08db22e843752cdd10c05b7b17f5622134461e3f2d7c54d4f302fdbe6c40c1907952d5a1eb47f1bc8315e70ea24c7a7faa581fb4e7b273cecf169bbc8ea68819c96a9b8a1f8ba89016ee759da94a5b88c563201b855fbcfc0dd1d1121b8c59e9d8843f6390e9ee9ef69bfc12fcd7bb32fa93cf1250467d22df7a423fcabfce217ec275f8ec14618bb012c55a61f0ed2e75dd36d10d185c720cfa638b54c7fc495b3ed1b3799c3d362da013a84f48069c41094b0e29bdca674bb65110733c77e8c907b8f4754f82ef1774063ddbab4285c88092b40c06093d63c1c4f01b515be24cad32a0bb3776257f167dc7b3213a6fe92701fcde5c104eaec08c1f34d486f903b3749889c0e29f4d12cd0fa9f728c7bc22874db9db5df6e06ceb17298ad9d5c717e32b8e48322340287bbcb4f135a689e540bbd7ef54732504f5d43e2506eaf7854d908029b9b9497c181ab92bf815ca4d41bcc1516d93c2996ac92c89ac6a3572a6ddfcd692e1840376f8f2bb128298c711e304e9699c005dafa72e83c93dcb0606d2ba971be9768d1156a510de765032a3091d369339e2befe6ffec882c6f163dec1f5254f0a928dfd0987f3db5583271d4482a5891ccd38bb7008ef7fc781e18fd5f2609eddd341fb675c7bfa02fcb9fc4e92bf4fada53e2faf972cde567633ee4a3568813400576c91c859168d5113ad44e7e9eb9a45e421ecc89b3a02464805a2b02c55cd819760b63bfdc49eb000115b7170eafa523293b1c5e6047ac6f6766e81dd9a6301e5d40298fb5b706bf3ee2f26a95501a7f9566709ffa5ba260cf54361aa33a1f7760bc910ffdf9cbfa2718b68db49fa180ea6bb23cbe9cd8f9a4e788f150ac0ef4cd9c3f6ea3d01692848c932d3acb66596634fc5f0733e4512e8bd2550f7c8ab03d50a310f455afb4b6faec65ef7b5aaef5d05a4927f159fcd355098e676046ea5aa7a28c35df420aec14e2c36b6531c31ae416e10641419c6874f3b878789f2af16f03141ef92603d3951a94c9587d0ccfdf119f80aa81bb0fdfae9a153cf8ff9664fbe2f916e5df692cf3158c9651a025aeaa82fcd82c767754ee373a7295edb30e56f6bc93a499d1a3dc48601284e78eb3d773a0bce10c5aeb685589467d6c15e97ab7d62efa712b383e420c8eed910ee7deac7892835cf22fac5f0fd89f024c75d304155efac532361b1241e61108aa94c1ae0f7a68eac14232fa64c2d8967a2a55395aace88a9e3c4ae4b82686a8138a9e6052d99237ac785c5f289655cdf444284ca1cffb09800986b2ea543f92694b5fbae36a5bec6aec0a0d535267452b5fc7841b1c59d645bcf35ae957a2e47fe391c3c995e852d61b622e8688a3fa30d275f2102d06312486d7ad6cf833219b6641e677b38ea1b11123c0443c426686999c367381ce5630b74d182f000396340b7eefc98f805582b5a85f93c3c297aaed7cacbfb86ba4d416b9eddb23581f155139ccd475c30606c5a526b158c6cde929190a1ebf5322805084eab59aba542cd2cc71f186252df89f6aa689f391be03eddf954fdd176d8892115c386765355cc64893cbd2502eb426cf406cc9ac90777dceaecbb17d3d2d6c5fd03778a8e919116580c68f7e8de25e037da385b5803b3a4ed100594f4f0a849d8c88168a1fe0dcd5044ebff06791438a6c92df76f49731148cb8b45c71df744270a10407883ec2be21f34ef9b5328ef6609c331b0936d2420ae3a7eb07a664aa05720a481cee76af151e391ccdda0d03760676aaccb7ecf10d11c2f8cf00618e38ce8e0566071c200f13fdafdd4e09fb17f8bbde4c7d2bee8c0b99146ed8ccc5476fd9a57a05ebb6a9931ff320bdb660637653ba0dea9809d2b2392e04384dc88a036f430f4c29e521c812bc95a10e0a362e570e8bcb0af7263b33e7f271f4f001a8f9d6a48d8aa01ba68cbc6bc6fd3904d49b8726423cb94f60a4ff96cbe2e6e3eccefa49fef52a42b50b3417705d61fb6972ff18b2d33f0e786505f75f5e1747b7ddec37f5e5a2570e183d79d48048952aa759902e9e9a77d8c45219c9c7ba88fcf1d7aa8b626cb239ffdac7649ba15749724d9d34244f6426db2de10c7ff2d70b869c63944838da2a89917ed9e9296d90e9e083aa655776a277ae206abeb39abc958d00f6b7dde076fd75c27d7668741fec44afe1c9593685dac4dbc7b71bf124f3402393f3a803ac6068169bfbee13470c352709048198c47f6f32e73dac5b6c1aece71de5927e478c40441c2955b873a48298ab9323237b47b43de38962bd42c32d9c82001855414312232a4ba77a0571c75113bc423739425605d6ca2dd81c7f86001d81a68bb1f0d8d1edb6f04709d04da53e3cf64bee812e89d131629d3d7fe1feff01dda8aacd47748283d104c2533ee4f25c03907525ae8d53ebcdec1f1ddd265e3509dc50f2027e36d9e013a4e382c627c54364fc2cb70e9354e5531c538df2a517734c6ea611c8390f9d43843e61bd451db85a70bed8058ecadf71c8013add02aca8ffb359df8f4725e80d114ca1e9a418cb65c98352d2b4037c9b7b6f96f4bbe02551da7896d5f96cf5e286bf89bdf7d83b5d4907909ec0efd80aadc0e734eab663c87f8b4586ca96ed1a6ecfebf783d1b9e3eeec7a83c2f2cbb027d441016ee8446bebbbee97cc75aa109e112819caf011b5930386cd962fb6fe1137fc3c70711794214140c8b01b8104462e0bf6e5f56b88247b4340a21f2443df6c4041f3c3df28d9ef2efb83eba06ab55286636f3835b862965db96db176819e4539f37e7bd770c0a8e35a9ab418d5f39a67c33d47fb9d4d0c8d0369a59cb3d2f3430f76f39f4caf9bd0e17ade5c5ba1e0f50fa54ae6bc3e4b1a8ffe4988f3a8097c81a30f93e8be2c50f1ef43f730500cfb242969bf3d3bad0271ba1409e97de9cf4b404b8bff71e1817f3dfb0ab482da6ba94eb869cb2aeb0d491a403df3987f53ab30200c9333b7307db1e191c7910ac29db251e4c5060e6dd75c24817bed2fedbc09008a3f6bdf2267ec736c9d373fea6e59cd7ad13a6c718c595939c67b1817736a05c645575d15559ecda37ef5bd3cb2a56a476a25e20932f2869d02ba4b9699daf78b81bb58ef4aee2e5500a9954fcf468ff4299394c8e7f4f2bbe04b9d57c815e546be35ca10b2998f5d7346afd16db7b0f821d5a21ee2737792eff7439baee7b3bff01d8d0f3ef34ad91533829b977803cdd55826544e6ce2cdfe285500516eaa8593509b6d1a47c44abf020d0064a75332359b00b9e1bb2dd44bb57fa0fe0d01d0f6a577d34babdf5dcc1e39131b1706f9af3229acdfb85aa5e85ce18d8f0102ad80dac094bc01dcfc71a21c8d5de6b3938ce50a17a4df76698707b8d048a9fcffdccc115843170deaeca1275c615488e099545ffa214513832af15a4ace2a17515db75f1186a48174285b87783d55d0020f706b1ff9160a240e608bfecab4ffe86551ad3bb818fb920d68bf2d67fb4fe1f108521282089bb50d2535a0fb1ba76423b0bf73a71c05cf5a6e5bcdd05ea9d7eb19b7b9ba4d43a3302090c1f73580c9711083ae77eb1a20a96dbb3eaa97ddb980ccc169d8fa6f0339a4b41581b4ad5f1aed9ce614c55b2c9dcdccfc218ffffb5f46991e1264cc52d0932d37ff7e4a689a7bf9386c7857752363cd39fa38bc233705c3519d9bcb05647d7dec4a745e1736205cf7fa0c9c0091997c2dcb0a91dd31adc96dfca7398f3cbb737540d0cbeb6142ad4a5dda9851b44bee1be1095bcabc7044364aba9c3e86770beb7f0433071674b99095c7802fccef95368182ec5b2dabb8d5a909a8c5098c2e97e66dcb511627745e78cf28e970b019083b925b3cb7e051c6f9a0011b3e26e0c800f0160199f2a96058f6a3bab67cd239d3861e3431a460f73e6a0aab15d885af5d434a5bf6cef5d71ef18e1813d4b660a4ab2674f24df56f6a1d04af78ca6a0f7768f9e7c390aff5779f72f1f71f27198048c6ea0e2de9860039b42a43d591b5ae87e5778bf9e9cc653553cac0fa070e4f6309641c26bdf5ce8398898920f0535fe9635e7141da2c5b34d6c1b7c94597982ee0153cccceaf50e4318526005750c6bbdd12396b6d802d5abcc558997e59d1bd017c1d888a3af2901d307433f0fccc6a32eda9986b9fdb2c4a00f5ff3433bbf0241b0f6aa8cdce46c13fe1b27fc5f6ebd2f33df43ebe29221f791e22a43d083694653bf4d8fb3e5013bc981291bcc9320e0fda741d41ea8992c90cc335e6686364c14ef2e44e207271e4609dec6f050bbada28fd97e20d3555d1053f4158fb2cf54569643a981a709a3267130ec4b606470847b4f105cb640833249bc72205416b79240e0a1e6d5304fb3c4aac35f15fcccc48a0d1c8370cda9c79051e55eb84fe1e8c665f9ad80a97f739ffd3f0381b3066fbb07a7d38f7cc6c1b717355f530faa078eac0ee28705e63fc21891404266078ac3a54dab36b8348de5c6df2745f7cf2b684c177a94c428a93f29ce8403b9fee9da0fe417daa3d856d83c93d3c6c3d22c20da4cba1129b64848d872bb194f15ef00a49f14fcee99e039db9aaa2928ad74270f2c1d43fceeb6777a6b6025befa2ff6803b04ecb87da41c80395f92cd5a1d7279279f05d59c1d0dd654de5ab7c79214063a7868b506dab4b792812f689e86b85d5650bddf31454ddac708156509760630e8cb07c5644ff4924651250edd93003a840ec782ea6b5131a57bac6d3a987e914f9383c72ff97b46086ab02c0f013afeeda227dcb6f320143654d47524bb31e88d50e293e916771da234d0365da50a052e5dcc88fdf1e0d3c7b9b1a50caa5362f06334048e08a1aa2cc7c213ce2e64a7f64eb3e9b14d11a49d0f3e5d036928f00883237936aae3fc57ce311c2333e2511f93b1a154dfcd9877dc11673d1f13164c2ae1afe69a0e39b81d115c985715273c4538edfd615ac492a8064f7a0eab63be7b4bc7349365a800c710931613a844bf48a60bb9ae46ec36cb1652c8973159b8f4ca4846daa202ee97e758d310ecb9c8a157e776f1f8c31b51ff58b0a7546ba454ea4aaf610c32b2a5b7c3b121f71e1ba0c0a7b71a6a29596716162f01e67c679d6b87f34f4c581361a49cba09a85b5cc1e735a55c30bf9887034e05efc224866f7f24f655c4a2a45527a42870c10f6f035210435e509764da6e7f3245425c862b311972f245384e044113bf377554924dc61219b1e79080e2a8e028c756b5da13d0f1b7986a5be2f7ea8d9365d0f43ebfc54cef87d3ccfe65c0ed4d77e4368f21b862c5d95d6470fd3d7cfac5dfd64896147a97e17fbdc9d775159c6145a2587085f9f5a5ee91ddfe5941d19e89bfab28ef1c49a3d8b54b8ff26483afb1e69f7980bbbc514d6c9cda8e1cdd7706ef01762bb4da5da2833c407abb9e6435282d81cf69727dce677f2deb07e69d8fd8b94efde1a33333bfaba8527821adf9e7a813f84342fe7215f5ff035165e2589986042fee9a58d14de8c20ab410e871b539619ce479b62d0487b4e079c9c9b1123018e207ba0f220ccdeebc74f28785abe7e63cc6cf45ec959dd05600f19e9380a340a5589abea73e34a02a251826157cc8f16d8adf1511dc14ab2da6ebf3cc296d077d836e55e7806a5f54df684526a33141edc12fb6647b78faf5d2ac395b608ca9a2035db9f36f7de4d7ee846d68ae1360e446ed836b213630d9a8c8a17a1e9e7970de7d873f1bb1f1a9a9e7096aec76b4af6b3bf93b7b852eab6ed622055d99efa37e20bd668c60f2700268facb266719d139c0531a636853bf22d59dce8e2aac1c1aa06e57bc9568c3ddfb5a58dfd32c515f72371f4c587d0759d9911ba69586bc9f591be55dd10d0eb3897360152170b5b3ee9069fccce37f9769852a81f0fce530238857f9f4c6bea101193c8123b4fbddfbae2e4a4c2920d10b5331ddf379bfed01e6e6983c06c6c629bb04a980829c24a4507c57a7bb23e37306a6ebcd212fddcb8d23f73d162d182d40129c79ab90f59540c0d1b01efdae5c6188d75220d3f817f9f0fa7db15dddebfc4df7b70cda7259446b7b4857657802a7144dad0b5909f88b0ec7c655a68d7cce5c1c485e4632536c107c892c631c555b940540167412e889fe16cebfffa40075141e5c0948c021a61a6538f08deb95cba10a6612c2d4dfd50ebcd1f6b44fe405420a9ed6786294709c2645e1e7d1145a1fafdf5c6ed0a2968ab0085d9040d76242306bcaaff8fef1626b263bdc5abc7252a6eea9f74006a5def532c62e12d4306ef048990190efd72a0070ad3281c51311db114286768b1c7ff8d238c4bbd23622a65a44ea3d868bdb8e8b3cbfd373c221743c9a648be63802f6545a88e5448c9fc1c2b94198630a0e3a6379bc7b1f6533db701b00e286987a964f052abe3402f53fcaf17f04a602d810128634be9602f72f69713c39a4b652845120416f3dc12b9fdf3ecf4b214cba19d5360079b32069a94c53d9d50005014e4705c331598ee04528ca0e39e7c09d1405acca545cea2e4b58ce37d1931751ab4dc306bce3e0da2da1286ac726b569eb75ea0e4f931a88af9f430b78c2f561dd92e82b743bef02c179792cf750c3318e73769dbeddf9fa7c086b2902e50e05863858a08abb0730affd4c566fef2386a36bc832ad15e98e5717ef933fb91ff166976625f0bd42d225cf6bbf11e2ce00fee935fd5575e8194af8c8e2a5a54b14ce9bc520a0a008a242ec62cabd28a8a666ad7e77895efc38524a413282a96e4080c661620ef63689a6f84b4b25a67ceec89b95b1b22f3bfccc65e8f18022420bbb0580cefde24a84d796a8b207e1868f0fefdb827c51a384a4a38a53081d8c9af5e00c4038e9eeedf1390f4ce167277dc81de6b35d9bb9e119c6c24f73ad62f3bdd804533071412c96080ead61b00a231506424c73e4fd19e3d0e6ff273d4245bfbd36d0ba0842324acbe65b233af79cdec700f455cd70c95f42656de4fa115765ea65057b60f957612d13a2bfe21df73ac1a2c6acb10b778608ce3db092688d2d3d12c219eee508b727826c7bed8b0cab1a28c9815f918c256406bd3d0c826dbadde0a27babacd2bc1f267f63d978cf24536dd2d224a5cfe2cc77bfdf5d8f4c49a00908f7bef9b10b181fbeb376ef82f557f73aca070b6992fb37cedfb57b4758c1f0c27b2569934daa9e7c1b0196777460d09c3b41e91a0ed9abc2f97b845c1ac07361f6c59e0169f5d41be6cfc6ab34f4a9c7c4b7bd10af1df816d098267bfda9b84a54764c0dde9d6ca11ee01b00f9ac81c81e0926ae2bc98cac584040f92eaf878ccb425f12e3987234af77bd3adc1e6370fb7306bad88e0c035f9f63c4129b44b6a84b6d4127e1e0eb36e88143eab6875720cfafab7a95611c591c54ef39e75f87e4bd849eccc930ecf4981749c7b0a33efae2efd127a66402e9f7b95d0f75be18834963a55b596028a933bc1eb9e4986a02626c95e5afddbb558f3caa45ddcbcb51c56a2ce167fdd2ae02d1513291cc08b0208759721591c612b1706952533cb6664ea7cd1d31328253a49bd86ca7fa762109f647938b78b7771c5f546f47c0e5b4916831215cbcf6b75325f46f863a3211f4d038159bb1790e88cf61104aa8018ff4618d4c285fc4c1642c42db64321f7c7315abf76ebd0d0ac412716a5940875bb32a2bc862391d7c72e6ce24ab67166413d663affd0260b8625add1c03662e4eea68cd60ee1123773e42ec409b4849fcc20a6c239297216277c5472eae0adff5d78348547b2ca58d83e8df6471369a8451c87b77725d61a531d4093809f67bc518b8bf4520969f94fde2162bc701627ba400f1466ed4d9cfccfea5a3f0abeeb9b498da48fe1c6c0670c0ea7c8596ef488da645222a348f7fb8b1a55422564ebadc21686b7fddabcd845a15f89a693ec68ec9bd166932a0fac56cbb6ab3deb6302b606c66c09e873406f55034f4320cbea1b3d682022c214b3450a03361c37ccd56a7f40cf91abbd5a3eacc070d47b25b916edcc7a22f7db513f2f763fc2703f642b306be81e83699aa51d28dbcfd76cec83cbfee650983e2cc4df1042a59180e85dc1dfacc2cd053f8fe811db8739ecca54fc1352a94e13aa9acbad6958d7338e18545bd12fc883f8995c212ab30d864fa5bb42582a862e72c932f16daf8ddce8a3b1c48982aa057b7311477f23963c050d0eed18b6d3da38ef7246ebfbcb3778e078d6263cc4b5d4469e19ac46dd32cfb2dec8c2a4973ac18e2e5dba830c83aeb4ab8a41ca437fd03fda2501acaee1740850bca826d875aff35e2fd07a557d215cf57c61c2443120b4874f6304760241d8dbc9548ff915879fc35ee725926c0c2dcd0df39fbf04048150608f0e31f3f4ced4c1d40e5afc98de416b571bcb66bc3ddb88a66e46709a2cd40b5bf7704f16c55a67d0fc9762146009b8f80333694b0b077c803343cc0fc95e881396a38ee4e05e0e514cebdc15190777089edeed9bb331bbf2b93cf7dfb836379dd49bfbe3f41ce5eafbf5f2fe0518aa97fd463a4c97fdd22715313ea4bcf5776e5e951585894001e6f8a6e1428f1452a07a20dd1c8ca75a9e866d988e4f2d3aace4ff2544691dd8b988fb65d3c4fc0a3dc9a08ad45c8eba6aaeefc643ecaf3e9073dfd674278ea14b41e27a6d31c7005177c753d3dac7c8b2ce8df6543686f99c8dc7188c00689fe1bf831d5256591a9e8385f88ea2971269b64f83e5b7729ffc487e43e4d1a5fb1fce48db666cf6386fae7c425bc904a212a928711f209587408a66c25331d2570ef75c21fd0eb1e46d8f3718db900bf781b952bcd57e53280961dd7fae403c7267476cd82977fc62969a51d5a0228a23cf566c4bdb348ead558122ce9e23777951a2b562acd2f44d708d7823cb181735d0294169773bca747cc8afe285f84c38d3337a47c6fad8f915f34325e07968c8548e81fdd9cb275ce64009c6fad6a44126ef5d248d4ee1aeb1372a35a918fe2f65f95cf8032cb174b8857eee6f28cbc1c86f63d4576bd6ee934c390373d73d8e58c497f7e13e2db06642ff4bf722d9ef509b3dd4454f27160706695230c7dad89ea5b61fb22ae85544bce8453053ad7bb117eaef4044e0e3b9e62cad8929f007ed4a98c95abc5d06e651436cf1feeb2ce0cb62316b0581554ed627465a0802945987682a0455d16d8b0d35340433781609ca569572990938c2c87bc6712f90ba861fbd0f1c5da5868342abe86bd014cf6b1a184d14f1358928376f4fbfd9ffeb777d6df30f67a225c9531c86a2ad0e80b3f918fef748d53c2578e8d6eabc0f7856069e66b3ef4317404f40cbcab996a645fd96e6a108701d98ea09b9c804bd06be4a939fee151dee87eba68741d351614a349f5defc66873b18086f4f9cb76abaab5bd5809bf90d78c9a0447d3b47e5b4cd5b95cd482405a08ef1c5ae677fb1749cc97c687b67343bbbf1702605c750cb41ee6b841a97ba94a47036e4a26970428ee97356ad13c716fce80a2bb0ecf26a89bed021a9abddbff57c97123ff65b5c4114c1caf60bca3ea7841ae29da3bd6f065be412812cc98da0ec0c4d295d21e43834ca8e6625a2fb040f5069b3f167a850eb5def3a4e1ed27fd1090c4a3d31d61b148cec6c6f12f6a6281920fed0ea23969770977a90b9ebdbc399d4c9674bf2afcc3facecd9586453389fc2aa33916d43452e12d43dae642bbc85beea9b4de594fab317a4777a39bf4efc80309cbb82340e3d21f2caaf784c6ae73ae74da80d97eff10e83d669bea956ea9cec7a5a2eb6bd586f49e2731b86a516eff219ac2b8587ea9a451d6adde7c668480d7e4f0a45205e4e3e017ace3975bb9a5c231c0c796b240a4d13297d6ba5a0dc37b087780768eba129d57008cad05f194e5a884e710633a84fe18715d936c07786c261257a859a7b2d98735837a2313fa180047396f236a5ba58350224997c3436844a1598f41cbf805ea0984b2bd7c64ed0a8402e8f44741943facb9b1110ea3e43cad341d3d37f61071ff0e00ce6c8918033d8d6cb8416c196d3aba7281a7a5e39faa864a6e351770da531123b12fc3cf863bef671811bcc0879025c5351d9dfcd3ba43929f3bf6e367058ecc03247a43f79a5b8d99250d98c9d4cf26cac4c26e2b28c7bca076e8d24798062e6bfab8f5b01aefd39e49da181e2eb59f064117ab42ba50023fd88f7d4bae559cb0ea34b4da14abc8f634738ecf996e3e40fe171b4ce9c0a3b71cb3386cb403bac41443929f4ebf342464f380f05287b1f116385bf6852ad96a03fe401fb8433bad998e0bfdd68429064618c3ffee5229e539a33b704e476d98eb348f94499a5c2f5d10bc913340edc768f3df342ce9c891b0828fdee774dbeac2fc6b3e2f719103679191f78ba45e487d0b02de343ef0b1f083bb7921ba6328c0742afe1b2012e187ce771a13496b4e5d14da1955e972e639e74dcfd5b7c182924f810b7c53db9a6e1869aa069516349f8d7bcc6d586c9603816480cd837c4f0cc0e478d38566f43917a4c5db5be41bbc872047258a8bed0663913a862bb6b45a73849362e6be7c5d1425f5ce30d6067d47e0a950bade15b700c3d54a1a03390d638f4085590030229ef808189204bfa5b4ef95477eeacb6a196c3a6db6f8d012e807f34e8f23677b7daf7185f8486e1ec4f66749522e0eb37f6b14eb7ebeca6dbf3de803792a845f41e5dc3b77948a2668b6d56871b9a973d918c32834c1940280d6c6c043c5b2fc8d26292fba8216e95eb86e2758859dc7bb34d01c8c06494f90b31422e7f086d08be52382d33a1c5dd61092bee48b2f22eea796f72ea4c94005cb8f43f7f5877d4731d6023dfe8be91f6769dd5c76edd02a36a4e6dc374a1802da445427b07a77084557fd7a0938166d7619a59c0f0760eb96fde9d721d7f0489e1e96670f0245817d0acf89b25703181566bbc084860f8327f6acbfdd697e06cb5e182682111be77e3899b5ee8703dd2a3657c15ab2a0ed531655a84be931e6dd41e2d0404d9d81b5edb08a386f549a2fdc3b7cf241e026dee8e0e19f22361b449ed92e752ab0090fa01c44c4e32fc19e0b562865eb045588181ce11c0bbee5d9cb9b978c6759aea4d2a3dadcf00682d4b8957881fc0a359186bdb498a6be59d85b367b822448bb2d57489914d3c5fe231c0564b1810b22227a01da95385c92a50345c4de370c4bdf8fb0e9d2989b907455dc6547898d1d484cb2e6c323f285d014a5e2d3fef99a12f72e6a0993f2f12d3b428f38feede3bb0b588b0ee910e3634fa6cee9746213a716e70ce7c90745746f675ce7eaed2c77182d3f86fbd8e61675fbb30a1f4968be9e3e54a557ce553868dbb2d3a0c76a4a0249d1b11a0a17d2eb8fe5c627651658b9b8d590d944eb92b4e2d4c1c43eabb189026bc08a13f19ac818f802e7ed57190322c6d10c7fb3683b303ca5d0e2477c3a286707ad76a3c2990a7c6d060bb9ed8c3272102b10189fac6674589312fb035390944cea9d6bd54fb352f84d772f299ce98a8b3c4230f528dded5fddd2a8969324a89e9c20135a7f3e94c94092e859535fe0097268f0c75f439ff044f6c55ffb016fb7fb9eaefda0c8c47ecd088b04c6da800b958819f322c6252f8ce54c0069e9f4d7ea09b52b0f74cbf4e004cab20bcb488ae4b53c6316e48fa076cade5bbf32f3dec2d05d06c4c61afdd950f6aa82b30fc6d81d7b2454f13e27e7c49480f6713a08be0ff821895302f01f37bbde6a7278a09b488a49c430cdd131ea73085987b3ec950550a22ed0f6c8336b667348b09c83cfbd594abf4b25f29f5310e91059dfa949f23e4eb9a8eeb4eceb493f63cafa2e6eb0077c210a1e9143333a4522f56f154c004510b05349b9737868e81134805812b2676d05ac4a7cabe0eafb08cf495ecdbc1c2168cda3ac7ce925ff6123b6e39cefcc2a7eaf22ece28150a2349b79375de291e378c609d92da90e58305ba4c9d19bdc396036661d30b722776ca6f8e35a0ce69667644e734b017b05b4631dcc3e0e78668ee7fee878b85620039e6000e1bf1f3019a6b77f897c532976d9fae20b2694c25eb09fc572be3bd4f47a0dc7a971f3893c30808bbc95961f23c61d34ce8658aaeaca67fe614959918b48f0f2b0a6e5a251b897d354192866698176c99a76e733abe7358a01c97475d8ab3fd22b79f4c8b49908fd587bc25b1108a1a26cdbea22a7aefbe14b10ba2d05942e1d35339b4c4385d75410ab466c844216c51a91c62d8f8e4da82424f02dce83ade4080a71943724edb31c1cb651a86f753328375088b7d79877566c4244cb9b7ee832a29338296846e7b502f52dce19c3a3031d2c24f4a483c21195f5b34c639b2ca68d2b8fa2aefa4414f98a8aa07dc417ea658361f3144a213abb7d4a2e5fa4915885af308737e8ffc9743aefdfda60672c6d49d07d618c96978ebe6b0f28b1a895e28e9c246c6a887defabc288125419f5a3fff8b0142212c8581398cbe4411ea09f2f7f5703a8420b1fa901703d9ef744515f535e86ee9f56153faa5e05055c211089cdcd9dcad5516434bb0edf63275f3835f0a4c514bf116f3f63d732c2026ac5533e810a6da87230e5b546e9f9087a687066d5c9f090ea250c97f29357dc6453a12338ed94944a6529ff7c8cb68073d159dca6b8630151f29540bca45df35bc782a6201c9bb33f8ce1a96f98f11970d31cabd06df91ae0d8076615411d9c6bdefecec1c35444db4749551196c50de8c043c33fc4f36b4606d3ae25dd886dd9e8dee7decadf1ecfe588a21be42599b8af074595f3fed6a6a84689ad7fe8d1f2aa44437374362c7fe5461021a5822e1fb0201995d4f0bdf88244a1c146e9185c43535e34ebaf4f9775219a63e1e9791d10e8d5d42de061d7e690b4c59d507ebb2c79823c205369dafa0cb15338830e189edce5536a793018db1e3dcfca17067d4257c5646772e11dfec5089a637ce477e64e223f8587cb2dcef440d68e9479377ecc5212cb97a41d067e0c11f0c369c545dd8d311df3f8ae5378f330cdd56f17438c679043346aaed4cc070120de30c4b5ca9620f125786fcf1022dfb32a5f2cb7c482d5ef590bef2c50411d50e10454440cc52e7b054402377d00abe4cbd2bae39ad40e829546904bf5f3715af85a9172d3fada30442706c68915e27750495db3de152d7be4e4d07bcd177f5e564ccee02ca3b99a4dc6a3aaf42ad671db003192c8ca43d4784048d5e0dd9f82269829d62bdbd40692793e97158e01c1d78d275d897c5f789d3390efb8a83e04a7f3f52adff40416a0116ded4f37ecda8df730b5671fb5c339e6a287d80635796976b6f4e40a90331ae456e4911de81ec8c247c25a3e78bee7beb9b8acacf14387cd46e2bb61249cab81f6a058a7a4481089480388a1bb7d2e7b6009ba5dc5903a93e434c0d56ca2806a1c44baf5bff2b6e6c37db7ab9d8854eb7909426ce9c3a058396800b0ebd932cd2a490c9885957d07dd5c1543c10392cfb14fc04343dda2c26915168c3f4d18e1b5df5fadaff513d2e79f737491d6a3baeb8f1d5e59b42ac6ba6f3704cdce5a6d98a6a107a835956168976a64fd49f0853dec766e8426c33803a7dc121abad0342c90cdc00c9d49fd430df1bd272d32423090b4dcaf1cbd7e624202d6dc85f21f6725fee24f61b14750f7fb1524ae41082bf72d7da75e459a196173635a2f3343830c5c915d3f3f5df8199dabba85c6438cd6b65577282f3ae8b9899893893aae0239ab746e54ddc0416d48537700b6c2645293e7d24467c39b6beecdcb96c8b94d21d5aa052132281bceb7d1d9b79c1ee60e44f9a0302f44aaa04fe081ae9f64e3b624e15aa559dd69f4c6dcdf8e331de64e09707e86f978fcd570f8c4a3b9391da539622decb211f80f45d918a2e1596bc80950f8b1d6564db86f68a226d92b9d406f5810f4b3eeefdac595e8860240e9f661a9d59a06b9ddf812862bb540c600d99c78eb00edce88d8f1b9452e598ce39f21cc9ec64806749b00e4a7bf879dd23f3e445bd330f962c9d8ca0fa951b6c7183333102bb76d33f6fe7b1b65976527faf74f72b51d38f003f0c68e4f9e83451bfe8c5ce3eb27419b707c8949749abd8cf4efe88525f25f2579daaf2a6af5ce8906f011694b6093f4019204caa252a944a389f55b7cb7a49c40b66a31dcad912bf44ebfdfa5ab7fd0afaedc6ecef631c2202d8126b2d6b6f695a691bde3a1871497cdc7f27d2e61dcb7797af50920ea200518f85bdbdc75da9e5b213601556fc9a315ddada03168153c09b899d9aa98a485be46158f5d28dd4e47f3b82db2d442a36d12918a82914705e49ef84954cbe7c5984b64fcecb050cf2c606f767463b3148e9badff3ceae4271571c61975e490d71c774b4bf2e52bfd5831ba2072b45d91932b31d5c0adc9d214cf6a2132637d84eb023fb4179be1e73255a5ffd29bc1cf94fc47ab83af9fbd7de2fbb575eb619d02d823af9ab9a6803ebf41bbdfe016b7c5eb0df49844adadc8f3e22df98ff84e5b6428471b96ac91cef3fb1bc90bf323633d25812655660d4b6cc7bfb1eaf8483bdab54a32aa06a9121bb34b92a4bf5877d879642f7f74affadbea553c1b3eb1eb9c0cae8391cb723bd1574031e28aeed78e31791d858df2962e7b2025a5bd637044ffe159248d22313e4b8425854ba3a2b07031448986b5e8531540381593253d71d99d9c801ea4e737344fee81212c70c32d459345ea6f0605db57b2f919fa6b5aab5f977430c06856a6e8d28929f14d5d0e4e2b697e53932ef14fd306da2149424bca4436585a8dde2ece4018ffbffb6a8f6881b23d0a09d8f5d984e57271e92abcf23ee7fd228fd0dcb137172022149b9c3f689bd4d0c1e8053631cc206368a2c1f7362a20def5f1db51dbb6627a044555e2575f80636d3cfa0bbfd0873c02519dc6dc2ad753f5c1c7862bc010e2ed89dfd07751c2de8d1726b0bb09e08501c898f4b7850eeee2d91a5856413d9b65e1f077f53f31defb59243b754b5f88db8f9dd19d02a5156038572fca260de4072b82e5bc9f9b07980d50b16d30f966cf866db3f3490d3163a4f586a77645726bed72fc7364ed80b9f5764d4c3d562db4fcf6b15a87bf887971afe9a48d44888565232d6dbc20556566bf51bd5776a11322c8252fc38186d968aa76332517fadbd8a899fa921f5383a1def62243128f29d01e0fcc3fe8e36207088811c1fb7a7e43065fdd6b3bb6501e5aef5bb92063d1fcc899f463d573d15a738b889e4c1c029ccd5d8d3749cdbb25d66ee6260c15235db24461c4e09563a32eec77dc8e7c89fdc2ee793559f1148552fd6998c26da0025d5f5044e2cadd18c5a5d0bee0540ec00b43f7c437e52e1cfce64c652e0a87cebc579aace39df16a911045ef3f3b7aad019482af2278ca12f3ba00deb16f6d1dacedc9624dc42da0a4de4b410a47538319af4c80789d53131e07575fd2b4e143a0e26de0a69f421eff0dad073a0c8d849e2c9c912fc93c94049833547e698d367d91455520ad066186ced22e0ba13f58352cbdec8e33dcda98adccc4f710f5bbee7d126a768afcc2e4a46ca9d453ba9e0fa1dcbab4eeb788bac7068cb9284b30b24c92bdbc304e4eae931d11d985a0920c695f8d7ad8ceb05e9e6b75c3a40a10154dc0cecd60bc09243ac29579e854fe0890dd6dbe62274fb39b482039b444b36d90e8d4e4ef1ad5b072548dfaf9bdd6bb3d61a3bf6d1d2bb1870cce7a14e2f1440bc5962756b887f109a1ad8318ed30f4a1c8a017fb5fac256ecc1771857b208dfd8f02a09931004dcca6925e1d9d95a1570fcceb011587beffc2b182b8d4a0cc865f858c277b0119da917848c581747288855791520ddc238e7e2a4aa37dad7cb39dea0b5c9b747f75b3af9ae51c17bfd999136b8bbd031eeb227d98f5f8cb8a1980bb3138b7fa48bd65746b68e66d1bfa632e6f98aefacca88ce085cc536a9924b7d5e6e7843b05747076ccbf54bba36f7b9f4b8392fcf162787e2327dbfe7eab2755ab8ced319856de17396e9262478ba297b4ed9eb9019dddc8ba1a5adfcab3e3a29762ef14788f138c354bf5d45ba96e4de86091e086606c2a41d33a5b0ce56800a13a2ebe8703898bc964330c68f19a154dc099fce736884718d6e6e103737bedf53eeb02df6261a09d9a3d12aab59d53038b004c736287cfb4c46da10c9bbf7a3dcf9e081c7f444eb62d3150a77687f62388a22ad47d09eab8ab1f1232d784a9b915834a029cd476f946b8d3ad9f0b04aa01b8243d280269cd7f42435e43efaa5e1daa95bc48a5e1aa8444a1ea32176cda2ea8fea7cf44734456b51dbae74d5cdf8b5928c3d31e31e9d9ac008b632a5950d86d758d662909f53ed084325a006769a485f435db29e8c8efd85bc807e777d24a00f75da2001c8b3a3141d23b080b5a243c4c72e5df45876aed4d7ea94884ffb7fcc4e322dc3702e37e62f835bc6599649a87ad9d3793d12c326d92101e8bd01d48168cefdaa9b7d91b8d2b4889dfbf89406e787cdb4f7ad10ba164109c85c022a23c83c95450c1ae2917959dc34eaefd3f9b35e6681235650168a8b51fbf6d8f24d244d1a740012b8d9b61968301de736178874a53c674c2485f4c2e17d89036a90d4c5e264c8f7a04276000801c6b8f7f48103e01cd46e34abac7a73a10ee382a947b688ad41a6943675187abf72c4ae784c5a61ed1aac4b01432674c4635a0639e38c0e5095b02bb9df50b0764eca04368d5b297b4e3d68ef8bbf0b27157a36502708b7cc4dca230572a7178b820773a1d3f31523036b77ad972b51c90b2c5c82004877142b77e4dedb1d1f47f13f9e9776482177db8a526e0d3f150fb69ed083ad3978a6f71f9e16ed0cf41d7c66549478f3797ceb4049e00b77beb209486549649f009ddcd7f5aa4ffcdf64000891073c1b64c07a3e71f607ba912ea3762b3b0fde1606da13aa9a9b179a26c95c123d01b84987872d05ae209c864c2391018a85e176bd0706ec036357d6f176f360b738f03543959cfed7136b7e87ec0a436a35fddbd7471382c9cb8629a1bd7de9944eaf6ec66a1aed37d1b421b56e9cfc70fe712d69169bbff386294ff787b5b41ffa8801f28698fa9293aa4d106f2f650768631653e931386b9b16c1737ef99b44ccf798de9fa316e4ffd3ae21750ef9ab116ac58c8f768814d3a63ef2b7d2b00fd57b4d39be0787f5e13fe083d80682398cf1be74de2b16ca64544201d97bffe74f3750f2aecc5573261fcf88c0492198e783044100ddde7faa6a661956eff220c94c96a4315ee183ad2e473cfc217258859ca128c83f76a0dc6ad4dde563a2ddbedd68e2b992fd0bb83182ce47251a5b1937d5c1415ac84a89df26c0515968def72c1e051f4b781d78aeb85c542c4f42cc9bba7ee6d84c6c496232f6485d8a9a697835f2f7c37c7410db90d11551d6a244fd4de8eba8dd53e8ddc03ab987417e30f1fd5e50323746ebe2d7589b99701affcef28ae33a9e35c725411b0231631e37f2036ee8fe282859458da2eec4557c2372567358b18847a80840d3b4fc8bc969ec87e68e43a8ed7eb7f71da84231d3e04fdb4f461cf18a6077ecc3cb25e444f2577a0dd5a8843bdd2bc053b710850cb399ced6ab67d600deb71d81e72393a55a6b06b12269a52744754e56357a935f83f1afc44392bf595be5a979ae59f2f0f56dd5e855f44b805eb63a3b6fe8a023526299818f4d38ecda91d8451adb50f0c8f874a8d15066b7bcfcb3fb5b92e4d0c924edca429fa6e0c0c54b5af88fc3ba780ff8123ddc7ac5fecc3b3f76c98734765066224daacb84d076af663f0b8cfa182ff35befd80645632c68ddb5ddd1942bc0219b890ec5ab41062f33fd9b0987f170c6af8963d46c8c56a9c42efc78d174250325f347087855e473251ced50cc9e88a07735fde80be8dd962f32815c16efc1793ab5ddf3bb83fe06d9cc5d1a87817f04c8ac07ee73742049773d182753fb0a3b1a1954cb45a656656aeb9160d012c449c30cc612343d562982b9e26839f031d00ecd6069bc2e25ad4a90e2968d64a06a2e94e86cc592a23ba00d11324f10cf125ec6c87390ed1e661062e90ef8fd55fcaa17fccc572180f24cbd322835afe1f3f963b323f24e214b06db3d49597b4477f7913246556c8f61c663903eb19d34622e76cc8996fecc3fb83bcebc28f9580f0b494fff04ea5db6563a09ffc01dc1956f6f03eb2e99a82f4a2a4ec296c3240693a24a887108d8df89c14cb5efaf879d9e9778524be59a503867f91b4a6f9dfd2958673a323ad4c0881757e35f14ca91d7690642eee778c872d2df8b6ad67355052fcb5c008ef4b59f5d96c65852696ca30d20711188982facc1667eb93f12a2bd0da3d41f50ab9894fde7747028060fb8ff4ece79458fb4eae3049e3e9264d40ebdf027d44734281ebf31806b9f976ba1fc0f138a1e59a1216f39b26a7fe08734f8c435d43c6142306fb144c10a56ba84df33589783d2602afb2e8bf9ee7e594add3ebcbbe27882011658dd03a9e4d088e40d4d71c26ae4c262b4bcab58b308739b590a59c1b0afb0926e6499d4285a43369b2efffafe7b7ef2b44e85bdb0f5adca416fb52c0aa7bee535f13b8d0229027ae78cfaf8d50ad80c6179eff36060e71e4bf1ad5d943944ec771500a7b8e27defd6890f4e710a3b4117e9058a185ed01e6da7493d77a6ea15b4d7b8b4c8a59b037511d0bd2eb1fd93f1b5588474435b5c924f9c30119ef31a2568e0f668fa4aa550c2eec36821ecf77c7f99d11c1fb5fcbacfd1a4ad08b929c838b5e84ec4a3807fe226196dd00d2923072bb1c3bac186ffc74cb77d83aeb78fdc797f0ff4c9332757863ff24bf6cb48fa50c4bcd330c578422d287d0765b174db23cad040e2723f78dc2eb6839a1c52cccfdceea07610700f9d0c533c53b3966d9acdafc04d9321b220697e97fc0c482f3b7e9ffc0fc9524d1c96e615ff49355741ea85265532353de9decf10bf2e6b889ceaf7eddff5873bc26683ca9dfd8ea260e9094356294a4454a38bfe3ec1a3e807ebc70a44904b29410b3d978954908a4ecfbf91c20f028969aae9062e82352c8c52700e9db43d156f0052100631ca7c0d803c8a0213c9fe593e1d0e1197858ffbf1f4e045843471fe68c82b98f61a828568116d61e2948426a7c54a4038e8c806a762d3522713e631f6c455835d01236a9f7013e23a62e44ba83a88d8f0beb2dd47d040d6e9b2b4b5fc9f311ddaeebd660d5600f0f94dd3e039237d13a4617be0a7a0c830941930e2c86671bfecb5d9b120e3fe9392533c75ae23c03d12aa51af0ef039e41417214ad76032865749f386a2d8fc2c193e87c69b546d866125a6ffdaad0dd2ed23d63d5a9b003262089064c47e9a9ea6920bc0285f6621efc550e84500db049194a75d77e74a2de14298b8e5d9548a7c94d92aabb5be2788c3b1b71ffe0bf01e300d90d3c7aa54e884d6d167592455836e748f4ff1f065f736165bb131e06daf384f094406a6247d63c5e3b7d46973b1085733eda1dec1b20356ae404dd747291e2795f609a6a573d9816912e33ca3f42e109d95e0839bfb4a4133ac3337f652458b298939e214fce21d8cff4dfb751665acffa788600fdfe02e1ba51a47f76875d5d753848a11b754e00dd6ed1aa5b5299ee38e3c97908691e2afe12b62d6f12756887d1b5f30a28bfd9bcde8a615f2f9d4e5e86acad798bcd3b8c45c03ab2e0d31606f54113bba31d7042b7ed364fe807a399698e71ea4395ff55c2730c85df3e9e227f3b6d3df4fbb16e5c57c849f39dfabc795769166d0a418f5abf1108e421748b5185a8d5e9c83f054910ff58c7167cd29bcce3c221bf2eb0ec4d1a0658bfb47b2e092a56b7ad8c9e7ea22a2122a89064d21c3ca7b910295c440bf1c42bb0d9a3bd3dba280b32746d62871edf5de623f9d643a98d23073413eb672591349bc9ddd5e3b571a1ebbc828e6a2b018c6d8f35b203fcdcd1080f1c26f29606cf474f06c8c4b6e2fb83ce1bdcd742408a2f8fc05e3a766719980fdaf0812452b247f0b39ff79a77ccc359581b24efa1cc2ce4201ab299e377905dd2b8e5915b3990ac2e6bc1b14303daaa93475703123eced7799bea580c1aeec0dd2dd69c8ca6df4955de61eb7da62770bb7070457069feff535ef2725e9945489eb805539e0d9e3fa2a498afe05bdbc4df021d7661380c4e1545e566adefedb3ce98d5ffc63fd35371159cef2d54bf50bf02d37e5eb608a4e330737b6fa0bede5e30a7c8e7dfa0ff8e821460cb95bc6030d378b4d05a084c82e0a682b64a27607ab4cb70cc6917260d260f8f7dfbdecfef6f6f0f2626d9c5ad3fb0f835375889aeb8c6624c8ceeb248ab78e896b73aa8ec1a720519b7d0ba9dd394de08e73dc30d20cf9e632157b0e4ab67bc450e175c03717f38d2b908ac779ef9b586f2c5c2b855918434d43efc9045a5b1be771163b2377ab8c81816ccc85647cbbd82d90b7a6207821d2e5d98d07a0514eb992b15aa9401aff0c572e72f80cecedc8a63e209ba3cc13835d87ddcb9230b0fb42567f2becd5b59120db2b84d7c04794b99a716387d54c8af523ab189639019db08e7b78b1937d61fc65955cc0fea87b8ca231a5f9628c19bb827b1bf0601965854ef00a744dcf5106eb241afd67b618f3088190edba79475dda8b1f44652b48fcbcb25d9a5e29683b3aa14c845e3e13def880f6c7f652037c6fb5ad5567780350ce6d457c70918e7861e751696974b8f465da1313c5f825ee45109cbf1bd646d9e9c535895b3dbf76a6ccc5a7ba4ee14f8178d1efe766afbd7d6828999f67491819c42b4b4a70e078d6185b95df94f69225baeabb2687158aca16871a1bb61daaad1f8cbf35c7f8d273156503111b4cf1b29c4223ebe23d6626aa153dd423120a8dd69b68919887fee2a02a270042ca0610c554d33cb862584292a5ffacc8991878358716b9c954198599fb0be59dccb95ea66deb4f7b99ca4d41e380bee79686e8587ce19c8dad9e727ea69c88e327bc38bd173f8bb36a2f2b2ea6f493f13b8e172c298afd12c6bd7a6d068ae24c53b9bb49b254e3dd02c2ef96c5202bb6babab8b372ed41d893149ed27f7911b069c6ef5c73fb492fe028683623a995cefb12eeb2a0afc89c64e760864eb9266b3bb8dc4e53f302898ffbdf1d225e7b75cc2457b16d68f2becbe4f3e6e4f3d6b04436b499aa6ddf49b00dc5ba5cb5481ef92a3176d30ac16d1889060b5907f73e9805a6c9963047e159f0fe97a0690b57a40b63d3f36cb3a34bd2bb46ea45d0676dfe12d41cea483b46e01b9a11e9e4ac234112c9b20601e2f0ee5805d9627877c64a941a9b7118afae58f433871fdf41077668ff2ce52a871e116237803b19daa879257351640b4653318e3439c34c8a938e1445c84e87afa925765d61351688f8e92d842120faaeb1667f29c4d816fb722b03a2b590d2d78ea73d7f201899e7da58dd854dd2077a452958184c75d1da5134864ae2e36865d51bb3b7c2cfbda7e9e49eb9c0fe7fdea80c39fcda3d0d73286ca3f98a7772324a89d1d9ebd7ed479601167e22622d44fbf7c6ba32ec542a708ab94d5790fc6ca65d49a0aa5d211f7cbdf17908c8774e0e7b08476e0304059da9ff76c27bc5de466b5056e05d88993ebc9effc39fb6a319d4c2fc86e7ccc5aefb15ec4684bce43709c0e8b41ddba487fef6a11fc8af3d72770054ab8af84f3b0d99ba3a8ab0d8e1addb23efe977a0c2b5cba3bb00e4417d01e7d184fda6a20bc72c8e6af1f8d596b62c168488351760061e7b6beb908cf8d94105504176b69804f0019342aec71c12e214f1941d9c690b8babe740e00dc51d7bfe0b8896791b418b6442e1440dd8ce2ff9b608a63e12a026ba8b14a9a18e4d2cba99126c685e10c88bf9d360a41c84c1a6c513488ac88ab126591c6d02caa39ac9a1be7de7d2dd0259a34a3f630071d4019cf91c4c93163d75fa1a5b578f8ba29b481b7dd71a13ad599b18b28366611b2fdf749bb30bdc75056895da71c44dac261c54ccb83daec3cdcb251a5dbbfdeec10f69bc03e96d716381447d5bf61d9dc31b6a05df8cc5c8f64b55df62d71e797f77ae5638a3dae69accc20794fede7b25dab10a417a79d80e1ab3f3101b1c82030470f0f9fe41d3e4faabc2ef17473ed5298838c01baac73f7f2484371ffe70461654aeab3feb2abd3bc6f7c7a17febab61b8116207e437f2883f0b99eed3c555e1c7e0011c022eb90289ad95a4a2addde930082d2d50be1aae3c094333a75e855ff73292ec8f99d94bfebad554e45a482d0cb7157eefe13ec16bf769e3efcf25287878694251d74747cc013c8496bcf9f44eb51aa9e2552e915a316925f460fd52d804adbc4a0f7e6c7a7975e642d8559396e3befcdd10f060801c6b81c9a8d4794610cc2730ff958207b35803c25957afb95272125bb8b963a856de93bf8b60779996254cc185d12abfc5c4c00f1387f8032893b6c31361e7c2b9b4ea461605679009a843dd0619b1b09bf15865e5e5697132cfa502e84495bc9225fd532488ca1e88aebffb5a039032a740c9a5fcda62bde1e11b85e66d41091ce92b84db0a5516a7a0bcf352cd24b1273dff6639bd76a5fb0ee9bb8e691b31e067d04e9ad92b1f70809011794cf9c76bc837d3cbeb052cf15cc0b7152741d0bb722aacf0bfc57fb836a3769cdd4a5db31c99f26acb4fca54b7e78229512f82c03b94678e9c33ba1034434ed4158b60ac5721f9aa624833c25de3cd0f808617c026472de553c102b3beac3f319a0addff4144ac0d58123ff3b5bb5b5ad1c85d27699e351724cf84063d8bba59178bf35d45648a8f09dc53af487eed276e0adb8a1534011a6170cc24978038291fc4bcf1099c90859c6c1f6c1432a5712420619427944e88e284e0f89d4ac207d9e6d4463da41671145b2aa5257335697c9cc68401505c3410d50ba9e4cc20387a2e75e1a3f6f3ba34d9058a83a970743301e6eeb1e85d34059c02e5b06005a5ddf23789babf535e628bc05954db8a280c91e9378df1577dfd8f51e85c8cc74c66ae4b057a263f4690074b9da06940c8bb110779f8335b5aaedd277b0358a9e422dad929b901ad9d256786eba86b2e569671750adfa4f863a2444acf62518dc7883080ce007ad2ad7c14dbf0e33042f1f4218e4b6723aaa1ec0a7ce492b3df3fe467525072427f46b24198b9ba20ea3c5c18b97c5d600bf7043493ff3264aa5dd07b9ec74b56fa05943884b1e3d958d0462078e75d0e4ba992a8fe674ef44f4150a445921fbd59dee7bca464f924df1087db0a02df2cbe7c6b3ae2e7075cdb80d597f1a127ffd740ce838d66425b129ddf8ceef7f1213e3cdbe9eec4ba4c976013740ac1cd466995d7346869ab88726de17f58b1f7ccbe2dd8772caedaae04f69f84634f2aad2bfbd8ec9103105fd59d1cc2e96f78262e6e05a6363d5f2249d8dec1e5b4d52801f162e404437f525608554fc21981c52065fe08154dbf675e61bc59c80654e49d01f52bd63ccf006c0df179098590807bbaea42d4f01e660259e52b5b2a0fbbaf2e4e44a482935db6292d30715f3210c8097649727b82bed8f49e1914759fc93ef04de3550cfa25c10c1df18389e79abcb9c140157329371e86b991f6298f21b91966ef4bcdeab5bae4a75cbaa2d443913cf8ccc4dbcbb54c24289a8e63a77c28ebe02c9cab9e880593adf4a85dc6d1343bc769501f9477962170f336aad2827ebcede7442682070b676ae4c09ea41a3b3b6ea3f286bb8dcb4353d9c6d437e35287485160a99f4979b82aff26e1fa151fcb12ae9f2fab26cc3a42295fe20a05b9790a3511f7133005692e84ab8adcfb969d963199c6ff0bed34b452ecfe56a939c72a66b123ad9810d094e634f98cc679317589b64309c09c7f11d2da807b8b4d8b005c0307a97526ae3d8f5aa399c4913d2da76cc8c01c931dc9081e9362e5dcd7415bd245884102f4e71ad06e01e2268d1fbc1e96ad18ff1bdacac749d117a8bbac5cfe3cd33b023807cecba23b70dff4dab289ed16a452a42f58a1b970b7fbb329893891a72c582c12a209df900ff2ec09d4070af0b155f111afa80f0e0949243f0c00c1847839946dd068ab3f183a21db5418a0832e45f4cce0255b59893e3a5074322249c8edf2a12f7b63af08dfc8e9ec03dddc481c4c56a8b2d79ded14dee362244aa276dca4e91099905842068bd320d10047bfaedd3b5e7cdabc4e63a5c21d06250983bda72c2eb334d3b8af0c75fde206e33514b5a37281d59e51b9e8c7caf8351610cd7ec905d36d4fb57e61d591506c9a3545543f6faeb92eaf8e7042e1015c033e7cb2c7f48d8d52e1a3fe617430dc678b22810748e10911edbdda9aa7443602033870b482bf86491d1649830b7a58167d01bb00068d44a7931f6247994470e879dea0096a6ee69b0608209557d9f64c4ff5d0370ff3dc4290152d17195aa203522accca536cbbbed0c8569d92e0d421a297a92d327c8f9029355328c4e2554b13ab3229308017a8e07f14cc4caea0a4bfe6b2f76ca807c1d3945dfb1467a799bb89a4b87c7d013bd3fbf279b4b75cfc99424db73190dddd1ec419322466d778bc08854724753594f591ae8f97583493c48e915f8d018ae9352c7eecd8f650fcc52b8d0ad801b9b760b1a7b7eeb395a7413f024e0270fe907b2c13ce7dd20902faf4b3d33abd95f0966363c107329f07c7105720332acceac737dfaa1eee443e1b7f3a9475ed9839f513c7792a1b20f0e4329e96acc5c4c824125a7c06ec3e1dd08e8838c61a951476934ea2e4e74546e66e30f2b691c489f2e05e88ef0b5defa427eb1aaa68c89bdc5a18dbdd216e278da00cb31816770db6dde763a12bc36aebc4852dcb1b52fefd5144d73c11e24de2419b650f10eaa5738b4e0590d46be7254e3d34d1007efcf814a0e427dc6e7bad738462ae9d5f945a6d4515cb81969d93842c2a16db2296f803b9d540febd9acf1bfba7cd9b87022cf8b5518afcec0f66f2a5c1779f36cdf7a495d95bdc569d4bea8e2df88750c4948b8a7d9a8e63e52dd4d60d73405d4ff4cf235c7bc4a1e642c070ecf28989fe1647359ba32465e8de7d42bc1f44f40c11b8ff859931466eea5ede94ff4aa757560a712d13267212c5ba0e11b437b7d8ea8895deb0dfb558dc4faaceb06689e49afa4bba57b2b5d23db37200226dea167fb12c15ab694d20103770b0e8bdda3dc45f5794e75116af1407f65d80a61b4e2b15d7ab8ca4e516ac6270524cae99ce90de0d5124e6732f1c50d0752d6d49342fb5278dba9bbb3d080058c39f542d5f98d27547ae94ca3a7abd3960e4697a2365580a3f1748c4e442c08a0392f5bad4892159f16feb83e3622a7a24e9c67f56878f2bf017e4cd49d6ebf54f26406b9f9a8f95fc470db704e0c686c2f198220bd983db7e47ecdb59b06963d78d56695c384a455a53e6321eeba794f46d44d69de86fe6a75275fc950b43d0fe2bee7e016b966fcf64ea8e0cf17a85151ee3ff439b373581420b370eb0066382b12dbd7a08d755b6ee62d558ff2f27df431ec326d867dd5a93f2913e2c6aa4db7bd3d47504c8062f05b1b66940bf78ddb303e320d32309b370c4d555b4644601e501555c7f40b92ea71ccf6276b51bfc6c7931a56dbe8f1aa8c24d07e393879cb2226d6f64648420aeab735ad13303c2fa5319ac97937df2234bc2d0b1b1ccfb76db98456a7e6eb87ea087268c59fad5bd0de6b550901623b8a825d0080ba8a2a8516b969cfeb09975390bad2b98ae969fa4a727392c9376f57a3880a992522a526c09628a0deca8c78b4a0d66e1500413581b195bb4da73b7ba557e60640651e068203dbaf215f49a7f15982585ef32e72ab2f136f10be3a4670dbf50bb1dedcce1bfd5d8631881c2a9d2252b87d867b5387aa579294612ba7a1b3f018fe72b455041414b837d7d97c3482e88241f46fe2ea24387b7f0551ffeca176c4e9bce4739d17bdaa350b05cebbb57b0cd034658c39098a7d6074cf167b9c59faf56fcdde35cfad812174bb339fb634d8c7dd8d0222e438a4388e25e690b87b4d8efc7b4630c931896ea2556966e8ade7cef6995c774c2e227b7bd986d761ffe7480f5d5d09881531ada545db3281e4c4b701b5d6f707f8ce1e32af42177dd87e53c07931121221bd78f684afa5a3945af94548cb3fa199cdde581091f177b21cbdefca3c6b6a00fc35fac69463d75ca54ee034a1a3b6232b0c9f326ef669f37b350321a1f4dbc0cd098f8c13c2da9fd3e494c1e8c2e063ebbaf2c168437c7a5d98a0c815789e73c4bfdb550979d7e8e8a4cda80da5c7936ae68c5e906058b68afd003bf19be7e62c7bee04706f46ec79a6929098142d0e5166d807f55c1b115fe16e84bc902444cc40b4424cc6b02533204b8699cb249dd9e796d16e24c69d406672bb6e0bb278b23b8a9dea81eb8b77759a883bc3b54b63caaa1319544d2acd02f80ef954c43e438275c1fdbc4378112e9d0c9193f9aca2f50fce42c5dc0e21b481d03de8fe2aa18bdeeeb10a5f372f7bcc3decd80fc24da026aa44a663cd011fb8deaeb06a193339961c543c8386c44f657a8ae43e508ddb9c878b6b5b64763828e2c253a177a4cdf06cb094df826cac96740078b699a1b00a1e4e14b2660fa0421fc4fd83d7dce2203e98b84b6101d73bac2b8856aa124a464f8a0b790b2b7eef74a4318f9c693c90d81fb3313ee4755bd0aebccece21c04cfb06a73ed0f4d950c78ab3dab73ec545031ff0896bd694a68c28200afd703140bbb97bd90ffb9f8bf5a3269b90b14878b6c8d5aaa00b330ab25a70a5ffb3e53dcd8916d8ed5f85265ef72071705ea0aebd75b556c6bbc897010f0193c2c8a9f867875ce4437855c84d99a7735f625c023b59c3fb2a1656c0e94509e13749408686a0f2e99477b7c2cedc4f41002b136929742878ab86db996d08a9a66a869fbeb3be575feb0cae2e105fef9d5a2aba52eadd240e39a5654e947b42296d4b3b38799461100c29045107ed1c02c27bde9435f1bddfb2d709b2b8ebab141445ce0cab4f3f38852785ac31ec73ed64873d0f2c5e0fb44e93473576c68f94a2973ff5ddbcf328c12b5a9609d70945f11c0da9e0ccd3394a4337b6fd93ad3ae2e0b4548b337198c8b18edec16a94b0afeea6e45d6236ca4d1613fdebfb6ec0878c4900d1c0378f079b96c5971f1b5574456a7e752aaba8b698d6fe40b4096115d7f0e20bc57cf9e52b1ae2e194dfd5a1e31ee83ef884710621d5d872670b1c738da7af9f46bb593808165fc873d596682ee98afdc9896af8d21221ab3b4c45862315df380a40b3305cf9312396456c6fb0426e5d0b0dcf210f788949377e81bf32ec5a445cc13c311679fe6a12d9e333e6c9570a4aa1e1b833a79a51f9695d9fda41285021e4fa71bd5b1497735969066ff36f407ff1db4f8a9f4e7b37063e3f0c260509638a6cf726a1a69e3e402d7cfe4d3b80608c52d4e1b7a0d1e095994c2e68171c461019096d25ab26b2cc40bab55bfb834417398fb5a6ad395401c477cde775de72c9191d65e8b4b303fdc8fd352812674b5b7129363f6bc8eb70d32aeed7d31cac73deeb9b24ef5969aff408f94c577f55d351b93470816e8880b7b16af4071d52076dcd47b3d13a8b2cc9ebf320817aa50a2ea23eb9335ed7dad1ba465dae27bb9581dc5a383b746c5d83bff11da48a51ab9b796cdf4d8ca345d99304d76a1fce581762b6e7a07316a04b13e6b74f30c6ef99e2aef7aa6000e8fa92ed28365cac45b01b88305c30aef06fef572d7925aba6ad094baaa05401a4f38015edcf15a6b3a8250ab8966d2e70c636316feac4b1ca593ffe8dafee892ef2129c87fd73607a58883db69410ea80f54d287a237a38fdec0ca1c444c1c2ca9be66219059f0b89f4e45e63b74b58b55392d273d125c19521c2e441248f3e7df840bd8da2f341465fba6171108562729b37609860c1956cc19849b53910dcf305e26db7f26a160978e9aedd47c7bdfeaa6352ba2b013cfd288d097a29d2fe5a4344eaef1ed58cb45fe25e4a5eb8b049f48a712c2070bf449720f62903d50f4cb0cdc1ee1c149a082dde680a906e55217e78eca9849d8d88b83354fa498952709cebcdeb308368957c50cbe392b4c645f2337f35db7fdd97cadf51eafdb40790a474105a720cc1b5693f7d4ac3e829e6d887bc06ddbfc77b734b44d1286e4f99ba6cd1947d8eb3945e87240d80f6a5472a80a8af8e369a4ff604526f857a5f0c6004d1f9e2a71332d1eb581ea2f9bb7148c91bad7f178df22a4d03ab4ccf4cffbda5a0f1e0b0fac9dba51116dd0f855974db4482fa1d5b9673a75f59d24b40413a10dc4f209d92b269a9a3653beaa5dd036560573bfc88b910133aa01693bf50f799b7548fdcced87d564dee698e6d1a04744b3c78e9722dcaa5f32537e3b2f34df6d1ef277a25f49f2e22c50aa53ee79c5d339bbcb7cfe834d9887a8e392dd680ae37f39e3857a84de4463306bff57c05f35c76d868cf419ecb686b0b9131f44bd920084bac82cb59838db8fac8670491656bdf47e511ad2308af1949a15f540df51205db557fac96ecd971d4334c603fb2f549ba13710b3ca30d54b0750b27613f7847284cd4cce1d40576a1206918eebc037e7c68a19d80f005e1482b2c7542926fe907d9726a597e2f601733d9a0df7cb85cab093a71a5220d1ecb576cb9c484c2eff257a1587aedca9ccddcd8cba7b20aacc0540d10bf54373efe604c7250723e3187207535a760b86736b7907b9405d5afa2cf34b941f37654f4b2e1302704b831207f3a823e4e212bbc68b223261c6702a6e2ef48a0a6cf4d6d03e24f4d39d4408b814d159e0a12603ef519465ce20e7852d2f15cc967bf1cd64c8a35b8912449fbd2c2c1db6291b33082600f1726675a5501c8d4d29678af8a99c98a86d932a7273df0c3f8b896d22e069b3bdc1d2f0838ae58fd3a7a306f335562ca3734620c1a6ee315415982690e3c9c40aef7571b173398964766fb2da7a2f035b9aa53d55014910363b19fed29f2b882f7f82cb9f784f3e5be115e803649c6b7cffc2859cc3944bb00b1e24e7e997b81880a77e6ae059c531c242c12167a2fc21ad2c2281b7705451c5c3215e5919acc14b63233441558f4c3b5df18acfc7538b66705f538998e35ba197bb44ee579d38fbdff7e3ec5ca553c3e8aeebe0a7b04eb9ae513d3cdae97e350bfdbda5d8014e0559207387c7fd0e34085c4761a4f180dfb56c4b1966f456c7f3d5389ed4439f71d85a9ff802db8862165cfc7e006e23ec2ef9a040b50d2e3ff3ee7c67727324ecd864fefaa01cd95ef14891173e744b44889ad2c539551cf549b2bb1f831dd0225e95e7636f865b66fbe1b389e273f5a8dcbc70fb3d087d9801439234519e71eb46141b9238ab41ab32bf32627d55be7d63cfb2f39426f49b1c4964985134167e58058f812e695c4205762e36bf02da35ce25b8d5e3d750b314237806affba5a8ecf70d12691bbc8869d2353b26099e5b7fc6316cecae58bf2d1c16285f78a1dcf729ebb255ae9a8692533a1e71bd7c18f1c7687e8641766994a7f806a4130d46d81af5504d13b61d353868aaa44bcc1ffcf35c0bc38b5fad3dd3e7b6feba00b650136e0b1bda4dd86457b17979b227a804516234c5ef53a1c7e23388e5319243c5d6fa6ac78fe8df9c87fa67b1ab4db86b31e4b89e3187277bca62f80bf6de3aae5b95bfaecc9e2e3b5e13d9a2c1ce2d631f68c4526610eb6a780620ecd8f954d9b8853a2feb008e67f974177ba087710fe47c87d6b2e8a2ffdfd90727b5bba6a8ce0b313b299e4c19ed51bc4fe601756d8d2b47a6e92e60d555d9806790c0eb1c75bf28ae756dbf632c63a6a7838da2c19a5b8ba79228a6fc97c120547703eb70796316dc93f16dcfc5791d5ab0252a8a1f7437243ab0393712afa8ddf331095e87d61b72e2d3f90db94ea6b79802815f1fa769ad5f0c05afe1902bfb3516186a96a56461eec9124f63f27dd83d38f275e6c3575b1975a0fb58ef913ad09e37aad6f820a077eebf4feb64025413b4005a177a45e97c8dd0e8036fdd9a5a338d8a00629076356e89dd87c2e0d55fade80832edee556847c132a87848e3480bb4f8e678b25103ee3fac03ca992a6863655311ba29746e9099676ada957d05d47c0a204c79ee20bc90ed0aedc348dcef3bccb5021c72484e17561508efa5d80bd6045f71bba7a0a09980d5d05e814f7bfa6745513e8653671c45bb90a20871739f7adf06beec6493928d1b1ac7c269fde95cc7f2743755c983181636c4f419ea8b6955b211ac3a3809ec3a03824ab6dcf963d15d61bdf7a0a6c5b47a7f463ddb1d59fc79e09a920c486b1c47f32bd2ed566a401081ac3bc8fd5d78fa3a3c082ee9397618094c2d88c94c11863a16a05be21e1db692df46c4453acca31f9e958ae99defa74233ab278b8ff367d760fd5f557d796fad5cef0a9ce5ce4497cd62966f8b4f48a833a88a5574650cd9ada320cbe6af2d5a93675068ef25073fc6ac3e415bd614b92214e3ae68ce6db2e2d3315ba3555423ec1cd6578aeb1fa6badcb14b010a3358e643555a52094c17f6e26365442beba50d0aca76513cbfa52b594eec9af79d5f7f6e0db900217baa2379f7cdd68c8707c2ab48394b09436c98c48f1cad4e51e9d8f6eb257d7c2837e21ebc6eea1804662932dbf8b9cab863709aa0b1248e3ddb97a3cd1e3a5e28c523b7b4c5b35b4672ef24394dfe62edfb25e51913bad34ce6ea9b1aee9b1f75df676c11a3c70c5c106f9ab2fa28945a4b4ce9cfdacb744f17c5b4ee5b0fde69ed5f9b701c3420ea2e072a29fdaff1cf7658a6b622f997762a216cb03d3930f867eb04f2b6d7db37a706b5b2e40b0f8b51b72bae543418e24c8d537759f0c3828923c08600478df9c14078962fe8cdd1a19812cac637106260115c978b21d45dede751954065b5e04bf0a1ab058fd64ceac514a4f862d64510e59b9f796a02f0fe31564664e08b63b3893b34974de760dae24016538417cad596ed6f3701ac462b314d93fa01b00e9a8f189f4a787c7b56ed431d0d54035242300ef4671a434c7e3a2a0069cb01aabe39eea0feee3468a9c33a507809b8663aec3a665b3dfd05c50a5342d173d4184f49e22049da85d989dbf3e01c28c97bdec890af42c907d0ec6aef014331507ba8b96052e015841cef8cc811fed426cfb8a595869920792c00af5d62765aed24af8d3980825ea60f2ad7dd1aa12e22cd770949f9bbf3553d33c7e5ec9635347a28e36d15dc6343ab6ef9e98fc121160afb99cae04401dfcdde61cefc8551ebe017c6dd7e1e3675628e1d97d0109672d1ddc484b793f1d390b8e17fb7c9e909909dbb326ef301c9e7a2492afb14bfef1c8735aed025171f12efe1203077a2910c4d0bbd3f1ed4b2e4e34be54dac67bcc507c6892fa1cde92e36a6d6c6bae67d899b2c603129075afbaaec312459005039e6b51d398a29b274b611e94bc3414ddb9d374eca4c06c9c6cf21eba754a9cfe497db557adc65ffe998a657c8b81d002fb415fa3d09faa4cf0c17900ec04cc18c35fb079ff9516699d50a2a23619a0e72e2f85659c9c0ac45ef2a944bcd1f251c6d14e7b9984fb87e5ec7d58f04bdf11e487f09a0aba669a3331c760cbca187a83435a1ba1fdb5c143e1378bd5e34dc0ac9fcebb2f14350927d9e667f04059487b504cf36237fc2c66fb82cf60dccd1bc106b823ee9d051970d332b616f27647831efce417d95830d2c331404b4fe5401495398efa5cc6f1588a99cb27eeb133d2a72cfad164b6888227463aa4b9236f0cfad313af4fc35045fb7b5f486bd3f5a65c2975b87513ed3f757bf2edcb18f37ac03e89385c73ec84c98d9ec224afda06f7cb953b4e232648db233161714ddd4dc7bb1ea313feab167026ed3f20108d349e20d99f1145fa493d5d93e9d602e6a37e052c831ede96853ce4d8a98d2601ae3f59776c7d268ab457739d7c5ca69ed9070fcbd873fcac894641bf145d5bbda77aa4d485b53d7bcfb693259c5c7975a9f71c21a505b47d64d26522b19c0a61462f266c3777cad114fa8057d951be94bee91e8b2c0d74f4ff87e11c4755f9b0e3f63d2ba827474e4d28a4d6549bc81dafbdb961e59d7413642c022e0f6dfec33bcfaf1de6488ee451596bd0abe33922127f30dbcffbe6ccbcf115e23dad4575d3a109d58064d8ccc95fffbb9f9ed1376f5148c0d14dcdfaab01f11fe99b53d50d15b1daca5906f7f1eb0a00ad3cb3438a4f04395a870e38d93f11aa009eedf631e4c5c8757cfb3abb719335fa47ccfdf8cdf03f42f795ef0ed2b041e76e799739c1933836d7d8915072aceb7814502a6e4ef0b7e12db9d12b0a4cefa88d93489dbadb70c8e0bf6aa0256d6ab897159f11ba119ca6849822bdf619b6f02d74bfda3af79b0f5ce54af290df7bd7111daea0fda523bf56327bf0d7298837ca5e83fe85c55589b5a126fc9d4a4ac0a98060c626b3389058be21fdb2277d4eb26cf08052d563ae06eb628a785cc75f537500fe3424074d1addb7731fe54f02be37ebb912bfdcb375f517fd698864b75c92996725453e83262d8208bfa9e10b7e005304f55aee70e172537d179aff56fafa4ca7d84bc7d1aeac725ef3a8e22732ff7931a13bed55d24d6e90fae63687c881599dd0f7d5e77f2467f8b3fdc904a4d8d42ef5330ed330de27a3bbd06f4cb2daf5e4ade7a369b1257047efa12f170add03a0e1966fde42704decf111a38ed26d16884886118775a3280b6db24a70bcf75dd8a7c6514d304458d86443f785306acf4f54eb0d01b0231af5c44b93cd81759d21067146a069c1cf837217fc9ce776960917a074d087adac0c8576a2741f6f855c3a719f4a881e69bf8e3ca4f485efb44d784585ee2227c14053388ff3bee2f3ea4cdfe2358a4660b221e32cacc0199ab9fdecfc9b847b6cfb52722fc38441a592aa926243ca1e4af37f90431f72da2fae8a94daefafd17cba4e982f60f718d67feaa4f9632476d186272513ed50efab26471ba139e0c0a76e76e4df27e74e499372040f444946bdd78a05acd2a31884bb686fea934193399daade2fd43e3f4e9a60079fb04e18baaeb6250dddc38fa51cb75ebdb4c5ab47bb341fe4a6caf8749497c757dcd159da547be95c4aad2b041b722a554c2bfe3e43088d1268322d16247b6c500382acccbf8ce2ea772f2b481cf8e38f09d38d6df110a0489f033dd9fb67515c8ea12b3e44a3b605ff45ddfc7179c4b3aef94073d204e3a1eeca7d7cc133520ff8a53300a423dced04663e1cdc3c1bebf3178e0fd295c7d15ded5d97933aae46399f0c441b02b9914b05fcb97da8a82cfb0183ae3dc4e459985bb5dc005fab522eca83c5ad3cfdfc900e7b847fbe67108df3a803465ec4a13bd60a102f48233323681e062133bea79ce5f2f214766c508badfcc6bd3a6f246685f83418b0b128280d3545250822893a29dcbea726fa708168e3488ec7455fcc839ee18503052d12d153db9f91bfcbfb68a1289ed7bedaced5d44066274199327491c16bbaff136eadfc3b55965515eb10058ee8ddcbe43558573474fc52e6cb1c07175aad4322c7a3c60f24b75226d8d8ad9aa15bbb94cdb7206c9f466f9c9094433b21688b5f26fe6f951ed69af39a34267872e4d410a6164a19864fa9247d05b6551698710aa67d740f998ece65e42daf275cbbb7dfe60c10b3197ab92fcda52e09008373a48c2e671150d026a4323100cf0b6a1ede339f26576365d6b801454e70eaa49e2ecd99b501b5b0b37fd3846170d83ef11001f35ba856184df07198aacae658614644fe9489a8d772118b9233c4897cb8ce06c6939e86747040973102078606674c4ba89d392c0b9f2d58d372ca2bc2dd798a3b67df23f59c234a74bdae24e949c6f32963c10754a683345ad5aa5b590563fa5e1d3e3a1191e20dfa3770791d8961bb9ddab72bf3b4b5c8807fcfdf5dc2637be26e2c44578455e83b75e7243e6de3fa80b6e68b5f073c9c9213047e123a9b9a0bcf1e775eda8aaefea136c04e5f9a3dc7f70656982897586a82dbc8472bb5c1b01a7f26658408d98cca8096574a028b8bf52f6476a9dd1fbacedc6edda0e44c2573e29953660fb5b875691d31563724b3b343bc8809da865c48a08dd722825a85d918f29b45b6b08a109e047de692f5e66076f57424fa563a8df4abb1cf42f1ecb7ea8de772e0e1926e91bb230d96f8c2b71892d2f686eaf1cc900d28e4567a7bcf2a4e00bd901aa3be05bbdc00bc65efe82c2db50c8300fe4bf314ff2859ebf0af398260ccf09e65c0b6f79b03ad8c2738c4f105c789f9314fd5df78f3457821d70d2596f6b34c130225bcb5148e9a388d635e9e5df13880567801921648b0c8aa4e986639d83dd45f3758fed125869d67fcc9763cb372109fd1fa5fd4292197d8610ed74d832adf1fd7ace6813b57e06f51ba39d6fc51552c282aa6a57563ce6e421490e8329cfdbb124371199937bdb2fae83d8ccc6ef2fea4b0a1d0aef55fb9b8bad5ea104c1e55b557f1f14cb562303622aa351f25f25f4944f9cd6234cdc8d1f37fd45412b97310110dcebb838b9ee3655293b911ffc1ed0fa3c80c3d0a04ec167231d969b0c42269c018e72c7de7357d054560d3ebad60eb9a75790f45f76e053cafe7428d0f5c6a58151b2faa31bda966ae455b6e28450dda6d5d784cc8ee2cb7c3e65bc381bad867e263da5575752f8522a39394894c983a39f34bc925579e34035377f0512b0895d2bb06ff96365100b93de8909bf0bde8eec9329e8f55ac123285b65e42178474c3b276a97aba1dee0f6fc0270843b8c3770c5a6977571e1afed0e317848dd7396e09468d35afe49bfc7e97d3d4e4d96a8add33d37ceee659b74a1c59346bb05121bd1ee6e132129407e4ff48684a9a764add763171d2826bc76658ba57b132bb458737a57a4826cb2f347d7ae9ba2c6d93ace91af2048edae15761b761d3b78aadead21c5bf79e0a183e7aa343395577ed1b8569cf52867ac69b268a1d8950ca1200d735a3d8b66c8deba5c9151e4954ae71d90fa0f2f457c33ceca7f2048cd27746ac23f071a97090cae9b0033c7fb3d5cd4e2d9065d48abcc7443f4810e1866e746e9a8f67823fb1e420a93459932b5d06373b11a8a77784315f665d438df1b14480bc3cf82184e96c237fac47dac0843abdfa40cf1126924fc5a237af14d3926ee4a79de982c4b84eb1d7cc4adf6de003037418c118b0fc4ebb574d71a9b4e851dbed64175df1d2be04592c8d6dc08bf6d53c92f85ccf398528c14231471079fe10bcff213fd1440d9bf8fe6df0ef5b4b986398c1a1eed9f1554135c5d3545cb785a44fb1b100d0761c6b3c0c99d07f226bbc3277f5a687d0ef1209aee9ef6fb67cba886557f471aa52d81d9608e8e9a4a840effe27b787f24056f3824a5a6390758eb3e9257a291525d0538c87dc33c94f51d4981c1401a0dc951a693c350266c9c80a88c7da7c348856299f1e5321eeb1ceb239e276c8cb15759aa6c6d42e3cbcab2af5faa59022a886f1c89bfa0f35f9d34d40b179ecc5c1793d447c8cb4442187f2d054b6a93468cbf2929e9f94e8900f227b4f7b6570efe0fd3f8ba6427adfafc3200a74e84f96435fabbc57856c7677ea5db9a31f6e3e324afb4017522daea61a3485cb5ad2b6b29477e49fd3a4cd88486b3439a58bdd174cea5406d30732de253ab7f4182587017e7b2567b176eaae5b4697840b06805bff9aedcfe946d3596485a74959204e4e3e2d506307c89a6f04a3a8d8244206dda20035f28c6a71230d1a293af9fd4c47cabfe9d118d70f9b3b01503c1946bf591b693956a88d132a261e5a30f6277e1be75e4899091b513cea8a64dc2a6f67a965da072aad487eed45faa76a8efbc399841631769ad5a6b81f241f02aac5b9299e0b1347ebbfa1b02bf05b649025d753352e8baaaadb678d174690d423edc0feeb703acab1901b622a86361b8df2234b68aaee6befe7f3dcb63d1491096a273668f7eb56e79a2ab77919ed5a9c6316c2c45fd675120ab4c8350b2f218db7ab62d297a369e4bb4a5107923b9820d1deadea2159f681daa1efe01686ee2f2cb227f071f10d20695df203e2ebbaa21c13812124226785b6b109dffbe1810cc0a7ffdadf4ac46339599df554ec25918b8a66fa8b7a1752c4f109efa3205e2d784dee2f3526b6bda0bbfa86f58bef583da74678a741339b63f035764197f5ab8602c54888c3ccd067e25e5ac2f2b48d959adaa2bab130abf80f3879c43284b9fbf56e050a747fbbf7982e01b37a904b75606e9c94ca3b1593f4bc7c0855c311745f040d151c404be5cc7a3cdf881fd511bd4a06fa1d41090d5192544f45b6e57e4eb1bbcc5fe541df439d35021eeebfbd19456a2a03a8badfce10c0e10f3b2c9ec83a3766202b9ce0ca1bf1547f0458e2a27e7c961755536e67f23aad94ecca28b1f45564da1df1e936078cd3a5fe24140ecc1c0d8c81bc3f100a9c4b8d2e676d008f2318eb548165a856b64e90f4a37b2f0a42459698e994431f9e1d73941a608909d820f4d8ffd98e746ff1b6e179a3c0b87420450620206efa9d3cea9f99151d258200798af8685d45a82fe4e0aec1c78dd4fc423f1696e29536a0b224234828e74f8f8b48fd318b8bb4745c77f806ad8988fb6c5f7e363c159cd85e463a9ccaf2c6fa69c7994bce0bf386c9188883d092d25197e967354efc180b5585455c20bddf603945d5a226530cfbcc90b5b374deb79712c7c3816c85c5364b70a97912f2318a416edd076bab220a278d2ab0191f06a4095088903207bdef5493478a1c84eada3099a55e7eed96bd69f10cc438c003293135d315fea45a2b12ee0482a0c8903193b74a0abcdbf945583c13817c07aa6d601077750436e6ad620f1249a567f34630faba13f1aec72eeb890e7fb21625ff303c22f4c5ea76d7e1185b9936ff5158cf766076400abd3396c81f3fb5f2179c5f0e574725885cf63634280f3a771d3f39075e393276c3e617ce15569d5cfbf4088f58321ac3df50dd0ff2051750dde6e97adafa58923f7548f96daeadb4c34c612330a6ff8c8a79c78830e118be4bba964fcb4d00bc00eaefa64dbcce59f20dd4d073a152ffd30834daa5ee956c8ffa7245ee882c0e8271b5a5af154020b71f8a2ea3d9d9c3f925b24df10a21d2cbc9f62d19e89a446d67021df11537c2792a7adfb738784b4fc90390d10ed0d7342825dc56536748dae6d49a9b99d3fa05dfaa1c24a1e61208139a04f579e48997a09b973d965ed573b4a604e3844e140fe201038b70bf23842d837abcaa58279d29e20b9d8af27cc5d30274cb4c8300872fca861951d4ae1238d265e0532fc1b45b4635a28637e17ddb9873c5d5f65fd69d2b8b85945157fb76a599f115c2955cd6e7da5edc00a6b74608568e28cc309654b6beb789f10fed29799d8ac101357d73404d6b469fa6bbfeecbf9699888e46eb466e89e6b1ea508ff5d48a1260056ce7f00a3e9331cb53fbb05a1fcbbb71ef125e998778a040da5b9cb6f1400ddb14b6a67c6cf6a4eb9f7ba5267d1e225fb47de27bca4948c33e48c1d6ce7ab4d089ce4a32fb16c0edcf62a9ddae813fda7bbf149df309082679f9b63ecfb9385c87ee3236b339ab15f1f323e4951a4fd255f7c9f32ef2baedabdc8cfcd451c3482e69db7fbd8b44312441ef07669a9be82c169c78aa23751d1500d97547a0ddcc9131c7a84ecc7aff1127e44b937a46c2d986edee3941cdc0f28394cdd609ab2f8b3841e2b2863319796abcf2aa6ef046b2685797a63439a28c26cb360d50743f2a2bee766f37922edf352d68341af015a27f5484965e7811de46d3405622d2c922e14d70a5e587d35eab0209e0ed74f491616ba50236bf0b34f79141e473b0c8043dcffa831ce60c5d9bedb03a3713a98b86d1d64d0e83062221146ba85406d81191a86704239a124c8d7229272f084e806706a5dc9ce4298625c9406b9b55d88e1204b07a619f5930b641931c23f782cbc662b1aab74b6c99f4530ccbaf41fbf705bd2a30de5ad5e7de57ebd85e1c65a0340ad97bb346d69ac9728c7e1dcdc4a2346ebf2d571d7ac02803ac09a840a81b658ba5fd28043f21744fde968e171a866ab9ec59e823aba9b097ec8f46a8045ee715ac1a03789bd4f9c4f6cbb226243766ecbf5033b7521021f8d90c955689d2d88b7845f2f103888ceabf95c0f473d935b69e9229388ca99bd396aa7ba15e13908b985f18e1dccf64d036d30833a5f2433dfb98347c9be5042724bb318ba020063b18a9c6a513c0d656708979c333fde95ef315365b65fa2f0b16d2ab5a1a9def0e4560f368a2bc48034cc8c5ba0bfa6bfef4ac376950ef10d83971fbba2c2a0cb84624e7fb59c08a98eedcad029153ee697624ee9bba35893c6c4315226a2292795a2ae1a7a630a7ccf61d09c60e966321e8aadce707bf6016756ab6b597b45ae6534015546ba591cc178cd2f6f84872fd5c79be947768d9f41d7685a4271b54726e3d98b0c14b6fd406bab258ff83d17e4f965daeca2162e2e1cc1877ce30ce116d05bed8715556a5942b57036d7c6fc2a496841efeb08b8b60bcf22f71d80fcab0faf293fbc1997d42d9dbf9094951bbe9b2f6e5d2b023efdca23187e79ec39123aaaead514b59e5cb86f960cb5e84d75ef51348f61996e63d2127ec2aec6e6ca2b641d4b27b4d4367f62dbccaebfb30f534c4e801e036a07f47a199912a66d6a967b3cf50227329b81d3ef617e92d8ad0beb7a14319b56e57340f9deec9aa5c4182e30b8215362456e4bba1c5fbb8b44194cb816fe5f853180f6cba50363a609c5c79374178125696f047600c5a219a5a442445809f3d68af62ac3afc613e780a7e56650e7ac62a30f1e04fef6a2947248828f246fb4c393650adb86be8a117e042033c3b0d56fb34a3ce235e93ffe4deb3ebe5479426cffc63e2e0e43b928e1c9131d522de3e6a93a2036d688049074a32c03ada9e26b0081d1285cc213d5d0c6bb50d4fa91ef9e1b67cd03d07a68b6b2ef36784fb2cd5d4c9d4d7ec33812e0cbd2ba72376564f3392f2695eae41694049524ec871b22185f643632ca30ddb6882b168adf7fdfdbaebc0bca3875bf2657595aab0ba4dcf66e55a57e4a908e8bbc7cabb06bc3c9f8aab4d0a7f68c1a12e520f5153afee8f2d799ff53a7398b1ecac800e9cf7cec18c4079e558622f3cb8fcbbd1fd0bf28bad403275b98f8e6d30044a101159997c435981a32d760b8d4feccb1c6bcb75f556d08eb3add5c5fced4164d26643fe9eb2e60e2c2793125390070079796643cc726faced9cbff6f42a8157951d2ae8748d0fe90b70383d3b60498f63fee5e75abca7c33f8e27836ceb07319957c172dbd99e62e13837c675458857f339c6cbf0d223d3217e1408974dbe4254d94b0c46a9af1768d866978cae2b2685ecbc634edf3749351e804703c5e0df3a574c4700cff5487be7bd6e64dfec7787bb9935e151f24f424969086baa958a84e2daed45b780d029d065c2aba42081f429ac44a72119a3f71db236d0a12b51fe481975205ce958d618a979ad598df7715b6f2e12917d7bcde508cff6df1c624e9d91fcf4f0e7be0ef84865d95744d6cc5678b169e79ac4dbcb03828657d3ba7c910e36401e8c36e6f33e7d5b85f452248b492e7a18b2216afa3f2c95711eeee2d0fe21ec079cf6cf496cc6f049595cae9851423a54286d5acc93c911c30281b37d5e4d12dc916debe4e08e26df10d3dd0a2effb99b657d52028a9a2aa17aa9477ba4cecb2633488ed7e8d012d9bb024f3e2354053e0a524b1e8066b6ec11df6fc673143f68335c9d8ac62558c1dc7ada96ad77aa45e3dadcdb8027d07a2e5eab3cc45e37a04ea30dd1e2468d48c75b62951d6d647bab7d09234673307a21b7e02174a4ed3e78f187c7db695b2e83ff002b296b06556f8841e386d4d3c435d05e879604f1917eba302a200c9ce3eec01fc14c88ea614142ff31fcbe7603dc46b7719c04adaa5354cbaf92cdf2869f81a8bfde8c9de68cc97717d5f24b72a79141358c4f75bde1de32042071e4146b9bbe1bec1a70bfbeb5dc56b78fc84edb6cd384c45b3e6cacadf4a1da7f0e020589df99bb7a881a039eebe19ab077417970a1bd41d4b5da9585ee726b48a9806d36922df7818cbbc849d70f9eeb1bbad73d32184b378ff16249f0e0093e6fe647c5ec62475ae773634ba544e108f80ca40a17a5ca60122fd06b715938717ba267e6d9e94d96a95899e8140a367780167aff9e2ffccd55ee27e83cdf77a25cd1a6e257580d56ae532145c37f1be304065b5e69262ce2c439c1d44bc73001bc5e24f4582eb8d773c0e697bb12a51a7e01aa811668dd8344aa42ee8d6317d1b883b7e17eefe5030ef4deddeba47082bc2d22e89c480242b8aab25e02d0f6be5c645e1afdb81931c3f5899672f2b24b0cb24d08e4ae6938e34e1719db89f22b4a0f2efac99544ce55b3293d70a6248b6adb3cec06012faa1236fd7fca9fc9489bfeaed578f6c47f8d6030470ab8bd2c375066efc91097a1ee976a9d2917cd566350aa7ff2a5bdfd79962a52617667a4a3c0b8dfd1d838ba71711af85578e8ebdd3ef48d30cc2006911154935a1835030d75f7b1344dc6e84477ee80750cf4382e4dd1cb52d93ec8e5b467caad4265545ccac5e006748cc0d2dd4630bb227b8450d7380c565cc453648eb2747dd54c2597e137923f42c9e9a470db50ffbdf48489209b786b17b1fd5e68a3bd3a2b695d664827a5555d10ffafb99bc40ab581db2dd62aa8bcc24f7f0254ded26fe8d60248e0d1cfb2ab59863ca3286c17d22243d51fb264472a73617fe124b730fab2bfa3c118b6103a0a80afefbbbdaee5fa105453ac2d299689ff18948e4ce5802b8861234e3091b9ef3c5924d0939359e6d6ea11de2bc8f33d857d177101cb19b711fbe3e8b2f2bc8f1cdee92030760bb972fa8bfb0cf230ef58fdc9ee0fe2939eaab18762263424daa0e56d470925f1e1222fc1e77da77014de1db08dc87c7f2e51c9f8b4d37a6707f07cf048942baee49e45df07a3d0771fbeb5da8d9ab43532ad86a716026bb53d83e2f4799f2d0d4b79e8fab9b7e3e95b9eb6b38f01b863f6637a68ba1fc96d1e562a2c0cab03c9290d6a9a71bfcb7e3c133e252acca68bd425ea2f82025919909a1f5eae41c44e232e5c373c7dc2f5bfc2257898b704e6db73c50ba736b869b56d40eb0ea6da3f59efce7d4b7115bd11c7bfe2bdbd3e6a1a4c6600ce1c6e551f0bd733a01a0d2b3343b7e1070bb297ae59ba8fef78ee0c8a35a56c41c84a32741a248d2821e947fbbcefa552186425d056caadaf0a4fdf47dc73ad8ad213b866f431f774a0a3a1f0e5c79229051f42c712fae77f77a1ec34cc1f763d1e03723d8ce203b992ec278f6fd34e80d955a0d119b059d37158d970cbe7fc80f70366b22fffce6ce51c2de13cc8b9bd64127c918bbb70c4802e406e29bccebceb21c912d82ca8dc94e97be0e1ac1f55a45c74e5498bbf033c8ca08b18dbca3201b40ab948d54e8d07b961a2ecfd8254278c3d2c6a56654a9099913d0fa690b1aeff4f187a46fb9f2ac4ef198b1830d7f4c8cf7474c5c070bb0e98ee2c43839576d594488c4bb5725cb34db21f552ce7c066282e815aa3664621895d0b0a0e3f642ed38df3653f79f18bf54dbcf6bdcb85f45fcf963caa667314ffdd2e3e022b4a8efe2efd9bfb8649d2cd8af5365f928e5306e2ea6e63b043daa9b19dd26513fc83a5b6f61388948503a8610a390aae53436c1ab14a99461aaeaa5fc11aa3e779979aba5b17bc7b1338ee3d9f10c435a24549c60933748e94fad45e57ede94faec204869b024ef2d08be0e8906f81cd706ff283cd81af5e2b0ef8579df9693aa3bfaaa7c985e5bd81fca4b008d52ec64f2d21e03a81cd5aa658c6e1b2811784a6688e361f980593765e93af08ed1948343b50949a71ffd6f226c8c61f79d7f192da8c4a0771ceb43d949f25762f582f45d231cff086f51ac41286f459778ddedd197793d127935dadde6805b2b7cea3d7865720e3bdce8f962b669092e815ca165f795311c0a0f1e7a8aa6745a30073d1aae1373e52e419a5128a75e9d54ad6b02fe5d07139516bbd5f6e3a4560739c1db80fc8fa3048baeabdaa8f31194864f8494bd71965a61a426b2fbbc4360825d5db755c79bc39d7018ea87338ccfcf0ba09fafd59c40976eeae9547e83e99ceaf00108fe70be8e2eb5a47b116c19dbb57d4832f6dad84b810c150d5dd89b20df3ff8adbf43df9d8b96ee31c72f2493787697f6e57617401c83a0feed617b13845af0ac7bd5005074d39831ade77ced111019df91b2fc1d70f9471a9f486218cafa568c513631c6f07c67764b597951d8b59541f5d499e0a94f76c75952cf6524bea16020162a42b8cf1654c8034a2d5f173c8da59389fca34ff365396df5332504b016d0c4f9713babbcef75f7fc153dc0b871f52f8216be1b36e22d9a6eb70c931dd2a8ab3a40b98bc815de19824d0976eb7f330308f63d11919706fe0ec2f1a49836ef5e2f78b3fcfaa8c04be93510dd220c67a0a51ab3cddff30e42f9bc8fee0b9e18ce07981e5dc0a9c73c405f1b7f88e6b625ac560e599695c759501be1ccda6bd2f15d39cdcb674eb0ac2151af0d4d58b0785559109d0bea95d2e158f16397171a773a915b46d6a255da78da107647150229b5adb4bac6c5d1fb55519760fba68f84b9bc23b8e1c5d3167fcfe78f40776311f256ef1ce6189f3ad766cb3bfcdb158119173d4e617d4416d4ccca1d9cabfd8f1628fcccdaf2b10996e1f0cbc197ea5effa62c22fc253e0b22b59946a039abaef365ded86bdd650b50b0e365d09f6c5a42a42f8c26c57b9b604b1988c7d2d9749d080a858c9895439df464e4edfc466dbadee031f95d655fe9cf16a5ca86756369787ec1d29a511e307f7632174086e31468a26644e0d4f542e1ca28d4befdfe36139b2dfe243ee898209ca436cb5dba670cc08f5b4c143c602404919e4a91dd63afea61b9db358963856e6ae7ef0cd593a094f149986c96b5cdb1fbd03bec9036c3009865b50f01d3b11dd457157394eea821d7ee263907d980c4af1a9710f7e2f94cd778e7ed8c0a6f124d05161c3230b53358c5df2bc67ec58643509e542d16af9ecc791ddc97dd122342135566e053c089e0d0cefb01f10e3b418c4805b87c76e1cda9082cc73354b42ccb2e26de1e51fd6737c899e7635a82045a946dd86400be9229bd627c92abeb13c94ce505c430998c6a58176ed0b7b4ffeb4272917dfaad072b7e6739fed6477358f186bb1b0c8b9f699d910b5548987f0932407afc7a6594f79c6bbc4fa81f941695397fd0adab0d966520f8a0f2a97a86039a69ae426e5674256686ae597ff769d5c3abb170d1ca19694b346c915dcd5f818376b249573d460a808cf05a7695d13ef5f6080d888143fba7d989fbd0e916c47dfd1377c6f205a4811d141ef36db7dba1ca4c42d036b3f0eedad71b7a700472048bbfd799772cd2b89e28d7bdd90a0a068b1dd486aad7e72f018b14199c74dec327b5670a23a6e3bdfa698ab6251b0e4a083909a53064582a145e1bba70e7f3b0fd7fdc4aede8af44b821d1bfbc135f6f6768bab2c479082ec3597096c9df6090b59a19f787e79e24acb9018a90a692047de309e4811670ab3b584ecbc4c27459b2725a8d5da7dee0ed09ade3f30b44f9ede9a071428a3863902db0ef2ed9809cd3a471f3f7cc730273d4fa13ba0f755a31b4508d5ea77606540b266470b008d523e8b8e3bf5457e0987ef4f435c0c7e4215c53e2fad67371df1657a849a011cbe0c8069e18f36d0d5592954103feb87f85938852a01115d9640c972a76d4670b649c456caabb4839ee5ab31bfa808e1ed93c7ce47983a77f54e59c8bf387cffad95536774122ff55e4bd0707b7c123e6959accd1ccaf99bed055a30da2e7d07710281dff72dc179c10ebd81c617260bfb9a21300f2a477e420395b11cc8592ea887b233c314d93adbbcdc48222db69210ad2509639f192cdfcb716f47e2d2d4b47e70169e47a519f23c35e2029fc2e9831f8944ecce7f656dcdd73f05b32b8cef0d9138e048b87fc4e4d50e0c3e3788247230b915fc0f0937398580bbca4f10c643bb77bd0727838863fd932ccfbafc3b191aba47700bde84a67a1eee447ea6f6fe2b5e8e978f577b682063211f3324ecd8815a368ff72119a05be36b8301f280dccd04d37d9bee91cbf45753a8cec3efc8834861b317f2031c1ea7d251ee0398d73a89d33750ad6ad058a9ebca419383863e0fab3c10d812420fde0c8f7f89dbc7db24b71bfa29a7f56244a6b7a2f888159e75dffcec4dec62a88f771773eb54be75e5ddbc3d7724e0a42beac493ae0e3a9981f3a54269680301f1399e3bfe022309a4f8fb61a16e7f542c945d32e1c54eabfe5a595aede33e18e3e94e16aa71563f75c6b76c46d7b24d54ec095c9e8bc485aad94e2901a55f133117b5ddd825c74ad04e7a4944f8640ad89719f331c1237924c62ba6197485953c46d18dd67835f836e06144657b0c28778c3deaff05264f33ad33574f6071ffdd5577237ba2f48c158d94da057a774537e7df2210a8e3107ce6bde8a9da113197b7394777175706f3a459aec9ad27a5782b10da31bb5b0dc2f26d63d7438c9811adce6c16425f24be947fcc6ab99b3a79b4115e28c85caea3ae6b674f166d9d9a115c85a8b0ab8b77d286640193bc83bdd421f49226e3b9f1ee0841d8706e60b7b1b54bea7a3be247d47d776ebf27eb9eb6add8344cf7f519f3c9d485f8b057f06b510e4c3a54714502df1df15b080db3ab7ef6040c66f709f376bcbe8f315290c32327f09e81abe9db2475e7778682c31d199eba76072c1b79120bbfba10a16256f737aa1e63a958b1189b7ade1d20a925b1fe8a782488d2e0c6aa8733444b3444560d1b0397862b6d18a89427ebb31c5df6dae64bcf7d20114c64383483c2d57472c16cf504a6779e3d5434cfddb9cf95a401959b63cfc59a7040b93d0cadd1ad0fc87e2b32f3acd43d5f1bfbcb9f608b554a11fc36c35e925ee78d30dc28638032fee8082aea1f91a5c6a40b2ce515e2d24bfe056f88d42c05ac37621e8770bbae1c47291f7888da32fc0fc216c91b6a15b534fe6519172178c65c94500746387123ea5ff6dc46cf6087507f59dd7d6db5a78afe978ff38e1163898323e5f63b702c8664b3ae180a88e691285cf7776b4bc06bfe743abbe5c0b0bc9b0c55e19f63e8877695d659c922c3d25426505e9495736c7ddc099441666d0cb1c42fd15ad06cabd49356747dbc68e96806c6a9008d12722a6e3989e7c6fc6aa84a1791ba298c6f9366c128a5c29eb607f3f63066b3dc606ee5e3c4fdce8db07a03c4e71a2a91c920584134f9a3694eac8c15534307450386cf3e20989b539bf591cc24f23d780336fbe001d8131b055500a4ff07d7ebc1e6174130fd4afc61cc5babca1f73b235e9ab4b3226258993e014c9267c6815d5f0ab2be38ce89f482ed4551c5c43752253ad77efd434468538d6f921729e2bb63aec02c2dd8c5ffd87e4ee8dfd915f500e694d99929644c3015431df0b22d75fcd4f1449faa35117109c24b79fcab3148f15a98a1b98e115acfc4abeac3cf64c06e632bc4bf4c5c1a74b282e7f9872604296872c9eac65e12a9a0d7932156a8d7c8858aa0a5340086fb027427885dc5604751e0eff4daac66a6f4983466bb2c555420bb766688ce067b02051e772486d1343d1c7f492532fb094c23d9f5eb6bea03e71c8f2ffb110d8339e75052c95b5e60bf8006f3b85045502eb268094749c750b7f6985186868fba9abef144f33dc38b3ac0ebd2569c51e8df5a8e545c469cb610aa4ea25a6d522917cbb34e41a7748d5faa53c4c0b4aa8fb506c3bac1f66022c695d1a43707498efc93beb5945c1d8ddf2598310ffeca563abbb1bb9d21bc1046774ac6cca4666fcdb0eec4dcef94c4c05ff01d4a46174475318f86a7a08b0e6491c5b33197a5c14c0df185bebb045e9fb7ead3e44a041c6b59bde136a27456a7bae714f44dcaea67e0c060aeb70130271fd512e5731df9998b10041df9610dfbe9ebe9dbab6bce2e051f20da3427d37ed4bb6fabcb65c8dbded27806f3f830cd3881f6e044a08b90bb13fe7675f88908160ed3bcf9dbd799f2a44c9800997afd6956f86b72a01c624c8e6da70993d26aecd8227506f1bfe0566f60cf58094868dc83471110e1752cf2f685cb72c5253367bff72626a5668e72f7c369d88382fd2f32aa39f9bd699162744a097867fa6f775d1924e48bf7a0096053baa2c66e94db099f70366ccef078bea4fa01b7fc77644450a4de666d8438607ea92ab26eb60e904b74d373fba43ffc5d02ffeb7c8bf942386cb4e88ae718408bdc97ce9030d55ec2b3930d3ca857b872eae1e1840c8082f01dd08c5e21b8e3da95c6a61ad967e0390560e82859b779754a5cec60dc4e458b9586c945d71863893b158649610587eea689c018723b882af4adc7a898b9ac3e62b0c7468e46bb55befabfe6eb38afb719272b86c8b5bc8fe1c9d67675f46982e1e0310e43ed15e3b2d271d19943b41fe4f052042a028a52c89cd85135f5a9d4110d9c369c2f5b7f070ce5b82f5ab74d638e31f4d8b965310cc5b4be60094fb34e49bcd48323db14f70a5cc07e45bba0aeb4a8f79279bc1e3af480d3e5cddcd571d8c22fbd662569fcabe74ffc2f62f858ea1039ec0694b0cdb1e4bcde904daa0aee75468c91ef5e719719f0aa1983fd0544e95d6d0cfc9f8f0cd847d27634d38c5b42495c97751dd7e540fe1f8524a1c2492dd09ea46346a679ecb51c5d39bd8b3b2bf448955427d115616a33c592affe527d0318a1d36b00de330df0b27aea2c41764db8a55dad9f4f11e865bb3fca5acbf8e9f000c9451026ce7a20d6d0007ce857269067b336346e460f295af9a0137b548b352343bca343613a1bb2893736fb5c2dc3d6a07f5f653897ee957fb53d0c67b99ddc5d26aeda0fc45a24a04b322b54e0eb81a1451a03b671747d39dbf979475a421fca1475ab14a5f1457f8734526fd2568176d7992e746b70d653d09963429d97bd167236bef97e529a6cbaf1c0db65340c9cb2e4ad687b46516b8ee6cc32f85f96029647353ab71e58feaaac27f796d821ee75162df0522eddd9d26ce80ac90bf6316fd80367b119dbf27de6b23c79d8eabef5cf70d5cec9ed76b6e5d5c48c2cd8a8c0ea42c300f03847dac7634176b4432e07213f6ba2f1c982e0b62084f1746b192869d2ddc83003af3a782b96f621c7f24cd3b2d4a5daafc66964c811eed31abd003976bd4fa8b5b609a7a1a12799b7a4761d660b050610152eeae066d12c128225434c282771d784c1108ecd92cd5a897ee4ab9dddeadf6c6157739ee26c5fa02131d20e2a44d160727924ad1fa51b5dc4959f157d7b0e1a2c9c7c4697dfab3e55a6acab13434d40131ae8d59108adf8e34aaae48d1807729d67680149b8d8533510c0bf302f4c5c38f0c6e7508c8aca7e71b2e06b57d0557ecf90a93572f8e8b78fa083596380a0ada606787a85b803a9bf58968b59ede9759cde24ebc94360b6fb3c4f05a768568875b2b9dd73c1e975d5d4f014b51ca3045cbdbc7653d54e7570bd2d0fe4cc3d831a129afddae204ba9c2bbb8c57169a966c24caa30a9d0dc2bfaac2dccbdff34f1114deb8d1e92fa884c531766f4acd22cc53af6c92de84b48f59d16441cab269a726ef9731bab17ae05ccfa164088af62f50b6e8d08a823b8a402da15dd08f08f9ae76ac54dc145af46235ee7a0c467f893cd4e729df97caf48d2da5be88594bd16efcde032ae0b4baac01ae3a55cc00517a09c6f5826bd5ce150a70b6d3e218753c5dc7907c7d6801d8d7e667c5c8b2f10ac3472a5c84c3cfd416ac7a1e13c0a03ec64286ed8d82f70ceb1d9865787df580d04903f4ce575207bf85b209e0cbe06e6c240095d2c71583d8f3213cfad13ed3e27f9aae6261d9663d3cbc7898135bb9ef37d423881cf068e90ac8955f5e792ab4f9fba2f365733b9f084d4e50cfa7818dd9f4448255788827703955e0c6cde9879f4e792dde0bb2bd5bc22fae1763e731f98fdc677be13ea208818329ebe83874e50d7d80b6c8cd93d29763a9e38d01c58e3ecaef08e7c7731fe0849c9984121633868a375295adf627ad83e8d7101a66ee369f790783b9ba74bc6f03557c8ea4c3062a4865ac4106fbd9f39f143983e3d165528f4275cdfa0b9eb40926d3cdd04555ff9959fec222d3d0460c50c686ee8e6d70ef8b01386c9186bcd51a2538b993beb46b3eff37868f3c40617b711e9e47a122d0d25a6db7dd25ec0b664e5ee2a4ae5abd7cd4dd40134e0b13248b448fb2414237e71301bc509aa9b5327df3aa9e6cb07609c992c7bba375b0770d2bc33f6ff98e3fa67a21cd6caac266bd830330f3c46ef70316262f961d347cd67f8317c2f563e521013c3399981d387b94a908d831be16b19eb009b372ddec2296faf9aaf9cb1d413e5284e8d95aff31dda0df8c5075d542d8f2efa69377d8476d548de17b922e244e0cfebcf972c5b3f6e6b8dc8ed2ec72ca0d4c5fa91396b27f63c5dc3c7e9b8786c2642fcaa1d2cda38246c9c6963feb356b8646d9d9eb2a4f1951b6f7bc31d9bbf4aa2e9c43608051f5bcf913005c1f24a9dbae11ad05c3083d2043bdb887f76591f5257942a85cdb11f5a9b860c796d5ee77405820a51474a589c72c5af0e231c5d6553524bd13fa32341f09ed2ee50b147196d8c79f046d5e08d1ae29449750b2c3e7d5a76c5a49db50c4139f9f447cc945d8650cf87722058dfe62322fa4fcdb5f51fddd0ef0d1b66e2a82cb73e32787c65b93694e641d91aa2b37473c8dc059e7ee8d2179ea518edcf82b639e1366db2c2e43d07d82e4e3bc703e11bb6a6fe8296ac73ec8bce1aff95da42e3e88c3b9fb30be0d78261110ff9e6df5a255923f20635aa95dec62d84e9ff47da29860b730784bcf8c168b197671e41abe25ecba64d74b2e65eb9689ccf15d1072edd1746305d90172d4af35f0a465fcc309377e493b242173657b8200f741e02f93786baad067e0b1db860010fde62b209f0a376400a201f9945ddc79b58c0e2cc914ea17612f78d832fd94046a1786e5722d24edad0bc27f145768450f27f6bf9d9edaf22ef3e7a36f3582f1ba3317e769f7debf35cfde42d238b93394e0bc9e370673484bc55961aa15765b0d574d1aaa3ef96fba9b87b4fb1bf5344eb2d260245681fe52bad8cf697d69fcde502aa67a9f312e430f12994fd1a1fd6cce06f8e81155283d4431dcff47f6bed70c955363fed5c2c89b0e7c1a06ce3c40d557c6647ec9f2111e87c3bf2cb55ce017c6ea0bfa1cb91806e77fa7e34714553aced5d74a1a4314c5f1150ca49b56b40e6ae73a947ef571190ea6bd43b586c941a3f69cca1071cfc50be8138af16ebd3f6d619c59f9efa2073ff8bb132fc6681d2a9b1b280d2d2eb79262f3754955fc4747d202b70fa5ee896e3605720da3fd4e094fec6775579ea0f8175b88526e853430f69cc0e46803943117518d03b75516d338d1d59d18cb7337e0269d450a2d29955ba0c2ae9bd47cf81aedc8a0bc9b6a20fc545fed787b0e8c0e263f1900cda6537e44c9bbd5425486dd192e5dc5944bbf89a55ab0056ff9df5da747382ef7ca8e375aa491fbac61e45f05c8d9627359bb6a84f0f28d2e8bcba957d68cb6da54712bb545390872dbbb5f52ebafc68106ae524ac3b96b6a8116e97914330a38e22e26e9374b1eabf6492ceead4295e25d50d01c82c3435085507c2d07bc82a5dcba33952eee94b8c76388930730b24a626bd9750aa0a3d73191a103a95dd74aef7db9a9167116fd56e5f2698f0f945d5c2eb0d0375f5f84e1c71a3c6d75510766bdcce4e3441f95b03a3affcf8f52457f803ad59a5544e5bb0040349777e1f00c4e2e8ddda3d0d88c9a851e7dfe55471e6d982dbc0592c0d25614c837586ea93ec6e922b55865fbaddddad4fe857a0fce40110b9f86de3e2ce270e4a605e28b3bbb16ff26ab0a4004eaad6f5fc65ffeb3e0ebef20a87294407b734bceff97377629ae21b37b7b9c7e3d52345713c52325342b59ca5de007a1aae5ddb407d67f8e24d58c54d2146a28f1f3c1cc5203e75510fabdc10baa6741edf9fc4e1ce78449a9f04d739ca604fc1c22f06f0d2dbd1f4441a60a0938df0329aae21d82123f72eba798df2def725d6418b6b5be8d1874c9b13bd65e3cf553736bfc6badf446308b1432d15ca0769ee5789c7030a7dff926e658d3c25d07e8965b4ff5821f2572da6da1e3d4a178a3ad38f395f45669521f2956dabc800aa47b4430c45848229afd0dbf70746ec138a3d1659eeff68f69866c8fb675e0ceb41aa6f87194f468698dbb652d7dce2444c1367001382730858f0f4154e4177a0c7cdcba6560672739177fea8361220ecc3622f42b78dc7931d4bd9a729276be8d1d78bc66a78294a778ce14a0a56ecd60c1be43571d62181be6bce4ed5002935fe2997892ec951471e091755105daf9ea236231228ad98deb236cfabd85c61d169c538b4a805865b2a8da2b47b3646ce2ac1ef599df6da284a88e2cfb443427e50c09c166ed0374a427450dcc1ca020a142574c1ddcdde579fa4a3e50eb28845b2837cfd033ee1336e22c506862779f94c0da8cdc4543ebbbba95895b6912817be89780fe35949e5fa90036767483df1004415003160540569bd4b146c1431264344cad6d5716acab63af070b00cff3d02816ecd53233ca935eb524b86418b0a5a1136b4fac2636a064ae563e3dfd5e302979bfb480e79955eef3b5bf2236a38439db15f20d68660d96504c3f8b35e481af885914e21071ab8dc947d70a2b6619db6fffcfe7672b3597a474a79929dcec847e6493e2c7b6ce96615ac86a97f7afc117fb9a058e311ec0213f1e0be56b405060de687452246bd2071e0cbb5e83271e6fa46a17af03c6421cd16e09171a65fc953ed0db04b1cb778f25d3864317a03e5f217519762a8317fbda9b4f469523603be583375f1eaa1583ab509e0c6ca8436d146c23a6f60385d1c1d0fcf4e150e52d55b660105231ac59f1c1366c9680a7fdcee977a41ddf64f21aa1d227246d0f71f9d419f16b0c06b4cd60df894293cd40bc8e089da190e46b867f51afe2791630880e06391ff54648bc81bbfcb7d2f26bb5c083f7330261e43f575f5e06e9903688e8d7cbb1adcb183d65174c44cafda0ed2ef3ba64d435df4e3d7d1d4ae0a8ceab03fed56049aa19257caa50be1cbae4435cb1e1f024d76b2b0d7cd326d5f73689cc3819120424e69e28e21842a6a4a84b33ec4ec8a44faf28fd71c5dcd4e2b8a58904e985c8bee288a5ead8361ec788c454e1a22400195b9e401fbe8981798a038f89060513e4eba4902c3397c3701cca1db2c0108ecc970a8d231856f4d45321834eaaf936e8fa1a4b4eff42fea1184c2968580ac918b73e8bf20ffb6d5674a92b84f619f045bc700081f71bbedd07256e3d609d397de5deb001c6381ab3582c9a2d2fef07f3e3dc42ba20346a752e0a7909eac529cc45377eb7408dc774bfcc5068db6528043d8f73e6f39b3517acaf23e6450f3725f15ea723535299585204aa2d29aeafeb003a966cb5f52ad7e3d7836349f11d5b5c3294e2b42b7b37afcaad05b8763f242e79c110fe0d4496062e11d76002fca0c42e5a639933bcd6704b8d5757894e03deefcfe891da5834a81afb9aa83a566b75d82ba7fde8a2ef7c5d42edd13b3f6470ed502e2b68af3afaec6e0fd9f0f8ee022b12eb8bee51a02f1ac90d11c609bcc3902a1a0776f0ffbb930ae89cc24a7f50b48e6aa8770064a215c0d41423a5cc0d8a5e736d3434af0d2e313e4f6701fb21dc6c302899ffc24d7624b3c7bbe2670efef8e4ff6a29c626758b01fbf00bd308d132734280c58ae2680c2f0728c519ddb0fae62b39934b81565f58ea57ee86d338bf8663e65485173b29ce8144d44624f4feda4030eb446df75b648d0b9f6cddd71bfa728fdd5475dc4526927607ab814b0d6e26b387f381512d1d17c9ce252a3a5d83054f9482523e647521cd35c33f062dde46cf5de0c02df75ec223691eb2522b5a3e410ac60d864d04ffa1e8cc388aa9f9790c7a7d4ec5efca7ce842a3be58ef95a1ea0754915251fcb4b9014bc6d1496cc7da6a44b564c3e9faedfb81f2769667482d7811b9637220b552c8cfb4b8b5808a61d266906e981d2b86e4aadd07e88c31f189c7b8bb2c5b83f7c0c0efe7ea469e649ec47b865d8eb8f6f9bc9a5c31535b8cea063dc9b356bd826a47455b47cd54c82b33161cda4f53ce96752c1955ac4f6216500746a480dd4e694f0690c24439d68f1b2a85f6d3e7affa72b214f1f616bab1b2186b1620cb129a8b8c1ac2a5d93a33557902a95e28bd45b3808daa0ae451a6598f48f3f8c2f2e0ec7581c91f9726b5ba44c235cf6e9d30c8350920e8b7efefb26a34220ca35c5bcafcd308c4a5ce06303b6b5ac3f2d4ae3013cb35ff490c30096c44ca9ca13784bdb0042150c3e897bfcc42a1340f992ca3139872d2788638fadb77a2394a4d736fb1415b830c611e75004e765bce44e9ed423a3ea0bb8fc327e254135617d03f7d61541151a3c981c8510ec2b2981e38ad81994f23e772a842f4c6086b5e0dc2fb2e8f36c9d86c1f34b1a5a0f07af7f3479e86f1b4e10eedaf8ee671f3547115a8ad16cb45bc02d145189f258450d4ed395d4cb3ee73d2ac68f031d2e7b197a1395df6a82fb0baa59002e8d979168189f1e4d3bfc9bd28b77e3ad0902fd9ba54b6dbaf83d2dfd45296153f58656714ff6fafe9b264516132c445270c4c7e6bf06aa2f10f70cde5bc86fc17399181e8a5fbe262d9e683c88d0fe5c32190d9c8a8d81852ff2261345f28ca7fd1fbce13e46e84dae08e746fff556e2e06f86abb9bd9cb9228fe46fa6348b3de7dcf33f4fa20d2a7783a6f511fc9b03393e8350ba7a86b56b6c16286ef38ab1cdcc7780515b62869e2fe86acbab36903ca567d0b3855228ac2bcf2791eae4e3ee33fb03897c395336a7b0b259fb08149281e3e6ef600c169ff5fcc7533cf355d5e86a86ae73ee0aba24f77484fbce995fa01d070fae713f83e9ff56a0be89c971425f732123eda96f83108536c07c024815ce526c10fd37cf9000104ffb8f9c5c00a4c2c1a36b30a6b19d0546e078020cb55733670f15ed0d8be64d99811ec3a8fb6b6304813b894bb52640bc393d54e24c1d408cd8a9e25278b67c134be0a9bde25b1531c192e2ee1b7b5dcf8c81291ad521f466fbe2515865c9e8b6a2c6ce8f621818b72a2a9bb6ab7abd1aec6e00a0e5645d37b7f40a007270bc90880b8f7c86882b825209b80195aecce9489301c514614393869aac8623c2d18cefe840a21944248c02366610d6056d9c565a7f54de2d2bcb1828ede01031a4bd904fb6751fd62211c8505f41a330f0138f11e61f9d683bf1e79c1bd68346d66c2524db679e47eff8ed80982e6421b70d1752d6a364d92262197e53f5b05bce82fc21589c902adbe49697c24fcc821635f9725b8b21de814e4512187b8923ce81dc0417c8ea494503bb39e2175300823aaa1027128bbdf6e26b14a264857b704bd703ba5ff8c658974d43bbe85767d555ff4042fc4561256d87bc58091bb43d43c01638d4d36c3f2442dd68991172ba01a8429f66a20608755a74a6ecbab2592d75784592fc547f7f3d0f1a112d5131c54d48a50dfd066e829019e53b76fd129368b1217375cf6f7b41e0c550fabd2a803eb18538a08c7134fb3e0a2130e304fc3c1c9d67718148612092ef9afdcb6580341aadd783e3b183272c5d58e7e77e68d96aaf3e4b42d8509af68de5963d761292c3154405015fea8b42f1c91a67d55efb01e51c06b282b5c82bd2569ab8f888098b655071b8ae172b2cfb043086c2a482f99c2ad5a0cf59738450dea9e45114b4cf8395345317edde52883e3682e7a29cfa091498dff411c53b53ee41d8740f3fc03303bfebccf1e8367b4fe26828caf22ceb7f58bceb69284a73a48b1ec53016662c226f0f6f26ce15f9426e86200dc746ac2cf37020b51fa2600c1e7d46b314a767fbfd2fd368819db45fc91e067bb5330a9796cd388c2d7055e0796711f5eaf2d69544fc6f24dbb5ae703805a52faf915fd1275f652f9a3f351c8ae6fd43fd94ba1688386d23e56957503e82456690bd5a4214d4d8fd58e53e953f36ace628f90d73eb074ab2c7c111f478e013604d0b418b4ce3ff85a3fba9fc44c45bd90b9df77ab4b3625e6f49032bc7c54b72b07f9a48e24df8abe8a20f97dc5154cb6bee0115d71f933c722c96ca4a71dbe43ee8ede00f63fb5cce45a88c684581fafd0dbad9849bd2574797a6c38a91af78eb37c441933835c75e9c1eef138946dfce8cb2b0e2523fbd8dfbdf4c0ae99faab16a7dc19e167c4a6cb4c98a6109e0c66a1ec827ebe70852187332b7b01b872bf4312baeddf904b64371fc14bf4d0cb4b6acd59519bb582bd505bda34b73a1c25e6b3f6899c2b76e3b2519746dcec58cb3edde89fab54b3cf7068d435bf19b9eecfd206f0d28f62d99e00cae0f2e4e4f14da6c5c6262290552ebf4f44bc66e38dffa061569711d219791a9691bc3f3fdb04d00ae0819b789f9459070805acaaa2c2431250ebdc714ea8ff6fa34a698728dd8618633336ba6b7306ce4d241b303b80b721c76970c32b2dbae4422baaa4ced9cdc3ca776d1150a0c9e75dbfb92038df1bbea75056a0358b7b87afea0e406205474299c4516d266e6c792e30bb61fbabb40e039d53d0684f929310c73b9588a9b1f0ffdf647b735fc21e8aaea7a97ece4bdfae04985904ea77bab09d4d8df49ab3e041114a6b8685a602a30aab08a23c64d82405662d5466ab103ec33ecc36fb755c8a360dfcd6a231a70c7122bf71c9476ba484652dbe70881daa6b59dc6bd24eb123838ae61cb27aa2e6e7b331e53cf4d661ecaa822fa6ec0c4eb2b21858e82713ad01b17a61577d5a9761255d2b43b1a48d7e2e8eb90909439bdb583559d306a431516f8eb481456e6c69cbd930b129d38acc0d280696b40ca24b39a017d6ffb47317ed52c03c800c1b7402ed7e9a901fbf10632c5ff9441a53bf3e4fc0b2cbb27b01ab0863ad0d805f0dcf5ad65db788b343605ab9eb94277cc4468352796b42d7982992e6102fd74da5d1dbecd53cea0551b6d1f30f056d73b9aff96de63b3fdb9bd8225b9cc1cbdc11c14ace556c7b2afba4d4341b25621ca538bbbd1ef4cac4985dd10cc8de0b6628d56cd80257d36c11b2f7f536a27a30c7fec8d7b9737c0e59b9f6b544392814e887d26ca044a08d8c0a14778306fcfedf625d0ae13bc34c2245138c05c538069faffa02f047ef3461f2dde6f67b5e8ba12c7af1e7ab65e862148331799a5b8ef0060ab88ee0b807e87a957d5173af45d437259edae0a0302cb74dddd8b29b7dd5ab856cfda04ab502e9641bcfbe5d70dabbbf92a5a47a8ff1c86164e7655cca1e0c22e7d4ec48c5640543db1db9a85efe604d8a51b15ecbbfc1037ac4551866723fb118ea44b48d3ad9657f6a79d99bbb2ab39dae30357fda60a4917bc89bb4bf1b71ffe7048c685d710d48f94164c68aba1e16a470bf5a6728fcf0b7a8a539ab206bd686061b3167f774f18d62982fd4dd18a5cb90e27ec6c1498ec918b2906eaa92d13bedc77f1f01fad49701dfed3c715832e288a30e2a9afc108ba2d45ba3dd55438b257b5d67c4685990ecf1630fa8ddf8f5abe8014d9442889fc3bc4256edf2018803d568c1c6064ff13bf0d65d3387a88385fefa6c7a411f1f88cecf753354cc6f5fdd7ee27f7d41b8761841b118ac4138df17665cdc941b04f7f6a212c1cc7bf6231ff80b4549de9869cb8b6d5c2e2bc525a9c94423fb9e310a08cac45801a286b36af29d389ec00f2372714bb695aee32c311c5f7573ccb399aa578bf63874cc45f8a70137dcd9cc879f45d41e0956e6d99e968d3b894c990e53e030b10d1d53203e92a1f5e9f95dc6876504be4fae9c8376842708d8e95e9741762e0ef91e968819516f7b958a60cbdf850b82d4deac4f332520ea54c8183340b96850710c85a37d7f076f0c64f09d7652dac2acb3b2ba18a1e240133d356185edd0464ae91386c8fffc9afa3efb1931d8b4f4bcacc5d0048cbbdcd3fb6bca2f7dc1a6fb17a095e6179ab90863f3d8cb20ccee96841b624359c98fec7c7b1f0a06383456513fe51db6c2ffeeaad50a4a1eba24c54794382fd6a706b3d9ac0f3f452d32a59d435d3ce8956e5c370464bf47905b8d2e67c0fe3c1af72ea2a6a10c33433272d377ea2f5c1f2ba09678c0a10a768fbc42d03a5b14f0cbcfc5f5f841059d41dfa6b7d5399f44d8a6518679647ee667cdf72583f913641406177899a01038464222504d3306faed151e87dc06c58122f4018b47510ea948db279a2d487472ef59cddd77973d1af595ac687c85cf17831c6a86cabe147ee413c8730bf6dc7d9ae6efd57d27777dfe2724b5b0b0866acd0f54a6c51f116be667080bc46a898fb29b1ff9dd84273a95da2413abb2b46b1c4b6a1aee27e17f3fc92b90b197b800a0a006c2c8d1265b3a5ba2599d4317fe4a8449664eb5fc5ac43c67743460af3a74482676455db0b1a2e94f751dbe6bcb14218693d88b56df7030365662b938d7a7efc508840f78595b71e52c1330d82898e1d49c01d92210d2d0270384d669470760c9e4d71ffa8e4a02db59abee413b62d7dea412909c6c5763018d2e804ea46a8218eb258a958cdb3313c7c350fed3cadc027937ddcbeef2b4f3ad72b0bac15294e771965a0a3b8583e779b294f01c0c7df07b73af004eed25295b0af569a2b74ed7ff31275402c2b98bd39256163c2b2b313504beaf5c3838b0e49320dae4f78ce69692d7587c9dfbb9008666f300bca59f345500dc394fcfc7cd77470018892c3ddee7fae00279ede72a7313ca5f510b03b806dbfc884dedca3bb29ec40941aa708f6757edeafb3a58c1ff37a864f61ea3da45606e49913221b84f0995071eb47dc876d316769dc2809ff764d2dd405a48113a7057fb40f53e9229fdc6052092352c1d51836dd3fae539147bafd68aacdf880b889255acae15d65a50fff90061f4df57eb6f420be031b8343323b7e46aff5d169e0818ee06778a2b25a18a395c83d88d5f30cec58bb93f31546c1b472573ad6085a674506475977eeb7dea931322c44273677bf9690cb08a8ee683cc0995ddc178239e5089d5d4e5e7771726eb246daee21c7a886d6936660e1766c8e3ceb82f1c97ee97200f3ce88cab9e8f86dd1e2fddb7267cef1790185688f8ffc36efaea5713e8b024279b2f762c126fd08f13e83bd5e751305f593fffcc0fee87cca0073651a17b9830b608f23f87f661480eddd949bbdff8e56214dd9b6db84bd8233876ccc93bad10312aab4c4d7cc214890fca8e9e95142c0b54760f0456c7f3976cb101783bb54560205060f361208faa44a41dacf11bb42078684b5b1eb9ac5051a30bb8cbf2dc438f496d968f12f97888a071a569643b23273b0d8edea10b438dfe5ee43514f125e29cac5bdb29a045f0e627da881da363ae25944820262934594e7b401449d8b1b46d12b6c16387f366c03dff7a68e8ca6aabebde163c6f135059abc3f0a35f5cfbd4f45d25b96f64b8175da78915477db42f460ffc17dae16994514a325146c45202f30224b3276d7831014410f4b85343fc80048f4c5a8eaf2e28da55aaedd6c488261d49c014013ea879409d32c38aa980b1f2293e5b48bbcca6ae6190b75188653a0a0de02c35cf2356e8135402457477b7e2d7004343c8c83290956d9e585df0ce85c53e1d9ce010ced8ba8d9aa2e5256d047f78dd72321da224f91f3c740e15ee06904b9d46caaf6f964d948e19cff290d18076e8a5606f1b7c9c362b7fdca118dee8f084984ce7a55db3fe260057788b3972ba48bc7e5cf6518a39141a3ead0b885b4be3454d4c4b638772346c7fa2efbfe54304d674434912057ad893406114ff216020fd504ccecc289dc695136e2a0cff32bb7343a86a2d0f5235744334026aa38d9ab8e68a028dd73d0e0abc5b98dfed36fc64c0a5a1a7242e5652a64a782a7fdb48afdff83f229fec59b6af53f88811e1a096413adfb0a14cffb333657f5e95da23e16bb5e2a6374e28761262212e9f9fabb81bc18d18757cc9fffaf65ab95bf1ee69019dbc486743c33657d7e3f386d7a396b0f84ceefa3216b273d43399861d3e213b78666f54a2ff654458af1b18d50f9eedcef25cd8b14aeeb8d48c52cd7534186bf103c45dddaab4473978c3a7771971aeefaad23ed4b1a733807788336628da56297541f77ec07a061ad3c06cbbfb7930117e1e3da59bf85d8b66f42abef4aec7c56ee4efe7a1e556a764deb878fbbae044c79612af0a1869f138221d392e461dc70b300738eee3fb417163995715d9621d1a1b6c88a5f51d31a19140bda13e691a2037ac323485990c49ef054f457a8c0e5c302e1b00d4eef09756431707d1b2ca1ef6f0bb2d4a1398f39d4fc5f231756a729ce7e973ec44a129bbbc3a4b2d0d2a85c6a42d364e4557bc990c07bc368831290386338260353fce20f304d93f8fb90531208436ca52ec926d1c19c9d56fc9cc88e7f3962b174ab646f7d308b87f82c92d5e5350b1a23bfe7ea0a9750f71a07f75a8f0bbe1d2cd2323141f4c21957edd27775a0c7570a51c89b48947813364c943b3d68a47aa88b5eae914dbd65e643ac0cc0cb6283de008462e675057fd3762b91caa7a97ca34ecfec327c98d45b704e205fe75d67aa218e0004e11adf6e47b5f07cab7be655d9780934a2dfd46d468179498ba26ce83345de378d41f522e028f130ff3b99dfdf2f48c60fef04a1563ede7603dbfce0c4f8531442bdb35805235b82bab6225e7eb83983b32884a5fdc867083823c35e0bbc385146014088474c10ad903c5ebacf082c8ed98572208c41f7c3244641001b23e887eb817ad8b480a6c5c663b1d652aebb31b591f7e052876efba86feb21b0e70a0f6d32910b62f4c1968e73d6a68f658c59dc1b537ffe9becc5b0bd2d02b1184f44f798bef17fa546bf6e00b0b88c409748699f066a0907f8349cb7540eead6d97e08df93208fc820237dfda0deb35c48b8101411551cebb70a153ea81cde92befb07e969663adce262cf67f914cd4facd2d12ad3edca4589a4cd743156e2b011423c4146adef1e4e9664170c6d908bb5cb66ea0d66c3867effa851cb86018abb32ab6a2a0cb761341984c1bd4b7538427fbdef85140054b943896a2be5ddd4749ea853d2f297516b54acc0453a60063e3a23a8f6175dadbe04288035231802f6ae4298a300ab478303dea0485c7f90fc53e01bfae282580837cdb070ac5c6f1775af189bcfbb9ba755bd0301d1969a2ba8141c4d8ebf27857c76d0dabe183e40b107577087dc6fc79363bced53336ba3acf892c4e955d079ebd6ab493f26f3ed5451346cc7f2a38923a0733fac068122c5b352a0f78ec7c6ec65b06deaceac8a5c6fc8c42f4e1af026081aa5062fb5e5e57b6e8b5d16103880231de3563336ea7ad97297d7b4ee7383ebaafef374292a3021bc352c361f72d801e611f591e4dfda1cf4a7538fab791e88a6dfc2d3eb62029b6012c87676e75140dde2e2a383351371dacb50060cf86ed2153da247a2c4f9974124c5392f327c357993ba8d736f16ff427426cf749727147e44f31309277efa7abd38f6d683c223d54a5be29175f066cd140e74218ac9612c50b12fea8f1f76644b5becd0e1caeebf0e264ab4b349eb250c0d28c7836990a91d914b84cc2b39d0bbe3ac244b8c98f07e5b04bed98aacda027c152e2e2cf50213bbf79731c3c98283b77286d91fbbe06c0726df58ac6ee040062139c6ebab61357bfb867cf0255e01c4c767ffc5520a9f9ae72839bbe6b94a5376377c01c84be1eb48c0495f0d19fb6192ca1009ec5cea32850adf1a19c6722af8e643f1848d9234f08e9260a2cca04bb82e4cc454118b51508bf36d20e9e2a4d95069887859da15b427ae092e7b051978bca9928a0e6b55c72916d08e42bae7e4f62c2aac17fdb9ba1f7fec876c99e9a02022f341df8ecaf4f72c5396cc963ee17e7a9bde8a5fd9a816454ba2e0846f13bb36b37f40d3ed2fc389e6f74e3b58f22d71e4e06a572717d196086209f5696d4f6de453670aa4bb5d40d21e74737e39cd9b8ec5e1359a96600f5d7b31d4ddb5e5715c84f4b37f9468e7c68f4973678bd7dde6fd90b9c1bc8133097e7bcd350a9e702f69735e7097f1eb742be61bfac1e919eb6ad580011e501843204253b71ab57afd504e775a763ec96ca5bb5c847e9fd85ec8567214a847abe1155e4b6abb695738a47c5d5c01718e48cc06b508fa2a0687116b0f9da8046eff496218e46fcf4d38e682cb95d0e96936a88cc2f2dbd4c498ba6e9dce62e58934351ec6da46154dc7babc20513d763807d3cff73929ec1e271a22501b4129fd07cf43c6a129362181909c6d77ab62dfb5cac683a1449bb538d9e2323843c78b32bfa63e7b959d8a849160b9e28c1ce1921b591a77b9a020a95f499e47df91656834487bf00c6ec43b6c5cc62764abd260bcb172d04239137f4839ef394d67bae8bb2970597585ebd7586ae35faebcfaaf601df6cc0c763dd9a24a9a148ee21a5c26c461ff82c279bef7005e2e8dd7cd4ef2ed3098d3123ad5b06a5c4559e6205c161f53d1cf8f9cbf8a5476d1906e81dd92d1dbc0e452d5aa46bd202e2d321bc27b70a4da36d0a28593e36ceaa592e5e4b0a1b6d2dc3fa694fefec5648506fcaa1c65962c4d7ab61e357b182ee6d9de749e0ef4c30c422d1ef52b7ce9c0a265b9b7531fc74eae61b9a3e2151750148c620d9963ddec9d440a8822b0022a9f31fdf6e605676b5a495162201653ab7f5b9daaf2eb0e5761a4da5e1e32b9957fc614a0afb0d26f41736cd1d636ec66d2bab058128abab2ef1005bf13602b2dfbf7e86e94a9d36c87448494774acb91b42a5b3ab69b5e46e7047cd8e23f33f7e5cb690293ebeb1dd1bf29b9c7a8ae840257755779567804a3b54bcc341f42c4e6297cc04c0375d5fc03656bd44e457f82aa0cee724de20854fd9ab6ac3d5bedc2cb0c2bba871d1816dd7a3de940d5aa0e2b95f8ab5ef17168ecbabf224009d6dff5836e03505806edd2f36c29a6445bf90201438ea43e8cfb816e998d40704c46185e2a705732011801d178962d9df981c06d9a35455417ab84359903a92dff99b24fbec277ef0ff1192ea89a9548041c363df681ef3baf8bf1a43ca81bcb6a412acfda7bb3b170e0020064b9dbdd8465b1b4774f795719fb21a1744d38981fa2ec019c96d5d385680f92b74a97eaa1f5b5c8364e2232ea33808dda9a442c0daf098e5abcd9d6855034c9d63b0511794e5d25bcc22d5d06d20193ad93b27ecf54cdbbe45b28f00d7fc06e60df228613a5ee64a94edde05755ec638a10dae5abe29ac99b81b4fcc9025fef2598cdf17685f9fff602d962290c5373cad8b73a3272d9c23a57d49023d24b3ed771606083002e66f52eb8c481469f5f5ff6d41843c55631ebbc20bfbef779440e82dfb6442cb82d4bfefcc9c0578066e7a68bc894d5e848a0865e28585cb79f89b7832204c27ac8bdb0b372ee73f60be513fafd28a421514c77ab8640c7a1a29bc943e0379c99c3a13353a6af3acceae4535a1029a07d41c128c1ae4255d89b78e4e547e5bffdb165f1ba580b580bd757c3a091135d434518de6a81167aa7aea992d464257209976922f5d734d0185eb1349ebd8ec65d492e1c03ce33efbb863e9f284bb7ec0a9b5a2130628825696e9e143899143fb745040e9c5e45403489d32ee4c74c867d415d94fb65feb69efa065b3c57f2ec9e0aa2ab41826723301c4527aec12d109eb80ff8f943dec3b75560ef2b6e2bc22f3ba7aa6557fff1008bb68c5b7a720852656f4d7f73de53c50556fe9c882239377653e4d7bfc58f998ab6cc354c7bd2656b7457b0ca028e15513da3463d7144653f923a0be67afdb7b5799a417db40f8b09d4ab095d21f987e081e2e3a5bdbe7d025c0020d49802c02397238aa9bec4f8bb9df2db0debb2410d6d152fad80f2dd0519a31d6fa6e08d9f2361d96f6c4a9153d99b7df36f694914fb0c6d6ea008cc1990b47cc0812adbfa35ca0723368be6f53e5bf32dc5a6977ad016c709d2c959e94375ca6d8a95ee6a45bee74dd0f3de6bd91d585c14b1a7f04583a97bb684792ca079edb0d6dfd64d3039f71dec8a823fa1e070f35e757d13c97768d9756b58ffcbd9b6f83bed772e9371f98d0fb40b23a2ec9c69218fd332baa21459dd745a9dc22ebdb8f289d3fb1109a6eb7993ba09151c0e2747be77d37ab6a08c22db49072f83433137c445e386635d1b9d2146cbd221ab46adc7249b9908f6bfd501f400c85a7c3f77cddec015a47f6d99c7528f64a5097cd0e4c077bb5c918e273f720625189c5f0ad2856f21bce5663ecbdfe53708dfb799f1244515a45d8337f4f01a7bec6138de422ea44e100eb0359ee43fd82927915618c92798fe033f91f4a629f99bc51ffd62bad783d8115511b4fe996086ebe838ede209ff7eb0c50817db398d19e75f97a2b9960a1af1949ef6f05f2d6e6b59cd4dbcf417ba05d01f8bc65ffc39c92020cb28d522b85b4033d42863f887cf7e51dba50d3a513314dac0415d6d0211ab6e18c305d9e981e303dd18a194da2a28bf51cb9024b6a1675e2d29c09616a83c914114c3696aaca3f740f90a99a350352d69c84cb1b8186e3af6f673802b17d0cab6d3f0e04502da71aa32411011588e9eb3c36267897424bf9b3fb3d59b7043d96cb133375e13ccbe1c06c6119b3a7568fd35a287aec5c70f9601d4e4ae1cfba7183b72bcb57fc9172f795a6272709ca98b5fcee947d27ac0bbc448603777b77b2e11324dd02c4925b76b60f5b05b6cb3a9f02ad8add9b802b7e7fab6124f4015ddf46a74f347bf43571d2f90ae6626531aa6a80e6336b38727e48927815521a1f59ed73ccf96a0b63c6953b57237d0242aef5f01d938539762723f810b93501b1987d3fbb055a18651e957deb3d23c1659d4cc6d0b1b6c29eff20b939e93e891f756a69c3518d7b1643fb62df02c59f1d6b3e842fdc531c5aed76dd7011c214b6f57ee4a9ee1d1ca6f37283c5960ad5003c9058e7991c8a90ca11d2a84e72f52d7adf9322c16694b8605da63a11c3da5be62354b6213226e06401fbc87ca2377a8236f3c5029a3b669e054d156b04c06c1238f865e2d2f4f887531cca3403dc420ccd50f18b37d89a095277ee90e730ce11aa442bfaec575309a0d0c1e8827b57d358e4ca74765dac775a6a81df58cb9f84da65edc792e2deb4902e5b5c6de514d8ea77aa976b13ad08f670989b38f444851863b126b5b054edd6a9a4a749f59518e6a1662224e63b5a783faaf3b7a402b52b52602adc1adc799bfe45485e75bf1136109f8130b0476680cdbd3b05c77e7f7ad8fcd031df272a64b393854d5e80ffa329b94ccb59218ed8e853146b8b1a14febd298e8d766a6059111fa337bc4b679bfd27e65e49a639c78bf98c877deee42ec20e15553e920debc9ca3f4221af0d18901dce4791734b7215abe739fe06bce9cb40d0ab0a2666a07fe9ecaee707d69ce2b55f9eae7502d099380f10ff54abe7a7bfe72305277050c18e82d0a08e1234c34cf3fdce8380a626ffa327dfc44b48bbb9d7e0d8d309bd2f52310eb722edad2c0661b63f6c7095df339955cb8c316df82d86567e691644e19b457259f57626d4b64e46664d40f54beca66c7e6085f037521a95d121d7470b573edbab7934d254396b27bfa3a13290a03133f34d4439182b4e8fcc25173517cb3c0b3de50e3576f18970ceea91534ae480447c8aaa6d5ea208554909b21416b21fa209932e424ea8d351884ebe0e8ffdba18a715a3185ba1db0e8d89869caf102ab2d7500f3cfa9d7481816ad7a608be569ffda35c2aec255e58460650e2efecaa50b8a73e74492d34a25e42ffd8b71af7ed158f3632d0b5105dc4088c35955c9ec5dbdc56e1dc7467ffd2b0cbaea0c6d1640f0e9e428c08db70269ea11302921841f26461e480a001480adb2c7c209cba83830cbce8c2b8eba558f22353d6fa73588e590177494f9b26c945129cfbfe4c9722f99ba364e1ca2e713a2c56f03c6784a281046c59028af5780839e118cd022293b1dbdb06a2437cf3b218ced23d368c573ff72421fcdb0c36ef3061f93e747abe8fee65adf81f0926a1a2a1013e4fb52461e393bb2c831ac042a4f07f4873628f3589d3ff48d96d5e74b844bb68313ce4054b8741b11b98b46f8d4e97545f704cab546faabf6e30f755851dc285818b0c533332d1aae783f873cae4e6c8ab1394865dafaa7f264162c026a5c08d02af958ea5026574cea59e08133e9ee44d72a93dd5d47a0565dbd98976141e2695666144d07d643e43066f300e0069ca44e98b400773f3c0aeb9ac5c5fe1898da0763f8b01647e1910b9babd62a8aeded2145adbb97b0cce1969f4f6b46eb6d9bf7e5734056fbf04d00655840c0eaa782941004a865892a14cb64e527d7b6a18c2326c58b3ac31ece62c55cfc261b21638a9cf1f7d9b02b56961134986c8c3a785d7829e6ed29214b5d217396b942024d20a34b5f383f8dae86d85b5c149a78f77924f648936a30f2067cfbee35b21febe6d616faddd4da18f817ba7cc34ead6500d7f587576c88ef02a73ade340f56b6efbe08d616af2ac2659e6cc66bf5abe663ea449847dc6ebc0c1925110d09b3d052cb91131e8b48f2724a5648e2ec0744acb938f7b69d9b529cea3627f4e8a590b07f8c38d077dac826f0ecda26dba015e604a569d1fac566ce21faa89853f6945352298458bc6bcae8588860a5f2361548e88649f281462831b8784c5bec156484a25f2975433b5ae9dd4f7abc3a0512f5f0dec1db2e36622aee2ae72d8358978db8ea13b9e12a1e2dcf0c921d32c93c0ac0db3f303787139492c5d644a129e67417a5a242b5bb23cde9f3d2a902c03ad487d7ea253e6209fbc7650fb50efce9d7bd37507e3e4c285b7f96cbca5e598c741a8b1d7700488cff15db9bd9e800828c638ba61c5707f68aea881e450737802b5422f59be0cbd8f24015557eafdf0fce281e310abffcfad1f76973d2a3b947e0efd45a3f4e4f65e2e3876ae167c3afa81396ec94f19f74b9b334980d0224110723411014a75dec687971ab81fc9f15cc4c5beda8eade00c4dcc249c42a84b04133012943555dd51185d6b9b8141d961ef578a424bae8ba65a68421ae41a3dbf69ee86d8ccab050edc7e3a4b6ef76588485c36e65044d76a89c2beb2a9fc6f5f43cd96174c47e979ec7ab2bf1efe4745b5f35c2b372b5a4107ef169d1f770c18450c6b534d57c38cb36a2cdff9c18457b34d18f07b83e9e3a2fc148109b54aaf4d1204c7dbc23e4621e6661e47d6f9bcb8ede8d8cd34925be6eabce93e88e7c97f3c0d9e76c67a5cca1d75281d96f2026b895171821540323eb94c2d0ac2823d0da0c6f0292d8f7eab276e1fd1c0d1d08389322fb99e3beaf55265bd4d7ac650a204605340fbcb41d7abeb249f5c64f98882da35061ff369824931f5497aed796532eb44b2bbc18894c7fbcda7140fba2cc00e5ad3482164d0889634747e222255d3c772fc7690dd48b06c36bf03fc2ad11ed42349aeda6e01001f52d77cbbcbabc4b7ddc1ba17ccdde84c8db543fc483277e77e89c8e6a00eadbfefa277bd1e5818e0c14bcba1ec65520e5f024a546b65a3a764e9f36886b9c8be2ac13b0bfe3a080a331afd0944b2c0b5a0c8f87cf36374acf4191d3dbf2551c1cbfe9cd67e0ca608aaddeb9f855308f8fd9b0cbab0ec7e3ee9a25a76974a91ad469687a9d6ae39926ef2b0abe4170a0f9258e5610b612570cb35dcbb02345a3543d6abd30f46e43c31b9c3801300363a3930d8e744d6bcebe215a4326c5460f4b23c3bee24846f43089c3ec2abfe26abeb9c7d3860ef4183c6c3a55800f279702f3e373f80f563b17ee3500ec04bddfae0afa1f8eaa60a772b84251c23cdc4411c51608b6eccc10f4633b03100df12217cf6f50ea0618d13f373648bf25559177117ed23b3677f3d0d87d0dfa6e38e81629535cf3f51108e43a4f0f72717ebd5867446a10f087d7bed3892da802ee7d585ba9d8fb43a20ae025da811ff189f67c7d4f2aaf87c8c09594ff9fc97b3bf0becad2d39a1aa369d07b2a4e2618d2d5781e950571ea783a9ee8fd4b3759824ea7ec87b4fbaa6b6592d19ec3de3996e6c847663ac5a5662aa3a0d05fa2b565642c790d6eabc75dcf63811d6ab55a6ef815fc6127677afceb13167c34e1a551c350b4a984acbcfda84c2e358fc7266f1d8f7d534fc53d490513bdae500a184196e182f138bf7a0d4ccfcbd55e4c07d6ff62a441f90dc3d7cb9efdf082ed3e0cf9b95ee942c2f4b7a869314686448b863e43edab68728ddb75613220626713d144e9fd4195196dd3ce797a09e4f4b437ff044664f914913509474149a9a6ba5dd8df8120348914475075b71480f80e7256be18e03086347c5aa962fb1a0bf5647e782746ce426bb111415281a3b3dc8ad321d615e95ab4690605472427d9d9dcac8a2ae56452ef5b9e82f24a6a18bdf427b2e70d578a008cc810045cf323cb2ae3b8abb6b25c760230276200d678710794cca71be16e196ad2f6c03c110dd2e3c1b4f5fa3968042750f647b3dc16775bee9a9a02b30d758b36e1eb6df923887c535bbcdac2db51fc84ba7012fc7831f4cbce4d92e6e2f25536ff7895ea837c9002d1504b413b569cac9a33ae74acc809b2f8267b5db4f5a27b00e4326b396f2909a980895cb4a80af5c81d17ca550b2089c3e507c606e3db5bf626ee27b6d26571702bd1232d7df0b3a3d24d6db9903d28fc2f82675b955cc8cdc8a6bbad6da8a9676d976d86b10cedc6e271dc386c6681012c98c56a763bbdb1d63d116a0696ef09fb1f75b54ff1f7c55988242a6a40d02f040c5eb4ce055dd858a1926f852dc14ed3348b45bcd56dae1ad996a1ac27ace980163073e3844abb190657a0d2c8ea5a71ecb4f7f449013a030064ef8a12400e37643f1d159f73bf6d2e38873b52be597b11ef2b47b3221380d13f38f0aa6d45da863a42423a3122627c0df7acf017515188df712751d0100da1b15404179521a28ee1eb383dcb2256c2465bb289089b22f68f18673a7819003dbd2313c51f23c3dbdcf995afe4c10975a11def0349c25e5e31037b05e818451c42027928d99b9ed136374af362fa9445fa4e6f4968fc2dd61c67d01afc1065052aa938259299d3742605adaf4ddb589c55d58e1d5fbe9b5cf0c46fa41db7832bf41a97ec9ca804846c4b9f44bf0e1d4dab565ccadf3db84525ee6197038593764511df93587e224d0298f0fa936cca6944d4a7f6b34ddadde7f3a7727ce6005461632fbd8ba9bc988f85357a3c07eec26eaf05ff66a4233ff6bcfd91dc1a4081484c8b0b2026e497019c31b65160e7ad0a00e1ec67841030709285f17fdc5eaabd55110f3f88df28e53c395689c724fe186e69e68ef94d2ba47bd31a8c1e68efec2bd1b6bf1e62aaff362d40dda3f8a3468f212588df05cca9f5386413fd733aa786fac6678e80ea2874220bdf80b1e03c14a067892554fb36478dca141dc75377247a130ddccf84a2f45b8166b7bc51c16791ea96927a4db17441222590541a9d68fda67b8f2696859f7d5450067e1322cd3c53bb938c9e01ea516b900f67e94dfc852a1eb589939c5149e7894ebc86f84d11d886b443c95fb32659806a76bd365564abf7fc9bd159828820ee7e7e6148c966a50e71b7257e337e5c7c7d93dceeb882ee4ab73c3bb116d6b1bcefe10847d708b2ae7f0efee96334a23041a0dc005faba4eea4b1b8f1f76a12050b0aeec920bd7cf460c623d17bfb683de15d6e2b4cdacf82327a7248dda434fe9888372f5ca1dcee22f5e8fbc800de628ab6bd3a6751a883ccdb86331bbbda68f9ab58d5620a3f51e23678fd17dcd35f5bb7dff0d5a42894aef0100508b0d8b4d5e642dd5098cd957ac2c38b120aeb81b32497246e9c7641503c6c410f87edb33fb2ecf520cc9a00f0857336dd281478d9d236962c4555b1050b00561a0f46e0d36ef5187a4fbdf99e6484c1859bd386b0ab09fab743dc2831bfef0a3ee12601674af045ef38f3da98405c2541166187a286c8fb9fc2d34eec2b47e7041b0a96639fb1a597e897d1386e0966c6c4a9a7563cb6c2791c12d864f08e65a4bdd62b3d76613c35897de294756aceea393d18b6f4b590922cff92f5074b5b056f0a4ea8f0d349a18a0e695b6b249c7d849960d0dd3c20a09c65717187b901efcaee7ddeea03f8956fd7ef9aa818fedb2d3623c1fb60825a418ad787e8f48460d5809fd383fc494293af1990685fd67f5dd5445b9cd242af0d6a4b2b3b43fe85413ee3a30275b8ee773dd9c9c2bc578ca0b9699d74058030decfa0d4cf331ddd5cc7109238b82e107f8cc91e6a5e3062ec13da37e25d025b2cce373d7d2c2b7a74e76b6748ac89dd5ef545bce88e3fcfccd48499da49811b655ae06e4872af40cc7f7e9d6235b28dc01bc7640e69bb3b7d378c2d7e36734a243be91017bce6eba574ae95523d42bc9c454677c4969b70fbd5fbcd8989f22f6dead98496abaa792b3eb9e21647d03a37ac55d710eff197042435cba18b30b1741979701e6ee4b557f4435cc042e793a75a84e494aa6f9e375877d1cf8bd9f0fc5e9c4421d6aefee4bb3e17d8efb7903602f27a188f92bf1dd36ab504c1e2c169ec93548c8f3c436514ec304ba73369d4624c08c4887a1eb6b958973c3ade65169de4bbd53b27e39db9ba21e12bb4847591bc63f9a116a47c9409dc5b3cca3d868684245d875f64db8e8879aed7c33d80e6292745be93facf575986f793b5e69afba7ee11ac5eb09f02540017425ab722832adae659ba6f834dfbd011ea33b24e0d9ed3cdb95ba622b70a7d519176c66e630b328a519e02e4b8df4babcbc38019130a0c1fed33bd0a09a9760f2e7879db9b88202c43553c0d5a504473092afcc91e6f0a5306d2b3c71b3d02b497b548eca509494e27e7b31a5ca22c81654ee281f15524a0134d78dd111cfc98c7243d51004e952a8e19802822885616eaecf8868c3458de19c3ce6943be5820f404cace09cb6ef12ba3ad9f3312a65a37f86a83b52c9f2581680935ab58044b13d232eb61fb9218337d26e96279889a780ba3d60050d26ace20b0eb11333785ca67d6cb81f31580fe2670dc7a1640bd70b16a41a6cc9804f5278c1af1854823d08b97b9ba8f9eb324f3f6f5e7902609363b7ba1240396ab55ba305efa74581daa46b45853598357b638d17f14248ab85e2119195cefa89c835f1d7db6ddde72a33f890eaf4ac7facb48cf7e6127932ec6f8333da6df4cd316cd8adcbeacdbdd5c430d5eff87883c268388755ed45b7fb4c4ce2ef9730731ee61c4d0ee8c935b7f5f35133ecda5c49b4860269ea79bf2f0fd2d09e40eb9abbc9e01a6609268e856d20094c7222ba8a017db778fe9801f468a54f0888289f1b4b6ff11fa5872da7e1fbe77184378ad1170b8ac6592f8eeded442d96f85bde370a9b4d1356abce42cd9d05abce85faaa9d3ec348619b7f4ef1be2bd046b30c01e41ec2af9e77d6e30b6d9602c252a59d0aa0fdb95c57a2b305b0e8a4dff08d50bebfbea3c6f56b8b6c7820f809c9024bdf53c932eeba9b429037336ee61f035f645b164fec4069f40fd4a9b48ec5c38796ab83d64d731e14cb3742e0086711ba856ec406ffdbb0d335c9709f2b14c37eb10d257280f83205912b68f6dbab0df23a346602b58d9be7f1082d4203863d40c2cb601da4e5d167a1f1dd1695f4b3a357daefabcf69c4d98c81ba98f9310e1ef412ea1d1991223f5facd14e380799ec6653602e20b0a473dc13d0db7b1b661e44bc604194f68e18b31713edb5c269190b7166d79bef46278171d3fb2b03239a460465244aa4594b904fb333132bd893556b3cc6742a91ac44a501a032fa0edd8716d990476af213484e0c889fc0b2e37563dc96f02266def11ef7ac1e4515e8de806707a40f70bc5a625aa1e69a0a02a9bcde6a3d37dde39024adef778ca65c8ed037aa6bba26584c293e6733ff7174357b67fa43d8f515184ab0feeb6d9b2b424ff831464e962f1917f33dc68b10943c202828d8115dca70d9aff9237ff921a055c82af39b533b58c06647a19dee6f027e59559466519661338df32248b1c59dafb851cf7179c0b6f4475767d95636f28a762e56de83723cc24b604a17e42579965be59c13f7b95c12aab333a4bcdf37b7504070405dc4bf162169ef01f4d48d75b4162b7ee92e12bc59d116db8a2edd054942cd7be6361d71699d20471a5ea2857baf3f5091866ebd214384b37d63db8898ab57b3bfd5ea8864de59fccb14f8555a75be6880cf4ab9039f783bcab6267b069a12b81b15d44217efeb755690c384b0778647d762ebd5a1dc2ae35c73115c51ca6818a80d24fab5fb6fb2a244719e19b18b5ee3b416ce141feacca3f282a12b18849f2f61a08fb87c4b93f1ff9deef515bc18dbe3f152bd5961cd31528145c18dd66858f3750f3ca56b28983e4c1fdb1adc0c989a96f41a8d5d6c653ed6b433a7d14c43064ed46afce43b3ae713079e7242bcc07438db2e323313fc4682ade31c0c23c04f6d824434939ca76afbcdd6072b8a6f239aa3e5e0b815e6019cbbae5acb96821ff3fa3d1fe445447c6a95ca22c956885b111f5347d092c550eaab74a4724990fcd68660b9cfef373283f322b6ea4ef9e3dc7241e20ef079920d9c45bd1bce310e317bfa1064f97f7217b2781906f5ecc1a5fccc9e7a9472c524938830f68c1acfbff27e58d21bdf57080a924a3532031306c074c41828bb1d24eb44b295f3dbae1102c71749a76156785da2b54a1ec31503931a58c76d0c07821484ad009401b3ef9781c76419c3ecfe24b0e529aea3705b3d578c0bf301019f2c2de4192e038078f5ec415c26a9c6a75582f688867b8e13f7090ca684cd6997f6d9f73403416c6082f20ade21e907a69a0c9bf501722d7e0b91014837cc6eb2016dfad3a0b01bd97a7005eead3f2f45dc3745aed18fed89579f92438a380cf730433b4cd6778d6c3cd2cec85b74a0c74e760763728ca5e7b392f3e508c6e143d5d8f5f3357f187308352f14fbe6d71ce1d7efb31ed702cad10df1d1400606389d18e085e9f2c8be4c941be6c9e1495dbe145517d5a444b124ac1dc2762a3e7c47068cd4e4d53e717b78c3c66b328065c9e57d79c7d44d65a53f5dcf20389e77a42827e1331eabe21d1a8e410fb965b0a580b78e0ef818e90a088347de82e3723a7da6941e84acad452d68db598d0890ecb22cb438c36a12a520e517955ef8919c8e54d2366dc84a538f4d1f5aeb288ad52c763db910b9f1559641f81c9ab801719e107c3122671c7683088621e94550ee75dc0ba6e616a81b504bc3bb86f1615665ba81198d87682b4165a23eac9137b2ab0fe0964b07a4b4db07e86e55c41d058dd161d4fe90983ca8dfa6579dcc032d2af66d5accec117716aa16ad78a1a927fe32af4d8939ff8af4a7127ee87a0ba692edd732736c50e77d709cadfd0c2604d644317a9877eda2ba9fd8117714e46d66811ddd8a9e7be46d8e44bc71e35dfaa0e083dde9ec74e33333f6c9e91994bd23f754d0bad149c71a60c91ddde6443bc8dd20d370d01863daf0c040a248ddc48e0e23e171bbd8ae27ca0a566fee0bf9ab423518e5cd9a6741c9e3db0472d7d511e81971d2deef2849b0dd2550629096a314262c9e382ad9a2e18218cea83702cfa527525209db82ed68729ad610011277c3a13ccad081aed520b3f0360cbc9156a7e54508ab255de9be797c3fab577fc5888c63c9ee02c9ace8f29ad6f442a6cab73a43540c6f65df8c8711435dacb72ddf7a29879a8925dca175419c1f9c7fdb474fb958d57edee4f403073eb1a9a72aa9dc67fedf1834e6b16a67ffc75807b9e980f583fb28290751ba6caf0207dbbd8f699d7375b97c68b9b0fbd5672a6f1f6105051e9112054ffa0cc1e35ea0db512981a50adddbea3993541444789a6c71f1c56074a10125f5778dfea7f86f783cf98853ee078bdcf7534b7b878c0c22ea2d8dd06fc9901e2c3f3e9538c7728fc8507db49e1e1dbcbfd1108207cdf2414c15f14b93d43429d19ee71535d174e00cc44810e48b9fb144d7dab8633087cc6b7ef358ce1a48e11aff77e9626c91112e76e1c8425fb052409a565127ed7d3c7e2c8b86959faae3b89ff3b90e8c4b15c8982f438195ab0a0512df0c8ea5a6e9b0338e1982f31589eea003d0e0bfd5990f817f2eaa677c0af5712e509405811d9a95b05f395300c1a38031e7bbb9df99232882f6de613ac318d011e6270271340e26642f0192588d1e6a71752faea30fbf911b4898f5c476e5899561acf021e9ef4febcc16db60e463b9128737b5561b17151d5615f1c5dca685f82f6c075e0a14afd70cc5ce00b2274384df3612b312a26cff6509c70fecc9435c5be422468236e4b05840bc462adaa4b98dfb0477ecfe234dc166c029caac502ab027fdcf550fb80abd61c3ab15faea81e09cac38ae8a24262ea28313d5d1c28f003f1d70ed8908e79234478129fd5eb2ea39cd7625e506d3a367bf0ce60cae1470ec63b6501d584405bf56aa0c21ef5024eb1c646633fc2ca57d2d1ecbfb1651159275a20244f348335f3490230799e5113997e59041858bee3bf0602b0625c404aa08e454e9c1fa619e2bab3119b0294d7cdb706d6a544926c77fa3ce3007e03f858ca4914688aaaa1363db437ae89b42fe435f317fadc01f21a86884ac623ff1ef33fe0c28b65284996ebfba88702ff5758e4c85c83ab9f8d46d7f44d229e18525d2cc0663186b32460c3b3256cc5f55b2f1aea935b392806104ee0e7ee447e7b1cb23887e8b7769dff96dd5d103030861b85fdea72cccf3d7a5e18c13a9fc7e389a56123b392e1a1e98b08e561f0ecc4f774a984e1e71c684d91791979b25fb2cb6f193be5ebb8d9bc294f4962b8dba783e342f39052e07f3dc2da74fc448c5accf5e66ab867824d64bb6c4a7e994d4e3d3bc606ca6757ffa3620ac92ac313e3e77a995bc4d648e6c5ccbd148d7e4e6ed09433d0d816a268c62915f08e2581e479de3ce1885ede90eeb56ce45d2b24b7aeb4eecd3c4f4aba0a4909c7a6ee31c4be134d10a7f7d2768a87e75800e3dece1e17a407ef7524b66725916251a778769ab2c8becf32900bdd8f4838ee8c84f7180c03671ffe66ba2bc1e04ef5b7ed9b5163de844453caf2f9d486113cf27b708306d16a6e86f56f5ffdd216a4173ffc6c48e99d871a4b932c2216b903aed86d0db27246351659f556a1210c9507b380cc826f39723bfa8396c70b3a549c7015a8e8751f5135e1cc1b0f83b03e9dd288ebc3b8888e584d0e6434f0b446befb7b1010d706c1024ba65c263bb8c9d9d038bb6c0ca40436c799466952002bb3ce020616daf3c8a57050a4d8ddbd17f3811a43d8fb53e830be7ed9fb773495930c546b25f44a7d6f939f7791f079d710ce6bedf9f6a4f8343d0a8a8a310561bc1874c56b9e0d35034310ae63adc1fa5328a230f37cfaee55052ecae243bea8d88e7331472ba75015fbf3709d0cb152c933af7576d69b1bb479ceb8950e565b7ac8604f5f6f1b961e34714b810a9168f444e577140e8f81494bb69d09be811f8edb4af8474e6b8e602ea1578bcae310568016433977f6d886336e1830ead0efa0784b063f23e1496cfede90045eebf8e8ab77bc63de60d8c24e9ee6eb0251ca5c1e2e41d476a0f1ce1f11cdd4539cf90e9fb2159eb228a12c7a5572ce3b30d3419ea0df1a9a4ad77d4263f40fd53855d61dc7b041798dc7f12e03b865cd30f5aeea2e0a5292a1f2a56e0b9e4d646cf2433e81ae28ee36a69b136564dd2d06fc2ef8802d8d95984a70677dbf8352651aa41a9025330664785817d0f23e7a1fb21eb3f53b1e763055f5a6d1c0ddfa7681781a3e4146b475044ae2e3488bd155d7b6fc9ddb0d95cbf0360aeee405e3318d8c1e4241ba14ef53352f9dc51e66c83dd9d726fa73dfe7f61490db9663eb4935889d7fea6d5daabe7cf0aecb731b44486a3acdb658b11cc2a98a099a560790f8e1e51513b6c39bd34f5801290f0a5146ba4fe3ee51d3689b5fbae39129a95da8fa5b1ae9b5e310c5523a5bfa55b1b0dfec4abf35fb56eb66114e28ac27ac4c55feb4045a1c7488e7bf1356b5bef3a04aa7d68673c953e830c8c9eeaa45ca3baafdfc3f7a0a18bc9fcb15a88a19e6f01fc2eb10d86f0510c4aa15dd5c3d877175274fa3f9171e191cf4b6f18f72e76d016f53afed8c1bd0b09a96be3756c37482e5105dd132b43c48f73b79015f8fcbc9a627fa2e5e0f28cec35310dfaeefe15f829f61d3f595808e5836bdd413b04ef496e66f9c8ed73ad2706000077de873508936a18cbd153564e01742e5fb4ea0b1fd6ca95d56bf3132053e6fa8aed4d7b0fe0bd4768d7e19797935367a648aad2d44697a7e127a375bde708c8664ab09f954446e608613d0e86658d65a6dbad74b4ad90883c8042074ec4dc68ecd4d69259202bbfe3396985134de8411f8469ca5c26b95e2ca8b68be89fa068a30250aba40f229db56ced3f9444705c2d439d4cdd1a730154ed9b626d86a2b8f1acc088c4be722715e06cc2c8788c21325c1c8f73e2c6941bbba9b011c149c0d5d1bcdd06b8657daee92a2d13f01b46dd8d485fc9441f0449402ef53ff6da84bcdea03e8c817f7ea96f83461676aa76a8590bb830475cdf26e381b5097fb5f8860084dc54498d71e98c489a3b23b1033d2ccef4c7a6e117179abe7e9b958cb98a8757cded94089e6ad46b34055a62c9d91932d79c60529eda6137ab1d8d266f69f5fc4a277743a1e30e84101f16960daf0fb3bdee4a50daae0ddff5149d82df1d6b126b5cfed7fe50c07153a348575572e1070fce494700f8d7564ae1e8c1a9744740cba64f7fcc4150e5a57fe1f96a7ca47b721821ba12c7c21adf0ac9e30a74b80a51ef27cabf43a061057d88aeddeeabc529d4289ef17b95271c2bf8b2e03cc94dc7596eb97927e4d1368a69d171af2072a5ee1e84fa5295374b87716feb277c49deca1950dc0dbf9f383102e707b52836899247309435b878c8d92e04da2c794cfe383ac841cb3d7bb656804337a2c26c244171b59bdeda6aa4477dd212f326b94bcec79379c0ea4970ecf69135aef0ef423c510b6444e3ffb04bdf3cef62329c538c51a4ac832898372420676b8434532d8d9f5ee7d0920e10e7a6f6e0c91ed5fbe9f19b3f11cd8e161d78ccdc5d9a99af8fd0c1c30e8c82e6755c56a24437a43cdda7a06d99af513558b60ac1d226ccdbe389dcbff89b438ddc56d48640f4645829bc25b99ee7218e38d88afbe59b39f5a97c8188593e24fab19c651e9e216611f88e7c028753ba7cc5d9e822605e9879fa4cb2a4b3652e1ba49de893445b16b7431f92ef840ed15dedbd6d22eab10c3924339cb41f27d799c0898e616eb80e3490086426828dbb5e3ed70d4b2118f52494f81eecefbf645caff2c3b2310563f37cf6af701ba19da08363e093dbd2bf7315ddbaca60e6b670cf4c37adfdf976bb8f34fb1b1670ecc3d43704650e9ed52e8c3283e1dfd2d1116e194649888290177f548ef864b0652cd7c31ebfe1807514f189ff2a0beb61f84974185ea873f15a1d6760238917e98441f65bd8ebb452a672aab8bb0d3d61da9ef9acb707eac445bc1b31a529e3034aaeac1012253b5b5fabf5cf7b86275598e9c7dd96bc1c778e160d48bb453b9debf3dfa3f1e741e7b7978fc2e9ee5b19703f021a8328c1eac02c6bb617b4c7dab624a19cb0c04ef531a2e3cb31c431bd9bf2afa55fadb7ceaaf483f2b113e74788744cb5c4a081028952c45882680e77b3fbc12c607f3ae2e6dfbc3e3e190d6e35da35e51a34198d44affcee645eac968bae786f18f61a5adfb747940190619445d76103a7b4061f2a82908c3d95935aa44523d757a1bd6ee1da75b5689c51595238e12a0fea3a4e9d1649bb5967bfd43cfa3c24617c50257869cbedee0b9e3ddb590c7e6292e0f136f32ca1eee4f084c6e5979ca2ebe0239761a15fb0338ac2944180596c29af36b646603999c37c3bb1e43c6839c2c85830da21248b93a8e2d101acaacef8e9e997591fb6cb761747f2ad71c4af663540febb2ae6a3d262ad0f7ba2c710f9f5a34765086b9886049219c1553d24402db89ebf35446172b3a7884e3dcdf3ffa52bd8b32c21230195ac3f4700eddc522ef55a65bf659a878e4462eda7340a0267cc67c98180170a3648ad4d059ec48316305f4243d5d414ac62a09727ea2ba89e1f7d9d92301e25a8a9447d9e3afa9c2136668d09153d525c3c5c54001d5ed20c3f227b418c1df8993aee37cceeb54c73b281d16581eea3ba0da8f6718a2558d0952cc43d68b2c0c2ca3bd6b11fc0b68651eef8ed6aa39561a206dfb2cf4d6b8c4058376fa1b26003689036d89f900cd01e6605bc7ee4b92ab62d5356e20142ada7fb72e0a3440f000af32c9d480508f4d86d9bbf5ef1be1120fac056aa8945699ef8c3a94e558bf148a2bfb28ebe20de0a2c6cbb03208f0c29e0bc9fbf2a4758069c5c1e79f38f3486734020c47df7902edb1b220462118872ff986fc464e8928a1a17d29bd3404304709c64ff0d00722d841c01a4e2a9f945ffabe8a111d0ce7a25b0fce317ca761d2d66d7a28e8f8f5a55a950551132d17f53e4c03b5d12ce8e0c0f972a15e1063ccfa3adaa346f90bbbc84ab23ac45001188c3904b046a7bbf91b2cca745e20e8920569e9e1adb1bc0695f96dcbed8e2de293775c82292937e54d613fdf6843572cc804e42a81ed6ed5a16b0e661ed4c68cda1c79ad3e4658d6aa8d9bd716ee519bd827f6e3f2f7b1f1395c4b02f9e798beff101272a971140fae1cd831211672c6ea2edc6c7b798b2a249ae452382be3b23a85c664789e6db87b391ac2d7ff53cd16925ba45416e3b1250987a47c5db3b6d8eb0af947742b482c7ec6e761913a16880aabb88bc7c6692961b1625b1f43dd7b2d17b960d6ceaa660326238fd88f011e36aba4abd950ef142df060a0c8e24f6ab013fe654475e41d647ddcfece491391c35318063f1ff46e4d9d5d08f134f5082f0c0988c5d6d691ed71d3221bda1029c463fa98c6a89638711f3ddca86275abeac88a0e44b4e2837a25e910e5209cf21237005a919cc0ee9b4407b8a9fe0fcb79e863626ae762b37e7210b94df42876ce17c94c5fc50a7735dbabb4f7c7bb75e0d635ac222f395ec887801c90a55db43c7fd28241920f2b50644eb2805aa1528e62356653cab86df3ce565dd2790d07ee4b53c23499bf0bb02a3be6ffd26ace344358e911c1378a97b720c090b05b3af0dd0f27fe848beb195ca4cf1dbbe137a7447ccc73f0cdd3a2d919acc6dee126a08897f6dd48d349da916a6ae3b4a98e30f7630b69cdeaab4ff338607af75f25ecacdfc151890420b38f28dfc8922069228aae2de20c6ea22c855d16a65808546ee39830b3ccf4279de7c28d4751a42f943bf278d0457e347489be48363b71e1d33c682b2ee8c4d0001e9737755cc769cbef6415e8c28f041b32983dafd11f964b303abf7ce231e6709fb606d07f1e2c3d2341bfbf615bd14763600bd27c76cd449e976c6c93a52ae4b40eab7a81b417d8ba8c1974c57273725d1905580019d3eed13c2624d696c87f798e958e86a42e73697879a0ec6536b434277f5f84cf7ecdfbc2a7883b783185e91eafa057efb6c7e9c3f8671f1d4bb1ae640bf6773c9060f1f786454e6e453260c0c1bf7ebc7f70eb8accefc4927828d6eae59aaa9fa419d8e07f827616ad59c076eb6f3500bbf43cc9dd5970461c3e9ccb5e862a565263eab2b9388da7c63c2840f54b7bdafcaca156fb47d8f8d809739eeb195dca513fd33e77d257150bba36530fc223f726bb25078eae26e71b38efbffe980d0581fb6eb9c05033aa1ab0a38e79dcfe943cad2be31622cb1f7bcad2ef5f1257362457586ab293f1fda57a42b5d3f9f4bc22e1ca6842a22dd5bef03be8451fd36b28b2ec8e8fa8ce1726a2f2feb9d18ad281f312e3c75adbb34b7bd6b69e52bf77d96b776415b44c48116b8707e1ede52fcac679297008ecc3ab0e5e52c58ee58ddeb38a38f4c9ce3d8b9c0656bad9b7bf3f4d73da32879e942d15ffad2b6c7e104600cda1f18167d59f0a0bcb973dc64eca6047a509881cb34d08e01839369dcd5c7b37e92b564fc1f6c0db889f7d58f82d2e3591da5535283063a9da4770d43fcbd9dedfbea7ea9db723b0384e12c7e11d3e96baaf882aa3b70124b9cb58778cd6dade6aded67f15d28eedf6a2d725f55ab01736a672406341d3473d4ec36b74e1284055f96cace960b16e71e15c626cb4965cae5ca718d72eb3a8e60384b0d323bd37e3e6a15d544cfdc1ecb6479ab434773098d6f15f558c94849127777a0690fa9559afc781df22a291517e5d8886e3aeb7ec5c8d4006e8ef87b40d1e46f5b93f66ac9892132c6aafff6b28b5c716b5e6bdd6bc386f40054c467d717ca579a6b416415106e94529db9e494c328ce6a8e1e1a03f1bb527a3dfa41827dbda34150d322194aa5792e0c70ed09553b9ec9e88ec19303809eead2166906de14ab25130807e6494431221e03427e7c7913f342a4c3c8b3734cbb382fc87ff73d9461137431b750a71d004da612de421f3b0c731f617b985a6c6d80fbadbc03d21c8c86db0c136af3f93705e1424c6e29ff69b3e8f60ab9c713ddbbf47c21b0573a9fd52fdab199f4e2bb0d06aa0debb73e3ec9021f2ba54cdf1c79179fbc9c67fe21f9d966a41c813478d4046d2fb2c5a762f021baf81db0f4152ebead8ebb7057efa29fd55b9ab25ad2a7ae561134fa7f71b39011c402905d3203d6ad274b1b65274001b791f12ae65284239faabf8ddfb87021978bbb33846032e1fdc1f75103784b516faba570e7294747553614e723e7cbf96c89b131169c376d89e30891c0c151b4c32d1efc48c619ad28568fcf05e20ffb1aa238f24a9453e8a99fb064ccc0c31638a325f46cdb66825f68ceaceafb1a1b8c630bdf1641e152edd587c44e722d29d6f6c5bc7e9b792fd850104be8a0d2109a243e7b69539a47346155e79c0f694613ae4802d95a339faf98abe8e8936276bf673a67dc68f697104aea76b5d20a3660ed439de852e68f76c5a62c2842652c533b02789624f328cd68816d55b5cf1490b778610494b48bb6d2ede8d6bcc8c5824a4bade7dd59d0da95a2e14489e45fe7fca9115caeae7fd8cbd9c1288742b73f1799d3dd1f97bab4521119b6680f44642c94db3f5f7f8995cdcab58a1ae5a4270d81ec43c00a57dbc4d6ea83403d2c4f12d4cd0d14ea45952758e06020778aaff2be28764d92c4f0ba84fcc628241c5acb73043e64689e123c46660b8da5579364f32398053d1f2192ecc99445779fafa13efeeabb8e0ae2f4fd3679a7ea09fa49205ad10f41f7735c7e8005f86ef789e07da3e3debf716fc1a1fc395cc8ce2cab9d28cf81bec484610eb54a690b6bcbf00b432614b9e2d529d4607cf452659f798ecfec9eb81cfeda0ee58c0e0c7190ebf3df2a8d2f090138dc4a316454cc49bdeda6cb42834401f43f73759b9d57b0172dea2772a4c194d70aeeeb3928d47116dc7a186517ce30a9bd35c2ae1871eff306351a0850a2b18b8558ec5ca7e36ca7ce065b9d926bf37c30093e2620ba170b3c47230e5a90520c8b3155c2cf1d9fa985ebc6694324291c85145607717d4b3032b00958df2393525fb88f9a40ca5745de99f1f34d91b89c18c611eaec75eb4ad79c7fe04aed3021301360250e12f58cd51d468c6b30ac4b45db60f0df5a1b65cbfb7e90d9726b29355e6580594c1dc1e06d1a9fcdef242eacbb26259d64f229464f02c42258403982e1cf2a274ce20b51289806bed0a63e952a2eca058ccdc685f59afcee8e065a389b44b2ff7de6439253ed775960dbca6e4ff8a3f6253a346e6210507ffd2555d2a5f1cd4f1044973b9ebd7b6eaa2251d85825396e1f871f71b1b11d6be511e0dda577be933bde8877cba42cf681466b2caf1a3fc863de01bfa158ba59c7dd30c68632e3516c1a671dbb29645411894b07889dada163c59e3e4b3f0c7a63bbad003d8c421e5bd1ad528981e53bc87fbdad2c4b393ea85b726187a8254880e563cbf2b2f34f0899910f3a59a61c75ce1f4286ca79a773f7f7b26b11b78378fee9f157d3cecdc6c1bdd7a432506ddcf50baeafed5c11468679d50646b6fa4652548f16ebe8e65cbb3f7edf2b997b52510cb508d99175cea5474f6c6860eeead9a109f8c38a588df8477918936f711cf914b4ded7d56cbe50d6265a15225399943d453ab174ad5e7895093a804c9b3fb1965aedeebcf20405dead8600fb5a136c58d51457ac4c54458f77d09869b3c6dce12d6ccc0681af1b6e56f7eb6d24385539e702959bcef0410ff130b222ce7412e1f9f094677c48f02f6c612bddf9a7ff8d1c9f52debd07e2d5f35bb74a36cae04172ee0383aa34c9c241706ba4573636b359311bd48cfe91bce14b1761c868d4cf31ab0729fe251ad3d29d4381bbd73721e9ce8f3f7a56915fab1dbacf422db003bbcf053667017f0dbcc842568a313b23a89a6d9f5287c7b2df7cf263d41b85d385d6bd5c6ae43daaaa717955b108e20d877a1f0b678f23d561767fe523a95755874a105a64e30535e95b57151156d93e3eb295529555e227ddc830ef7b88ef4aea442c96ca33491a3a7f1e82c50bd497a17c015036cfd0fa77b248698e81b7ecc9c4f25f8e2755e9185151e27579c53ca4ea8a4073114dfdfe966e4c3551c144e5d0f1d75ac000bbedc1878fa16cbc4e97d9d44630f17bcb93960ae282a75d9cbc6dff7d385d6c6fe61339b47bc0527e542075dac5970278177384596773adbae4bad5c18917f51bdca01859727bb0bab587b6d1d1749659dc6bd7367866c809d1db83ae189a02e4ed3bb39baef230026181021c034238c6153b49bb26e6e3886d5015a474b8ae9a137578ab3f2d88f247bf4eecaaa83f2cbe4824634e40b6866fc0d14aa3c535266f6a92bf5cfa3892244f610cb82c687d3368664492e47f94cb1441c9b02e30753b048c3fedad1d91b32efbb6603c298be58e1e8cb434dda034672e9ffa7a8518fd440fdd09f4bd48cced3aaa477cafed391efb9f0c937b12795f359a2a9e3678c49e5bc6875fd431836b6e0a17be92c1f646789baf2bb3ab46d1e509bdf6296399fb36666c4dbbb34219f3aabe340a9314068e72bff2d8b829ac13531c70c017933f77b34304c04ec200acb029384fa33125114a2058890f3d66643ea34db75999f5a80807f201d1abe7506bef64755024df5ec6c94fd3e4a9ac83690c8a339b7e505ddba8013b523fb83e239d72e4e78b98bdda9137ee85057c7cca6efda4da17cbf39263277e88303a5e1292167e82853173b7afad815cf7f9f905c5511dd903666c058c5d0732d4bce41db3552a17b231c5aa5e96d9ae5aa67c220ff9bfe1f315ebda79d06e29b6105a559ad537c3cdc68d40cc503094657cf54669e4f6ddf0b24ef074be1f2be573529b1666494d95b889e0f0bfc43d7a0707c5f249ce6e6598616b0087881b41b3b520626c4e61ed1a6a9cfae909d72268fba7a548244c2974552100a536516bb8b3ec594a1df80c76944471e8b57e2941c534d57168186aa6b08eb837b7f95cbec3074a7d4ae38554705dd61e9d67e5a0340fa89b1e65653f09967e1d6c806b7e64a20f2c7e95af5d61ceb475b4b099e0ee56934bbf08c1219bf0d23b14330fb288bccb55af1541dbbe84c47e39e5802d80274dfdad1704d4b3290326bfffe107c9e6cae9ebaaf4006545b2d6e33c3de66a3094f40c05aab7cb6581eb64758c884537e7124aab0b9c0a86fe937122e61afee47aa24e3dfe0fd596242941fd9410dbdce6c885552a48ea98a2e082ce1495729a7071df98066da54a2ab2934db42ba37cb083a99d7083465085a8cbe46f69dfe68440c38cb57a0f1f86b6312aee545816f57fa4ba3a3994d794d82de72dd4cd43aa8b7d8ca3e1ffd151c6bf053b0b7c6bcf156b9cca5699329bd1b37155533e18e647c6df5963ccd0cf3fcd0a7fd669df504bc6cd26863a162cb1fc20877e960b58ba1ec29860b8c731ad5e319fddf21e0db162561afa8cd5c0630f746aa95f412c4b81f1e410c93c2c954af62bab1b67085dd76f205b55829caa99a23711388c84ded0ff575f68e786257a2fefca7dfeb67d8c552eac0a4814cc175085b932a55bb478ba01c6b6091ff65c0b5c43fae01d175311fca76c415496fd206d35a2fdae8f6747b62fe66704f65820178a6a16c0a6df18668a4d9b8d5505dcc63d006d3e3916e7c4c35c860da9e553f7c56461e0318cee285d346329b7e2ee9515f35b8c96ea16b733e4ec1be8b48f6dff080612764516161bc156a6672e92e3360681b38fd99a3785997e7dce0db57ab83dd84694f8dd5409700306fae3d4669eab2c4b0ec21c6c06ecbfd0f573aed8a93dec1110cd42c856e7b053ffef7a669093a23cb8f748aa9befb850fa39ff36c859fd0a8d793b6c0d76719caaad0d9b77a7992b598ca8814e3df9733e3060a7b43958726f05b2b3c757efdd6301de0507b2f06de354ecb4e6f9087f58162eeabf2440291ec298c27ad4498fd19f458056affa5139ad1cf69da7f4f7b99ced446fbedda8f4cf91dd0e08dcea25740a6665cb81b51838017e66f862fb460e1ffb9c85a0b0b73815287cef3678141d4faa18ed07339c21923ee5c5b940989cf8d46800de96f1321575eb15d14cf6bcc10e87e3f5f56b05b0a28bea0566add61b301f3ea3fa6cab705e2a82b728830ca1cf6c60f0e36fd665d0b72dc93bf2ab6dd9636734ec76f8efa50cfde19aaeadbc86346b5d0f6d2770d5814f397a8149f39e573f99bcf62abda4790cdd64bf4e9a99040eae26c8f24c29714b4427ae9a0b77f422d71df79d7b92910d50f6b77fe2eb2de5c9e6eaa2581197b58187cb746603d3861af78b8c6089c46337f1be88a7be685b3014c82aeef24b41ed82cabc08a2cafcd09c8add0ba27ce2d5418b8b550c78c64760e2fb40ee9720ab2d7cb12a11f81c712b9defa65981220d59eada7e89cec292f4200653d226e33e4956c409a9dc83f9eb122a14086ae6f47d2b820268d05eee4ff6eba09daff17494184938a27c9288e998c69cf79a67aaa4d2324284cd26b66a78b0aa093d7b43d225aec3e97e29234d96835ee4baf42750e0780c70164ab65daf590be0e0784862e49d6dd98b83c4f254ce7ea52d28627e180e1b47928942ab63dd5439ef61bd67cf2df26d8bd8c46a31fdde556bfb885d5fdcf88d0e837dc1bcbf0d767839a4d0c016186fb4bf628d2cba7eb2f44cf3aede61a0afc348abfa32160848c86308faf1f701b76fe77a6d1c0a1a87aed8cdbd9df4d051d9963a41eeb079d35ea558bce645dafb7e98bf4dd2970037477dc6ba7423ec85254c4b06583746b5f32d147c3d2f936928a8af3f133195f1f1590c374d7f4749047baffe2e4104d0328987963abee0d8d9a3e45aa634e4be5b6954fee0b3b2a0b60d3d941a42a0cfb50875e800b06e21e64d9dc52ecb4701d06b8928d5a006158973b116bbcfb1b89afb13ad5e1ea2128edf9680d1e371ef20240b8a2aa6386090f0a8db9b28aa273ad17da0f6b96df39b463ddcdaed5ddd58f33e2cee07e03dc200be8be031356fc0250768261dad2193db68d9e8b96b577132027dd1b03de30ce7d6aab4583b2543318dc9f40efaf82a0a9d13e91a38f4ff56ba9fbef933c97bfc283782ec9d599b1983ef62e1167221c4793abe7acc37105eec6b60827b483aa0bb7b3cf921be9dd1b07bcec7e82c7787b48168bb5feb7b864ab88be7ed7cf80edf94a84bd9abe65495a96debd86487ae6b9eaa65ca49fa3291d960ff055ef922be1ba2f11228785431153518bbbccfee3cfb5b4cb8c6099f7f991ee39adb64e7564be378e6869efb2a4834efe3be4e571ffc57288ff83c0ac3d0e4579a4cea89b7897d761244e8c042ce25e10b44fb9fc6955b550bb0113e3ee4dcb2802f9b073832a9b7432a1ba45f90e92258ac20c470cb9eb419845053af789b3323ee91a0282b0d4975b42156e4f359fcb41a8e2345ab19d48ec51308da82f8dbe2371b49a41a8d0b2be4b58abddbbc8758da959c6a673f752d7646b39394e02943d63b68b9a92e64c90944d2157e8306607e0c9eed18fbff764c4be306a266488507e3335962b24f735a4b77d444b9335a74a05625f99a654906a75a157809ea3b9451322702810e72be2cabcab7cc7ee753f697a93002a32369650fc22b398fcd81a6b521342df7c2b148ffa9f05d5f4a080f281b7937e1e36c190fa2875c099bd684e958f80af542d193e92cfefabcbb5a60ed15f336d9877dddab08bc47dbb1f05f31bdc56e14a90ab50c50636d91b3a43f58fd00aaebabc5deed10d664d70274d4f6fa3239c655fc69205a82dda89ef4069adffc3c94077a668120828fd7d06177280a31042ee5d77e0ff8c891dd91ead4d00f900b348ce6e7c087524e60d4042d71c36dd102e0d4fbfcb7fb1461af81a3a4958d4c42f958d31ecc099e899d0f15a249d09265469ea7a7c1765c9dad3f8ae29f6b47816dfb69c16134a6015f382e25bb5fc4cf025f4fb8f1213f3708541f6c173159522773cbf99eb9915392359060e065f847509ce764b92a26b1c8af19026ade4b0920adfd388853ed89ece82cab8cee6098a15e39ef1d8225a2c2ec9896c8b1de55aec635632b880c1262f9e7889ee8c4ee13a0ca0f08325bce5675981096f079c3d60e47e2ded7ef4c779f198ac4a9cfa637bcf93ed68515cd57a397f5978e600322278d921c3f23aab6f38d56a9f45da9afc57dec76b51f4710a2815fe3287e73e35acbb6f22906d1a76d6b4cde84cdbb22c20b660af0ff1678e1278e8eb1288c68c965885f7826ee73542cc02dfb3ac0bce3c50d57cbaed97501938d371330897b05ecac5b6eff3b90dab873c77bd95a8c5cdeb830a444f42b70dec92db5931d3ce61ce9bca4634dcc32c5b04ccb39c84e24812138cdb6e9a9fe16e857be3d52e5b9501fda337c553e2fe39af6dadb083afc17837150df4ad12bab68fa891bc8a5da1c8c3fe3e2a68c226de44d07150fb79a12b00879a1a5843249e4b241fc39a2b4f1de7a75e3467b261f5f8cd8d76792844438e50de3b4bd2f4ece2e2545ca7f013ec0b807aacba204f3e31dabf2ac89c6f101627ab844ccadd379c4d260e235a2238fd828074879ec06a3e49ecba686525111af03cb6fb9a97a8a983a04aa168478ff25cb74f5a57bc3c9b287ce04047e4bcd8fd38097147dd0b0dd0d9c4f79e8f4b6fd68ab8e4ef0a5d2fff1a26c9360f876de35694c135e96c7a0c49b5c17c74e87403666c2f3f0d6388feaa9f180b1efbcaf91a30d73444b138d188324080ce9ddef05dddbce1841fd141dc6863d7e4f3aa9a464ac145f4443c77beb82be33907cd94bba966eb94afe5bf124621f18849f3d6cec6e725e0b5d302e4ba601b7de412da6b151c8b7245f12e99ffde397f6bef982feedef03102cbdbcee81480a3bd6eb2bee4ab92cff8d204aa4f258849c47e44844411d915724f059af35aa091c8eedc969ed4b0e0e9e7b520258c60abae44e182e3c7f280656d6ca1329f3eef7181431c9be5276b1060cba8dbd30efd6230c3a946bec5e8e08f6d65a0aa3bf7fe0fc9b0e3b9457d5be5ca40257fff02c6ee114fdbfe5d2f86e9ac7c686690a23124b052b5dff88d1c8dac9db5afeddefa205c188cfffe7d3a3d7375b3c0dc831227395d22d1bc3ba28da85b14e0c5e64ecf590d5c7584b158bde9969beb1b5c44b78de679826b258ff7ec947cb5a661bbac5cfd109b2d906823502b7455efd992b16c011a7d50952e224f71198e87b346b1e2f51018c544fda58a8653a4c3dfd860a3f3ea552b2c94c7fc93fe9aeccc08544a6e8126108ee08b86ff4f8f1dc3c2eca420a5930216087b2f5a1f4d4d292da7f1d9ed8a79822902d89386766a69a8018a1c7ec4a9d1f8410b0de8089678e31a69439b2c3ed12161ef5b556ba40598d6b625c41b884a1eeae26cc1d77b95f49930556f30431c49a4eb5622ecfeeeccff07a454d2333474360a972616d2a1388eaa1ca4b87d38dd2f8e4cb8af25d3aefd84e4f41229868f11114405ecc976b29f3e696e18fa373510610c5af04c22060772883e947ed475aa663ffe69ddfd87e85dcebc722171852329697437fb0e1dd5fc8d84ce2eb321a1b559dbd92962af041c481393ebe78485a23b9d42e57586ebd81c80e619796d728c5b42e11cfec939f6a42f3c604543c4602b9c63755d905676789ca72510a48dd10422edcbf2d67a501bb98b76446f6324b39eb72504031ba1eeb576d4d67db0941fbc724acb63bf61a98f392e44e737f1e6a335bd3c6e98bb7d5c902b364cbf43da0fbc2bc8e155a793e3647054eab0cb12cab69bbb7b88056a652ea54c2ba60013a222494002e25e497d0953913987114a80f81a36246ff45211628686d481be07bb51a6b30ea4488e485ee9eb2806ab6ee6a927d2c867e6ad29951fe149e5a18f3412a98487eb24a90ad0ba60c3c337cb1f892a04e15cc5f924906ad722d086b5c41ebd219df576c12f4a5c4b1b7a4ca2ea3e050b96f5bfeb4eee87b8fdf5f02c117eea4e23575722cb5cccdca81eae6bdfada7ce4fe84f7f60fb168c0fb693c4842cbb0cb27d3a3ea48a0ca40cc861a09bab8f1afd049c72a755a609d2d079a011a70ce6f8af3d08f7dd2fd15eac1a346f27159ca7ebb1f0cf436f1a6caeee8403a5c17b24615d48cf561e3183fe918c7cc71fda9ad27e4cd36a51e2fef056ba3b0f9ccbd37bed6327c4a7638ae67e42f9d4b6d9118777348cb93a3f3acfe7f38394f6c2974411ef5c266664569b3583ee886fbf421bda41d66b7917d6edc446f7629c81e6200f329e86147c25532d216f23d007e8c60664397f968cc4401e66c9ff4df5de9fe1adf2f18bb265051cabe09c9d1c4cf16ef18f1b8d6613c070082190ec71d2ac0e63fa96c82cf2bff090f6e89860c834069bdc77276d1c8722050c5b5ae04475911be8418d89a1956b3b5c031d423f4505a18fcf17f3cc79aca87c5b9f94cf50c444b82303848a41232f714e3b39b89726a46991bdc9aac243777e0be95a96ce2580ab5d03f83f4745471085c3853afbc9bdad5a053a24cbdc05e425946bdaacb7653825418f8f54a85923879ff6d3bc35dccc1d12cb793844f57e2f60d88ba626eafc14069967f7bcafca5651a1b9f180b002a07ffca16012628aedc1d2b3086d4a03b89979c0f4e68ce666d897cfca6c3518d76ca8aa135aa32c6481876dfdcabfb49812664a13a95b94e267b4235619b94e7ed9a96df045d1354ea296aea3b146f26b3159d35c2ef64862ada3a662c564fd3076e32701fc65e96d65ebf1fd82bb013397b4d592501475da8d296a60403454a895b2c5834e696f9bec988a7450bef9ffdf06873532ca1d03e4c0d53d2289ed6d272cd6bebe784a2071714462e6e5acbddc9c37057edfa3fae315267b45129406436957f118fef670c0f98c6aa7af2a80634f2eab5743109c36eccb042d5d82c83e7770b8dfcd85bdbdc4a74ad212df61172e400fe92e8ba7c0d1900b20eb153c26786dcecaec98814d14ed83bca696954d9b22ca7f83a0f45077385a9b4a94cc3da8bc6727e27f1216ef1b72c47acc8c761bff02cb3697db7a82c314f01d349f0f6c0b160834fc7b5aa18add288e5b57f5d6c06535891909c54265713f1607ad292c180fa6e803fcd548e37a11f2c46f8375ff0adb1fa09d5492167ae8f8bd0744c65c3cf9d3762870c0fbaa40e5a4a0ab809addc832417cff17fc4548cbd530104e99a2eafe1ea186a759817b8f4b0914ddb9b18b6bf6628c871a033d35dcbc3fff4fb225704769523045733888581b6addef2822c3e08dd92828348a33691db9e82ab17553231a399354eca7bb69cad834afdf27e0171a3b7185dee6155f0c7bbf00616f6684c366b60bdded9af2de9c4918e99a613a11d7fc0a82802786e3f8e991e3f91ae2c1581d149fd5a1b4324bb4bbe2ddcb7605cc75720e96bb164d4e8b67998048b36d41a2866a9ab6b2ca70ff1dc2db5dff82e8ba2138bbbbb099235a8ddd860fb3c312a993b5b686239e756f5ddc7621349956980ace09ce40d0f3ed8b7e9b79137bc3caba05141867cbe1d8c3e979d1aae2b8cb627b6fe8d358e73b964715366b0a8a2e849019af68d4cf154ca69cf66e86979cddec863401dfdf7ed6d80ed6ebe1f8ff6a5ace1fc5a0e067c87fea6dc0a525f68b71a6eecc1d9b763767deef6daf08eeb840e7ccfd5ae36214ae82769b0c66451b6062dfb31c39d41ed564fa0fe36de1a9b90ced0076a6d399978e336a74e791563d0e8317ddc4a476f8ff8a6afc690af9746274495715abeece54e688c2f86713bc37e7f3578f92c0300f67fb7c2d8720824288ec890de090132715d33ca4a3f4a3727b060fd1c51502d5a445f8b1debee95ce838e53a127738b523ae1a8f4a38260d8a373f74937b4b9954d83fe76da4b3f62f73720243f70c74e888abe8f07c6c968f15b577be5cb3e0eeed272cba3884a7e518874cf278f35d7e746577140d426c31e708b2fb85da3ad51fdfcced7af1fe6921e11506ad2983c7e19d802f7cf5ae6828a0afa8142fba21ec76b51975c2205c151258b1b4d06e8bfc8ee07a0756566699a2d6024d47fb60353524ea0ed83c64230745eb013494aecb43fccf371ec72b18b593808c42f915581652ca9ab470d374fb366d246f3dfce2ba2d66c8de91908f5062aefd9e1eb7f6f830cbc5be4868ebc06677c2dfd64ff9233c6ccee45efd06f8c235e8869d8596c4cb87d054a046fae062fb4c2541bac5d57d219322d8d11f358b1af5f3e4b21a6ad426081bc2acb95c4dbf7a4a53d754cfb57413147ef31f5a6f522b43f42c6027e3d20c77b2dd996077cadcb157fb549f221009db756672550d819f219fbe2aab416c2ead9fb3c5977e3b798db451ed7dabcd0dc1dad48dbcaf2e2a709f781065145c5d890a6a43f1ce270ee84ea00d7a7be195eb34cf12a9f34295cc270dae35f9d9ef7e713383179c2fbb5cd9854ba81f4db37ea1cbd61082972c2d91901438b4edeceee7ec2e05bc1e0b150cf919808f9952438da86bfe1c6891df6ac4ecda79332f261d6b9ffef9ede13cb923b01fa580f59d69c213f9bb7c517053a6d3a88381dcc979a995e5aaabdbea4a1b00638ada4e6fa25214cfce9e8a8a316340f0a4e39f31649869f65eddc6884b490f9254dde273f4703b94d0e4370011a1ef0f05aa00bcf713561f03530ffaf835f42bb12f958fd5b0941b0978c2e0c47661f9f0a2e05e363bf2ab8c88cc695453b4efe26ef9af1db84eb593859218278c125a6e7b7673637451734a5134c53e8e8d1b71f8698700dcf02cfc208f03ee88469fb48e9323620624662b0de0f09474a6c36d15ae0851c7cdce5ceccab1ba327d738457af1a705f2c7f12ec922350f90052c92e85b299e81fddb4eb893b209f3ee294bcbd05c398081237a3fa13618fe8bc78c5b04e4eac3cf76d7653b06b1df2bc87dc038a000d302f0a220e3ef727957c23de67f3814e02841dd20ff4adb61a48cc9a360b6602429a2be0b4767740361c689ddec5b96865f2ea4b7f826af54d465cd9624ddefd32318f7767f2f9483cf668d0c04f1571a5072b0626c5185f1f7651d775ffb5319b7e854a96f1b525e7648baef4b02c2faf6f3cf0eb983e00560b7c3d0278e821bf964eb14528960b9761d76b2435bc4573490649279940aac4618e819c32f2389f5a8a5576e7b8a872b6e2fe5bc7be837bbf84cf828fabdb4380646b9d88b8164f4041aba9fde92c04195d58c860f4a635b2c1875f610a4b15f6c836d49e016e266c4d9071b424ce06691b01fb5baa5c74441b26f10d122cf63db58309109e67c5edad27d4373b37e76f26db575e37c23545de9fd05fc529cdb074a3209d61222ad5b7779f69fc64bd537c4b580902fffe92b4baf7542cae6017760ddf2ba1c65855aa8069764925d483138197fce2f5de1b8bd0b167778cee5964f0415798e5a8296b001102d47de7938b319e93d0ed768b486785cb440321c20f93a92493e3538d2d5c2ae50f745603bbde528fa7f4f86e38e78dae7cdec6773ae508dc38b39a00a11118ff3ba454cf347dc3389604d6c11055cbb60db95b93873408fcc85835e5d9c31e511e45609d18a0e5c0cd4b2e2c60ae6ced90f37231e478b237403028fd7d59bcec311412f77d9b0440daf11010f71b34f58722435b6bdf3060cd5b8863e7cd6f03c867861929d092dded856ecb914000aafa431f4a08dcb820cc417c1c17f32c1b04afc54a23681b4ab72cefeb49c865ee7e7498d8940fe8edfcd817ae97872cfb5051f99f8388908f0998eeb9cbe83550d1824d18a99f9cac9e0cce38d51f1b0daa053bc16e336ede3babb7b2c1c5b63403bfb08fbfef4835efa73cd12825c3efa37ce179f1a3d5fa57c0fc1310a66a6883a7002cd2f960173b5ba6ed3949baa91dbcfac12f18d3b3bdf99167d9488b38590fb5008c2984a3420ce7fa601870e713c126c57bb01b5b28af57bca132db68e51ceef598aaff8f18eff7c52e670d6b8c8a4e8ace13f4a0b112df7b0559422b17ce983c515a1112d131a933f15535ed278a8150802fd9701b172402cb77caf436db37e8ffc28403c6aa12971949c46cbf8677415b9871b2a327955ee1d79f18d04216a1aef92001c66a93708fc2d4f6ba63a41e42a6a591183ac5fe29f628c2b72657c2a5f4fd3773b3290eced35f773b40f936519c83fbf081b3d2e517a48b4050280d0790db40af6e3f703d81e7d6a063958fe1ce7825695ca28d1993ce925180bcfcc3b14442f44ed0ba21276d3ddccb0d3b2577718d29f9e01b418600bfe07864dd80419baeacef3d13331a07a4276bc0928c90ff0362b55db6c4c914b7486036e222c32bfef6ac0c695ca3b07a947d287e97f9f3a327757ab62e8bc69c40152a6e6001df2a033aa2fde86e2f2406076fd1077dae5051b9b45083d7c4f55afad0efc42f3c3942cbc8085ea3bf291d576d88aeff6c3aa39198017853ea04969f4a48ad291df8a4c5b12397d3b95e30b0fbd9f67d0baeea4249ce06b73589774a14a4f76faeec955c0a6df403341ba53b0841676857588c8eb0ae00e94c2133cdd29fa37650f4e70cec707a9f179b2e048ffe4076e169fcef0491cd4d38ae01b864a3f7b579d376b9e4f96eaede271bbdd51e3857df3f37450ee7e839da8409ede78fd7fbebe9087f8331f7eab42eda32cbd3c902c299466aa9ab08f089e0cbe0f1e840f118a8693f7702c79209cf5fdb54b728ce17bc680dc3ea3990c201de5e45c8503733ee09b06b2832f5fd9c4a63b84bbcc8d6d93af0c803ba3aa6273a70c5f790bc88d42125d0a4d5fdb895d81b0035377d2adc6e531543be35008c70740e03cec0d63df452e4356b2e5373679e1c682db4ea8590a679d0d5675f5b25f06cccee65bbe748f4fb97ab98614aed8f8f46a348f2768e1252e2bbc8027ce73cfba502e60e20bc5ea30586399791b019e6136e974477316ca2c04e7eb1737c7b43156c9b9ca791105adf3b4da929490ffe5473b54ee2feb8198390dc6632353f9945f74fdaf95844befb93841c31afca86969427eb3b4dc1cb4bbda636feba9023e663ea9cc96a7e3ecc67567f474c52f9884686b68c854db28e6375ed873d1e5e173ab477503e60121245ba6a84cf74b9629d0e247db627aa6a1e1be6cb67dfb1768b07b749d145cda3ea4026f9f4d5c91342d17ea541a80f5fd94d765cbafe47e1e3ad611e9bfc31eed619735b178bb260769fb33d709b221caa8698753754b67c1062cbbd7902c097eb820bd0b2971164acae0c34e9727052858e07d3ee8aa9c8676355a81f0a3baecf991e0654c3530d299460ffc25beedbb836160851d747bbbb0f919edbbbb62e9383c4f0b35e486a0b13e17c316c03c663ee7066f35b341ee1f136ade7ed43c6232101f94c6719a07bf8b6b38f3178359354841724a715b9af885805969b980a44ef3af39745e687282d8b74b73e078e3ed8b469fdb183f7559e6432376ab06f9b12e82f01233437a07d7d98fc62be9422813b05d6d37caf6accd21306d51df19d62cf1bfc3a59fcafec800547dc46a08a9782e5d8bc01a7b3299445c3a1f614dabc547fbf422e473e5b08ad737d037b446cd68bb3fe03fee7bc57cab406bf8169067264aee26c1c6d3dfca9d929a47fb84ec7b01a122b4bdebe2e1c745aac4590b31ce7d77c9067ada5aa2776aed83b774fdad93235594632aefcf174ab5577d988413bbd14e9e68c3388b10f0d6b1b593fecd45049a40e9d81e2125dd674333e5229821b6783b2216bc58ccbde25538d21725d657199d02fc2da02530ee16819d692cb5393044ff372c17aed4db6508949100fa707deb89c0da3386cbb24c226664ce8994d14301286979372515b22ae93008bb23c77243cdf5ff0114e74e33f83f06e349e50ca45eab6e7420b2c7a62e8760d46b65c27d65177a7ab4bc32ab2461560493b2484946e35f6301738a2a57ce6f48a144486fc9d8e5259a572dd2c40eaa2b061992606d26ee90bd3faec8430d64a33fe5c3a9f726f262a69fb4a30c6a2260980bcbb03b9445a37bdf8bdd252630a4a20a115185dfc9ea9cde08fa3723b6cf6ba119ddda4147855cef346bc35ef38997027e1f28deff88b8961570fe925b18037a7a6e2d1e56b162368b09044645b094881e205fb77861e981d2d1160f4b9ed16346639ac37d28e49e705c90304212f58488b50b4110525226a67590713c044df86f2a0ed00cc1cfa2c893fafea7234cc772fef5fdc95cf14b79b06b4596dc40d6f4320d381bc1eeb1c8c31dff04d4228388e0fffece393e7f49f9ea5ba2305d13900b6216c7e79f0def36c55eecc9faedbd028919d424565a891ff4a39351fdfd75d8098898b56644bb7b715957f2d522000a0104fe60202e70eaee527e6c7eb1ee01ea41f304e537007c938909487ea3d9ef50208bea481e7d032482b711b5adf9b0c5aabd19bfdfb2b9ea65f45673478a16d8a7beb066d75bdbc5a6f201edd44bfed3b4089f814f2a6cc20edbabba7cf3cd2bcc1a6e11aeed2ac0a29ebd196dd5a35f52178e158a7028077d745cc85fa6fbdefcafbb4c25201a99cd9e959a348796ced566b21f2cf6407ba213b2842d54522465929058d01e5e88915867472c2846abb9ab2c24c52bef89d4ebc5059a632ca17012e6a1b089e4741febbe4141fa9f6b6b8c937370fd9cd9ffb8060b35e1da1e1851b13ac7074c68d62e88c034f083c98dcda90e7d001f28f2e2ed033f609563791ca7f456468480d100aff61a61cac9daa861566d8453993abed3ca0122b89d48528540659c6dd1646be03aeac66ee20ca91f3b29bc5dd8618469102582f9a326179c096dd18f62a10d7f90dd0c9ef14fe745e01f5ea40096f648f7d753e2da1462b11badc781e8ea02b1f9d138a636ab83c78e3689f9adad53c4aae841a0749de21344542878cba8b690b409ab86f37bf2425aeb8e6f89dffa973ad6031fb07a012e153ccac0da38b0ee742006420d3b7b04e4363683a4907f75bb77f2115582bc479e5547bc65c2256aa2ae69ddea72fa1bd84496897d0de540a85c075a688fd279f78e39ff8352c514634eef91009e5d5610b033cd794c98dcddc7395ed432862e807d00c23cdf08c14eb566bc34529bcd2fb029e8a1768fd7115a98b07d8fa9ba726bcfb0eb3fb1a8dcfab703f5aa4c5f5e12dc10827e9c32c37e32527e322308c296854e8e78dd1a81729ede3be4116eb4af18accc44f0686e4f89db0d6e9aa37143b6fd5baa71bcfa5da77ced9402007c0c637331c9c9096c5432ff1bfe02123cb6f619843ee4f1a0d04828a4850016f5fe3aa86a9b1cd91dfc70f8a8bb4916d6c1917d3d6f1faeee3b94a0e72e6073121ea5cd106b8790d67b943595ff52fef5ce8cc38f3b099e5fbc89db6bf7c4a78b7de4764db0c9fb19e78f0904db6862bbfb1bdb52a3e02c334995aae741ea6ce41695bb01c85205bd62701529c8f90f05dbf6d5fa8bae3160fb3dc800e9206752db004940c5edee54fa301cd268022aca36a517a9d0cba9b75b3e693d100510ce7f27722f6c9b13c707898a9de1786b85e62b07d7e023a4edcb993373e343216db7a0ef9aee3a94a1f1b8631c33a480a0e992a6593b61475d54f57b8c1f2fd707e93b3c03f7a3ebd25273e5cd9f3f771f35f8fd9f00f91acf62e72472b200d1995dd6183aaa9b1b1471cc590f52dce29951a7e66cbb0c27e52fffd2e834ad5cfe255e2ff14df9f9c33a0db0b693a981aff8320cfeb2ba56994a5d91e6ec431e3a5471b1bc20ceb980d5bea95aeb1af00010749eea5742e08d8c859e4b90df35f80ba45331a2c23198b8d80ba7d77d78d2a572e1a7b35224f0d5638cec2b75c837da476698f4b6a8012b3dab1daa00d734f790667f0e257ec4a00d65ff588b029e3f476788d90ec6c5a2ab06d7284bba6582cbc274f309f2b8fc8cf74678eedadb1b9a0bff4b492699aee9fe713b1ce09a6b8ada708c00b8739be9dead1ec48313f047622adf4e4542700c044daa75be56b21adae0adf7fb725608fcf109ca30e1adba6ed476a8dc591a25ba22c1224c1c05eb41dd02882d852910eb1a526441c1f57de6d72509a3863bb2f88c857c05e437d97424e3907525766fcfe5ba69fa00511addaaed157ac6af74a99cc5ab7c29e0b74521ab88dc9076e7cf5e138541e244b03348e5ece06f72a422d8519f0435bae5781378eb9f2739a2ded1c44108f611163d19b027b3218c93303803aa023cd457deae7e18e5cba907632e201e67f63f571980d664c0b580a6ebf643f54c2a2aec798ce2db48b9bd0cb926c73683905fb4b82cfbd56f1f4df1f41764852bb6840a41173c920ecb7ddaac79687f42a315af70b7731eb47d870492f8fa1ea1f5e841825e532749b249e8f9a77254a9808f76edd7a79aba1308a842367a4e48f47b6103b7e0ae2a7655fd3071625559291083324ffe7b69a83069c3c98ba10c2267333474e4e1f103eb6cadf0b814b18d64a61fd724b5848926f69354ccd1f83fa686be32d5f8a5812eac3c51f2b8ae62133be4ab52b545a1ff75035c09b83156139527f560aadff8507297c526458f83acd86f1e737ffe5915aab57f83580d01d261142f307ca913a6f307de951f423314456521f333a71522deb04f79c27e045a4fd9c8b5fd6745507af94ac44ba4e4e8e084f70c93ca4a844a398ec32f22f470e3ff75f43fd53969f55cdecf5f98b51cfb3f06af2ecb06cc42d1380f1c8cdf14bac368a790b0c36c6028cf6480b5d3cb805a1cb786ff6c9ebda3188e087d63e3d55b4ab20e3852860001172eaf1520b7137444d45f169e8a27512596a872ed5f4295acea5ec1836eb8a33ff08fac27297e69ce13f33db1b9f84e4387dc18b4a865363d4aee46a72b843682cae0c817d29c61c374b66e75ca6ffbec1d8726ed15b5f4da4b73d9a826dbb35fd01dca7bb110444ff0f447130787dcd13dacd2cd773abb2188b55e07070b260a239fda747826c17a985dc2ed41810030009c71d82ba807743f7c3409f2cbcc0b1a6d5188362adfd034673405e3b1b31f2fc488b8455004f8c60eb7dccc3cef2eff571cfb4b59453ae1236cf1e8fa25855a1d1fec5932d3335134f44f706d45bfc8b11a639b747faf574ea45937140619695e1bf3f106336f82c9e0268bca9d200391320e4df48355cc6c114994d87a5d378580532f6c1720cf927f2d7ab6dcdf76406d7a79bfee55b151e3445b69a634f4c2672378bcbed06859ca7ae7db8459c9b9abbb49632f4254275a0f3ad7b8c8588a65278b21d9ab878cda2149c1ea2c911384ce9273659d7f02111fbd19fe024eae19af2eb5290822a5b13fb295705a319f2f941650b28c803d0c4e3e6ca148918a9ac7bbc6fdcda94697b352447e77e0dcf2eed6c3f96391953d8971b7f6974dbc8b7d2581e7d83d8a7559814d8d1d8607f13f1825ffb55f80fda9f7e669156c0476d58805abeb31abf20f303a31b006872508983c09643ccaf6f0a44da70e42265cb481107472f44947f11840452a300b33502acc1545cf65b1cfe33b8209147fb1ff1621691bbb506fe483cba515416d05e03990b6a87c4a69666cbccff65b05bebb2ce02ea179f9b11093448191afb064054c3472af7661dbd4081ebf60f824f34edd01cd2fd6df6f9a44bb39520431bea299b39bd805539e6d25b1fd86aca52436d962bfd14c63290b2701150bb92d61f854794bdfbc22e307aa2ac62d890fbf3a2f4e98dfc2910c711b27e3fab9c038793bff79e71986d224d5961ad4c2690282b80953e5124ee8a57967848f06f006f09b4e7c95f7451dfad25c07069bf99cfe281e87a779c54edb57598c8d5c11f117d68bd0b81794c097dba3e89be477b40f97b36f50f87ecb321e22ae378964a8dca776f636a971bf3c52f277bddff054bce0e869c6f33a2e86761d80dacde7de66f0fc3b82162c8bf0085de788124836f320239883a2f99273b004b7e5119de4193f91d6c88db42ff6479234bac3b69575ef0b9ab348fef0b82195079b7b6728efece403e21c828097b716a62583dc484fbf80ec25d3b07a2cb420b928fd1443d4ac22af35f22e421682d5cc8bb80968a193624ab84fd06653a73226ac79e84aec15e4cbcde579eba70661093d298493c9463796892a48f961bcd7ae781a87e0e4b7230163fe94c88d820eeac7414dcdec2eb570d7fc23c848ade3bb5dd90c4fbed7ce72da93e4e3f90f23e7dd44f3c1fc62b6e66774b621d3ad57906bfe8a0140556d3bcc5463301697e22ea1e63713744b949be52cf465699229b8231216c7898dd2cfd7aecff68803d504a0653848be479334120a4fca37e67fa12326897b06084c302ff9a8b785356b8dd84d264f6a8970aba60fbadca384486c1dce570225528de0184e472798d51586dd9dc6f7a3b73cbecb3f6be54294e5cf7a6e0bd0db96f00237c600484efa8c49f3beabe0a46e5408432451a35f9692de1c9b9ae6c95b3806d992dc29b441aa874a4fc8d0845182e6eea732740b3f2b2b9aade0a587680ecc0b561eeb2da31a79349459ec75f9a28f28926a7343897a127115452be91dd5ca0f74625ad1d8bc762e8486be3b83387bbaba570910c49dd13043037f7a505db5c45e06e03cd9270ef103e5e2a0851388be54f377fd486709de2bc9017f7848386a30dc98393fbc9dc852846fa2fabe37da2d26af176d95846b214d667ebe804dab9e2d30b75c4f426cc031dee533331864edf9dd30cd7100af5ccfc43a3b93ddf6708a15930867f7c33ad56da36a2f152f1e1152f7a18b8c58fb6d377840635fea702c084f34762adb955365e00df689a9c05be516d3e91e9945168fec3b3cad76a149172b756bffd4bb9d764fef38d5edfbe1891f960fd5ad17394a4e31af5bf3709c446985f7dce16e5865bce2f056f9411ec98d1266a39ef1dd8d63990a45505550cf171a1432c12b9c5f7f45f65d0cb9ff38806cdb1c58fa5113a552a211ec9dcd0ebc8aae4cc75fe36e92fd771d69d04c50b7a8eb758f3427fc9d94dc4c1b062e6074257287e2ac850c5a3a3b078ffde47394220673ab27107f67873397a7d8cda945d3a118452a512f24fc65d4ca71e40947d0615d3610bf12f1c062e12fcad85d49fa7d9f3926996da4c63189ec07d8382dcb6528d1ac5303978fb11bda43e62029685e356598081e4d312a5337828e81261ff7f922194033488263ba5678d93d244443da302f4b4028b4684223195d45db0bb5260444c9ec5a403b6c0bf762ca64f3552f19ad5ab32b6c4eb9b645a441070d46d9b896ebd948c00c78e2c5ad74a44f34dfb9020e697cc200bf8ec35e0baa3e3f909c7f2a919a8591fa570c0d9c23dfcfbea02d1f2b31730ddd0492f941d8d92086dffdc8c4fb729fdb678783364647925ae482d9d870095d3cf73561050456dead554f38a40ba1550bcfaab785083cfc9ea15da7d5ec2092c890a95bcc8cf80812254c8741e69592072fb8242890e557104689cfea0408f1992ac6720520fa6cc5bcffbfb230bc859eb846cdeccd03f106a5677e3bc644082447ec81347a55bc994b038024c63fabcd4a5adffa127437e9e01fc35b3fd9fd62c4ab7c934e026316311d38fbf79a022881c7b779cd3c341a96ea0b4a1fe2cceca4a58393d430eaeed0d192465582d3099d773c097b92b10d2bb177749ebcfa136b7e8be1317cdedcc86ebb5be5202b7222787254a3cb60ae0a2621b67d3700139f3eb6cf370b3878374f94b4f49ed8fcb8762985636473ea2765c383be16f208309bca80e6751d0059160762b71a59a3ac255f873cbc144e8899c1928d996ecd7852b425221a4f4aa3957e2bd1a9ec5a4fd240c51ace1c51c0e7b15686f858f3f8b45e68b6df1bec2cba890f4aee4e737ba9ecd8ad36d6f9c3cc838ac345561e159bea0e0baa5a7564bf6aace346e759137fde8b02aba270b5e4f2d170433bb6a4b0aa4f33b7853e6e362411b05d5ba1de05cba2e1aa6d7558343980b2bae1d418509659dce3d7528e15d0e925d4c31416d71cec1e88e46a19c04e244520d01b5527183e6fee4aa078517a908410644bb64ed2f636802d0101e15df4051c48f223a3ee75e229ef5a9917ed57f7f79b52aea2db4134190981c4ee04e3a3c6b96eea4e486f3c86ebaa938ac5ae2e706b2ddf4fa20459079b84aa9a8d9b158df423bcab4b9c04efa86a94f4984d8012a97cce74b38c13c0a0202cf47a2033d52637445cbf59b8844ca49b7ca7dc0dcdc8452254b74604e739557a02afd1885cd3e89993e74c8c3b2d36961044febe26b57eb0c8229f764aed738612ebf19c17b1ced5ed5345a009019448bf0728b294073e49df41468aa7bc6ce24565bb0c12db2d2483dc03e7b2c17029b20e61610eae07cb911ed212d25780897b2f11983660cbf96a1ae651244b58f8c542e5820afc811e76b333458713360812a7210262e332386e4e71f1e1694876d1b0cb5179dd8eb78589add12dd20158ed63c1432728665b5dc3447fa990267d12d6a7aa34fd78ee3edc95b016e9fb44e9c1d6371819292ddddaf7880c4661d9f0218de87f28dc1dd92e15eb4f4b986ce7200e967f01d1cafed25a0a8ac7e2335ecfb8357404b9778d99fc6ce7270142c7f4fada7096025ec2d1b97edacd4918e6060ef926861f793b479b7f55c373bd3ff702bcc654c7dc6a818d3a8a8063a55e1dd632fc17be3b2549b74d7d10c84226e08ff88a5a1bc74b5731e42e201bfced04211ff58c3fd215e5af065e90dbe6f1606f029a1ebdd6563a15fbde0f7a39f472b13574077b4d8e86e347de6d838f7b90ab99a1d820dd6ece18cf177ace554af4a80ffad8b3a8bba5c95faaf70e5ef4b2198309e5ca56d08b076291dc05f37e290a4aff9d2ded3875c7f5576bc24136e61b23ba5809fb5d7a4877b62636d057a1401ab1215a369ee021e291b571857e464ff3421cd8ce1e1e4acf83b0871f25a814fed9eaa9705030eda5b0b93065a29885665dd0f46958a9de446ec9904ec14ab43b91b383033b3d51d6d24bdb046e564117b638b2696bede1728a594815f7d239e143f6863492e383542e31306b4f668558fdca2371d09cb69cc153e12e650bfbc2e13e8b0e1ce4fc9c68923c61e3bea77fc4f368d7bf5f190288a42dcbe267c43f9f727eefed56fd5cdf27f03af1eb09e18ccbf6f54ae51d881f432e730c311eb7421ed55e454ed2282e1f3c1c3eb54ad491294d34c7f27dc1b06a4fa2551a4d34b9daed7682fb2fa0d5ed4f60e09ebbdf10bfba656c8cc03178d1f55801a442a5e346e399cb64d13818467e00c2cb5715742fe86eab436d44b0fb51aea111cf8128f7d7460e66aa2a1b95593ee29bcd71377c7f0cf88fb6644d0d83655d564b5b7436684ebd5b9bf2cf22fb97199c759a1a774882e5b3677ca63fa933c5de0660e9ded22fdfc5ca790a2757ab1c963f3e74e688f53f71baf78b2295e020fa0a6a4febc13c5d2c7da3ae9fedf8d9c8fd9617e8c1af37d64fa8d10712f37fc6f202572462ff24d2479a80738bfce5e2be9dbcef9aafe49b98fd16ec2a239d3b2674ba57ca6ad6c57ace7549ced866c1ee6b6f4c1be735beb113490173fd89591f44ac359dd8844c8e04d38e8c373c160e867b1fbf7e70e528bbc150d7894c7f207f0e8f4e729a40fa7303f8af3c18ed9c1ea51e0bdd9189861e4bcfc8dc33fff1c484fa528208e677541a50d129f17e6d55efc8739a3e02c58fa9b09c8aebac43e4fae9ec49890b6b505de3e06a52ed17b0eac38f596211678ffe44bb69aec1631e02a93ab84dba95a86024ab3d06e6bdf6b221fcc401bde1342f6454d27d636c6647cc11cde7522c22364c91d39853fc206cb0b7b8a835596d804bd58cd19bc2f51e79b18bd6c9779e1f611ae6c9edecb021fd9df2c7646d5491bb21ac3f6e0403ec870b30012cd774ddc4dc7b311194ccbcdd93e753b8b5cd7b46f88fe23864efceeb79b943934273445dd73d35476df9f1e1321916c4ceba4b485d0bae6930a0a771e55f44ce449b72484e3ba7babc7ed0cd002d6d5a141b36b22c4127c4f480c76af5db8dd54f90c47782ac71ee89d00b06da45b4aca488f2f32fc936796a7ea91daba38c73776620c6cd8f943d3e467073fab4b89c0549635a962493f3fbbf6b3ea6b0308e0377d630803ba0a23bbf5f492208f6b0be1deda5129810897858e9d89b0b0d9701013a1ebd2ee690d63f2da14f637e2c655dadd2614c8f6bde119159f155f5492b829a34109191c8916371814450ffd7b54b8f04125c86e5b3373774ce9208990b8b7655ec7be1414dbf765cd42a8d4980e265e8531e9e62099ec677bf54a4e58ebd5c6325099f5edfae112a4803ae467536dc874f4751c1455ca38dcde939c6d7df6b6dc21cb744a8e1a0672b0c39bdefbe922492eb53466137fabcca40848ee05d82c01bf5e02781bee8e228bb2bfb0718e515836e3fa1a83eec83fd7ea63ffcc869e27607653c4b2b58136eb6072479a615cdc5155aed6ffaffba2fc9d6a4b5248662f74b99f4ebce3736a8092b23cb7dd9a0beff3bf3cabc2397c6e7723a3a67bb1da7a6d217e7fb8eccc3812276d1ae2621edc6db321d8c3d3c63e8d900a2391ba49491a12ee1ffe24fc3b68bf564e369fee002652aaae8fa874431558fe392cbc93d0f6f39383470d0462b8ffeb423b7efd2d65b7e5c852a31f53fa1409799f62b3806f33c4535390f849a8263a37f4fe82e971bfad3f0501e1a9f57bbe2c4074fa5622b5afbda1961c0232b7d5fb70b2bc758e189f21ccc0b25804b2bd547279d9734b3e74199c5e52b9fe15a38a3fbd448bbdaa7a800285345b00893528dacf6d1675cad8206df02d266357bb6da320a976b04c1656fc061bc8ae211ad2d087068fed79a451024cfbba7782375ec43b3f9e1eb1e3e9822a6cb0dacc00fc8a55c95b8af89fb70a78de33afd7d5b743955be8cf44a9ee8f28b2a283b8cfd19c48c07083db25f9cae6892a27f08fcea7551fa976ffdb0f09bcf6c91963ae3b9844c6c2efc02af10b5ee896079d5d58e1f263f0a355ddc9468ca24a2feebcdbb2fa74a1971fa6e0c32a50091a4d03fc23b88b09edb7dec7d290569b19afbf2c7d95ec7987bcc54fb0db729705469ea0b4bd0b124a0723bed3eb23d5388b72b7b8a6bef4929ab917fb2adaf8367e9f9f16f7b539895f715bfcf6a8e32ffeacc5d0f8191165cec6cb5469ed991e5455a7e444d01cddc3c1b94822afe0bc21b20bfe1c6cc18485a0de8259ff5fea4bd92ad10ef0f96e2ea8e4fc8d7f77681c90ab1e2256f1414ccd4b89cdfca5fbf10ec3901b417d244ed53c0b9ffbad97fb2aced3c5dacd227b683c2902182d546b16fbf3c1c08fbeb8e03d7d2a0d09d042063681c733c88e6fb45165b100e536d064d936714c36338e77d77e463f427d8aa2f342850ae73498c0413e0517d82e936d879d699dbf6864a57ae61f033b5c096d4d189e266def2f5c42dfaa19f96f495cf9dabcc876fb38e16e39dc8fd2fb26f2b48272fa7b46d8e77a4957fc94a71aaa7292c0f713c6666f1c9d4551bbe76ad0a2ba4faa6b3ef468c81a34fdbaf37efc28dd7e34994c8b596806b81083a6fd26a65c8bf10380d82bf5f744e8c4b05a9343e2d9bef31c7c1a049a00df7e1eb5c884d01ad2462a80df0701e6d1c180350b8d552df556ce8277603c9f321321624b5a4dd4597cac81e170cbfbb403604f0ac335b4d02c055e104e88d46618ff157021f0df217f53d905a6dc4a69e0942bbfb21a2074e11c8e3c95e5854919599ec0ee2581cc9e6dd0c3a867a4eb6fbe2b821e18c8ed84430487bdf1256f98e4ce42a5ba705fe860d5f9eec1dcda7dad3bb5ef55be3cf043e6540041556c35493bbb0744eac7c168447f1ef7237570d465238c26bc4a4c564c29911b125a056f6d58ea3f30c93fce1ea36a42b7ea15e2f4f394f2a5eee327866a791b0581dbc8c80546aeb4ecb9fee0c605edf54f043161781d9194f719cd61722a5c43ef43ec50360ae46aa9521fe870aab3d22c889c9b0931b9babdaeb3a7a44d8d223a29356dc7cc610a4c52548d9f70c31ce2000ccbf72c08c86ae6114e38111cd1a91c1605482e55c7fe504a32b6aa761517a0561063375d9ee824e393a629b4043eba52f73655230cd88e27ea149217455b2d124684035abdd421630dbe8d9ebd1633b8970a7829d8a379cafc6cef0813034fad8f1e158b77d657faf56042dbd0c1a9d1729687f698579f359884e79ac2548b408d3c4f06c6219b6e32785c0d4ba3dc0bb878d1a7efa31f478fbdfb52ba85b13d0a428d98bcaeb3543be1aeab73802eb63e2ee01eda6013c7e7ca87755c66e697b08da853e35dff8fc5a974f9cc45415a400ed9b9c5153036c31b18c7d299419c61b0054160071451778309e3fa566ee571cc5e8910026f919e7fb05e8cd117e6579e9eab69c6b4e970df6f29298173c1e888331450e97c1f225b9fa4d4d9e546986b6b4418ddc6f190265517a3e4d5b894ce7ce145f95c549f1c35568714a8f56d732528ad19e58d61cadb9255e0e50c3999cc6e328141c0bfe71aa2e335fbce2178b68cc1cce6641ef3be8612e54c094a5dcdd0888d9c0451455ba72a09450c3b08177b5ed91de3cad05d21e00732ff8769c9c0680357ce6f0cc2d69540694354deed14784ab3019fe991e1ec9f8ebbef885bf31e3de14d9ae596000880e9550d763ee1b27de938ec268c70baaf3d7bf6e5784ed00295debcc0dec5ee2c1bdfcd54ac1a3858f86db0ee35a649b8c99a85f89a99356a9a9a805b98b236406e7473e0cb941226c6d5524d6fce266f4023bc76c913b5619203485ee56988350d3c9d54bddbccdfd72814316720f389c1af0bdf3eb021ec11ca3f008ca8f641e774991de13b6362a7e7c4fb287144cb9f6e7f9e8d002cb84d880952b600ce268327f7929596e1d29b73392ac9eae8743117c644052137b13d1b642a8f94d2efd13323ad396f13f95ae6e804f1400af2196d745292ee58756dc4248e30041a3944ecb0405acd73eb14d5cd976ceb06ad92a887a60ed916ff81a63b49b71eec177a8ebd44e7513b065db660a85fbf18deedcc9a9df02c4d77d49e01daa982ac69023a8479a099eea25d4768864eafa81d5027fc14cccde76647422a040c2e1dd9218a0654323ae30c68c7e4d8b7bdd6c00d9cc361b627cacaed49713c2ee1153d627a1bbdfb137572ba8c7ef020ec444d072da8a04e15159f81f3c8b8e84d6e652b1877b2f5038bb54718e84fc906d18bbd4f0786a2ef501d2cd75cdd83ed4972a0a37dcce8672d0bd1eed9da63d985d3b0e23e3df26a3c2c74cf6aa45145656345a13b04cff8ca8efda02a47d8d51dd96b68782331c0569eff3023e8eb0ab30b3374f6da79abacf537a759b1bbbe6292d8a84a7c59697656f0698f95b2bd21194557ce33cde5d56a9f777cb7032b850c55d4862cc56f7a37cfd19288a5316c0cc647f48bf94ee97be191097c950dd4dc1a9e58a5cbef3af965a5481a11460d0c453af55d30be953936554df22ddf88ae6ed18c0c7079983ed03f58bd481ab5ea674ca2a15ac82fbc82316bfa86c663c64554d2859726faa1437ba52fd96e495b6be1d652ec433f9120ca957bdae92247c60ae2806eb7c5ed6f1e1ac4cdc4449b2410afc7b3e9163f1b2308823754080684c36d2b35f3fa5b357b5df0e1e651c269ecf9e4db910a21c9e1565a79a68478a04a446c4e1ed2565b8524f36b2801af6dab318ed5394524ab4a47f07e29bf1eb4513b89894f0bb2d110bb8f13e4e893aa5c846b45dad3e9501770b0ced24743997fde81781e482a97964fb7528024986eb0e5f6fab2cd924c90991a597dc56bb1da5b1880859647a47d57c3705b0171c0909d090ceb63c35e1e41ad968e03c92d159ca76631d510d4d4ea41f41f9e159a3affa0f5d45e9e5cc4a03bae25d8c2c64f8805835bb06fa5dab9729524637cd66fe6f7b460e110cc53ff518f18d38a19ebb5fca135540f38d750516309db18f367a7a13cdb942ca91f62f0aaca9aaec16588f2494f311328f1053e8563a43953041f9d8500d948fea61362ed645e75fa87ed3143a7f0dd02100d761eac6ee3898256f4eb749b4445efcd82d23c958d8d650b655ecdbf30089390bab2196912321d7beca2597c1bc6b1bb8a8b7f6c0c439671b36567261b27e77708521dd52fa1e93a8de2fb5074fb5515d5195cfd989a1fb1d73e6994cd16e969b7ba71175a104559438148230e8a31b974200ed0ca2e0dcfd19e5f76e8aa07783d21d9d76b25dcd2d8e19a7992a0b3ac499653c4663b0477f6171973581d8725949c43e2d589b605c73cfd246782445e9fefd3849d1350189ff967f5a879fac7704a5171bf81348a1cb631ec139340ca6a6f7aed8da06948623388ce620966f6ece228bf4cdf37374f317f349b0f7dc9050879d0d2965521e1cadfe548967a46d1a4ff27aff2ca578c9aded15904e19d60cc78f44bb6662d2b2a80001adb160e5324c3302209e0aee3046ed081b9bfebf157ffe696ff0090a4bc92f9523a54cc4231fc91d4d939e338a5f4e7d8bd4cc8af634cfa022b181b8e8433b1a0eed34a4015dded3874886ad03b80e955aaba6ee147a418af19908570873893b869251eb92d8d22c824bdb19a5f1fd4c9da7ef35da4be40c1acd4029b0e0af063183fa32cf2f3d30f915d0b081c20067bafa8698f5f1bef52e9895844627145cc7643230f976fb67db53f2b8292274a4c4a3d9f1870da249fc4e65106f8630c9aa5d136864b2b6d2b70b565b88c8cf198a6eecccdc8d0e47bee8eb5ab2b0879959cd325c019f963ed597bdb033390d83257295afb5338ce03c83279965a22c8fc99b885d9945347528aed3947418f8ee47df1a11064b8682b31116444df1285b41d6649e31e9b0a4c5b89def0c732ff7805cc93d7e3bda1bc4fead23087099bab0eda8112ab6cd40e41ace8d01be49d59292a05d4db7be14767982fc8b0a2267533d8448d927b59bb0f73141e39530f7b35d489c8ba21895f35611d43ebb47e6195977bcceecddec53355874fbd072fa45570349f815cb20aa0dd4c2c8be5ccbc68701da06f8903b138439cfe980e116086d457b69b7c1cb4b1ae6eab75a16dd3af8a221c7514bcc97bedb7eb1ccdad548aa6b45f9e084ecc204398dea2abc01ad0e4cb72c4d01160f4e13a1aabb8ecfd6241810cef993abd08935e4dccfccade762ff0d142100390bcd75fc9e7420c1c7c129c45a1db70b60841167c7da82294823c6d3affb6598a48f15eb9c975de0e261ebdc38f8b94d3e319b36ab4aac8c2ebcd2fe6acdbe39a6e47487d39d1d134f84acef6ce0d71cd9af17cdd018b85c11428bc7dbd5ea0e466345d6f9c6169c6fdc46e3fbe3d902c105c37bdd74f9a7a2ede734b54a231f6576a85d691f33a6027cef8e4ef4c39adb5f34f7ccdf88fc394adf1ca4e11355e8129c1de42eb9da7a45bc7b3ada34cc1d1a63f4f9f0c6598366939994fcb29d3c78d8b936cabb1049522f04204c29b51622f9a009f252ddd3dfca11cff629b33f027efc36e68fa35807996c3bca6ce074db49961f221c93844630cf5804ab1ccd20a6d4eed4e96a6484af374507dfcceda44d9bb02c6b9846294c0d2d13a3730aa689398d14abb1e29253cfad98da41adab2ccfc6c9330a93a61e0287f0a124edd136813003ac322200d458eaada5aa0f3b7c6f0a86578bdaaf95c8ac72eee4de9de5718d6d558b0845ec901ef72a93886ab4fa50147448c95513f3a567b6bba8f59efe9ad3b9e5b071f04ecaf20df4e0fe3e08fb01d51f1adeebdc9894678556871a04d93c3072c69b5a520a02455e15a5da6394a89f58d0e8a8c8436314fca06da32b35d12c355b1867a042127568529ded500b93784b9369312dd6e0fc29b4facbe3ea5a83e84ab41b77812abf62ef56c57b692006a08752f88e5780c20cd25a0824f49216d3120d2a9e0ce66968910c818e1dcbdc4ac3caca8265d9f0813f3e9fbe6f6abf8b90c8e3dfb34d3734bdb8251f4af7cfad667201bc01e7bacf87e328ed60111fe0a8837e99e7ef2f3fac113af1fb32a03a59d934b6c7aa73b034eb1ae8b12c1d5f98087e9eff4c6638fc232284dd011abb2a0af7cbee5269895a3ebd585c3cc7f2e867494300234d246c79d43c3f01c316311d114ea2e091e2a5c9d50484acadf8e7d50334554bc143241db0879391bc233ea26b7d6759e0a1a13a74358fc6b3a50aaef1ba7330306811e968fcb7bab8f29de4945e5a2b12c84d86e0ad852e6dcd6334d9ceafb25d218648028934bed838f7ce795be5bed95744c413af1e6bb8c95268ff4019285ba662c9e5a7409f58fabcafa2f4b311742a1cc1d384a9f8b9ee170fa40e0fa477b871ea3ccefeed4990a79f496db1a6888ee170e05b4ca9c59929468d02af54e10cd21767b821d94099339c78793c5cbf15456ff60af985facebf7daf34cb0ec0a1d4c9e5eff675a937227db34fe6acc8de04fca27265da71e8315da96688f3edf9989c79f7ee265313403599456d4374c929e040c64148a6808f888ef1dc4356472413e1fa6c0680690147f54ce9b16e5f0678f698afa0e4b73a40daa896f62b3fbae7ad8cbf39c9a444f0b8ac19bfa3913448c654d1f3f39440c57851c712daf64a5b17c3bb579e326e56fdc21c6325882a9ea42fe684cd71df20d3e484645fdb9b537f9d05d0b87aaa99c7ffe33e1c902c2405d413fd0e6b310fe16660fd76e94d346361894372f71438185c686d21c8ea723f530095132c8ec211452fd3d27638bbae00919aa082f051654aef0f1f7fec3c144af5264d028206826bc83d1acfb9853fd7f60e5de3f23803e9650ee8583a944d30210826d9fd0388a9f51a2ea5b1b7ea7f31dcc6df371f542aea029dae84eebc14782bc3cbebb897fc800ee10c7a2a1930fbbaea93c0ccb324aea1aec0ff636fa40b41afc2363a8651deb913038152acfc13331cc5a0f644dfc7f77edc0bbcf37a438946ed2cc6aca295f3ac78a928ca9b2d224224a4aa8c9b851a830d06a9f089f201c2c62feb147238ed96750c4a67b774acee90583598d9de33400172618d75094c6cdf896a8a069fe1070121767063b8954bfc6cf838eb9c1905e51610c61d9a1358ee1b0449e074fb07e1451fe33bae6439ccc55dbd1d6b81686679832f76e3f9c06ea7931fe0401c087c15d449c36057fa3ad1f532e6e8e143de4bdb3eef78a5a8bbac9819a733265a6603dd5170d7c34b7ab8094775ccffff6de42e51ea738a836b78d8f5fb02e239995775c2e6d4ad8dc9708ef22fffdfe37c28a12cb3690aee8386cade7f2232f85cd6515282a934f65ec3db1c4fa8c2c3b0bffbab8dfbb68e834632264758fcb968ff70a21172b940d639a23a5a681fbe0227de8525db2b0298e267878ee2b726687fbc592c76ae9df24ebe7e4cd381afd92350c98f59180457a0ee5af6669f4a00215278ed4fadd386964d6463cf637178c723981684a7668769f9b63086a7a86f89c1cdc35430ff1697728dc74b9ff4335f60b192f8724199ef23548f7e91508049932de9a66aaa3ebe3048005071333cb4af8a7b9c059427d0c8041b30fe5265e5bbfd4da847aa3bb6af42d1a13825ebf408f1ff9da6eba7b6c5b76bd95836f37fc316a1eb791b71506f7b7ddbccda5bebbeaf895ad6334b1ecc032695eaa28df56c39e77106c8de2c118e276510635acd1fb54d87efe3b1fcdf09455133b0ab376f83c0087d68cfa83373724e4c5615050a2a675283d2cdc9431d5fd29c605f0bedf8fa2b185d89194874473de8f162d5c3757891bb638c9bbfe0c27bc25332f4e51ff0e831d7573feec33e23adc7f153aff69f791981968209f3b067676d965af5e7d8e7f876523ba54b4dc90159550c681afc20b8d2f061f96eb629b1058d6f18f54fff05ef38ea7dae0f844f8b231a2f17e0d5cbb6c49fe00214245b9b7d0d33819e864dea309f74567220ae2c8b009ba2b5ce20940c5cc0df86387a126912231549baf8bb0a751a7198e9548ec2862488be46e5e0711ee7fd2f1815638ac28f2f3fa09cf2a42b54b48830c2ba2497ffeba6fa9c950999f86d349cbb38c86bdb14f022443b96ffbbd346ce4b22097ba696c1cbfbb408bf6fc83226f811fff691b83c0657ae8f06cf36b82bc47bbb238643ced0c3a12d8f812ffa6320c1a5845308e55faeb5ac04cfdbfc9a997a56dddd28e6f18ccf3314360d7e4fd9f844f755ac5238f1f77e39a2830452bdec241001f071e79e4cb3bce9838326db2efc5a2a0474ff527bf7decf053dc6af25846762a38000fdb9f978bb0e959e8c9403123cd11a881cea8d10497bbffe184bf44506ed8da9385037b982d4f1004b5c7a51142b74f06f4b4ad7b850cdc26129486a40007174182a46835ff79ac5a973c5787aec17fb6802a07eb8663e206370f04959acc772daebbfa0805990789a1cbe63179684ffe03d712530dbde3b3fa757bcbac48d0f0c4ffba7d53d0404286d2d8d478768ef351b0e04878b0e13d83489fe74c8e447c67ae789377d5d6bfead56abbe60f68b8ee28cced4552073b3ab15953b3e44aa36c1deeed5e90eefa2b80358da9b56b7618bb014f7ec8cafd63c85886c80aa0084118d00d123324eb3feb9de681b621c3972c9019001433af8bb249d4c0e316ec1c6f167f066e879e12c79cbde06830022c9394fbac2a6b79a172940a34f6e571668ab305ed1981da47de1751fb1a68087b0fd4fde2f04a2cf6dcaa0abf621d008bbe85bef0eefae7ff52e28acdb67034d48026fdd9a0fadac13fd9d9ae67ab9e549a12c28db387287fc07104368aa482a8599d7e2fbf52ec66ceda582504b833485359e117d7ae80e1076b970ba977e9a1fec5fee5bbdf8b7bcb6e483c2f9a2df658b8088b43f7300d6937bb05e9699d71bfd8cf4e8a50f787449d3d46e5c82c2f725969b9ebd89e9eb1801c32afd581c62a767789cbb66e5afb1348d57cecc752b82628391202616b70ba0d9b7a775a3af2e37d6a2ee1a2ca9d025fa58b601e952c968308c0c0e29da5bacd3f06e59ac75201530a8a6b88441c74049a7228dec332543cdabe491d8933c883b83a3af398e2c694b8e34e09c3d0e9b9eae0b41cfe0d8b7c5df469bff0926dcb56e8cc05367c57131ce3bb399e4fb42fed1b9fbc0218ff80568e3b964e43550efd9236b25d590dce8d028a8efa40a55264db3bd7424ddcde946472278092038244a8e82952b1d6dcedddeb9e3f3ea4a0d80b759a7c20a70bbd80779c2cc361e93e2afdc44395ecc5d4d2cb5f8b0e9041fbe2573fc0669a1b427f616d52ad8b338f21cf7f304f1d6fb63a2a60986d4640e0cd8d1cc246399cd9e58c9296698c349c2b932ef548468e20e35dd005da08400e689b9149464a61c3a27d31da4b068ad729be13190c0b0df34516b3d45f18a4f16a7ca4f0c9d3bb2583b9e62f704f4e387cde66272212760c475438beeb30a7106bd752fefaedf6fb71f655d4dfd32599e5979b4e4f46aab247e6ff363652c2cf3f3974348d887b9ada8eb7b0a594a7dac07334e83a96f5dcd5927b635ec82d65f67acdd52c389b2ee9ce58be098f21f2fec8e65d7796f849c7b2486ca18cc2000588d2b4bd2b53567455553aa32af966e38ce70ad3c14ed772f5eca1f2351808fc4711a2acedf8d58f9a25c563292f47279c036fa219dc779d4d3c91108f165cf59f76919fb6fce2c7b7703f9fb63842aaab5bb0c1220818fd93eb00026f167736ac5f66952356444d50703fefa5d3efed888dcf943feff5ce020d3382b7db5f165240ef887868f06c54bfbac56cc77217d7d245fd2c79b7bf3c66ad935bd361eade6d64a0f0e0157b6a4c637172473431fe6501ce14251bc4ec8d7c321d0297aa69e5e4011f29e8231b8966bf8f13edd2a4bc52b1096192e52c34c738c59ca104e39ba7a8d6d8335a34b4ac99aaade041e6cd3f22d40aa8af41c8277a9e56855251d51571671aabcf5a38f9488dfd8ee650bf14071eda1efc5dbd9d11767960a2edf66a3bb3f33e25c0bad837ab4cc87764519c43e8703191246b4b9912ef0541d49926545123027c2a3f1f296d16578621877b311277c94a88186797d33800b10c2e5821e3dacb4e3507fb126a8170c54ca7403adaed5f1d9ee0a73507ab437a1edddfc2090de26c6e1f7e17889edf8269649dd9ca63e954a8dacc23a01b34c6d2cea0a2a825c6006aee8013319ad2a1953b6557306f8fb2de236e5338d50ced9e57e32935e270c4afcd610d5de9732c9bd2992d36344f799e45495d5aad79fbd21a34011b7aa2c41397b1831c2f5621712eab1f7dc3b8a1bb7e4d690eea5ca5f5bbc9f741eea0504c126fc024eeee9083da128a6fa85f8fe674398e563f4e8c6e39f9c265c899f1bf0707fd1b963d11237bd0d18839fbdc20358c8c7aff7894e3df83f8bd6235f0186a0b2564986f14e0497a800db58bcbb49b29fe5c2023996fa245cc6d61c553aa7f6024e145bc35f2e65d9936f68c7aa2e146f527a4aef69a493709ad10460f617fb88b7274865e08faf43af556fc880b062ecd8523e418d9d0e4db8c64fa988cfcc81f4d4865f4faeecf33d0cb0c82f6f75ea4275c96dc619e9aa6f0a87938f12a7ae68ade8a902adbb076209683cf660170b0a416e71d702a4dfb0f4a553afe68d9463134646cbb1d330bc3c194210aaaa40b7d7e0dde5c3c3db4b75b515585b4b49117101dd27cb7127b9bf10fdae3274d6de449b5bd180df5fb528276067d60d435365e88e31a6a32345abab7278cc6814021545fa1af8ebb6798bf94dca5394730fca86e968b58da4df963728be85fc27737ee52fd3e15f3ff9fa3d1d7678eb3c36a747c12c4c1258a7a5eadf333ba467ccd048570a35f48867f937a6e16d05718a88e52554eff1a33d6a29b551b79d01a49bf4427241f56dffea27c62318034bfbab6ad3f2e17fb102457645106e5ba74fbfaf10e157ec3e0e874660b1074c76b2733e0a6c5ca7867c09f06df864e33f88ccc5ac31bf2d1b400a299acbd721e81fda1b4d06ad4413cbd96373cdccd587e90e6aa75e2cf8b8eb226869facf8d25d98a1d4d89675f9a2d783e9844da9e729823456bf7416965a197b3eb02badf17c2d2a879d53b33e5f08bda7addf73ebe21d727968484f4223fc185033ac7a9107ef71e61e9310b1f58666ebef793aaf43c94336d7437bf83405e6a04f679f54aed11039a6367f9bcdd69877f74bd795f49d6681e3836cbdaf750cb4a7657c5fff37181cf57dcd47f5a3ff3b064bda1aba78ebd8ee7086bb3f51ef7ad65f873d0d87f5f597012b67f0297cd0aec4760e21eb4203bc6ee16d5d697e21607022d721d966f1b2eec5c67fee429278cbc731634542b235e6d909399a10577fb540cfeb19e5af7096c55da8b22d6d4b0b68be99db2bf69f55d0048ad8a4418f69abf7a51d6a06706f890f9cf13c5f78b786c44c3d410f198f85c7429833fc9272db77480ac55eaeb6633df8cd2b4516d74b0fd5b0df4c0d86df15ad9f9bb39912c59ed42d014f2e208bb6cf52c6ce63f2f4160e42bdef5b4e859969c23641335cb01bc3660ab1f19909c31b6e3fbf9efe30d7799ad66249973af015690239f8554ad2149fee1cf7aa4039810fd7b767132e7ddaa653eab40bd60b6436881d0f47d8320c042b3590fa419b0ce38efdd8154d3a530db5d549c46e884f3840dc196c5ca39e3b06d33d283708fd85e8040bec1a8eca8601f65c1482a5a42f5af3bab4fa2bb7b67ea16f550cadf61f7a23e3115fb1af185050ee64f06282d84349557f82ad1663d067555cb6f3e6aa0bc69927502691488f753448e3f795d154cb9eccf38f75d73c78809a42c1250e68780a31719dfdee97b204bfe6da2ff6cceea265aff132ece60d1015852e033dff57550f1f2d6172aba070c4cfa4272302d6b5b38125465f1dbdec5ca1110b6937f50c55d6bab0dce7c4f8a7b6e878bb334d0fb54663fcf29716c20cf95d36e1e56e89375273c70ae2f54dce46690a3110c58b9795ceb38e58156aa901f8067f53ce1b6308ea9c1185416a4ec2cbffd977c3afbb99bbf4124caa7163aa195c09312b9cffc69c85971f6f81dc2093dc695b7950e26b26f0900629157a4ba34eb16d1864368710df3763d617930837819d1f3af7894c9a2c34be77be5c2f2e4d61e0cf3d25a7905ef0ed129be8dc604435eff41682860ced133be7929b9951bf525013b1f77be4c35405fb5057410e3635d378355e07419431a0ba06ec20cde85268f844d514ad2071c55b8f5362ed206ada7b69119b18a93895fc6c9f0d4e597e3e0650d89685baf02386d2dfb2434017a52a810651c4e796f4e8ea51d7876958b69682c3e07dbeeab757986490e5cab33e26109132f4f50acd9526e69269b57f9ecd03411be200dbb3943e5f911d9099dfdf6b7fa8c5301bcd9bd965c1e49f3242a97b6d97a0f222f52593025168a269c25bf943f414953b616742b27a9e8894000063f7ce2df8e0725fb6d3a111ab47e510028dc921cf6d896d2ce7b02caf044c3ddea165aeb3594a14bf1cf38b19ec4aaa348cdf50f94fb3faf935e76bc3892857c589d68bc0da71a2846718958b294c2a162d821c31da2a137ce897d8c978645792dda4194414a0a701165ba5695b0fe79359bfcd2abe3f55d3057996f93787b762ccc84e938be8a634cbe227cb7992179d2c286dfbbedf24fdb0dd67fd89fe0551db31fdf6af2f13ecd11899fc2a69f7ec090f9fa457f4edaa13e2c7c79ab85877371039438d862fa0413bbd95ec19bc9898d609435274c0d5225f2c0748bd3ba0b1d59c0ef07610bc73004a98fcc9d4e125e6e513cfd6b51cfa2b183e2873abd3f41cfc1c6bbaf4125222eec6977b82527f5733d71ae2d822e74bef8f43ece4672beddfb2122f7759dd44291b023f6fbe598fce7658a6f76012b162d315d64d1124642273cb8c234807981fab2f6e30230890b59d16efbf14263ed0f794d9225f199b98beedb6cada6f66a0d1f1227300f6d59862b9985f309764f5d8844829609074dacc0bb370d268c473fdc3d58eb58a3341c6c62ca17b23ad124bbfc7ef917f51b6e664ad04560c02396ec972aa6d40a5baecd4d5092820ef1972f96e73cf84b6d956b48d2d9f46ceda45afc733283f1d1987c2d57a9a57a43ddedd24030ed8678dba195c35588bb37e0bf3b83d92f13380acbff9bd0637eab664da4d6b7f232620e2f1ad59a98c900507efb1942ab5c7780c6c34aa4a7157cb74c4a24498e74755a6a1f0d04bf42664e11738069c94f748791e47a5de005540eef224254de1cbc576ad9fdafdf156323e9cb6547afb9ae39fccdc7b60a8590aabfe58185117a50de9497e06b28ec63da18ab4c50b98592ed818bcdd21b6faa7f7853cd27be5790becd37080dee2cee104a35fe1686259984b70f2d8314d3008134ea7bb974d2131d27126ef4418f338d46fa30e24171386f31dcd86e97a3aa089b1493ebef966349dbf15a27441c49b35869b4e7bd1a19c3b0ac80663af9b169093cf33863c8b0d13b63a3bd89f8dae424b1f9d263e2bcae3db745ea29d7ecf823db93e6ba1707f5435d605b2ae9b3eb897679a7067ec9a5f7f5cdddcc092e59af949e8ff4b212ed67cb26452d69161fdfb814f2f1a515a0578ccf33be77a987fb28cbb8fb025672e9370175f3fbe29b8032bf98c23c77325c0fe12201cd2bd5d05074df4ef4a3baa75016a34b62f790f52c32043d358b847121daf21fa51c82ab7c591edf6a9f12ddc282df2b2df61e856f6f734a93fb1e1591cf125ee4c36bf6c458f41d76e710b8a64ff9661ead1a81935e1edaec7c44eed18c0498e270a45f668457fd44da7a5ea2bc64afb3bde6ca5adfe157fab59b9026b0657afa13e8475b2eed200b5b44b4fd7783b34f6b642ebfde834cd5a62eca3cc98ce9f8581de9ee49979d27255bddf680132214b88207a6d7888e5e0afaf9c0a7dbc021218bde4aa3f1cdba86ee2ab23c15f8970ac3b2289b5e2f1033c0411331bd67dacf30c79f41a052261cca3840fca5ebf84fc54086fccf5e4fd79b2ad629a0043275c84c949077624f9337c12ac84492c9df7342911de475bc7b58bfe314c703e998ac356fa519e14fb7c9e24f989767af1d6727ca485b09af42cd71081b0983c994aab03fb2920606ada0dae399ec8940c270eca0e7c6ccd5966eac5d8d2d1fbc8bd65d48118f42f756d972f0e53966f2743ae195e022bb5cfbbc758c7ae8e75ea9093377e52e93e4e03b9f5e9d4e7d5498d05d684030aba5d2ae8135f40db3d3241b532e49dc4b86cf234494ea5d8451c082ea1af90abf3473c1f0eabc59f2fc1e33daae2cef14f1227a7dfdcfa904d2d1caa22ff8dec0a4bd43a3d097b420a58f63375d52d5c77530b70768f66b32b50be01607a2033d760ffe5796fe0009fbe99a1963a688896fc1492cc3e6d173ec04dadf6610c19d539a7b1eeb7de276114cd1036a0645c99a26b9f1827816c7c3550a61da8f973099605fffb523fc58b3884e8d5ac6f27f1429e1e73f657a1a862b1617145d7b1087ec7f7c2fe6107ae6bdbca36a60615707c2e4b08f2789d32790cfd8fe4527667047314037715eacc709dd082d99a35132c6aad1864e38b8ab141ec343e09e1ffcd76e88da9fe357e079af4f2ca5e9938eee41069675934efaf3d326b4d640d2eb590082d26afe0d2e8f4eb0dfeff0359d2f85fe007a1310503ff7b3984937e96f34a6c754775f1988895d54bcac191748044b71dab96118115fcf5afd303bf9fc3e3235e281573fbb7c7b54be2e2f648cdd0e1f4544b7ef45664dbacf4e43b839bfb5fd8cfe7670c29bceb7464fb3bbe4028d961eac8dd34dbc0f441e011fde8d0d7b121dedd1ede6c6443af09ac52f5ba7b60f7723b49d33469d5b87c51359c7f713235a2827a405591a23a44513e0c6660dba97bfbbb2ff99193a138bb06b3fa5b61e021d1de5cbf26c816244ad0ae82560add517b48168e13bbac3e87dbf15c211444e96ea865a10c3528cf02cf6a5479392a7b0aa6678f78bc8a2aaa5cedca8fcfa17a144681b658f125dfa011e397f9d9777a8f0ee88b21843f9d950f3d23907a2a9a1fe0a1096e5fba57cbfd39b0af619064ddfd021a453c8f65becfe15b72783130b657ca0413277ce9cacec45cf4a3e23afe7d5a5e0aa0f64407fc79a2c677aa522db0e0fbdabd3f751f146b655e4e7aa84ebdc041955d9bf1a3463a0270840f0db5e7c2c10a2f5f8b7e5e5e48250d68223956438502442f6bcf8a82705aa22975d3e0668d26254f61230d9de25caaf83aa509fc0bfb4868e7e94a469796b1de8e7ee205495666a226ab373fc4a4b55ba1fb0b349bec4b7106272865ee7283ba8a6261c859362fb2f68183eb650b3effb54ee1b66209c9a574e7fb8f830228709933066eea7b5e559ce091221d28cf143a3f556807e62deed0dbdbe148bf1acbfbc3dfdf4d9cfb1c35eb977c67c4b94a144c724915f17a67de1ebf9ad8d6b8df2f0d452bbef75e8291d5065d4dda034dcccd82a9584c6d64ba6e1bd163dbcd2bb3b878219c292def8844e740db3eabcc270a9be66fc307cd81c58f1bb18bccaa7e5b271c70fc48181306e21022f33f276277072b47e9a96e8f7c60e6bf191157e4b318d5e7cc290c0f7b9558ea3d53b4153d1a474b174ac7ca6bde3ec32b4acb63eaefc5a3d96b77f316eb0ce5b63bd25881dbb4678a434beaa3412c5daa42dda906cde4d5044c885cdf4b6b9259f5a272027afb8864feea11573e6b453e0b9b0f622300a8472b75f5307392c7811a79a1bb21be76bccc84a58211581d418ef170b0464b8e88a6e77803bccbf8f8692d2a9369c352971d3d4c383ce54132f64fc9aa15cdb4a794c455220903a7a0391d54ea111b41d760eb0099b56be63e8f04628b12fbf250739aaa69d6cdb5f1f3b73a71bab2376d3fa99e80d62717c21ca5a75d71585fd931edcb01bbebe0c59637e9b7120a51e46cc9fcac7b0c0d2b24e1f90ca3346cb761c653c69fd7a04a595724a4182b133f6bd4959bbf279e483c981ee48ee90ea857b1e5214e7bd612106e0a371496228d94882dbbc825a8ed05201252677379a08f888be7d02f9dc3c5559b7e22d849bfc2a706ffc2a0acaae09be4959e22ffb1edc5318a971432b552b18fce7556d25e0f267406335d873d9cf5b5eb13e6086f7d49f9e52ec008446ec3c0ce0827729bff3cdd1df8197a4d8a1dcf2f173cc351cd82b4cf4097180e53a320cb0bd7d5ddc2d6353b90a3ab4b90965b545a2525febc7f8354fce676205f50c43653fd0b4da97261545be857954113929e401478cd71787c7e304a01ccb8f76ee40a6d28b5a57dd2f1d455e3f49a96345c2ddac08451c934dc8e4689c1eccce83a24516118f30e9d9c1950170490245ea7f271c7c74f43b805315ebc96545b19192e27974a6a8d4f0a8f83b958a001f200071a8f89eceddbea569cac069f82c67a3d7765640a1319cd3918c652bcf7c8228ae18a52a76c7d537b91581a09abcf0753a32d396c2248eb7cf9b03058034e01de2e12896cc3a4eb62837515e0dd32b6e6a8c8ae4b5e205a926a10559ca223adafc5056565e7f1e729e3fd8bd2a756953536c989cd71234dee78e3613f43b83b83749276287596d8beb392548917cd7d7e37e897011e2fd3fec6e4adbded083fa0c27f0404ea8383ec5f9d79f337fdffcd824602bd8cb648ba96dccb57a6b6016e429bffbbdd43c0143ac1311169fbc0c233eec95c44d6a8f88536aa8026bf3a51100a85e3437b9dca4b3af1680c2479b7efe6e994d38df030749b599edc91a7079e18bbbcb807c3e7f7637581cdd2d09067482a0dc8529eae4774fd3f8c3cb4ac734ee98c3af3a4a5cae1039ea49e054eceacf1b037c5279510bf5b3b812e6612745deed67df4d79386dff3d06a239aa3f0cfc3be61f7a7f54c419d387f2e30f76b4348dd2fe9ffc5c21477da6eb584351408d1ceb8b37dba2d4a4974d34f1304271299989f9858f3926342aff6ce71058aea8b176e76db5740717b7e974e2ba6c51d05ee2ab7c2787ee49e991dfdfdcfbdbde15860e30a6b3d46307ad1d7589044152ac06664940d763370375287431ca1318c6c3d2b928c0f91ef5d4cbca7ab662612059ab37418c66e7b98063cee781ce6d452da7901463ed849409f18b75a0da39e2110f444b946f2ca2ebe71809cc321c8a0b13b9860bc23dd9132e6308d1d23a87573d7e8f59273f0d0d3a7b28e905ec2b203a3ad51cef9398d3f80bd0e977cbb05df2fe9f7cb66c2da3c94b16d0bb35daefc5637af2c4836cc7e23ba9b859fcda68e759ccfb4d814c54bc2f7b9c3c2b52232f3a0ec0f6496a96663b938b0a7cec5ed08f0cded8cd1d1b9f943937739f3812c366ebbf20bab2a89108b02602a2f14a492223f524c093349474a05f817e1321fd7de3e49d1d625602cfa046bca1c28c587e269c7b3a5f3ef7a1b8ffe67e624a8fecba343c4f9fafd03399e8e11da0114171791fce7f86ea47c94e5e4bd880a0f992b591b9ae6dd80791b58c94c82b4d9e62a5164a3322e59e51b4ab10b9a26a5b1559a5c3012f3fd1a9348bb08f536480ea3ba92436423c016f3ddd04539c02470b6d2c1d38a8287e631cdfa079dd62e3b4bc5e298548dc12ab12079a13f86cdc7d130d4764c282f5c01f4454f5cb7a161dbb466b28896e18e6390f9a797b7c19ff3e22dba6ed641216a20a64e4356ce07458ed6b4168f2ab8b16b100781e3ff31ff295491655f9e74276d3b818aee5cf4e762d6c60712f329d650e3a274404839d00156288b7a9de40d93611304ac2ba55efbc10631e6870be7a98de7d258edba5f2229fb00c001e8d61aed51e8c04fb0b6af8ceca8bee91d1567e9b75c47d5fef8a812b978353fa5522d3e3dbb250a67adb4c9130d576593c554b596e5801add89b38f52a342b112fff1d14aeedb181fbe1d2035dc1fa00d00f0c2fa4a435b943bc84694f6736b02f97dd49044514d46fb1f302805ccf3fd635ab87267d504a9f41cba5796559e7bad34abea4ef973959770876d1b95028c65af014ddf2324f6c897371c9e33cec2782b725302d66b6492c3272ce91519415001d0ff5d6c3160ddea8735b2449fc2862889f838054330faeb7ecc5c8fad1b242bff2cc13c7ced1bd3fbf747c0644a3aaeeb468da47fb967c92d9019205386d81ae3054642127af4184d5d4d56d452977163be1df54d006a245da104a59e78868f9e1ed2093fbf3fd5b54d8b2b06c3cf069dfa09c5b3f41f99a3abbd80b8cce78719e09bdff5c8ca52710514dbd8c4ac7f6f16929b396a5f18d144632bcd488f7c09a0624f5a1eddef6c18191df54b8544828d10d9fbf5c6941af465112cd60445a6d88d623427b1d0f6a9b91f56f6897fef8a6745000c3ea5eec9f655429c5993f3286d164a13ff2e0787609588d44d056fc8cc85316a05117d7dbb0a71b1edaa8ae4d2cb2484b8cf8c8647b47eb42e4f709cbd5dd7735136219b187aa6e8a1149224e1e937357a05787be21f0048d4786c2e6c5dd948bc2275bd4cfffe2cc21d02837d0c89c771be7ab33ef60033b7ec739edeb29c282ffe756717fbe1fc74c9ce45756afcdf3e35a23b8426a00c1264cf7441203a510d9b14b9ca00f55b20fff615b3a6674f5a5f4374ac7bf84bb33a6289adee9818b59a4856a762cea8343bf5ec5d27adc79e9b4f294c1b292c2d4bdacd8c3c4995581cc2a3124adc3bfab3624cd308ab2ca28efd9cc1670d46de6fbc0c747eb16ed8dc537ab60d80ce0d83e21857341651079175fc7c2097f929e2548d5e6457c522964882f8102ea507923829e06f4990c2d0a127b60a29825511076b4522aa23dd64bcf66964e87b324d10082f71b88f449c3094c905b17030a6d03509482c9f16eb19259953b1aa551f3384ac9f98ffed2cbbbe5478083b73508419c4f3b1e9fe07d76ec02c34f47f02204125cf85fec4f4edbb4e49fd68ea06e77115509de718b825a29800d2d19b6a99cd97aa5b44fbfb48dd7adabedfda61a671237fcb37c825a980d56ca62f54581adccbd080ac110a4a06b8f79f658d4e6611c4fe925395481839b43010c7fce644649bc67a8a29a77280ce0e2bb17e746a0d3455fc3f0dd28e7b4dece9ff3872644cd7397811f903dcd4c63474e285dadbb28473be430527aac1b68ffef07d13908869883c13f7214cbfbf87bdd2bf0ce4422ea38a1188f2f05e89249cd632e529d8bdc80bd35bb9c0210ccc2a75b64e89fa69ce3f623a52c6bb192f73d220fa26cfcd4c7b91acf5920236a71c3188ddd89d54cf5a73e03265d250b366227ac1473fb468be8a4a614e78b2d9b6443d5c4dd3c315f97ea99ee9cd7ae692f30aafb7a7e40d208bcd0b590d4499da91deae4e2a3539c258e3d9b215542c91c58d3406ece28b795ae07b3e82a8c8c83953fcae1b06c8d942cc6ff3ab4a6071dc635f545b6fec9ab9e31cf5b3399c225c55e057838217df481502630b26a0fcbcc99302321ef3e8cd98b72adbe372960a4a7b300ab2e2400fa34511b1e613d7510b1847c878ffa0fe41dccb01be254f5780506ed13d0696599b25417a615f1428a6a46caf85b39dc6caf0dcf5b2f57afe298c4448329c34fc660eae2d76945786e0304ea462645e01857f669adc5a2d9977c571f087d98061d4ba55f88247aa173e3688076d2ada4bcd1e928ab721ce08c4e907b2cae566a9a06194142ea4a48502c9031a2ec8431d5e6a1ab74106f1851d2597dc65c3b6bba66128ca950caf7393c82d817846b68ad53a62ff3dd4514da734a05bed7a428ed79f2cd94a681f19e5fab9176fd119f1a8b7e4ac5995a8bc2c354de54cef4eef53c68b738458f755831c53b62d2840b18d5f6efafb313492e078162b7c6a4f50209ae6b93c5c4a928da2e5cf94533cb58ceef9f57353dc4bf66f159ae22a5a47e6b373bd355a9a05b3a881eb4777cf6af7aa9d8723016051764d722f5415aa6d48cf5cc9837ca6eeb99d0f8083e4dd4bda7b698ec2891c71ecb8ff32955c1e3d25d9a54911f602d363795cfcacc9b247e6d58be0cfe7ba49d0486c0f6b6a65b85443dcad8a526420f77b48de4802c8a01b45078c0af743b1059a712c155414890b70a542df29b9428915d8a421b40c529144f9ffb3ef2f65f3d959369c0d4c4d34d05c03ab15665a16664f049b4722319a4b72fd1248f87f6d015b20135f08bf828840751f49f4bd121b0084e5843adc6b41168ad8e9e1a95cd7a74f49dc6df256aabc001efaa3923df7e289bff21708833f5cb9ac513d2d970dc1268258dde182001742f2df03cd5793b5b648da9e3008dc5146c4d1ddc84b86377f64ade3c4c6b68ce16fc498f05a4c075d2d94fdfb48a1d67b56418c41c85bd5843d08c48d89c224b8b2aa879e2c5d5b803a8de7cdae00c2a7c851f6f5649197039aec77b5b33f7f13f78b82154018d95484eabd6c807e07f12593423d6c92f1eff6db5e5559948cd7d490f25f764d72bed6b89a67d70615b87757a9c8fb9e7c4da129cb07bb15d903c596200c4701dc52a1cc6fbc853258146b7fcbfee31ce9e6f04f7ceac3d8c33687ae8e958237222e50bb545ed50e0d926629dd6ebb4057df4e2a8be8b5256520c72998e4ed36f27cdd7889be0f47055932b3e2c30c959f9700500aae69b060a3c9197e4456e1552feb981344380563896a5f1909660f89510fc2573652f6d34d51a47d96a2637405eff841943fff0fab7dc1c954f1a9c707a8c726e42165ffaac8cb6363cb56ac90d510f72d23cc0e384307218b55f8917cbf49afdde40b403b2826113e4de2e224c453bbb6cc1e32b4880bb5ce1d7e5f1553b1718cb4e29e2eac4bfbed6ad6e8c8744d476b4468e6ec1166a55ed50d45ff7fd8f71cfcb123c8219a352d1006095f4578913c88c9fa54c8ff05d5fc63f4e243b7a6616ec77770c6416054ee19e07d911069596deb9952512c0f730821a0b16223db79abb89978f9dc6603e0c72c91dc889e164e0b1d6008c3a8c8bf0c9cfa41655672751081ee6aeb15d941ec7de174321c044d641f803ded987b54f04a9d52dfb490be52642b630282b94b7c9acbd9e30c4997adcae9338685b243cb65d1ffa95a346101811d43cd6f54259184c17972ff0cefd4c32e8e3f4a196bd2557a10f1081a519b9fa57393f8f383966df5c6fecd94e1710cbd04bfe84a860be37498cb5074643d30f4a1a5b9adb70a55695adc1c4c82448aa2d0bb78c6b294112637475a66fe1facf3fb237468add67699ac1c6c111c6403dadeb952a29779167c8149bea65d372036f8e7355a5e4930a84ec35951a41a6ac1eb42ccc9430850a799d4daf11a0b25283e82a88782d1db07f543a3b6e577193df2ad02d69a548012114140524f3ca1ad72439975f6cdfa9327be88ebf8112003ca9c5e7a1a4febf3429561438d162cb14640811dc07e1b2ecf3422310974eaa7570c7ad7171d06e37061e878341399fa03472842bf0685adcc7e3b072f5b4583abfbc90afc1a8880d2fa98f32c5283ae86edc2eec1bb302a306ddf06ddd980e75dccaa640604c310c9b9a0d4ec091b214c7a76c754226485aa126ea3bbfb2775994ee00450a8db306d79cb6d08a65feab65615875878e8d6566080a631c78c1272d6568e013729eec52559c7fe4143c45cbdd606a4b78292e3877122418ed2ee5b46e3dcc7746f19e6b2aca92ae322f9a6dacc402e93d39c2b2fba90b8ccb2b111b83afad9afe2f1f74771003e7e91f5e4e134f3f3d5b18706574bfb113c2c7bce70239b043f672686b07a0d1bd16c0dd60845d22f16c10b6566f85304adf2e1fd8e94645f806879c272e0a58f5294c56c4f1ba4dbd6eb31cfc80659c8b61e01e85c42a99a195721b5d8edd7f47decd3711545fed8b323e78de167e2f1c449b43a9c3eb1de83ee559088ea6cc098242de3992a0b898fb604fee3afc90c78fa52a333c2f9affc2a6bf914f652d168da86b40bba7640fa6a452b5e247db95f8ad4d5adde4f965d8cf91e1c3609180a7c0c1baf0c26b6cdaa0bbe8bec06d790347ca044febf57c7177e7ed6028e654644e8e8581a16d1ab12fdb6abea9223eccf03181ecb787faade88c96e9ec144edca48a634059e125f0f9d382c6c140270c37fa9b607cc5d6971f84bd12897d839c86bbbd7bcef65635a525210913c94ea456edcef3e73bd3c30724bcaa5271d9bab101ebf7dd96d7d138989845389a576d54b981dcf512e34fec03fa8092625c5351a070259783922e7e97dc91278b355a8fe5e23b1d6f5cbe9c422cfa2d3f5eff89206efafcb4a6051bf243ea48ec2b69d24b981dc277cac25f728dd9048a28773a01aacd26fbb065b2a5b72b64b9168631679baa538aff14b5e8ba4f95f88a470a1c30dcf54e13307314a9170e550db1ca61201b35a6b771e9c82c23b8e2b53ef92f4a857abcc2cd432bbd793b375c7dfc5e392338880363e107488190bad15ff9621d1bb3fe0b89263bc4aed4bbda8be04406f282d2c0ae3fb3c404899725f980cd0f62611aff1f1472388f6d3552c8db4bb685a1731c0fc0fb2c0454159fe90734618f8ef0ecca4138cb89e93d220abf12182427ddf32db9a8d290d1ca41722b5ac4b82ca7c5ff574b6f336db45e18c0716bf14f6950dc43534e9e10ee715a52629a3093c7e96d93adf514746aba2d27c1c6916d7c924f8e277250e4f551d5a113e0bbc622d385f3b77bd908a52bf2488e2b3d71e7a73dbcbb925aecc05cb4647a33e6861df8b95b8506e1e4f0aa484cb93ec2e82623ef855e83c8c6ed0741a4b92aef89d9239dedfdb451eff46e9c363162b15b3f62961419f4f201d81dcf24668e2b12e194176826c4070eadd61dda2582df1e73e1551873a20c33d17b8439efd458936f3357e5883af6a1887105c3cb419c213f89b8c77c340afad8a5553856d2ab5d5c86e72bf0f173bc62f21893090d5a6420f65075d151b4e7ad3b5d27e98815654e963aca48f28f26863b82664128e7e518d6896a056b7229d9c11214ebbfc082e2b78b8b74c771a04a6369a4495e128a7d4e30c6a2f844f140c06ee9281c624353d8243cd58649b38c0649d2f1071f70023b69f45d36918a0104216728532a291a435553d8d3b518148ac4fcc1b8343afdea45ab85e81d1e1f15a0a651ee7e399a156ba6e78df0117e36dac8ff7eed37c2036d36524d700dbbb5653fd74115aed0a9dcf8c61937d75a9bcb8e479850d12c26fad390ea5d328d7a7b3942d2a09f50fc9eaae351358776a404e52bc74d8e34f90c60c37c03422a1138d10dfde3a55b691b6dd5f4524b2efff8a5c67b2539da86d685c8b5a3f2527092dec27d5c5c458afeded7150eab03a313442350c27e92a9632a6f79d8d3b8f793e7d1fdae270a281115f8aa05fc59814eb47192a36a200c4bf87d1c0571326f752e39ac742483aac3ac076acb5501aa31c735b9335c3dbc86aafcf321654725acf8ac0824dad3e7e23609b378836dc6cc780158b3fc00240e1c059e7a8a5653dfea519cc1b280e6ef68b7b8687d785b91847b1b403b9253f14bcc7104ce2050e30fed4736ef7a5b7774408508556e80dc57d6c8efb093e0f15638ff3621a94d69ad8c404de9adf0effe2f95c6756d0c8a1b41e183157e80bd4aa1929f192f1903a0f3038350e7a95df7f53ed71e63a0884bf4ad856dd917325c32f5faf35ff38c32d8b8be23e3a6cb6d8220e0effd7e556440ac311f0679345e0179bf50a41833154c241df6d98d191b039f71ac1e8275497579321463ad77ee117bfdd57d1ae9b50d3b59f3eac2dacadda3d1745ce2a22fbc2fbcebbd6847896c02baed1889a050038df68f2460194983a21bad7580cb75ee4f447c09d7dea7ea01a10b8e8611458319da27d7b00d26beed5acd9e48d9df27ac0bf86a0016f3cd83204cd022b55f310b5a465718d11ac27dd35e4db1ad37cf0a567a405258c6b5e124414c7681e16d966b00de4146e258e4eb5912d0c3ab6a7e575c235f2654905ad9ff3cd8711ba41bcf998393b90e15f3c2a9d85ead7ca8a89fe06ecee2638bd3d356802e644e14a3a0b24e458e90463a79744fd6395124496c01e8e5b16af6398165fbb70febe66d70e254f54d5cf88014f3fccebcb751e8b3cc761e0d304a562be9ebd68aa38fd78b0d9f32fd5627d036331e0202aa624350a495ba7ea826787786ed61ae0f9c52c2562f22e923fd1338f63684215792500a958ff4965e1ff1808d4749ea8e5d2da02efc444fc5a69218a5f22bd7768f26501f8337c9cfc7087f90a6de5d49646915dc37d6d8dec9b24adfb6c66e2dc9b216e70ee14f2ee3cb80c3648d3547727a8c7392994b4f335789367d325269d601b01a31be9d2113fdf8905ecda3216a8a5633cfcc37bc6dcb3f74a94573a43dcb5cced6983f6c8712c3e6f21ac5a3fb7b7cd2d43ced66c1d4bd3b58f745bc32701e447685d776b3625fed98482a8d8ed55c72634b2fca22be268a22557e4e3b156ac5fe5fc4998c2ac1cb7a305c30bd9c15befe6f02dd110fab4093cd924301cbe7bb8c3efd451021deb199fe7d9104953a0cb912aa158988313aede1afce4640089ba694a4c1046dc545084c9237297550fbaad5a705c839e7591098b85367f7b8591734eab3b30e4f6fbee23eb393fd2ce0875d16e06f043b571543f215781f0a826b586c46cc568d7f255bd3b705336cbfb9f96a170877600c7f0662dc2274880fffd36d55a9abf45144d97097242264a30272ab831bd9eabe7f5d1946e11b80c04000353646b026fbe8c5d38a83015e0d282a5057e408f35104c00a9c6db624cc56ec81a53b7cfd5b5061e9bcfb672f9b616ad108209e097bf5a5542c7fd3c8a52810b4752060b08a217bb37bca6f8fe1e84dca4ae2da7d64c296cc22e5b0a87506b48b112cca3a9fafe590d0936efa6f10ceeb9ad94314f00edae396ea2ed13605aefd8545e031c55fa2bd2885264ba63e8d577372e1b25f4237c7a803d395255aa804b8b056304517ae5456e97fc96196a397e09b52ec38aafb3b71b7d50ca18f2314057b8b9977818f0d54b75f9860da90b0f48a95639f44418ff634abda6edc547641e792c8fc4806bd059cc7379cb7d6a2ded2399ea57f690843768df545a9c9e6e6f281d370af7a1fe348d0113b0674356d06b84d055cc9631db2997e8aded069948143f59daf06507c1e2a168847429ab387f61c22d1059d587d482bc04a8474f97713b8a7b0cd5634a78178db67ef50a1d63fe2a813aa93c71c6a74de58c888d4d26e776af4a04b0ba4920a861799e06aa6316c70aa7116f9c2093deba2cf7a0b3ba19289ed282e589602cb3d1bfe9a54bfaaa0aa452aafdf09e84fe10512ad6a0e248b848a5ebaa55df9991ab7c498f2ef3a8532ca37392064cd1b0d4a498e2263fbbbdedc0a7fb27352b8164327a6b7baed39069c634144689fb328f61f732f8de36f28a1923634a7362bec7fb7dac6e8c4c0982047d40e5f7ae5a0c122a067bbaf603083002fe737b3e2cf28dbc4be003565746bab59999b9d4819acb6c4b40c2faf681ca40e2d4e152d714b78918ca86da4b39c4fe31a2a3d696681700bfefea861f5b39ae2380c5972c04f1932f83f8e4c954e21482afb122a91dd16acf1d0fd7de67feb53c94c309bb51f3f0d284191bc1fc55a8d8d9cd2e8c807e54e073b27219f122b0f1e41371de6b0777b4547b73a814de19a7ff18ead3f5e4e49b1030ba87dc9876a1ee5493415f2c5a6a2fa95fa43fbb4a58efb3336dbae78b4841b1a6044cd59377fbd0de599faf5364be69fa06384350b5a90b2c6117cd38cf9194c25720231ff7d362c75698e8dedd0b233deb47c9f30502078317724a53d121e5003d2e08120f0719ec1e92abe28a0f101780758fb7ef52746ba23ec6750145b1d0888cb42282a138778aa497140494d76eacff9e65f3c85733cd65f93a67901a53cf1897de16a834672beae7d89b0b41e270bab61b48ba49f29dde67b959ba518a80fcd286920d3a0847e21bf0880e575f5171454a3a2f279ccd95e898ab2bc8bd54e3c2eedd57477f382458f789d2340c854db7899e42bdd08b5ffc3618f7b5c5fd7c08cb2b9235e4952f1bcac1bf80003082e1bc6f05665d28beb1177a9d827d236abc82679ec285b6f10352eaceb5421b653559c3b42a220449dcf732fabd273d2deea44f2db40153fa663e245beed8ce223a742689048e5b179e198076086d66464adef896183c8968ce31f722144d0547b883dfde3b5de73c84931060e5da3b6c21841c0e1ac57ed545b8d3d7828d2ea37ce5f320862fb53d766c944de1164ac9a67311057c449449d7052434c85248ddb5e0e85f851ef033c3fd713160f4245182b8f3edee40f05e3fedaa4be2d6b9b61cca8b036f3c9c5ea5ca5199056edb1d333d3919b8b8c876605f3d6318e39026808a2578810d5f478d4b1d52eceb5956150162fd2527da623c682336f3d183522004e75daac4429b3729b1ad2045bcf5343e16683b8f88edfa19e4ffa308d8171945a2683622ca13eb102f8876eedaaf06ab5f67aa98ec32c19a98879c2c9456df0d3e3dcab2781c16f26d28b9cd9a0c8658298a1bcae9266b8009a22309d5d67d23c9f8b2ebb5ae80ff6696f8d9eecf8b81968ee1ac5f3c9339218432f218bf266e896a6d1251d16e902481b0e1ba16a6400c3e22cdef3e2f80d6d55146f9229c13540ae84063b7a98c78b4319b107ab28dd39d9dd4c3361648fd054948f02f2326f3e42e55ffa1b251e70ccee8306803af8e28d95ed9f0a97160ac12b4d93f43b8dfc18c5475ab553c568d6200d67221380b8e2121d71905c45dafdbe8435ba56469aaa3abf6bfdfe6e8d32bfbb8e4a7f2eed402f6fc8a6410e82e890e2ac3a38143d2671c60f3946966f5b44bd123d5bb609642680e142136fd189abb90430a36497ca1522fa9affeb8e841e0333264727ed4e5cf46c750c3a588e1b6d3c79f4d1bf0ba1e2ca542e02e9b936fc4e396a0c557a7e87150db8c0427a44d6625c9caaf2c72809c5c353eeb8c8196aa88a8548b6fe0e93e27054fc778d0ade9f08cc082e12cf13be2529a48fd485bdfabd1a5c93d295907422024d0a235e189a6c35f75f880956b562bb12cf2a158f5b9987728b520a755442f72978384d0f5a2657cd69d478d571288433b6deec7dbd248639b720e5977f4514a2c5345da4a8e79921697890761f4eab6da1df27d73c266cd646bc37831b26e7433a4e4491b5bd07c6f547051ad133bfee407d65a8db4960464f338cd7195abe1e114998e2e411b757348827ec946c64150694ad50f7ab777a48d5d81290396b4d07cadb02642ab18b059db5c6cf39c942e9e3b0415812fa0f3066c7e739257a1f89b9ed7a988f0e3c9dab327a91f9cf4fa34f632650e19ad1bc2c864565189de63df1078afa26a131f5aa4d10c4862437d6b6875bda0dd6282155ce48a23f07c9e2f5b728b54912aadf3933e745d0cd963f10d6e7ab5d7eb460f6b2ae54a3424f2c8feee302959d4e6ed45968dc35cbd6a51a0ddde88717ca70f6ca31ebb7177c1bcfc622f967831295f0777f0cbdada48fd1967f74375f637b57ee3c92e274c06f62e16af67d2d7072bd3f721ff13fbd90c81a5d67071517f9836af197ba6f217e876398cb2f844fce080aee52898b1631c287847a9fd2d2f78d5c553398b89da6a0bca23b08bf2882b57ce44591a5a32cfeb970c549793e5f05d4bbc5cd925fd4110dfb33e8929e69e0435586f4620ff06efb4dd388533f5a68f10bae52ea3b139a0f956bc9a55f136b665f1d98f7b53c24e41f970018492ef2061ce035b4b95d27f8712980544d06a9fe2be7b0c5c06c9022373ed9962cc0286177f3197c59fd1e5136b6205b06244ab479535a3c3224a648b4993dbaa8e8fb8aef01d6449d690ebd9f57878282d8a599624e40759069cf6e80edab178067a5b3577d103930901d3849b4b3644b1ae5b5ea1ae99c60f1c5f93eb2d16d470e0ca8e138de04be523c996c31ea837d1892eeb15b31b663ee8e51a6d3b76f50f743c430e63863b461fd9fed965ecbba04b55bd3f509719a1decb3f30fa95b1b053896edc7d330234ff0c4c22bd12a784023dd95bde75eb7c78c481c2ac8d378b1077502e5444de987c0a1f5beb80fe97510a6c0200c50f83034d2725f5fa55ac5d88969260261a1e9a8193d83348a418191c55ea5033d065ea20799ebe6635d54f7abb2b6fa930a800b26c42595c2308f1de8b4a131049e1ea207ee613868715dac265488655c1ed0e32c97a69608c547b9febb86433c3cea3abac38f84e3ec50ab4f2f9d316c4f29878307e9dfd4aac23c12c69b48531129500c5eeae1669f7a5b54394040885fdf18e5c811b5c45e1b885893355f924ad19d40d3930f675f12c3dd8a910350637ea542e0d7d6b2bd648e6ed5dcb5d95032bb0fe1018570302b7734409e3a43474eafbd1b2bf1759a14dd30a016beb409ef37b7f8ffe6bd6e22c41fc003ffcc8a976dfa5bb85aac1147a9acb81c2e83b082ec53b467cf4f9e82dc0259dc64e13c7dfb20da3ee823bfe6df5d069962eba30d55d40cd78815168432da354563ee2cac456f05f61725a04025c35013d565e01dd1f5a3d73f33664b42a25040db2a27c94fa5d0dfd8d4216f44ba113908d4b2fe23ece71631c91e60ba7eddb7bb8e98454da3380d83f8837969a83c13c2d3a853f858fbafcf675c8a00fedafae468b0f20b0e5e97347540727c402fa9dc5e5d9a9497a360420f57585642837d5172bb58ce054f978c51c70e5f021de05810f5cbc0fe3c4dc8aa929a291f2f3b9419efae040addf9fca112067b46925e56879cedc42e603b85a7078ed06f587c971540cc11df91456473dcf395f238441dac88049cd3e681d5a87c50d0d5fcd34c6c61e9b629ab912a34d63f90eebcebe992e1728f7336bec5d135db5de90915c4645e5cb1bc6aba40641a91c471a3386ed062c7da90fa3962961a6f9f352c923c59ade84cfc184784b6d8689e96545dbc2e645ae2ad7d2e5e7331655850c49bbd06bbee91f00a2de460f58acca3da92517a4e4be540ba91e45a2fc744d0dd62281d401090f1fa5288a7d3f82b90ba085708a1f4b8304986af22cd7220f711e7cdf462d54961173b2ae9b643a9d2173e803d8b8a48c4176593754d6cfe2b4367a77bbb3a9c0199c4b020080ee96c1fa67ce401258c52a31a548e64cb1075b3d3517e00bdb86aaddcdfca8294a3bb1f7e7e47d7fa93a91aff73b1a2c59c8bdf8a496a583f48ac4dae4c1e5b0593bc6bcfe5448c612cdebcf2118d456e42bd86899d1edd62374b8ae3914b22b269c83cb945d5b18d14edc4c966aee6cfa1b7b7b7deae117fe0a8beb06da5d839e92d20f36d8fa8a56371e87476f3c16e79f9c00a6a2ea3e204dcdd0ae16f63da142e0cfc1cf1a93e42f4e21245c0682658725d3f2f6bac46cfb7e9657fce4dc1152383309c3f4777ac9a7a7e1f2a66d687d50667dc0974085c50692f40b4e414bb78a34bfdcc8aa38427ad616bc6a0216c26da82d905507d3f121ce6289f445f82f7ab10d2322684d36ed4c40f71af1296cb6e0d8b770f6c672d49d45ebed9f8581a88e0c6a92235d6b47c9b2a35517cd388dc81bef9f0934cbc2e5e784efc0defccb2a5fd002b4d40d550429cf29394835b37917c9771699c47d208fc685f2da2b7294a934cf177c1931dc6a41ecd4e1fa9fe3a8d81ed36c27e04c888de0c0fe5b29b9f224d3f3f87cf88a6d963d4a5ff0570abb88c99591965007282582a33393247d33ba6111087a95e1a2f6d6e2081653340ddc149b31c2f0bace751ba52ac89b734a732da7d3796244a5a8a8b1361da09a6c70ea4b32ba51cbc101e248f5e45d6eab11e55b325d1bd52f6ed6ad793bf35bf539121f5e969033519a9a3d93b53c841c702f346497d9ff40c39ebd7fb039986f6b44ccda58e1168f4b67e4a76233b082a5cb20f39888cc031acad28a2b6ec49fc43268465e7df431fa148058745801b204c2dbc2f07b1e24bb8a1f289939f8879aaaa1540af378d69bb3bcdd3fabefa05629994663e581a60df38190b460b296368b51fc3438eb787816007e31c400fc30787aeecd27736def585199a7059d0adb92cfba7194eb39eddef93872fef16695f3ca6aad715bb320d2339a154a11355e50d44b0c6df5724e8bb95edfda4390be87ead97085a8891831ceffd226af4ae02ab5832d24ed1becf402453777467fb27f79827cd163f3b84a00b787dbc1663d43c5169e63993e66a417ae1d170d2e8dcc6611c179fa97ce21b6fd43fb272b0205fd8430e488300587b0d70aa139c636ecd27b1ebb7f1404bb18568a7ee7c1aaea6be55abb21f42ea2332683c0bfe292ad237d286db00081049c3d07f95195ebb8194974055047e6f56a8d4bfd86f7eae35f6dcbe2cc811759146564a186e0ece5c08ad0381a49184fdc2387ee251eeb0c7ffb415186b9f9f741575533203845e012f27f42199c2a34a0e1f6c6a9a5eb3155cd6bff7b2bc90ccbaa158234ea12d04767d2410134a6b249537939bfb926024e1c2445b728dc369bd7741a2a7b6bd7f639ed2d926ecfc5484cb997d794f8a4ca320722fc18e325eb964425dc3c4ce16569ff38fcaf1efe6b3973674abb8381a04fe852a6c92007c60eba07b641e65cfab83b2819f8fbd028aa0cfaa6d25f72f87d1db40f2901c47d02af3959560504014e303ab5f2e51a923436234f129c0d5dd5bd3d6d8d1dae5eb984383a38315ab7aafbb044ec149ebe8452680926892d400262539f270ad4e01c0a1480583a1db0ddcff9b67cb610bae6551e87ed92fffe8206358f4d616bb285fcd86a05c6118648cfa0db2ed51b76ed48b0e47872b168045a600d8bacbdc1fdc5362ab6d5c8a9c2da490d656bd589a018ec28950b3ddfcf741973d8d206a84613caf8f5b88973755f03e420d2da20acfde7e1261ab8c21546d340d9045cf13acc5073a48c7f1df3c8a3af332c905c0d32036410e7dc88fba2cbda2986962ea511218617777c543c93cf249ac4c94e92be7fa62b05a00a1ff2cef5aead500dd1cf110540e113cd88adf63f7536f891adffb9882bca3cad460137e77f0a774f0433b8c5ac6ed707af3fa5ee4513ad00d925bf4478639d1fa6374bcb29f49f8a0c9064f8fed8ab95538bbe11977b30f658845f34018cca9bc72885698d03b91dbb48bf5914c79becc4f2e7e33c8dea487036bc611d831bc911d923820b624a57ed92c8bba1d94d1fa5d09b0387108ded617cf25e32d393769cdd08e106e25e6cbc22061fa02f78b418ac2345b7e8576416bb444696aff6e5d5bc04373f741307fe49b1d5f232bc833f2af1ba4a4f9534d6ed38f79fd98f7bd0d575c07fe32130af1863f5fc44a0583a96a3352c0250fcf81357d7e678c9db92c402f26b3f9280b1c78185206a5287aab85be21393cc284c05e440f1caddecc056ac67e4ade6649a5caf8dc0e0c2a54a8ef6ce75b37fd773bed466a127497ac0f453cbc6efbe6c7723d2b9daf7fd12c06b0af79e06289dec8d3247fa7bed2cc03d477249f8c8b8e743afce24f813584c6663ff193a5ff99a0a44cf83b084aa4809a6058c70c029fdf9c1a30525e0113a5588c4b3edd171513e4da16140f4026925bc4dea0c80fab713b74717f89fad4d259e2c325a06dae0bed4b1852baecdbca8aaf16baaf704e796b1e78e7e68a19a46d80586266408f0e0a9fe264bf2357d5f411c1a944057649a3868c978113abf32cea5ab8dbd5423365b83e4958f52707793c14c58d896f635770e120a22abeaa2fed720f1f2aa6596954766db34778e69f8237de91b9315492919fff9707668b6c254082684c11492cbb8f42b425fe012ad539949ab9b15ef52a1d598931653fbe6f871f557e66c45e58b5bb08aa68cf716995f97aa0adbd21cc0b79d6b8f3e353ca9e4955f3dc0a8b83b8bff650a6b3ede55f0760180f52070e61ac2fba878b84d3310ff84bcbc7876efe4df3193c6d8b127028b4691562fc6ec0b3e1c8f1e66f93b9a362ceff99883b061722b3b3f8590a1de3582b7206263ef0c231130cfa651a483796cb44da9e45cab1a9ee358375ac405e15fe26a866c40917a70895746da1ee0da371878bf42cc8f7573c1db4549d52641642aa0182f8ff79f0c558f63fb2ca81389502aadd1c37bbfd730b6abc006a7a40ff00693f014949d557ec32269a66e8f42a94a9b010f3222aee09bcd0f6f5384197d118bdf2cb17a9e5431ff33c55ccb2979b6577424a3ee4ffc276a8d161e756bdfe417a4186df25fa777f5fc9337c4012c32c93c8c90273494856ad3b332599dad2c7242f8b73ac46e4948a58fde93ab211aa8acf2a835d3ca43103ade737b3b2295b55684be4f91a791fbf9c7773348cfe5d01f38fe6a3ba8218cbbaf178cffb1753abf87e1f4dfab56eb41ca6271335221812e1c67f6683311f1351c3d001561f1b32151d5dadee41e8e41fde15260dd8098aa86787c5c1999ef016e360007ba973e217caa147620a01df1df23e23dab6f2343d13cb78ece16f098dfc143ef7ba8d679f9f0018bcaed812701b9b86450e382eba748a19eb02501f2e2bae38057cf6a71c29f98b45d6f423e7ec7baf3bad00e85b8879ff60220293dc55cce559b175c378b5908221558ae9ebd0e470b6b43ce596ee1e2025955d1e097aef0ae527a74c3f80345171ac22d8c2e33730b37fc5770030475b631e4afff4117ebe57ea45f5ac4c0949b184228d7d2cedf053097ac93e39dd66db0529041c4932635acc6ef7482d6f1dc59e3df23ecdf192ddd5fbce033a9645c5ed800b0fcaf4260234c03bfcd0d96742c9273daa131a969883f0629ebd4755e5bfb38f3a9da743eefcec876fcc811ec263abc1b997af0e91e232fe41073fc8df04c61b8d8d5e8a45a6ccbba2b6118a3578e2629d139493ea4887c180d26a31f1f875d169ee0885d40513ebca8606b481d19b4076de610382633abd6da4d9212c6a96dbd2fa3336797669ec052f399c9e97eb97474adfd7d1da709978eb298239601735809b0ccb80c62817183c438bf7ff2fe52c9abb596f361d1987e33015384f8915a650ae98f433dde35f279cabcc8b086ba31908b9097ca620e29db8f8b23636815c060badff3fe607dbbd9ac8c25d50fbc351e826c082740c3f350bc85adf8bfab56cdf515ae767ce1a96dd841b59a9c8568f99a0cb4a31e9c0ca9085942280cbd3e713b9941751bb786b2036dee5dd928022770521a1a6dfc39ab515d3caec9a50e33635a6978d6e09774b75067f1974a5bf159f361f40d711f9b2650a3b2f5536f6d70ebff5f7ccfbf79d074c397ded6cde4e9d24023500b7e1acfe8a359c416cbdebf7da7dfc6bc958352c57d0f2ec09fa02a199a548258d542f813c293a5d819ab19344452355a0bea224001c5e92511779aafac71b6dc5effc61bddaa44c0e7386e927700f044db7a39e6713af3e3222795885f4597d80c99892ccf73a9f2d478c4de40440cc8a8d4f51b64ba9181856a9dad40d4c19b27b1377f52405cd77e62e2d07c577d2076219c4af36b0ab2b005871f5feebb96bfb1df8c95aef9e306808751fb7c31b4550aee4f29f69c74d3072cc926b1697299a279d277a2988cfa70da583336f8d166a23d38254ba92bf0cf87395ddbc28d13675e3e469be4eb882992be13ac1bec2ae34939e054c7ac4ae140e696252262bd82d77ac0f4457e022889a485c6c8bc9bab01b58f9790b06bc5155691a3d57a9281a88bd6e9e95172fd0b4188b688486c95edc8dd268202b2a1c6e2c7b47a56eb51e93745f49576092b5ef5b3fc5d166581ab337bba2d937c5e5a697950f664116c1ab29e4ef66b22263e15ef5495060f23dd284b045f24d525529a1fa72c992c18c5a0bc91782ace81ad2884b34a7965e3df26b31fea415fc7ec1134473d6add2b3e5be87d64e8ac5eeaf296e3e28c9222d63b4e107bc747cf3ff224aed254bda1b65ca2fdd4ea75a9b6b0796572248a4299ffcff9b373c4ebfcfcb901ac4e9e87685c7515ed5dbc96988713d67d69da83204f77672d66fa032d7ddabddaa9dbba0f94b9cf900e3ee616f6d2ea6a5d65428214d55f4dca385877c1f6b3558b53f756416e3bdab7bf73f3307c33f8c27c727472378625bdc451a4edcc3e91e4a496e84ed1700bc41c683a5aab4fcc75b83bd2697a90a7483cf2cf58167ff9b72cc2c70815e56b0991b2ad3cdecbc45ea86faf4d6f1615d0464ec19a28ea1e66ee5caed02465bd41c0561c837c00398547708c461058353d32340665903f229851771e8f1d1dfea28b317a55e14e591d444e0973b9abb54f7a6cea324559d473b7bae78a466285e079162e145b70ff9db01973468ecb70614a42edaf759a16f563089aa0994d1f0b647f9ba7164010cff5c70b1a3f436217295800667af85fdd7b552484fcc8d6031b9df48ddef73c5556e3b44ede3396118674f2e2c6954c3c72a3204c8e3dd3a8d4c35e48d7f8cd580c4edde9e8fa4a0fa72de5137bc1f7e0dd4321e92c22fc94578d89c0924404781f81f04dfbf6e19d38854f3bed888d3d7b05b4e973cc760982a0918babb8a9eee47188c3f13fea43d9ff31bcfde0946ed9410394f7c5c00b1885d6174699f14925ec43143d7d159bd36f7f48cabf254bc9cae5767238bf27d4f1b6f050a716705dac61776914d1d50b6c2bdadbbf1d44fdf7baa89d52a567bf00836641c486bdccbf839b01acade9d983b81b3255c27003fe76f444e32f276502ca37a17ba414c6e4b5170ef03748af654e582ab1286e9dd501fd4be08b06830af98d6119b03a958781183e7d04da4d9c2950eebb64921d8c97d7e98a058a1bc168540f999532db7f60c2058a4ab2c28d489e0e5ea497430c36ca22d80dd06fb74f0c37a96b95a0a0e8b9d22d5dfc25e8a61ed9676bbfdfba83dddc734f748b5464c79701c73842b9759174c90c33a26b3f1f6d639b998c18d920101e642310c6619002712bc9e2d8c6390ae65b5b2b08fdd3140c28f87c9c4248c21d1669ee3c0a4e7d27cb9a6b6e92e3226537294dbde6fad5f43609dd78a26a0b0d12896189fec9651e3fe10811d07873aab97f98d8217f546e7635f19e09fd9de3a90be03614a3f2e56ae145eb894448ae21975f1c4b5c0adc8521e683a200fef575a2d27809ac58ed0c344f1a9cb542d17865838965511c730edf03ae7bbf5df57b361667834e67a445e0e2afc667ac764ce90902af483f7b4343ec5da8b2086888fd4ff17d942820289df9a9bedb2d290d82ab75ebffd3436eb3d086ea3e99cd65c70927fd366051c0e4ca07e4c386f68d8f45908f38d6f3dda1bc18712721ba3a9b65a638dc99e05acfb3c639c3757f7647351e808908a06c881923afa6d1d41d732529bd897bab8d07a75e37672daff3ce6b828ec93c265a1bb5f5db8bf2a0db0fa05eee96ccc8a3b452b7d64a71946609364050b9b7ec9a9e2cb08a5b849eea4d08e29891f5caea770aed90107f8380da8f125e152df9bed26207a11e6eac9806c3ccbd3499788e6ed39085ecaf1e8b5511a88fc7277d87d1663a65c9e69f603e0432b4b28c703ca097256a53e2cac482e047909fdeba3969b48939aec86cdbbb4aa5cb5d9858e74916012ad9c9e15ad64509ccb0e2c244450cd1e8d26e9e3246961fb67b7b551d008b981f127ad45dd722e45f6ef561ee92bc0f412008c3a56d15ba7f5d9c5d52d0f3644f50b557e8d1cbe5bdc2f4a9b924e39dd66800a4333ef74d5b654cb49348d86cadfdf2824294a33666f2ad1f26994630f59a46a63ff98bad9144bb28dc7abe7566fb4df895678f869886bb81b9a1f1826e480bbe94994b95786fb7344164ffe053fe33db48862f2430cd104dfab87050803c6a5df017339fd83349e8cb54197868b4ccdc8d4e37a9723794e578ed6832663e00f1f698b1f51f1f5abb5c626fd6fb8b63e71e61157eee57b72a7f23071b34c6737e6d31c680cd031712784e7811ea1ed9da0ecde1482fe0abbb3ce714d30ea974789aca1f2d22e6f7bf4c5e8521e9eaae61cf84ec222ae4742e16e0c92244684b485125a9275ef8e62f80ca03ce2dc830c88ecf6f4babaae2997218ad796a00b2fcac592dd5de1f804e5eb14e84d9800664a8f8d99ca61d7737937c9dc1701905b45c9e72dc0dfefc6c02e90cf74fb447f48efd00e0a7f826bbf4257f9e31e1ecf5ae085b846e2f47280c294944a2243f3b0aba7712eb034a5307a8bb28656dabec395a558f657b2b8e371217a63ea396459a3f1e83b209183807cb9d503b40acbf053aa9290ae024ee565f10793023e32cd2d5afbd7986a7ff8af0fdbbc0e5613f6069ad08e838c838a6a8aa1b59a6a806794a4156b227cb6e5efe24b5777fe3c4fcd47e56706a45ca6d49f7de64b2e9fcf9baaf590109a1552fccdf03c6e68723a29ba31b54160318d3ce15cd2903286f7dd01757a8e7058a36ab84812fbfa835ed4823eb6ef2e1c688050b619520bad2a72cef15649cd59af1934142d1049b8f2d7ff653d41bf289cf1b784fc664a30e128efbfa32b08519b8cc479cb1020e9366429c7128e84ba3845117c8e5744872caf6ddab0a515b353f53fc16fe730b997ba3b85e334363a5d01d17dffd95acae413287ec9bdf0a8373de56afc2b2b2b10abdbf9d9a88ff6adfa19d4170241f18b19bd453f73d6cdd68fbe0155115520ee2e735e13bd6ab4362d7803e571121b76e34593c90c293e57345f59349c3abb16a61227ed7b1408f8e8760a25a6a5e9782c98792586ceed7e18738d1bee8560c5217c88c96679960118f5622a3ec24e5295008eae25f0efb40d4d5e306033b8f7d99eebc87d9cc9faf3fdfc39269d438119e6a8528cceebfe11297a68354c5f682bb84e304ee0b585654bb3e2793a15a871f8e4aeb6747b69af7f2382e8236753f21ea5ee8a3e20dcd08648ce4234ee5bbca5aded3dd3fe9b9588763dcee2b1bb0d7f0c45f73de97269c8a9fadaf0c72db1ef8cd1dcf1b3fc9d14eb910ccb5bfb653222bea28289398b1e0c47e6ef82c15fb7d9204ec76fe3a073e7274611fdeaec2c8f7a2c1027ba139f38b4b50587a6b1d13db9f83eff49d201bf4d088758153cb37353c20d7a7fb619eaa78118e1e599e49090e7fb684e25195e5b5b242e4bc36d0f81c908416de5d24bba175ba2efd4fb416cdbda6d280183073fa0544635be947b35fab8445f041131b982ce3d9153a2ff71c29b2eb1a493bce1262783df75dc01b27405fbef61c56be3a560f8698ababfb332286bf51d3291fa7157ec8297ee66e175d18f1fba745ec11dc4e10c02cc236fb78396bb163089989dc716f7c573c49b41d989d5c1d0d48e504dcbbc3fe5862849afad8ea13b8d5a7816ac00715d7b5668a3bf8eecb61786de17a5d8dad7174ff6a9133582b9bb67bd16596a1b28d196cc7f210ad251e9deda0dac1ca5e50acad5cac6bb0278a5daf0f5ae5a18470e0021fd9f5db27c80fb23abb416f100be867d43c0b489a93e43c8b674f519fb2a60683550496d05d32e153006d2bd71ea26b4fb9a9093ff053c852beb1c983c762730b5ab506efe0b10818516f71b2316bd854b5b759dde49758ac8a28c171cd473baa856b53546d48df60c8a08fb1f8f351fa9c2b1e52ecabbacf2882cacc8865b9d93da7aed0c572e06333f7d5ff7d30983b2654e62ea3bc0aefd6e8fab227a913ec7b523329b77652e448b5de2f54b91be87f657e172c0b27d17e0c9885d6eb2a2646c5322ce39c008483df8fde18e93e982fbd0e043be2a2be0e679848ac0174aba1c2a3de2417b1f92f63a320d264e3d56d07c6cba70f4bcc1e327e097e65d9d213aa3516d2086d9eff5abbc2830034ed2d1b8b6799739befff0ae0cb4bb1371ebf7ddf39189bc0167c3bdc186a486591ac38b679f3c639e5db42fc3f0e7f16214c0e110530744f814ba85e3daaad1abb43154c18bb723b16d82a732262058b2e429c0367539659cdb9bc28ddc5e5ce25a8a152466ac964a8ab8f84cd4e70b92dc7791fb8e7b2cf58774662764215c11fa115f99b46dfd4930aeb5640234cef5232e6c4c197bea199bc7fc957c7def7146c2a134225e161d68b504fe7aaa479353adb4f7585caaaa922c5632ef442b383695d87f0051ff6adc8865a371f6e2380500d997709099acde0df8ad692aab000ae2c7ee4e2054db667d983340c6709d29b092c74c2cd425023a279ed21a54a842721824f13f7c1ffa7f4b680ab68ddb52873916f207a4b72299beddd7b15a138a3857b9961523bc88070551fa742c9c1cff7470649c6ef27c25f9caa438d6225558ba5e233851a93f0a313d548faf8a7a3992a9ace2e314a410f462690f620307032fd9740158a2f043d8353ec449f8cf0bcfe5ab4e0289cfddbb49d0d86922c5e577ffc1cb73548fc2e10efb3b61dd5143946d82d634ca6e8b48f3c66f9900b5a76a336572293d7c72e37a1226a7320e60b6669bfd062d21bb7342a38cd5eb9afff73251de6c9b1acd19f9a288eef97179c8c7ef1f4d87566e4f6938a89b6c963b403fcc9bbb66c9fae2085b3fdb2f8e5600e6da14e044f692731bf132fd07fc4e959ebf81b54573466c34d70febe37dc7605b0be4918a98bc8b2df664b599202b6f8689bcf6dfa11063ef95343db9cc5041f4bf4e14b151904df87f0f188442e96ae0db1771e6e6c94fe12a42063d7f940b171fa6a33f9c93ad6b7eb3a37a77be4be7bd85b412c815ad1560067b5774510a36d2e8aa21a356329613f57a64eef87b598b443e8f743e625f17fa9a4a2a6eb5b1914208dc23fb53b5482525db145a1a1ac862ecc4b7be3048ca2c76776b687f46a504f3b0102be8e7ac9c2e0360fe54403ca38eb08f5fa83ef52064e03d01fce6bea7ab9011ad771cdaebf8ca4e1c4d3bc600a5f778c5870a752826518db9152533553a76e27afe2de7934ccc8e8755aedcd805a9150fe064450343facdd5ebc570601e85e8a2c3786f79083a1b200f3f361c7aca62ded3ac53237dc3bbd3d814883a21491fdc6683fbefe046a5b3a42a43a5035e6df5faa1ea04fdea6db4c99a0c0097dc0f816a4f2b3292796761542f611e1c21892853ff8770851127079c0e0ded841dae659de13567224e5722a49a7cf2d661fa17782c89e87e2ae0939a622638c31adabad1283bf3185fc679456479b446be3402d1e9d9020d46514f8ba1181b59ddb75d1e72e30d44d0b607b98491409158e0bf857fa7cc61243c84649591035993b28440c8e618a31550868fa59511d47618133718ed290737e937dc405e840dbdf860ae4fb9b7770534817694e1e09dfe58e7cb03891e6b2be6da8ef0da40c77d12c5b55f495c3594a2259ae2870c7bdc33400fae4f9768c602c837915bc73f177948e38b125b194b192813be32f26074eea55a9265a021233667be208f9d09b8765ba142b25575ec472c0f8a258aaaa47a3b2071d71cbc8a4a640ce93ae314b74fb953ab16399e86e938e867082ea09ead739d6e4402a7b3857d0128726603663b12cb5f3600bd8c9859bb89b72ffe924ac49a330c9bddb2703b49fd0fdfef27b240bb8c24bf51bbadb8f971b3a2cdaf7c4fde73282fa690d39fa9bd04c981e8ef438cb63cf1775d1dc1673dc0d0c1f8a5659edb1c5238e24b47c0949c6659187fecf85f8dc0023ebdc8665443c76c16c81996733bfb2cfc286499362d6199029d4382ce31583df56aeb80d52e9294504dd30e44f12b630c066a21e359c659e40a9e2ab135f44cc997bfb9c97d87ec9cb979cf97fb78a1378cd149bef72a074b0a0301cb383e073c19d8d333ab6b364a8c417a7eb07a9b38b33d51ab35b463a8b75adc0ae67661ef80f0386dd2c0a75d7317ebbc5e456f2efe48871c7ab790589d2a61602a1455ef3e4dd1a298e66604473e8be23daa91c062139c9440e316de90d98b4f4a07f0513ef702c2ccd99331e7e25631383520f03dfb10894b86f9d44df33943ee8989d5d534b73f626da021c82aa5b0bcddc3fec9ece93691645ce8cf59c4b2b0e0461ef6c09666a3c98d18f31929154dacc8b31670addc9dd25038541cb847872be2d31221ad426e303ba789f8dc80fa3386c45edc7d2718a9139d987f2834aa51b45bdcded772eec3f06f3383ed711c324bb6bdfc40c86ec9b12ad25408cb200af6b3dbd4d9c80ef86c358f37e6659a4b7fba846b7aecafc669a7a74976db081c36db035200c2babb93d1e3c3a2e4b0e6fbd7c2801d551f9c0a61d74515f09a3d3265702fd71297d465a603fec829b19c4e0eb5ff44b6ebed459a8dbc4917e25332a8f21734c79376bc6335096952f20e8518ecf54326754c6cce38f24d942a28dbd34799a0465b4e4a9b6603d2a7d0e01e0cf8de9dc9cdfd31c6c69bebd8b8fda63ba89e61dd742de9d768d64ed2bd14b74f717cefaf33b8f7eaaa2704584098077302e1082694724e7a2798a68d4dccce1eb0d5328813c575fc2c6968b5b88c699ae094484f4249d1d23f2c6956f7b8b19ac40beebea1846174c562d0a805e9d2e28ed1aa84386116e7acd6c8ff2191bfcb003b83e130c5c2572ba946ab7311632cf1f5c17fc68ce91cd58442d34e6d43b12e135304f03e3047c93726b430311771e95191217896d42e864cea9a2fbca88d185b6c9b74198e16546d71d49b160d7eaafa30e86de101dc21bc6b6ee05295a001959d3b9566f03f9ca8822d7249c691d66077d6da6744bce8812152964bffc00ed2c576b7a73dacdaae6355f582fe8297be8378706f82d892cc7ca1e083fb5021562c20a8ac7c20ad133c3f8804eb20424f417ec5b04ca2ab468ae87de819aa9d9b13e488b2f5b45e826a86e72f444bb2279bfe16798e3f1765d9ef42e8adce3433f22f2392fbd98cdf4a1bd35ab7400b0d9a4231626f82a5618bae5782a2ed1b1fbb9c9a727bf829d67a9f7185c0a96b56b284fc9cf9b0243f056876e7d1d433f94af61b434a7b0ceead1698d360cbf961622252b734c4c981bc8cf5777f55ac9022c8fffbebe3d98a4b2752aeb0c4bb4b30e03d98dff328f18f57abb6e73c86d66a0b7f1de5ac73cf85e87b51e99f1d69c50e67af199d7656424cb1ca0b806c24d2d31b7505c9cef3f26e99dd86391156694fe17ff9dea7a4d671b587f17d5f3130bc41169c74cd1dcf270024fab9837d56f89f6dad67f5d109df5b58daa12a36e316cabdf9fa80fc07c9b88cef77f3bd3526b4c1abe41f18960ea1105756ddea8ad052d235f1fd7e880d322a11a0603da6450d808880c55f4398aea51f6dfc3ad99e1e4063f5be7457c07c49dc8d993124958407d9cb0565dfee60df66fccc7e50b9c8c1342f9026aee9b5a9d12eeb0650296cf4a5d5c6a3965adb14a163c711130ecbbfe748028c64fde72c54cea63297a1a826372838f777a720ac24930df26f7356f08ebea4f1fbcf8dc0ea80095a4abda7b2d893eb6c80447f8be4601ded3ca695e0955f5f307c17a6854ad43217c2ff6efddc458af1bd7e84cdb4389e6d767943c34b854fb4a0962366ade2383245009e470b18f52bb66c47aee60ea8030c9ed75d4873c9f849614d2998eef6e2cd54e5934e34a07096234952a67d71bd38cc9b3c008b652ab50fcc052f2fbb078eb5a1bb9a161b9fdc6e9972e28bb9b3ba631b62487fbdc46f29d358efe5ca1f6e72bc069a79db13e590842d6747bcde0a7350a95bac4a9cd0ddcbfe6d4671c128a0c4dd05ef7c0509d12639de8b8c5ab05860014a6fbec85e804e250203ae9e34183439e0e033fae9db8391028bfcc6a18bae2d51de26a5eccd1e995696f684e93307fd54063161fd572914d4cea004cbc7321203e42908d9fd53c32e7fde28d6e815e065e05759693bf26f6c9aa977ecc3c19ee04f10d81b98e6ea787f65686da29d2a3e488951e4cb5bcd122ac7f12ab923f78700c611bcb1da7c09d7d10854af384272aa233908a7e2d4074daab22b6620fde25c0855423e09ce3c4304a13974e479c3ddae4bfe884b08c2f2fc7b3b708c894894322272372f07d275c2b3f6fbf2b606fff881022b73fb15972e0f0e09cadb15d35cb664de0578fa363853502126b09455b6df8f511307543abeaf9095f3f238f0c5cee57121cade8e4bab30f19365fa812008904508496aeb5deffbad4a9b94f038095c40cf611222944e95bbfaff459f3e948a31261fb8ab5457aaa5b15802f7d887bbc892c1949a9111158f8ee1860f0d4f531185a15b6fe698f2ac914fad091dac41f998d15abf1457bc21f50b96a7626ecf2739c756ac7f3e0d1683864d57a5214e7d306d3e0331817cb90fe251a3b5da99475396d1be33b352713b148bd3c8c2cc9b3321bb188011da26ec990d2c2853fa9326b79a424f58c33aaa785b5f5a300a33b6188fe94050e43185ba99134d53a3d048f64b358675d71199ba69b0b4be07b6d8fad70e05d765e7b9325a95ca0da39bcb252b885e45d71ee70b8de68f65fbffff82d31a4d467597fde569efcb3249e89ec6d2d5aa94805f35da86a7d9bd3f0a94c250b8127d57cacbdda1c6c7a481ded33c4338d5f2d322cd6d586af77d8ce8704e63ad7979364cda8f77115b2c9918d7ea0209d6d1509bdef595d20993f7c780578fc261e219e06595d33a0670014eb0cf6e45aa45135be3fd99745ede870fd3161d6509a7b594ab48f5fad4a27aeb828e3a47f3de95b6c66749f423638d7bdda79111b096b17bc0a580a8547cdf1a7be3ba5d020c49157e141444af06515477a8760f1beb0f54324f532a4c2b6ca3370deb34a71f488f2db5068b4ad5ff67dbd5859c60e1bedb10fd8b9a91763a5732cbc0b62bc87874f016b33eaac37ef507f8228f0b21084885bb47b1205d7b497e037911b001157fbd7e908ab07a9a0e57fa9c3b72c14151807346bc55f066114516f23262e18e0732c8f882ed14b44fad9e1cf5c8f2c4eb12c0c4618a614f4d30a5a620f73637e7b2b53bde3d68c46f9f85df4afbf1c2762ca493b19ab35397e6b935e5445a8864e65337f1ddc98a17e7300c24f7316346cd13c12c4e3e1be0131e7732f9a6734a397775ae12d000c58b764b323da09640808433809e17fcab0e870169cc02326e3a3a4671e645823fd491aacd91a645c1b40ede95c9a29ca7bcdf6402343524eef230c4c443a9a53eea987df41c001f9a321f4ebb9ad346d940b5e8ac823bc81f6eaab3de14bac0d823a6162118158b7744e65eaa8b7223098cf18abb81e56f970a82c143db66fa17e2ba7a0530549b7b7e956e88367b0470acba112a2cadae52c90b1074ff66bd26c52c4d2dafe43843828e456ba9e111ec93ef77cb5acf4b35e70c44c04c34e841e8c1ff4d2a8e4d5767ad728a24904ac5c0e31c966265eac55ac60a1b438b2f7ccda3c31aeb72ed97aa6746e8a753d4002700c4f16766e67973429f34829907964e681032b8298262aee9b9d0f6bc688a945154591818f6d10dc2a651b21328567dcc01d85641bf8efde476b5823a0875613e5c6903991d73f1a3b573a4c6303b06d0e7453f5372bb37ddd38c2a78218c5b3f51aa473b89c33d7ce68d221359b2bba06ad5903510d52d99809c1fd7d870f57fd35bd7c2b67c49a7af7be1059ad2312fe975750512e7da09ba68e9751e9782e749ccbf96e76fdc7fe983e9b7645fa384c794f5224ed605e2b726921cb686c845c15f1d17bfdb11f721d03c23fdb1efa5c367192efa463fe562d4f8df7dee93d72c84366717e0908052fccde3eb92608c7bbb9d7eef550834e6488bacefbd9219f53c4913d6f220294a8ae9cd8c798704a71ee46d4847176224b5348ff2db0312aa71a63f790a77e9ddf04248725ce2f4e3e373470b700acebd04cbb9e160246b2503364001069876278128b7a3579efa03fcfb9701fd1250438e613caab37fd6e711efb1a1795b8cc30405aa1f1556aa693b54bf238da84edfbfe4463a899a13685826210f9d683cf2446d13672490d48df89ab2b1990cd3c0a277a532d0521108b880ac7180466a4b6b9644482d992d1ae6dd62a8c80f21d77e7609c9fab493178f0d7f7896efa7df54f62b02a04ab9a2d97628eeb700bb389f17e0d3101b82f0b87afd9ec187f74c9f810c78a662d5c1484380842373a6ff02f4db6fb0c8e8c1ce41f4284be94beebb6b84d5c8c0adba996da735e28e08d82679a107a84ce3919ca7ca7ffeb010c22064534d2cca44dd3eb801ca8a632c8a1dd346857b441d321a1021227df254e7cdb0ccd7b5efa59eb22766df5140406c6c5c6116c8b8e15e9d2e3b7a70182bbbf9ea542d7d8cbd6004f5b808f9c42fe78fb7adb66329923c7d322f6dcd22a65f7468fcbe26d1ddd3bd3d1b6e5606a59083a24eaeef091a0de1f5c7c402e91d96478cf5d2d84f747bb012696362f04b851305cf59b5220bb30202437be4e4cc6291efabf2ce8a473d7cc9b4bf03c2933fe7616cd75eac2b543ca04dcb1397590674ccfa760295592d12aec8bdf73906ee8959c491caf09769e65468e08d85c4a2aafa55ead2aa13bf10663e9e0cc31b9d9dfdd3443ff06838160674a73f84398e6d31d92af4b9c9b6e16596802eb0e0a98c32581ae422205991e883881a9ec3f5aa47aecaa800e1b50b45f7eba0851f8dd0b40915bfe9396f3aeacea34673097a5fe1edd774764687373c36b51812a5de952626f9cb199aab2525bd0bf1ced7fa64067edcb593375da16cf808af11c29c18b18075b9319cfbfe4d131c59ed60960524b23f9281722d16a57bf921d1e837b0ab317c5efbbdf83a810b38ef2f9e9a6d3abac03b8fec29b6e6d6e3de8060388fbc0426734ad45197f5b75eb299869e8d1948e85e0db20ff3d7d799270340e18944d55a995c343018984dbc549c15774f1a2291b67f93baa05cfe758429dadfb3082e4e6dcd3c92c31db31349a9154b45faa98d026b21f4916f7251f907b29046c8ba346c5ed8553d38f6619dd0dc05fb314797f429eb585e5861ce9cb067765307b955191a11dba751a9bdd8d348764cf32fe63a305f21ba84e7118c8a7a1f60879dbdc63fc589c5b4d9f9eb050a725a0a3455a1aa39e5608a3068b33e2e89a9e6e6473d59534e7d362e90e7dd34d9f348dac72983215c69987c5ce14952eea351c9fcb8ba1a8465b7e06366badea48b49a6e632de4981470b987aaf72fe25f1a08a993dc00d76a4763131c7175e6362e3d3a429961cc707b4e6a18de4829006c2eaec98402d6138b489b3bdd82f845416c6be412b474844d5e6211e72ed9b1347188bf852d5f67cf7b74cebcc49aebb617d6f33e93cf04020fee89f8bf06f56a7a1abf267c726cbdbc613a9bf43b8420ebf3d585602da8fa930bf1e70868cbc7e523a7cb5111fbeea17371cf17f18013cde0634f386dc0daac7b891f0a7f16ddb533037755a6e3c2235c61689579f7076bec487a73e40d8d7205cb804b1c1d04cdc62aba6fceec4f7d1567423412cb9bf98fd2c6be070ce1444e3a01b4d9085a77e42678a944d65f64879ca18709c6c6f42243cca94a7c25e8d9312a564b846e2b52788b3c1f51abbc59f38e7819fad7b146ffbf66fc6b159546282a17f4861422118659ccea3832c4aa843fdff2c9fd8bb25de55c077e6809988d8752a26391d421f2cb6ae360254d040a842edba52b74a7cf7818efd77078ac0f3b21ecf1003f1d602e75d31fd05c59e11724d4afe7244ee62453d9c0441015531ff2b7da588366115a4042b3a6b68975f03a851e86777e5e2712dcaef3d8f1b1d0235d094260dad538137c8dbb3ace6ea779d5cd97c8de4a008e658470cec33e10a39ef53f3d440f8989ec95f25f4e4c737508234f753024aa89e261c57d1d699273306ce51d2bdf9ee0d905beccb80487f5e09c538ee3ecf3015c3bd9fff119e993ca7418e0c62ce668b4dcd92c35acc2aada0051c0924fdd3dae75b5363199746fb91f397134a298c992aeeca1b3bd496aa2c6c0df419ec23733b49891c148378b32f9e7ac743a3f53e294660b2946f4969f2b0837712cdccccc32143a7d31627b735de0ecda18b66606d591c900c913f14cde16c1356672da5dcef6e18a33f41ce59bd6099c96a6f1fcc909e36ce5b11ed22359b3f2470d7aa9cad27718c9b11ddc7669903a55c47aed390ad7f4c1ac5f9280b3cc5674dd19bfa2db88b689da9b3834b477f1bfaffb2444519db844e93bfc7b57bd3d999bd7e788daa5bb9570ac9784c65d061dbbbf6df3ebbc8c1eddda6f9eb9e79d899b99dbb437d2ae931d156b3a4f2c873dffc4a62ded81179ebcb6b278828668cfd2e3e9b45ee169a1fd13ac9373b6623985ba43611976a997cc9136c39c65d334467d168921a09fb0c3faf5555928a522a83749dc10066e384df591aba52316e54921e3c068ec9d1ecb31d899d78d6ade095f20eec20693e3a33bfaaabd4491d3535d2df8d401855634d16752c3d23b0c5d274076d53458280425085ea482ba45879067271922134713e66acc13480742af95d9ef3d5553b9efb2a6aeabd6b09d671a1792bfa22983d9878b843889c4768c853617d53a3b93eb7b8ddbb1876ad5ed0b5b5c7e2b5bad45b9b528880b7ee76e48db7bc9c44e6b99b16fd74a89c6386bd81d0c067f0fe476e523ba0235d0752b9e3ae58ab84724d3e8fef91744c9fe337301258df905fd8761695d8fa0b43365994f2b60897d5894ff3cbd6110b5724408562a3cd4afb115fa897d13538ecda93fabe79352c49fe6cedb7b44a638d484ca9ca720cab5114b73ba1d63cd32f6b6bebd2b38d322549762885e7a7ebbf20b3b18990f450aa31f5c30512e95a0676c06d8f58d5625d53392df9c5f4ff5d0c1a78e993f5bb39574a360aea611af9efafb8beb2a79b27356410548cb21a19464bcda7dd6b743aca9507402c6f6cbf6714be1130545c71d746d34d39db9a178bd52e2f6ea32d9026f80dc0c4db4bccf95731bf3095f93269b0cabc0a7ed085e1314690dde00bc49bf99b5c4eb76044e73d7551ca0a4ecdcd8887cd833096ae983eb1aad37de419f3697abb369097724b4e4e82b8cd5d8b47924d586847ca1f2f8c93f7a90ef28c22d277a9996a441df8ead08075483b36229623cd248983e570aa9d0308cf2c9715313253b18c733e8fa267109af6a8a55bd7ad9df44e0e51ef6f989ed1c09fe822596f012f92c114fcf6142606e34e60b0b77c69f998c80f3e6539df787a2259083ae41ee571ab19a781ea989aba5ac5420ec5e7f954449cc36ed37eed96ea805c019e6040054b129fac9c0169b2dd8d12ed15d22326390fa4552f215e6e4b36cbc2dff61eafda5442530f9690c09bb05f1a281b49607a08be547085b22e75e027b3b32413db2d173f0bc213796b2c52614e80066adfe085d2323412c063a15079b2825d72b383f12bc0faf3847e5440c33e93e096d1580d44f5f65fc210343feabc070d770a6a96fe199ae9d3fbb79575c995552f2ebbcb8b716e0505ff78f36021e29580b9690e46d8dd6cb4b98e5e32b2f52d422fcc66056bb1bd84c63b2f23bfde6e4c4e4855c548a1a83185d3e1981b8734ec185d0996eae788708e57b6521348b00040aa2c3b7df166fac8f5e4d55caab46d705c3775e017ec2c4da7714d6c462f272d71b718e329caba5ed550a1f9f67c6e375ff17df85b13d4ef47a5c0114dffdd68cd690b573d77eae8e322e99304c454b87350f104f98652e590096c961adfc0fb5e0026e179505af835f14c5aca6fbacce9dddfa29a67bfb48068dc3eebb0432176886214ffeb9548097ba3ec467de72e218a05efb3ac719f94f21cfb81a586bbe02aa4f1e0edbf2393c6bc8a5c3973006d17488a7e489c8a32b51dee31a53aa5f0d0efd4f72e5324e56adeeb3c6c8c2ebfb4633bd5eaf0924d0c0b53e25a5d30c17483757cc79af622064489b6ccfbd204cee57a49f3899bcb6b4c32ad632d2e9c3e668496a4517647f93324ae6339d646cbb987589c459f5bfa24646f7a0c474b2689258d699c0b2e6afeeb28788bb4e37bb41775ee0f5befc84dc55c84955dddaf3191703356024590b242bd8427ff56a1e560bed7a8239db831bbe91aca78ce0d4941685724514a227b6409bd0ceb53954fc92573dfbdac6bd7d32f4eeffc0f423e2691855b8cf502c60a0d52690180bf1ca8593f38de1d0ca824357c9a1599d809a448470d4883912ee5e61713ff8aed8dc76b8d83135b1ae7d136cb96430cb36691a5a4fb4f953a290ec48d043d4fc5785b76b05fa18a01f15588b5e266e8fbbdaec8d814ae518f96424facb5e5f832cc5424e6005f9f69fe56c3db5cdc077a90547217a69bbeb9857440d25b9a4f28d53ea293236fcf6530b0a800fbd2f9286b261493e1b73c4e1d7c12d9a3466f8a1a8334326d5cbcbc1eca4d2c1fe549540f5dee61706ffe786ec1f22ac8dc0dc450c8097114edcac244d712c930157451c1102671d1786c6f5be46c4913d7357b1b7cb40246814d16d6c62c756d75b26a3aec925a1efb73d5f9577c69f13d58539bfabe51305dd04bbabb52b35ab46d928a60a709eee07c1812ca48792b934f70df5c3cf27c2055034feff374b5ab7f33d94738be0cb494d0f7f3724fdb4bb02a912dd430d7c4d37a8b4b7dc1eba50b4913aae36600d82905d4f66d83b3846261ffb99bc39fca2beaba9bfedc518282e19172173a3a9ac948ca792fa1f36956e752a5c7d72f6cff76f78adcdf7c73add1959ff3c8a4a9daec076f6c5fe9b064b8abb0b826937087c41836e0880df7ff7d58a8d79d21bc08cb91d7e431818270d31baf9f82bd8bc01c713a99059adadd6f83bb10f09b63428b45357012d80c9575474900185cebf77cd6874ad63ee8caa76dddae1b154e0bed79d3a31cf5cc1b551b4e2e751e6ab1f3160dbe23f3120945ef162e9e53ec2fd0d6956f3d6ae742fa0729ffc648a7062144c3498c9090c9207422b12409599611685acfa4a396352c6ed286f87bb83c2d295fed5d4b7e241dde59c3d705f40602ba59116153cd4791ed38959db025138ac46bb5be3a353618b2eb80c1b58e09841d8cc48aba15983c0c07f739c9f3c8f8822ec52abc454e2bb24fc2f1786b6cacfc49639498cfa70d3b946a5b0fdc457f6610488501372bab0f5c7236941721fbd84c611008658bf1ce463e5757dbce18d1f0bbdc5778e8785befa8b88a604eb7aebd6fc1da690f953bed7b1ab581d674072ac2163cf68fcb8a6ff876b461d63267097707de358fd01f883f68841c6f762b85bdf2decbc1ecd0c4738877059107729777b2cccd4073e1c85d293ae18d1f2e6c12a680ebe4ddd97336b9e7dfd4ee42eaa3fb9ec50126dff6c099435b0f87cf7288dc25663b73d5e19fce9d2aab489279eeb6437fe3b2b439805ca687b8a36a7f7f9b3f8342c09a07678443e2241babacb1cc60040c4e1f276a8ae3011ef964c90c3ce8dc2ed822a582c3acba47773d6835c328ec6934e9b2789c7ee8bcc9bcd1466512286cdc690c299ff7d4dd6b347f3fbd880e76d43e4c5fd563366becc34e3e6e95d91b0f39f8f7b0e6b106de6a19470dbbdc11508fcd63a98af22eb3f0071c9941f12d085065022a4bd6d5b33a2a4ffa57e4506fb5abeaa3a218bfbbd722ed9fac18e6ba69ea5560b388c73eed2170e79f5fccac3e7255195e2676c55d24806db20dabb7a7b7166ce2b804f341a82efcd7e597f1856af3ece2652a43edfd7c2a6ab65c39f9a0699e2d12d00775a71e6ae4b745f28dfe962993971ca849f78a8964e5d4c8cd35122d614222b3d077e2facc1fef23d4ea565a93ea494d966c5d887584b5e01fb5f444c384e4e6dbea5eb5d849cf4bb643d506ac8d899ac2846b2f8cd479ac4438d707ff89f49e8596636b2498475a998a06cd75563c0f11b5e7092c17385df96410d96499bd723780b1c5e57c8f9e50a417114fbba0ffde5390a49692854e2bbae6df0f8bb1e7692ced1a7fea149203de72e0cb17fd0583e74704e3f2698328caa99359e6e1b07fb71eb2927ee215732ba7eb1e7a5371c63d9362289b3546f0f454d2891f448c90449fab8937cf9371c358beb55efb0a270c639b6206da9e68f974d9a0eef00bd4ce9be608b822b6d3d7e1d45892ffe3e255472b8ed10cb8036610c47a9fcf964b3f164918af33e01e5ec316e51a564385100b9c58d2fa4a42bfb98b513856b815d73fba07266a5e00ba215527ebda03cc84a7664f22eeab8fead99998c54fbc6a5950db45cb9a51f1cf603277ff15330651f6b2334da8574fc8a8250d534ea9d1d710bab941b1447891d3764c52dce11be0994b9625e6b2dc0f1ddfb5f8d99c5edde3694e01f3bbed44d0d2f18b42556749f270f518367d400b643cc1253d34999fa5c7b3597f0c1d24c07f65bb879d37941988970bd1aa4ec257abe7b15faa6e96801c68362a2385fd03027187c407ce626a01f55b3f997a73a88209f397b9bc1eab12bd995837d582c3bfea889c97989843eaedbb009f87c4fb6ea219dcb72136bcb69536c34061cbb9391e90f7002b94c983ac6d19858baa5349ec7d245e9126188315c87512b42f61ac4d06eea70d58dfc31b8e06a7fcd1c31c51cd9c855284ea7b9c2cef5115c83f672e26531ae1bc53df6c73e9c60988cc088b785c199e0741283b1e7e673549f15b7892aaec7a3c2228ab80cd3fc87425ab6b1abc6af0f2625019bd5980303c6936d3285a9384aa9129b2ae7cea55e11f01c11ac1e567c46810f546fbb3a38721554b74866631aecec91e24dccc8533319868767ea6e672d9a808ae9b250e56eacbb2f07b1c5720d45fabf265d27cd8ea1b3db18083b46a775f19bf7f1625259d8357bb0992727e6202a6ca339d3523bfb8afa0e3b0bc82bb8561a4c6621b68a5caa0750ac63beb629882dcebd6c4e2aa5246f18c800cea31e98b52925a1c334bd9785af6660b71aed24a1c9f14bebc1ef05c40b8324d0e2fdb85a876070cb6f717f982b3645f77b97f04c0ac1f40aaf1994369be0d2489a2b09bcc4090e35a458328bcc63b3176c00892c64d676fbaa50d2a487503c341878cf09e88a7e54c23366581647a204f9647f6747a1022a37f61714fa2623cf80edb7276686c38d5035c8511c7242d5fa957758ef108a7a20581a3e57fbe9b46860a2ee19be0ccd0c8ed24889eee7078d502bae5d065547777175ed9ea471daf60d4e44140d7ce6a93ed0489b0f035d7c9adcbe51b60b2fd6a70afc10be60197ff3323113bbfe11c6d627954006ada6df3ed8b1e3b046948d280f3d5da27b3763afe8b855ea45e3e1c93deeba577adee68c061488e5b1f5b4621716d7ad49887dd49e47911041ec4b81a7fe093278509fb3f73ae6177f82bd9481c8816992c1b7e86b6c2305c826143ad0685fc2d608864ee13ddd5770f84f216b1389bfd517eae7181d3c32929f61eb691273147ab100cee4117aadf1676425c4e3a597c60e358e50b540cee40f35e2e8077aabd78660d92a15b15d0269d8613175447e0735ba5887a8ce82c4f1d37d747c9b598e9e0379a2918b3bd9dd8973cad7b0841ef9d285406f9993335273fd23d67cf14a2e39faecaba18851717dc13f35794dd0e8cab73c16f9fdea817a704243c9023505437d6ecfe20d2c1be667e61f0a15c4d1278603f36203baf3c6658a760ae697617662d3fe408232f2de559921399e28efbedf9129372e9fcd6e24e99b0856318fd2d2941bf65b79f35732b1b0bc408627cb8713efbdb8cd28b79907eb6b877c4d0b3c0ee2682e4622ebbf13544bd1006e2ede9f0f2da4d2b774e68ca74f2ccb53fdb563e666b9a55d4828282e9020991c21ebf6e43c0b1490f9e165f855574d4f98c7b4314a5e83bf98dc7fe231d57daf9de96bd58825546f85d071c88dc0e172fb7208da7084ff19958dec87c897812d3fd5380db95811adef678ae6fcc78518da4e9bcb96ef810979dc518cc299c1c6b1e4ada9dc666f7c9d8ced5111cb6bd1e9dcbaee88eeeff101d6c069d3231c7775dabbedb9b4e694066570ef57b589b9c8f669910d89a4a978d9d005768bf24dca962bd01c0a430c9f9f8e59271acc0a1d65e07545f5023e2d53d313beb4504ff39252cb1a7e4fe882cdce3a81fbf5a000f7108ea0de75d384d2ce9bfac97bd0e1c38168e62e6e740624ae62ec8f1e4bc17ab3c5b73c144290ec6c6a28f20a9ff798f681bf7f8aac261bf58e52c35770d664a3e5a1dfd23eb5c2d3315b670c2656a64d6132aeca62937ba6ddf1e49fa1a6a68f885a1f6d8d3dbd4afd9cac9a80795c5e876738b09995a75f315f154fe1da01d889caf6235dfd725bc2356f8286fdee7d41f48f5e2b0b10262f9193ca5388bba0b778ae70b8c97424c30d8d9f9bfbd06c38a022fbc484fb863f08dfd0670162506b6bcc71633e29ea3df0e6e2fc9435be45e5e5786c37fecd8b27dc3ca069a072295ba44521add8b35f21b38e62a3ba70829eba789291905ada29e949126c6ef841044f6cb60e31235d0811886fbd93f94dcab67fcfff9b1a8526f5d884060b33c41882cab91b47de96a20193a2526f2e795d1ea0ca954f30f3d7cd78139f0798bd29b837e140e2df296499d6c4cdf5ef05a15eb1126dc75b5878002d708b657d7e929fa816912e07535969ef34aec7a6e66fb9f638c09d3656bce1e5e87beec9e2660329de2cd51d0b26b3a826e3d5c43a89ff447be197c80611e3bf6c5db33bb00176b5943bad22dc65d12419a88e7fd303ff51de5a3978e9478be68f77b40e99f39f684ceb1702c91b4642943ac5469b8df2541edf7cb6f69f805bd4bcb4e6dc08d54c7883c1243cc4d3aace23e7472f5abd559983662e2b12948ce8d85fe5dc721d54efcc2c40bc95c139e6400c7739f63cb2c70385eaacf2636dd72bb6e87acc5b6144e47fa029ec23559c0978120db383756d20af9a98bbd745dd1ecdd1f9fe992102ce27de98f673f6b21bff1d193a26edfd12c1c6f2414d2347fbd03e97f2512751e617ed1f5b6cea29a046a5b8253aaff7af2accc84d183b4a9564445826a088227db746799ef69b7879bbd092eb3e9cd066a89c2320f73d043a5437c9f3d462cb5d1ff38dfca222c7679434f13a9422ff7c2823eae7c55088da45e4f10730af1173b9a39f2fa6298d368d4b36043ffe83d4ae33352dd019c027a2844b2f01ba31e55758b15c10ae2a2b6a58b65a3d905b276762114ca6471db3c822ea6bace961eade1d0c6fa2d59fd74f48b9d695fbc79ad9f42ba60c98db03b0888fc2966cf570ede91ffdbdf29f64b0b47c288f6028c6a86776558ff316d14bd00173c3d916c201c24cff7282f7bdcf26accf9674e52dce8b71ebedc1e245b0701ffe7a84f39280adc8905b60b5a483802b8e62f5d87d4be40b9bda89ed7cabc659c6e4079f4c61fdeead3e755e09ab1a8fc3e3a0d5e53ff441c2cf485af485cdab65fbd532a5cd25e1702a504a79cbd7e674451ce23bc1357a15fb57690c67890a4ca5e1aa94ceb5485de11842121a7c3b9179a73c9aafc63b57829832162bf075fcf14949330d394bb8b67047492529e20aa3deb1d7f82c4c2161f0f209dbabd69e2e139e94053826b575eeaed769098c049db86685957ab6c53ba73a2f7870995e5ee2d82d9196095180ccc42545257e3f348b2bfc833333445a7fb2e6653fc38e2337787df46f0595ddd8b43e486691277ba312d03fe6ccf3190fca7bbd407394027ff430018596d82027e2977d33339c5658f96987781997df3235c0edf16f4d00af070314003cb3b2f460a706c4c267e9ad065001921d1f6dfa60162fad9acb0d1fb66a63469e613c5c3bfbb0a1bf5345429e6aa0f81ea89a2a4704d612f32d8e3a8f0e552e4b0752ee94f4c07ab1ed66989e3724aac349b14855b61780a8b70b2847a62dbf02d65215d34ba1327e188e4bfdc10f59c1627c6c3564115a2901204a5e7125af4f0ba2d9eddbf3fbc78578208a0a277099075ba960d806d0cc920a91ea917b40a79728c81cf973b7c62a1f7d9ea138c06747529d9b377c40d575144d4dfab332c5d477c16687d403cac2de52f05f0d7f18bd962652dbd45b9450a1e161e064d3213075b30f8cbe45374258beb0fa9b20ca4bde29cd99c9082d57aea90c6161fafc7ea207e70acab02ae3eae9565628b03f9712271144f51c3c2bd012c15523f058e23103452c5849aa539ec0f69f22f6096a4ea2f3bbbba61dfd13e9cfe0a90b5277fa0f36336f5ce237310674de078ee1d911f046d5910b95139bd13922ed065792c645c886635e1b90b78569f8cc821570868ca30a8f00951d408df561f85eee3833c6b033f288ecba8d30c1ab97112b42cff7af34c9a64c95c2b3ed99125aafaa924934a6f27ac3afd2ccd08d9a75c7f412a3eae15448147f24c619b4f1f7a65354c27bee776754c9a063c2360006969b9a663cdaca64cf29c1904f930c01d266519c50fc10df222b5657475ef7197ae76d8053f351fbc27ec701d7f0a823a380959e7d7e816f5f84fd6413dcb2d1748f04c8e52152829a04f7efbe732c1531ca26b277f2a0e9382c984ef559bc342ac255bf433d8bff6b8a53520331e97f3554c2250d94fa7ac5e05825f029238d6c5079345b35ce777865e5cb92e574fd976bd3e475ff17f55af8674c3aed5780b2dd219ecbe58e4eced8590cd717ac745dd9dd33941be64a69e5ad26d3f0fa34780db4d23cd051266d8139f81820cc71254db55018020a67a5a0c747f5a62a8fc4850bc2c56c8241dca2a2642bac46c46f2ba790dab04cf30e0ee505af8266b67a6157910f56918ce278aba29fa791f6f233a75c814485c6f78bf8c17a0602204df677867c15a80f3be25bfdc149ddfab6412b9703978e68cd7b4767f6834718a62e335935e8f912da931865ec7985d5940401db5adf9f7ef4c1982eda3d2642d2c948c1915530c4fe169cf26ad5a1f0f71ce358d05d5f705539d122cccfe7fc2ba9acb1efe7cebb7b048ce9b50939c18feea08c5453c74e907eeff4577a649cd9c1aa66a08b3f7505b2ed88808aae25fe0a7c95db50de2cac8516d14a9d2f540b87c7010eecf4174fa72646d8704a21ffe7d225c0bec9a9fca6afc9bfcd5398e44ab6149f74f84594856a0e0a1543480c194c930884d18cea4731335727fbe2aa606dbc74fc1b3b1b6abcbb22038674b1936f2c19a4abf7958c10e074fab4107f2079117237bb63e5f9abaed4eb254bc9c78707a4dd5f096dcc1d54ba589d289ba07bbfacec8bbfa1ba016998e9f9f33d7f44bc4dcb0d61f768e378da2e2e8e98005cea4d3d90453e79e7e55ecc35293d6c875d1da78a0598876fa80b7cc5848ed032cb0941db3c5db8a21e41d4b6c736c018ba470913f0c491e72f445b406601aeb26a309f897f0f2bd14dc72d24219da9a6dd58ddd9b18f140d1c61e80fc1c9636b29508d385e79606ba196b283281908166eade8edc99d38b1081d75d2aeb9a08358110571bd01a637aae39c2b6b1a044245f130671b6da10de9b0c513077492e3dc1d33722a82fbbc08b313bc4f29b6216f3892383d92eeddbe348b63a77d1591dbcbf883dbc4ffc24f89affeb7c0104281238a0078d2324e900b0559066ce667fca8d28ddc0b08b66d791513ace65f1ab3dd18ecf9c119690a672ab2af898cb0ee98cb6c6ca871b19075f171b3661e87a6377442ddd0e70b7675b49eabc42097779b146eb2e552f57e96b332984f85ec976fa2714ed11ab9240645a46242bb3033792a3e55d50a3c01cfe96bcb9a7b9002b91529e6392b956fd20ae72178e36f1f3468c91cf3e7775a502603c70296f66bfe772591824d5de44e2f1188e9cdaa56c6e1991b318015479738f1d587e93e6ec2d424e3026b6098ffcab2d6d06b03b6b46058162f512d7f1f441395e9e4b00b3ae5fb9adb91ed0d3639743c6bae00fce1c23ac355e16e3a6ff116dc36c88ce9362166009c6faa8653f40ef2145318db193269a09e90d0bda9ff142a99e3cf4720faa6aede21ce374db3121133bd6ba09939706fd33d1efcda2c4da85e68485fdd66c8b547e3881f8c93c1ee941761e2591c17c18d75c089b524e428685491943a3ead60a157d9caa2a110d1390acdd348d4f9507d51979786c860a7bc5283ba92e3ddc60cf8fa0188610e6b0e7abf72d5fe492311a8bf69cbae796e2fe5d38958feaca551e9d4ba7fc64bf8fdba0756996e939343954ba86f21ac398f590d29bb434c45852972466467293f7a7644ec1cc58f7d27b4f23fd5975772ff91247acbcf548154ecc0bc861516eab317c70319c211633d7f9a5d91c306f6ba734dc24501a49e3c089529c2a8d428dacef35484a3f3fa99c5e2bd50d8a8cd7b3765ddee92c63b103c752cc74ab5ba5d8714d70ae6daeefc634d71b967205a611fdb90efea03bdee0cdbb1e060ca93ac12a3fb5447c0524dfc9be2f8f17fbcdea9e16542deda186789a4160a67081204895646860626dbaa0b8999e7a3ce0197c07bb52a32b4a6653196a7a5b29473538c8b27ba870893c27c9ca17b22c741ca4ff87ab555597c775b05cf448437669dacbb7c32ba54333cf81eb3a1348a4ee0faa14a0e72caf301d2b4a5d2e2da3e1cb4a7b141a14ba146ab1b499eac4c8e5581653bf08cc6bbf878584a38fb99981f4282503725fe92fef009dee07fafe9ce688fedf487497efd1f396a54e22e8e90b865146e1a17be18924fdde95e92c01a5ad73e39dfafa6a2e58ae1c0d57b35a23250aa91d070d6111dbce4af7684495ca8363c8e204b9f939241f468f6c7ce29d59214ed4720d2e34ee15414a06aaa6f1c7bb860b5fc3d2f8637720d551a0856b23dcf480938de11dd3ca50b1cb553e763c343547d03d44d32befdbf19bdda58c9dd7c80811e957adbcff381744ecd34bb920512cc90d08490d46c23d83bfe2c61098454bd8ba9ed12afe05eb81bc49dddc147d19504453b54cc5eeac4654fe407639424b5808c07c071dfee871814746b22ee39854185f0795171541c1905fd5731168d48fa289e743a742e5042ba07344fc31360e529eba0a8fdb1526dfa00c7f20ef7511f5e183bd5f7b069809b679feb48dda7a7a697a639e2d8af022ed8c3a4f86fd0a23df52a42e79b21c8f4c83f0d9868d35e5d9e8103d071c1eb0a0a8bd36491b337be03cbc07d089a6461db064dd91f55fbde7aee25d94961b48efcee4d3c5856135e1b66b819f7dd0bc31eacd025d6f6d5843c9f3939f25c5d7a832f56742a8289b1f82fe2b13d9b399d6e772986ca7d8a70a53685cb0610967426ba9dbbe9c188c9bbf71c3812e780889bccabc8f95d6b8ceb2ee58f4b167843c7ffdb4c478e11cd649a8769f5da434e2e0310bb5c9020aa433e6456d07d806cc6fb67c7c06729285e9289becff584c0f2eccce13800297af485ad1325d867f4ba22c3a6cf4828cd27b0a4f23edf1d3ac349053348e6bc3bff20b472963f12f9b99eb9d3c8a7dac9b14ed583c3078903d5f65459473e996aaac634869cfb58d5628d4c0682611ab37e08b8decb436eaa7ea46b704ef37255eb82c1e6cc27177383ddf3f2ad9a169ef6c66c88773cd9b5a1f5012f187c92062fc637724c6dca364fcd40bd73b85b07135317e67eac8cae59270c18d2fa56d01b5bfc2ec0cf39d07f9c7ef4f53c9713828b7bcb0096c5097005704fb9b4cf4a439dad5ef1d4922676736ffce48e1933dda535af5a8cd31b073d77ddf305f3a34d82a3d17f56cbd4554fce670153e27b997a3e83d4e316ebadb52c0617aebbd54b43dee50ccac4b13959a6dca8d9fd1c2bb903a1e760f4fa5c0008ca6181d4dea7b988db9d732eacf6990218f68d094955232f5e1b84534c37e12d273a55522afc37997c66a0bde91fb6f1052cdca57abc14f061686777c706311bd10f4e790e05176dd4f87847b94a93e2aeaf7ddbe263f4d5c97f51795f4726c46180c925f4a34a3eb0af6ef2eca63f69a5a6d99c6e176e7d471531cd26f2ee6498b3f94c2fb80178cb32f2f99e279bd3c97b72fb875e6ddea35fe1c6ba03539845050a2da3496ca8e17d42962d71ce0c586584b8b4c49b5a3a7390ffc5ceeee59a81c2a5e987f9de83095dc06cc7cca56e65547616f33fd06bd2a3707c12726803d98dd79a8f05670950e274f2a8e7c9aa0661666bdc9eff7cce8181ffe089c186c00be6e1c6a66977563f9218053740b1385f6df97f0cbd852b77bb5d3fe7e74b1be0c9ae9df669bcfc00710b63e47c1f6759ec2a236fcf99d174154a9abca2df931975e76d2de899ed9c30cdeb5a04ac7704db447179cd5c89ded66d9a30e54f2ca98446ab9c07676b56e42d04e1fbcc6ae288eddc4156ec38234183c13a5716a84fe31fd9f9540a47709d7b7beafe0c5c5211a68499610ed317522ceb1517322879cc06cac6686f0db1a321b354d4b0e379e082a2bd3454cacde35c9fa19fda78e7f523b2f2b19e3bb2420835c21cc764ad976136fb8b45ee9bb962455f6a962e92912a63b0c5035a652f3d642fc7ef15f0da1533c0a9177a8ee97916593d827160bce97b4eae99f6cc543c1c715837a3a6f705f2df7eea9b92dfc4d0da36c7df70b354297f106ae36ee132c906d8a965f529b3e81df152a6321307d79a943eff58627098eac14b2c324598f1c2efd37c075175591b4ddcf0b88951c53b4f5ddc418acd6bbba99d70080e38ce682953645442ca1bd5fafc83993011e1db904a29484b2006fc29fb022231a0036d37b382ff3ce58ba75cd8d94a08a614fee2dce1021a115f590413200ca084fad924f5355e90c5132d80993d44bf2a107ab829fbe6129e985232f5c2e2bebf3f7037526e8f60087cc229c4721c5accaa1ae8bcd53c4ce73140f8d28575fa3bd5adbb641c066c368346ced52f0c4ee263ab63603b25b696983de7c99cf07478462ccbde2824848c5c12d768743df5d99b4d60b7b155ce8108274ae8098bd14a5462d30ccd6916dcd07534c4ead0e4d2e14b60adf1fa9e3ad9b3cf8f5dc87de7caa727d8badc045aec35849233e80fe6cd1ba4a4937c28d713797bb5662ee1d7568e34cc86e8347c31334b4b6ef51ab9076b45e936158ff22d2bf8c586ed60eb4ab0622e2fc7de372ad58666ed6068839f33c516fb8adcf5da9a71d339fae0072d2bbacd8f2661adb4b832db03c70f6375cbd710d2a2b07f88ee2032a6432f0ec74f49f00f02e7d4a7b32f28cce0c9e90bc384910c51493261124b18d7cdc16707a303b9d7bec1edffdce866f7e4fa4890bab4e496fa9ecd169dfab51e9e702bca994d8801277abe105d06195675999ea967bf28a51d5a8ac70e4514c2404c9c61b2d7dd09bfb60b00e90d0ee2c8723b13d12d18ad6dc36d712fb9430558f9a3f011235c7dcf4eaa92739a3bedc69e8766f37a99572bd2a258c252639260ea0afe7a49b3a1f81a1aae4aed53d9ac665f688f452bade18cee1af9874a94f3bea31130ea4f46ece5a2abfb94a01f0199d936e5c39a616cd7efaa53e53d8181a6deb8374e6ada8df49ff419cba349c5bb074a18a28ae3706a370be7ba6d42510efbc1d13e484f71b467f38172f61bb1539ace0d82f647b8b8ce70c6cf60a2a94544d379f0bc4d83d73983897435e966db5398e49263aa47839fb703bb00ff9e6dd8f3ad0ba5ad8092f1a7035ab3c00e1ef2ebf80b59dc88214f8e648768b1c6fc23fd78bee12f78f59875bfd48932176392c92e6ba1f2f2c665265f03c39cdecfa85109a03f5182a273cec4a5dafe1f020e84d5e1a24887ee763aa93dab96f973dfbebcbf7ee181f67c09cb002847d1cc837d338d83c3acc7562adea2d3be8104816b9da5d441b5d071931be3c515ef2293457a082f62cb8c8591b239b16a4bcdaf90a34bf94985353137a9c9b2c9c3d25c6f0f38a6376ef387cdeecae0cb3890b2c8f0086dbbdf3a3b8788ddeeb128390c1a8cbd542494bd50e09a428bb2a4eb391b3df62144d29083f52719ef7d58c7c6983b65d95ef23763d5165656c3a6c924d79d1556650601bca8fd2093ca12a53cbb59a4da6f0b8d28cca7338ab6c29d3a6535e3d00c35294c1ebf831eddb8f1a67edab2f4ddbd5c76606dd7a9dbe4fd951213e5cc8615e2bc30d5d31ebcbbd3e40efe7744c075d349126fe50ffd24850af39440597bd0029becf7a9dd7193f310e12e43becb39160d1d3c40901dac39cfd8dbe98e42b023ca9d6ba8b49ffd8df464f1523b9aea989f77ff74b290f45adb52a2e2ce167554ccaad779abc34264750293a6015f76c17bb00b55bead6b6c475a4741f1a4934e9679bad6c27967de11b2ea30413007c5490ca166ebf196fdbcb5dc6b5a44ddb371d38da556492d5b9fcb9166a5c7dbe7a7eb15f63e8581aaf17b51a883828d0eb1d05fa6a86d26b095a77fecddc2777ddfd8c4ef5b2f3e5a5d789dd959866905cadc3fb5f2716b9709c010340973248292744af516029cb2bd184595ba145cdcec4ba819a6553069dda1a36673880bbff5c3ccc293b9ec63d53664ed720fe2e22a1bf795de182752f123b9f11cf431621eb645b7eeaf693da56cbcd12fa2fdbae4a1e9170832390346fcacede7a9b19e927e47c3111d6ebddf0a43cbf31fc802a67d381d64fb86fd1a4f0252f9f47a23487106baaa77b99705b0d429ce6492a59519c5ef25b4284169537862dc00cef7a468bd1dc3d01a15be39ac7ccaaea27a4be1043babb23e94c50c5278749ef45c4b9b5ac6eed03364c9c6797d6755bc09449f3f53e983ee91977fa7d7454447ce6b246bae9d7afabbcaed674bd21e79f4e2f53111740c015b69a9da4dfd2017fcb72b630409f486938c857950667f72f4af6632b703c487f29d4bc88d42c825a261ba8ea9c02a8042bd71f912393bddf255a3a150f2eaff05b621e1179973c55e7ac37c3398d50731c4ca667ce8b22552b6a3d657c9ea1345d5301f6eee38345ec4c1e7bca6cdb8c32669efe6c4aff979448fba717d69f305f24ebab2fc29cbb5a31400677f71d2777dd9301d2efa546d12c41e202f41db20963853ed5ce99731791d3032f75b5f1b4ce8e220744eaf5d90c38a11fa79269247cacc166ce72b913e1b85f1215f915a4e040b5b0d1ca3cf94fad30e17aea7e64e6ea6c36e3c5ca4e3f22748570c3a7a65df7b14a5a27f84c09f5e8473c22c56008b8f218051e3eb69b7a8683052bbcf99215810db389dd5d2fe9f3725044171816002bf2287bc6a0698b942b51009d19552cceab466aefaa312f66978dc38378397206cb72f2beea5a997c086bf645af827ef02e57adde707762b1211290bdfeca1df24f67ccfc45660a86798b0aaf5598603f0be7e2821a39baee6cf496d52491ab969c2f59b201037ac1b5156ef8353990774ebe2d0cf02b4bee4a2684a38d2e13a63d69f5d56c0b63ef09466fbe00496797919bdc741a1951c32c59b2f6dd50c6a98402ea1a78a5165a5c28dacd0f86c478f3b54836aa9c85cbb895c42bab85152c48c2ff2a4722d2f6af05d55692a5ffdf3026737c455b1a0d7412b9c7a78faea59957443619648581dac390c5abd2d331118878b4aa9e7839a0dfc7ccc8e8634c7de40dadc12737e87a8a678e55e32f0e198709255207e9ff832f2bb796f2335c915f4c24e07f6ee7d07ac702c138183a0f10c44aa759730bc8ed5e36c63f7752c3316228e5c67a770bebb3163b9cc3f748ddcd11b6b8a0506f1b5aa2ecabf2b60b48dfebdc56688898a9cfef48d3d5aa8259ec5cdb0d6b7ea662cace21b5b9b46c74ce6fea65e25e4635e8cae30e3d8b5f5cb7882a40743b9c8418c4b6cc407bea11a55c7c5b4429d529f26ebd42fa8e5d7768e5c35d802a80c1d74a300c515a5d261e740bdcf18907d09cc5d66d39a95be013f3720a01dab11e0bddfdd224d4c4aa72046965e7b4d2ba8aa5fb59553d8c8c7b22c7704582955f2f650c8cb021a3a194295a57ef98580be78d989dc2dac7e8fbb56429e86fac502b5564777d5abf00ce884e2a324b56e180289d4673eb20c621cb561427459cac753b9150a36dd5b267a9b2c419d619ff630524e186c0f13c223753e5c2abdb6abb88c3f257be6fd58532ead23908090ef80d93430fe08595b0f4fd97d508c0630bf1a188f476f5dea59e33a150ab9fa270dbcee2e9dc2bfaca30fc08b6298e02a688e73100009bf35ab0ac16d47643c73951bd9a312d3cfbd38ed48972cf91d89f00c1256ca75e0b63057a30f7964ea1d4599b34ee2c6c00cddd2a71516fc39131ca0e44c164c895145067bd515452602f8307cc65660cbaf0fdb0e7cd8a6d166ec76eb3b19848e081445ca417153863fdfe618da76a33bf9dbe8ac76d46fe3bc875c70fe59b64a8eda6157a5b07f40564df36c4bae74c08316b4c4520859974f751066309c7051eda92cf778f8e8f776144c8e70164ba4a87cfe3c3dcd2447a38d2c0e52325b1cff9baa13824e5cf58339d6ca50f53a635a39186ea1a4705a136fb0d4e1a8dbb3780c1f2d46ac8b14913c347003ec423017d5656068aa96161f08ec50ae76c6f566d50de4d21cff3f7a3a34ea3ee29d850636c4d9f5463b611a69796cb0160b64ffefa6d285a73cf98005e2c10a1cfd8af4586f35b0bfbcfa5431b080215e3a11de515054d1ad3ee50bc727e9f75a6dd2dd538b6f0cbdd64a8ad9568a9c9a20e55bb39837aa93ed6e578525df53b24b75569267ed1c932436884b65f190143c60dda2b1de74d1b6e00ba8af49f3533930d1079b784895f1c4ea01e7c6451fcf7366aea92e7ff1a9676faad13ef8a16315a539b38b9c0bf05294f9892bb935fa4a0651bd3e9f7e45e40cd01791a9d99ca08bb8985bab8d60775954b853fecfac6be9de794410f56e29b4710da5c2cc9ff6b5fbc71076d7497230ca695cef5c89a769a44a0ab7917eb71794f6871fd9b09d783c4795371d2a613e925e0d6af9ebe2991cab9fe7d8147d91c0fac34a57a86ddc3cfa4e0da4720fb3ad18f67bffc0c21c3f814f29aff921b64198af01b4472173d76edbf6fc3b1831785726f101675f55ce2841e067a9690868defb98d09eab48e88cd3d5a746c11fb915ddff4160ee22874abbe501ce1597a0cbf7c5da7df879e79f4898778bdd2e19f41c19591ee63304e688f007e3843bbc3becac0b163399c4c0eff25ddcb2b221daeb8be5161920bd1814b17dffb8b6904c9f145641c1f104a1a797e43e1ca49b08b0496cff76f440fa67cda4548af3044d1ac4b22362110e9f3ca4f9110d19de52eb78c198f1986b5a58546e780fd6d60a5f7f42d0b792378c79f2f16ab0fcd816bc5e35831ee4036d1106f56688d33eb71780606573268ea773084badfc96ea1d2ad3564d6dd9ccbc3e67cc43468bd880d630c5b9daf25787e4c2499e545976a8f333458302c4e80adf84c8dfe05f84fd7e3b394961fe8ec87f2acada22e9d4de775386736ddba6b3f609e49b19282b49478fd0a4e5e60aa1a94e4fe286accee460f10d782510e33444194492c2b13434140d322f75101a433dc1107298dbf5326c95f31e53595d0e6b8dc47ac2e4707c844a2def237c83ef7717b41c825e1ace332623ddf67f244ccaa8e2d2c94a5f691e40c2c254f0d6e73892043757a0a3bf2e39ba3dbf06e1c8df25f2609aa62864dd91c4c6a4e640c2d51307d7c8bb02ba1a8526b63e862303e59ce50944c39522d8e3d0d71a8bdd215bfd9402555163d56da352b77d71cb44cc62ef320c4b83f3adbc5ba7c0eb44d8c91949248b7c298862509be0787aa54d72f1b2f02e62350ee7c0a045935fa889b17cb8003b3de351c1f95b0e02e872ec957b3254588d5c645e522c2c437d5ff621e9cc47e70431d7e14b25805a60e7cc511513eee3e499cfc7c4236a4905baa3a321571a1256c13d7d1a782f273e6d7bb3901c4d07580745150152024ba50ea25d9c55c27bceb4f3457aeac2a35ea019bc4834c95b7acfe991fe6ac4a26a8d218ad358d5f7feade7c0398a7968238579d5e1fae7497d78c95ec53aec97d489244c11b42a481cc280052fd2a6b71be5029f21faaaeb3a75b11ecc97906182cd4c48bb8fcb5c8f2d6e81f05821270c11b600b2eb57ea21b4600b531b0b218703c36b228b252b3058c1b924677b9bb8336f9178935724c217b47740eed042e235932a218755dfb67bc534adb131ce5f26430ad6fd61dc46583611107a45f3cf87ba0db59c19c774996dc1dadd9a9045f3c479f4f68eb24acc7bbf3a12ff3a1b6461855ab4d540a7286f1e1e06e62821299f43c575240674ae2baa61e914046f57e703292e8f2ec54a2cf60049981e0fec94f757eeb59cadc0fc74eee7ca7d41844717a1b14efed2c01a903c821713e2113175983482911607c24e6fcb8537f08a354b32b9929f85b53e4e167966a19b40438c1702d2bf163e308159ea74099c24091316d3d8d0aae6815843c2138539b32c7375a96db7769349d841c771102b6e76a769b912d32d2c153d834df4dc3a860ee6f2d990d64be8428268473c5222ccf367f43db89109b2a3de96c6f02e34b0e030564bbc0ea4c27f7b0be438e7fd8867f9d5426a1303a811a10a44014caa1f1143d086d7d415235a1bebe3dd9087ded119e0ccf82a583ad1c20d88a76928622a6992caa2b044dde807cc9e36f582c83adfc40439fc76f06dfb5f98f058d11d58f28fb6129093364ebbc0a474170c9ad90dbb8af8a6258c8a0bebe8987ed4ea55bf47e3109bad063addcaeb1137a2f13ed4a95e0648ce3dfe69e1c4a7187403e250320d9ad25fbf9f49b361294d23d695e351aa7a13e0374280d8e54123b000b9be68ce774b759b6f5c8d45a148214f0c1d566a700fa445d52695e0612886a7a79aaa23b2f6a410156a8af05b32445af210140e7f180171a946bef4621fb360c351ab6148ef3f9bae83c641a6a18ecf412502fcd210a664cc94d22eec9f717cac424c88e47a332389f84c767dacf081799c50c24feeb5fffe32d4df2b224d4c804c6c184ad09d18763697dc07479238a948b574d160afd63b7697ee0463fc9e7643a10c332096cee4f708277e4be4ce1e6c32b243913b3d5250899a2ad0d7b214388d247e7d3de578263cf50cfa18d62d873e4814272022e2b3d67f1173f5fa3c59a4a9b0f289eda5e5c31cdfd2c8ed50478063c9044a9acab35d023808aa968017eeb5f9fd3996c2aaf2be8f0c9d0855f1c4e7365e1505e94782e5a5cd0fb9bd1f858e3454500b721a3bb02b96876157f632ea63ca8eb31af3470c7a5c42718f998a895d66a53a2710ab0ea45d8b88cbbea5c4737c0cd0d24f48a664761796542a463cdcbecf6e0fc90a7908bd5150e2dc32c9c07839199ad8e8b6aeb5cdac32ed42c626c403b0456cbdfadf275e4f68e4726dc33a735302256559a944d14ba3a72d79bf780b4f1ad7804111dc4747043f3505f15e2c8c03302f1f70aa8e2228a50bfca8511b470e0ecbc28c561c592738a86c82d3da8e36afb673a298a6454798ee1ccd4c910545be7a521faabca0ea6790f8dfe4ff1728f51c3182a1468e795042ec631002e3668efc6600d922a5609328b3a740503eab04ab1b9eb585f11161e4c0e2026a4c2a5e4f9ea1a6189e8a3ea81b32b21ab40b6d43d102545929dbfec149eda7097d4a471e116397ea328703c5326de3d511235976c1813a112495f5420d527afb3e3b1f90577274e0d7a23aa3e8af6c4ff1b9b9b38f9b935e6e514ef9834142397e26862a413a4959e60f15b2f14380ac890a3866b8316d6320c431f63502eec8fb70f255d137828fca3dd079db9bd1372f9d4bfdfb0506c87f3119e746fbb5221bf97fed7e8df47d173496d29843f3a58ad16c41ad7cac6cc320f8532837098e3da7e3cb553b4dacaa3905b4c7bc74ba2049c075df62b67c41b4b37a813a7a31d0d09509efc61b17b0b948fe7773159f8745c8d22cf2008ed3912d26e781a17bf38173478ed3b54deb967db5f44d9797b546e29802803e847159bba9c06fdd1dda943b503c6ab6db2aff8ee70aa16aa2f261e50e932fa2f69b95529c2b8588e443f5c2144e867c24102126b4477c42c48ddbd541c014841069cd1a2e39064dff3c0ddb7530ab32a2e7050f9da0a2d67bd8ce6254d506cfb0aac121b70ca8d6046c1da726dab615f1ccf5819e4434e5e2b0c79ba1b8c40f3253f3406d8f8f1a7e6cf48e38aa979289f98b77b7fb7e16349556d9ae5a753030e4b0ad2ca4161730729b6c2ff8efad1c1093a8da936a656375228e5ca35276b73914da1bda52366a89f72f49e264278adbceee6e103d666764be58ce88a9f4968dd924701e9820cefc362e06272aa32c6cc5c7d56087307962a196e6becefc1e1e94be78bf0d5dd5b8a26805ca15a5582d4cb975b94cc9912fe5349b8dee479281d16ed298698b862cb09b4f8c45dd109aca498e74b5d893420905dce16ce6b88843289b7340d96175b146eea260b02c88707dc946365fab7b5937826ed2c3a0c028d4995d9e141e653aa1e3e5b9f43b13d391e365a24d43018f6bdb88c4025357d5914c19aaec171ec8d65a7d4310ae9738bbfe77556e464b89572a1becc35e1909ec01f247518c73f12b8e1603c85bc653c630ef7a42f8f85397e00496d8488277fa1c3e70646574d78a4aad667a7e11b269e3b4da9c565487c405d6f7be784249df770d681bc8a75607b49b80eddd1e8c78b97fa416f93a538ce552fabc44fa99f3c1d5d0cc96fc175f63542bc5cd9043e4676213587bb3d2627361246d369efc8ab86e138ddb171eb11a3fdd4ac7f2e8e68eccda15955e8f9b4b4bd0246ff4c74f7c4a925a1061078c02b1ca6a37a2103f9e78de6441da6d297331867e0a2a61bd8d46a7a27abad595290e09a4986521416247f7f61be9f7dc37d09e1ef5f207a8cc884913c832b9fbafc1f4565841a0bb430fb62c00f53a4680681cd9688beed7427d8d85a4ce303cac8faf1bee01a370cee431726706ecb6cddc141b8d08fd61b8523c795d5c07d6c31c7118b600fbd0be05f51a4ea30d384568c7b664cbc7d27dff26f456792beb02a5d03fdc9dfd444bb5ab94394a417fd98b6b7e08f23f3c5c5d7ea03eee90b0939bc4a75e4a4147aba3df80489da7a7a0f3d69ee964fc0d77b55ab8614adf08d5b89f33e8305458f0d75f66282819819cd2bb2496157781eae2d31ac5f627d4d57bfb75eb3e822e315ac18927f5084dbab5bc1bc032f647571b3cfb5677dfc36475861114d850aecab89d4b0dec6188510f7b16a3537867890d74feb1561118ad0bf81646545e0d6c62ead09bde4e671267b8a497696ceee5d4718084658ea81847e4ca449e65d479855ad42d241549a909dd2a107e44055500d656df5bdbd05a4d779a0b66e231a243af4af3f43f9d757c3c82e2dca80dcb78c918ff97215fcb0554f0eee1ec841f16c1976683b55f37f93dbbd5789189feb41b5441c64285249beb2a232baf23b868d8baafcd01cf728145ce832c34c2a25f5d4bdcd7c79a0e1f36d6677d227a858b7a281939d8b0b3cc2bf6f380503af7e62bc153a02c04e795b6af250d24cf4aa79234544a1c985eff68f7f8e9e258c867b77ea9f858cff22fbe075ab4caa56d50a17175168e93b81bd503136defb8fffec1b9b05e7e173fa2523e6c7a5bca237ef16a83251ac5bbaa735acc0266b82a987196bbf4a4028e41e390cdb12ecd0bf7e389ec05406789eae371fb7d9a2671d254d56c937bd4d405ec8cca52e851207fcec047cfa31e9ad4291873748b95e7ea31808b6d626be8b29cf31fd3f2cece8c01f18bbc6a6f234cba1730f822b20a4c9d653b72bf9a40a2854c55edcae86484272ae2e64aa8e503afa1e8458b4a9ba4475657bbc23ea5c85ad9b0745ad7cb32df3eea3de4266fd8bbfec987c2e396872ffa6d24a3936490d6acfc2911841586c2a3a06e43f22989a8e7d78799e47e33da3badc47eac73ed94439fed2a66e055e0c7bef67aa98692bdafd7bff9970ba084f91cbdbdbfba5ce4f6a488c191d11e79fb7b8bd642f1773421e17832813415861110968dcab075161d80aab2159559f3f0151b40285f290cd323c9c98b38e91a3f1d871effe2ad6d1f01cf9d0dd122d09abe6597a0fdf93bd3864ec0264c9677d7b89499076c8ba95e65e85de981315791bebe0491ad0151771c6b52225cf32f82fa1100ba45126b03b555123b1772677761c443009c67711d377e669649c5c929658144ca09fd7c6c98ca7e2714e7f584ec75c947d1b76fe1e1d5084bbc43825871d4d89b1ee45d29cbd6fce4fdaf0cd6f6217e2bbedf3e3cb574ab1f37719cc55e9aeb96ba2296a913218d9c5337bc324881e09e07668ee0946a66b2b34c8618c6cded419c4ce48cffcf3b72712d6ad300e5944f8dda78e02e143b46a22590a6a41ba81334427799dc57ac52ed3ba85779255a3dc2837a8e6dc0d2ff7f67bffb0d378239f18e0a1ab3776e7c8612f571231025f261fd1a197195510064d75617872f97bd41477eb78738f82b4a014e737db1034f2f185ebaccf4dc77552b3a5f7f44d3bbbd9f29530aa10935daf8520e8e530bacce87bb2e5f7ddf4a0103df080ca8d192f914540d3c335d1b294de781924080ee94d9373319e3c4e860e444318da958682f3b3dfde534b91a9f840ad1192f936019bbf07c9a2c4d79c2e6440bad84dfcc162216dbef34ca0d6039d9fc98119a0f3a945c60133f8542124762a001c584fb0406c9b12c735bd81a98a28147ebd2db5c84a9391b26c4ea1253edbe70e2a4708aff7608be3f25bb286b77c4c9ea9ebc4e6f93530461811eeab69f3c1491b7abe16c58355b5c40067127e97ceefb12a4751cc6940c5f8cc04d069cb65e904054b98659b7d355e172b58ab02eedf93ea930a2e82ee2ead0e3729990f4e38ec0f701343ad9a0fb3adc8ba9e1009c0cb0d3f8ac4f5c9482cf65c6cee81c237dc80b4e7cf0ca942e4f96526e69b8947b2df04054566696598155bf4bc1017f3f69c36d90829e0b1c0c57d131bdd488b7c4222bee0a5bda9abf41078d71a9c14d6d06a0fcc95c76222c0261f2e58472b2f68e37a2aedb5b280bc6b5cf276bb8f9926ca9fb74aa4b883f6b65bafb7d4492798b6fbe7e2ca106c465375502beda774ce1dde322225c3ebabeab287f3d334c119aa1a76f8de02e10b5d66539cdb9171c77db9a24e74a8ca244377c4c8b4d21129699fe0c4e417f2516db36445aab74ad22ff571c167a864713e33f2440bf4081cc058df7d07787ed397039230deffa67803862207f5c16fdde54ad1dfaf9ff20b96cdcb288a6ba507d3d2b5878b16840417fdabd8a91ef6c01411dbe361ca4d450978ccd45363e4631d6ec583a12b0be4a0cfe2d4d5933c1345b353f56a2f8727384525c26579743f9be2eb7e938638a3dd306202c28f59472f5afb6e8fc0cb6334f37babf270714ee255ff3608857a1f0a0d88afd0fa75e58fead01a02e12b1ff9a7a344a5f79ba9a6ddfcc7676f92bdf2a7e3cdcb8cec2cd4be7c33076494d10efc7e3ae99aa735eea6ad687dcad77e719ec1a81851325d3bb5191df0be468cf9d5a66dbbb2fbf9c3fdafe431ac1c9a9bd96d744e1a1b194a96e7cdab720af287342f3686cc812f3a4850063ebd8fed0988043a97a3718cbbe90664c2793ad5d32f070c91c7359cc3f7e7d07ef048e6d7e9c17835a27868ebccc4b58d34281c5f3c6b9cda045cec9023566a1d740de3cf8c504cc89e54d3c874cbbb26bf1c0657274ad1aa3e4365bf2f0cfe5436fbf375eabe2ce3597a1c26afcaae970338b568ee89a85844a640d6d266d7a19a526e4531cb773dfdd3dc4f3102d34b9754c1f1182ac1d5ad533403a2942e65994bd6334f7fc07943ca6e58a5cb75e32f58a534153bf6db22e88ea13dc771d02cfdc352033d410fdd80d114b74000ecbe32be4796e5157ac85956c242abd84db5dc3fb356116b6f3f5de569d23e1155fa0745eb1dab6e6c18052223a63578d33d99c459a44e5f87d4d32740a90ce088115a7de240b5d2fc3a7e7d8f4791099c3b00ec9ca6862b3bd00c51adef5c00508b3cfbedbc345fa8d909881a599480bb6ee2cf5d7ce0ad4bd74fa8d4cb37cfa100c1025c312c8bb426bdd1ee0b34784982c881a370509431b730c7677e4e7cfca331ff0a1dd026218d25e5ba7db0bc89616aab06cdf42211fb1c8e01327800a2a4e46e880628768497024dc3c147de3488e4921eca6bafaab87359268a6fb5aecb195ced8e3629baf22784d7632485b9386b825d58d9e1ac6f9e16117d18bfe3b09a0efb4afeb1a0adb7e06d6c5c95bcb5a048f2921a1e4e85e2c3e93dce0b3677a21a2200baf17af399bc599a0c5aa4c0f56dc50c395453af886129997f44301186762e2efcf3fdca39badd336e582424283eb268b0d5bb384849f76138d5d1e7588f36596485981a24bf17875f77d0ff672b100a3b7db7aa9b319048962ad599f4807f22893db560bf57eaec4fc9f8e6adcf82ddb81b062122e47c39cd51b51c286277acdb8e17a2088c2a69fea54c897c59fc3ac8bff5c3fffed3bd941c8ab3f227a12ce4f4b8162246263719ca25c35a5dd290dffff16293cca89bc23b6774c88a052afd7e6247150a580beed64207e78554ea5afbd38f5717c9ce1cb09dd851b7b492e8cd562f43a79510a478680d9e5a3ac56205e6225e0596c3c0c4bddcd607b4bdf9e1b4f1179ca1cf38f4e1195b79d95233f15080b22ca26f2da2f6afc56da388aea5f819939351fa31e89d1d73fd5121a0de55731260a21c179d0f287970c5de026bda6988656023e873360d836cfd99f6b28c2b6e554ef81f871776abc93648341f1d599f523726c532769c42b522ea873e7ae639158736e12d12fc32cec873f10686f03521d68cf512add023878d4acb3b927c6b788fad02f3378895ff1b02c4d63eb9c78d345d55623b5e42c6c88f2c58f4a922396ec4eae405ad3b99905ffe4971a3d0b93732f54b130d3f9a29474fdd0321c8d0727124d18b76f57ba739c5063e90c55e46b1ad154170c612a1fa4dd54376fe108c1bbc740b562113aee3f1504ede19eefa88096457dbcd8818ce70e04000778a7e7903e22cbf0dd6f6ff10f3166ab8b6357eff3bdfbf1e7e563a3547badea988b7508d33e6521adc6afb225f0e8327769ad7a5c7fd9a4d6fb1fcee7a0ea2ba5267b64463c0f0d973d7d710deadb1be054ae65bf802391e45251c4996654b0570ca399a06268dc7e985f9d7fa0fb40f64861e6a5e360dda510e4237ce4a08a74351a54976d77647d3ed55cf907bfb6ba69072e505ba08b33d5b55641a4dad6c780e9612005e141731366636f9ffaae45c7b1e61b71814f7aa5a2e681ebfd951955c39467f750d1144a61fb91394c563acdc120caf7c960f069056b8b0a327b00853a06f4da5171476e3d605e7e4435062cfc5d43e07e88c615f48e68def0ecfc152506c5421aff60efa258e60452710b4f746f84e545f30ec3dd5e4e33bf30ba7f455e49a8c2510d8c611c597f217451a57ff56ec79fdde76b425e28bc5d5ea5ff394da68171e23e44e39e0b7fd940ce57af251e24129587488b2c174ede410b64680f3696a65a533a8e6590f5f9e82789f627d0af80df11df3b64e53c11da30ba59175cf480bf5b2e5257c0aa452e5a38ad8f50b62f9c4af6e896679f69b9898f2842c2cf5c79e64d1e235fe2fe20a074a14e0dbe72c2ae4e95c5f357946cf3e368b400c4ab3e3deb094c659a1551b90f5c7a9217a215393412e0d5e857be1102a3114300bc0c862ddba2d012e29483e1ef9c56c4785dd64a507d417987726fa36d7539a147e6997c0b1d33458806a85d34c099ccd13bfc901ed035328819f3724c540c10d252d2dc6f8388f4303415ee9a995e56ec10a93eb1546a3f079fae23ff2fb9eaac3bf3ebc6f7c4f1aba2dd4ea5f819f87981a4552f4567e519b20802fc50b221e9756f4cda4d0c3a990505f51f33ce90a48ec313537c91c6d9564a55479f5a6b7a8fe3ba2bb31ff89c8c5f764680f2fad4481681a47b4e804003d53a5bf3092dbf252a7380a3502423e5b8a5f18d1edd7f50b8ad2848e1140a851d165e81597baf7281a2cdf31109f99824f878b843ec39cd28f6284c2547ea4a455a24eb129a750a1eb86f73cc2dddb8d257c68f85b3d3dfbe001c737a123b42611bcc0aff9602f1f8b9bfccdb7f35e60f4ce31af774a75da03276caa6243fd77d3ae9a22a0c37986efd8fa53e1648d856bc1d9a98530e75267be5dc4794e21151b2b89f676c489095857903e5f0c403e2b8ec4146207458fb9f5077f2bea56ccde152697365873c61f5b8e14c4b82588520395106fc3a7879ffa7e1ef8ec356e65612e233fc74bf989835d520757e02d6bbfe01837ea52d7f1bcb8d15286860805ab15f8b840c2d35dc41a6cf559d562fc1c509dc5670d16f71d339fa9c7f8067fa1eb17945e90e232d05c16bcac92aaf45f7062d9f03a47d4b2e422121e778f4d9a4d2848bd17218738263748172ffedae24f9d4042b1d2ad0a225505ab807c8ffda072f09bb9a46b3e4543f1d682a2b252fb9e41d96be1a7b87149310c01688c705f037953bb318b9a666099471e997bc2b6200d2df1f738ede0ed8fb496eed1a2e2cec4537e5285dc8b40376efd5b81ed4cf98ef19da63b5a654c0d6a9bc01110aede87b5f140f90294226c4c7d649b4a81013ecaef0ec5bc50966f38944dd5ef7506f5220aacd9b6cf8c8ca14eaa4f1b33198f3d17d2b16ebe41cc3595115e1aae31bbbafd2f8810bba718a6007253d491f911aba5b118cdb077719edb2e21e1da53aeb3e3a097a97836baafbf6c91aca9a6f9434c033d9f17b07d4f90eff0044357b63e40010d23140546bd52603fe9b85deaf5c1e3440fcb6f9830ccf316f06d43e49dd916cea2a4e1daf2f34e1e71dbb47af9c17883ced77b89c90552d2fca7899fb66370b23359f99e4e974ae0f58df5b07ad4195424cf43234f4a7dc80b114125cb140f360d7e8621ba34cc3dc894d9dbfee72046798f199c181b0bb5d78919951157705c9260d3c03db69dcadcc18ac4592f580beb9f6a92077ecbb5867783c4e3ba8893ffd5b78d0ea29a2cb8eebb9bad8b6259550ddff16cd9defec13973e564b4a17e353c9e6e874a10212efd8d5ab7251b2c53dbcd11ada6a26d355ca7800244441df90100a3bc2b7dcaa41fa81400507d8c93678ec411ca4f0353932a9f4935614d902877298699e85f30ebc453954e0d2dba81ee90cbf1b6e732b9323b0c202c1dd8380f29e4a1f30ea1ecded0b236970185112addeebaf4e129e9ef8bad8e316e7e6cf11da9677f7c17d6939003a5d51bb1419000752708b327262a7d0bc4ab7b925fe14d932b2caaa170f3ba8e01aa03d431ec66f93b1b485051deb811ad6ff37844760eaee1d000e09b4a140fb1494e18e56636a4f3a2e347679b080a8d863a482d7a5c3da07e416183f4fda0002558ea2094c9863f4d97abac3ecffd85f92a62630ae4a05a01a56b46665f7bdb057f85458731f40430a4d7e979e9de8ef9381a8e7d6f6459bfb9ccc5e660ab530d16b81f51ea513f1a84ad4b9de5766cf8fba425affafc6f8f6761b545b9884307b083e536b1013f310da402534b5d0eb779ee0eb1ae7b72a7c00c6bce85d073a76714f3fb05621f40bd4dd3314e12634985f99902e3ae57246495922f8d10ae0d75e2ab5ee5bf7b00812eaad0555a071b8fd956c7803d018bed359f247b6e079b38619a9d58d441a0bc61df1c243d68ee047f08cc236fa363fc0d3419326e203615b7c889f09fa5aaaa46ad5dd6581f2d4d64a5ef8fbce7808e3640b70dee07e7538a29a4cf29598950eeb170eccc8ceda566c14df61e6428d1f50a1cca50a1901302c9c9411437954b77aaf4db7d8a9a7dd831f39ca2aa63d6462818b6cde8ba12700cf1e394de3da5decb1f525b988263ebf01bb293d7e69930ff00212d1563b8d396c08ed433d8260142242629538631a993b946e1fa03d7512c0c0e75ca9ae9d3bff2ce274071a71edb86c1554e52b185dcf267f55cf9714ee4e4b81676c4c9c08b98f32f39894bcd59ac3c62b1e2c6e4d97f0ab8c0d5f589417ca2b2f71b6e90ade3b621b573c0071d56a67a802c5f9ebf018280b802deb0fa038f38dd5fb0738827575f468dd45f5aa66357546988749cc990e2946137ef2e80688f4cd1cb735061d07f967c5bbf8bc8f497ec5644c6e035a76efcaec943fc875aedc6b1ae8e14abadac4c927bcdeb5e1b5758edb9ec7b74ffdc006f6652a14189a9a96442df959e1b89056d1e52e7043ab89a1fd23ba5d2702132852b167319a82ab3ba32ff3853fc1cfee8bdee02190a71c4bfdc5d56f997d921636f9756a5c0033327295662f6649f0ecb08e4de6584da09ad9571b41e088d764847e372984ce627a80c66a4bfd7c3ab0e324682fb8e42f448dc8df36ff6d0d79c468284386c83119e45c9439e5a06b9ed2f8b91eb76681e9485380a622c07ea635bf5d3e5c9fb44d90923cf48b22ed7a81630ca8ee52f46af73923bd13dcc682d02a2e486e20785edd71379ee27ab8530138327e41e707fd45a18551c286bffadd882018177ab991b51c1e106515d7f65d3853ab14ee1ae8212ceffba1db088274ef69fa1baf2ce2507c6ca6c71507a1060ef2cdfd6033869049ec85dd4282d4f61ac6d18239db3c7079087d4b3e8c7a60d46927d5956c86c77e78bdd58fbfb1c57085c25e72b115d3fda70e462511ca4510d4f080253e35bfae946728d6f5f15f0278958841251ff2935ab7991ae5d509002f90733cf8a6463ca10a42526abf5f2e77c47203c1dc8902526b5d4b98e18d075292173cfcefa13a2fc06040d7e7684b378f37a82951edc308c0361d613ee2bd696ec455142d12d2bf348a8afa9a5f605835b7a9145fcedac1f184aac144b6147888761dfbc44a7553100fa884500c0052906b395f6e2c8c12ea5c4e2e165ff1ebfe1b239b0acc41cb04e2bfb865d24ce8df98b450be89ca7852db647e09caee81e2b1bacbe7870a418bf9510ec22a1982bfc20eef6393646f582f913a9d1ccadb26e30f3d5beef55d4c430b910f569ac9786f025917a1ee018b58f539337f5ea6de49e93fb102afc9bb670117fc4f5de4d1e2feda0e1a5bb92cb33a3027f09965ccb41e38d9c22cbcadc67be37994116ecaca17e0b742419c4af3b8c57f940f520c75a508970583abecc5c7b2c7c1292cfaf3c8868f396a2cdf41f02ac412623a9a0817bf7e0d78515a156bf3040ce38e10d3343cb7bae762783ee840142e189abc2ea745a0c31625d5a01669346bf67623ec2c75db4bb6841592251cc868047d58c7a09e9c7fc7f6ee802691cfcb0bb57421edfdb8c486212b03f9fdc7d3b36f8be6161c14310199a620988500aace99cc5869d01aad59a53117f228c22176351ec6f745b5bc6ffbed293e0dca352e189eb009a3f69167ca93d41e6583f562b736ff6fee14d8dd1665342d55b8da63b254105fce207a758ec24aabe8fecb6f5ff522e9a89f2fc56fe2dcf9826a509abb9d213051d6b56bc52915b02e5e8860ad0a2cc22e1334d5c28262391f4702b86f565c9859bfbbb26075919b16326ef5531d0a13c5c32824b8f7d74784d0d8abef69e7fb265678296857cfc37232bdc64d3bbbd70aa02aeeef0f52acd6729298744b388d96de37d4a27281daeadd25d510b6cd76af6a7ce6ef0f5cb819fd460fad9851f08d07316cc31deccead613f9fc90cd43d986a0edc04487ee65f9666490a5404ced5178aa600de9c33d46f2b33415e685fc7b6a2b267cacedcda90c2674a24ed699f424d8c2d2d72951a4823da3ff4a985ace032fc27a47beb8e16dd915889b70577a5b24bc566c33747ef7405c375f30e7ebc9f8dee4ce00b90580c6e29e44e69012d6231c7af8c0cdf9d60dd11cecc8f70e46a104183bc97fe41a869d092f71bb4420563964f5f80484bebdd88457d115b423eed4c330215e4a672dd60fccd1ae78c7b1b081c61fcbdeb9a952d92eede684dbd6487a86e23eea5fbf340ece053ed648d4b730257848d66234d1dce7ad5c88a7d878187d2c004cb41e985328cf7fb35e2f41d3d9223c9b975004f302b843f75ad067eb8ae459f811ac3e27ef324ad7871697cba078af0adf9a9de71a262a7a5d18f63e853a7b17537f8b0b1533984e30fb295b05f516bf7de0f92b49078b57c6a313fc4bb88eaa4d2f2b3e43e7e8344dee0ba25646adcdb2ab8771f389adad6d80fb72686930137d7aef74f64838927bf029085b1c57284234dbb60b422744f57b87d78af1470449e884f0f24c80a396577d4cbe723555c45bafeb3a758371580c790036161935323a999ddc47fb1388a9bcf4ef563faa998fda19cdbb5f81e45ffe317108c4ce615b1006a7db823ae78f0882946853369296abc63ec681becfc2e85cec1b26fcf4dd73072d5c9e95300931d5af89587a3d605e336ba1b3377b5a024dd7c785260ccd207b37dbbb90ec408ec1d0369e590c60b9ced33041bda4f549e3e04b7a5c9ba6cbc52c3d311005689fa08fcbd5a041940f33dc5aae66f2da47a630c5452e2670ac6109fd85c3406dbae2b1e4ba56f3bc2e60b2e133dca53f9b59284209cef22c72aa440bd62a28c5ebae74ce61ea029b5c4359f51841292af17401afbcec77feeb76912084fa3f84efcf963d81afaca25a9cba59e554df5958ce89b7acee4f455c9aac7a7647891275926a0864451947aea97618766ae3f17bdcc7a0c420a734857b801500351cb94791183ad98a9911193963ed1f61bf7557ea403b9390bded235b6a7b410e774ecfa5fb6c34ea6b3c8776c9b3f7c9d212588d0ce1456fb335461cedcfb0ca3ac4a82297b687d798179dc8e763a63ae68eec2e99ef27622133027b74a4bfdecdcc05e746ec7b5b177527931eaa220eb138505318b05655776d58f40112545f082c6b8b74fd8f074381d2d7cd30950e099184c38013f03ca68d986c8c38f2d90f8e773d0e5fde5f1de380a3bb21b74bcdeace822042c5098fccb5fbebc61b4ab9dd7b81abf1bf9a7d37918dcea440b350b3a486a545d71f09d69f2fd2b26faaef1077d979d95f5f449c5318550c96d0796ea08cc1d2a33cda729c5af354a8401905bb8df4e3ae1ff9580dbaac0e1d97a93d65c6dc364014b9d3c67328992854f36f7af645dd435d582e0fb8f391d4f57e234c958f9786d00a78652b2f36cf140e9c32578818b214cb01aad026c58a16dc307324b4f66087f43dd350fa65c5554843dc7a6cc9661f9480029da93041081a7c913bef6e46c67441e0e108f48dcab67c4dda04792d46193985cff3956ae29000214752f05734335a7c206c06d9a0cb9186e48bc9e1a592e2eee9bc0a4ddcf6f6257c2a15765f3ab5a9e90e48582b616d5cae2b2a159a4ed2667d1d65915a25dad76e45b183a6c97d5176bb96ad21d1acb2f050654ff203d9c8cfa6dfd1b5252a1232f0adc64eea4a01e8bbdbcbfd670e60adc3ce5f39d253e3af5fbe23e3e3c4edbe1038a8da59d8554c3828506639fc369f402e34a32eac7312c541f91170ca4d622a43e22b566c025d3802bf87336ca067dafcbad16472c57b7db44abef016a768bab9c45f91700bc9335dd89c80bbc626b07dec9a810c6b2bcff3ec1110f2b30546c4c474e012cf895fc5e23e137f4195ebc3c38a495f1fb7bf2dcde4daa4f486bc16eda8de77e0825064b221f460b4b6ba749d6b2618a135470cd4dc1250a003e910882dee278dffc02729f1f7026e90db54dbe2013712afc357f777c3b189a7833498255517fca0f6701962f660791624937dcbb234bfc2b773010aaa3fefa4b749759f9a9087f45375137c72acb2f46fb2ba0f9765b1ed5006c7478522232d7ebc25a749b5114da3277699b377bd3e1856784e2a8069a2b3fb1cbc47fd4e5e72693ca60bbbe75642d9dd50c2a1905947697bceb928b0076f1578060391aa5dfc024e87c2b982daa9d80aa67c25c8b7eb61b61c9b79ba1d3ac59cb3a0d92ed3ba38f3d4264f6cee40b3a4d08f07ff67adbf68ebfef5d37c6b6895d324eef967f438812f7107d5edd89f95a9b086acdd28d6fbbf7246cb87a3df798e5826613343aa395536feda2b908cddd57780ad3bfce0931fe65e82e47fc92b89f3250cee8ba75b8c803ccedc78011ecb3030c798aee420b40613a11adeb5d737ae4a496ad6d2869d08247b01b05bb87cb797bb4fbb37e06ed57440a74a8c8ed0f71350d0c2dbb20e07eff5f52465d797355188a4de3986a65d38f3064e25c7dfa9ded9d7928f7ebdc04485356aee96623bb955149df7810ebfcce9515ec6c44a021af2edf703344ef4adcc5174004ad8e0ac3ae9c4cf2dbf092c1104092aebceed3e70dafa652e09a5d310b2323ad1ec9b41de2bcbe69802f4ed82dd4441c0c7e11319bce0fced74bb4e8119ae6adc72e22bd466c37da091887a73b8c9a49dfe248fe440ef5f1e30928f4d6002403338820ba263596e9622de768a6ea0ea3369a0baa180c4f8ca861993da7e4b2bb055fa1f31603c5e63c7488b2e1bb606b6e2380171175775b9e1e424e15bfb2b74c6b83736d029f13944d26e0b88b972b66525c4890a84f8c886e4214e41bbbaea32eebd107a94fab72aa6f36b77682acc0b5346573b769fc0e24a023f0ef3b8d11f3d4fbd6a07112c8c0f005f457dea878b98d03cfd80459080ae234061dcfd730c0296bdbacf7b0383ddcd3fbe064ae38ea6bcdb71df2af7ee3b3c55e560fac67aa03d1b0abb72a758a3debb1c77c59d4dccf52f56ed51c4b20265ce754d093729530928797ebf872cf6b3e88cd164cd5ae07a0beda7592c1cc28b28504d776bef63a5d733b8af0cb9acc0b006859bd1d721cfb65c42242c56b42e7f83e68629cee9b548e532b8b5766247543ac2f6d6ab403917de3b086ae7ce2984f6f602864ac76705cac5e045f1729956bbc050f5caa92d245a698f583659197fc0e9b67daea8895feb57f86095ce2d6cec6f997a210fed5a7ba516493534a803972df3f7e7aa217bc1492c5ea2839cc7e247f335a73252561f3a740a646e6e3e515e6828b78f8d5bde14917b30d33b56ead5bd8e889655a4799b16b64fa5abc3c8ac6561c87ac4c340814d97523509251d280d6ab0a68118acea27dd017196547201a251c340dab1d29bc59b5f501872165a93b276799347ea8b51f505c781962b290a3a4eb7a6908f75750937d5178b8e921219860e4cb8a8b9b83e3e71ee5ffcce3ac798aa27ee1564d7b21823139665642c1bcff6aacd3ca512b8a3ad27aca41ecf0eed6325b6e742cc4b95cabf0ded072cc0214f54c6b22936b0bbf24d3f2e1f907e2afb494b6b5aa1f9779563b8fdfb8aef805ca94c478499a7acba50f989bcd85ebb2a806b46b688b6986eb3f87a76905c2255eeff4468f1faa751e5631342463366b4b5e85f2a48b65c1aad4622bf9260233b83a14bbe6316dd2c38c23c8bca459e850b94c5474a4a1569f789c3c5df43c3d4f1f007f4275723830a92547349b55322c477b1e54b7307fdb09f94d964d640bc86dadddb596ba6e9edc9979fd09b630ed53beea0b9bba5f66f967d058d25267d043c1d67a720627695fcb8eb7810e8700d6f393a42bf6ef2c4ba684bc105e290253ba3caf8a938bb8101900ea65b790eb3b25c295ee7ca21e0c16c81a03dc13a299294ab1efc01f1f94bb577be2313e0518ef7079fbd7fa9f39183e7ffd8b7f87db66a27225fe8fca4ec211093e413ede018b634b2488a68ec1f9e879b2e93a46920c3a5b676e451b07979906e8f79c0faac0ae7e23a4608862605e990daab96ab407e863e8347f8c49b2e0ab05358dc752a8804131bcfdb043164309da0add22144c512064b93647f10cad1a43bba319358480c6e698fee2034d11d1ae1ee1bf9e87e5c9ee220f94931e91b8976795c53f1d1ab78df2d64b0e1d59457c52e06f8b1491ccaae8f2c8c89cd154d00ce2879fd2f2ceb3e7f0b38b38b96152bc839619d274a8b0617f7c34ce33a1be786b3210f93cefe74559f85fa2cb6e50b4f655ebf8b2164ba5506b845f6233ef0918c0e4d8b37749913e13a00252825b0dc839adf18aafd739c12e1008b4469e6eac76456dec06000e10667fee0e3bea3a791b59215b07304c838d0bbd2ea6bf46b50753879331b5d7c66e037e3caec5a11869e74f1626baa7404222a765c02a449f6cc84bc64ef33cc24ff95113c68ec661d3a93010ce8c52ce6d8bbc8efe3bf19a95bd566fd0658686aa3b940d7ada6c367d0d44c06d44942a8ebf0390871c046b3d937daf303df1a7e0c6196cb45ffe6fb83efb84a88bcaa0ef49a87432313bde3b673b2086c843ef681eaeb8c7c1756757e2390502df44e145916efd85dd4d0768eb7418a5434908717e0e6bfb8cf780c54d22fcf7d73c1bda8a00208a8bf51bf7944b46b5c773d268af8c543543fca5f26467da2fdbb964857f237de8c5bb15962c3488dc1ea16f68a36cdd0825a7539e081a684838bdacdf50c8ef4bf48f62b7dda9227db031f3d351bd4abe6bec8a7343b08ef12cedfcf90d945693c7ecb72d89e47b26ed6b669bd777055035962d5b535f75373c66389015bac641dfb4b17a246f234084dae5be7116e87ecf3722c439607a1e45bb7c449cec515844b4af6f1239b6ee8f7faf787e9e17756298a57a861cb369abe6944b3f13f00c14ab336016bedad017fbd68871a2cb155e4e8a1924df9d7bffc27e871398b3f539ac047a197b792cdfd930a165d3ddf4bd903b58cc6306c0a25c1822bc2f9f9df349aae69dd26ae2ab130a132fe3a0e05ee9744a99a9013dcb6a13513bb7f3dcfd88127e50cb4ea18f8445b0507b6c25c822fd82935d7e072212573b06a4324272a9985f377bc1ecd533a9943b13c27115c2be3c0fe6da34b09f766ac7fb14726d60d17c00f8c03bbb24869e42c6011d1f8c69443640135ecf80b31e2f6736dba29bbf6adb36a7ac6fd42d03a9f12df616a1177a3c7a80d1fccbce724d1c54c955d4472a1b115a62d2a5596bbccc0ecfcb105a6bab6d745efafdd58406210a7011a543d265e918dbd6ffce4016def2cb1cf8171805c33b4a0871af7773055414c2da4a38853084727b6ae5797738ce27b5059cc56c60a3afd1b9d4546771147a6f91a13a5c3a6fe80aa9d9dbaada318569306003cd080ec7ab33f6b398dc7d04a0ae1a64f7f9537642d07483d7ba55f3577f440ed50d4f3f079899ec0590fb007736c6e1e53b3c9d82f777c80b78b185fbbd9774a8ddb8656003d1e41531d7ade39f819ce3e0435aadba6dcc12a7f1dbed7423daacd43b6a331873dd7177fa078928a3bdc55dbd7bff082e731379f79f0b2b7865926b4b7d2731eb28216241056b409938d40862bac1885753c136c663b6bff506453607d33790b23b91a3edee1692a8db48e2e9bca085bbc3a04b32b729ec5b3634445d0a1fc547615d87e9e26f733437396ff87e473b4f660f17fe77d308458a4192e229f6d7b0a58c2814e61f163672a1f4ca2c07845e64d5af38a77a7db1b73458d993b8823ecd10540e8331b6a8726b7105d8fbbf02b1bacd43760ce5cc9e0d6890260e5440f18cb0487553a2c59c0f2d331ebfbbbb51417ceeb40519f081d0a1699ec8f38ce0e0b38a1922b6b136c1b926fae53ce559bd2882391466fb9ccfdc3249d0132467e45acb72abfffce4920462e25cae46279be1d48906539be5e2e50bc8a79f94b1fbe4056eaac755a99e355d1d77a275f929785b55b226b047d74fd2ced4c6f12308276458544eb694a1baddce89b63ec855df1102d9d9d93feb07f1134f645e6ba8babdaea893e16fd05daddd3b52b7895de030beb4e7259ab06c30e1abe5203c38027771d0ad116baabffc833114a570f354b3833d9eb4b031b1c41a9f4586200eb98f6c9634cad83f2497f0636dd0fc031eab672d158c23ae2023bc102deb9d992f363748fecb16f0bbaff73e6e7ca44f419885ff5ab39419e62160b515faa6a2be73b371919bcf4e2242170ad5acd7e6ea4b407de0a2786451c0ca38f915be36d61437f9e8b47d9b2e8f9c19b7f271eb0b201e238c1198d0d384da61cc12dfb39614e9b7a47f835a499b87e567a613943347af3bf6b86d4014536264dd96d57031a43c4e3148bc7be15b9a2f2265c76a2e91c3b59a0deb3f485e8688374916a4e9419ce325c4b6906c0eed7e4e30ffe8e0e480acbbe53f9a8eee1e0e769b29c33b962f7773797827a566b33bc7f256ec928c9406385320aff2aea0c2c6ca690170c63637bb61c51a8a1fca0ec339a65976078348e6c09d6a0f71ac4480e62e153c821689ccfb97d4421538aec0628c9a7c3f5d704cffb6741d55165b6f93f20ad44ef2d98328b6e5eb3720a004ad0f1d2bc45acd6307f2be60c09d87b561a77d71fe24072c259c5e6a10694f48e3afaa9c34bfdffd286254c580da41a16a1e2c994d42a01a9657dc73dea35ba11398b75d14f5a497ef87aad1487764c11142c165938b2f21ce1282f39a1d5b969bbecafdaccbb8c03f17d418ecb815f5c10c0a608f247100d64b4f83ccf314ff1b12546a64d9c9dfa99c953f3cde406460e2a3609d70a850539d95abe35e84203315b4cf1914a287e120267bca35a7adc562f62771ba13594215f856e03fe3efa1dbfe9c3ea7b15d1097255c5e36ba22f8e25a1df90590daaf4b2ee07520867a467ed3ea5013ce18b7da7571f18dc11e2f6cc116918dc558a8fda0cdc29f2556ccffe23425addde67c0788b6a18405f00d06b71ea2d98a49549d7b692cc131aad22aaf50a5eef4f7b9311c4f3739fd14ccaa2e674387ae69c8c8b3702df5e0616911c92b12b14f3f1a9df830af052a68ae6e1f98b9f49e0c76195c4134bdc28eb4d6a7644c26044be06f5d1f30f12e128fc704dbbfaa5084fee65a41ec684a16ff38069eb0e356dd8d0b2f70fd2d92e73f723fe57473757685fafb59b15d6a4a78db142a9711f218bbb6b92231f90402419a4838fda0193f6939b940a484578a0fe500e3f604d9f531a18692ec4dcfc5ea84bc3f5bb5b6b2b8e586b4b0ef0a622ae372f34b91a06e1e99476468c460e5bccbf74825ac06fd3d2576e245ef081e4b5420ee368f4aefb4814106bcce86c520e92bf8c746da00dd67d3e172b7ec5db3444191258085fee8329e33c7edf9be74fd9775102327eff47782477be61bca9641dd06620c719efbb36c0484a5ff069a97e5f5a0c060a45c3dbabcfe9028ca0ecc8b38ae942c982288c89899e2112d0415d558d7d3598319c97b8708e01c33ce3ba57d8e8a440deccebab165035039b95659dd6630d35916e5fab35ef9419af2b9f67f4ecd91bb5725d2d67bf62576382c4f83bcfdbaed9febb318be323a98bb22948004b0d8904cc93ea48a78d4e23d30e9848f00301aa05b69d69a9810fbb429ea5208e7fe5c0d6f5d98423bbabc4699ab312c692080a51796f4a68e45bac037efd1bcee88baf9fea5e566663486af9476bea827ee909b85aad6725f110b71944cdb56994682decec94832fac4de3341a34ddea5ef13cd4bb6e45a38df35360b83760ff93bc7c20e39ef23a56cc56932c27f78979d6a7dcc2b4b4f01757d7bc98371260bfad2726bcf3be2d36b918e30e5bbeb43541470c4d1e9de588f250008f36b819c13b1234899c7a8ffe7f873791b1412b1a9bc5f1a784c11c6f2bca03eddcf4b96233a5b462c0b4222e0cc0d568d6c4bc5ed1fe3a368e4eaddb2a3f5d7d839938d8cf113a053be06295230a40abfab9ac151ead7f479991fa0ba59d3b3f9935bdd273568d6d171a39307a51626a21400b274574fba95ba3b367fc19a13b553bdc59ceaa48bcc35ddd98d27fa973e25e94207680fbb6dd41dc36786a55cc236f0611745f50a81c72815e46e7f44d6514bad2bb404cb02849bc763690f1e056b4cf1b9491983b2f976f4a98724ef6b22b4695d9c5a61d7369061bf8fdeba699ce69d90e85b8b80b2f6a595f0d6c44c9ed3012734c1994930905cb56613e9b0a4b3d25b812bf0f1c3f89c248c82259e35436b1ad82a39eda767698f320ee8bd4fecd1dd10557e40229e48c39e74481a0789caf7a1340f15f2f30927eca5926f8db6767e02732277b90cf303c9f9293b414f2c57b72287cab5dcc45bf0e810c9a032a686c6ad12127c9659a506aec01715f72905ac880c834abc55e9fd4a11ab1f5245e0945770c1b8dd5e0ea2e9cebbc5af12ff1982037192843aea482e040787b2289e35591dbf8448d2956a6b8623c046691793c26cbbd86332453e65965e8839fab748d5a24a1e0af068aaa0266a466bdf811250aba72bd5ce2f5ed16f859aaa39284c8a8d352864fd698c9425accbb2b3abf11286fc45994816bce79c376109565e7b7f350735f400b5ed8822037dab36a3a3a2a9b1ff7d2276796421e8d7ea5d6adbd8399a251d76abf71f5edcc179d968e535040450b0c41af7200a800a941fe2e0b39aa744aa149719721ca5587466e7969c0af0ec388f864fbcdd2c0aedea92946e124e72e4b34ee4d0c1a414952d97ae82fd6d129b14884405d70ae2b8614a8187bb29796c8893629bdfd1f8586599a13f90b321555c5c0190957255dad36a25133f6dc95719df656cde1007e9b63dd99d20adc152a507f046ee3a796bca03cbdecc2b395b6fc58881fee42b2333d32a068a8fc404cd1155b7d42132d61e5618983984cfff57b9b926bae86c75411dcc3692dd4a6f3a39b30a551b109d46ecce3f7301d7e32b77880bed5aa08ae6ee47cb92fc12240d7dfb5e882c1f77948692baaf8a6181149d40885d7a8b52182947717dd0be395c174d6c22f8c93fec8650e0a186c82a4abafdb3dff07b68d9d76f0e2298b61c75e6ec3d692b60b6e3119037ffa2f5b16750c6293c8c8d9449e62bd5d0595b6c5ae706bc7b4db7847fb7967eeccac2b4a53c885613f23ca68bc54ffc49277d2b538c1be87c21b29e424120bf9561be2e3c14ad95503cead33cd96feb68f99dc3d67e71f8709c465c4d6aa3bf6e6264d9dba41c4f3b849b8a8a3267d0d5b0b2fe01b6341e787a24bb35df0ac7ec41b9188808548c0d10c24e542b77a2cf880b6e79a9ef143c6c8b0045233db80d1e69fb0a26dd5a7b9a4de692ba6203535fe3cb232268d62d050030d2ba0bbe518677d38329ee0337e62c5896cd81232aa79c4d07afeaa131579b73c45c7e4a289045c7ec565fa8f9841b77ae16f2a0a0b9102d33987d11e6bfe0398bbafeb13faacf8fe402df4c7b9b89bdf41f3cd4bbc9164da53b9169dbec9a646ac19d689f3d2fa356b4b4f6d79b7208620938f1296e08fc692105c165e07ed2e818a0c240dca82570984472eea90abae682c6427fef020e97e0d17770651644132e48133ae8832b2b39e86705279f3787ed8de8cc0343909c8a6101adf35f5b62d0a5de545526647766ea6f028c62f52f9e9afa2527fde3298a7a736871814aaaf3a118ca625dccd044f4c00b682c65ec92d1b27f35c9afaf16c37bf3bb75795ff633143f7e9178c291375efa9e571352a46501cd54804d6d8d28fe2e41c3227f710a0ea96c89b883b276afc975231dcd212c1ae61d22c97859679442e9e7e1decac72f66992beba7cab87346a179cc33dd455cefcef3e86fc7e861ef363515ddae43d9af93d15aa2d5d4503512d052ef9d660c4b2cdbb87d3993f96d3c93b369948ee5e1fe5d30286d12d226ebdcc957d19ee33d95dbdc44a5f66c54b338c7070c6808cbe5a63b6dd94a820a448f4762387199589495399d903ef22c9428323f1ec1483b30077a0d3f497d8f64b0965c2b525221263edf85778da62dd2a8985c7d549cc09837270ec8f05818671911bd81166b0222dd2c7ee3f32e7c84f0cd1acf33bd82843432e67cbb0a9ec3ac83f9f03fccf25c249735c568f498c5bb1a7132de24e4b6c9f7bd247bac3319693dc3641690418ece6973228493b3b45b25c33bb67f94463b58aac5848dff2740ac0ed8e75c288b95ab9f5c5ade8e7187b450384354dc27ca1c3b34bf8db560efc659ea45259fb045798934f7701f1cdec03685934670d8b3b978371330e4df1c38015b9ef963ccf0ddcd8ea41d6709da127ba47b48216b002f571b1ae6a522dfaafa56f607498cea20b5d059a5520e699c70eac56e302ccac6cd33e9eb2ade97d172ee26def8c8b387fff09fd4775c9cfbe304d4b07970b95469b22406b754489ff02235c775895847f11473039f495cc756cb68b3b8329c14734ea0332b876187f13a922e62c4d2ef20e11ad7caac85005cb0cc2a59fe8ed29fb85ac01fa91ce524332d78d7a03f0da78a13c420fe40c10134f8497a29e6a5c7d12f0dc1dfd8fa94e9ed10cb840522d6a1b5b32342d39788a75babe1aabead5c71b13a99810611375ece01a62c987645208b61fed5861d886eb567666033bd2e70ed7cc9f11338679e6d4c890c761af279322cc359e6c4dca1b4bfbbdca52a270ee684e61d71f4d60539135268d8fa15d70b1ef67cde14f1144f0b4c0e6149dcf3e9360aff0fad36cf16c88ba18c1a19677fe569163740a0ee04ba13742aa3e04fe0f9706c2ccd2d10beca6daf8ed8f9c36665614386f4f70ce75d493aaf4e1b65fb2241af7911b6d445f85709e9f46cdf712a3f4cfa7216af4ba0cbb57ff2733578733cf44c0672b4cd31eaec3b5e541611fe90179a2c8e51bc490dc1b2154e4f53f7134f64e672387d41b3c3899ef4e634f0ad6d2b13a1eede2ec3cce443d1200c2bd551b04ee6fecebd486991599f5ab20add3017f00a62ec225938ee06c43e7fb93d07d809af82c8cb3d359409f9fc2b7676c98cc09519e8900d8d9b0ee24a79ed1a0af69b035c3827e5be64b594cda570a197ca2f775f7032ee180f7755ed76363dcbd2be74327daa234c8237c7a8eefdbb6572ea8875d717f205aba332f1f15396c7009b759ce3a5585f673d7f6757441ce238c7a6208d728d48082ca78e6dd109f48f56049145203145dbb247c31342f159062bd434b6fbda773845018593b178b56674e0cd815ab2114b56ce66146a0f5aaf00aafb9c16009c05dd69781fb02812f6b4493328c1b037ad332058734db0ad9ce020b9d30882b928ee801ae8485a38bbd894f845c58b4164821a19b29c798212ad11d9eb674101024b6f5fba52594ca55645be23b4684dc2f45bad4bac97696cdd1af88d7b615def7069b27362092555b946c9bd23db03ba1c562882af1de61f91cb0de046c0641d4be17208e9d5d72a5a4ce9e2b640e9fca738ac3d7288407fde978d1477c7564149029a39b2aad60236c79cd3e282803c68129b4b17fe6f9cfc70307d3672363f8f832ac6d08e3f4ff937ee992616c5953c81d85b0ccfed4d08154a81616dcc6fc9efb86f85779c603fab2b391595b7d46c576a6aa7e63a72a0abee884490388a79e1d0647f3bc91249f99e430c6eac8c4ce2356334f898b880aae41e3fa7a752887b91165c3b7ec0f8e3c8430a2c578999eb1a586e1be0ed375879ed3048a458f2daaabf377a17427f816a78b999c820d594efd6406556837d4e9a3955bf78f2e9e9092a4d9791b9a1ac042bdc46df49100bfc5a81a8d3c5a59b9326d14263bfdbad81a7d5890e3eb9dd972914f51e08cae1ece896607102a2c29daccad19289703295b65cf8d9c94a80533a2ba4cc28ffb1862a2871d7ec0a15b2c4beb1ad0533407149d2bd8a7b8fedb4c7710660a6c269e72e98775c6240f216d6ac91dbc911c985045dce74479b4e818bcf45b88732090dbd258e05ccdc2956962a2c4935a38ba3de83f3f7cd4f6ba163c216b1bb8bdfb312c2c6fbb8e87422b40001e01bb6049ab47dca6294c1a7c6b829909638ec8abf4bc210d4c6026953b42694a1b91a1f9407825123dac97a76b378d58a3f8a6e82314baf2dd925da</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-up">
      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-up">内容已加密，请输入密码后阅读</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>2023羊城杯</title>
    <url>/2023/09/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/</url>
    <content><![CDATA[<p>林花谢了春红，太匆匆。无奈朝来寒雨晚来风。</p>
<span id="more"></span>

<p>比赛成绩并不算好，不过挺开心的</p>
<p><img src="/../../images/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/1.png"></p>
<p><img src="/../../images/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/2.png"></p>
<p>前一天玩游戏玩晚了，导致今天状态挺不好的。很多题能更早做出来，却卡了很久。</p>
<p>经过这次比赛又学到了好多</p>
<h1 id="Danger-RSA"><a href="#Danger-RSA" class="headerlink" title="Danger_RSA"></a>Danger_RSA</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>(<span class="params">a, nbit</span>):</span><br><span class="line">    <span class="keyword">assert</span> a &gt;= <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        X = getRandomInteger(nbit // a)</span><br><span class="line">        s = getRandomRange(<span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">4</span>), <span class="built_in">pow</span>(<span class="number">2</span>, a ** <span class="number">2</span> - a + <span class="number">5</span>))</span><br><span class="line">        p = X ** a + s</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> (p, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, s = get_key(a, <span class="number">1024</span>)</span><br><span class="line">q, t = get_key(a, <span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">e = s * t</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N =&quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># N = </span></span><br><span class="line"><span class="comment"># e = 11079917583</span></span><br><span class="line"><span class="comment"># c = </span></span><br></pre></td></tr></table></figure>

<p>根据$p,q$的生成方式可知$p &#x3D; x^4+s,q &#x3D; y^4+t$</p>
<p>根据$e$的比特大小判断出$a&#x3D;4,s &#x3D; 17bit,t &#x3D; 17bit$</p>
<p>把$e$分解后得到$e &#x3D; 3\times7^2 \times 19 \times 691 \times 5741$</p>
<p>选出<strong>合适</strong>的乘积作为$s,t$</p>
<p>$\therefore p &#x3D;x^4 + s,q &#x3D; y^4 + t$，$p \approx x^4,q \approx y^4$</p>
<p>则$n \approx(xy)^4 \longrightarrow xy &#x3D; n^{\frac{1}{4}}$</p>
<p>得到$xy$之后</p>
<p>联立$n &#x3D; (x^4+s)(y^4+t)$与$x\times y &#x3D; xy$</p>
<p>解出$x,y$，<strong>这里要注意的是，s,t要选合适，才有整数解</strong>，多试试</p>
<p>然后就能出p,q了，发现$e$和$\phi(n)$不互素</p>
<p>处理一下即可</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">20289788565671012003324307131062103060859990244423187333725116068731043744218295859587498278382150779775620675092152011336913225797849717782573829179765649320271927359983554162082141908877255319715400550981462988869084618816967398571437725114356308935833701495015311197958172878812521403732038749414005661189594761246154666465178024563227666440066723650451362032162000998737626370987794816660694178305939474922064726534186386488052827919792122844587807300048430756990391177266977583227470089929347969731703368720788359127837289988944365786283419724178187242169399457608505627145016468888402441344333481249304670223</span></span><br><span class="line">e = <span class="number">11079917583</span></span><br><span class="line">c = <span class="number">13354219204055754230025847310134936965811370208880054443449019813095522768684299807719787421318648141224402269593016895821181312342830493800652737679627324687428327297369122017160142465940412477792023917546122283870042482432790385644640286392037986185997262289003477817675380787176650410819568815448960281666117602590863047680652856789877783422272330706693947399620261349458556870056095723068536573904350085124198592111773470010262148170379730937529246069218004969402885134027857991552224816835834207152308645148250837667184968030600819179396545349582556181916861808402629154688779221034610013350165801919342549766</span></span><br><span class="line"></span><br><span class="line">s = <span class="number">120561</span></span><br><span class="line">t = <span class="number">91903</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ab = <span class="built_in">int</span>(gmpy2.iroot(n,<span class="number">4</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># var(&#x27;a b&#x27;)</span></span><br><span class="line"><span class="comment"># f1 = a*b-ab</span></span><br><span class="line"><span class="comment"># f2 = ab^4 + a^4*t + b^4*s + s*t - n</span></span><br><span class="line"><span class="comment"># ans = solve([f1,f2],[a,b])</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">47783641287938625512681830427927501009821495321018170621907812035456872958654</span></span><br><span class="line">b = <span class="number">44416071018427916652440592614276227563515579156219730344722242565477265479486</span></span><br><span class="line"></span><br><span class="line">p = a^<span class="number">4</span> + s</span><br><span class="line">q = b^<span class="number">4</span> + t</span><br><span class="line"><span class="keyword">assert</span> p*q == n</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(gcd(e,phi))</span></span><br><span class="line"><span class="comment"># 21</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e // <span class="number">21</span>,p - <span class="number">1</span>)</span><br><span class="line">m_21 = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="comment">#求出m的21次方</span></span><br><span class="line">e = <span class="number">21</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt;=PolynomialRing(Zmod(p))</span><br><span class="line">f = x^e - m_21</span><br><span class="line">f = f.monic()</span><br><span class="line">mps = f.roots()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> mps:</span><br><span class="line">    flag=long_to_bytes(<span class="built_in">int</span>(i[<span class="number">0</span>]))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>一般flag没有填充的情况下，会小于p，所以用$p,q$单独作公钥求解</p>
<p>求解出$m^{21} \equiv c^{d} \mod p$</p>
<p>再用多项式环求根	</p>
<p>参考：<a href="https://blog.csdn.net/m0_63321019/article/details/131805582?spm=1001.2014.3001.5501">2023 CryptoCTF wp by lingfeng (medium分类——1)_c_ling_feng的博客-CSDN博客</a></p>
<h1 id="Easy-3L"><a href="#Easy-3L" class="headerlink" title="Easy_3L"></a>Easy_3L</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    p = getPrime(<span class="number">1400</span>)</span><br><span class="line">    f = getRandomNBitInteger(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(f, q) != <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = (invert(f, p) * q) % p</span><br><span class="line">    <span class="keyword">return</span> p, h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt1</span>(<span class="params">m</span>):</span><br><span class="line">    a = getPrime(<span class="number">250</span>)</span><br><span class="line">    b = getRandomNBitInteger(<span class="number">240</span>)</span><br><span class="line">    n = getPrime(<span class="number">512</span>)</span><br><span class="line">    seed = m</span><br><span class="line">    s = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line">    s[<span class="number">0</span>] = seed</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">        s[i] = (s[i - <span class="number">1</span>] * a + b) % n</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt2</span>(<span class="params">msg, p, h</span>):</span><br><span class="line">    s = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">    c = (s * h + msg) % p</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = encrypt1(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S1 =&quot;</span>, s[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S2 =&quot;</span>, s[<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S4 =&quot;</span>, s[<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;S5 =&quot;</span>, s[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">p, h = get_key()</span><br><span class="line">c = encrypt2(s[<span class="number">3</span>], p, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h =&quot;</span>, h)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># S1 = </span></span><br><span class="line"><span class="comment"># S2 = </span></span><br><span class="line"><span class="comment"># S4 = </span></span><br><span class="line"><span class="comment"># S5 = </span></span><br><span class="line"><span class="comment"># p = </span></span><br><span class="line"><span class="comment"># h = </span></span><br><span class="line"><span class="comment"># c = </span></span><br></pre></td></tr></table></figure>

<p><strong>没给出S3，要先把S3求出来，然后就是LCG求解</strong></p>
<p>已知$c \equiv sh+msg \mod p \longrightarrow c &#x3D; sh + msg +kp$</p>
<p>$\therefore msg &#x3D; c - sh -kp$</p>
<p>构造这样的格</p>
<p><img src="/../../images/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/3.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">25886434964719448194352673440525701654705794467884891063997131230558866479588298264578120588832128279435501897537203249743883076992668855905005985050222145380285378634993563571078034923112985724204131887907198503097115380966366598622251191576354831935118147880783949022370177789175320661630501595157946150891275992785113199863734714343650596491139321990230671901990010723398037081693145723605154355325074739107535905777351</span></span><br><span class="line">h = <span class="number">2332673914418001018316159191702497430320194762477685969994411366563846498561222483921873160125818295447435796015251682805613716554577537183122368080760105458908517619529332931042168173262127728892648742025494771751133664547888267249802368767396121189473647263861691578834674578112521646941677994097088669110583465311980605508259404858000937372665500663077299603396786862387710064061811000146453852819607311367850587534711</span></span><br><span class="line">c = <span class="number">20329058681057003355767546524327270876901063126285410163862577312957425318547938475645814390088863577141554443432653658287774537679738768993301095388221262144278253212238975358868925761055407920504398004143126310247822585095611305912801250788531962681592054588938446210412897150782558115114462054815460318533279921722893020563472010279486838372516063331845966834180751724227249589463408168677246991839581459878242111459287</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [-p,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [-h,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [c,<span class="number">0</span>,<span class="number">2</span>^<span class="number">512</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">1</span>]) == <span class="number">2</span>^<span class="number">512</span>:</span><br><span class="line">        S3 = i[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">S1 = <span class="number">28572152986082018877402362001567466234043851789360735202177142484311397443337910028526704343260845684960897697228636991096551426116049875141</span></span><br><span class="line">S2 = <span class="number">1267231041216362976881495706209012999926322160351147349200659893781191687605978675590209327810284956626443266982499935032073788984220619657447889609681888</span></span><br><span class="line">S4 = <span class="number">9739918644806242673966205531575183334306589742344399829232076845951304871478438938119813187502023845332528267974698273405630514228632721928260463654612997</span></span><br><span class="line">S5 = <span class="number">9755668823764800147393276745829186812540710004256163127825800861195296361046987938775181398489372822667854079119037446327498475937494635853074634666112736</span></span><br><span class="line"></span><br><span class="line">output = [S1,S2,S3,S4,S5]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(output)):</span><br><span class="line">    t.append(output[i]-output[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">T = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">    T.append(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)-<span class="number">1</span>):</span><br><span class="line">    mm = gmpy2.gcd(T[i],T[i+<span class="number">1</span>])</span><br><span class="line">    m.append(<span class="built_in">int</span>(mm))</span><br><span class="line"><span class="comment"># print(m)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        a = gmpy2.invert(t[<span class="number">0</span>],i) * t[<span class="number">1</span>] % i</span><br><span class="line">        b = output[<span class="number">1</span>] - a*output[<span class="number">0</span>] % i</span><br><span class="line">        a_ = gmpy2.invert(a,i)</span><br><span class="line"></span><br><span class="line">        seed = a_ * (output[<span class="number">0</span>]-b) % i</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(seed))</span><br></pre></td></tr></table></figure>

<h1 id="signinCrypto"><a href="#signinCrypto" class="headerlink" title="signinCrypto"></a>signinCrypto</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> key</span><br><span class="line"><span class="keyword">from</span> iv <span class="keyword">import</span> iv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">K1= key</span><br><span class="line">hint1 = os.urandom(<span class="number">2</span>) * <span class="number">8</span></span><br><span class="line">xor =bytes_to_long(hint1)^bytes_to_long(K1)</span><br><span class="line"><span class="built_in">print</span>(xor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Rand</span>():</span><br><span class="line">    rseed = secrets.randbits(<span class="number">1024</span>)</span><br><span class="line">    List1 = []</span><br><span class="line">    List2 = []</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        rand16 = getrandbits(<span class="number">16</span>)</span><br><span class="line">        List1.append(rand16)</span><br><span class="line">    seed(rseed)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">312</span>):</span><br><span class="line">        rand64 = getrandbits(<span class="number">64</span>)</span><br><span class="line">        List2.append(rand64)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="keyword">for</span> rand16 <span class="keyword">in</span> List1:</span><br><span class="line">            file.write(<span class="built_in">hex</span>(rand16)+ <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> rand64 <span class="keyword">in</span> List2:</span><br><span class="line">            file.write(<span class="built_in">hex</span>((rand64 &amp; <span class="number">0xffff</span>) | ((rand64 &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffff</span>) &lt;&lt; <span class="number">16</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">Rand()</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(getrandbits(<span class="number">64</span>))</span><br><span class="line">K3 = flag[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">KEY = K1 + K2 + K3</span><br><span class="line"></span><br><span class="line">IV=iv</span><br><span class="line"></span><br><span class="line">IV1=IV[:<span class="built_in">len</span>(IV)//<span class="number">2</span>]</span><br><span class="line">IV2=IV[<span class="built_in">len</span>(IV)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">digest1 = hashlib.sha512(IV1).digest().<span class="built_in">hex</span>()</span><br><span class="line">digest2 = hashlib.sha512(IV2).digest().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">digest=digest1+digest2</span><br><span class="line">hint2=(bytes_to_long(IV)&lt;&lt;<span class="number">32</span>)^bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(bytes_to_long((digest.encode()))))</span><br><span class="line"><span class="built_in">print</span>(hint2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mode = DES3.MODE_CBC</span><br><span class="line">des3 = DES3.new(KEY, mode, IV)</span><br><span class="line"></span><br><span class="line">pad_len = <span class="number">8</span> - <span class="built_in">len</span>(flag) % <span class="number">8</span></span><br><span class="line">padding = <span class="built_in">bytes</span>([pad_len]) * pad_len</span><br><span class="line">flag += padding</span><br><span class="line"></span><br><span class="line">cipher = des3.encrypt(flag)</span><br><span class="line"></span><br><span class="line">ciphertext=cipher.<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 334648638865560142973669981316964458403</span></span><br><span class="line"><span class="comment"># 0x62343937373634656339396239663236643437363738396663393438316230353665353733303939613830616662663633326463626431643139323130616333363363326631363235313661656632636265396134336361623833636165373964343533666537663934646239396462323666316236396232303539336438336234393737363465633939623966323664343736373839666339343831623035366535373330393961383061666266363332646362643164313932313061633336336332663136323531366165663263626539613433636162383363616537396434353366653766393464623939646232366631623639623230353933643833</span></span><br><span class="line"><span class="comment"># 22078953819177294945130027344</span></span><br><span class="line"><span class="comment"># a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1</span></span><br></pre></td></tr></table></figure>

<p>重点是求<code>KEY</code>和<code>IV</code></p>
<p>观察代码，能猜测出，<code>K1</code>，<code>IV</code>，长度为8，</p>
<p>说明<code>xor =bytes_to_long(hint1)^bytes_to_long(K1)</code>，hint1的高位没有受影响</p>
<p>输出<code>long_to_bytes(xor)</code>，能够得到<code>hint1 = b&#39;\xfb\xc2&#39; * 8 </code></p>
<p>随即能出<code>K1 = b&quot;dasctfda&quot; </code></p>
<p><code>K2</code>通过随机数求得</p>
<p>给出的是<code>rand64[16:32]+rand64[48:64]</code></p>
<p><strong>随机数的生成机制：</strong> 通过生成32bit的数进行拼接或者移位（大佬教的）</p>
<p><strong>如果要生成16bit的数，是先生成32bit再取这个数的高16位</strong></p>
<p><strong>如果要生成64bit的数，先生成两个32bit的数</strong><code>x1</code>,<code>x2</code>，再进行拼接<code>x2||x1</code></p>
<p>本题中，因为两次seed是一样的，所以<code>rand16</code>就是<code>x1</code>的前16位，后面输出的<code>rand16</code>是<code>x2</code>的前16位</p>
<p>而<code>rand64 = x2[:16] || rand64[16:32] || x1[:16] || rand64[48:64]</code></p>
<p>这样就有了全部<code>rand64</code>，一共312个<code>rand64</code></p>
<p><code>K3</code>前七位是<code>DASCTF&#123;</code>，最后一位不太确定</p>
<p>又因为<code>hint2=(bytes_to_long(IV)&lt;&lt;32)^bytes_to_long(os.urandom(8))</code>，说明<code>IV</code>的前面32bit不受影响</p>
<p>直接打印出，得到<code>b&#39;GWHT&#39;</code>，注意到给出的那一段数据是两端重复数据拼接在一起的。</p>
<p>说明<code>IV1 = IV2 = b&#39;GWHT&#39;</code>，$\therefore$<code>IV = b&#39;GWHTGWHT&#39;</code></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> extend_mt19937_predictor <span class="keyword">import</span> ExtendMT19937Predictor</span><br><span class="line"></span><br><span class="line">predictor = ExtendMT19937Predictor()</span><br><span class="line"></span><br><span class="line">xor = <span class="number">334648638865560142973669981316964458403</span></span><br><span class="line"><span class="comment"># print(long_to_bytes(xor))</span></span><br><span class="line"></span><br><span class="line">hint1 = <span class="string">b&#x27;\xfb\xc2&#x27;</span> * <span class="number">8</span></span><br><span class="line"></span><br><span class="line">K1 = long_to_bytes(bytes_to_long(hint1) ^ xor)</span><br><span class="line"><span class="comment"># print(K1)</span></span><br><span class="line"><span class="comment"># K1 = b&#x27;dasctfda&#x27;</span></span><br><span class="line">hint2 = <span class="number">22078953819177294945130027344</span></span><br><span class="line"><span class="comment"># print(long_to_bytes(hint2))</span></span><br><span class="line"></span><br><span class="line">K1 = <span class="string">b&quot;dasctfda&quot;</span></span><br><span class="line">IV = <span class="string">b&quot;GWHTGWHT&quot;</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;task.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f.readlines():</span><br><span class="line">    data.append(<span class="built_in">eval</span>(i))</span><br><span class="line"></span><br><span class="line">data1 = data[:<span class="number">624</span>]</span><br><span class="line">data2 = data[<span class="number">624</span>:]</span><br><span class="line"></span><br><span class="line">data3 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data2:</span><br><span class="line">    b = (i &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xffff</span></span><br><span class="line">    d = i &amp; <span class="number">0xffff</span></span><br><span class="line">    data3.append(d)</span><br><span class="line">    data3.append(b)</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(data1,data3):</span><br><span class="line">    t = (i &lt;&lt; <span class="number">16</span>) + j</span><br><span class="line">    predictor.setrandbits(t,<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">K2 = long_to_bytes(predictor.predict_getrandbits(<span class="number">64</span>))</span><br><span class="line"><span class="comment"># print(K2)</span></span><br><span class="line">K3 = <span class="string">b&quot;DASCTF&#123;&quot;</span></span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;a6546bd93bced0a8533a5039545a54d1fee647007df106612ba643ffae850e201e711f6e193f15d2124ab23b250bd6e1&quot;</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">8</span>):</span><br><span class="line">    KEY = K1 + K2 + K3 + long_to_bytes(i)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        mode = DES3.MODE_CBC</span><br><span class="line">        des3 = DES3.new(KEY, mode, IV)</span><br><span class="line">        flag = des3.decrypt(c)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#123;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<h1 id="esyRSA——复现"><a href="#esyRSA——复现" class="headerlink" title="esyRSA——复现"></a>esyRSA——复现</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"><span class="keyword">from</span> md5 <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q</span><br><span class="line"></span><br><span class="line">e = ?????</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">ans = gcd(e,phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> n, e, d</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Flag: DASCTF&#123;%s&#125;&quot;</span> %md5(<span class="built_in">str</span>(p + q)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = </span></span><br><span class="line"><span class="string">d = 14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>发现这个n是有重复部分的，把重复部分删去后是正确的n</p>
<p><code>n=80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</code></p>
<p>$\because ed \equiv 1 \mod \phi(n)$</p>
<p>$\longrightarrow ed &#x3D; k\phi(n) + 1\$</p>
<p>同除$e \times \phi(n)$</p>
<p>$\longrightarrow \frac{d}{\phi(n)} &#x3D; \frac{k}{e} + \frac{1}{e\times \phi(n)}$</p>
<p>$\because \phi(n) \approx n$</p>
<p>$\therefore 上式 \longrightarrow \frac{d}{n} \approx \frac{k}{e}$</p>
<p>对$\frac{d}{n}$进行连分数展开，得到的一串分数的分母很可能就是e</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">n = <span class="number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line">d = <span class="number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"></span><br><span class="line">c = continued_fraction(Integer(d) / Integer(n))</span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    k = <span class="built_in">int</span>(c.numerator(i))       <span class="comment">#取连分数的分子</span></span><br><span class="line">    e = <span class="built_in">int</span>(c.denominator(i))     <span class="comment">#取连分数的分母</span></span><br><span class="line">    <span class="comment">#计算kphi</span></span><br><span class="line">    <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">str</span>(e)) == <span class="number">5</span>:</span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p_q = n - phi + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;p+q=&quot;</span>,p_q)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line">        <span class="comment"># e = 13521</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;k=&quot;</span>,k)</span><br><span class="line">        <span class="comment"># k = 2384</span></span><br><span class="line">        var(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">        f1 = p * q - n</span><br><span class="line">        f2 = p + q - p_q</span><br><span class="line">        sol = solve([f1,f2],[p,q])</span><br><span class="line">        <span class="built_in">print</span>(sol)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">7920625690369490250766357750388349704260128405941822835255851274284409978206593795103040446837018619894098452542488850045009467407103749792461438242280929</span></span><br><span class="line">q = <span class="number">10181341212828413853336916619161138854377885230386496425058202154486415709366161346816273366144505351043947477469664133317598479763451392984403646602585037</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;DASCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(p+q).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>另外一种用格的思路解决</p>
<p>$\because ed \equiv 1 \mod phi$</p>
<p>$\therefore ed &#x3D; kphi + 1 \longrightarrow ed &#x3D; k(n - p - q + 1) + 1$</p>
<p>$ed &#x3D; kn - k(p+q-1)+1$</p>
<p>$k(p+q-1)-1 &#x3D; kn -ed$</p>
<p>构造格</p>
<p><img src="/../../images/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/4.png"></p>
<p>规约后能得到e，再求<code>k(p+q-1)</code>和<code>ed - 1</code>的公因数得到k</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">n = <span class="number">80642592772746398646558097588687958541171131704233319344980232942965050635113860017117519166348100569115174644678997805783380130114530824798808098237628247236574959152847903491509751809336988273823686988619679739640305091291330211169194377552925908412183162787327977125388852329089751737463948165202565859373</span></span><br><span class="line">d = <span class="number">14218766449983537783699024084862960813708451888387858392014856544340557703876299258990323621963898510226357248200187173211121827541826897886277531706124228848229095880229718049075745233893843373402201077890407507625110061976931591596708901741146750809962128820611844426759462132623616118530705745098783140913</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [<span class="number">2</span>^<span class="number">512</span> , d],</span><br><span class="line">    [<span class="number">0</span> , n]]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">L = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">e = <span class="built_in">abs</span>(L[<span class="number">0</span>]) // <span class="number">2</span>^<span class="number">512</span></span><br><span class="line"></span><br><span class="line">k = gcd(e*d - <span class="number">1</span>,L[<span class="number">1</span>]+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p_q = (L[<span class="number">1</span>]+<span class="number">1</span>) // k + <span class="number">1</span></span><br><span class="line">flag = <span class="string">&quot;DASCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(p_q).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h1 id="MCeorpkpleer"><a href="#MCeorpkpleer" class="headerlink" title="MCeorpkpleer"></a>MCeorpkpleer</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params"><span class="built_in">list</span>, m, w</span>):</span><br><span class="line">    pubkey_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin)):</span><br><span class="line">        pubkey_list.append(w * <span class="built_in">list</span>[i] % m)</span><br><span class="line">    <span class="keyword">return</span> pubkey_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_cry</span>(<span class="params">e, pubkey</span>):</span><br><span class="line">    pubkey_list = pubkey</span><br><span class="line">    encode = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">        encode += pubkey_list[i] * <span class="built_in">int</span>(e[i]) % m</span><br><span class="line">    <span class="keyword">return</span> encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">e_bin = (<span class="built_in">bin</span>(e))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">list</span> = [<span class="built_in">pow</span>(<span class="number">3</span>, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e_bin))]</span><br><span class="line">m = getPrime(<span class="built_in">len</span>(<span class="built_in">bin</span>(<span class="built_in">sum</span>(<span class="built_in">list</span>))) - <span class="number">1</span>)</span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">pubkey = pubkey(<span class="built_in">list</span>, m, w)</span><br><span class="line">en_e = e_cry(e_bin, pubkey)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;n = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;c = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;pubkey = &#123;&#125;\n&#x27;</span></span><br><span class="line">      <span class="string">&#x27;en_e = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>((p &gt;&gt; <span class="number">435</span>) &lt;&lt; <span class="number">435</span>, n, c, pubkey, en_e))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = </span></span><br><span class="line"><span class="string">n = </span></span><br><span class="line"><span class="string">c = </span></span><br><span class="line"><span class="string">pubkey = </span></span><br><span class="line"><span class="string">en_e = 31087054322877663244023458448558</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>给出<code>p</code>的高位，coppersmith梭出<code>p</code>。</p>
<p>需要求一下<code>e</code></p>
<p>观察加密发现，<code>list</code>是固定的，因为<code>len(e_bin)==64</code></p>
<p>而且<code>pubkey</code>的第一位就是<code>w</code></p>
<p>又$\because pubkey_i \equiv list_i × w \mod m$</p>
<p>$\therefore km &#x3D; list_i \times w-pubkey_i$</p>
<p>通过这个，求出几个<code>km</code>，再求公因数，经过验证即可求得<code>m = 4522492601441914729446821257037 </code></p>
<p>然后感觉是解背包加密$c &#x3D; (pubkey_1×e_1 \mod m) + \dots + (pubkey_{64}×e_{64}\mod m) $</p>
<p>构造格<br>$$<br>\begin{pmatrix}<br>1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; key_1\<br>0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; key_2\<br>0 &amp; 0 &amp; 1 &amp; \dots &amp; 0 &amp; 0 &amp; key_3\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; 0 &amp; \dots &amp; 1  &amp; 0&amp; key_{64}\<br>0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1 &amp; c\<br>0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; p<br>\end{pmatrix}<br>$$<br>正确结果卡在中间，一开始没发现，以为是自己思路错了。<del>草！！！！！！</del></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">phigh = </span><br><span class="line">N = </span><br><span class="line">enc = </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = phigh + x</span><br><span class="line">root = f.small_roots(X = <span class="number">2</span>^<span class="number">435</span>,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> root:</span><br><span class="line">    p = phigh + <span class="built_in">int</span>(root[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line">    q = N // p</span><br><span class="line">    </span><br><span class="line">mod = </span><br><span class="line">pubkey = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(pubkey)</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Ge[i,i] = <span class="number">1</span></span><br><span class="line">    Ge[i,-<span class="number">1</span>] = pubkey[i]</span><br><span class="line"></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">1</span>] = c</span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = mod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        tmp = i[:-<span class="number">2</span>]</span><br><span class="line">        ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> tmp:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(j) == <span class="number">0</span>:</span><br><span class="line">                ans += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(j) == <span class="number">1</span>:</span><br><span class="line">                ans += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        e = <span class="built_in">int</span>(ans,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> isPrime(e) <span class="keyword">and</span> e.bit_length() == <span class="number">64</span>:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line">            d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            m = <span class="built_in">pow</span>(enc,d,N)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p><del>下次一定看清楚www</del></p>
<p>另外一种解法是利用上<strong>超递增序列</strong><code>list</code></p>
<p>$\because c &#x3D; (pubkey_1×e_1 \mod m) + \dots + (pubkey_{64}×e_{64}\mod m)$</p>
<p>把$pubkey \equiv w \times list$代入</p>
<p>$\therefore c &#x3D; (w \times list_1 \times e_1 \mod m) + \dots + (w \times list_{64} \times e_{64} \mod m)$</p>
<p>$\therefore c \equiv w(list_1 \times e_1 + \dots +list_{64}\times e_{64} ) \mod m$</p>
<p>$c \times w^{-1} \equiv list_1 \times e_1 + \dots +list_{64}\times e_{64}  \mod m$</p>
<p><code>list</code>是个超递增序列</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">31087054322877663244023458448558</span></span><br><span class="line">mod = <span class="number">4522492601441914729446821257037</span></span><br><span class="line">w = <span class="number">18143710780782459577</span></span><br><span class="line"></span><br><span class="line">c = c * inverse(w,mod) % mod</span><br><span class="line"></span><br><span class="line">list1 = [<span class="built_in">pow</span>(<span class="number">3</span>, i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list1[::-<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">if</span> c &gt;= i:</span><br><span class="line">        m += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        c -= i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        </span><br><span class="line">e = <span class="built_in">int</span>(m[::-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment"># e =15960663600754919507</span></span><br></pre></td></tr></table></figure>

<h1 id="XOR贯穿始终"><a href="#XOR贯穿始终" class="headerlink" title="XOR贯穿始终"></a>XOR贯穿始终</h1><p>先核心价值观解码得到压缩包的密钥：<code>C0ngr4tulati0n5_y0u_fou^d_m3</code></p>
<p>拿到题目，以及私钥文件</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> enflag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = q * p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = getPrime(<span class="number">17</span>)</span><br><span class="line"><span class="keyword">assert</span> gcd(e, phi) == <span class="number">1</span></span><br><span class="line"><span class="comment"># 以上信息生成了私钥文件,但文件被损坏了你能提取有用信息吗</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(enflag, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALmtMy+2uH1ZtbIL</span><br><span class="line">SuiAukFthyQRH5mp7UmLyzZQkdg9zEP9/5tgffikQ7ytx5kHySHnazgAO1sOzmYE</span><br><span class="line">N4Axlev6uafiP8B1Eij97v5VkYJ1I9e3mtBNheTbXKoT8op+ASQ1fQaF4A8UzLuW</span><br><span class="line">eZeZI8JTH/SH+bolAK3kiZXDFdkTAgMBAAECgYEAl067LaC7Cvs2A5cMPhfYsESv</span><br><span class="line">IgcKN1CwW4Sd3u8dSphhgu7TgyzIuvwxbuo2g1BC6WwKhaI6vGN+csfw6nh98GEn</span><br><span class="line">/p3D0huNroAYvf/DRRB9UnHdttX7wB+Mv3P0RBDWHgBiCDVvHFuFUV78cIs0tnbn</span><br><span class="line">jxjU07aPV2XRC3AfA2ECQQDqWUNPVg3i6vTyHCL7EGkbeUheYpAAfcKCQrxjc5+<span class="number">5</span></span><br><span class="line">X6A+XtgHAA1JHwykPlCpHUOmlA85DJF1ejuoImzlgRLJAkEAytTCnQF+MN2r1gaA</span><br><span class="line">UETZyj5qMYT7Th8zKEVVVJjDawLnuX4usJ2FyRnjCkk86U75QSJhw5mMc0QnG25u</span><br><span class="line">Gz3++w==</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>私钥文件base64解密再转16进制</p>
<p>根据<a href="https://zhuanlan.zhihu.com/p/461349946">(PKCS1) RSA 公私钥 pem 文件解析 - 知乎 (zhihu.com)</a></p>
<p><img src="/../../images/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/0.png"></p>
<p>提取到n，p，q。然后解密。<del>中间那段绿色的不太明白代表什么意思，求师傅教教</del>。后面了解到那个是<strong>d</strong></p>
<p>解出来的结果和压缩包密钥异或一下才是真的flag。<del>当时想到异或，但是把字符拿来异或了，卡了几分钟才做出来的导致痛失三血www</del></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">0xb9ad332fb6b87d59b5b20b4ae880ba416d8724111f99a9ed498bcb365091d83dcc43fdff9b607df8a443bcadc79907c921e76b38003b5b0ece660437803195ebfab9a7e23fc0751228fdeefe5591827523d7b79ad04d85e4db5caa13f28a7e0124357d0685e00f14ccbb9679979923c2531ff487f9ba2500ade48995c315d913</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p = <span class="number">0xcad4c29d017e30ddabd606805044d9ca3e6a3184fb4e1f332845555498c36b02e7b97e2eb09d85c919e30a493ce94ef9412261c3998c7344271b6e6e1b3dfefb</span></span><br><span class="line">q = <span class="number">0xea59434f560de2eaf4f21c22fb10691b79485e6290007dc28242bc63739fb95fa03e5ed807000d491f0ca43e50a91d43a6940f390c91757a3ba8226ce58112c9</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">91817924748361493215143897386603397612753451291462468066632608541316135642691873237492166541761504834463859351830616117238028454453831120079998631107520871612398404926417683282285787231775479511469825932022611941912754602165499500350038397852503264709127650106856760043956604644700201911063515109074933378818</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line">a = <span class="string">b&#x27;C0ngr4tulati0n5_y0u_fou^d_m3&#x27;</span></span><br><span class="line">flag = long_to_bytes(bytes_to_long(a) ^ <span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<p>日落越来越早了，不到6.30天就几乎全黑了，感叹时间过的好快啊，转眼就大二了。</p>
<p>近来几天状态不太好，而且这两天天公不作美，很多计划都被打乱了，怪难受的，明天就得开始上课了，算是给暑期的学习过程画一个句号了。</p>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>星盟安全团队纳新！</p>
<p>欢迎师傅们加群（346014666）学习、讨论！</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/3.png"></p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>LCG</title>
    <url>/2023/07/05/%E6%B5%81%E5%AF%86%E7%A0%81/%E6%B5%81%E5%AF%86%E7%A0%81-LCG/</url>
    <content><![CDATA[<p>江畔何人初见月？江月何年初照人？</p>
<span id="more"></span>

<p><strong>记录笔者学习lcg的过程</strong></p>
<h1 id="lcg-线性同余随机数生成器"><a href="#lcg-线性同余随机数生成器" class="headerlink" title="lcg(线性同余随机数生成器)"></a>lcg(线性同余随机数生成器)</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p><strong>很简单，原理就是下面这个公式：</strong><br>$$<br>X_{n+1} \equiv aX_n+b (mod \quad m)<br>$$</p>
<p>$$<br>其中,m表示模数,(m&gt;0)<br>$$</p>
<p>$$<br>a表示系数,(0&lt;a&lt;m)<br>$$</p>
<p>$$<br>b表示增量,(0\le b &lt;m)<br>$$</p>
<p>$$<br>X_0表示原始值，也叫种子,(0 \le X_0 &lt; m)<br>$$</p>
<p><strong>通过原始关系，可以推出以下公式：</strong><br>$$<br>\because X_{n+1} \equiv aX_n+b (mod \quad m)<br>$$</p>
<p>$$<br>\therefore aX_n \equiv X_{n+1}-b (mod \quad  m)<br>$$</p>
<p>$$<br>得到公式①:X_n \equiv a^{-1}(X_{n+1}-b)(mod \quad m)<br>$$</p>
<p><img src="/../../images/lcg/0.png"><br>$$<br>\therefore X_{n+2}-X_{n+1} \equiv a(X_{n+1}-X_n)(mod \quad m)<br>$$</p>
<p>$$<br>得到公式②:a \equiv (X_{n+1}-X_n)^{-1}(X_{n+2}-X_{n+1})(mod \quad m)<br>$$</p>
<p>$$<br>由X_{n+1} \equiv aX_n+b (mod \quad m)<br>$$</p>
<p>$$<br>移项得公式③：b \equiv X_{n+1}-aX_n(mod \quad m)<br>$$</p>
<p><strong>公式4如下</strong><br>$$<br>令t_n &#x3D; X_{n+1}-X_n<br>$$</p>
<p>$$<br>\therefore t_n \equiv a(X_n+b)-a(X_{n-1}+b)(mod \quad m)<br>$$</p>
<p>$$<br>即t_n \equiv a(X_n-X_{n-1})(mod \quad m)<br>$$</p>
<p>$$<br>\therefore t_n \equiv at_{n-1}(mod \quad m)<br>$$</p>
<p>$$<br>又\because t_{n+1}t_{n-1} \equiv a^2t_{n-1}×t_{n-1} \equiv(t_n)^2(mod \quad m)<br>$$</p>
<p>$$<br>\therefore t_{n+1}t_{n-1}-(t_n)^2 \equiv 0 (mod \quad m)<br>$$</p>
<p>$$<br>令T_n &#x3D;t_{n+1}t_{n-1}-(t_n)^2,则T_{n-1}&#x3D;t_nt_{n-2}-(t_{n-1})^2<br>$$</p>
<p>$$<br>\therefore T_n &#x3D; k_1m,T_{n-1} &#x3D; k_2m<br>$$</p>
<p>$$<br>\therefore m &#x3D; gcd(T_n,T_{n-1})<br>$$</p>
<p>其实上式求的还是$km$，只不过这个k很小</p>
<h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&#x27;Spirit&#123;***********************&#125;&#x27;</span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = 33477128523140105764301644224721378964069</span><br><span class="line">print(&quot;seed = &quot;,seed)</span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">ciphertext = seed^plaintext</span><br><span class="line">print(&quot;a = &quot;,a)</span><br><span class="line">print(&quot;b = &quot;,b)</span><br><span class="line">print(&quot;n = &quot;,n)</span><br><span class="line">print(&quot;c = &quot;,ciphertext)</span><br><span class="line"></span><br><span class="line"># seed =  33477128523140105764301644224721378964069</span><br><span class="line"># a =  216636540518719887613942270143367229109002078444183475587474655399326769391</span><br><span class="line"># b =  186914533399403414430047931765983818420963789311681346652500920904075344361</span><br><span class="line"># n =  155908129777160236018105193822448288416284495517789603884888599242193844951</span><br><span class="line"># c =  209481865531297761516458182436122824479565806914713408748457524641378381493</span><br></pre></td></tr></table></figure>

<p><strong>求出循环后的seed，然后和ciphertext异或即可得到flag</strong></p>
<p><strong>这道题已经给出系数a，增量b，模数n，很容易求出最后的seed</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a =  <span class="number">216636540518719887613942270143367229109002078444183475587474655399326769391</span></span><br><span class="line">b =  <span class="number">186914533399403414430047931765983818420963789311681346652500920904075344361</span></span><br><span class="line">n =  <span class="number">155908129777160236018105193822448288416284495517789603884888599242193844951</span></span><br><span class="line">seed = <span class="number">33477128523140105764301644224721378964069</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed + b)%n</span><br><span class="line"></span><br><span class="line">c = <span class="number">209481865531297761516458182436122824479565806914713408748457524641378381493</span></span><br><span class="line">m = c^seed</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#Spirit&#123;0ops!___you_know__LCG!!&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="例题2-已知后项求前项"><a href="#例题2-已知后项求前项" class="headerlink" title="例题2(已知后项求前项)"></a>例题2(已知后项求前项)</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&#x27;Spirit&#123;*****************************&#125;&#x27;</span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line"></span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line">print(&quot;a = &quot;,a)</span><br><span class="line">print(&quot;b = &quot;,b)</span><br><span class="line">print(&quot;n = &quot;,n)</span><br><span class="line">print(&quot;c = &quot;,ciphertext)</span><br><span class="line"></span><br><span class="line"># a =  59398519837969938359106832224056187683937568250770488082448642852427682484407513407602969</span><br><span class="line"># b =  32787000674666987602016858366912565306237308217749461581158833948068732710645816477126137</span><br><span class="line"># n =  43520375935212094874930431059580037292338304730539718469760580887565958566208139467751467</span><br><span class="line"># c =  8594514452808046357337682911504074858048299513743867887936794439125949418153561841842276</span><br></pre></td></tr></table></figure>

<p><strong>应用公式①，已知后一项推出前项</strong></p>
<p><strong>这道题我们知道X9，系数，增量，模数，要求X0</strong></p>
<p><strong>首先求a模n的逆元，然后就可以求出前项</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a =  <span class="number">59398519837969938359106832224056187683937568250770488082448642852427682484407513407602969</span></span><br><span class="line">b =  <span class="number">32787000674666987602016858366912565306237308217749461581158833948068732710645816477126137</span></span><br><span class="line">n =  <span class="number">43520375935212094874930431059580037292338304730539718469760580887565958566208139467751467</span></span><br><span class="line">c =  <span class="number">8594514452808046357337682911504074858048299513743867887936794439125949418153561841842276</span></span><br><span class="line"></span><br><span class="line">Ani = gmpy2.invert(a,n)</span><br><span class="line">seed = c</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = Ani*(seed-b) % n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(seed))</span><br><span class="line"><span class="comment"># Spirit&#123;Orzzz__number_the0ry_master!!&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="例题3-求增量b"><a href="#例题3-求增量b" class="headerlink" title="例题3(求增量b)"></a>例题3(求增量b)</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&#x27;Spirit&#123;*********************&#125;&#x27;</span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">seed = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">b = plaintext</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line">ciphertext = seed</span><br><span class="line"></span><br><span class="line">print(&quot;a = &quot;,a)</span><br><span class="line">print(&quot;n = &quot;,n)</span><br><span class="line">print(&quot;output1 = &quot;,output[6])</span><br><span class="line">print(&quot;output2 = &quot;,output[7])</span><br><span class="line"></span><br><span class="line"># a =  3227817955364471534349157142678648291258297398767210469734127072571531</span><br><span class="line"># n =  2731559135349690299261470294200742325021575620377673492747570362484359</span><br><span class="line"># output1 =  56589787378668192618096432693925935599152815634076528548991768641673</span><br><span class="line"># output2 =  2551791066380515596393984193995180671839531603273409907026871637002460</span><br></pre></td></tr></table></figure>

<p><strong>这道题需要我们求增量b</strong></p>
<p>用公式③</p>
<p><img src="/../../images/lcg/4.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a =  <span class="number">3227817955364471534349157142678648291258297398767210469734127072571531</span></span><br><span class="line">n =  <span class="number">2731559135349690299261470294200742325021575620377673492747570362484359</span></span><br><span class="line">output1 =  <span class="number">56589787378668192618096432693925935599152815634076528548991768641673</span></span><br><span class="line">output2 =  <span class="number">2551791066380515596393984193995180671839531603273409907026871637002460</span></span><br><span class="line"></span><br><span class="line">b = output2 - a*output1 % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(b))</span><br><span class="line"></span><br><span class="line"><span class="comment">#Spirit&#123;Y0u_@r3_g00d_at__math&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="例题4-未知a-b求seed"><a href="#例题4-未知a-b求seed" class="headerlink" title="例题4(未知a,b求seed)"></a>例题4(未知a,b求seed)</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&#x27;Spirit&#123;********************************&#125;&#x27;</span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line">output = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(&quot;n = &quot;,n)</span><br><span class="line">print(&quot;output = &quot;,output)</span><br><span class="line"># n =  714326667532888136341930300469812503108568533171958701229258381897431946521867367344505142446819</span><br><span class="line"># output =  [683884150135567569054700309393082274015273418755015984639210872641629102776137288905334345358223, 285126221039239401347664578761309935673889193236512702131697050766454881029340147180552409870425, 276893085775448203669487661735680485319995668779836512706851431217470824660349740546793492847822, 670041467944152108349892479463033808393249475608933110640580388877206700116661070302382578388629, 122640993538161410588195475312610802051543155060328971488277224112081166784263153107636108815824, 695403107966797625391061914491496301998976621394944936827202540832952594905520247784142392337171, 108297989103402878258100342544600235524390749601427490182149765480916965811652000881230504838949, 3348901603647903020607356217291999644800579775392251732059562193080862524671584235203807354488, 632094372828241320671255647451901056399237760301503199444470380543753167478243100611604222284853, 54758061879225024125896909645034267106973514243188358677311238070832154883782028437203621709276]</span><br></pre></td></tr></table></figure>

<p><strong>这道题需要求初始值，但是题目没给出a和b的值</strong></p>
<p><img src="/../../images/lcg/5.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n =  <span class="number">714326667532888136341930300469812503108568533171958701229258381897431946521867367344505142446819</span></span><br><span class="line">output =  [<span class="number">683884150135567569054700309393082274015273418755015984639210872641629102776137288905334345358223</span>, <span class="number">285126221039239401347664578761309935673889193236512702131697050766454881029340147180552409870425</span>, <span class="number">276893085775448203669487661735680485319995668779836512706851431217470824660349740546793492847822</span>, <span class="number">670041467944152108349892479463033808393249475608933110640580388877206700116661070302382578388629</span>, <span class="number">122640993538161410588195475312610802051543155060328971488277224112081166784263153107636108815824</span>, <span class="number">695403107966797625391061914491496301998976621394944936827202540832952594905520247784142392337171</span>, <span class="number">108297989103402878258100342544600235524390749601427490182149765480916965811652000881230504838949</span>, <span class="number">3348901603647903020607356217291999644800579775392251732059562193080862524671584235203807354488</span>, <span class="number">632094372828241320671255647451901056399237760301503199444470380543753167478243100611604222284853</span>, <span class="number">54758061879225024125896909645034267106973514243188358677311238070832154883782028437203621709276</span>]</span><br><span class="line"></span><br><span class="line">p1 = output[<span class="number">9</span>]-output[<span class="number">8</span>]</span><br><span class="line">p2 = output[<span class="number">8</span>]-output[<span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">Ani = gmpy2.invert(p2,n)</span><br><span class="line">a = p1 * Ani % n</span><br><span class="line"></span><br><span class="line">b = (output[<span class="number">9</span>] - a*output[<span class="number">8</span>]) % n</span><br><span class="line"></span><br><span class="line">ani = gmpy2.invert(a,n)</span><br><span class="line"></span><br><span class="line">m = ani * (output[<span class="number">0</span>]-b) % n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Spirit&#123;Gr3at__J0b!_You_can_be___better!&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="例题5-未知a-b-n求seed）"><a href="#例题5-未知a-b-n求seed）" class="headerlink" title="例题5(未知a,b,n求seed）"></a>例题5(未知a,b,n求seed）</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&#x27;Spirit&#123;****************************************&#125;&#x27;</span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line">output = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line">print(&quot;output = &quot;,output)</span><br><span class="line"># output =  [9997297986272510947766344959498975323136012075787120721424325775003840341552673589487134830298427997676238039214108, 4943092972488023184271739094993470430272327679424224016751930100362045115374960494124801675393555642497051610643836, 6774612894247319645272578624765063875876643849415903973872536662648051668240882405640569448229188596797636795502471, 9334780454901460926052785252362305555845335155501888087843525321238695716687151256717815518958670595053951084051571, 2615136943375677027346821049033296095071476608523371102901038444464314877549948107134114941301290458464611872942706, 11755491858586722647182265446253701221615594136571038555321378377363341368427070357031882725576677912630050307145062, 7752070270905673490804344757589080653234375679657568428025599872155387643476306575613147681330227562712490805492345, 8402957532602451691327737154745340793606649602871190615837661809359377788072256203797817090151599031273142680590748, 2802440081918604590502596146113670094262600952020687184659605307695151120589816943051322503094363578916773414004662, 5627226318035765837286789021891141596394835871645925685252241680021740265826179768429792645576780380635014113687982]</span><br></pre></td></tr></table></figure>

<p><strong>这道题连模数都没给</strong></p>
<p><strong>首先求出模，然后求a，再求b</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">output =  [<span class="number">9997297986272510947766344959498975323136012075787120721424325775003840341552673589487134830298427997676238039214108</span>, <span class="number">4943092972488023184271739094993470430272327679424224016751930100362045115374960494124801675393555642497051610643836</span>, <span class="number">6774612894247319645272578624765063875876643849415903973872536662648051668240882405640569448229188596797636795502471</span>, <span class="number">9334780454901460926052785252362305555845335155501888087843525321238695716687151256717815518958670595053951084051571</span>, <span class="number">2615136943375677027346821049033296095071476608523371102901038444464314877549948107134114941301290458464611872942706</span>, <span class="number">11755491858586722647182265446253701221615594136571038555321378377363341368427070357031882725576677912630050307145062</span>, <span class="number">7752070270905673490804344757589080653234375679657568428025599872155387643476306575613147681330227562712490805492345</span>, <span class="number">8402957532602451691327737154745340793606649602871190615837661809359377788072256203797817090151599031273142680590748</span>, <span class="number">2802440081918604590502596146113670094262600952020687184659605307695151120589816943051322503094363578916773414004662</span>, <span class="number">5627226318035765837286789021891141596394835871645925685252241680021740265826179768429792645576780380635014113687982</span>]</span><br><span class="line"></span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(output)):</span><br><span class="line">    t.append(output[i]-output[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">T = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">    T.append(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)-<span class="number">1</span>):</span><br><span class="line">    mm = gmpy2.gcd(T[i],T[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> isPrime(mm):</span><br><span class="line">        m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(mm // i):</span><br><span class="line">                mm = mm // i</span><br><span class="line">                m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="comment">#print(m)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        a = gmpy2.invert(t[<span class="number">0</span>],i) * t[<span class="number">1</span>] % i</span><br><span class="line">        b = output[<span class="number">1</span>] - a*output[<span class="number">0</span>] % i</span><br><span class="line">        a_ = gmpy2.invert(a,i)</span><br><span class="line"></span><br><span class="line">        seed = a_ * (output[<span class="number">0</span>]-b) % i</span><br><span class="line">        flag = long_to_bytes(seed)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;Spirit&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>对于同一个lcg，其$a,b$是一样的，通过哪两组数据都能求出$a,b$</p>
<p>官方wp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">a,b</span>): </span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>): </span><br><span class="line">        <span class="keyword">return</span> a </span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b) </span><br><span class="line">s =  [<span class="number">9997297986272510947766344959498975323136012075787120721424325775003840341552673589487134830298427997676238039214108</span>, <span class="number">4943092972488023184271739094993470430272327679424224016751930100362045115374960494124801675393555642497051610643836</span>, <span class="number">6774612894247319645272578624765063875876643849415903973872536662648051668240882405640569448229188596797636795502471</span>, <span class="number">9334780454901460926052785252362305555845335155501888087843525321238695716687151256717815518958670595053951084051571</span>, <span class="number">2615136943375677027346821049033296095071476608523371102901038444464314877549948107134114941301290458464611872942706</span>, <span class="number">11755491858586722647182265446253701221615594136571038555321378377363341368427070357031882725576677912630050307145062</span>, <span class="number">7752070270905673490804344757589080653234375679657568428025599872155387643476306575613147681330227562712490805492345</span>, <span class="number">8402957532602451691327737154745340793606649602871190615837661809359377788072256203797817090151599031273142680590748</span>, <span class="number">2802440081918604590502596146113670094262600952020687184659605307695151120589816943051322503094363578916773414004662</span>, <span class="number">5627226318035765837286789021891141596394835871645925685252241680021740265826179768429792645576780380635014113687982</span>]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    t.append(s[i]-s[i-<span class="number">1</span>]) </span><br><span class="line">all_n = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    all_n.append(gcd((t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>]-t[i]*t[i]), (t[i+<span class="number">2</span>]*t[i]-t[i+<span class="number">1</span>]*t[i+<span class="number">1</span>]))) </span><br><span class="line"></span><br><span class="line">MMI = <span class="keyword">lambda</span> A, n,s=<span class="number">1</span>,t=<span class="number">0</span>,N=<span class="number">0</span>: (n &lt; <span class="number">2</span> <span class="keyword">and</span> t%N <span class="keyword">or</span> MMI(n, A%n, t, s-A//n*t, N <span class="keyword">or</span> n),-<span class="number">1</span>)[n&lt;<span class="number">1</span>] <span class="comment">#逆元计算</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> all_n:</span><br><span class="line">    n=<span class="built_in">abs</span>(n)</span><br><span class="line">    <span class="keyword">if</span> n==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    a=(s[<span class="number">2</span>]-s[<span class="number">1</span>])*MMI((s[<span class="number">1</span>]-s[<span class="number">0</span>]),n)%n</span><br><span class="line">    ani=MMI(a,n)</span><br><span class="line">    b=(s[<span class="number">1</span>]-a*s[<span class="number">0</span>])%n</span><br><span class="line">    seed = (ani*(s[<span class="number">0</span>]-b))%n</span><br><span class="line">    plaintext=seed</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(plaintext))</span><br></pre></td></tr></table></figure>



<h2 id="例题6-求出的是k倍模数"><a href="#例题6-求出的是k倍模数" class="headerlink" title="例题6(求出的是k倍模数)"></a>例题6(求出的是k倍模数)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b, m</span>):</span><br><span class="line">        self.seed = seed  <span class="comment"># 初始种子</span></span><br><span class="line">        self.a = a  <span class="comment"># 乘数</span></span><br><span class="line">        self.b = b  <span class="comment"># 增量</span></span><br><span class="line">        self.m = m  <span class="comment"># 模数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = self.a * (self.seed - self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lcg = LCG(bytes_to_long(flag), getPrime(<span class="number">256</span>), getPrime(<span class="number">256</span>), getPrime(<span class="number">256</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(getPrime(<span class="number">16</span>)):</span><br><span class="line">    lcg.generate()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">57648351648792284446777383544515312078150027665462203747924668509833442797796</span></span><br><span class="line"><span class="string">90378879763416486117626477831653213918315023665514305359005153448529276829825</span></span><br><span class="line"><span class="string">21826576702665114807208181233864324586557058567478767825970403161758214940301</span></span><br><span class="line"><span class="string">47594460970742467761038407996122637655856234121180714918606854365482948918701</span></span><br><span class="line"><span class="string">11871076497267630136796123094001159466754095580273018347962555675375123133730</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">output = [<span class="number">57648351648792284446777383544515312078150027665462203747924668509833442797796</span>,</span><br><span class="line"><span class="number">90378879763416486117626477831653213918315023665514305359005153448529276829825</span>,</span><br><span class="line"><span class="number">21826576702665114807208181233864324586557058567478767825970403161758214940301</span>,</span><br><span class="line"><span class="number">47594460970742467761038407996122637655856234121180714918606854365482948918701</span>,</span><br><span class="line"><span class="number">11871076497267630136796123094001159466754095580273018347962555675375123133730</span>]</span><br><span class="line"></span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(output)):</span><br><span class="line">    t.append(output[i]-output[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">T = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">    T.append(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)-<span class="number">1</span>):</span><br><span class="line">    mm = gmpy2.gcd(T[i],T[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> isPrime(mm):</span><br><span class="line">        m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(mm // i):</span><br><span class="line">                mm = mm // i</span><br><span class="line">                m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    a = gmpy2.invert(t[<span class="number">0</span>],i) * t[<span class="number">1</span>] % i</span><br><span class="line">    b = output[<span class="number">1</span>] - a*output[<span class="number">0</span>] % i</span><br><span class="line">    a_ = gmpy2.invert(a,i)</span><br><span class="line"></span><br><span class="line">    seed = a_ * (output[<span class="number">0</span>]-b) % i</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">        seed = a_ * (seed - b) % i</span><br><span class="line">        flag = long_to_bytes(seed)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;NSSCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h2 id="例题7-输出X0，X2，X4，X6，X8"><a href="#例题7-输出X0，X2，X4，X6，X8" class="headerlink" title="例题7(输出X0，X2，X4，X6，X8)"></a>例题7(输出X0，X2，X4，X6，X8)</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;******&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b, m</span>):</span><br><span class="line">        self.seed = seed  <span class="comment"># 初始种子</span></span><br><span class="line">        self.a = a  <span class="comment"># 乘数</span></span><br><span class="line">        self.b = b  <span class="comment"># 增量</span></span><br><span class="line">        self.m = m  <span class="comment"># 模数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        self.seed = (self.a * self.seed + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> self.seed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lcg = LCG(bytes_to_long(flag), getPrime(<span class="number">255</span>), getPrime(<span class="number">255</span>), getPrime(<span class="number">256</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(getPrime(<span class="number">16</span>)):</span><br><span class="line">    lcg.generate()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"><span class="built_in">print</span>(lcg.generate())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">25445927935559969212648839062255651208014967526951331344342413906051118248013</span></span><br><span class="line"><span class="string">81572970970116732975667604095930675262596098540738447440566868976253289440293</span></span><br><span class="line"><span class="string">6956793925625110803779114150160476498676179542815207353218944386232051429289</span></span><br><span class="line"><span class="string">88042506866508011592456777776490262927213783361334741921985316105965255450508</span></span><br><span class="line"><span class="string">5652832125321707726481846809536180176877263519327268361130605456255558285092</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这题给出的数据是$X_1,X_3,X_5,X_7,X_9$隔位输出的</p>
<p>$\because X_{n+1} \equiv aX_n + b \mod m$，$\therefore X_{n+2} \equiv a^2X_n+(a+1)b \mod m$</p>
<p>可以把他当作另外一个系数$a’ &#x3D; a^2,b’&#x3D;(a+1)b$的lcg</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">output = [<span class="number">25445927935559969212648839062255651208014967526951331344342413906051118248013</span>,</span><br><span class="line"><span class="number">81572970970116732975667604095930675262596098540738447440566868976253289440293</span>,</span><br><span class="line"><span class="number">6956793925625110803779114150160476498676179542815207353218944386232051429289</span>,</span><br><span class="line"><span class="number">88042506866508011592456777776490262927213783361334741921985316105965255450508</span>,</span><br><span class="line"><span class="number">5652832125321707726481846809536180176877263519327268361130605456255558285092</span>]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(output)):</span><br><span class="line">    t.append(output[i]-output[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">T = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">    T.append(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)-<span class="number">1</span>):</span><br><span class="line">    mm = gmpy2.gcd(T[i],T[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> isPrime(mm):</span><br><span class="line">        m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(mm // i):</span><br><span class="line">                mm = mm // i</span><br><span class="line">                m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    a = gmpy2.invert(t[<span class="number">0</span>],i) * t[<span class="number">1</span>] % i</span><br><span class="line">    b = output[<span class="number">1</span>] - a*output[<span class="number">0</span>] % i</span><br><span class="line">    a_ = gmpy2.invert(a,i)</span><br><span class="line"></span><br><span class="line">    seed = a_ * (output[<span class="number">0</span>]-b) % i</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">        seed = a_ * (seed - b) % i</span><br><span class="line">        flag = long_to_bytes(seed)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;NSSCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="例题8-给出高位"><a href="#例题8-给出高位" class="headerlink" title="例题8(给出高位)"></a>例题8(给出高位)</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = b&#x27;Spirit&#123;*****************&#125;&#x27;</span><br><span class="line"></span><br><span class="line">plaintext = bytes_to_long(flag)</span><br><span class="line">length = plaintext.bit_length()</span><br><span class="line"></span><br><span class="line">a = getPrime(length)</span><br><span class="line">b = getPrime(length)</span><br><span class="line">n = getPrime(length)</span><br><span class="line"></span><br><span class="line">seed = plaintext</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (seed*a+b)%n</span><br><span class="line">    output.append(seed&gt;&gt;64)</span><br><span class="line">print(&quot;a = &quot;,a)</span><br><span class="line">print(&quot;b = &quot;,b)</span><br><span class="line">print(&quot;n = &quot;,n)</span><br><span class="line">print(&quot;output = &quot;,output)</span><br><span class="line"># a =  731111971045863129770849213414583830513204814328949766909151</span><br><span class="line"># b =  456671883153709362919394459405008275757410555181682705944711</span><br><span class="line"># n =  666147691257100304060287710111266554526660232037647662561651</span><br><span class="line"># output =  [16985619148410545083429542035273917746612, 32633736473029292963326093326932585135645, 20531875000321097472853248514822638673918, 37524613187648387324374487657224279011, 21531154020699900519763323600774720747179, 1785016578450326289280053428455439687732, 15859114177482712954359285501450873939895, 10077571899928395052806024133320973530689, 30199391683019296398254401666338410561714, 21303634014034358798100587236618579995634]</span><br></pre></td></tr></table></figure>

<p>已知$X_{n+1} \equiv aX_n + b \mod m$</p>
<p>把$X_n$拆为高位和低位之和，即$X_n &#x3D; H_n+L_n$</p>
<p>于是有$H_{n+1}+L_{n+1} \equiv a(H_n+L_n) + b \mod m$</p>
<p>$\therefore L_{n+1} \equiv aL_n+(aH_n+b-H_{n+1})\mod m$</p>
<p>因为$L_2 \equiv aL_1 + (aH_1+b-H_2) \mod m$</p>
<p>$L_3 \equiv a(aL_1 + aH_1+b-H_2)+aH_2+b-H_3 \mod m$，即$L_3 \equiv a^2L_1+(aH_2+b-H_3+a^2H_1+b-H_2)$</p>
<p>于是能得到$L_i$与$L_1$的关系</p>
<p>则有$L_{i} \equiv A_iL_1 +B_i \mod m$，即$L_{i+1} &#x3D; A_iL_1 + B_i + k_{i}m$</p>
<p>构造格</p>
<p><img src="/../../images/lcg/6.png"></p>
<p>因为$L_i &#x3D; 64bit$，所以最后调一个$2^{64}$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a =  <span class="number">731111971045863129770849213414583830513204814328949766909151</span></span><br><span class="line">b =  <span class="number">456671883153709362919394459405008275757410555181682705944711</span></span><br><span class="line">m =  <span class="number">666147691257100304060287710111266554526660232037647662561651</span></span><br><span class="line">c =  [<span class="number">0</span>,<span class="number">16985619148410545083429542035273917746612</span>, <span class="number">32633736473029292963326093326932585135645</span>, <span class="number">20531875000321097472853248514822638673918</span>, <span class="number">37524613187648387324374487657224279011</span>, <span class="number">21531154020699900519763323600774720747179</span>, <span class="number">1785016578450326289280053428455439687732</span>, <span class="number">15859114177482712954359285501450873939895</span>, <span class="number">10077571899928395052806024133320973530689</span>, <span class="number">30199391683019296398254401666338410561714</span>, <span class="number">21303634014034358798100587236618579995634</span>]</span><br><span class="line"><span class="comment">#0是seed的高位</span></span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">    c[i] = c[i] &lt;&lt; <span class="number">64</span></span><br><span class="line"></span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length-<span class="number">1</span>):</span><br><span class="line">    Ai = a*A[i-<span class="number">1</span>] % m</span><br><span class="line">    Bi = (a*B[i-<span class="number">1</span>] + a*c[i]+b-c[i+<span class="number">1</span>]) % m</span><br><span class="line">    A.append(Ai)</span><br><span class="line">    B.append(Bi)</span><br><span class="line"></span><br><span class="line">A = A[<span class="number">1</span>:]</span><br><span class="line">B = B[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">M = Matrix(length,length)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length-<span class="number">2</span>):</span><br><span class="line">    M[i,i] = m</span><br><span class="line">    M[-<span class="number">1</span>,i] = B[i]</span><br><span class="line">    M[-<span class="number">2</span>,i] = A[i]</span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">2</span>^<span class="number">64</span></span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M.LLL():</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">2</span>^<span class="number">64</span>:</span><br><span class="line">        L1 = i[-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">seed1 = c[<span class="number">1</span>] + L1</span><br><span class="line"></span><br><span class="line">inv = gmpy2.invert(a,m)</span><br><span class="line">seed = inv * (seed1 - b) % m</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(seed)))</span><br></pre></td></tr></table></figure>

<h2 id="NPUCTF2020——BabyLCG"><a href="#NPUCTF2020——BabyLCG" class="headerlink" title="NPUCTF2020——BabyLCG"></a>NPUCTF2020——BabyLCG</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, bit_length</span>):</span><br><span class="line">        m = getPrime(bit_length)</span><br><span class="line">        a = getRandomRange(<span class="number">2</span>, m)</span><br><span class="line">        b = getRandomRange(<span class="number">2</span>, m)</span><br><span class="line">        seed = getRandomRange(<span class="number">2</span>, m)</span><br><span class="line">        self._key = &#123;<span class="string">&#x27;a&#x27;</span>:a, <span class="string">&#x27;b&#x27;</span>:b, <span class="string">&#x27;m&#x27;</span>:m&#125;</span><br><span class="line">        self._state = seed</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self._state = (self._key[<span class="string">&#x27;a&#x27;</span>] * self._state + self._key[<span class="string">&#x27;b&#x27;</span>]) % self._key[<span class="string">&#x27;m&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> self._state</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">export_key</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_lcg</span>():</span><br><span class="line">    rand_iter = LCG(<span class="number">128</span>)</span><br><span class="line">    key = rand_iter.export_key()</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(key))</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_data</span>(<span class="params">rand_iter</span>):</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;old&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">        f.write(<span class="built_in">str</span>(rand_iter.<span class="built_in">next</span>() &gt;&gt; <span class="number">64</span>) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> rand_iter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">rand_iter</span>):</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;ct&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    key = rand_iter.<span class="built_in">next</span>() &gt;&gt; <span class="number">64</span></span><br><span class="line">    key = (key &lt;&lt; <span class="number">64</span>) + (rand_iter.<span class="built_in">next</span>() &gt;&gt; <span class="number">64</span>)</span><br><span class="line">    key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    iv = long_to_bytes(rand_iter.<span class="built_in">next</span>()).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    pt = flag + (<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>) * <span class="built_in">chr</span>(<span class="number">16</span> - <span class="built_in">len</span>(flag) % <span class="number">16</span>)</span><br><span class="line">    ct = cipher.encrypt(pt.encode())</span><br><span class="line">    f.write(ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    rand_iter = gen_lcg()</span><br><span class="line">    rand_iter = leak_data(rand_iter)</span><br><span class="line">    encrypt(rand_iter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>题目先是生成20个随机数，然后把第21个随机数的高位和第22个随机数的高位拼接成key，再把第23个随机数当作iv，进行了CBC加密。</p>
<p>只要恢复seed，剩下的问题就迎刃而解了。</p>
<p>问题是，题目只给出20个随机数的高64位</p>
<p>$\because X_{n+1} \equiv (aX_n + b) \mod m$</p>
<p>把$X$拆成高位和低位之和，即$X &#x3D; H+L$</p>
<p>$\therefore H_{n+1}+L_{n+1} \equiv a(H_n+L_n) + b \mod m$</p>
<p>于是我们得到$L_{n+1} \equiv aL_n + (aH_n+b-H_{n+1}) \mod m$</p>
<p>$L_2 \equiv aL_1 + (aH_1+b-H_2) \mod m$</p>
<p>$L_3 \equiv a(aL_1 + aH_1+b-H_2)+aH_2+b-H_3 \mod m$，即$L_3 \equiv a^2L_1+(aH_2+b-H_3+a^2H_1+b-H_2)$</p>
<p>于是能得到$L_i$与$L_1$的关系</p>
<p>则有$L_{i} \equiv A_iL_1 +B_i \mod m$，即$L_{i+1} &#x3D; A_iL_1 + B_i + k_{i}m$</p>
<p>构造格</p>
<p><img src="E:/Blog/source/images/Lattice2/19.png"></p>
<p>$L_i &#x3D; 64bit$，所以最后调一个$2^{64}$</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="number">107763262682494809191803026213015101802</span></span><br><span class="line">b = <span class="number">153582801876235638173762045261195852087</span></span><br><span class="line">m = <span class="number">226649634126248141841388712969771891297</span></span><br><span class="line">c = [<span class="number">0</span>,<span class="number">7800489346663478448</span>,<span class="number">11267068470666042741</span>,<span class="number">5820429484185778982</span>,<span class="number">6151953690371151688</span>,<span class="number">548598048162918265</span>,<span class="number">1586400863715808041</span>,<span class="number">7464677042285115264</span>,<span class="number">4702115170280353188</span>,<span class="number">5123967912274624410</span>,<span class="number">8517471683845309964</span>,<span class="number">2106353633794059980</span>,<span class="number">11042210261466318284</span>,<span class="number">4280340333946566776</span>,<span class="number">6859855443227901284</span>,<span class="number">3149000387344084971</span>,<span class="number">7055653494757088867</span>,<span class="number">5378774397517873605</span>,<span class="number">8265548624197463024</span>,<span class="number">2898083382910841577</span>,<span class="number">4927088585601943730</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#0是seed的高位</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    c[i] = c[i] &lt;&lt; <span class="number">64</span></span><br><span class="line"></span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)-<span class="number">1</span>):</span><br><span class="line">    Ai = a*A[i-<span class="number">1</span>] % m</span><br><span class="line">    Bi = (a*B[i-<span class="number">1</span>] + a*c[i]+b-c[i+<span class="number">1</span>]) % m</span><br><span class="line">    A.append(Ai)</span><br><span class="line">    B.append(Bi)</span><br><span class="line"></span><br><span class="line">A = A[<span class="number">1</span>:]</span><br><span class="line">B = B[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">M = Matrix(<span class="number">21</span>,<span class="number">21</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19</span>):</span><br><span class="line">    M[i,i] = m</span><br><span class="line">    M[-<span class="number">1</span>,i] = B[i]</span><br><span class="line">    M[-<span class="number">2</span>,i] = A[i]</span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">2</span>^<span class="number">64</span></span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M.LLL():</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">2</span>^<span class="number">64</span>:</span><br><span class="line">        L1 = i[-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">seed1 = c[<span class="number">1</span>] + L1</span><br><span class="line"></span><br><span class="line">inv = gmpy2.invert(a,m)</span><br><span class="line">seed = inv * (seed1 - b) % m</span><br><span class="line"></span><br><span class="line">s = [seed]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">    s.append((a*s[i] + b)%m)</span><br><span class="line"></span><br><span class="line">key = s[-<span class="number">3</span>] &gt;&gt; <span class="number">64</span></span><br><span class="line">key = (key &lt;&lt; <span class="number">64</span>) + (s[-<span class="number">2</span>] &gt;&gt; <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">key = long_to_bytes(key).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">iv = long_to_bytes(s[-<span class="number">1</span>]).ljust(<span class="number">16</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">open</span>(<span class="string">&quot;ct&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(cipher))</span><br></pre></td></tr></table></figure>



<h2 id="题9-Linear"><a href="#题9-Linear" class="headerlink" title="题9 Linear"></a>题9 Linear</h2><p>题目:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">40</span></span><br><span class="line">flag1,flag2 = [flag[i:i + <span class="built_in">len</span>(flag) // <span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="built_in">len</span>(flag) // <span class="number">2</span>)]</span><br><span class="line">a = bytes_to_long(flag1)</span><br><span class="line">b = bytes_to_long(flag2)</span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">x = [random.getrandbits(<span class="number">256</span>),random.getrandbits(<span class="number">256</span>)]</span><br><span class="line">cs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    c = random.getrandbits(<span class="number">240</span>)</span><br><span class="line">    cs.append(c)</span><br><span class="line">    x += [(a * x[-<span class="number">2</span>] + b * x[-<span class="number">1</span>] + c) % p]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x = <span class="subst">&#123;x&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># x = [...]</span></span><br><span class="line"><span class="comment"># p = 98658574968607903088958866815944266273368824806380957165790489794472555646793</span></span><br></pre></td></tr></table></figure>

<p>$\because X_{i+2} \equiv (aX_i + bX_{i+1}  + c_i) \mod p$</p>
<p>$\therefore c_i &#x3D; X_{i+2} - aX_i -bX_{i+1} + k_ip$</p>
<p>注意到$a \approx 160bit$，$b \approx 160bit$，$c_i &#x3D; 240bit$</p>
<p>构造格</p>
<p><img src="/../../images/lcg/7.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">x = [x1 ... x40]</span><br><span class="line">p = <span class="number">98658574968607903088958866815944266273368824806380957165790489794472555646793</span></span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,<span class="number">43</span>,<span class="number">43</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>,<span class="number">43</span>):</span><br><span class="line">    Ge[<span class="number">0</span>,i] = x[i-<span class="number">3</span>]</span><br><span class="line">    Ge[<span class="number">1</span>,i] = x[i-<span class="number">2</span>]</span><br><span class="line">    Ge[<span class="number">2</span>,i] = x[i-<span class="number">1</span>]</span><br><span class="line">    Ge[i,i] = p</span><br><span class="line"></span><br><span class="line">Ge[<span class="number">0</span>,<span class="number">0</span>] = <span class="number">2</span>^<span class="number">80</span></span><br><span class="line">Ge[<span class="number">1</span>,<span class="number">1</span>] = <span class="number">2</span>^<span class="number">80</span></span><br><span class="line">Ge[<span class="number">2</span>,<span class="number">2</span>] = <span class="number">2</span>^<span class="number">240</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[<span class="number">2</span>]) == <span class="number">2</span>^<span class="number">240</span>:</span><br><span class="line">        ka = <span class="built_in">abs</span>(i[<span class="number">0</span>])</span><br><span class="line">        kb = <span class="built_in">abs</span>(i[<span class="number">1</span>])</span><br><span class="line">        a = ka // <span class="number">2</span>^<span class="number">80</span></span><br><span class="line">        b = ka // <span class="number">2</span>^<span class="number">80</span></span><br><span class="line">        flag1 = long_to_bytes(<span class="built_in">int</span>(a))</span><br><span class="line">        flag2 = long_to_bytes(<span class="built_in">int</span>(b))</span><br><span class="line">        flag = flag1 + flag2</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="利用Grobner基"><a href="#利用Grobner基" class="headerlink" title="利用Gröbner基"></a>利用Gröbner基</h1><p>当a和n互素的时候可以利用下面脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">result =  [...]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建一个多项式环，包含两个变量a和b，系数在整数域ZZ上</span></span><br><span class="line">P.&lt;a,b&gt; = PolynomialRing(ZZ)</span><br><span class="line"><span class="comment"># 定义了四个多项式方程f1,f2,f3,f4,其中result是一个包含数值的列表。</span></span><br><span class="line"><span class="comment"># 所以这构建了一个线性方程组</span></span><br><span class="line">f1 = result[<span class="number">0</span>]*a + b - result[<span class="number">1</span>]</span><br><span class="line">f2 = result[<span class="number">1</span>]*a + b - result[<span class="number">2</span>]</span><br><span class="line">f3 = result[<span class="number">2</span>]*a + b - result[<span class="number">3</span>]</span><br><span class="line">f4 = result[<span class="number">3</span>]*a + b - result[<span class="number">4</span>]</span><br><span class="line"><span class="comment"># 将四个方程存储在列表F中</span></span><br><span class="line">F = [f1,f2,f3,f4]</span><br><span class="line"><span class="comment"># 使用F构建一个理想的Ideal。</span></span><br><span class="line">Ideal = Ideal(F)</span><br><span class="line"><span class="comment"># # 计算Ideal的Gröbner基I</span></span><br><span class="line">I = Ideal.groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(I)</span><br><span class="line"></span><br><span class="line">a = ZZ(-I[<span class="number">0</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line">b = ZZ(-I[<span class="number">1</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line">p = ZZ(I[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">m = (result[<span class="number">0</span>]-b)*a^-<span class="number">1</span> % p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>原理不太懂</p>
<p>给出一篇<strong>Gröbner</strong>的知识分享：<a href="https://www.zhihu.com/question/24452817">(11 封私信) 介绍一下Grobner基的概念和应用？谢谢 - 知乎 (zhihu.com)</a></p>
<p><a href="http://www.scholarpedia.org/article/Groebner_basis">Groebner basis - Scholarpedia</a></p>
<p>参考：[<a href="https://zhuanlan.zhihu.com/p/363648238">CTF秀] 密码挑战 个人writeup - 知乎 (zhihu.com)</a></p>
]]></content>
      <categories>
        <category>现代密码-流密码</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>流密码</tag>
        <tag>LCG</tag>
      </tags>
  </entry>
  <entry>
    <title>2023蓝帽杯</title>
    <url>/2023/08/27/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023%E8%93%9D%E5%B8%BD%E6%9D%AF/</url>
    <content><![CDATA[<p>蓝帽杯2023——Crypto</p>
<span id="more"></span>

<h1 id="初赛"><a href="#初赛" class="headerlink" title="初赛"></a>初赛</h1><h2 id="DHRSA"><a href="#DHRSA" class="headerlink" title="DHRSA"></a>DHRSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,getStrongPrime, isPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> r,g</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> r.bit_length() == <span class="number">512</span> <span class="keyword">and</span> isPrime(r)</span><br><span class="line">FLAG = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_DH_key</span>(<span class="params">g,r</span>):</span><br><span class="line">    x = randint(<span class="number">2</span>,r-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> x, <span class="built_in">pow</span>(g,x,r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_RSA_parameters</span>(<span class="params">g,r</span>):</span><br><span class="line">    main_key = gen_DH_key(g,r)</span><br><span class="line">    sub_key = gen_DH_key(g,r)</span><br><span class="line">    x, X = main_key</span><br><span class="line">    w, W = sub_key</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Public DH Keys <span class="subst">&#123; X = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Public DH Keys <span class="subst">&#123; W = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        c, C = gen_DH_key(g,r)</span><br><span class="line">        t1 = randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        t2 = randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        p = ZZ(C * W^t1 * <span class="built_in">pow</span>(X, c, r) % r)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_prime(p):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        q = ZZ(<span class="built_in">pow</span>(W, -t2, r) * <span class="built_in">pow</span>(X, -c, r) % r)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_prime(q):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] Try <span class="subst">&#123;c ,C&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">return</span> p,q</span><br><span class="line">    </span><br><span class="line">p, q = gen_RSA_parameters(g,r)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(FLAG,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123; c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123; n = &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>$p &#x3D; C \times W^{t_1} \times (X^c \mod r),q &#x3D; (W^{-t_2} \mod r)\times (X^{-c} \mod r) \mod r$</p>
<p>因为$t_1,t_2$只取0或1</p>
<p>列出所有情况</p>
<p>①：当$t_1 &#x3D; t_2 &#x3D; 0$时，$p &#x3D; C \times (X^c \mod r) \mod r \times (X^{-c} \mod r) \mod r$</p>
<p>则$n &#x3D; C \mod r$</p>
<p>②：当$t_1 &#x3D; 1,t_2 &#x3D; 0$时，$p &#x3D; C \times W \times (X^c \mod r) \mod r,q &#x3D; X^{-c} \mod r$</p>
<p>则$n &#x3D; CW \mod r$</p>
<p>③：当$t_1 &#x3D; 0,t_2 &#x3D; 1$时，$p &#x3D; C\times(X^c \mod r) \mod r$，$q &#x3D; (W^{-1}\mod r) \times(X^{-c}\mod r)\mod r$</p>
<p>则$n &#x3D; CW^{-1} \mod r$</p>
<p>④：当$t_1&#x3D;t_2 &#x3D; 1$时，$p &#x3D; C \times W \times(X^c \mod r),q &#x3D; (W^{-1} \mod r)\times(X^{-c}\mod r)\mod r$</p>
<p>则$n &#x3D; C \mod r$</p>
<p>四种情况都需要知道$r$</p>
<p>题目给出很多$C_i \equiv g^{c_1} \mod r$</p>
<p>如果存在一组$a_1,a_2,\dots ,a_n$，使得$a_1c_1 + \dots + a_nc_n&#x3D;0$</p>
<p>则有$\prod_{i&#x3D;1}^nC_i^{a_i} &#x3D; g^{\sum_{i&#x3D;1}^na_ic_i} &#x3D; g^0 \equiv 1 \mod r$</p>
<p>找到两组这样的$a_1,a_2,\dots ,a_n$</p>
<p>构造格<br>$$<br>\begin{pmatrix}<br>1 &amp; 0 &amp; \dots &amp; 0 &amp; Kc_1 \<br>0 &amp; 1 &amp; \dots &amp; 0 &amp; Kc_2 \<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; \dots &amp; 1 &amp; kc_n<br>\end{pmatrix}<br>$$<br>乘上K为了让规约的可能性更大</p>
<p>规约后得到$\vec{c} &#x3D; (a_1,a_2,\dots,a_n,0)$</p>
<p>求得$r$之后，共模攻击求$g$</p>
<p>尝试4种情况，求出最后构造$p,q$的$C_ &#x3D; n$或$C_ &#x3D; nW \mod n$或$C_ \equiv nW^{-1} \mod r$</p>
<p>再求出$g^{c_} \equiv C_ \mod r$</p>
<p>求出$c_$即可恢复$p,q$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">cs = [...]</span><br><span class="line">es = [...]</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(es)</span><br><span class="line">t = <span class="number">2</span>^<span class="number">5</span></span><br><span class="line"></span><br><span class="line">L = Matrix.identity(n)</span><br><span class="line"></span><br><span class="line">last_col = [i*<span class="number">2</span>^<span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> es]</span><br><span class="line"></span><br><span class="line">L_last_col = Matrix(ZZ,<span class="built_in">len</span>(last_col),<span class="number">1</span>,last_col)</span><br><span class="line">L = L.augment(L_last_col)</span><br><span class="line"></span><br><span class="line">L = L.LLL()</span><br><span class="line">May = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        May.append(i) <span class="comment">#几个符合条件的向量</span></span><br><span class="line"></span><br><span class="line">R = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(May)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(May)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            xx = product([ZZ(y) ^ x <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(May[i][: -<span class="number">1</span>], cs)])</span><br><span class="line">            yy = product([ZZ(y) ^ x <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(May[j][: -<span class="number">1</span>], cs)])</span><br><span class="line">            r = gcd(xx.numer() - xx.denom(), yy.numer() - yy.denom())</span><br><span class="line">            <span class="keyword">if</span> r <span class="keyword">not</span> <span class="keyword">in</span> R:</span><br><span class="line">                R.append(r) <span class="comment">#求出可能的r值</span></span><br><span class="line"><span class="comment"># print(R)</span></span><br><span class="line"><span class="comment"># 检验后知道r</span></span><br><span class="line">r = <span class="number">10667924450645948100608927157603781268991945924055943816082403476371801785989561454936076097627912279097114498936308342036099904242687703932444772733243819</span></span><br><span class="line"><span class="comment"># 共模攻击求g</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cs)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cs)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            c1 = cs[i]</span><br><span class="line">            c2 = cs[j]</span><br><span class="line">            e1 = es[i]</span><br><span class="line">            e2 = es[j]</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                t = gmpy2.gcd(e1,e2)</span><br><span class="line">                <span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">                    s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">                    g = (<span class="built_in">pow</span>(c1,x,r)*<span class="built_in">pow</span>(c2,y,r))%r</span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(es)):</span><br><span class="line">                        <span class="keyword">if</span> <span class="built_in">pow</span>(g,es[i],r) == cs[i]: <span class="comment">#检验g是否正确</span></span><br><span class="line">                            <span class="built_in">print</span>(g)</span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"><span class="comment"># 检验后求得g</span></span><br><span class="line">g =<span class="number">6019887080267290264230260653584196278384320835640816590398803560025633855808434001764263669714920086295176455397726166743099512294951861972283858355052731</span></span><br><span class="line">X =<span class="number">197551296081022143608034360606381334253374533627365455002683616928330857539205836504075700389569213696043700490195977045586318090211726350917451410932216</span></span><br><span class="line">W =<span class="number">10625560347436147537644301075885059900758953251551866239435327407977591190018531918316486861730777808988185029637608372445416280896280058313924537678128258</span></span><br><span class="line">c =<span class="number">61040814411609979711931510878805548760848686739454567580358315369154260598969544907138563610735920809370306294050956464828615417082277087799410050319871691154003766481799397897519555113273982347768485719165972634089532894585256662433949694618032747408071953491187718726218120284389638124624152241321006634774</span></span><br><span class="line">n =<span class="number">66022752859576751705544115674843820574619778139841743306742674741819040147745776264697779394213058328572691946505564202779552568613562176486470653760142864852745249430164256770469301179840812051842363261404790355057115296671805975126795017665392798621718740402876024901551851638786170466127104615340863081593</span></span><br><span class="line">C_ = n * W % r</span><br><span class="line">c_ = discrete_log(mod(C_,r),mod(g,r))</span><br><span class="line"><span class="built_in">print</span>(c_)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(g,c_,r) == C_) <span class="comment">#检查c_是不是正确</span></span><br><span class="line">c_ =<span class="number">9459072654036531380057822508623309360299476015001753632088039036432789857424193280036533227566474452833834253934061279659663650834198718093112487222065271</span></span><br><span class="line">p = ZZ(C_ * W^<span class="number">0</span> * <span class="built_in">pow</span>(X, c_, r) % r)</span><br><span class="line">q = ZZ(<span class="built_in">pow</span>(W, -<span class="number">1</span>, r) * <span class="built_in">pow</span>(X, -c_, r) % r)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">n =<span class="number">66022752859576751705544115674843820574619778139841743306742674741819040147745776264697779394213058328572691946505564202779552568613562176486470653760142864852745249430164256770469301179840812051842363261404790355057115296671805975126795017665392798621718740402876024901551851638786170466127104615340863081593</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<h1 id="半决"><a href="#半决" class="headerlink" title="半决"></a>半决</h1><h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;***&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> gmpy.is_prime(p) * gmpy.is_prime(q) &gt; <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> Fraction(p, p + <span class="number">1</span>) + Fraction(q + <span class="number">1</span>, q) == Fraction(<span class="number">2</span> * s - X, s + Y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p / (p + 1) + (q + 1) / q) == (2 * s - %s) / (s + %s)&#x27;</span> % (X, Y))</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(<span class="built_in">bytes</span>(flag, <span class="string">&quot;utf-8&quot;</span>)), <span class="number">0x10001</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br></pre></td></tr></table></figure>



<p>$\because \frac{p}{p+1}+\frac{q+1}{q} &#x3D; \frac{2n+p+q+1}{n+q} &#x3D; \frac{2s-X}{s+Y}$</p>
<p>假设$n+q &#x3D; s+Y$，$2n+p+q+1 &#x3D; 2s-X$</p>
<p>再联立$n &#x3D; p\times q$</p>
<p>三个方程</p>
<p>①：$n+q &#x3D; s+Y$</p>
<p>②：$2n+p+q+1 &#x3D; 2s-X$</p>
<p>③：$n &#x3D; p\times q$</p>
<p>解3个未知量</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">X = <span class="number">153801856029563198525204130558738800846256680799373350925981555360388985602786501362501554433635610131437376183630577217917787342621398264625389914280509</span></span><br><span class="line">Y = <span class="number">8086061902465799210233863613232941060876437002894022994953293934963170056653232109405937694010696299303888742108631749969054117542816358078039478109426</span></span><br><span class="line">n = <span class="number">161010103536746712075112156042553283066813155993777943981946663919051986586388748662616958741697621238654724628406094469789970509959159343108847331259823125490271091357244742345403096394500947202321339572876147277506789731024810289354756781901338337411136794489136638411531539112369520980466458615878975406339</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">15380535750650959213679345560658190067564859611922563753882617419201718847747207949211621591882732604480600745000879508274349808435529637573773711729853565120321608048340424321537282281161623712479117497156437792084977778826238039385697230676340978078264209760724043776058017336241110097549146883806481148999</span></span><br><span class="line"></span><br><span class="line">var(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">var(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">var(<span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">f1 = n+q - s - Y</span><br><span class="line">f2 = <span class="number">2</span>*n+p+q+<span class="number">1</span>-<span class="number">2</span>*s+X</span><br><span class="line">f3 = p*q-n</span><br><span class="line"></span><br><span class="line"><span class="comment"># ans = solve([f1,f2,f3],[p,q,s])</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">12604273285023995463340817959574344558787108098986028639834181397979984443923512555395852711753996829630650627741178073792454428457548575860120924352450409</span></span><br><span class="line"><span class="comment"># print(isPrime(p))</span></span><br><span class="line"><span class="comment"># print(p.bit_length())</span></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<h2 id="Dual-ECDSA——不会"><a href="#Dual-ECDSA——不会" class="headerlink" title="Dual ECDSA——不会"></a>Dual ECDSA——不会</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line"><span class="comment"># safe curve parameters</span></span><br><span class="line"><span class="comment"># NIST P-256</span></span><br><span class="line">NIST_256 = (</span><br><span class="line">    NIST_256_P := <span class="number">0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff</span>,</span><br><span class="line">    NIST_256_K := GF(NIST_256_P),</span><br><span class="line">    NIST_256_A := NIST_256_K(<span class="number">0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc</span>),</span><br><span class="line">    NIST_256_B := NIST_256_K(<span class="number">0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b</span>),</span><br><span class="line">    NIST_256_CURVE := EllipticCurve(NIST_256_K, (NIST_256_A, NIST_256_B)),</span><br><span class="line">    NIST_256_GEN := NIST_256_CURVE(<span class="number">0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296</span>, <span class="number">0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5</span>),</span><br><span class="line">    NIST_256_ORDER := <span class="number">0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551</span> * <span class="number">0x1</span></span><br><span class="line">)</span><br><span class="line">NIST_256_CURVE.set_order(NIST_256_ORDER)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NIST P-521</span></span><br><span class="line">NIST_521 = (</span><br><span class="line">    NIST_521_P := <span class="number">0x01ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span>,</span><br><span class="line">    NIST_521_K := GF(NIST_521_P),</span><br><span class="line">    NIST_521_A := NIST_521_K(<span class="number">0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc</span>),</span><br><span class="line">    NIST_521_B := NIST_521_K(<span class="number">0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00</span>),</span><br><span class="line">    NIST_521_CURVE := EllipticCurve(NIST_521_K, (NIST_521_A, NIST_521_B)),</span><br><span class="line">    NIST_521_GEN := NIST_521_CURVE(<span class="number">0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66</span>, <span class="number">0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650</span>),</span><br><span class="line">    NIST_521_ORDER := <span class="number">0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409</span> * <span class="number">0x1</span></span><br><span class="line">)</span><br><span class="line">NIST_521_CURVE.set_order(NIST_521_ORDER)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">open</span>(<span class="string">&quot;./flag&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(FLAG) == <span class="number">64</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dual_EC</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, state=<span class="literal">None</span>, defaul_curve=<span class="literal">True</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> state == <span class="literal">None</span>:</span><br><span class="line">            self.state = randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">256</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.state = state</span><br><span class="line">        <span class="keyword">if</span> defaul_curve:</span><br><span class="line">            self.init_curve(<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init_curve</span>(<span class="params">self, paras: <span class="built_in">tuple</span> <span class="keyword">or</span> <span class="built_in">list</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> paras == <span class="literal">None</span>:</span><br><span class="line">            self.Curve = NIST_256_CURVE</span><br><span class="line">            <span class="comment"># replace the generator</span></span><br><span class="line">            self.g = NIST_256_GEN * self.state</span><br><span class="line">            self.curve_order = NIST_256_ORDER</span><br><span class="line">            self.P = randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">20</span>) * self.g</span><br><span class="line">            self.Q = randint(<span class="number">1</span>, <span class="number">2</span>**<span class="number">20</span>) * self.g</span><br><span class="line">        <span class="comment"># customized curve</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            Curve, P, Q = paras</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> Curve.is_on_curve(P) <span class="keyword">or</span> <span class="keyword">not</span> Curve.is_on_curve(Q):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;Points are not on the curve&quot;</span>)</span><br><span class="line">            self.Curve = Curve</span><br><span class="line">            self.g = Curve.gen(<span class="number">0</span>)</span><br><span class="line">            self.P = P</span><br><span class="line">            self.Q = Q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_update</span>(<span class="params">self</span>):</span><br><span class="line">        self.state = <span class="built_in">int</span>((self.state * self.P).xy()[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># extract the high 240 bits</span></span><br><span class="line">        out = <span class="built_in">int</span>((self.state * self.Q).xy()[<span class="number">0</span>]) &gt;&gt; <span class="number">16</span></span><br><span class="line">        self._update()</span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">random_bytes</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        rounds = ceil(n*<span class="number">8</span>/<span class="number">240</span>)</span><br><span class="line">        out = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">            out = (out &lt;&lt; <span class="number">240</span>) + self.<span class="built_in">round</span>()</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(out &gt;&gt; (rounds*<span class="number">240</span> - n*<span class="number">8</span>), n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">random_bit_integer</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        rounds = ceil(n/<span class="number">240</span>)</span><br><span class="line">        out = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">            out = (out &lt;&lt; <span class="number">240</span>) + self.<span class="built_in">round</span>()</span><br><span class="line">        <span class="keyword">return</span> out &gt;&gt; (rounds*<span class="number">240</span> - n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECDSA</span>():</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.prng = Dual_EC()</span><br><span class="line">        self.hashfunc = sha256</span><br><span class="line">        self.curve_bits = <span class="number">521</span></span><br><span class="line">        self.curve = NIST_521_CURVE</span><br><span class="line">        self.generator = NIST_521_GEN</span><br><span class="line">        self.order = NIST_521_ORDER</span><br><span class="line">        self.pri_key = self.prng.random_bit_integer(self.curve_bits)</span><br><span class="line">        self.pub_key = self.pri_key * self.generator</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_curve</span>(<span class="params">self, curve: EllipticCurve</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.curve = curve</span><br><span class="line">        self.generator = curve.gen(<span class="number">0</span>)</span><br><span class="line">        self.order = curve.order()</span><br><span class="line">        self.curve_bits = self.order.nbits()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_pri_key</span>(<span class="params">self, d: <span class="built_in">int</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.pri_key = d</span><br><span class="line">        self.pub_key = d * self.generator</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, msg: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">        k_bytes = self.prng.random_bytes(self.curve_bits//<span class="number">8</span>)</span><br><span class="line">        k = <span class="built_in">int</span>(self.hashfunc(k_bytes).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        P = k * self.generator</span><br><span class="line">        r = <span class="built_in">int</span>(P.xy()[<span class="number">0</span>])</span><br><span class="line">        k_inv = <span class="built_in">int</span>(inverse_mod(k, self.order))</span><br><span class="line">        e = <span class="built_in">int</span>(self.hashfunc(msg).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        s = (e + self.pri_key*r) * k_inv % self.order</span><br><span class="line">        <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, msg: <span class="built_in">bytes</span>, signature: <span class="built_in">tuple</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        r, s = signature</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; r &lt; self.order <span class="keyword">and</span> <span class="number">0</span> &lt; s &lt; self.order):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        e = <span class="built_in">int</span>(self.hashfunc(msg).hexdigest(), <span class="number">16</span>)</span><br><span class="line">        w = <span class="built_in">int</span>(inverse_mod(s, self.order))</span><br><span class="line">        u1 = e * w % self.order</span><br><span class="line">        u2 = r * w % self.order</span><br><span class="line">        P = u1 * self.generator + u2 * self.pub_key</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(r) == <span class="built_in">int</span>(P.xy()[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">embed_secret</span>(<span class="params">self, msg: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">        S = self.curve.lift_x(ZZ(bytes_to_long(msg)))</span><br><span class="line">        K = self.prng.random_bit_integer(self.curve_bits)</span><br><span class="line">        <span class="keyword">return</span> K * S</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    SIGNER = ECDSA()</span><br><span class="line"></span><br><span class="line">    sig1 = SIGNER.sign(<span class="string">b&quot;AN INFAMOUS PRNG NAMED DUAL_EC BACKDOORED BY NSA, FINALLY CONFIRMED BY SNOWDEN IN 2013.&quot;</span>)</span><br><span class="line">    sig2 = SIGNER.sign(<span class="string">b&quot;NO ONE CAN EXTRACT THE BACKDOOR! UNLESS YOU CAN BREAK THE ECDSA SIGNATURE SCHEME / ECDLP!&quot;</span>)</span><br><span class="line">    emb_flag = SIGNER.embed_secret(FLAG)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;pub_key = <span class="subst">&#123;SIGNER.pub_key.xy() &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;P = <span class="subst">&#123;SIGNER.prng.P.xy() &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Q = <span class="subst">&#123;SIGNER.prng.Q.xy() &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sig1 = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sig2 = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;emb_flag = <span class="subst">&#123;emb_flag.xy() &#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>LitCTF</title>
    <url>/2023/07/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/LitCTF/</url>
    <content><![CDATA[<p><strong>为之则易，不为则难</strong></p>
<span id="more"></span>

<p><strong>记录2023LitCTF——crypto题解</strong></p>
<p>进入Hyperion复现的第一个赛事</p>
<h1 id="梦想是红色的"><a href="#梦想是红色的" class="headerlink" title="梦想是红色的"></a>梦想是红色的</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">自由友善公正公正敬业法治自由自由和谐平等自由自由公正法治诚信民主诚信自由自由诚信民主爱国友善平等诚信富强友善爱国自由诚信民主敬业爱国诚信民主友善爱国平等爱国爱国敬业敬业友善爱国公正敬业爱国敬业和谐文明诚信文明友善爱国自由诚信民主爱国爱国诚信和谐友善爱国自由友善平等爱国友善平等友善自由诚信自由平等爱国爱国敬业敬业友善爱国敬业敬业友善自由友善平等诚信自由法治诚信和谐</span><br></pre></td></tr></table></figure>

<p><strong>社会主义核心价值观解码</strong></p>
<p>解码得到：</p>
<p><strong><code>LitCTF&#123;为之则易,不为则难&#125;</code></strong></p>
<h1 id="Hex-Hex"><a href="#Hex-Hex" class="headerlink" title="Hex? Hex!"></a>Hex? Hex!</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4c69744354467b746169313131636f6f6c6c616161217d</span><br></pre></td></tr></table></figure>

<p><strong>16进制转字符串</strong></p>
<p>解码得到：</p>
<p><strong><code>LitCTF&#123;tai111coollaaa!&#125;</code></strong></p>
<h1 id="原来你也玩原神"><a href="#原来你也玩原神" class="headerlink" title="原来你也玩原神"></a>原来你也玩原神</h1><p>密文：</p>
<p><img src="/../../images/LitCTF/1.png"></p>
<p><strong>对应提瓦特文字</strong></p>
<p>提瓦特文字表：</p>
<p><img src="/../../images/LitCTF/2.jpg"></p>
<p>把最后一行对应解码得到：</p>
<p><strong><code>LitCTF&#123;YUANLAINIYEWANYUANSHENWWW&#125;</code></strong></p>
<h1 id="你是我的关键词"><a href="#你是我的关键词" class="headerlink" title="你是我的关键词"></a>你是我的关键词</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">IFRURC&#123;X0S_YP3_JX_HBXV0PA&#125;</span><br></pre></td></tr></table></figure>

<p>根据题目信息，知道这是<strong>关键词密码，而且密钥是YOU</strong></p>
<p><img src="/../../images/LitCTF/2.png"></p>
<p>解码得到：</p>
<p><strong><code>LITCTF&#123;Y0U_AR3_MY_KEYW0RD&#125;</code></strong></p>
<h1 id="Is-this-only-base？"><a href="#Is-this-only-base？" class="headerlink" title="Is this only base？"></a>Is this only base？</h1><p><strong>栅栏 –&gt; base64 –&gt; 凯撒</strong></p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SWZxWl=F=DQef0hlEiSUIVh9ESCcMFS9NF2NXFzM</span><br><span class="line">今年是本世纪的第23年呢</span><br></pre></td></tr></table></figure>

<p><strong>先根据提示，23这个数字肯定有用</strong></p>
<p>首先栅栏密码解密，这里的栅栏密码是特殊的W型解密才能得到有效信息，栏目数为23</p>
<p>解密得到：</p>
<p><strong><code>SWZxWlFDe0liUV9ScF9FNFMzX2NSMCEhISEhfQ==</code></strong></p>
<p><strong>base64解密得到</strong>：</p>
<p><strong><code>IfqZQC&#123;IbQ_Rp_E4S3_cR0!!!!!&#125;</code></strong></p>
<p><strong>把LitCTF和IfqZQC对应一下</strong></p>
<p><img src="/../../images/LitCTF/4.png"></p>
<p><strong>凯撒移动3位得到</strong>：</p>
<p><strong><code>LitCTF&#123;LeT_Us_H4V3_fU0!!!!!&#125;</code></strong></p>
<h1 id="Virginia"><a href="#Virginia" class="headerlink" title="Virginia"></a>Virginia</h1><p><strong>维吉尼亚 –&gt; 凯撒</strong></p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ysexj lrk rzmkses os wilj hhks joa rtsy xzmktye yt xuim ehgy joa ofsz blnz yz pohv tnjx fxtx yuzc dxjlmy fyd nzr tnjx fuw cegq! Orkfx wnfe yuz haty eo jwpas;lz wnjce etf wgse tu lz;bk bsaz dzu cfyt zt me,hjnaaxp yuz sabj znrd znk qtfk fyd usp cnfyck yz du fwl zmp tnnygy dzu cfyt zt oo.Sfj yuz sabj pnuzrh nfapospsy yz mgpp yuz dwkje,ettfgn ycigqd tu rlkk dzu yycotl,pnuzrh ytcrub eo qjpp etf harln,kszumm sovj eo sfve etf hguay? Gqhaex auz dzuxxpll ny ozmpry’xsokx.Tf etf fkjw tnfe iz mfrzx joa,ne pxtmahqj hawes zmp ozmpr vjcsus, eou.Yse nfapojdt uk aeuuwe jty’t tjneyxlroqj hgap tnj meyy zf kapreysitl;ehkd uuyy xaqj ehk rzsz tq ebjcyzmtnm ysaz hzmkx llusr tnjtr cfj.Hguaitjds rnps ltc tntde cmz cxd,ehuxp wnt suxy, ehuxp wnt sabj degwnhki,lnj ysoyj hhu mlvk yciki,qox tyle ysee hln guarkhtazj ehk nxpuweathp ol upovqp,wnt sabj eoahsej yseow wibjd.Luap bkltny bttn f dmoqp,gxths cneh g ptsy fyd ksos cneh g ypax.Yse hwtgnypsz kftawp woqw arblyy gp bgxpd us l fuwrozypn vfdt, etf cgs’e gu ty wkqw it qtfkzytoq joa qpt mt zf etfr vfdt lftlawps gso hkfctghsey.Bset dzu cjce htcn,etf wkwp cxdtnm fyd kapretye gwzuti joa bls yrtlosr.Loap yuzc lokp su ysaz bset dzu jnp,yuz&#x27;ce zmp otj hhu nd ssnwitl lnj jgexdznk fcoaso yuz ts iwjitl.</span><br><span class="line">Uwegxp skso tnnd mkxdamj eo zmzsk upovqp wnt xegs dosjehosr tu dzu,zt ehuxp wnt sabj eoahsej dzux qtfk ny otj hae tc attehkw,eo zmzsk bso sfve etf ssnwe cmpn etf rkfwle spej ne,tu ysoyj ehgy xaqj joa xpe zmp bxnrhzjc soip ol ysitld wnjy yuz lrk wparqj duby,tu ysoyj hhu dzu cfyt zt wez yses pyoc ysaz dzu guarkhtazj ehknc fxnpnjxsiv.Fyd ok joa izn’z, izn’z bzrxd,yozmtnm gld cnwl nfapks eo etf,yuz hirq uuyy xiyx zuz ty tnj zpvtctastte yz bxnrhzjy surpotj’d dgd hizm ehox xeyxlgk.Rj pgxdwuwo iy szt g wpgaqlr Ifpsgw aayxhoxi,lnj yse ksn frfr=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164] -Cgjdax</span><br></pre></td></tr></table></figure>

<p>维吉尼亚第一次解密得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">There are moments in life when you miss someone so much that you just want to pick them from your dreams and hug them for real! Dream what you want to dream;go where you want to go;be what you want to be,because you have only one life and one chance to do all the things you want to do.May you have enough happiness to make you sweet,enough trials to make you strong,enough sorrow to keep you human,enough hope to make you happy? Always put yourself in others’shoes.If you feel that it hurts you,it probably hurts the other person, too.The happiest of people don’t necessarily have the best of everything;they just make the most of everything that comes along their way.Happiness lies for those who cry,those who hurt, those who have searched,and those who have tried,for only they can appreciate the importance of people,who have touched their lives.Love begins with a smile,grows with a kiss and ends with a tear.The brightest future will always be based on a forgotten past, you can’t go on well in lifeuntil you let go of your past failures and heartaches.When you were born,you were crying and everyone around you was smiling.Live your life so that when you die,you&#x27;re the one who is smiling and everyone around you is crying.</span><br><span class="line">Jwybmp mfho nicd gfmduhy ei ubzmf jpiqfp qii xybh dinyebjhr np szo,ui ebpmp qii suwy eivwsye szos ftzf cy ioy huz ic uoiebfl,ei ubzmf qsi nuvy zif mncwy xbph zif lfuwfz hpye ce,np nsity ebbn xuly jiv mpy ubp vscrbuyc mjxp ig nscoad qiyy spo llf lpumfj xpqy,np nsity hbp szo xuyn ui wyu nsyn eyix nsuu szo bjalfwtuuy ebfcc zscphemscq.Uyx jz jiv xzh’u, xzh’u qzlss,yiubthh vlx xcwf iuajfh ei zif,spo hcmf uotn xctm zou iy niy zjqicnvhtnz nz vscrbuyy mpgpioy’d xbs hcub ebjm xytmlaf.Gj jbmdqplo ct hzn b lpavfll Dupmbl autmhisx,lhe nsy fhn zmur=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164] -Wbydus</span><br></pre></td></tr></table></figure>

<p>似乎没什么用，但是发现还有一段怪怪的信息，再解密一次：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Please send this message to those people who mean something to you,to those who have touched your life in one way or another,to those who make you smile when you really need it,to those that make you see the brighter side of things when you are really down,to those who you want to let them know that you appreciate their friendship.And if you don’t, don’t worry,nothing bad will happen to you,you will just miss out on the opportunity to brighten someone’s day with this message.My password is not a regular Caesar password,and the enc flag=[86, 116, 128, 80, 98, 85, 139, 122, 134, 114, 125, 136, 117, 123, 129, 127, 128, 128, 142, 130, 140, 147, 127, 132, 131, 136, 151, 134, 152, 164] -Caesar</span><br></pre></td></tr></table></figure>

<p>注意到这段话来自<strong>Caesar(凯撒大帝)</strong></p>
<p><strong>把LitCTF的ascii码和86，116，128，80，98，85对应</strong>：</p>
<p><img src="/../../images/LitCTF/5.png"></p>
<p>写个脚本跑一下</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">list</span>=[<span class="number">86</span>, <span class="number">116</span>, <span class="number">128</span>, <span class="number">80</span>, <span class="number">98</span>, <span class="number">85</span>, <span class="number">139</span>, <span class="number">122</span>, <span class="number">134</span>, <span class="number">114</span>, <span class="number">125</span>, <span class="number">136</span>, <span class="number">117</span>, <span class="number">123</span>, <span class="number">129</span>, <span class="number">127</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">142</span>, <span class="number">130</span>, <span class="number">140</span>, <span class="number">147</span>, <span class="number">127</span>, <span class="number">132</span>, <span class="number">131</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">134</span>, <span class="number">152</span>, <span class="number">164</span>]</span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    flag += <span class="built_in">chr</span>(i-(<span class="number">10</span>+j))</span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;it_is_different_caesar&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="隐晦的消息记录"><a href="#隐晦的消息记录" class="headerlink" title="隐晦的消息记录"></a>隐晦的消息记录</h1><p><strong>OPT(一次一密)加密</strong><a href="https://dexterjie.github.io/2023/07/05/OPT-%E4%B8%80%E6%AC%A1%E4%B8%80%E5%AF%86-%E5%8A%A0%E5%AF%86%E6%96%B9%E5%BC%8F/">OPT(一次一密加密法) - DexterJie’s Blog</a></p>
<p><img src="/../../images/LitCTF/3.png"></p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">出题人:6c73d5240a948c86981bc294814d</span><br><span class="line">某不知名收件人：收到消息attack at dawn</span><br><span class="line">出题人:xxxxxxxxxxxxxxxxxxxxxxxxxxxx</span><br><span class="line">某不知名收件人：收到消息Monday or Thur</span><br><span class="line">已知出题人和收件人手中的密钥相同，请解出出题人第二次发送的密文呢（16进制，字母小写，解得的结果记得要加上LitCTF&#123;&#125;哦。）</span><br></pre></td></tr></table></figure>

<p>根据题目提示，知道这是OPT加密，了解一下原理之后就知道该加密方式是通过异或实现的</p>
<p>只要把密文和密钥进行异或就能得到明文</p>
<p><strong>首先把 <code>attack at dawn</code>转成16进制，再和<code>6c73d5240a948c86981bc294814d</code>进行异或，即可得到密钥，因为两次密钥相同，所以把<code>Monday or Thur</code>和密钥异或，就是我们要的密文</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">ciphertext1 = <span class="number">0x6c73d5240a948c86981bc294814d</span>    <span class="comment">#   attack at dawn转16进制后</span></span><br><span class="line">plaintext1 = <span class="number">0x61747461636b206174206461776e</span></span><br><span class="line"></span><br><span class="line">key = ciphertext1 ^ plaintext1</span><br><span class="line"></span><br><span class="line"><span class="comment">#   key = 0xd07a14569fface7ec3ba6f5f623</span></span><br><span class="line"></span><br><span class="line">plaintext2 = <span class="number">0x4d6f6e646179206f722054687572</span>      <span class="comment">#  Monday or Thur转16进制后</span></span><br><span class="line"></span><br><span class="line">ciphertext2 = key ^ plaintext2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(ciphertext2))</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;4068cf2108868c889e1bf29d8351&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="RSA签到"><a href="#RSA签到" class="headerlink" title="RSA签到"></a>RSA签到</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">e = 65537</span><br><span class="line">n = p*q</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;q = &#123;q&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p = 12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073</span><br><span class="line">q = 12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451</span><br><span class="line">c = 108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">p = <span class="number">12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073</span></span><br><span class="line">q =<span class="number">12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c =<span class="number">108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;it_is_easy_to_solve_question_when_you_know_p_and_q&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="md5的破解"><a href="#md5的破解" class="headerlink" title="md5的破解"></a>md5的破解</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from hashlib import md5</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">#flag全是由小写字母及数字组成</span><br><span class="line">m=md5(flag).hexdigest()</span><br><span class="line">print(flag[:13]+flag[15:18]+flag[19:34]+flag[35:38])</span><br><span class="line">print(m)</span><br><span class="line"># b&#x27;LitCTF&#123;md5can3derypt213thoughcrsh&#125;&#x27;</span><br><span class="line"># 496603d6953a15846cd7cc476f146771</span><br></pre></td></tr></table></figure>

<p><strong>注意切片，前面闭区间，后面开区间</strong></p>
<p><strong>这里输出flag中索引值0—12， 15—17， 19—33， 35—37</strong></p>
<p>第13，14，18，34位需要爆破，根据提示可以缩小爆破范围</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> string.ascii_lowercase + string.digits:</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> string.ascii_lowercase + string.digits:</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> string.ascii_lowercase + string.digits:</span><br><span class="line">            <span class="keyword">for</span> d <span class="keyword">in</span> string.ascii_lowercase + string.digits:</span><br><span class="line">                flag = <span class="string">&quot;LitCTF&#123;md5can&quot;</span> + a + b + <span class="string">&quot;3de&quot;</span> + c + <span class="string">&quot;rypt213thoughcr&quot;</span> + d +<span class="string">&quot;sh&#125;&quot;</span></span><br><span class="line">                s = hashlib.md5(flag.encode()).hexdigest()</span><br><span class="line">                <span class="keyword">if</span> s == <span class="string">&quot;496603d6953a15846cd7cc476f146771&quot;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                    </span><br><span class="line"><span class="comment">#LitCTF&#123;md5can123dexrypt213thoughcrpsh&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="yafu"><a href="#yafu" class="headerlink" title="yafu"></a>yafu</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n  = 1</span><br><span class="line">for i in range(15):</span><br><span class="line">    n *=getPrime(32)</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n = 15241208217768849887180010139590210767831431018204645415681695749294131435566140166245881287131522331092026252879324931622292179726764214435307</span><br><span class="line">c = 12608550100856399369399391849907846147170257754920996952259023159548789970041433744454761458030776176806265496305629236559551086998780836655717</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>注意n的产生方式，是由15个素数相乘得到</p>
<p>分解n,得到15个因子，然后求</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line">c = <span class="number">12608550100856399369399391849907846147170257754920996952259023159548789970041433744454761458030776176806265496305629236559551086998780836655717</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n =<span class="number">15241208217768849887180010139590210767831431018204645415681695749294131435566140166245881287131522331092026252879324931622292179726764214435307</span></span><br><span class="line"></span><br><span class="line">p =[<span class="number">2201440207</span>,<span class="number">3354884521</span>,<span class="number">4171911923</span>,<span class="number">2719600579</span>,<span class="number">2906576131</span>,<span class="number">4021078331</span>,<span class="number">2151018733</span>,<span class="number">2758708999</span>,<span class="number">2315495107</span>,<span class="number">4044505687</span>,<span class="number">2923522073</span>,<span class="number">3355651511</span>,<span class="number">2585574697</span>,<span class="number">2767137487</span>,<span class="number">3989697563</span>]</span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    phi *= i-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">d = invert(e,phi)</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;Mu1tiple_3m4ll_prim5_fac7ors_@re_uns4f5&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="factot-b"><a href="#factot-b" class="headerlink" title="factot b"></a>factot b</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e = 65537</span><br><span class="line">n = 87924348264132406875276140514499937145050893665602592992418171647042491658461</span><br><span class="line">c = 87677652386897749300638591365341016390128692783949277305987828177045932576708</span><br></pre></td></tr></table></figure>

<p>网站分解</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line">p =<span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q =<span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c =<span class="number">87677652386897749300638591365341016390128692783949277305987828177045932576708</span></span><br><span class="line"></span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;factordb!!!&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="the-same-common-divisor"><a href="#the-same-common-divisor" class="headerlink" title="the same common divisor"></a>the same common divisor</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">m=bytes_to_long(b&#x27;xxxxxx&#x27;)</span><br><span class="line">e=65537</span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q1=getPrime(1024)</span><br><span class="line">q2=getPrime(1024)</span><br><span class="line">n1=p*q1</span><br><span class="line">n2=p*q2</span><br><span class="line">c1=pow(m,e,n1)</span><br><span class="line">c2=pow(m,e,n2)</span><br><span class="line">n3=n1^n2</span><br><span class="line">print(&#x27;n1=&#x27;,n1)</span><br><span class="line">print(&#x27;n3=&#x27;,n3)</span><br><span class="line">print(&#x27;c1=&#x27;,c1)</span><br><span class="line">print(&#x27;c2=&#x27;,c2)</span><br><span class="line">#n1= 9852079772293301283705208653824307027320071498525390578148444258198605733768947108049676831872672654449631852459503049139275329796717506126689710613873813880735666507857022786447784753088176997374711523987152412069255685005264853118880922539048290400078105858759506186417678959028622484823376958194324034590514104266608644398160457382895380141070373685334979803658172378382884352616985632157233900719194944197689860219335238499593658894630966428723660931647038577670614850305719449893199713589368780231046895222526070730152875112477675102652862254926169713030701937231206405968412044029177246460558028793385980934233</span><br><span class="line">#n3= 4940268030889181135441311597961813780480775970170156650560367030148383674257975796516865571557828263935532335958510269356443566533284856608454193676600884849913964971291145182724888816164723930966472329604608512023988191536173112847915884014445539739070437180314205284883149421228744714989392788108329929896637182055266508625177260492776962915873036873839946591259443753924970795669864031580632650140641456386202636466624658715315856453572441182758855085077441336516178544978457053552156714181607801760605521338788424464551796638531143900048375037218585999440622490119344971822707261432953755569507740550277088437182</span><br><span class="line">#c1= 7066425618980522033304943700150361912772559890076173881522840300333719222157667104461410726444725540513601550570478331917063911791020088865705346188662290524599499769112250751103647749860198318955619903728724860941709527724500004142950768744200491448875522031555564384426372047270359602780292587644737898593450148108629904854675417943165292922990980758572264063039172969633878015560735737699147707712154627358077477591293746136250207139049702201052305840453700782016480965369600667516646007546442708862429431724013679189842300429421340122052682391471347471758814138218632022564279296594279507382548264409296929401260</span><br><span class="line">#c2= 854668035897095127498890630660344701894030345838998465420605524714323454298819946231147930930739944351187708040037822108105697983018529921300277486094149269105712677374751164879455815185393395371001495146490416978221501351569800028842842393448555836910486037183218754013655794027528039329299851644787006463456162952383099752894635657833907958930587328480492546831654755627949756658554724024525108575961076341962292900510328611128404001877137799465932130220386963518903892403159969133882215092783063943679288192557384595152566356483424061922742307738886179947575613661171671781544283180451958232826666741028590085269</span><br></pre></td></tr></table></figure>

<p><strong>共享素数</strong></p>
<p>n1和n2共用了p</p>
<p>先异或n1,n3得到n2,再得到p</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd,invert</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">9852079772293301283705208653824307027320071498525390578148444258198605733768947108049676831872672654449631852459503049139275329796717506126689710613873813880735666507857022786447784753088176997374711523987152412069255685005264853118880922539048290400078105858759506186417678959028622484823376958194324034590514104266608644398160457382895380141070373685334979803658172378382884352616985632157233900719194944197689860219335238499593658894630966428723660931647038577670614850305719449893199713589368780231046895222526070730152875112477675102652862254926169713030701937231206405968412044029177246460558028793385980934233</span></span><br><span class="line">n3 = <span class="number">4940268030889181135441311597961813780480775970170156650560367030148383674257975796516865571557828263935532335958510269356443566533284856608454193676600884849913964971291145182724888816164723930966472329604608512023988191536173112847915884014445539739070437180314205284883149421228744714989392788108329929896637182055266508625177260492776962915873036873839946591259443753924970795669864031580632650140641456386202636466624658715315856453572441182758855085077441336516178544978457053552156714181607801760605521338788424464551796638531143900048375037218585999440622490119344971822707261432953755569507740550277088437182</span></span><br><span class="line">c1 = <span class="number">7066425618980522033304943700150361912772559890076173881522840300333719222157667104461410726444725540513601550570478331917063911791020088865705346188662290524599499769112250751103647749860198318955619903728724860941709527724500004142950768744200491448875522031555564384426372047270359602780292587644737898593450148108629904854675417943165292922990980758572264063039172969633878015560735737699147707712154627358077477591293746136250207139049702201052305840453700782016480965369600667516646007546442708862429431724013679189842300429421340122052682391471347471758814138218632022564279296594279507382548264409296929401260</span></span><br><span class="line">c2 = <span class="number">854668035897095127498890630660344701894030345838998465420605524714323454298819946231147930930739944351187708040037822108105697983018529921300277486094149269105712677374751164879455815185393395371001495146490416978221501351569800028842842393448555836910486037183218754013655794027528039329299851644787006463456162952383099752894635657833907958930587328480492546831654755627949756658554724024525108575961076341962292900510328611128404001877137799465932130220386963518903892403159969133882215092783063943679288192557384595152566356483424061922742307738886179947575613661171671781544283180451958232826666741028590085269</span></span><br><span class="line"></span><br><span class="line">n2 = n1 ^ n3</span><br><span class="line">p = gcd(n1,n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d,n1)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;TH3_Tw0_nUmb3rs_H@v3_The_sAme_D1v1s0r!!&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="e的学问"><a href="#e的学问" class="headerlink" title="e的学问"></a>e的学问</h1><p><strong>考点是e和phi不互素</strong>，相关知识在学习过程中有</p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">m=bytes_to_long(b&#x27;xxxxxx&#x27;)</span><br><span class="line">p=getPrime(256)</span><br><span class="line">q=getPrime(256)</span><br><span class="line">e=74</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;p=&quot;,p)</span><br><span class="line">print(&quot;q=&quot;,q)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">#p= 86053582917386343422567174764040471033234388106968488834872953625339458483149</span><br><span class="line">#q= 72031998384560188060716696553519973198388628004850270102102972862328770104493</span><br><span class="line">#c= 3939634105073614197573473825268995321781553470182462454724181094897309933627076266632153551522332244941496491385911139566998817961371516587764621395810123</span><br></pre></td></tr></table></figure>

<p>因为e和phi不互素,先对e和phi求公因数<strong>t</strong>，再把e除去这个公因数</p>
<p><strong>这样就使得新的e和phi互素</strong></p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">86053582917386343422567174764040471033234388106968488834872953625339458483149</span></span><br><span class="line">q = <span class="number">72031998384560188060716696553519973198388628004850270102102972862328770104493</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">74</span></span><br><span class="line">c = <span class="number">3939634105073614197573473825268995321781553470182462454724181094897309933627076266632153551522332244941496491385911139566998817961371516587764621395810123</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> gmpy2.gcd(phi,e) != <span class="number">1</span>:                   </span><br><span class="line">    t = gmpy2.gcd(phi,e)                <span class="comment">#因为Phi和e不互素，所以要用e除掉他们的公因数，保证新的e和phi互素</span></span><br><span class="line">    e1 = e // t</span><br><span class="line">    d = gmpy2.invert(e1,phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    msg = gmpy2.iroot(m,t)				</span><br><span class="line">    <span class="keyword">if</span> msg[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(msg[<span class="number">0</span>]))	</span><br><span class="line"></span><br><span class="line"> <span class="comment">#LitCTF&#123;e_1s_n0t_@_Prime&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="Euler"><a href="#Euler" class="headerlink" title="Euler"></a>Euler</h1><p><strong>对欧拉函数的理解</strong></p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n = p*q</span><br><span class="line">c = pow(m,n-p-q+3,n)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">n = 115140122725890943990475192890188343698762004010330526468754961357872096040956340092062274481843042907652320664917728267982409212988849109825729150839069369465433531269728824368749655421846730162477193420534803525810831025762500375845466064264837531992986534097821734242082950392892529951104643690838773406549</span><br><span class="line">c = 406480424882876909664869928877322864482740577681292497936198951316587691545267772748204383995815523935005725558478033908575228532559165174398668885819826720515607326399097899572022020453298441</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/LitCTF/7.png"></p>
<p>通过爆破K,即可得到m。</p>
<p><strong>自己闲着没事试了一下，好像m的次方大于5就不能通过这个方法求</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line">n = <span class="number">115140122725890943990475192890188343698762004010330526468754961357872096040956340092062274481843042907652320664917728267982409212988849109825729150839069369465433531269728824368749655421846730162477193420534803525810831025762500375845466064264837531992986534097821734242082950392892529951104643690838773406549</span></span><br><span class="line">c = <span class="number">406480424882876909664869928877322864482740577681292497936198951316587691545267772748204383995815523935005725558478033908575228532559165174398668885819826720515607326399097899572022020453298441</span></span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    m = iroot(k*n+c,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    flag = <span class="built_in">str</span>(long_to_bytes(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;LitCTF&quot;</span> <span class="keyword">in</span> flag :</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">#LitCTF&#123;a1a8887793acfc199182a649e905daab&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h1><p><strong>解方程</strong></p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = 65537</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(128)</span><br><span class="line">n = p*q</span><br><span class="line">hint = p**3-q**5</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">print(f&#x27;hint = &#123;hint&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n = 2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797</span><br><span class="line">c = 2168563038335029902089976057856861885635845445863841607485310134441400500612435296818745930370268060353437465666224400129105788787423156958336380480503762222278722770240792709450637433509537280</span><br><span class="line">hint = 392490868359411675557103683163021977774935163924606169241731307258226973701652855448542714274348304997416149742779376023311152228735117186027560227613656229190807480010615064372521942836446425717660375242197759811804760170129768647414717571386950790115746414735411766002368288743086845078803312201707960465419405926186622999423245762570917629351110970429987377475979058821154568001902541710817731089463915930932142007312230897818177067675996751110894377356758932</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/LitCTF/6.png"></p>
<p>解方程得到p</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义符号变量</span></span><br><span class="line">x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">hint = <span class="number">392490868359411675557103683163021977774935163924606169241731307258226973701652855448542714274348304997416149742779376023311152228735117186027560227613656229190807480010615064372521942836446425717660375242197759811804760170129768647414717571386950790115746414735411766002368288743086845078803312201707960465419405926186622999423245762570917629351110970429987377475979058821154568001902541710817731089463915930932142007312230897818177067675996751110894377356758932</span></span><br><span class="line">n = <span class="number">2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797</span></span><br><span class="line"><span class="comment"># 定义方程</span></span><br><span class="line">eq = x**<span class="number">8</span> - x**<span class="number">5</span>*hint - n**<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解方程</span></span><br><span class="line">sol = solve(eq, x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印解</span></span><br><span class="line"><span class="built_in">print</span>(sol)</span><br></pre></td></tr></table></figure>

<p>这个脚本能跑，需要很久，而且输出的结果很多</p>
<p>用下面这个脚本可以更快求出p</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义符号变量</span></span><br><span class="line">p = symbols(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = symbols(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">hint = <span class="number">392490868359411675557103683163021977774935163924606169241731307258226973701652855448542714274348304997416149742779376023311152228735117186027560227613656229190807480010615064372521942836446425717660375242197759811804760170129768647414717571386950790115746414735411766002368288743086845078803312201707960465419405926186622999423245762570917629351110970429987377475979058821154568001902541710817731089463915930932142007312230897818177067675996751110894377356758932</span></span><br><span class="line">n = <span class="number">2230791374046346835775433548641067593691369485828070649075162141394476183565187654365131822111419512477883295758461313983481545182887415447403634720326639070667688614534290859200753589300443797</span></span><br><span class="line"><span class="comment"># 定义方程</span></span><br><span class="line">eq1 = p**<span class="number">3</span> - q**<span class="number">5</span> -hint</span><br><span class="line">eq2 = p * q - n </span><br><span class="line"><span class="comment"># 解方程</span></span><br><span class="line">sol = solve((eq1,eq2),(p,q))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印解</span></span><br><span class="line"><span class="built_in">print</span>(sol)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c=<span class="number">2168563038335029902089976057856861885635845445863841607485310134441400500612435296818745930370268060353437465666224400129105788787423156958336380480503762222278722770240792709450637433509537280</span></span><br><span class="line">p = <span class="number">7321664971326604351487965655099805117568571010588695608389113791312918573783115429227542573780838065461696504325762281209452761930184231131129306271846427</span></span><br><span class="line">q = <span class="number">304683618109085947723284393392507415311</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;f9fab7522253e44b48824e914d0801ba&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="babyLCG"><a href="#babyLCG" class="headerlink" title="babyLCG"></a>babyLCG</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">bit_len = m.bit_length()</span><br><span class="line">a = getPrime(bit_len)</span><br><span class="line">b = getPrime(bit_len)</span><br><span class="line">p = getPrime(bit_len+1)</span><br><span class="line"></span><br><span class="line">seed = m</span><br><span class="line">result = []</span><br><span class="line">for i in range(10):</span><br><span class="line">    seed = (a*seed+b)%p</span><br><span class="line">    result.append(seed)</span><br><span class="line">print(result)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">result = [699175025435513913222265085178805479192132631113784770123757454808149151697608216361550466652878, 193316257467202036043918706856603526262215679149886976392930192639917920593706895122296071643390, 1624937780477561769577140419364339298985292198464188802403816662221142156714021229977403603922943, 659236391930254891621938248429619132720452597526316230221895367798170380093631947248925278766506, 111407194162820942281872438978366964960570302720229611594374532025973998885554449685055172110829, 1415787594624585063605356859393351333923892058922987749824214311091742328340293435914830175796909, 655057648553921580727111809001898496375489870757705297406250204329094679858718932270475755075698, 1683427135823894785654993254138434580152093609545092045940376086714124324274044014654085676620851, 492953986125248558013838257810313149490245209968714980288031443714890115686764222999717055064509, 70048773361068060773257074705619791938224397526269544533030294499007242937089146507674570192265]</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>求seed初始值，在此之前需要先求a,b,m</strong></p>
<p><strong>关于lcg体制可以观看另外一篇博客</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">output = [...]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        t1 = output[i+<span class="number">1</span>]-output[i]</span><br><span class="line">        t2 = output[i+<span class="number">2</span>]-output[i+<span class="number">1</span>]</span><br><span class="line">        t3 = output[i+<span class="number">3</span>]-output[i+<span class="number">2</span>]</span><br><span class="line">        t4 = output[i+<span class="number">4</span>]-output[i+<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">        T1 = t1*t3 - t2*t2</span><br><span class="line">        T2 = t2*t4 - t3*t3</span><br><span class="line">        n = gmpy2.gcd(T1,T2)</span><br><span class="line"></span><br><span class="line">        ni = gmpy2.invert(t1,n)</span><br><span class="line">        a = t2 * ni % n</span><br><span class="line"></span><br><span class="line">        Ani = gmpy2.invert(a,n)</span><br><span class="line">        b = (output[i+<span class="number">1</span>] - a*output[i]) % n</span><br><span class="line"></span><br><span class="line">        m = Ani *(output[<span class="number">0</span>]-b) % n</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#LitCTF&#123;31fcd7832029a87f6c9f760fcf297b2f&#125;</span></span><br></pre></td></tr></table></figure>

<p>3tefaine丶zhou师傅分享的另外一个wp</p>
<p>another exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">result = [...]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建一个多项式环，包含两个变量a和b，系数在整数域ZZ上</span></span><br><span class="line">P.&lt;a,b&gt; = PolynomialRing(ZZ)</span><br><span class="line"><span class="comment"># 定义了四个多项式方程f1,f2,f3,f4,其中result是一个包含数值的列表。</span></span><br><span class="line"><span class="comment"># 所以这构建了一个线性方程组</span></span><br><span class="line">f1 = result[<span class="number">0</span>]*a + b - result[<span class="number">1</span>]</span><br><span class="line">f2 = result[<span class="number">1</span>]*a + b - result[<span class="number">2</span>]</span><br><span class="line">f3 = result[<span class="number">2</span>]*a + b - result[<span class="number">3</span>]</span><br><span class="line">f4 = result[<span class="number">3</span>]*a + b - result[<span class="number">4</span>]</span><br><span class="line"><span class="comment"># 将四个方程存储在列表F中</span></span><br><span class="line">F = [f1,f2,f3,f4]</span><br><span class="line"><span class="comment"># 使用F构建一个理想的Ideal。</span></span><br><span class="line">Ideal = Ideal(F)</span><br><span class="line"><span class="comment"># # 计算Ideal的Gröbner基I</span></span><br><span class="line">I = Ideal.groebner_basis()</span><br><span class="line"><span class="built_in">print</span>(I)</span><br><span class="line"></span><br><span class="line">a = ZZ(-I[<span class="number">0</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line">b = ZZ(-I[<span class="number">1</span>].univariate_polynomial()(<span class="number">0</span>))</span><br><span class="line">p = ZZ(I[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">m = (result[<span class="number">0</span>]-b)*a^-<span class="number">1</span> % p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>





<h1 id="P-leak"><a href="#P-leak" class="headerlink" title="P_leak"></a>P_leak</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">e=65537</span><br><span class="line">m=bytes_to_long(b&#x27;xxxx&#x27;)</span><br><span class="line">p=getPrime(512)</span><br><span class="line">q=getPrime(512)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">d=inverse(e,phi)</span><br><span class="line">dp=d%(p-1)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;dp=&quot;,dp)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line"></span><br><span class="line">#dp= 5892502924236878675675338970704766304539618343869489297045857272605067962848952532606770917225218534430490745895652561015493032055636004130931491316020329</span><br><span class="line">#n= 50612159190225619689404794427464916374543237300894011803225784470008992781409447214236779975896311093686413491163221778479739252804271270231391599602217675895446538524670610623369953168412236472302812808639218392319634397138871387898452935081756580084070333246950840091192420542761507705395568904875746222477</span><br><span class="line">#c= 39257649468514605476432946851710016346016992413796229928386230062780829495844059368939749930876895443279723032641876662714088329296631207594999580050131450251288839714711436117326769029649419789323982613380617840218087161435260837263996287628129307328857086987521821533565738409794866606381789730458247531619</span><br></pre></td></tr></table></figure>

<p><strong>dp泄露</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">50612159190225619689404794427464916374543237300894011803225784470008992781409447214236779975896311093686413491163221778479739252804271270231391599602217675895446538524670610623369953168412236472302812808639218392319634397138871387898452935081756580084070333246950840091192420542761507705395568904875746222477</span></span><br><span class="line">c = <span class="number">39257649468514605476432946851710016346016992413796229928386230062780829495844059368939749930876895443279723032641876662714088329296631207594999580050131450251288839714711436117326769029649419789323982613380617840218087161435260837263996287628129307328857086987521821533565738409794866606381789730458247531619</span></span><br><span class="line">dp =<span class="number">5892502924236878675675338970704766304539618343869489297045857272605067962848952532606770917225218534430490745895652561015493032055636004130931491316020329</span></span><br><span class="line">e =<span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    t = (dp * e - <span class="number">1</span>) % i        </span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">        p = (dp * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">            q = n // p</span><br><span class="line">            d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line">            </span><br><span class="line"><span class="comment">#LitCTF&#123;Prim3_1s_Le@k!!!!!&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Where-is-P"><a href="#Where-is-P" class="headerlink" title="Where is P"></a>Where is P</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">m=bytes_to_long(b&#x27;XXXX&#x27;)</span><br><span class="line">e=65537</span><br><span class="line">p=getPrime(1024)</span><br><span class="line">q=getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">print(p)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">P=p&gt;&gt;340</span><br><span class="line">print(P)</span><br><span class="line">a=pow(P,3,n)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;a=&quot;,a)</span><br><span class="line"></span><br><span class="line">#n= 24479907029118467064460793139240403258697681144532146836881997837526487637306591893357774423547391867013441147680031968367449693796015901951120514250935018725570026327610524687128709707340727799633444550317834481416507364804274266363478822257132586592232042108076935945436358397787891169163821061005102693505011197453089873909085170776511350713452580692963748763166981047023704528272230392479728897831538235554137129584665886878574314566549330671483636900134584707867654841021494106881794644469229030140144595938886437242375435914268001721437309283611088568191856208951867342004280893021653793820874747638264412653721</span><br><span class="line">#c= 6566517934961780069851397787369134601399136324586682773286046135297104713708615112015588908759927424841719937322574766875308296258325687730658550956691921018605724308665345526807393669538103819281108643141723589363068859617542807984954436567078438099854340705208503317269397632214274507740533638883597409138972287275965697689862321166613821995226000320597560745749780942467497435742492468670016480112957715214640939272457886646483560443432985954141177463448896521810457886108311082101521263110578485768091003174683555938678346359150123350656418123918738868598042533211541966786594006129134087145798672161268647536724</span><br><span class="line">#a= 22184346235325197613876257964606959796734210361241668065837491428527234174610482874427139453643569493268653377061231169173874401139203757698022691973395609028489121048788465356158531144787135876251872262389742175830840373281181905217510352227396545981674450409488394636498629147806808635157820030290630290808150235068140864601098322473572121965126109735529553247807211711005936042322910065304489093415276688746634951081501428768318098925390576594162098506572668709475140964400043947851427774550253257759990959997691631511262768785787474750441024242552456956598974533625095249106992723798354594261566983135394923063605</span><br></pre></td></tr></table></figure>

<p><strong>p高位泄露</strong></p>
<p><strong>因为P大小为684bit,P的3次方是2052bit，而n是2048bit，相差4位</strong></p>
<p><strong>爆一下k就可以得到P</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">n= 24479907029118467064460793139240403258697681144532146836881997837526487637306591893357774423547391867013441147680031968367449693796015901951120514250935018725570026327610524687128709707340727799633444550317834481416507364804274266363478822257132586592232042108076935945436358397787891169163821061005102693505011197453089873909085170776511350713452580692963748763166981047023704528272230392479728897831538235554137129584665886878574314566549330671483636900134584707867654841021494106881794644469229030140144595938886437242375435914268001721437309283611088568191856208951867342004280893021653793820874747638264412653721</span><br><span class="line">c= 6566517934961780069851397787369134601399136324586682773286046135297104713708615112015588908759927424841719937322574766875308296258325687730658550956691921018605724308665345526807393669538103819281108643141723589363068859617542807984954436567078438099854340705208503317269397632214274507740533638883597409138972287275965697689862321166613821995226000320597560745749780942467497435742492468670016480112957715214640939272457886646483560443432985954141177463448896521810457886108311082101521263110578485768091003174683555938678346359150123350656418123918738868598042533211541966786594006129134087145798672161268647536724</span><br><span class="line">a= 22184346235325197613876257964606959796734210361241668065837491428527234174610482874427139453643569493268653377061231169173874401139203757698022691973395609028489121048788465356158531144787135876251872262389742175830840373281181905217510352227396545981674450409488394636498629147806808635157820030290630290808150235068140864601098322473572121965126109735529553247807211711005936042322910065304489093415276688746634951081501428768318098925390576594162098506572668709475140964400043947851427774550253257759990959997691631511262768785787474750441024242552456956598974533625095249106992723798354594261566983135394923063605</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">for k in range(1000):</span><br><span class="line">    t = gmpy2.iroot(k*n+a,3)</span><br><span class="line">    if t[1]:</span><br><span class="line">        high_p = int(t[0])&lt;&lt;340</span><br><span class="line">        f = high_p + x</span><br><span class="line">        x = f.small_roots(X = 2^340,beta = 0.4)</span><br><span class="line">        if x:</span><br><span class="line">            p = int(high_p + x[0])</span><br><span class="line">            q = n  //  int(p)</span><br><span class="line">            d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">            m = pow(c,d,n)</span><br><span class="line">            print(k)</span><br><span class="line">            print(long_to_bytes(int(m)))</span><br><span class="line">            break</span><br><span class="line">    </span><br><span class="line"># k = 11</span><br><span class="line"># LitCTF&#123;Y0U_hAV3_g0T_Th3_r1ghT_AnsW3r&#125;</span><br></pre></td></tr></table></figure>



<h1 id="我测你vva"><a href="#我测你vva" class="headerlink" title="我测你vva"></a>我测你vva</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class Encrypto&#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        String flag=&quot;&quot;;</span><br><span class="line">        int cipher;</span><br><span class="line">        char[] arr;</span><br><span class="line">        arr=flag.toCharArray();</span><br><span class="line">        for(int i=0; i&lt;flag.length(); i++) &#123;</span><br><span class="line">           if(i%2==0)&#123;</span><br><span class="line">            cipher=Integer.valueOf(arr[i]);</span><br><span class="line">            cipher=cipher+i;</span><br><span class="line">            System.out.print((char)cipher);</span><br><span class="line">           &#125;</span><br><span class="line">           if(i%2!=0)&#123;</span><br><span class="line">            cipher=Integer.valueOf(arr[i]);</span><br><span class="line">            cipher=cipher-i;</span><br><span class="line">            System.out.print((char)cipher);</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//cipher=HYEQJvPZ~X@+Bp</span><br></pre></td></tr></table></figure>

<p><strong>比赛的时候是非预期解，现在重新做一遍</strong></p>
<p><strong><code>Integer.valueOf()</code> 方法将一个字符串表示的整数转换为对应的<code>Integer</code> 对象</strong></p>
<p><strong>题目的意思就是把明文偶数位的值加上他的索引值再变为字符串,eg:<code>arr[2]=&quot;65&quot;</code>经过加密之后这个位置就变成了”C”</strong></p>
<p><strong>奇数位则是把明文减去他的索引值</strong></p>
<p><strong>把脚本逆回去就行了</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Decrypto</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        String Cipher=<span class="string">&quot;HYEQJvPZ~X@+Bp&quot;</span>;</span><br><span class="line">        <span class="type">int</span> flag;</span><br><span class="line">        <span class="type">char</span>[] arr;</span><br><span class="line">        arr=Cipher.toCharArray();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;Cipher.length(); i++) &#123;</span><br><span class="line">           <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">            flag=Integer.valueOf(arr[i]);</span><br><span class="line">            flag=flag-i;</span><br><span class="line">            System.out.print((<span class="type">char</span>)flag);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">            flag=Integer.valueOf(arr[i]);</span><br><span class="line">            flag=flag+i;</span><br><span class="line">            System.out.print((<span class="type">char</span>)flag);</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># HZCTF&#123;Java666&#125;</span><br><span class="line"># 格式改一下 LitCTF&#123;Java666&#125;</span><br></pre></td></tr></table></figure>



<h1 id="Babyxor"><a href="#Babyxor" class="headerlink" title="Babyxor"></a>Babyxor</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">assert len(flag)==32</span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n = p*q</span><br><span class="line">e = 65537</span><br><span class="line">c1 = p^m</span><br><span class="line">c2 = pow(m,e,n)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c2&#125;&#x27;)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">n = 139167681803392690594490403105432649693546256181767408269202101512534988406137879788255103631885736461742577594980136624933914700779445704490217419248411578290305101891222576080645870988658334799437317221565839991979543660824098367011942169305111105129234902517835649895908656770416774539906212596072334423407</span><br><span class="line">c1 = 11201139662236758800406931253538295757259990870588609533820056210585752522925690049252488581929717556881067021381940083808024384402885422258545946243513996</span><br><span class="line">c2 = 112016152270171196606652761990170033221036025260883289104273504703557624964071464062375228351458191745141525003775876044271210498526920529385038130932141551598616579917681815276713386113932345056134302042399379895915706991873687943357627747262597883603999621939794450743982662393955266685255577026078256473601</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>首先测试了一下32长度的字符串，转为int类型的数据大概是256bit</strong></p>
<p><strong>1024位的p需要已知576位</strong></p>
<p><strong>512位的p需要已知288位</strong></p>
<p><strong>当满足这样一个关系的时候才可恢复：</strong></p>
<p><img src="/../../images/LitCTF/9.png"></p>
<p><strong>但是把f.small_roots(X,beta,epsilon)中的epsilon改为0.01，即最小的时候，可以在已知264位的情况下恢复512位的p，已知528位恢复1024位的p，而这道题中，我们已知256位p，所以需要爆破8位，再恢复p</strong></p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from tqdm import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">n = 139167681803392690594490403105432649693546256181767408269202101512534988406137879788255103631885736461742577594980136624933914700779445704490217419248411578290305101891222576080645870988658334799437317221565839991979543660824098367011942169305111105129234902517835649895908656770416774539906212596072334423407</span><br><span class="line">c1 = 11201139662236758800406931253538295757259990870588609533820056210585752522925690049252488581929717556881067021381940083808024384402885422258545946243513996</span><br><span class="line">c2 = 112016152270171196606652761990170033221036025260883289104273504703557624964071464062375228351458191745141525003775876044271210498526920529385038130932141551598616579917681815276713386113932345056134302042399379895915706991873687943357627747262597883603999621939794450743982662393955266685255577026078256473601</span><br><span class="line">e=65537</span><br><span class="line">pbits = 512</span><br><span class="line"></span><br><span class="line">p_high = c1 &gt;&gt; 256</span><br><span class="line">for i in trange(2**8):</span><br><span class="line">     p4 = p_high&lt;&lt;8			#这里需要先爆破8位，使得知道264位以后再恢复p</span><br><span class="line">     p4 = p4 + i</span><br><span class="line">     kbits = pbits - p4.nbits()</span><br><span class="line">     p4 = p4 &lt;&lt; kbits</span><br><span class="line">     R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">     f = x + p4</span><br><span class="line">     x = f.small_roots(X=2^kbits, beta=0.4, epsilon=0.01)</span><br><span class="line">     if x:</span><br><span class="line">         p = p4 + int(x[0])</span><br><span class="line">         q = n // p</span><br><span class="line">         d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">         m = pow(c2,d,n)</span><br><span class="line">         print(long_to_bytes(int(m)))</span><br><span class="line">         break</span><br><span class="line"></span><br><span class="line">#LitCTF&#123;oh!!!!coppersmith_is_fun&#125;</span><br></pre></td></tr></table></figure>

<p>放虚拟机跑会更快一些</p>
<p><img src="/../../images/LitCTF/8.png"></p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>NKCTF</title>
    <url>/2023/07/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NKCTF/</url>
    <content><![CDATA[<p>重新做一遍NKCTF的题（没写完，之后慢慢做）</p>
<span id="more"></span>

<h1 id="baby-RSA"><a href="#baby-RSA" class="headerlink" title="baby_RSA"></a>baby_RSA</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">nbit = 512</span><br><span class="line">flag=&#x27;****************************&#x27;</span><br><span class="line"></span><br><span class="line">p=getPrime(nbit)</span><br><span class="line">q=getPrime(nbit)</span><br><span class="line">e=65537</span><br><span class="line">n=p*q</span><br><span class="line">m= bytes_to_long(bytes(flag.encode()))</span><br><span class="line">P = pow(m,p,n)</span><br><span class="line">Q = pow(m,q,n)</span><br><span class="line">N=P*Q</span><br><span class="line">phi_N=(P-1)*(Q-1)</span><br><span class="line">d=inverse(e,phi_N)</span><br><span class="line">dP=d%(P-1)</span><br><span class="line">print(&#x27;n = &#x27;,n)</span><br><span class="line">print(&#x27;N = &#x27;,N)</span><br><span class="line">print(&#x27;dP = &#x27;,dP)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n =  114101396033690088275999670914803472451228154227614098210572767821433470213124900655723605426526569384342101959232900145334500170690603208327913698128445002527020347955300595384752458477749198178791196660625870659540794807018881780680683388008090434114437818447523471527878292741702348454486217652394664664641</span><br><span class="line">N =  1159977299277711167607914893426674454199208605107323826176606074354449015203832606569051328721360397610665453513201486235549374869954501563523028914285006850687275382822302821825953121223999268058107278346499657597050468069712686559045712946025472616754027552629008516489090871415609098178522863027127254404804829735621706042266140637592206366042515190385496909533329383212542170504864473944657824502882014292528444918055958758310544435120502872883857209880723535754528096143707324179005292445100655695427777453144657819474805882956064292780031599790769618615908501966912635232746588639924772530057835864082951499028</span><br><span class="line">dP =  33967356791272818610254738927769774016289590226681637441101504040121743937150259930712897925893431093938385216227201268238374281750681609796883676743311872905933219290266120756315613501614208779063819499785817502677885240656957036398336462000771885589364702443157120609506628895933862241269347200444629283263</span><br></pre></td></tr></table></figure>

<p><strong>dp泄露先求P,Q</strong></p>
<p>$\because P \equiv m^p \mod n \longrightarrow P \equiv m^p \mod p \longrightarrow P \equiv m \mod p \therefore P &#x3D; m+k_1p$</p>
<p>同理$Q &#x3D; m + k_2q$</p>
<p>则$PQ &#x3D; (m+k_1p)(m+k_2q) &#x3D; m^2+m(k_1p+k_2q)+k_1k_2n&#x3D;m^2 + m(P-m+Q-m)+k_1k_2n$</p>
<p>$\therefore PQ \equiv m^2+m(P-m+Q-m) \mod n$</p>
<p>CopperSmith求解</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">114101396033690088275999670914803472451228154227614098210572767821433470213124900655723605426526569384342101959232900145334500170690603208327913698128445002527020347955300595384752458477749198178791196660625870659540794807018881780680683388008090434114437818447523471527878292741702348454486217652394664664641</span></span><br><span class="line">N = <span class="number">1159977299277711167607914893426674454199208605107323826176606074354449015203832606569051328721360397610665453513201486235549374869954501563523028914285006850687275382822302821825953121223999268058107278346499657597050468069712686559045712946025472616754027552629008516489090871415609098178522863027127254404804829735621706042266140637592206366042515190385496909533329383212542170504864473944657824502882014292528444918055958758310544435120502872883857209880723535754528096143707324179005292445100655695427777453144657819474805882956064292780031599790769618615908501966912635232746588639924772530057835864082951499028</span></span><br><span class="line">dP = <span class="number">33967356791272818610254738927769774016289590226681637441101504040121743937150259930712897925893431093938385216227201268238374281750681609796883676743311872905933219290266120756315613501614208779063819499785817502677885240656957036398336462000771885589364702443157120609506628895933862241269347200444629283263</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    t = (dP * e - <span class="number">1</span>) % i        </span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">        P = (dP * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> N % P == <span class="number">0</span>:</span><br><span class="line">            P = (dP * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;P=&quot;</span>,P)</span><br><span class="line">            Q = N // P</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Q=&quot;</span>,Q)</span><br><span class="line"></span><br><span class="line">            R.&lt;m&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">            </span><br><span class="line">            f = m^<span class="number">2</span> + m * (P - m + Q - m) - P * Q</span><br><span class="line">            f = f.monic()</span><br><span class="line">            m = f.small_roots(X=<span class="number">2</span>^<span class="number">400</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">            <span class="comment">#print(m)</span></span><br><span class="line">            flag = long_to_bytes(<span class="built_in">int</span>(m[<span class="number">0</span>]))</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>另外一种解法：</p>
<p><img src="/../../images/NKCTF/0.png"></p>
<p><strong>得到kp后和n求公因数p</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">114101396033690088275999670914803472451228154227614098210572767821433470213124900655723605426526569384342101959232900145334500170690603208327913698128445002527020347955300595384752458477749198178791196660625870659540794807018881780680683388008090434114437818447523471527878292741702348454486217652394664664641</span></span><br><span class="line">N = <span class="number">1159977299277711167607914893426674454199208605107323826176606074354449015203832606569051328721360397610665453513201486235549374869954501563523028914285006850687275382822302821825953121223999268058107278346499657597050468069712686559045712946025472616754027552629008516489090871415609098178522863027127254404804829735621706042266140637592206366042515190385496909533329383212542170504864473944657824502882014292528444918055958758310544435120502872883857209880723535754528096143707324179005292445100655695427777453144657819474805882956064292780031599790769618615908501966912635232746588639924772530057835864082951499028</span></span><br><span class="line">dP = <span class="number">33967356791272818610254738927769774016289590226681637441101504040121743937150259930712897925893431093938385216227201268238374281750681609796883676743311872905933219290266120756315613501614208779063819499785817502677885240656957036398336462000771885589364702443157120609506628895933862241269347200444629283263</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    t = (dP * e - <span class="number">1</span>) % i        </span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">        P = (dP * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> N % P == <span class="number">0</span>:</span><br><span class="line">            P = (dP * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;P=&quot;</span>,P)</span><br><span class="line">            Q = N // P</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Q=&quot;</span>,Q)</span><br><span class="line"></span><br><span class="line">            x,y = P,Q</span><br><span class="line">            tmp = <span class="built_in">pow</span>(x,n,n) - y</span><br><span class="line">            p = gmpy2.gcd(tmp,n)</span><br><span class="line">            q = n // p</span><br><span class="line">            d = gmpy2.invert(p,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))			<span class="comment">#留意一下加密指数是p</span></span><br><span class="line">            m = <span class="built_in">pow</span>(x,d,n)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h1 id="ez-math"><a href="#ez-math" class="headerlink" title="ez_math"></a>ez_math</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime, bytes_to_long</span><br><span class="line">from secret import BITS, hints, flag</span><br><span class="line"></span><br><span class="line">p = getPrime(BITS)</span><br><span class="line">q = getPrime(BITS)</span><br><span class="line">n = p * q</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">c = pow(bytes_to_long(flag), e, n)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">print(&#x27;Give you some boring pows:&#x27;)</span><br><span class="line">for i in range(len(hints)):</span><br><span class="line">    print(hints[i])</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">n = 369520637995317866367336688225182965061898803879373674073832046072914710171302486913303917853881549637806426191970292829598855375370563396182543413674021955181862907847280705741114636854238746612618069619482248639049407507041667720977392421249242597197448360531895206645794505182208390084734779667749657408715621</span><br><span class="line">c = 324131338592233305486487416176106472248153652884280898177125443926549710357763331715045582842045967830200123100144721322509500306940560917086108978796500145618443920020112366546853892387011738997522207752873944151628204886591075864677988865335625452099668804529484866900390927644093597772065285222172136374562043</span><br><span class="line">Give you some boring pows:</span><br><span class="line">pow(6, 42762902032363446334121451790132830028099011269558028556333775251728898854654431095595000922138958455510196735338223430882428451914478079186797153527810555787441234842366353864053114538165236037883914332840687123514412294276743506313011532002136735343280737244020115917460801848337792582496228600926958548903290, n) = 4</span><br><span class="line">pow(6, 141997416965295486849546892322458652502850390670128808480582247784728456230996812361056958004801816363393016360646922983916999235770803618904474553309200419301820603229504955218189709387942156848904968053547462302189568831762401075340100029630332409419313772378068180267756675141584884876543484516408660699471038, n) = 9</span><br><span class="line">pow(6, 163378867981477210016607618217525067516899896304907822758749135410592905658324027908854458465871295591148114728316034699358213461728042658497873130073105697195541220650688132150216266657024774867846925219967805863946774978900772828496605795631400777090954141000078238226487076065753781167791598816872139973922682, n) = 3</span><br><span class="line">pow(5, 101651508435846472131121026992982127175369332865677196032272241712711171024515826370577416844824734811581351106736224929238579734879671732717639124571916168742336862493284572465162318403582113621582374924091725060981390318743531229548188092491836655143124663368239422819562367919547196053790207486164506763679128, n) = 4</span><br><span class="line">pow(8, 7202269322818255506843028035725052687541091567764933235328308385449791332345247877549905289072216053144576876979686287212194040101112899704499548530779540409356827298148385589812450437990490353926475147376495772639210184768544932563432306664067058309318707174880146258394471096033723193568453520897758319446472, n) = 3</span><br><span class="line">pow(6, 64144353048545169501182177685199245042148516904337042834500662877593348281981646643392501383208437683265295103007335146323642677871717118780195730291715833681161852263549530796079671807247854056825871499261030685271618441415115259469517298003205103014921105866030173876191202772506688873744342901390437823354935, n) = 8</span><br><span class="line">pow(6, 21381451016181723167060725895066415014049505634779014278166887625864449427327215547797500461069479227755098367669111715441214225957239039593398576763905277893720617421183176932026557269082618018941957166420343561757206147138371753156505766001068367671640368622010057958730400924168896291248114300463479274451645, n) = 2</span><br><span class="line">pow(4, 21606807968454766520529084107175158062623274703294799705984925156349373997035743632649715867216648159433730630939058861636582120303338699113498645592338621228070481894445156769437351313971471061779425442129487317917630554305634797690296919992201174927956121524640438775183413288101169580705360562693274958339416, n) = 9</span><br><span class="line">pow(2, 21606807968454766520529084107175158062623274703294799705984925156349373997035743632649715867216648159433730630939058861636582120303338699113498645592338621228070481894445156769437351313971471061779425442129487317917630554305634797690296919992201174927956121524640438775183413288101169580705360562693274958339417, n) = 6</span><br><span class="line">pow(4, 10803403984227383260264542053587579031311637351647399852992462578174686998517871816324857933608324079716865315469529430818291060151669349556749322796169310614035240947222578384718675656985735530889712721064743658958815277152817398845148459996100587463978060762320219387591706644050584790352680281346637479169708, n) = 3</span><br><span class="line">pow(9, 3293982057350410278459882519024200329089724149803879577174733206141551016681048848343176690789446255513117465644006032807116613436995145441651711865811812905401261777042165657533800465011922458688696664211216129846590488003282750224539553623014598025837108471148806368738631086225250952573439068109703953523338, n) = 4</span><br><span class="line">pow(2, 43213615936909533041058168214350316125246549406589599411969850312698747994071487265299431734433296318867461261878117723273164240606677398226997291184677242456140963788890313538874702627942942123558850884258974635835261108611269595380593839984402349855912243049280877550366826576202339161410721125386549916678832, n) = 9</span><br><span class="line">pow(7, 156359509651684605051402965560382969488421316701585527115005130492947292379802933549188085059602557600903593831240316597311439285149968787780538126741092612405335349622445040578126369183536683733294143156965518222696624206221060030916594302284630706642066420353822195108928341123726471513256217857861184609387726, n) = 9</span><br><span class="line">pow(7, 170559914324671769117535654836487226009685359320636182075960576764702323732727088502920021993271666209903403463612731506055433486417625242935904916789051793747298593847158174830184596554822038310041512771676833824200302666130102306284852931958549925702330464987955245647072909056824574486147965487598401928881026, n) = 3</span><br><span class="line">pow(8, 123173545998439288789112229408394321687299601293124558024610682024304903390434162304434639284627183212602142063990097609866285125123521132060847804558007316726174558714580872721495215950738261924525921590925432950469320750692763054435407707754979429841729673081392197456811651326615118306026475411557079498916218, n) = 4</span><br><span class="line">pow(2, 21606807968454766520529084107175158062623274703294799705984925156349373997035743632649715867216648159433730630939058861636582120303338699113498645592338621228070481894445156769437351313971471061779425442129487317917630554305634797690296919992201174927956121524640438775183413288101169580705360562693274958339416, n) = 3</span><br><span class="line">pow(3, 6587964114700820556919765038048400658179448299607759154349466412283102033362097696686353381578892511026234931288012065614233226873990290883303423731623625810802523554084331315067600930023844917377393328422432259693180976006565500449079107246029196051674216942297612737477262172450501905146878136219407907046676, n) = 4</span><br><span class="line">pow(7, 146900004342901005519726059203387905743111231159623333298786259340649199259667124880775175860427705602975071010583553281005991812801779033020769274211420710213704563866848310994325033574484679477677016014418321661821714582236428708141287327064859146436371562752616380650770729341741997594308364878898526065859626, n) = 4</span><br><span class="line">pow(5, 172192380036714150788905270808196199818277334366508682218739812159577144024191963252552116624193235000074634457087111471641800814071769221933018962135503876997163938949365614056098717522475180216291316295788774044033481065993544994610614082708563841846852650913646728169671510827052772868386414581035580266356334, n) = 3</span><br><span class="line">pow(8, 68789042322037899901399142739922213531190892214327212247633649397602243027562329029767224931385807659445647908974735092145336602662873465734923450809783198772444106655438821950560058413359621316189435942839212247873870560114926459781136160541556773230183543715576244986800296759341282346581691226676298068904581, n) = 6</span><br><span class="line">pow(5, 159624441075769368394142197503800917105605266793330527400563601282696932962732683048452274321445695181246055818189076528484173940458256745774766217433996778905066039826859919029954611118842967545793750205189398662362981005947945407568116603784658538931110792205205160154125544664182868277733116044735541284338342, n) = 9</span><br><span class="line">pow(8, 14404538645636511013686056071450105375082183135529866470656616770899582664690495755099810578144432106289153753959372574424388080202225799408999097061559080818713654596296771179624900875980980707852950294752991545278420369537089865126864613328134116618637414349760292516788942192067446387136907041795516638892944, n) = 9</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>$\because 7^{data_1} \equiv 3 \mod n$，$7^{data_2} \equiv 9 \mod n$，$\therefore 7^{2data_1} \equiv 9 \mod n$</p>
<p>做除法之后则有$7^{2data_1-data_2} \equiv 1 \mod n$，$\therefore 2data_1-data_2 \equiv 0 \mod phi$</p>
<p>如果$2data_1 \ne data_2$，则$2data_1-data_2 &#x3D; kphi$</p>
<p>随后把$kphi$当作$phi$解密。</p>
<p>需要注意的是，有的$data_1$和$data_2$求出来的$phi$与$e$不存在逆元</p>
<p>这里我选择的是：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pow(7, 156359509651684605051402965560382969488421316701585527115005130492947292379802933549188085059602557600903593831240316597311439285149968787780538126741092612405335349622445040578126369183536683733294143156965518222696624206221060030916594302284630706642066420353822195108928341123726471513256217857861184609387726, n) = 9</span><br><span class="line">pow(7, 170559914324671769117535654836487226009685359320636182075960576764702323732727088502920021993271666209903403463612731506055433486417625242935904916789051793747298593847158174830184596554822038310041512771676833824200302666130102306284852931958549925702330464987955245647072909056824574486147965487598401928881026, n) = 3</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">369520637995317866367336688225182965061898803879373674073832046072914710171302486913303917853881549637806426191970292829598855375370563396182543413674021955181862907847280705741114636854238746612618069619482248639049407507041667720977392421249242597197448360531895206645794505182208390084734779667749657408715621</span></span><br><span class="line">c = <span class="number">324131338592233305486487416176106472248153652884280898177125443926549710357763331715045582842045967830200123100144721322509500306940560917086108978796500145618443920020112366546853892387011738997522207752873944151628204886591075864677988865335625452099668804529484866900390927644093597772065285222172136374562043</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">data1 = <span class="number">170559914324671769117535654836487226009685359320636182075960576764702323732727088502920021993271666209903403463612731506055433486417625242935904916789051793747298593847158174830184596554822038310041512771676833824200302666130102306284852931958549925702330464987955245647072909056824574486147965487598401928881026</span></span><br><span class="line">data2 = <span class="number">156359509651684605051402965560382969488421316701585527115005130492947292379802933549188085059602557600903593831240316597311439285149968787780538126741092612405335349622445040578126369183536683733294143156965518222696624206221060030916594302284630706642066420353822195108928341123726471513256217857861184609387726</span></span><br><span class="line"></span><br><span class="line">kphi = <span class="number">2</span>*data1-data2</span><br><span class="line">d = gmpy2.invert(e,kphi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag[:len(flag)//3])</span><br><span class="line">m2 = bytes_to_long(flag[len(flag)//3:])</span><br><span class="line"></span><br><span class="line">def gen():</span><br><span class="line">    prime_list  = []</span><br><span class="line">    for i in range(4):</span><br><span class="line">        prime_list.append(getPrime(512))</span><br><span class="line">    return sorted(prime_list)</span><br><span class="line"></span><br><span class="line">prime_list = gen()</span><br><span class="line">p,q,r,t = prime_list[0],prime_list[3],prime_list[1],prime_list[2]</span><br><span class="line">e = 65537</span><br><span class="line">n = p*q*r*t</span><br><span class="line">phi = (p-1)*(q-1)*(r-1)*(t-1)</span><br><span class="line">c1 = pow(m1,e,p*q)</span><br><span class="line">p1 = getPrime(512)</span><br><span class="line">q1 = getPrime(512)</span><br><span class="line">N = p1*q1</span><br><span class="line">c2 = pow(m2,p1,N)</span><br><span class="line">c3 = pow(m2,q1,N)</span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;phi = &#123;phi&#125;&#x27;)</span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line">print(f&#x27;N = &#123;N&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c2&#125;&#x27;)</span><br><span class="line">print(f&#x27;c3 = &#123;c3&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n = 8836130216343708623415307573630337110573363595188748983290313549413242332143945452914800845282478216810685733227137911630239808895196748125078747600505626165666334675100147790578546682128517668100858766784733351894480181877144793496927464058323582165412552970999921215333509253052644024478417393146000490808639363681195799826541558906527985336104761974023394438549055804234997654701266967731137282297623426318212701157416397999108259257077847307874122736921265599854976855949680133804464839768470200425669609996841568545945133611190979810786943246285103031363790663362165522662820344917056587244701635831061853354597</span><br><span class="line">phi = 8836130216343708623415307573630337110573363595188748983290313549413242332143945452914800845282478216810685733227137911630239808895196748125078747600505622503351461565956106005118029537938273153581675065762015952483687057805462728186901563990429998916382820576211887477098611684072561849314986341226981300596338314989867731725668312057134075244816223120038573374383949718714549930261073576391501671722900294331289082826058292599838631513746370889828026039555245672195833927609280773258978856664434349221972568651378808050580665443131001632395175205804045958846124475183825589672204752895252723130454951830966138888560</span><br><span class="line">c1 = 78327207863361017953496121356221173288422862370301396867341957979087627011991738176024643637029313969241151622985226595093079857523487726626882109114134910056673489916408854152274726721451884257677533593174371742411008169082367666168983943358876017521749198218529804830864940274185360506199116451280975188409</span><br><span class="line">N = 157202814866563156513184271957553223260772141845129283711146204376449001653397810781717934720804041916333174673656579086498762693983380365527400604554663873045166444369504886603233275868192688995284322277504050322927511160583280269073338415758019142878016084536129741435221345599028001581385308324407324725353</span><br><span class="line">c2 = 63355788175487221030596314921407476078592001060627033831694843409637965350474955727383434406640075122932939559532216639739294413008164038257338675094324172634789610307227365830016457714456293397466445820352804725466971828172010276387616894829328491068298742711984800900411277550023220538443014162710037992032</span><br><span class="line">c3 = 9266334096866207047544089419994475379619964393206968260875878305040712629590906330073542575719856965053269812924808810766674072615270535207284077081944428011398767330973702305174973148018082513467080087706443512285098600431136743009829009567065760786940706627087366702015319792328141978938111501345426931078</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><p>已知$phi$和$n$分解n得到$p,q,r,t$</p>
<h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>和baby_RSA一样的操作</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime</span><br><span class="line"><span class="comment"># from sage.all import is_prime</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method only works for a modulus consisting of 2 primes!</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors, or None if the factors were not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s = N + <span class="number">1</span> - phi</span><br><span class="line">    d = s ** <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">    p = <span class="built_in">int</span>(s - isqrt(d)) // <span class="number">2</span></span><br><span class="line">    q = <span class="built_in">int</span>(s + isqrt(d)) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize_multi_prime</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span></span><br><span class="line"><span class="string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prime_factors = <span class="built_in">set</span>()</span><br><span class="line">    factors = [N]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(factors) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Element to factorize.</span></span><br><span class="line">        N = factors[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        w = randrange(<span class="number">2</span>, N - <span class="number">1</span>)</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> phi % (<span class="number">2</span> ** i) == <span class="number">0</span>:</span><br><span class="line">            sqrt_1 = <span class="built_in">pow</span>(w, phi // (<span class="number">2</span> ** i), N)</span><br><span class="line">            <span class="keyword">if</span> sqrt_1 &gt; <span class="number">1</span> <span class="keyword">and</span> sqrt_1 != N - <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We can remove the element to factorize now, because we have a factorization.</span></span><br><span class="line">                factors = factors[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                p = gcd(N, sqrt_1 + <span class="number">1</span>)</span><br><span class="line">                q = N // p</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(p):</span><br><span class="line">                    prime_factors.add(p)</span><br><span class="line">                <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(p)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(q):</span><br><span class="line">                    prime_factors.add(q)</span><br><span class="line">                <span class="keyword">elif</span> q &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(q)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Continue in the outer loop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(prime_factors)</span><br><span class="line">    </span><br><span class="line">n = <span class="number">8836130216343708623415307573630337110573363595188748983290313549413242332143945452914800845282478216810685733227137911630239808895196748125078747600505626165666334675100147790578546682128517668100858766784733351894480181877144793496927464058323582165412552970999921215333509253052644024478417393146000490808639363681195799826541558906527985336104761974023394438549055804234997654701266967731137282297623426318212701157416397999108259257077847307874122736921265599854976855949680133804464839768470200425669609996841568545945133611190979810786943246285103031363790663362165522662820344917056587244701635831061853354597</span></span><br><span class="line">phi = <span class="number">8836130216343708623415307573630337110573363595188748983290313549413242332143945452914800845282478216810685733227137911630239808895196748125078747600505622503351461565956106005118029537938273153581675065762015952483687057805462728186901563990429998916382820576211887477098611684072561849314986341226981300596338314989867731725668312057134075244816223120038573374383949718714549930261073576391501671722900294331289082826058292599838631513746370889828026039555245672195833927609280773258978856664434349221972568651378808050580665443131001632395175205804045958846124475183825589672204752895252723130454951830966138888560</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">78327207863361017953496121356221173288422862370301396867341957979087627011991738176024643637029313969241151622985226595093079857523487726626882109114134910056673489916408854152274726721451884257677533593174371742411008169082367666168983943358876017521749198218529804830864940274185360506199116451280975188409</span></span><br><span class="line">N = <span class="number">157202814866563156513184271957553223260772141845129283711146204376449001653397810781717934720804041916333174673656579086498762693983380365527400604554663873045166444369504886603233275868192688995284322277504050322927511160583280269073338415758019142878016084536129741435221345599028001581385308324407324725353</span></span><br><span class="line">c2 = <span class="number">63355788175487221030596314921407476078592001060627033831694843409637965350474955727383434406640075122932939559532216639739294413008164038257338675094324172634789610307227365830016457714456293397466445820352804725466971828172010276387616894829328491068298742711984800900411277550023220538443014162710037992032</span></span><br><span class="line">c3 = <span class="number">9266334096866207047544089419994475379619964393206968260875878305040712629590906330073542575719856965053269812924808810766674072615270535207284077081944428011398767330973702305174973148018082513467080087706443512285098600431136743009829009567065760786940706627087366702015319792328141978938111501345426931078</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">prime_list = <span class="built_in">sorted</span>(factorize_multi_prime(n,phi))</span><br><span class="line">p,q,r,s = prime_list[<span class="number">0</span>],prime_list[<span class="number">3</span>],prime_list[<span class="number">1</span>],prime_list[<span class="number">2</span>]</span><br><span class="line">d1 = gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c1,d1,p*q)</span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(flag1)</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line"></span><br><span class="line">f = x^<span class="number">2</span> + x * (c2 - x + c3 - x) - c2 * c3</span><br><span class="line">f = f.monic()</span><br><span class="line">x = f.small_roots(X=<span class="number">2</span>^(length*<span class="number">2</span>*<span class="number">8</span>))</span><br><span class="line"><span class="comment">#print(x)</span></span><br><span class="line"></span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(x[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">print</span>(flag1+flag2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime</span><br><span class="line"><span class="comment"># from sage.all import is_prime</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method only works for a modulus consisting of 2 primes!</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors, or None if the factors were not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s = N + <span class="number">1</span> - phi</span><br><span class="line">    d = s ** <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">    p = <span class="built_in">int</span>(s - isqrt(d)) // <span class="number">2</span></span><br><span class="line">    q = <span class="built_in">int</span>(s + isqrt(d)) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize_multi_prime</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span></span><br><span class="line"><span class="string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prime_factors = <span class="built_in">set</span>()</span><br><span class="line">    factors = [N]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(factors) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Element to factorize.</span></span><br><span class="line">        N = factors[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        w = randrange(<span class="number">2</span>, N - <span class="number">1</span>)</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> phi % (<span class="number">2</span> ** i) == <span class="number">0</span>:</span><br><span class="line">            sqrt_1 = <span class="built_in">pow</span>(w, phi // (<span class="number">2</span> ** i), N)</span><br><span class="line">            <span class="keyword">if</span> sqrt_1 &gt; <span class="number">1</span> <span class="keyword">and</span> sqrt_1 != N - <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We can remove the element to factorize now, because we have a factorization.</span></span><br><span class="line">                factors = factors[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                p = gcd(N, sqrt_1 + <span class="number">1</span>)</span><br><span class="line">                q = N // p</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(p):</span><br><span class="line">                    prime_factors.add(p)</span><br><span class="line">                <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(p)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(q):</span><br><span class="line">                    prime_factors.add(q)</span><br><span class="line">                <span class="keyword">elif</span> q &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(q)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Continue in the outer loop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">tuple</span>(prime_factors)</span><br><span class="line"></span><br><span class="line">n = <span class="number">8836130216343708623415307573630337110573363595188748983290313549413242332143945452914800845282478216810685733227137911630239808895196748125078747600505626165666334675100147790578546682128517668100858766784733351894480181877144793496927464058323582165412552970999921215333509253052644024478417393146000490808639363681195799826541558906527985336104761974023394438549055804234997654701266967731137282297623426318212701157416397999108259257077847307874122736921265599854976855949680133804464839768470200425669609996841568545945133611190979810786943246285103031363790663362165522662820344917056587244701635831061853354597</span></span><br><span class="line">phi = <span class="number">8836130216343708623415307573630337110573363595188748983290313549413242332143945452914800845282478216810685733227137911630239808895196748125078747600505622503351461565956106005118029537938273153581675065762015952483687057805462728186901563990429998916382820576211887477098611684072561849314986341226981300596338314989867731725668312057134075244816223120038573374383949718714549930261073576391501671722900294331289082826058292599838631513746370889828026039555245672195833927609280773258978856664434349221972568651378808050580665443131001632395175205804045958846124475183825589672204752895252723130454951830966138888560</span></span><br><span class="line">c1 = <span class="number">78327207863361017953496121356221173288422862370301396867341957979087627011991738176024643637029313969241151622985226595093079857523487726626882109114134910056673489916408854152274726721451884257677533593174371742411008169082367666168983943358876017521749198218529804830864940274185360506199116451280975188409</span></span><br><span class="line">N = <span class="number">157202814866563156513184271957553223260772141845129283711146204376449001653397810781717934720804041916333174673656579086498762693983380365527400604554663873045166444369504886603233275868192688995284322277504050322927511160583280269073338415758019142878016084536129741435221345599028001581385308324407324725353</span></span><br><span class="line">c2 = <span class="number">63355788175487221030596314921407476078592001060627033831694843409637965350474955727383434406640075122932939559532216639739294413008164038257338675094324172634789610307227365830016457714456293397466445820352804725466971828172010276387616894829328491068298742711984800900411277550023220538443014162710037992032</span></span><br><span class="line">c3 = <span class="number">9266334096866207047544089419994475379619964393206968260875878305040712629590906330073542575719856965053269812924808810766674072615270535207284077081944428011398767330973702305174973148018082513467080087706443512285098600431136743009829009567065760786940706627087366702015319792328141978938111501345426931078</span></span><br><span class="line"></span><br><span class="line">prime_list = <span class="built_in">sorted</span>(factorize_multi_prime(n,phi))</span><br><span class="line">p,q,r,s = prime_list[<span class="number">0</span>],prime_list[<span class="number">3</span>],prime_list[<span class="number">1</span>],prime_list[<span class="number">2</span>]</span><br><span class="line">d1 = gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,p*q)</span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">int</span>(m1))</span><br><span class="line"></span><br><span class="line">tmp = <span class="built_in">pow</span>(c2,N,N)-c3</span><br><span class="line">p1 = gcd(tmp,N)</span><br><span class="line">q1 = N // p1</span><br><span class="line">d2 = gmpy2.invert(p1,(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>))		<span class="comment">#留意加密指数是p</span></span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,N)</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(m2))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag1+flag2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<h1 id="real-MT"><a href="#real-MT" class="headerlink" title="real_MT"></a>real_MT</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_1</span>():</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">208</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">96</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess after number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_2</span>():</span><br><span class="line">    number = <span class="built_in">str</span>(random.getrandbits(<span class="number">96</span>))</span><br><span class="line">    randoms = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">627</span>):</span><br><span class="line">        randoms.append(random.getrandbits(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;randoms = &quot;</span>+<span class="built_in">str</span>(randoms))</span><br><span class="line">    guess = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess pre number:&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_3</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int32</span>(<span class="params">x</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(<span class="number">0xFFFFFFFF</span> &amp; x)  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">init</span>(<span class="params">seed</span>):</span><br><span class="line">        mt = [<span class="number">0</span>] * <span class="number">624</span></span><br><span class="line">        mt[<span class="number">0</span>] = seed</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">624</span>):</span><br><span class="line">            mt[i] = _int32(<span class="number">1812433253</span> * (mt[i - <span class="number">1</span>] ^ mt[i - <span class="number">1</span>] &gt;&gt; <span class="number">30</span>) + i)</span><br><span class="line">        <span class="keyword">return</span> mt[-<span class="number">1</span>]</span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;last number = &quot;</span>+ <span class="built_in">str</span>(init(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess seed number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_number_4</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_number</span>(<span class="params">y</span>):</span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">11</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">7</span> &amp; <span class="number">2636928640</span></span><br><span class="line">        y = y ^ y &lt;&lt; <span class="number">15</span> &amp; <span class="number">4022730752</span></span><br><span class="line">        y = y ^ y &gt;&gt; <span class="number">18</span></span><br><span class="line">        <span class="keyword">return</span> y&amp;<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    number = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;extract number = &quot;</span>+ <span class="built_in">str</span>(extract_number(number)))</span><br><span class="line">    guess = <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;Guess be extracted number:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> guess != number:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Wrong Number! Guess again.&quot;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to the Mersenne Twister basic challenge. Please try to solve 20 challenges in 60 seconds.&quot;</span>)</span><br><span class="line">signal.alarm(<span class="number">60</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Round: &quot;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>))</span><br><span class="line">    random.choice([guess_number_1,guess_number_2,guess_number_3,guess_number_4])()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Good job!&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>).read()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Congratulations on passing the challenge. This is your flag: &quot;</span> + <span class="built_in">str</span>(flag))</span><br></pre></td></tr></table></figure>



<h1 id="fake-MT"><a href="#fake-MT" class="headerlink" title="fake_MT"></a>fake_MT</h1><h1 id="ez-polynomial"><a href="#ez-polynomial" class="headerlink" title="ez_polynomial"></a>ez_polynomial</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#sage</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">flag = list(bytearray(&#x27;&#x27;))</span><br><span class="line">p = getPrime(16)</span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(p))</span><br><span class="line">while True:</span><br><span class="line">    P1 = R.random_element(degree=(ZZ.random_element(len(flag), 2*len(flag))))</span><br><span class="line">    Q1 = R.random_element(degree=(ZZ.random_element(len(flag), 2*len(flag))))</span><br><span class="line">    if P1.is_irreducible() and Q1.is_irreducible():</span><br><span class="line">        P = P1</span><br><span class="line">        Q = Q1</span><br><span class="line">        break</span><br><span class="line">e = 65537</span><br><span class="line">N = P*Q</span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line">c = S(flag) ^ e</span><br><span class="line">print(&quot;P:&quot; + str(p) + &quot;\n&quot;)</span><br><span class="line">print(&quot;N:&quot; + str(N) + &quot;\n&quot;)</span><br><span class="line">print(&quot;C:&quot; + str(c))</span><br><span class="line"></span><br><span class="line">#P:40031</span><br><span class="line">#N:24096*y^93 + 38785*y^92 + 17489*y^91 + 9067*y^90 + 1034*y^89 + 6534*y^88 + 35818*y^87 + 22046*y^86 + 12887*y^85 + 445*y^84 + 26322*y^83 + 37045*y^82 + 4486*y^81 + 3503*y^80 + 1184*y^79 + 38471*y^78 + 8012*y^77 + 36561*y^76 + 19429*y^75 + 35227*y^74 + 10813*y^73 + 26341*y^72 + 29474*y^71 + 2059*y^70 + 16068*y^69 + 31597*y^68 + 14685*y^67 + 9266*y^66 + 31019*y^65 + 6171*y^64 + 385*y^63 + 28986*y^62 + 9912*y^61 + 10632*y^60 + 33741*y^59 + 12634*y^58 + 21179*y^57 + 35548*y^56 + 17894*y^55 + 7152*y^54 + 9440*y^53 + 4004*y^52 + 2600*y^51 + 12281*y^50 + 22*y^49 + 17314*y^48 + 32694*y^47 + 7693*y^46 + 6567*y^45 + 19897*y^44 + 27329*y^43 + 8799*y^42 + 36348*y^41 + 33963*y^40 + 23730*y^39 + 27685*y^38 + 29037*y^37 + 14622*y^36 + 29608*y^35 + 39588*y^34 + 23294*y^33 + 757*y^32 + 20140*y^31 + 19511*y^30 + 1469*y^29 + 3898*y^28 + 6630*y^27 + 19610*y^26 + 11631*y^25 + 7188*y^24 + 11683*y^23 + 35611*y^22 + 37286*y^21 + 32139*y^20 + 20296*y^19 + 36426*y^18 + 25340*y^17 + 36204*y^16 + 37787*y^15 + 31256*y^14 + 505*y^13 + 27508*y^12 + 20885*y^11 + 32037*y^10 + 31236*y^9 + 7929*y^8 + 27195*y^7 + 28980*y^6 + 11863*y^5 + 16025*y^4 + 16389*y^3 + 570*y^2 + 36547*y + 10451</span><br><span class="line">#C:3552*x^92 + 6082*x^91 + 25295*x^90 + 35988*x^89 + 26052*x^88 + 16987*x^87 + 12854*x^86 + 25117*x^85 + 25800*x^84 + 30297*x^83 + 5589*x^82 + 23233*x^81 + 14449*x^80 + 4712*x^79 + 35719*x^78 + 1696*x^77 + 35653*x^76 + 13995*x^75 + 13715*x^74 + 4578*x^73 + 37366*x^72 + 25260*x^71 + 28865*x^70 + 36120*x^69 + 7047*x^68 + 10497*x^67 + 19160*x^66 + 17939*x^65 + 14850*x^64 + 6705*x^63 + 17805*x^62 + 30083*x^61 + 2400*x^60 + 10685*x^59 + 15272*x^58 + 2225*x^57 + 13194*x^56 + 14251*x^55 + 31016*x^54 + 10189*x^53 + 35040*x^52 + 7042*x^51 + 29206*x^50 + 39363*x^49 + 32608*x^48 + 38614*x^47 + 5528*x^46 + 20119*x^45 + 13439*x^44 + 25468*x^43 + 30056*x^42 + 19720*x^41 + 21808*x^40 + 3712*x^39 + 25243*x^38 + 10606*x^37 + 16247*x^36 + 36106*x^35 + 17287*x^34 + 36276*x^33 + 1407*x^32 + 28839*x^31 + 8459*x^30 + 38863*x^29 + 435*x^28 + 913*x^27 + 36619*x^26 + 15572*x^25 + 9363*x^24 + 36837*x^23 + 17925*x^22 + 38567*x^21 + 38709*x^20 + 13582*x^19 + 35038*x^18 + 31121*x^17 + 8933*x^16 + 1666*x^15 + 21940*x^14 + 25585*x^13 + 840*x^12 + 21938*x^11 + 20143*x^10 + 28507*x^9 + 5947*x^8 + 20289*x^7 + 32196*x^6 + 924*x^5 + 370*x^4 + 14849*x^3 + 10780*x^2 + 14035*x + 15327</span><br></pre></td></tr></table></figure>



<h1 id="eZ-Bl⊕ck"><a href="#eZ-Bl⊕ck" class="headerlink" title="eZ_Bl⊕ck"></a>eZ_Bl⊕ck</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">s, k</span>):</span><br><span class="line">    l, r = s[:<span class="number">16</span>], s[<span class="number">16</span>:]</span><br><span class="line">    l_, r_ = xor(xor(r, k), l), l</span><br><span class="line">    <span class="keyword">return</span> l_ + r_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">s, k</span>):</span><br><span class="line">    t = s</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        t = <span class="built_in">round</span>(t, k[i])</span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = os.urandom(<span class="number">32</span>)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line">key = [os.urandom(<span class="number">16</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encode(r, key))</span><br><span class="line">m = flag.strip(<span class="string">b&#x27;NKCTF&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>).replace(<span class="string">b&#x27;-&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(encode(m, key))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&quot;t\xf7\xaa\xac\x9d\x88\xa4\x8b\x1f+pA\x84\xacHg&#x27;\x07&#123;\xcc\x06\xc4i\xdd)\xda\xc9\xad\xa9\xe8\x1fi&quot;</span></span><br><span class="line"><span class="comment"># b&quot;&#x27;&#123;&lt;z&#125;\x91\xda\xc5\xd5S\x8b\xfa\x9f~]J\x0f\xf4\x9a\x1e\xe0\xef\x129N\xe7a\x928+\xe0\xee&quot;</span></span><br><span class="line"><span class="comment"># b&#x27;8\x1f&quot;\x83B4\x86)\xce\xebq3\x06\xa0w\x16U\x04M/w\xa1\x8f;)M\xdd~\x11:\xe3\xb3&#x27;</span></span><br></pre></td></tr></table></figure>

<p>手动推导了一下</p>
<p>前一半：$iv[:16]$，后一半：$iv[16:]$</p>
<p>round1</p>
<p>前一半：$iv[16:]\otimes key1 \otimes iv[:16]$，后一半：$iv[:16]$</p>
<p>round2</p>
<p>前一半：$key1 \otimes key2 \otimes iv[:16]$，后一半：$iv[16:]\otimes key1 \otimes iv[:16]$</p>
<p>round3</p>
<p>前一半：$iv[:16]  \otimes key3 \otimes key2 $，后一半： $key1 \otimes key2 \otimes iv[16:]$ </p>
<p>round4</p>
<p>前一半：$key1 \otimes iv[16:] \otimes iv[:16] \otimes key3 \otimes key4$，后一半：$iv[:16]  \otimes key3 \otimes key2 $</p>
<p>round5</p>
<p>前一半：$key1 \otimes iv[16:] \otimes key2 \otimes key4 \otimes key5$，后一半：$key1 \otimes iv[16:] \otimes iv[:16] \otimes key3 \otimes key4$</p>
<p>round6</p>
<p>前一半：$iv[:16] \otimes key2 \otimes key3 \otimes key5\otimes key6$，后一半：$key1 \otimes  key2 \otimes key4 \otimes key5 \otimes iv[:16]$</p>
<p>round7</p>
<p>前一半：$iv[16:] \otimes iv[:16] \otimes key1 \otimes key3 \otimes key4 \otimes key6 \otimes  key7$，后一半：$iv[:16] \otimes key2 \otimes key3 \otimes key5\otimes key6$</p>
<p>round8</p>
<p>前一半：$key1 \otimes key2 \otimes key4 \otimes key5 \otimes key7 \otimes key8 \otimes iv[16:]$，后一半$iv[16:] \otimes iv[:16] \otimes key1 \otimes key3 \otimes key4 \otimes key6 \otimes  key7$</p>
<p><strong>把r或者m加密后在格式上有相同点。</strong></p>
<p>设$flag$和$r$分为两部分$flag1,flag2,r1,r2$</p>
<p>我们把两个密文的前半部分进行异或能得到$flag2\otimes r2$，已知$r2$，可以恢复$flag2$</p>
<p>把密文的后半部分进行异或能得到$flag1 \otimes r1 \otimes flag2 \otimes r2$，上面已经恢复了$flag2$，所以我们也能恢复$flag1$</p>
<p>最后把$flag$拼接再改为uuid形式</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">r = <span class="string">b&quot;t\xf7\xaa\xac\x9d\x88\xa4\x8b\x1f+pA\x84\xacHg&#x27;\x07&#123;\xcc\x06\xc4i\xdd)\xda\xc9\xad\xa9\xe8\x1fi&quot;</span></span><br><span class="line">cr = <span class="string">b&quot;&#x27;&#123;&lt;z&#125;\x91\xda\xc5\xd5S\x8b\xfa\x9f~]J\x0f\xf4\x9a\x1e\xe0\xef\x129N\xe7a\x928+\xe0\xee&quot;</span></span><br><span class="line">cm = <span class="string">b&#x27;8\x1f&quot;\x83B4\x86)\xce\xebq3\x06\xa0w\x16U\x04M/w\xa1\x8f;)M\xdd~\x11:\xe3\xb3&#x27;</span></span><br><span class="line"></span><br><span class="line">r1 = r[:<span class="number">16</span>]</span><br><span class="line">r2 = r[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line">flag2 = strxor(strxor(cr[:<span class="number">16</span>],cm[:<span class="number">16</span>]),r2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br><span class="line"></span><br><span class="line">flag1 = strxor(strxor(strxor(strxor(cr[<span class="number">16</span>:],cm[<span class="number">16</span>:]),r1),r2),flag2)</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"></span><br><span class="line">flag = flag1+flag2					<span class="comment">#得到的flag是byte型</span></span><br><span class="line"><span class="built_in">print</span>(uuid.UUID(flag.decode()))		<span class="comment">#把byte转str再转uuid</span></span><br></pre></td></tr></table></figure>

<h1 id="eazy-high"><a href="#eazy-high" class="headerlink" title="eazy_high"></a>eazy_high</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p * q</span><br><span class="line">p0 = p ^ (bytes_to_long(flag)&lt;&lt;<span class="number">444</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N=&#x27;</span>,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p0=&#x27;</span>,p0)</span><br><span class="line"></span><br><span class="line"><span class="comment">#c= 4881545863615247924697512170011400857004555681758106351259776881249360423774694437921554056529064037535796844084045263140567168171628832384672612945806728465127954937293787045302307135365408938448006548465000663247116917564500525499976139556325841597810084111303039525833367199565266613007333465332710833102978756654324956219855687611590278570749890543277201538208370370097424105751568285050703167350889953331829275262932104042040526209179357770495596739361176548337593674366015027648541293309465113202672923556991818236011769228078267484362980348613669012975963468592763463397575879215173972436831753615524193609612</span></span><br><span class="line"><span class="comment">#N= 17192509201635459965397076685948071839556595198733884616568925970608227408244870123644193452116734188924766414178232653941867668088060274364830452998991993756231372252367134508712447410029668020439498980619263308413952840568602285764163331028384281840387206878673090608323292785024372223569438874557728414737773416206032540038861064700108597448191546413236875600906013508022023794395360001242071569785940215873854748631691555516626235191098174739613181230094797844414203694879874212340812119576042962565179579136753839946922829803044355134086779223242080575811804564731938746051591474236147749401914216734714709281349</span></span><br><span class="line"><span class="comment">#p0= 149263925308155304734002881595820602641174737629551638146384199378753884153459661375931646716325020758837194837271581361322079811468970876532640273110966545339040194118880506352109559900553776706613338890047890747811129988585025948270181264314668772556874718178868209009192010129918138140332707080927643141811</span></span><br></pre></td></tr></table></figure>

<p>$p &#x3D; 1024bit$，$m$经过左移$444$位之后，$m$的低$444$位全是0，猜测$flag$的长度为$40$字节，则$m$经过左移后的大小为$764bit$左右。</p>
<p>所以$p$的高$260$位是不受异或影响的，则$p$的$260$位就是$p0$的高$260$位，我们有了$p$的高$260$位和低$444$位，可以用coppersmith恢复p</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c= <span class="number">4881545863615247924697512170011400857004555681758106351259776881249360423774694437921554056529064037535796844084045263140567168171628832384672612945806728465127954937293787045302307135365408938448006548465000663247116917564500525499976139556325841597810084111303039525833367199565266613007333465332710833102978756654324956219855687611590278570749890543277201538208370370097424105751568285050703167350889953331829275262932104042040526209179357770495596739361176548337593674366015027648541293309465113202672923556991818236011769228078267484362980348613669012975963468592763463397575879215173972436831753615524193609612</span></span><br><span class="line">N= <span class="number">17192509201635459965397076685948071839556595198733884616568925970608227408244870123644193452116734188924766414178232653941867668088060274364830452998991993756231372252367134508712447410029668020439498980619263308413952840568602285764163331028384281840387206878673090608323292785024372223569438874557728414737773416206032540038861064700108597448191546413236875600906013508022023794395360001242071569785940215873854748631691555516626235191098174739613181230094797844414203694879874212340812119576042962565179579136753839946922829803044355134086779223242080575811804564731938746051591474236147749401914216734714709281349</span></span><br><span class="line">p0= <span class="number">149263925308155304734002881595820602641174737629551638146384199378753884153459661375931646716325020758837194837271581361322079811468970876532640273110966545339040194118880506352109559900553776706613338890047890747811129988585025948270181264314668772556874718178868209009192010129918138140332707080927643141811</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">phigh = p0 &gt;&gt; <span class="number">764</span> &lt;&lt; <span class="number">764</span></span><br><span class="line">plow = p0 % <span class="number">2</span>**<span class="number">445</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line"></span><br><span class="line">f = phigh + x*<span class="number">2</span>**<span class="number">444</span> + plow</span><br><span class="line">f = f.monic()</span><br><span class="line">x = f.small_roots(X=<span class="number">2</span>^<span class="number">320</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> x:</span><br><span class="line">    <span class="built_in">print</span>(x)</span><br><span class="line">    p = phigh + <span class="built_in">int</span>(x[<span class="number">0</span>])*<span class="number">2</span>**<span class="number">444</span> + plow</span><br><span class="line">    q = N // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<h1 id="eZ-LargeCG"><a href="#eZ-LargeCG" class="headerlink" title="eZ_LargeCG"></a>eZ_LargeCG</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from gmpy2 import next_prime</span><br><span class="line">from Crypto.Util.number import getPrime, isPrime, bytes_to_long</span><br><span class="line">import random</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">def init():</span><br><span class="line">    primes = []</span><br><span class="line">    p = 1</span><br><span class="line">    while len(primes) &lt; 100:</span><br><span class="line">        p = next_prime(p)</span><br><span class="line">        primes.append(int(p))</span><br><span class="line">    return primes</span><br><span class="line"></span><br><span class="line">def genMyPrimeA(bits):</span><br><span class="line">    while True:</span><br><span class="line">        g = 2</span><br><span class="line">        while g &lt; 2 ** bits:</span><br><span class="line">            g *= random.choice(primes)</span><br><span class="line">        g += 1</span><br><span class="line">        if isPrime(g):</span><br><span class="line">            return g</span><br><span class="line"></span><br><span class="line">def genMyPrimeB(bits):</span><br><span class="line">    while True:</span><br><span class="line">        g = 2</span><br><span class="line">        while g &lt; 2 ** bits:</span><br><span class="line">            g *= random.choice(primes)</span><br><span class="line">        g -= 1</span><br><span class="line">        if isPrime(g):</span><br><span class="line">            return g</span><br><span class="line"></span><br><span class="line">def gen(st, n, a, b, c, d):</span><br><span class="line">    A = [st + 2023, st + 2024, st + 2025]</span><br><span class="line">    for i in range(6**666):</span><br><span class="line">        A.append((a * A[-3] + b * A[-2] + c * A[-1] + d) % n)</span><br><span class="line">    return A</span><br><span class="line"></span><br><span class="line">primes = init()</span><br><span class="line">p1 = getPrime(256)</span><br><span class="line">print(p1)</span><br><span class="line">q1 = 1</span><br><span class="line">while p1 &gt; q1:</span><br><span class="line">    q1 = genMyPrimeA(256)</span><br><span class="line">print(q1)</span><br><span class="line">p2 = getPrime(256)</span><br><span class="line">q2 = 1</span><br><span class="line">while p2 &gt; q2:</span><br><span class="line">    q2 = genMyPrimeB(256)</span><br><span class="line">n1 = p1 * q1</span><br><span class="line">n2 = p2 * q2</span><br><span class="line">print(f&#x27;n1 = &#123;n1&#125;&#x27;)</span><br><span class="line">print(f&#x27;n2 = &#123;n2&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">r = getPrime(512)</span><br><span class="line">print(f&#x27;r = &#123;r&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">A = gen(bytes_to_long(flag), r, p1, q1, p2, q2)</span><br><span class="line">print(f&#x27;A[-3] = &#123;A[-3]&#125;&#x27;)</span><br><span class="line">print(f&#x27;A[-2] = &#123;A[-2]&#125;&#x27;)</span><br><span class="line">print(f&#x27;A[-1] = &#123;A[-1]&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># n1 = 39755206609675677517559022219519767646524455449142889144073217274247893104711318356648198334858966762944109142752432641040037415587397244438634301062818169</span><br><span class="line"># n2 = 30725253491966558227957591684441310073288683324213439179377278006583428660031769862224980605664642101191616868994066039054762100886678504154619135365646221</span><br><span class="line"># r = 7948275435515074902473978567170931671982245044864706132834233483354166398627204583162848756424199888842910697874390403881343013872330344844971750121043493</span><br><span class="line"># A[-3] = 6085327340671394838391386566774092636784105046872311226269065664501131836034666722102264842236327898770287752026397099940098916322051606027565395747098434</span><br><span class="line"># A[-2] = 1385551782355619987198268805270109182589006873371541520953112424858566073422289235930944613836387546298080386848159955053303343649615385527645536504580787</span><br><span class="line"># A[-1] = 2529291156468264643335767070801583140819639532551726975314270127875306069067016825677707064451364791677536138503947465612206191051563106705150921639560469</span><br></pre></td></tr></table></figure>



<h1 id="complex-matrix"><a href="#complex-matrix" class="headerlink" title="complex_matrix"></a>complex_matrix</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2 as gy</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">k = 400</span><br><span class="line">p, q = getPrime(741), getPrime(741)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-1) * (q-1)</span><br><span class="line">_flag = bytes_to_long(flag)</span><br><span class="line">p, q = getPrime(1024), getPrime(1024)</span><br><span class="line">d_array = [getPrime(k) for _ in range(4)] </span><br><span class="line">e_array = [inverse(i, phi) for i in d_array]</span><br><span class="line">c = pow(_flag, 65537, N)</span><br><span class="line">print(&#x27;N:&#x27;,N)</span><br><span class="line">print(&#x27;e:&#x27;,e_array)</span><br><span class="line">print(&#x27;c:&#x27;,c)</span><br><span class="line"></span><br><span class="line">#N: 71841248095369087024928175623295380241516644434969868335504061065977014103487197287619667598363486210886674500469383623511906399909335989202774281795855975972913438448899231650449810696539722877903606541112937729384851506921675290984316325565141178015123381439392534417225128922398194700511937668809140024838070124095703585627058463137549632965723304713166804084673075651182998654091113119667582720831809458721072371364839503563819080226784026253</span><br><span class="line">#e: [65128799196671634905309494529154568614228788035735808211836905142007976099865571126946706559109393187772126407982007858423859147772762638898854472065889939549916077695303157760259717113616428849798058080633047516455513870697383339784816006154279428812359241282979297285283850338964993773227397528608557211742425548651971558377656644211835094019462699301650412862894391885325969143805924684662849869947172175608502179438901337558870349697233790535, 58756559706647121529575085912021603170286163639572075337348109911506627489265537716060463072086480156516641723700802217411122982693536541892986623158818442274840863016647800896033363360822503445344748132842451806511693779600370832206455202293028402486647422212959763287987847280322100701242139127654031151565924132562837893975505159702015125483479126108892709063135006366792197127007229210558758401679638300464111782814561428899998471531067163715, 34828685390969672139784723764579499920301439564705391196519314224159563070870933754477650614819514127121146216049444888554338415587165719098661141454627820126445291802801256297252654045398330613075575527685542980264993711077876535643646746742646371967302159565887123638001580042027272379341650995728849759541960087953160211696369079708787543303742132161742979856720539914370868829868891655221361545648778590685232034703220732697083024449894197969, 26717968456600556973167180286909817773394160817933525240720067057464671317174201540556176814203780603153696663101158205367554829261808020426363683474848952397963507069306452835776851274959389849223566030857588019845781623271395012194869024566879791449466064832273531795430185178486425688475688634844530106740480643866537205900809400383304665727460014210405339697947582657505028211149470787536144302545259243549176816653560626044921521516818788487]</span><br><span class="line">#c: 39297018404565022956251803918747154798377576057123078716166221329195959669756819453426741569480551313085435037629493881038383709458043802420338889323233368852331387845200216275712388921820794980987541224782392553528127093154957890356084331463340193478391679540506421250562554424770350351514435220782124981277580072039637811543914983033300225131364246910828188727043248991987332274929827173923543187017105236008487756190002204169623313222748976369</span><br></pre></td></tr></table></figure>



<h1 id="baby-classical"><a href="#baby-classical" class="headerlink" title="baby_classical"></a>baby_classical</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line">import re</span><br><span class="line">import numpy as np</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">print(&#x27;flag length:&#x27;,len(flag))</span><br><span class="line">dic = string.ascii_uppercase+string.ascii_lowercase+string.digits+&#x27;+/&#x27;</span><br><span class="line">f1nd = lambda x : dic.find(x)</span><br><span class="line">class KeyEncryption:</span><br><span class="line">    def __init__(self, m: int, fillchar: str=&quot;z&quot;, key: np.ndarray=None):</span><br><span class="line">        self.m = m</span><br><span class="line">        self.key = key</span><br><span class="line">        self.dicn2s = &#123;i: dic[i] for i in range(64)&#125;</span><br><span class="line">        self.dics2n = dict(zip(self.dicn2s.values(), self.dicn2s.keys()))</span><br><span class="line">        self.fillchar = self.dics2n[fillchar]</span><br><span class="line">    def setM(self, m: int) -&gt; None:</span><br><span class="line">        assert m &gt; 0</span><br><span class="line">        self.m = m</span><br><span class="line">    def setKey(self, key: np.ndarray=None) -&gt; None:</span><br><span class="line">        if key is None:</span><br><span class="line">            while key is None or KeyEncryption.modInv(np.linalg.det(key)) == -1:</span><br><span class="line">                key = np.random.randint(0, 65, size=(self.m, self.m))</span><br><span class="line">            print(&quot;random matrix：\n&quot;, key)</span><br><span class="line">        else:</span><br><span class="line">            assert KeyEncryption.modInv(np.linalg.det(key)) != -1</span><br><span class="line">        self.key = key</span><br><span class="line">    @staticmethod</span><br><span class="line">    def modInv(x: int):</span><br><span class="line">        y = 0</span><br><span class="line">        while y &lt; 64:</span><br><span class="line">            y += 1</span><br><span class="line">            if (x * y) % 64 == 1:</span><br><span class="line">                return y</span><br><span class="line">        return -1</span><br><span class="line">    def _loopCrypt(self, long: np.ndarray, K: np.ndarray) -&gt; np.ndarray:</span><br><span class="line">        ans = np.array([])</span><br><span class="line">        for i in range(long.shape[0] // self.m):</span><br><span class="line">            ans = np.mod(np.hstack((</span><br><span class="line">                ans, </span><br><span class="line">                np.dot(long[i*self.m:i*self.m+self.m], K)</span><br><span class="line">            )), 64)</span><br><span class="line">        return ans.astype(np.int64)</span><br><span class="line">    def encrypt(self, plaintext: np.ndarray):</span><br><span class="line">        assert self.m !=None and self.key is not None</span><br><span class="line">        if plaintext.shape[0] % self.m:</span><br><span class="line">            plaintext = np.hstack((</span><br><span class="line">                plaintext, </span><br><span class="line">                [self.fillchar] *(self.m - plaintext.shape[0] % self.m)</span><br><span class="line">            ))</span><br><span class="line">        return self._loopCrypt(plaintext, self.key)</span><br><span class="line">    def translate(self, s, to: str):</span><br><span class="line">        if to == &quot;text&quot;:</span><br><span class="line">            return &quot;&quot;.join([self.dicn2s[si] for si in s])</span><br><span class="line">        elif to == &quot;num&quot;:</span><br><span class="line">            s = s.replace(&quot; &quot;, &quot;&quot;)</span><br><span class="line">            return np.array([self.dics2n[si] for si in s])</span><br><span class="line">def getKey(key):</span><br><span class="line">  he = KeyEncryption(m=3)</span><br><span class="line">  he.setKey()              </span><br><span class="line">  nums = he.translate(key, &quot;num&quot;)</span><br><span class="line">  res = he.encrypt(nums)</span><br><span class="line">  enkey = &#x27;&#x27;.join(dic[i] for i in res.tolist())</span><br><span class="line">  print(&#x27;Encrypt key:&#x27;,enkey)</span><br><span class="line">  return enkey</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">  fir1 = &#x27; &#x27;.join(map(lambda _:_[::-1],re.split(&quot;[ &#123; _ &#125; ]&quot; , flag.swapcase())))</span><br><span class="line">  ciphertext1 = &#x27;&#x27;</span><br><span class="line">  key = &quot;&quot;  </span><br><span class="line">  enkey = getKey(key)</span><br><span class="line">  _enkey=[f1nd(i) for i in key]</span><br><span class="line">  print(&#x27;key lengeh:&#x27;,len(_enkey))</span><br><span class="line">  j = 0</span><br><span class="line">  for i in fir1:</span><br><span class="line">    if f1nd(i)&gt;=0:</span><br><span class="line">      ciphertext1 += dic[(f1nd(i) + _enkey[j % len(_enkey)])%64]</span><br><span class="line">    else:</span><br><span class="line">      ciphertext1 += i</span><br><span class="line">    j += 1</span><br><span class="line">  ciphertext = ciphertext1.replace(&#x27; &#x27;,&#x27;_&#x27;)</span><br><span class="line">  print(&#x27;ciphertext:%s&#123;%s&#125;&#x27; % (ciphertext[0:5],ciphertext[6:-1]))</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">flag length: 48</span><br><span class="line">random matrix：</span><br><span class="line"> [[13 37 10]</span><br><span class="line"> [15 17 41]</span><br><span class="line"> [13  0 10]]</span><br><span class="line">Encrypt key: pVvRe/G08rLhfwa</span><br><span class="line">key lengeh: 14</span><br><span class="line">ciphertext:1k2Pe&#123;24seBl4_a6Ot_fp7O1_eHk_Plg3EF_g/JtIonut4/&#125;</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>



<h1 id="Raven"><a href="#Raven" class="headerlink" title="Raven"></a>Raven</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env sage</span><br><span class="line"># Problem by rec, with a bad raven.</span><br><span class="line">import os, hashlib</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line"></span><br><span class="line">def Raven(n: int, secret: bytes):</span><br><span class="line">    H = lambda x: hashlib.md5(os.urandom(8) + x).digest()</span><br><span class="line"></span><br><span class="line">    p = getPrime(728)</span><br><span class="line">    R.&lt;z&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line">    seed = H(secret)</span><br><span class="line">    f = R(</span><br><span class="line">        [bytes_to_long(secret)] + [bytes_to_long(H(seed)) for _ in range(n - 1)]</span><br><span class="line">    )</span><br><span class="line">    x = [getRandomRange(2, p - 1) for _ in range(n)]</span><br><span class="line">    y = [ZZ(f(xi)^2 + getPrime(256)) for xi in x]</span><br><span class="line"></span><br><span class="line">    pairs = list(zip(x, y))</span><br><span class="line">    return p, pairs</span><br><span class="line"></span><br><span class="line">flag = b&#x27;#####&#x27;</span><br><span class="line">key = os.urandom(16)</span><br><span class="line">cipher = AES.new(key=key, IV=bytes(range(16)), mode=AES.MODE_CBC)</span><br><span class="line">ct = cipher.encrypt(flag + os.urandom(16 - len(flag) % 16))</span><br><span class="line">p, pairs = Raven(4, key)</span><br><span class="line"></span><br><span class="line">print(f&quot;&#123;p = &#125;\n&#123;pairs = &#125;\n&#123;ct = &#125;&quot;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p = 1018551160851728231474335384388576586031917743463656622083024684199383855595168341728561337234276243780407755294430553694832049089534855113774546001494743212076463713621965520780122783825100696968959866614846174188401153</span><br><span class="line">pairs = [(615358616404864757405587650175842125441380884418119777842292095751090237848084440177153221092040264723889917863863854377665802549748720692225139890884830475485512763149974948701807492663962748292710803434009673589337265, 84982753624462868217739962129526665082932464631118597651920986288766037499319751354013335054886685186857222944776560264528363811382359242656883760986496856164448940929282013856762706210675691655747370624405968909408102), (528363810186974800127873139379943131424126521611531830591311656948009967709310974894584084912262479395720199930206495204352231804549705720854271566421006481173043064265399467682307971910488405265826107365679757755866812, 496810092723839642457928776423789418365006215801711874210443222720529161066621876103037104247173440072986344011599384793861949574577559989016501090247331146721371126871470611440468688947950954988175225633457347666551944), (68711183101845981499596464753252121346970486988311398916877579778110690480447199642602267233989256728822535174215153145632158860662954277116345331672194812126361911061449082917955000137698138358926301360506687271134873, 995428771589393162202488762223106955302099250561593105620410424291405842350539887383005328242236156038373244928147473800972534658018117705291472213770335998508454938607290279268848513727721410314612261163489156360908800), (61574167546312883246262193556029081771904529137922128124933785599227801608271357738142074310192454183183340219301304405636497744152219785042075198056952749425345561162612590170550454476602892138914473795478531165181812, 618169326093802548516842299173393893046765466917311052414967158839652012130855552015876657514610755108820971877570295328618373296493668146691687291894702228119875561585283226588768969944781923428807766632578060221034862)]</span><br><span class="line">ct = b&quot;|2\xf0v7\x05Y\x89\r]\xe93s\rr)#3\xe9\x90%Z\x9a\xd9\x9ck\xba\xec]q\xb8\xf2&#x27;\xc8e~fL\xcf\x93\x00\xd6^s-\xc9\xd6M&quot;</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>



<h1 id="PsychoRandom"><a href="#PsychoRandom" class="headerlink" title="PsychoRandom"></a>PsychoRandom</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># Problem by rec, with a toy generator.</span><br><span class="line">import os, utils</span><br><span class="line"></span><br><span class="line">seed = int(os.urandom(16).hex(), 16)</span><br><span class="line">gen = utils.ToyGen(seed)</span><br><span class="line"></span><br><span class="line">sec = b&#x27;#####&#x27;</span><br><span class="line">assert b&#x27;nkctf&#x27; in sec</span><br><span class="line"></span><br><span class="line">msg = b&#x27;##MSG FROM NK: &#x27; + sec</span><br><span class="line">enc = bytes(m ^ next(gen) for m in msg).hex()</span><br><span class="line">print(enc)</span><br><span class="line"># 9c1250e1fefb6012cf74a7fd0156cd1a2817ee9381d086a1561399f5b7f519e5abf4437739fa254cd35b241375292d73aa8b8e6ff61f4977da3c68a699156e6bfbe2c38d7b08eed07e40e831c25f5327a21847bb156060228e2b</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>2023WMCTF</title>
    <url>/2023/08/22/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023WMCTF/</url>
    <content><![CDATA[<p>复现WMCTF——Crypto部分题目</p>
<span id="more"></span>

<h1 id="badprime"><a href="#badprime" class="headerlink" title="badprime"></a>badprime</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">M = <span class="number">0x7cda79f57f60a9b65478052f383ad7dadb714b4f4ac069997c7ff23d34d075fca08fdf20f95fbc5f0a981d65c3a3ee7ff74d769da52e948d6b0270dd736ef61fa99a54f80fb22091b055885dc22b9f17562778dfb2aeac87f51de339f71731d207c0af3244d35129feba028a48402247f4ba1d2b6d0755baff6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getMyprime</span>(<span class="params">BIT</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = <span class="built_in">int</span>(<span class="built_in">pow</span>(<span class="number">65537</span>, getRandomRange(M&gt;&gt;<span class="number">1</span>, M), M)) + getRandomInteger(BIT-<span class="built_in">int</span>(M).bit_length()) * M</span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">p = getMyprime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Try to crack the bad RSA&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public key:&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;The flag(encrypted):&quot;</span>, <span class="built_in">pow</span>(m, <span class="number">65537</span>, n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Well well, I will give you the hint if you please me ^_^&quot;</span>)</span><br><span class="line">leak = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Gift window:&quot;</span>))</span><br><span class="line"><span class="keyword">if</span> M % leak == <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This is the gift for you: &quot;</span>, p % leak)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;I don&#x27;t like this gift!&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>第一眼看这个p的生成方式，以及M，就以为是roca。</p>
<p>尝试了很久用roca来分解n，并没成功</p>
<p>看到$hint \equiv p \mod leak$，这个$leak$是$M$的因子，M是前126个素数之积(无所谓)，直接把M进去</p>
<p>得到$hint \equiv p \mod M$</p>
<p>$\therefore p &#x3D; hint + KM$，这里得到的$hint&#x3D;971bit$，$M&#x3D;971bit$，所以$k$大概只有$53bit$</p>
<p>可以爆出来</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">hint= </span><br><span class="line">M = <span class="number">19467773070115377343221509599623925236459751278180415885837207534756855405403128279156705968461708578168638327032034542684864920135818987044810141311008655898015207220772515212093850725541003213054560185603695585660265284153421684796257245143362498012760214539505870197264858636122745485373430</span></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">R.&lt;k&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = k*M + hint</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X = <span class="number">2</span>^<span class="number">55</span>,beta = <span class="number">0.4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(roots)</span></span><br><span class="line">p = <span class="built_in">int</span>(roots[<span class="number">0</span>])*M + hint</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<h1 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pr</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">bit</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        P = getPrime(bit)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(P)) - <span class="number">2</span> == bit:</span><br><span class="line">            <span class="keyword">return</span> P</span><br><span class="line"></span><br><span class="line">pq_bit = <span class="number">512</span></span><br><span class="line">offset = <span class="number">16</span></span><br><span class="line"></span><br><span class="line">P,Q = [gen_prime(pq_bit) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">N = P * Q</span><br><span class="line">gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(P ^ (Q &gt;&gt; offset))[<span class="number">2</span>+offset:],<span class="number">2</span>)</span><br><span class="line">pr(N)</span><br><span class="line">pr(gift)</span><br><span class="line"></span><br><span class="line">inpP = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> inpP != P:</span><br><span class="line">    pr(<span class="string">b&quot;you lose!&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">secret = randrange(<span class="number">0</span>,P)</span><br><span class="line">bs = [randrange(<span class="number">0</span>,P) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">38</span>)]</span><br><span class="line"></span><br><span class="line">results = [(bi * secret) % P <span class="keyword">for</span> bi <span class="keyword">in</span> bs]</span><br><span class="line">rs = [ri &amp; (<span class="number">2</span> ** offset - <span class="number">1</span>)  <span class="keyword">for</span> ri <span class="keyword">in</span> results]</span><br><span class="line"></span><br><span class="line">pr(bs)</span><br><span class="line">pr(rs)</span><br><span class="line">inpsecret = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> inpsecret == secret:</span><br><span class="line">    pr(flag)</span><br></pre></td></tr></table></figure>

<p>又是类似$p \otimes q$的题目，类似于DAS7月赛</p>
<p>先遍历$2^{15}——2^{16}$恢复出gift，再爆出p,q</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = </span><br><span class="line">N = </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">15</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(j)[<span class="number">2</span>:] +<span class="built_in">bin</span>(h)[<span class="number">2</span>:].rjust(<span class="number">496</span>,<span class="string">&#x27;0&#x27;</span>),<span class="number">2</span>)</span><br><span class="line">    pbar = gift &gt;&gt;(<span class="number">512</span>-<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            qbar = (N&gt;&gt;(<span class="number">1024</span> - pbar.bit_length()*<span class="number">2</span>))//pbar</span><br><span class="line">            qbar = qbar&gt;&gt;<span class="number">6</span></span><br><span class="line">            gifts = gift^(qbar&lt;&lt;(<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length()))</span><br><span class="line">            pbar = gifts &gt;&gt; (<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        p = (pbar&lt;&lt;<span class="number">6</span>)+i</span><br><span class="line">        <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">            q = N//p</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] p =&quot;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] q =&quot;</span>,q)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>$\because R_i \equiv  B_i × secret \mod p $，题目只给出了$R_i$的低16位</p>
<p>$\therefore r_i \equiv R_i \mod 2^{16}$</p>
<p>$\therefore r_i \equiv (B_i×secret \mod p) \mod 2^{16}$</p>
<p>因为前面$R_i \equiv  B_i × secret \mod p$</p>
<p>所以可以把<code>mod 2^16 </code>和<code>mod p</code>交换</p>
<p> 于是有$r_i \equiv (B_i×secret \mod 2^{16}) \mod p \longrightarrow r_i \equiv B_i×secret + k_i×2^{16} \mod p$</p>
<p>$\therefore k_i×2^{16} \equiv B_i×secret -r_i \mod p \longrightarrow k_i \equiv B_i×secret×inv - r_i×inv \mod p $这里$inv$是$2^{16}$模$p$的逆元</p>
<p>最后可以得到$k_i &#x3D; B_i×secret×inv - r_i×inv + l_ip$</p>
<p>于是有</p>
<p><img src="/../../images/2023WMCTF/0.png"></p>
<p>这里的$k_i \approx 496bit$，所以取$K&#x3D;2^{496}$，为了让右边向量的值都差不多大，调出$\frac{K×secret}{p}$</p>
<p>因为这题不是很清楚secret的大小，我就直接套脚本了。</p>
<p>现学的，理解不是很透彻</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">h = </span><br><span class="line">N = </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">15</span>,<span class="number">2</span>**<span class="number">16</span>):</span><br><span class="line">    gift = <span class="built_in">int</span>(<span class="built_in">bin</span>(j)[<span class="number">2</span>:] +<span class="built_in">bin</span>(h)[<span class="number">2</span>:].rjust(<span class="number">496</span>,<span class="string">&#x27;0&#x27;</span>),<span class="number">2</span>)</span><br><span class="line">    pbar = gift &gt;&gt;(<span class="number">512</span>-<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            qbar = (N&gt;&gt;(<span class="number">1024</span> - pbar.bit_length()*<span class="number">2</span>))//pbar</span><br><span class="line">            qbar = qbar&gt;&gt;<span class="number">6</span></span><br><span class="line">            gifts = gift^(qbar&lt;&lt;(<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length()))</span><br><span class="line">            pbar = gifts &gt;&gt; (<span class="number">512</span>-<span class="number">16</span>-qbar.bit_length())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        p = (pbar&lt;&lt;<span class="number">6</span>)+i</span><br><span class="line">        <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">            q = N//p</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] p =&quot;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] q =&quot;</span>,q)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">B = </span><br><span class="line">R = </span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(R)</span><br><span class="line"></span><br><span class="line">M = Matrix(QQ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">inv = invert(<span class="number">2</span> ** <span class="number">16</span>,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    M[i,i] = p</span><br><span class="line">    M[-<span class="number">2</span>,i] = B[i] * inv</span><br><span class="line">    M[-<span class="number">1</span>,i] = -R[i] * inv</span><br><span class="line"></span><br><span class="line">t = QQ(<span class="number">2</span>^<span class="number">496</span> / p)</span><br><span class="line">K = <span class="number">2</span>^<span class="number">496</span></span><br><span class="line"></span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>] = t</span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>] = K</span><br><span class="line"></span><br><span class="line">L = M.LLL()</span><br><span class="line"></span><br><span class="line">x = L[<span class="number">1</span>][-<span class="number">2</span>] // t</span><br><span class="line"><span class="built_in">print</span>(x % p)</span><br></pre></td></tr></table></figure>

<p>HNP问题参考：<a href="https://blog.csdn.net/qq_41626232/article/details/129964038?spm=1001.2014.3001.5502">lattice的HNP问题学习_无趣的浅的博客-CSDN博客</a></p>
<p><a href="https://www.anquanke.com/post/id/204846">浅尝 Lattice 之 HNP-安全客 - 安全资讯平台 (anquanke.com)</a></p>
<h1 id="welcome-signer1-——-先搁着"><a href="#welcome-signer1-——-先搁着" class="headerlink" title="welcome_signer1 —— 先搁着"></a>welcome_signer1 —— 先搁着</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> isprime</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm </span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;***********************************&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">return</span> message + <span class="string">b&quot;\x00&quot;</span>*((<span class="number">16</span>-<span class="built_in">len</span>(message)%<span class="number">16</span>)%<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfastexp</span>(<span class="params">m,d,N,j,N_</span>):</span><br><span class="line">    A = <span class="number">1</span></span><br><span class="line">    d = <span class="built_in">bin</span>(d)[<span class="number">2</span>:]</span><br><span class="line">    n = <span class="built_in">len</span>(d)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> i &lt; j:</span><br><span class="line">            <span class="comment">#print(A)</span></span><br><span class="line">            N = N_</span><br><span class="line">        A = A*A % N</span><br><span class="line">        <span class="keyword">if</span> d[i] == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            A = A * m % N</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,key</span>):</span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(md5(<span class="built_in">str</span>(key).encode()).hexdigest())</span><br><span class="line">    enc = AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">    c   = enc.encrypt(pad(message))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">border = <span class="string">&quot;|&quot;</span></span><br><span class="line"><span class="built_in">print</span>(border*<span class="number">75</span>)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;Hi all, I have created an algorithm that can quickly calculate powers. &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;But it looks like there&#x27;s something wrong with it. Your task is to get &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;its private key,and decrypt the cipher to cat the flag ^-^             &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border*<span class="number">75</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="comment"># generate</span></span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">17</span></span><br><span class="line">    <span class="keyword">if</span> GCD(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        n_ = n </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">msg = bytes_to_long(<span class="string">b&quot;Welcome_come_to_WMCTF&quot;</span>)</span><br><span class="line">sig = <span class="built_in">pow</span>(msg,d,n)</span><br><span class="line"></span><br><span class="line">CHANGE = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ans = <span class="built_in">input</span>(<span class="string">&quot;| Options: \n|\t[G]et data \n|\t[S]ignatrue \n|\t[F]ault injection \n|\t[Q]uit\n&quot;</span>).lower().strip()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ans == <span class="string">&#x27;f&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> CHANGE:</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">&quot;You have one chance to change one byte of N. &quot;</span>)</span><br><span class="line">                temp,index = <span class="built_in">input</span>(<span class="string">&quot;bytes, and index:&quot;</span>).strip().split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">                <span class="keyword">assert</span> <span class="number">0</span>&lt;= <span class="built_in">int</span>(temp) &lt;=<span class="number">255</span></span><br><span class="line">                <span class="keyword">assert</span> <span class="number">0</span>&lt;= <span class="built_in">int</span>(index) &lt;= <span class="number">1023</span> </span><br><span class="line">                n_ = n ^ (<span class="built_in">int</span>(temp)&lt;&lt;<span class="built_in">int</span>(index))</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">f&quot;[+] update: n_ -&gt; \&quot;<span class="subst">&#123;n_&#125;</span>\&quot;&quot;</span>)</span><br><span class="line">                CHANGE = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">&quot;Greedy...&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;flag_ciphertext = <span class="subst">&#123;encrypt(flag,d).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            index = <span class="built_in">input</span>(<span class="string">&quot;Where your want to interfere:&quot;</span>).strip()</span><br><span class="line">            sig_ = myfastexp(msg,d,n,<span class="built_in">int</span>(index),n_)</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;signature of \&quot;Welcome_come_to_WMCTF\&quot; is <span class="subst">&#123;sig_&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            quit()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(border,<span class="string">&quot;Err...&quot;</span>)</span><br><span class="line">        quit()</span><br></pre></td></tr></table></figure>

<h1 id="welcome-signer2-——-先搁着"><a href="#welcome-signer2-——-先搁着" class="headerlink" title="welcome_signer2 —— 先搁着"></a>welcome_signer2 —— 先搁着</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;***********************************&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">return</span> message + <span class="string">b&quot;\x00&quot;</span>*((<span class="number">16</span>-<span class="built_in">len</span>(message)%<span class="number">16</span>)%<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myfastexp</span>(<span class="params">m,d,N,j,N_</span>):</span><br><span class="line">    A = <span class="number">1</span></span><br><span class="line">    B = m</span><br><span class="line">    d = <span class="built_in">bin</span>(d)[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">    n = <span class="built_in">len</span>(d)</span><br><span class="line">    N = N</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">if</span> d[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            A = A * B % N</span><br><span class="line">        <span class="comment">#  a fault occurs j steps before the end of the exponentiation</span></span><br><span class="line">        <span class="keyword">if</span> i &gt;= n-<span class="number">1</span>-j:</span><br><span class="line">            N = N_</span><br><span class="line">        B = B**<span class="number">2</span> % N</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message,key</span>):</span><br><span class="line">    key = <span class="built_in">bytes</span>.fromhex(md5(<span class="built_in">str</span>(key).encode()).hexdigest())</span><br><span class="line">    enc = AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">    c   = enc.encrypt(pad(message))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">border = <span class="string">&quot;|&quot;</span></span><br><span class="line"><span class="built_in">print</span>(border*<span class="number">75</span>)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;Hi all, I have another algorithm that can quickly calculate powers. &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;But still there&#x27;s something wrong with it. Your task is to get      &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border, <span class="string">&quot;its private key,and decrypt the cipher to cat the flag ^-^          &quot;</span>, border)</span><br><span class="line"><span class="built_in">print</span>(border*<span class="number">75</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"><span class="comment"># generate</span></span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">17</span></span><br><span class="line">    <span class="keyword">if</span> GCD(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span>:</span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        n_ = n </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">n_ = n</span><br><span class="line">msg = bytes_to_long(<span class="string">b&quot;Welcome_come_to_WMCTF&quot;</span>)</span><br><span class="line">sig = <span class="built_in">pow</span>(msg,d,n)</span><br><span class="line"><span class="keyword">assert</span> sig == myfastexp(msg,d,n,<span class="number">0</span>,n_)</span><br><span class="line">CHANGE = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ans = <span class="built_in">input</span>(<span class="string">&quot;| Options: \n|\t[G]et data \n|\t[S]ignatrue \n|\t[F]ault injection \n|\t[Q]uit\n&quot;</span>).lower().strip()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ans == <span class="string">&#x27;f&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> CHANGE:</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">&quot;You have one chance to change one byte of N. &quot;</span>)</span><br><span class="line">                temp,index = <span class="built_in">input</span>(<span class="string">&quot;bytes, and index:&quot;</span>).strip().split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">                <span class="keyword">assert</span> <span class="number">0</span>&lt;= <span class="built_in">int</span>(temp) &lt;=<span class="number">255</span></span><br><span class="line">                <span class="keyword">assert</span> <span class="number">0</span>&lt;= <span class="built_in">int</span>(index) &lt;= <span class="number">1023</span> </span><br><span class="line">                n_ = n ^ (<span class="built_in">int</span>(temp)&lt;&lt;<span class="built_in">int</span>(index))</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">f&quot;[+] update: n_ -&gt; \&quot;<span class="subst">&#123;n_&#125;</span>\&quot;&quot;</span>)</span><br><span class="line">                CHANGE = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(border,<span class="string">&quot;Greedy...&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;g&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;flag_ciphertext = <span class="subst">&#123;encrypt(flag,d).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">            index = <span class="built_in">input</span>(<span class="string">&quot;Where your want to interfere:&quot;</span>).strip()</span><br><span class="line">            sig_ = myfastexp(msg,d,n,<span class="built_in">int</span>(index),n_)</span><br><span class="line">            <span class="built_in">print</span>(border,<span class="string">f&quot;signature of \&quot;Welcome_come_to_WMCTF\&quot; is <span class="subst">&#123;sig_&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> ans == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">            quit()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(border,<span class="string">&quot;Err...&quot;</span>)</span><br><span class="line">        quit()</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>SICTF2023</title>
    <url>/2023/09/10/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTF2023/</url>
    <content><![CDATA[<p>SICTF2023 #Round2 Crypto方向</p>
<span id="more"></span>

<h1 id="古典大杂烩"><a href="#古典大杂烩" class="headerlink" title="古典大杂烩"></a>古典大杂烩</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">🐩👃🐪🐼👅🐯🐩👈👇👭👟👝🐺🐭👉👙👤👋👚🐪🐫👍👢👮👱🐼👢👨👠👭🐽🐰🐻👚👂👧👠👥👛👮👯👮👬🐾👐👛👌👚👞🐨👏👉👆🐿👆👘👇🐺👦🐸👃🐭👟👑👪👃👁🐻🐻👜🐧👇👊🐧🐾🐼👇🐫🐺👐👆👪🐼👋👌👧🐻👐🐩🐺👥🐽👋👉🐰👎👠👠👣🐧🐫👧🐭👢🐯👑👑🐮👂👏🐻👥👚🐮👋👬👌👥👁👣👅👧👯👦👌👌👍👠👌🐽👉👃👊🐫👉🐨🐮👩👆🐪🐯👘👏👏🐼👩👍👊👍👡👀👰👋👣👨👧👍👜👐👛🐮👘👅👠🐿👂👰👄👈👝👠👤👃👛👘🐭👅👱👆👬👫👥👆🐽👁👐👥👊👇👉👊👩👌👭🐫🐫👬👱🐯👇🐺👁👞👑👙🐮👜👋👘👪👩👚👦👨👀👩👐👉👃🐾👥👀🐫👝👍🐩🐧👰👆👇👨🐪👃🐭👦🐫👱</span><br></pre></td></tr></table></figure>

<p>base家族</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">base100 --&gt; base62 --&gt; base64 --&gt; base58 --&gt; base32 --&gt; base62</span><br><span class="line"><span class="comment">#SICTF&#123;fe853b49-8730-462e-86f5-fc8e9789f077&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Radio"><a href="#Radio" class="headerlink" title="Radio"></a>Radio</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n1 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p * q</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n3 = p * q</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">c1 = <span class="built_in">pow</span>(m,e,n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m,e,n2)</span><br><span class="line">c3 = <span class="built_in">pow</span>(m,e,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1 =&quot;</span>,n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2 =&quot;</span>,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n3 =&quot;</span>,n3)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 =&quot;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 =&quot;</span>,c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c3 =&quot;</span>,c3)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 14628911682936716611458501697007036859460044243525290515096052103585430459755335375005202100114469571371360084664887335211277585652711111523095037589648375630146039444071400098427638768750755153219974194380355807078158427824557754939604018020265955042573660474772006646525311705184431094905718137297923127124517126579859336516891364853724635334011666814712424599592662398013241607855160919361308195967978220182785816761656927836373944699635667244275310680450562446433724968942835275279255823144471582249379035668825437133182865600026935116686574740844588839352146024513673500770611055698030333734066230166111140083923 </span></span><br><span class="line"><span class="string">n2 = 16756694748293603983474688536179571665757862433174984877308316444468003022266277794769268134195205510197588585566270416339902269736376811449830775290335951504698137924773942880807921752691668522662285163130340474205633998154849689387759453003838730282756734975490180702422176361373516245372635401939755527017589503572550811648345570775428936487145892225736625411540461653083957762795820510109891180906709827194217045059033312564525916136573856999724346161896146703174418039344166251503310869772735585554127509732135494936119159784702673291794381095696332128950979288440758815310482211285712819274848744478643590996499 </span></span><br><span class="line"><span class="string">n3 = 12023158079717019193506148537498877243668782424904061914991928068483879707115315968983829360560644394409575645736275352836086080024994045582242629571839276759393418303915955798990522990081795218822313146157773272844272865701134880180795342597049645358985187689813369428579614193015028249821853347208001645148169449968882591709833452960545988520048722323580338213590245476892223967673180144525106292453573842357322398199104132677638909964034937501684668442732786408572501007756270725934445316827054687741612177409932320532825182104820899546084015733164816993674100635828218335112393003462442685677115798304835391938681 </span></span><br><span class="line"><span class="string">c1 = 786426913645332991929803636719878643130489430090701482974255190570111407517277263761161970232982615374753982050075781017755721714929721429185828101898786972242994012456972241276851428750970754773002966788642795040933520662931514953660571657013642671173456750800960592586345219252277575624120271330470724245201080094330964145796872211627254805407394764183615099525852600855622089361965086460279057625205099471122036599934609091062009161119885692567925924978687256063116915630947838112126347748759078024890458539541208153526564434483654508834147071166870006117573542198238493913144419569943131642262575848786399020602    </span></span><br><span class="line"><span class="string">c2 = 14269311999815379511888097227418748728398011595172649708273598243317106830139061994801598925448165045032084910971094414749744701731066555194159863759072739031915833091715422787808666326235589236328864675164322734119047182014621724868200908222400504845559290620275973427127376594365043386362821355037781568524903149101953873768462097165128186788759111090267131443645126715520994688945363059795513931799317608292977574376954729552861360597103229877031117089231816770880909815561950691603994439997197261395452797893557057320175747162837857668062550646101714062365530246698404923128445182100334335447738834779014705114350  </span></span><br><span class="line"><span class="string">c3 = 3204718091370324153305164801961074660508922478706979436653573192321723216725523523538914956544950802616295043619768261075799875855502834749045520466140056621489305006966280527055668378303630674311102581232313032585389907028715671091914904062961720585667564982641321454541632782484415075257140508738041786400512095949826279576159569786734978545737717138115729502475357594151593143140355121154223614868465202149338507796306863351134218879326031985027900678671697876083351974546516576983143592764763925335805465720148057651958521255276602933604064541840892578409973858867533575728482926007556060584654853884046046420855 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>中国剩余定理</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 =   </span><br><span class="line">n2 =   </span><br><span class="line">n3 =   </span><br><span class="line">c1 =     </span><br><span class="line">c2 =   </span><br><span class="line">c3 =  </span><br><span class="line"> </span><br><span class="line">m_list = [n1,n2,n3]</span><br><span class="line">a_list = [c1,c2,c3]</span><br><span class="line"></span><br><span class="line">x = crt(m_list,a_list)[<span class="number">0</span>]</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line">m = gmpy2.iroot(x,e)</span><br><span class="line"><span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line"><span class="comment">#SICTF&#123;fdc0afb5-1c81-46b9-a28a-241f5f64419d&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="MingTianPao"><a href="#MingTianPao" class="headerlink" title="MingTianPao"></a>MingTianPao</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, message</span><br><span class="line"><span class="comment"># message is a Classic English Story</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    tmp = (message[i*<span class="number">30</span>:(i+<span class="number">1</span>)*<span class="number">30</span>].encode())</span><br><span class="line">    <span class="built_in">print</span>(binascii.hexlify(strxor(tmp,flag)).decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1f2037202a1e6d06353b61263d050a0538493b3018544e14171d2b1c4218</span></span><br><span class="line"><span class="comment"># 3769373b66142f31297f291126410e042b01162d59103a0c005221075013</span></span><br><span class="line"><span class="comment"># 37242c202e1e3f743c36371130410c1e2b491a31574406014505291a550e</span></span><br><span class="line"><span class="comment"># 7f6922742e1a213270372e01264105193004532b1f554e120c1e2a145618</span></span><br><span class="line"><span class="comment"># 7d69143c23156d18392b35183141310e3b49213613590003453a291a555d</span></span><br><span class="line"><span class="comment"># 36273731341e297424372454230e0c0f2c49127f005f020245112718545d</span></span><br><span class="line"><span class="comment"># 26396320295b2531227161273c04430f360d533118444e0f0b1d31554615</span></span><br><span class="line"><span class="comment"># 323d6335660c24373b3a2554350f0a063e05533712101905165e66145f19</span></span><br><span class="line"><span class="comment"># 733e222766152220703e27063508074b300f53371e5d40444735291a555d</span></span><br><span class="line"><span class="comment"># 37283a7432146d2d3f2a6d541808171f330c530d12544e360c162f1b565d</span></span><br></pre></td></tr></table></figure>

<p>MTP</p>
<p>网上找个脚本</p>
<p>需要改动一点东西</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo</span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):</span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):</span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:</span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dat = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():</span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):</span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]</span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))</span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]</span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">            dat.append((f(pos), index, pos))</span><br><span class="line"></span><br><span class="line"><span class="comment">#这里传密文</span></span><br><span class="line">c = [codecs.decode(x.strip().encode(), <span class="string">&#x27;hex&#x27;</span>) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;0.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()]</span><br><span class="line"></span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>)</span><br><span class="line"></span><br><span class="line">getSpace()</span><br><span class="line"></span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:</span><br><span class="line">    infer(index, pos)</span><br><span class="line"></span><br><span class="line">know(<span class="number">0</span>, <span class="number">24</span>, <span class="string">&#x27;r&#x27;</span>)	<span class="comment">#如果需要修正， 传入所在被改字母所在行和列，再输入替代的字母,例如alwa s 改为always</span></span><br><span class="line">know(<span class="number">1</span>, <span class="number">10</span>, <span class="string">&#x27;h&#x27;</span>)</span><br><span class="line">know(<span class="number">1</span>, <span class="number">12</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">know(<span class="number">2</span>, <span class="number">16</span>, <span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">know(<span class="number">2</span>, <span class="number">28</span>, <span class="string">&#x27;d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg]))</span><br><span class="line"></span><br><span class="line">key = xo.strxor(c[<span class="number">0</span>], <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> msg[<span class="number">0</span>]]).encode())</span><br><span class="line"><span class="built_in">print</span>(key)</span><br></pre></td></tr></table></figure>



<h1 id="Easy-CopperSmith"><a href="#Easy-CopperSmith" class="headerlink" title="Easy_CopperSmith"></a>Easy_CopperSmith</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">leak = p &gt;&gt; <span class="number">230</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">114007680041157617250208809154392208683967639953423906669116998085115503737001019559692895227927818755160444076128820965038044269092587109196557720941716578025622244634385547194563001079609897387390680250570961313174656874665690193604984942452581886657386063927035039087208310041149977622001887997061312418381</span></span><br><span class="line"><span class="string">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line"><span class="string">87627846271126693177889082381507430884663777705438987267317070845965070209704910716182088690758208915234427170455157948022843849997441546596567189456637997191173043345521331111329110083529853409188141263211030032553825858341099759209550785745319223409181813931086979471131074015406202979668575990074985441810</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>一般情况下需要已知286位才能求解512的p</p>
<p>但是把<code>small_roots(epsilon = 0.01)</code>改动epsilon参数为0.01可以在已知264位的情况下求解p</p>
<p>题目给出高282，修改参数epsilon即可求解</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">high_p = <span class="number">6833525680083767201563383553257365403889275861180069149272377788671845720921410137177</span></span><br><span class="line">high_p = high_p &lt;&lt; <span class="number">230</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = high_p + x</span><br><span class="line">roots = f.small_roots(X = <span class="number">2</span>^<span class="number">230</span>,beta = <span class="number">0.4</span>,epsilon=<span class="number">0.01</span>)</span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p = high_p + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<h1 id="签到题来咯"><a href="#签到题来咯" class="headerlink" title="签到题来咯"></a>签到题来咯</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c1 = <span class="built_in">pow</span>(<span class="number">114</span>*m+<span class="number">2333</span>,e,n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(<span class="number">514</span>*m+<span class="number">4555</span>,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 18993579800590288733556762316465854395650778003397512624355925069287661487515652428099677335464809283955351330659278915073219733930542167360381688856732762552737791137784222098296804826261681852699742456526979985201331982720936091963830799430264680941164508709453794113576607749669278887105809727027129736803614327631979056934906547015919204770702496676692691248702461766117271815398943842909579917102217310779431999448597899109808086655029624478062317317442297276087073653945439820988375066353157221370129064423613949039895822016206336117081475698987326594199181180346821431242733826487765566154350269651592993856883</span></span><br><span class="line"><span class="string">c1 = 3089900890429368903963127778258893993015616003863275300568951378177309984878857933740319974151823410060583527905656182419531008417050246901514691111335764182779077027419410717272164998075313101695833565450587029584857433998627248705518025411896438130004108810308599666206694770859843696952378804678690327442746359836105117371144846629293505396610982407985241783168161504309420302314102538231774470927864959064261347913286659384383565379900391857812482728653358741387072374314243068833590379370244368317200796927931678203916569721211768082289529948017340699194622234734381555103898784827642197721866114583358940604520</span></span><br><span class="line"><span class="string">c2 = 6062491672599671503583327431533992487890060173533816222838721749216161789662841049274959778509684968479022417053571624473283543736981267659104310293237792925201009775193492423025040929132360886500863823523629213703533794348606076463773478200331006341206053010168741302440409050344170767489936681627020501853981450212305108039373119567034948781143698613084550376070802084805644270376620484786155554275798939105737707005991882264123315436368611647275530607811665999620394422672764116158492214128572456571553281799359243174598812137554860109807481900330449364878168308833006964726761878461761560543284533578701661413931</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>相关消息攻击，遍历所有e</p>
<p>参考<a href="https://blog.csdn.net/XiongSiqi_blog/article/details/130978226">Franklin-Reiter相关消息攻击_Emmaaaaaaaaaa的博客-CSDN博客</a></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">E = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>^<span class="number">9</span>,<span class="number">2</span>^<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        E.append(i)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (<span class="number">114</span>*x + <span class="number">2333</span>)^e - c1</span><br><span class="line">    g2 = (<span class="number">514</span>*x + <span class="number">4555</span>)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(E)</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> E:</span><br><span class="line">    m = franklinReiter(n,e,c1,c2)</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;SICTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>



<h1 id="small-e"><a href="#small-e" class="headerlink" title="small_e"></a>small_e</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag=<span class="string">&quot;SICTF&#123;&quot;</span>+<span class="built_in">str</span>(uuid.uuid4())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">3</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line">m1=((m&gt;&gt;<span class="number">60</span>)&lt;&lt;<span class="number">60</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,m1)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 23407088262641313744603678186127228163189328033499381357614318160776774708961658114505773173784501557046914457908828086210961235530240151825359345210845219656000760996670856300710703016947799649686427460688236465568188205550456293373157997725204643414082796492333552579250010906010553831060540937802882205118399938918764313169385349293602085310111289583058965780887097301702677087443291977479125263301000328313103296364864396361278863921717374909215078711198899810620522933994481419395021233240234478331179727351050575360886334237633420906629984625441302945112631166021776379103081857393866576659121443879590011160797</span></span><br><span class="line"><span class="string">e= 3</span></span><br><span class="line"><span class="string">c= 1584727211980974717747362694412040878682966138197627512650829607105625096823456063149392973232737929737200028676411430124019573130595696272668927725536797627059576270068695792221537212669276826952363636924278717182163166234322320044764324434683614360641636360301452618063418349310497430566465329766916213742181</span></span><br><span class="line"><span class="string">((m&gt;&gt;60)&lt;&lt;60)= 11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>小e秒出</p>
<p>exp1:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= </span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= </span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t = gmpy2.iroot(c,e)</span><br><span class="line"><span class="keyword">if</span> t[<span class="number">1</span>]:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(t[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        m = gmpy2.iroot(k*n+c,e)</span><br><span class="line">        <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">            <span class="built_in">print</span>(m[<span class="number">0</span>])</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>预期考点应该是m高位泄露</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n= </span><br><span class="line">e= <span class="number">3</span></span><br><span class="line">c= </span><br><span class="line">m_high= <span class="number">11658736990073967239197168945911788935424691658202162501032766529463315401599017877851823976178979438592</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">m = m_high + x</span><br><span class="line">f = m^e - c</span><br><span class="line">x = f.small_roots(X = <span class="number">2</span>^<span class="number">60</span>,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> x:</span><br><span class="line">	m = m_high + x[<span class="number">0</span>]</span><br><span class="line">	<span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>



<h1 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span>  Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hint1 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">hint2 = getPrime(<span class="number">13</span>)*p+getPrime(<span class="number">256</span>)*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint1 = <span class="subst">&#123;hint1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint2 = <span class="subst">&#123;hint2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 68123067052840097285002963401518347625939222208495512245264898037784706226045178539672509359795737570458454279990340789711761542570505016930986418403583534761200927746744298082254959321108829717070206277856970403191060311901559017372393931121345743640657503994132925993800497309703877076541759570410784984067</span></span><br><span class="line"><span class="string">hint1 = 564294243979930441832363430202216879765636227726919016842676871868826273613344463155168512928428069316237289920953421495330355385445649203238665802121198919543532254290185502622234014832349396422316629991217252686524462096711723580</span></span><br><span class="line"><span class="string">hint2 = 484307144682854466149980416084532076579378210225500554261260145338511061452958092407101769145891750844383042274498826787696953308289632616886162073232218214504005935332891893378072083589751354946391146889055039887781077066257013110</span></span><br><span class="line"><span class="string">c = 57751903193610662622957432730720223801836323458721550133101805763463060486486266309568004721657732742899781400754207249733137375171400440423755473421971160000575072519031824740691618617905549725344323721903857290320737224300672847773455169809689188843070599176261204013341324705808617411345132933937680951713</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$hint_1 &#x3D; a_1p+b_1q$，$hint_2 &#x3D; a_2p+b_2q$</p>
<p>则$a_2hint_1 &#x3D; a_1a_2p+b_1a_2q$，$a_1hint_2 &#x3D; a_1a_2p + b_2a_1q$</p>
<p>两式相减得$a_2hint_1-a_1hint_2 &#x3D; (b_1a_2-b_2a_1)q$</p>
<p>于是$q &#x3D; gcd(n,a_2hint1-a_1hint_2)$，可以做检验</p>
<p>$a_1,a_2$不大，可以爆破</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">hint1 = </span><br><span class="line">hint2 = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">hints = [hint1,hint2]</span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>,<span class="number">2</span>**<span class="number">13</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        A.append(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a1, a2 <span class="keyword">in</span> tqdm(<span class="built_in">list</span>(product(A, repeat=<span class="number">2</span>))):</span><br><span class="line">    kq = gmpy2.gcd(a1 * hints[<span class="number">0</span>] - a2 * hints[<span class="number">1</span>], n)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; kq &lt; n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ffind!&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;kq=&quot;</span>,kq)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;a1=&quot;</span>,a1)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;a2=&quot;</span>,a2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">q = kq</span><br><span class="line">p = n // kq</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>参考：<a href="https://github.com/DownUnderCTF/Challenges_2023_Public/blob/main/crypto/apbq-rsa-i/solve/solv.py">Challenges_2023_Public&#x2F;crypto&#x2F;apbq-rsa-i&#x2F;solve&#x2F;solv.py at main · DownUnderCTF&#x2F;Challenges_2023_Public (github.com)</a></p>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>星盟安全团队纳新！</p>
<p>欢迎师傅们加群（346014666）学习、讨论！</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/3.png"></p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>2023江苏省领航杯</title>
    <url>/2023/09/12/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023%E9%A2%86%E8%88%AA%E6%9D%AF/</url>
    <content><![CDATA[<p>记录部分2023江苏省领航杯——Crypto的题目</p>
<span id="more"></span>

<p>题目来源于师傅分享，归类可能有问题，题目应该也是不全的，如果有误请师傅们见谅。</p>
<h1 id="高职组–决赛"><a href="#高职组–决赛" class="headerlink" title="高职组–决赛"></a>高职组–决赛</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzkwODMzOTA2NA==&mid=2247491638&idx=1&sn=a11dd769472151e82d11a68bd7b160db&chksm=c0c9d221f7be5b37e82c5ae6ac61320e0dcb3877adc51d223395eccd48dde80f1864c2eda222&scene=126&sessionid=1695722613#rd">wp</a></p>
<h2 id="回文"><a href="#回文" class="headerlink" title="回文"></a>回文</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">=QfzEDO4YDNlBzN4gzN0YGM1QzYyUGZ3QDZzgDM7V2Sn52bI52Q=</span><br></pre></td></tr></table></figure>

<p>把<code>=</code>去掉，密文翻转再base64解密</p>
<p><code>CnHongKe&#123;083d47de2c450f478870e468813&#125;</code></p>
<h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd ,invert</span><br><span class="line"><span class="keyword">import</span> os,random</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">flag = <span class="string">&#x27;flag&#123;*****&#125;&#x27;</span></span><br><span class="line">nbit = <span class="number">2048</span></span><br><span class="line">pbit = <span class="number">658</span></span><br><span class="line">qbit = nbit-pbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCRT</span>(<span class="params">mi, ai</span>):</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    curm, cura = mi[<span class="number">0</span>], ai[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi[<span class="number">1</span>:], ai[<span class="number">1</span>:]):</span><br><span class="line">        d = gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>)</span><br><span class="line">        K = c / d * invert(curm / d, m / d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m / d</span><br><span class="line">    <span class="keyword">return</span> (cura % curm, curm)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>():</span><br><span class="line">    p = getPrime(pbit)</span><br><span class="line">    q = getPrime(qbit)</span><br><span class="line">    <span class="keyword">assert</span>(gcd(p-<span class="number">1</span>,(q-<span class="number">1</span>)//<span class="number">2</span>) != <span class="number">1</span> <span class="keyword">and</span> q &gt;= <span class="built_in">int</span>(<span class="built_in">pow</span>(p*q,qbit//nbit)))</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        dp,dq = random.getrandbits(<span class="number">50</span>), getPrime(<span class="number">50</span>)</span><br><span class="line">        d = GCRT([p-<span class="number">1</span>,q-<span class="number">1</span>],[dp,dq])[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span>(gcd(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    e = invert(d,(p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> n,e</span><br><span class="line"></span><br><span class="line">n,e= genkey()</span><br><span class="line"></span><br><span class="line">flag = flag + os.urandom(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span>(flag&lt;n)</span><br><span class="line"><span class="built_in">print</span> n</span><br><span class="line"><span class="comment">#24520888125100345615044288264230762903878924272518571342713995342063192899124989891699091460914318368533612522321639660343147487234147817765379565866063142022911783047710228071012334390251457138278189863078398353697056081286846816500611712981402958876560909958985941278622099006464269427107124576069124593580390423932176305639686809675964840679026457045269910781753881177055233058940084858058581167930068081780478893848660425039669034700316924547379360271738374641525963541506226468912132334624110432284070298157810487695608530792082901545749959813831607311669250447276755584806773237811351439714525063949561215550447</span></span><br><span class="line"><span class="built_in">print</span> e</span><br><span class="line"><span class="comment">#11548167381567878954504039302995879760887384446160403678508673015926195316468675715911159300590761428446214638046840120602736300464514722774979925843178572277878822181099753174300465194145931556418080206026501299370963578262848611390583954955739032904548821443452579845787053497638128869038124506082956880448426261524733275521093477566421849134936014202472024600125629690903426235360356780817248587939756911284609010060687156927329496321413981116298392504514093379768896049697560475240887866765045884356249775891064190431436570827123388038801414013274666867432944085999838452709199063561463786334483612953109675470299</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="comment">#7903942109284616971177039757063852086984176476936099228234294937286044560458869922921692962367056335407203285911162833729143727236259599183118544731181209893499971239166798975272362502847869401536913310597050934868114362409772188138668288760287305966467890063175096408668396691058313701210130473560756912616590509776003076415730640467731466851294845080825312579944440742910769345079740436037310725065646739277834041891837233390010487460412084089630786396822488869754420904734966722826157548254882580507819654527378643632759059506306290252851428488883937359516531613654502801727220504711666666550673928496325962262842</span></span><br></pre></td></tr></table></figure>

<p>首先观察d的产生方式，而且p,q相差很大，想到了<a href="https://link.springer.com/content/pdf/10.1007/3-540-45708-9_16.pdf">Unbalanced RSA with Small CRT-Exponent Attack</a></p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/4.png"></p>
<p>这里讲了公私钥的产生方式，有个疑惑的点是<strong>论文里说了</strong>$p-1$和$\frac{q-1}{2}$<code>must be coprime</code>（互素），但是题目附件中</p>
<p>怎会是这样？</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/5.png"></p>
<p>网上找了个脚本<a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/index.html">RSA | Lazzaro (lazzzaro.github.io)</a></p>
<p>适用于$q(小的那个因子) &lt; N^{0.382}$，这里$\frac{qbit}{nbit}&#x3D; \frac{658}{2048}\approx0.32$</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">N=</span><br><span class="line">e=</span><br><span class="line"></span><br><span class="line">n = <span class="number">12</span>			    <span class="comment"># 或n=5</span></span><br><span class="line">beta = <span class="number">0.32</span>			<span class="comment"># beta = 0.3212890625</span></span><br><span class="line">delta = <span class="number">0.02</span>		<span class="comment"># delta = 0.0244140625</span></span><br><span class="line"></span><br><span class="line">X = <span class="built_in">int</span>(N ** delta*(n+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line">Y = <span class="built_in">int</span>(N ** (delta + beta)*(n+<span class="number">1</span>)/<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C</span>(<span class="params">a,b</span>):</span><br><span class="line">    ret=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(b):</span><br><span class="line">        ret*=(a-i)</span><br><span class="line">        ret/=(b-i)</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_Matrix</span>(<span class="params">n,m</span>):</span><br><span class="line">    MM=[[<span class="number">0</span> <span class="keyword">for</span> __ <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n): </span><br><span class="line">        pN=<span class="built_in">max</span>(<span class="number">0</span>,m-j)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(j+<span class="number">1</span>):</span><br><span class="line">            MM[j][i]=<span class="built_in">pow</span>(N,pN)*<span class="built_in">pow</span>(X,n-i-<span class="number">1</span>)*<span class="built_in">pow</span>(Y,i)*<span class="built_in">pow</span>(e,j-i)*C(j,i)*<span class="built_in">pow</span>(-<span class="number">1</span>,i)</span><br><span class="line">    MM=Matrix(ZZ,MM)</span><br><span class="line">    <span class="keyword">return</span> MM</span><br><span class="line"></span><br><span class="line">M=get_Matrix(n,n//<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line">L=M.LLL()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">x,y = var(<span class="string">&#x27;x&#x27;</span>),var(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">f=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    f+=x**(n-i-<span class="number">1</span>) * y**i * (L[i] // <span class="built_in">pow</span>(X,n-i-<span class="number">1</span>) // <span class="built_in">pow</span>(Y,i))<span class="comment">#将x,y参数化</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.factor())</span><br></pre></td></tr></table></figure>

<p>参数<code>beta</code>：$\beta &#x3D; \frac{qbit}{nbit} \approx 0.32$</p>
<p>参数<code>delta</code>：$\delta &#x3D; \frac{dp_bit}{nbit}&#x3D;\frac{50}{2048} \approx 0.02 $</p>
<p>参数<code>n</code>：n为格子的维度，大佬用下面的式子计算出n，对于本题来说，求得的n&#x3D;3.408695</p>
<p>但是实际用脚本的过程中，发现<code>n=4</code>并不能得到想要的结果，<code>n=5</code>可能是一个最低值</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">beta = </span><br><span class="line">delta = </span><br><span class="line">n = <span class="built_in">round</span>((<span class="number">1</span>-<span class="number">2</span>*beta-<span class="number">2</span>*delta)/((<span class="number">1</span>-beta)^<span class="number">2</span>-<span class="number">2</span>*delta-beta),<span class="number">6</span>)</span><br><span class="line">m = (<span class="number">1</span>-beta)*n</span><br><span class="line"><span class="built_in">print</span>(m,n)</span><br></pre></td></tr></table></figure>

<p>结果得到：</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">...(603601239605461619719962824215850028370828276194986402520006784945171666555162381560306067089554862768237542295127706223128204911327713581268000464342787657534895446276895456449104343518846054862311913534953258511*x + 1115967702502739*y)</span><br></pre></td></tr></table></figure>

<p>从后往前， 第一个是<code>dp</code>，第二个是<code>k</code></p>
<p>然后利用这两个式子求p</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/6.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">dp = </span><br><span class="line">k = </span><br><span class="line">n = </span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">k = k + <span class="number">1</span></span><br><span class="line">p = (e * dp - <span class="number">1</span>) // k + <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(p).bit_length())</span><br><span class="line">q = n // p</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(q).bit_length())</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#CnHongKe&#123;1b35037a-a472-4e9c-bdba-768f7e84dd0e&#125;</span></span><br></pre></td></tr></table></figure>

<p>根据$ed_p + k(p-1) &#x3D; 1 \longrightarrow p &#x3D; \frac{ed_p - 1}{k} + 1$</p>
<p>！！！但是，这题不知道为什么k要加上1</p>
<p>总之，理解不太透彻，只能当脚本小子了</p>
<h2 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p1, q1 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p1*q1</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p2, q2 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n2 = p2*q2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;<span class="built_in">pow</span>(m,e,n2)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;<span class="built_in">pow</span>(n1-m,e,n2)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1 = 52579135273678950581073020233998071974221658902576724000130040488018033110534210901239397446395736563148970863970460542205225993317478251099451639165369081820130823165642873594136020122857712288395352930384057524510346112486008850200845915783772351449146183974239444691330777565342525218070680067550270554767</span></span><br><span class="line"><span class="comment"># n2 = 68210568831848267339414957973218186686176324296418282565773310695862151827108036984694027795077376921170907068110296451176263520249799154781062517066423984526868547296781709439425857993705489037768605485740968600877866332458671029054092942851472208033494968784822459369206497698469167909174346042658361616469</span></span><br><span class="line"><span class="comment"># c1 = 42941712708129054668823891960764339394032538100909746015733801598044118605733969558717842106784388091495719003761324737091667431446354282990525549196642753967283958283202592037329821712755519455155110675327321252333824912095517427885925854391047828862338332559137577789387455868761466777370476884779752953853</span></span><br><span class="line"><span class="comment"># c2 = 62704043252861638895370674827559804184650708692227789532879941590038911799857232898692335429773480889624046167792573885125945511356456073688435911975161053231589019934427151230924004944847291434167067905803180207183209888082275583120633408232749119300200555327883719466349164062163459300518993952046873724005</span></span><br></pre></td></tr></table></figure>

<p>e太大了，对于Franklin攻击来说要跑很久，在其他师傅的指引下，了解了<strong>half-gcd</strong></p>
<p>参考：<a href="https://blog.csdn.net/EI_Captain/article/details/104777528">HALF-GCD算法的阐述_half gcd_Entropy Increaser的博客-CSDN博客</a></p>
<p><a href="https://www.cnblogs.com/whx1003/p/16217087.html">多项式 gcd 的正确姿势：Half-GCD 算法 - whx1003 - 博客园 (cnblogs.com)</a></p>
<p>脚本来源：<a href="https://github.com/rkm0959/rkm0959_implements/blob/main/Half_GCD/code.sage">rkm0959_implements&#x2F;Half_GCD&#x2F;code.sage at main · rkm0959&#x2F;rkm0959_implements (github.com)</a></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x^m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x^m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x^(m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line">sys.setrecursionlimit(<span class="number">500000</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = </span><br><span class="line">n2 = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">f = x^e - c1</span><br><span class="line">g = (n1 - x)^e - c2</span><br><span class="line"></span><br><span class="line">res = GCD(f,g)</span><br><span class="line"></span><br><span class="line">m = -res.monic().coefficients()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#CnHongKe&#123;Fr4nkl1n_R31ter_4nd_gcD&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>GCD(f,g)</code>返回$ax -bM$，$a,b$代表任意数字</p>
<p>用<code>monic()</code>使得上式变为$x-M$，再提取$M$</p>
<h1 id="复赛"><a href="#复赛" class="headerlink" title="复赛"></a>复赛</h1><h2 id="asr"><a href="#asr" class="headerlink" title="asr"></a>asr</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *              </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag              </span><br><span class="line">           </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genprime</span>():              </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:              </span><br><span class="line">        r = getRandomNBitInteger(<span class="number">64</span>)              </span><br><span class="line">        p = r**<span class="number">6</span> + <span class="number">8</span>*r**<span class="number">4</span> - <span class="number">41</span>*r**<span class="number">3</span> + <span class="number">14</span>*r**<span class="number">2</span> - <span class="number">116</span>*r + <span class="number">31387</span>              </span><br><span class="line">        q = r**<span class="number">5</span> - <span class="number">9</span>*r**<span class="number">4</span> + <span class="number">17</span>*r**<span class="number">3</span> - <span class="number">311</span>*r**<span class="number">2</span> - <span class="number">16</span>*r + <span class="number">14029</span>              </span><br><span class="line">        <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q):              </span><br><span class="line">            <span class="keyword">return</span> p, q              </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">flag, n</span>):              </span><br><span class="line">    m = bytes_to_long(flag)              </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(m, <span class="number">31387</span>, n)              </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = genprime()              </span><br><span class="line">n = p * q              </span><br><span class="line">c = enc(flag, n)              </span><br><span class="line"><span class="built_in">print</span>(n)              </span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<p>$\because p &#x3D; r^6+8r^4-41r^3+14r^2-116r+31387$</p>
<p>$q &#x3D; r^5 -9r^4 + 17r^3 - 311r^2-16r +14029$</p>
<p>$\therefore n &#x3D; r^{11} - 9r^{10} + 25r^9 - 424r^8 + 503r^7 + 10602r^6 + 45292r^5 - 175921r^4 - 5758r^3 - 9563095r^2 - 2129556r + 440328223$</p>
<p>把$n$开11次方，得到的$r’$会略大于或者略小于$r$</p>
<p>爆破一下</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2 </span><br><span class="line"></span><br><span class="line">n = <span class="number">73553176031506251642448229714220151174734540964434813056145000616720019024269982417494553771890010861489245572362590935764438928110836109730139595790550323300572059713433794357690270439325805603980903813396260703</span>                </span><br><span class="line">c = <span class="number">6035303231100318215656164353047198868742763055193754611914191674005776329646395050293747516587004104241717689072827492745628156828285466831779549229513115371571798719567117034735830671759951028004405762435531685</span>                </span><br><span class="line">e = <span class="number">31387</span>          </span><br><span class="line"></span><br><span class="line">r = gmpy2.iroot(n,<span class="number">11</span>)[<span class="number">0</span>]                </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):                </span><br><span class="line">    p = r**<span class="number">6</span> + <span class="number">8</span>*r**<span class="number">4</span> - <span class="number">41</span>*r**<span class="number">3</span> + <span class="number">14</span>*r**<span class="number">2</span> - <span class="number">116</span>*r + <span class="number">31387</span>                </span><br><span class="line">    q = r**<span class="number">5</span> - <span class="number">9</span>*r**<span class="number">4</span> + <span class="number">17</span>*r**<span class="number">3</span> - <span class="number">311</span>*r**<span class="number">2</span> - <span class="number">16</span>*r + <span class="number">14029</span>                </span><br><span class="line">    r = r+<span class="number">1</span>          </span><br><span class="line">    <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> n==p*q:                </span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))   </span><br><span class="line">        <span class="keyword">break</span>                          </span><br><span class="line"><span class="comment"># b&#x27;CnHongKe&#123;m0re_fuN_RSA!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>结果发现，只需要$r+1$就行了</p>
<p>脚本来源：<a href="https://mp.weixin.qq.com/s/8GOOfJm3jQb_mHChsucTSg">2023 江苏领航杯 (qq.com)</a></p>
<h2 id="ezrsa"><a href="#ezrsa" class="headerlink" title="ezrsa"></a>ezrsa</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *              </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert              </span><br><span class="line"><span class="comment">#from secret import flag,e              </span></span><br><span class="line">e=<span class="number">11299</span>              </span><br><span class="line">flag=<span class="string">&quot;CnHongKe&#123;xxxxx&#125;&quot;</span>              </span><br><span class="line">           </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">key, p</span>):              </span><br><span class="line">    e, n = key              </span><br><span class="line">    cipher = [<span class="built_in">pow</span>(<span class="built_in">ord</span>(char), e, n) <span class="keyword">for</span> char <span class="keyword">in</span> p]              </span><br><span class="line">    <span class="keyword">return</span> cipher              </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dec</span>(<span class="params">pk, c</span>):              </span><br><span class="line">    key, n = pk              </span><br><span class="line">    plain = [<span class="built_in">chr</span>(<span class="built_in">pow</span>(char, key, n)) <span class="keyword">for</span> char <span class="keyword">in</span> c]              </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plain)              </span><br><span class="line">p = getPrime(<span class="number">512</span>)              </span><br><span class="line">q = getPrime(<span class="number">512</span>)              </span><br><span class="line">n = p*q              </span><br><span class="line">pubkey = (e,n)              </span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(e &lt; <span class="number">20000</span>)              </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Public key:&quot;</span>)              </span><br><span class="line"><span class="built_in">print</span>(pubkey[<span class="number">1</span>])              </span><br><span class="line">cipher = (enc(pubkey, flag))              </span><br><span class="line">           </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encrypted flag:&quot;</span>)              </span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 72247494519029483967034760366376786853061601103300157813759661775953565912596351092287547406601293830981872918918938736057259213906558022493243888210973589378711150746378675386713286364059548872717761789465830532496818860955952848759604076974545518597370294034234115061042965941759696027120414108241913315823 </span></span><br><span class="line"><span class="string">c = [23086568633766027889700149282556028601873588133389538577048220777519629053893020835596785887647597774272630671514043075789089166339490664485821551265008072526985961605709337174865785620861795518368806256695564549352791382917399957127324333828822855864895189216581775972150143373812919138450624070271563605781, 61424780590998716668669522879005833894226611068988736111090847848564952203683192799647992306556603909310758923465682857752771528865725336620979965796403804180726836508128298963907214867637490978049881021200499605597084724400813056262536028860369819412653602159130062278358850923752212354694875260742761085298, 48972347185727309580275811398968322398732292284718613286033964656750569533816676490768122129969818200823106363038086076716848785261859085349544695714346759435389253954398744742706972731080540025437559712419376172012608552755595256980994587437212314607911439680754158685958213442852345610886117149808132016667, 61900034054386621130587335874165191153789670659043111868368913383427388843553828977951515166753531254554889530123861241679942156133394477844988559568261609121966239636746106844585498882352452796587012169345091313195906669668187972481122815780919799898784783071380231308771760678158462462371463688337980966056, 61424780590998716668669522879005833894226611068988736111090847848564952203683192799647992306556603909310758923465682857752771528865725336620979965796403804180726836508128298963907214867637490978049881021200499605597084724400813056262536028860369819412653602159130062278358850923752212354694875260742761085298, 9450415868171579852265098054119152648200942770623210086786809222084784959844945630371248180007508011953947300816820109987312423346559505226253550792399518771112488858163511513111841198409634670818742944088825363946933893952656072580401498319136121912520261916028145167846733858193149171599064970439268199783, 10035734578627344969947375235594072983851319696847209997368331158831147669149961069031833471519627366504594153020437204571060611428623914456969214997923532068856482468179965518854707629794312716955250557912419773434419097161023559262564458848063915219346903480654597328232422644596377103117825829328614075690, 5651041338136387965270707005514495599960051787842260459297309665876049923224924292148523058126335232362070965833156272480917510429785778533039914573874120321092901286353688478193761623313802721160582545556066963078690764669931722358118104123077318311422846797054759255064946480668759913078778113387444436772, 14271259146328702790695772784067429851163342737347538777950741762508946650827944617931146968866218980425939274541815935964077603794848153188731356254177631333208035026728310408767228380734867744475231330055609453484352384922899766458129175972076865172633564831188088602907146780176603278159798710852150155253, 62406194652765011605245085350409728452067228284594736543030951188813141827047471129688563874017873401654027493958313799538667190622125421268982329762449606129199279688989354341511243792985075002044026442461088633434402762089223231979549393979184803396697173744411798858018768084174805247172995100258785744206, 63709385155465577684045832627013714734477675077145869296144855691101040965871249828804609100346204070983371062590273336734564969020068052618256509773408613924173909751351554561064586129837540954337160904415625404892669592986127801019807989827319368290273765648256480872195493742292667971088647173453059033806, 48977318868316177241868377840886234518379318740788414464335149639789241373564334219732049732484152649864293157598629604567238775720288389168177046142209467079549232009426147052416900999957014084019576693027561825654624690272350264451017869825303585254430358271190141844081570800201723992346171314406386674943, 48977318868316177241868377840886234518379318740788414464335149639789241373564334219732049732484152649864293157598629604567238775720288389168177046142209467079549232009426147052416900999957014084019576693027561825654624690272350264451017869825303585254430358271190141844081570800201723992346171314406386674943, 565104133813638796527070700551449559996005178784226045,                </span></span><br><span class="line"><span class="string">9297309665876049923224924292148523058126335232362070965833156272480917510429785778533039914573874120321092901286353688478193761623313802721160582545556066963078690764669931722358118104123077318311422846797054759255064946480668759913078778113387444436772, 3956140276099962408524811644378665260926195324627931125735919417604617330787900581903522720016806707086965650313838135840992580442876605474811383818108244966337270671303251812771008272858935652243561913687651063565007930291142413707811828393424201379693530423289355865533076364121921469892110296393354892615, 64940238786056387401400208343541494710106569145648776253264921960848871998112873944735053044143142466740886274718484463159497520574083206269832189589919893550520334911490391957266450195041949757369417242568602992393025242097901450113737739057611554182495438506865992404354942119595468005771945393932589768474, 64940238786056387401400208343541494710106569145648776253264921960848871998112873944735053044143142466740886274718484463159497520574083206269832189589919893550520334911490391957266450195041949757369417242568602992393025242097901450113737739057611554182495438506865992404354942119595468005771945393932589768474, 26352444581944643830963227423429946980811236174292159142870560906116668786800921081108266494217634934060542948019867625299869944900083383044563948756655507024025376518773098977036898176798319228360435941463124583821154981070698271384027340432620539761424919238056654209894138660851835259359180413998571510866, 40143952866342512113851528831224840428508359508863486720333430314639020044892359484055175960350878532212164045297142804890441825145732613460997839927190176844605217276182528040788352071676527553305037569493706223713078036314819975031692707790811142576347096406283580538840499698900522007082050790381461432333, 3956140276099962408524811644378665260926195324627931125735919417604617330787900581903522720016806707086965650313838135840992580442876605474811383818108244966337270671303251812771008272858935652243561913687651063565007930291142413707811828393424201379693530423289355865533076364121921469892110296393354892615, 64940238786056387401400208343541494710106569145648776253264921960848871998112873944735053044143142466740886274718484463159497520574083206269832189589919893550520334911490391957266450195041949757369417242568602992393025242097901450113737739057611554182495438506865992404354942119595468005771945393932589768474, 63709385155465577684045832627013714734477675077145869296144855691101040965871249828804609100346204070983371062590273336734564969020068052618256509773408613924173909751351554561064586129837540954337160904415625404892669592986127801019807989827319368290273765648256480872195493742292667971088647173453059033806, 48888685774691755361314428123012470903274435407919121739086146641066936108772671897622273617773466901370666579985825990735116909193505734002962914749300893402294987407241465624548368394059300582991374404299605248595530416820237532082552535859877438232561386581747696852665114096889765422722443550622873560905, 48888685774691755361314428123012470903274435407919121739086146641066936108772671897622273617773466901370666579985825990735116909193505734002962914749300893402294987407241465624548368394059300582991374404299605248595530416820237532082552535859877438232561386581747696852665114096889765422722443550622873560905, 38583572018907364214647900005166742548285199585572254326541125387795789224923544225334386246655335740938100752554849888600258201438026409196139322439518308323982209353504064739859448757230608480631399883893401220790226127149746215151900805996489931009866529965548635227695192170717058032494324346363053930619, 64940238786056387401400208343541494710106569145648776253264921960848871998112873944735053044143142466740886274718484463159497520574083206269832189589919893550520334911490391957266450195041949757369417242568602992393025242097901450113737739057611554182495438506865992404354942119595468005771945393932589768474, 39561402760999624085248116443786652609261953246279311257359194176046173307879005819035227200168067070869656503,                </span></span><br><span class="line"><span class="string">13838135840992580442876605474811383818108244966337270671303251812771008272858935652243561913687651063565007930291142413707811828393424201379693530423289355865533076364121921469892110296393354892615, 64940238786056387401400208343541494710106569145648776253264921960848871998112873944735053044143142466740886274718484463159497520574083206269832189589919893550520334911490391957266450195041949757369417242568602992393025242097901450113737739057611554182495438506865992404354942119595468005771945393932589768474, 48977318868316177241868377840886234518379318740788414464335149639789241373564334219732049732484152649864293157598629604567238775720288389168177046142209467079549232009426147052416900999957014084019576693027561825654624690272350264451017869825303585254430358271190141844081570800201723992346171314406386674943, 5651041338136387965270707005514495599960051787842260459297309665876049923224924292148523058126335232362070965833156272480917510429785778533039914573874120321092901286353688478193761623313802721160582545556066963078690764669931722358118104123077318311422846797054759255064946480668759913078778113387444436772, 48977318868316177241868377840886234518379318740788414464335149639789241373564334219732049732484152649864293157598629604567238775720288389168177046142209467079549232009426147052416900999957014084019576693027561825654624690272350264451017869825303585254430358271190141844081570800201723992346171314406386674943, 63709385155465577684045832627013714734477675077145869296144855691101040965871249828804609100346204070983371062590273336734564969020068052618256509773408613924173909751351554561064586129837540954337160904415625404892669592986127801019807989827319368290273765648256480872195493742292667971088647173453059033806, 21643731734484252696109953515687478013118937715056061520976924340371395968660338303624558633862679263768843575243426341986847599097591917653435606042602095144570247241757302533523905744626606836773661026140082883368820615972739914083417816255913686820936373857254933361629603081613492930030281179652207492149, 48888685774691755361314428123012470903274435407919121739086146641066936108772671897622273617773466901370666579985825990735116909193505734002962914749300893402294987407241465624548368394059300582991374404299605248595530416820237532082552535859877438232561386581747696852665114096889765422722443550622873560905, 64940238786056387401400208343541494710106569145648776253264921960848871998112873944735053044143142466740886274718484463159497520574083206269832189589919893550520334911490391957266450195041949757369417242568602992393025242097901450113737739057611554182495438506865992404354942119595468005771945393932589768474, 40143952866342512113851528831224840428508359508863486720333430314639020044892359484055175960350878532212164045297142804890441825145732613460997839927190176844605217276182528040788352071676527553305037569493706223713078036314819975031692707790811142576347096406283580538840499698900522007082050790381461432333, 40143952866342512113851528831224840428508359508863486720333430314639020044892359484055175960350878532212164045297142804890441825145732613460997839927190176844605217276182528040788352071676527553305037569493706223713078036314819975031692707790811142576347096406283580538840499698900522007082050790381461432333, 63709385155465577684045832627013714734477675077145869296144855691101040965871249828804609100346204070983371062590273336734564969020068052618256509773408613924173909751351554561064586129837540954337160904415625404892669592986127801019807989827319368290273765648256480872195493742292667971088647173453059033806, 63709385155465577684045832627013714734477675077145869296144855691101040965871249828804609100346204070983371062590273336734564969020068052618256509773408613924173909751351554561064586129837540954337160904415625404892669592986127801019807989827319368290273765648256480872195493742292667971088647173453059033806, 395614027609996240852481164437866526092619532462793112573591941760461733078790058190352272001680670708696565031383813584099258044287660547481138381810824496633727067,                </span></span><br><span class="line"><span class="string">1303251812771008272858935652243561913687651063565007930291142413707811828393424201379693530423289355865533076364121921469892110296393354892615, 48977318868316177241868377840886234518379318740788414464335149639789241373564334219732049732484152649864293157598629604567238775720288389168177046142209467079549232009426147052416900999957014084019576693027561825654624690272350264451017869825303585254430358271190141844081570800201723992346171314406386674943, 20593313344992264722474643208232460904729585942331327945281307002575544045487870568637031063784433406096326172788745559326479291854636106027597680333110098010128235038952685620360851399518780967171732233524825381055879695801401425059095441692301391956163400460584139637380367489591078077440142620116997434358] </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>爆破就行了</p>
<p>这个$e$是不是不应该给出来的，出题人失误了吧，按理说应该通过第一个字母<code>C</code>，来得到$e$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">e = <span class="number">11299</span></span><br><span class="line">n =  </span><br><span class="line">c = [...]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(i,e,n) == c[j]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(i)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#CnHongKe&#123;a8cc755d375811f55cec82153388c&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="prng"><a href="#prng" class="headerlink" title="prng"></a>prng</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *              </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag              </span><br><span class="line"><span class="keyword">import</span> random              </span><br><span class="line">              </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base</span>(<span class="params">n, l</span>):              </span><br><span class="line">    bb = []              </span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:              </span><br><span class="line">        n, r = <span class="built_in">divmod</span>(n, l)              </span><br><span class="line">        bb.append(r)              </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(d) <span class="keyword">for</span> d <span class="keyword">in</span> bb[::-<span class="number">1</span>])              </span><br><span class="line">              </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prng</span>(<span class="params">secret</span>):                </span><br><span class="line">    seed = base(secret, <span class="number">5</span>)              </span><br><span class="line">    seed = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(seed)]              </span><br><span class="line">    length = <span class="built_in">len</span>(seed)              </span><br><span class="line">    R = [[ random.randint(<span class="number">0</span>,<span class="number">4</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length*<span class="number">2</span>)]              </span><br><span class="line">    S = []              </span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> R:              </span><br><span class="line">        s = <span class="number">0</span>              </span><br><span class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(length):              </span><br><span class="line">            s += (r[index] * seed[index]) % <span class="number">5</span>              </span><br><span class="line">        s %= <span class="number">5</span>              </span><br><span class="line">        S.append(s)              </span><br><span class="line">    <span class="keyword">return</span> R, S              </span><br><span class="line">        </span><br><span class="line">m = bytes_to_long(flag)              </span><br><span class="line">R, S = prng(m)              </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:              </span><br><span class="line">    f.write(<span class="string">f&#x27;R = <span class="subst">&#123;R&#125;</span>\nS = <span class="subst">&#123;S&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><code>divmod(n,l)</code>返回<code>(n // l,n % l)</code></p>
<p><code>base(n,l)</code>就是把n，写成l进制</p>
<p>分析代码知道</p>
<p>$S_1 &#x3D; (R_{1,1}\times seed_1 \mod 5) + …+(R_{1,n} \times seed_n \mod 5)$</p>
<p>$\dots$</p>
<p>$S_n &#x3D; (R_{n,1}\times seed_1 \mod 5) + …+(R_{n,n} \times seed_n \mod 5)$</p>
<p>$S_{n+1} &#x3D; (R_{n+1,1}\times seed_1 \mod 5) + …+(R_{n+1,n} \times seed_n \mod 5)$</p>
<p>$\dots$</p>
<p>$S_{2n} &#x3D; (R_{2n,1}\times seed_1 \mod 5) + …+(R_{2n,n} \times seed_n \mod 5)$</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/0.png"></p>
<p>上面代码自己生成数据</p>
<p>在<code>GF(5)</code>下解这个矩阵方程</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">R = [[] , ... , []]</span><br><span class="line">S = []</span><br><span class="line"></span><br><span class="line">r = Matrix(GF(<span class="number">5</span>),R)</span><br><span class="line">s = vector(GF(<span class="number">5</span>),S)</span><br><span class="line">seed = r.solve_right(s)</span><br><span class="line">m = <span class="built_in">list</span>(seed)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># flag=&quot;&quot;.join(map(str,m))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    flag += <span class="built_in">str</span>(i)</span><br><span class="line">    </span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># CnHongKe&#123;l1ne4r_prng_1s_d4ngr0s~~!d9uxdj9223&#125;</span></span><br></pre></td></tr></table></figure>

<p>感谢这位师傅提供的数据</p>
<p><a href="https://blog.csdn.net/Ahi0upsec/article/details/132717024?ydreferer=aHR0cHM6Ly9jbi5iaW5nLmNvbS8=">2023 江苏领航杯 misc密码wp_零上安全的博客-CSDN博客</a></p>
<h2 id="bd"><a href="#bd" class="headerlink" title="bd"></a>bd</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">d = getPrime(<span class="number">299</span>)</span><br><span class="line">e = inverse(d,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">hint1 = p &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line">hint2 = q &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint1 = <span class="subst">&#123;hint1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint2 = <span class="subst">&#123;hint2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 73337798113265277242402875272164983073482378701520700321577706460042584510776095519204866950129951930143711572581533177043149866218358557626070702546982947219557280493881836314492046745063916644418320245218549690820002504737756133747743286301499039227014032044403571945455215839074583290324966069724343874361</span></span><br><span class="line"><span class="string">e = 42681919079074901709680276679968298324860328305878264036188155781983964226653746568102282190906458519960811259171162918944726137301701132135900454469634110653076655027353831375989861927565774719655974876907429954299669710134188543166679161864800926130527741511760447090995444554722545165685959110788876766283</span></span><br><span class="line"><span class="string">c = 35616516401097721876690503261383371143934066789806504179229622323608172352486702183654617788750099596415052166506074598646146147151595929618406796332682042252530491640781065608144381326123387506000855818316664510273026302748073274714692374375426255513608075674924804166600192903250052744024508330641045908599</span></span><br><span class="line"><span class="string">hint1 = 740477612377832718425</span></span><br><span class="line"><span class="string">hint2 = 767891335159501447918</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>利用上高位的boneh_durfee攻击</p>
<p>参考一篇论文<a href="https://eprint.iacr.org/2023/367.pdf">367.pdf (iacr.org)</a></p>
<p>论文提到：</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/1.png"></p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/2.png"></p>
<p>对于1024bit的模，当$m&#x3D;7,t&#x3D;3$的时候，至少需要27位p的高位，才能成功</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time.clock = time.time</span><br><span class="line"> </span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># 如果晶格达到该尺寸，则停止移除</span></span><br><span class="line"><span class="comment"># 显示有用矢量的统计数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">	<span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示带有 0 和 X 的矩阵</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>: </span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="comment">#print (a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试删除无用的向量</span></span><br><span class="line"><span class="comment"># 从当前 = n-1（最后一个向量）开始</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># 我们从当前 = n-1（最后一个向量）开始</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 开始从后面检查</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment">#  如果它没有用</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">             <span class="comment"># 让我们检查它是否影响其他向量</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># 如果另一个向量受到影响：</span></span><br><span class="line">                <span class="comment"># 我们增加计数</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 等级：0</span></span><br><span class="line">            <span class="comment"># 如果没有其他载体最终受到影响</span></span><br><span class="line">            <span class="comment"># 我们删除它</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;* removing unhelpful vector&quot;, ii)</span></span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">           <span class="comment"># 等级：1</span></span><br><span class="line">            <span class="comment">#如果只有一个受到影响，我们会检查</span></span><br><span class="line">            <span class="comment"># 如果它正在影响别的向量</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># 如果它影响哪怕一个向量</span></span><br><span class="line">                    <span class="comment"># 我们放弃这个</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># 如果没有其他向量受到影响，则将其删除，并且</span></span><br><span class="line">                <span class="comment"># 这个有用的向量不够有用</span></span><br><span class="line">                <span class="comment">#与我们无用的相比</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="comment">#print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span></span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1，-1 如果 &quot;strict=true&quot;，并且行列式不受约束</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 在以下情况下找到解决方案：</span></span><br><span class="line"><span class="string">* d &lt; N^delta</span></span><br><span class="line"><span class="string">* |x|&lt; e^delta</span></span><br><span class="line"><span class="string">* |y|&lt; e^0.5</span></span><br><span class="line"><span class="string">每当 delta &lt; 1 - sqrt（2）/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)   <span class="comment">#多项式环</span></span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u)        <span class="comment">#  u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"> </span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># x-移位</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 单项式 x 移位列表</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials(): <span class="comment">#对于多项式中的单项式。单项式（）：</span></span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:  <span class="comment"># 如果单项不在单项中</span></span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># y-移位</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 单项式 y 移位列表</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 构造格 B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#约化格的原型</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment">#  #自动删除</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># 重置维度</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 检查向量是否有帮助</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 检查行列式是否正确界定</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#BB = BB.BKZ(block_size=25)</span></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 替换向量 i 和 j -&gt;多项式 1 和 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;在格中寻找线性无关向量&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 对于i and j, 构造两个多项式</span></span><br><span class="line"> </span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 结果</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example</span>():</span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># 随机生成数据</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line">    <span class="comment">#start_time =time.perf_counter</span></span><br><span class="line">    start =time.clock()</span><br><span class="line">    size=<span class="number">512</span></span><br><span class="line">    length_N = <span class="number">2</span>*size;</span><br><span class="line">    ss=<span class="number">0</span></span><br><span class="line">    s=<span class="number">70</span>;</span><br><span class="line">    M=<span class="number">1</span>   <span class="comment"># the number of experiments</span></span><br><span class="line">    delta = <span class="number">299</span>/<span class="number">1024</span></span><br><span class="line">    <span class="comment"># p =  random_prime(2^512,2^511)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M):</span><br><span class="line"><span class="comment">#         p =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         q =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         if(p&lt;q):</span></span><br><span class="line"><span class="comment">#             temp=p</span></span><br><span class="line"><span class="comment">#             p=q</span></span><br><span class="line"><span class="comment">#             q=temp</span></span><br><span class="line">        N = </span><br><span class="line">        e = </span><br><span class="line">        c = </span><br><span class="line">        hint1 =   <span class="comment"># p高位</span></span><br><span class="line">        hint2 =   <span class="comment"># q高位</span></span><br><span class="line"><span class="comment">#         print (&quot;p真实高&quot;,s,&quot;比特：&quot;, int(p/2^(512-s)))</span></span><br><span class="line"><span class="comment">#         print (&quot;q真实高&quot;,s,&quot;比特：&quot;, int(q/2^(512-s)))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#         N = p*q;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 解密指数d的指数( 最大0.292)</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        m = <span class="number">7</span>   <span class="comment"># 格大小（越大越好/越慢）</span></span><br><span class="line">        t = <span class="built_in">round</span>(((<span class="number">1</span>-<span class="number">2</span>*delta) * m))  <span class="comment"># 来自 Herrmann 和 May 的优化</span></span><br><span class="line">        X = floor(N^delta)  <span class="comment"># </span></span><br><span class="line">        Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>)/<span class="number">2</span>^s)    <span class="comment"># 如果 p、 q 大小相同，则正确</span></span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(hint1),<span class="built_in">int</span>(hint1)+<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n l=&#x27;</span>,l)</span><br><span class="line">            pM=l;</span><br><span class="line">            p0=pM*<span class="number">2</span>^(size-s)+<span class="number">2</span>^(size-s)-<span class="number">1</span>;</span><br><span class="line">            q0=N/p0;</span><br><span class="line">            qM=<span class="built_in">int</span>(q0/<span class="number">2</span>^(size-s))</span><br><span class="line">            A = N + <span class="number">1</span>-pM*<span class="number">2</span>^(size-s)-qM*<span class="number">2</span>^(size-s);</span><br><span class="line">        <span class="comment">#A = N+1</span></span><br><span class="line">            P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol = <span class="number">1</span> + x * (A + y)  <span class="comment">#构建的方程</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># Checking bounds</span></span><br><span class="line">            <span class="comment">#if debug:</span></span><br><span class="line">                <span class="comment">#print (&quot;=== 核对数据 ===&quot;)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta:&quot;, delta)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of e:&quot;, ceil(log(e)/log(2)))  # e的bit数</span></span><br><span class="line">                <span class="comment"># print (&quot;* size of N:&quot;, len(bin(N)))          # N的bit数</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of N:&quot;, ceil(log(N)/log(2)))  # N的bit数</span></span><br><span class="line">                <span class="comment">#print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># boneh_durfee</span></span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="comment">##print (&quot;=== running algorithm ===&quot;)</span></span><br><span class="line">                start_time = time.time()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;=== solution found ===&quot;)</span></span><br><span class="line">                <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"> </span><br><span class="line">                d_sol = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">                ss=ss+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;p的高比特为：&quot;</span>,l)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;q的高比特为：&quot;</span>,qM)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;d=&quot;</span>,d_sol) </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ss=&quot;</span>,ss)</span><br><span class="line">                            <span class="comment">#end=time.process_time</span></span><br><span class="line">        end=time.clock()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Running time: %s Seconds&#x27;</span>%(end-start))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()  </span><br></pre></td></tr></table></figure>

<p><code>d=783087701705468761679148299766995936398557044101882919430819055852416479930185217204358163</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">d = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#CnHongKe&#123;Y0u_m4d3_n3w_rec0rd!!!1113dsd2et&#125;</span></span><br></pre></td></tr></table></figure>

<p>另外一种解法参考：<a href="https://blog.csdn.net/Ahi0upsec/article/details/132717024?spm=1001.2014.3001.5502">2023 江苏领航杯 misc密码wp_零上安全的博客-CSDN博客</a></p>
<h1 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h1><p>星盟安全团队纳新！</p>
<p>欢迎师傅们加群（346014666）学习、讨论！</p>
<p><img src="/../../images/2023%E9%A2%86%E8%88%AA%E6%9D%AF/3.png"></p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>2023NewStarCTF</title>
    <url>/2023/09/25/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NewStarCTF2023/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误，请重试" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="8a45ce66faa06dee5f43f1d89511d3e54197b9acc4f810a833764fc02394f6a7">ee88741ea599eb54e0cde20fcde6e56c4263149f0c9e3eff7bcccbdeb4ba14219acdc895dabc509f2ccc2c403a03988b14f5b6677e66c2976128410bc483140fe2a4e50ae98e9a6a5ca6f8f7970e5fc164cf45e41d63117b49c23fc0563421c3c7a23a3826d2845bede9946d847ce7740d783b6c35aa3b51990db0081b81f3f96f5653a44fd0c7980e6b5582e0b8a1b7f559acc506d122e04671b50f5bcec4a6ccedabb6c827e6a61cc796612a4be48479fdea0c5ae8f710ceaee1ee9fcd505eeaa5ec1b5e1bd39e5591da17895b1eb3c2b51a6312dcaa2401bd08b2c2c9a6deefc2c283fda52507be459e897c1cca37dbe820a7016910b14c6da480d0121590e919faebc5c4d277ae6d6acd7e9ff9b639edbc3f0dc75756ddbb8e416aa861293483b8561e27fd224af375fc0579748ad3d435253862b8b7a856333798a7fc05d51cea1cce52dafa9b1a7c5914389c61df4ea787e0948765346742d1004832f67c15cf13d082fac41bcfceef1e2ea37b1fd7c78d60032d974bc2d4ebe96fd668919afec08249bcf0751d8beec47f642f08351b906154a31cf7ac29652a44bcfed29074748bfbadfb5087c65d6ea09e27656d6ee3b644f95d6cf4d2ad4b733220c32bac5c952647414265395e0356b82c3f560f5b250f9aa02dd7dba40de9bd19a9fec7417bc912ed76afee05a76b44786c8db14950119ae09f281796e5bc2f42ebf936efbc364efa057ccfec602c3e1a83a59dd8d3b9a7ac2ecb6b8efa123c0ca1fba749ff96deac8665652b44ea431305cd410741bfe646609fe7f001f4296b566fe401892c45acc0e7067a1d977c9321bb9c58de3a5129ae063f34214ced5aa35a9a8cddd4761430cb14d16c70edd3cc3c85b70bbc57ee5e6c3e01746b0c47f4a5e2eec62bdfa46bc856988ca01c7cfb8a9fc22efa1867b2f860a26820b70ea02482164a4b43a892fde3e81d0ac1cae8e9f8b91a37f5e4212cf716919166f219da8d1e8a94f9940d253246483194004a479edf53673f1339578a1eddf2c080677a6cde1f44c6b8a753dd605ec781eace2011b74bebeda7f1373744d4dd153077e76c4a17c34a4565b5cbc36d90d752763957ccb3f5082465854a4f06714286dbb6a656ec6b00bcd02d3c8375ebcb8f005fa61931ae56544d8b26c6319f21d0f549c7e0def1b526b5cc69cf754da8f25319f0257ee9022153097977ecadf9b0b9627947048d93d794cb147fd0ded794abf52d1280f47ee0e7997d2b9b833f885e9c003f34bb1d5ee38b9ba690d317380f4c7d1b34d458e1b9737287bd3746e76427d362711a3911a3475bbef4c1906e5eef7294cc0bab624d5e500ec3d4eb508049787bd7b46a2423ae63b87c588ab18a65c1c45cd7acd0cfd135270395bc8975390000dee179e46df3d323cd59b39a4d5b1f700bb4022c65c9384c70b55bb1cf4537f573f9d6a344e1400d003d46ed66028d6e756a0295e7ab4a2c644ac671e0a514d6c4cc0a80c97b73c8bbea9fd868eadc7365024115269486cf3ab2da3ac52c310333e258c668cbd7133e106b56a5c8e0aaac1249c48bfa157b11aa9c116bc8d806890d1db659bd9e2e6be77f81f7a347cb115f14cfc4092e4777f41b2f94610f32121d79f75af787fb2d4663acb8adcc5c1fb228ca5d4a246184af0b374a0e8ab889a49b7ce5d8c37c1ad5a0053208249f132e3d7f6134507908927232104a2b1bf960e5000d7dbdea344a0741f78c8e2d664b030f2661b2574d0c0eded7afcad19562cdb87fc4f92ba410c13e31c00b3d3879c8afb230161be9e458dc407f35393482e807aab7790ea993db82a6ffe358d3fb0a44fcd620701843f2270f3bdf25d367137974b75176fe532acfab44bd1f6166ebe34f10a896ec142b33701526baaaedc87bb6ba441c5861b01706d1ed6f273de446f181ed361e5a6f02199e007e9117e4bcf3e5b2e9598322648378a27217784bcfc5f5f4cb5e062623ca67e8599fe22a4cbbed0e0f69492959fc402e7b6f3692942646fb13be5f3dd98d1b3c9303e995d8ec2f96ac36a1b32cc94afafe0f2254d9c253f0df6f9cd19af3d947ca079f6f950ba3fb8e75741aa4c7b22871a8f477883d408bf9b0fa4a42e31441ecdfcf8b53bdd18aa7066d0fc7ccd209634e270e59cedb0c82e5fffc45a5bee76d6933c321a5e5fc5b625d906dab7bb3ae5de1fd5a433ecb91577c99de74477ea668d60dead83aa17fcd3d5dc20bbede78b88c0c99f7416cdea8dad8c1c158e93dc21b2d9642f72b19b405881c1b6af43b2a652778d6ed94cfeb069e069d04c2f3343c7bdc78cce4193ff8a37650fda30436151d4d28dedde18475364ba09b9f94cfe3162365c3e19534bd629764e205be48b484d149a65ee69783c138f860e150162cec0d085ce6d654a88a22176a08fd43f48ad1d3d93d9a6b6ccaf2fd0bdfe0f3730e22ac510dcabb0d89908807de7273968741d0bf380de903220dec02c977f4028559edb4ad8ff791de7e2dd9ccdb6ad92a146b939e07783d2f80d37e5434d7da16986d48f4f146380c2e2c0feac12a458d1751a84c4c197be28e6d5e1a769371bf368c3abf8449c791ae342ad733334bf999a66938405c3aa360eda5f9bc8a1d6016b69fac1b70b8b6298ca80a6387384090204167d95137b04d7589d33bf2cf964e30206d6428b14bf88b0effdea94e528e70bd48a8acab4a762da719e3f0b0e40b5c51eb66a889545ba44e0842a556403df011d78bd0a1942d2857956e484814596e2f7fcab0d501da6511e5d702598458614ad30329e8bb1ed7615c229d3bf98e4180da82bd63617153ee2f8bc7e110a9b079ca143033794125ad3a857fb190c799b524d34d9f87595540219d41a595862ad205cbdf06d2269fbfcf9dc2a1e46f557a49f959caec477ef5be211714ce579cb883c51823b7e35c86e1bc359b693e1a4448d831e2d1ddba6385d9ae4f2642d336d6bedf054668016217050b903cebfc2e3f37685b61ebb2145341a9b93ea86b90753d9d39c5dcf1cc9514d2406651d96169c36daccd207133e32f5a480e3b5275a9d3e59e10be97c90791b98750d1e9082311e2d01e0b57cd41533a04726035a26d0520593cc9432e46461d019b8a73325488ab5438301278e4fcc89b2bc6bd559891663f0a60a00bba0b4bd6ea385ce941fef1226131fac9641a5426fc55cfd2be83baadf62c7e718370394d8e998ca2d72223c5f9ed67fd3bcf23399eaebc9e73f647300f69770e2f27cb170da1aeb82d3e28b6d7972c07d81c05a3f9549f5c4a93cfc4a9f6dc46feddd2d627d3674134e2bdde8361833f1360fb07890fe8b5bf289abe3d482d62b32d6cd426a660b61a471a9d38840aa1600fd539a96b90841700705ec7053179373bc2c2de82a8368c103134de4a733f96f98e044bbcc0378ae1c35304e16331a60db1ff5bf86b86e90fea0e329bb009fb67409693cffc18015b0283d1142e7072026169bed264a15b29b61a424af8719efb1efeda6c18a299fde2ff26324279bf4416fbee6a331a152d94afc2db3f5165b79b4d67fa769db143fd8ba3c44eadf40e7dae76f88719c2fd6cfe643fe54281b7da55c0437c2c405127399061961a2cf09cd3786364df86577cdbc11c8044338db5aec856b70ccbd83475ccc09ef43a35de1eb83b8de8d899d8eb7c11c8738255d1896f7d4a65828c1528715afb963c3b89557585f63edfd4c9f7d4c1d63322def35c9947b39e8e16f052b42416f562673ce0ae811e9c0a4a3ae3ca95fd1fa067f1e174c6185ace554d71652ce9e1bff293113226405d6193aea21f487919a4f1268706e6d58c7e817ec885e54dbcae407f5f76e6a29a2cef94190056e96529980d9db5678aa900e78cf4fe8b841a218a19bcf068f02f52157bd6933367611ffa66a2a898f61d1c0a26fca61ffd6cfe8318b2b855a5ea73f936a76cd6d7c600b692880f5aa6bd312a86c838720f8a0eac2fe76c9b1e96ddcbde57f6a99a60aa00b6195d07bc47b4ea43521818c934b9b29b885b45c3bb2767a620c987e5332963b723a864270d2746157803c1247ab0127f8c7a4760c9e587e33baacae47ef933ae00bbbec51bdc18539a1778a5726efef672f6d584ab94ceacd29e3d89e45651b4bfb89df1c25e33ccdb580b2a6a7d3668b8bde592d828c9a0fdcaa76240a96cd805b3b39975c494d10dcfa66ab56245fe1ffbfed13ca70d0eee9d5faefa28168ad52969bc79cf931f3796a9df035769ef43d4dbbde4341b0bf1a57e3fadafab02ec7a9733ece5cf736ae2b437849876efc909bc6d7ef5c87165df2fc08858ef3792b17d1e427496535a1d4329984c043a7ca826c63ce75f332d5f20a785a3cf9a6768f70507b2857f5221787a5184a20d8ba833982e3c001b7e9438546e42de440cddc9e778bc59823e9a01e93596d7f5033935347212d6715f301f9d5f90bd80f104c40a0670bc57d28bf38db1176f5d148defa6075837cd1e09f124f946d92d2ae19ae7793b78db950067268255152e686982da46d37e1e0059beec371307e2b7a626828835e3d5789b88851715c0185e60d74cf416d7095072f095880cb3b0d66ab0c8e2ba6631b72f4233a2fe7a3e658d498c27b40d438737b59f8a9c249760ab56559bb11802ace586b3dff20468adadc96d44f23f6da42d9fe2cc073f8a414cb61df9e8bb148bd5e044192db5697539b8eb98da3d3b525232c9d77a187bbbb15ed5f0cbd489fcc486fe27b4b9179c1464b9e50141a16e1ce6d21496b31114922bbd7692ccf6a10a9d1920b944ed0c006fda282fa037bb0946b92baead12f17d07d0b8753d199e2750be6472c636188c8fad5916464422bc5b31f81329bef88045bea74efe0b62fdbc0cadefed272da631652cf2a8581499558c0aab05652f198799efcff893d7d418083affb7631c6a2ce9f1103054861209e524812cd254f51f4778ef961776ff2cbe56894ef358c7b226fcbc0ea78c14495c4c32ef9cf83084adbbc690a724b3354c7414e5da188df24d62755e52e8b08e5a4c25fc90544907da226177d168fde1b03d421e907e038d8175298fc470e02724f4a9b03608f381f45d63e35c98da02761bec6bcbb19e966be2c394dc0b4f2049c0fbccf6b2a63f550f242210cc969f7d2e7ccd4d3acc8fab00890f383f9684d3ce89b1890cc246a33542c79ef3f79565bb08fe7e55c2628c757a69ba293ca5fde152e8d9d85485ba2ad5f839ffa34046948ac06a116a184f36a20595fe78665d678f03e1d0873847811493c4a07deccbe1d70bbeb47e2842f3bc69af63e37e8aa87409e960a651d113a3cfe676c5d76a09eb2dc2d96cd4496f88f2260698a03668b2ba1901b138ec3fd747054e46423a1afcd420136e458b30affe61449101ee5e7ee424a5444458f7f4478eeaed2bc83e4ea84929b1acedd1fc4a91ab91c8e69fc84b352ad525d7662cf3946253baecfc7deebb49854fc7833fadf8cea11717da9f5ee58d977d61d185be9b0f7ea3bb772904c5cc40d7ea0d8fc6b68b6ab517c259b774d3cc318da0cb7a5faffdbbdf21400f5b2879f964bcfe25ae83dfeb72267a451b8936ce81ac43790f9e56ef760e8426b3efe635676f462ecbb5ff574f92fd8c6f7251a365dcb6ae6cd5d502e3e54a362776c5b86b170e60a2c28f13c7dcc15801791ba9633319d8f66cd3097ff21f218a3a05fc8adac1be80acdfe16c1fec6210214d60f466854fd9aba95923bd5d4fe72496d72652cbe38395cbc08de2a76d5e323b40b74ed2a0afac87167122d8622c799e0df3d7622546601438f04d071abcc7dd22e27dc5896c82dac2e89346c23f3225b0605cb6b65ddc3b501e3a233088a57ba462f9b0797ce096d86fa43cf14eff3f75de4ab3eb4d223f58051eae8c5f9c4fea34bc4060defd8972a4183842c2d4c850ed8f072c4b5df9d27ee48daa83b240246d62cc0fa128354ba38ba94cb96c3e26d2126a7fc7de4ed789e43a3da611fa2bac815e8c60d08ae4fed31f7e66805d451c7f2f77ec39c31d53864e1118474200432e8edd08f449483cef5d15cd352d08eb98420db316507137afbdd479b4befc339dab5adb3dc6d628b0f04681d1a35f6976cb69f2c69a76d3dedbaf1ace2c22f7d6f0b61bf8944d9a1e8564625bb01e490b082e9cde7c7e6099fa4e0b99f46e2c6af360ef7ed11f5e15d90a2bd8f66667ece92a16363126720febb48e5b5dcd3f0c20f40c33627cee90d08f2af1d5c551e072602bb7400a0e1c66c88bee854500eb9e2f043710c3b81af9327235433f2ea4f74912fe56ba23df742aa4662574fbddeb34d988a8243003caa607c685950691db676703fc90dd08514d7e0e10ac561d113ad572445a5e0f1d76791419d7b3733b9d995787e1c8ee32748f1ac8a173e8b108395ef9e1aeea36c3d00e8d812cc7e114b1be062865f368e6ded403342ba6624320cb635eb3a98c98440af5f34bb2192a479b8dbde3d92d0ce847e3c8abf65d9ffa7a65f58ab0a9520ea230d270cfb0675753208d99d2ab016bbc6836d575d2e9f02c07bcc3a97524cf752145b56f9d500e853d18bce0d1352f47fad8fd52a8273e0a39bc9d78f3b721d5c6cc49e89a1a1fea0800b871ec5dc96725caa51bfb3d6b06f6737a9e17f3620aaeef1018177483644a71135592f8b6c3452c3b58ff3e9b6d7e6b5876f858baf8d4dbfcf73fc5df229d7251bb99c18d5ab931eb66e39ad802343a856b83a67769c9b24e1d7b767023ce4cfce449de4040903157d2bd2551b2668a7fa6f06fdbf3a1f3aa833023c683f824f5ad0dafdbbdef7e92a1d0ebfacd54a441705e8a1bc67d45ed4bf292f22855c4aa17b9af38ff9f1663409e47eb1b31f8be0d07e989001494d610c512bc850962003b503ef36bf4431bc3c2f3f1a4cf53db833e86caa4cd840f4dbd979741e6124d8191e04b88856857503adc43f230d6c01eb2a2f45d8657c2ec456f2da6e2cb29fea49a88a56b13ff2a23fb472752d425a6fb38fa5ce6465d10787097f5d99a0068dcccdacf9576b1c2a77a6c2a7a6e6c517ff9af0f6d4cf1cdf7cc596076b76ccc7611e7b54e70c6a568998a6085622de8f54d54bd9604030e9088a287137c4d4f146efb2870f26eb94d476af356eae7dc0f07d43f22aa4468e8d64655d83b53efde2b073a39611a9a6b27ac48da36ba339113878fcf1947af6aa98d59221ecddfb9cb339b27e87c8b8f933adde9c02cb7de0d32b925e352c2fa19c61d20420a4f16d9374856477588464a12407e24aff60c894930a1ad31701941f6360e56d7798d78f3cb55ac5d38de7af1b7f78138ddc841369c4e2c235027032e09cf598490f08f8cd2e5a7aad3aec8d916f94104e0b97515b17abf7946f9419f1dec2be7790d6d37cacab58c2eed39df52984b344edccf28a6b82f96ac1da4e34fd55caa47ffea528b65d5b3ad3d7257cbc24756e8d26a6960973877a414b1cbdb800a6753584463d713fa1414ff70d672006cf7d1351addb094b1f429119294788d0f8dd9e8fb497e8c97978b91795d8eec1cdc67ee5d56b5c5f53afcb12878a815ef731e96c9d74010b59625180f3b53ddd31f753618414d632942a05ee15dee712d4d11cded74ce8bb431dbbafb15b3129871c058644b88ffbce53d6236ad3bff12a980f56103a2030e350e52ae0b78577fd6dddb45c75e553eba340e76fb2733582321e6d7ad88376d1386dbf8c2238070ce521a1a1419060e03ee69c068958cf3e7c4e1b379718ad68aa59541e45d12d102dea39c8f7e4a4156eb8e1141e924fae28bfee091e232b76ebd861eb0af21abf105a27868d118afce725fe89d84aa457a6d55c9dffa12266bc5bba08d99277f865804770817516cece3b411d35f569a3b09761df5718fb8b3197bbb828d5485ab4278a431503a80b67c70d5a6e9d40d3d055d4db3641b5b24d206f43880afc0d91c35ff6be28fd6293227b77dffce5f365528d371a684a5653f50990fc57502b5b68392ae8aeed7fd1c9653388b69dedb01ed64ce3c1287b705038e17bedb63e1cdca432221366158df23af794ef4be71bcb0b9e269d8feb9c6db7650eb4b827a7ed1678be92d3449b0f6fbd9680056bb1c2182fe2aa0fde8efb07f3c10a2c3d089d8624fe13d6df63fa6b69d07a27500c4c3c18bec003ec95fa30c0c779674bcb0c0ec3a569afea87502cab9bd75f49832d7c577b1c56d5ed4115656c2e3c6db6d155fa3f24733f1b8a5fca1b52d1dab694da3324b9a87d9d23f7610bf6a08475c7bbc4cbd1c400d4c73adb2104bc4fe7de14002a8d627417849cff1ff741af59bfd1bf68f66bf33b5941847e333293ed9b6ae7b027b5808c106606a9bbf87fea541239c5491aabd1a704aa99fe4fe0e8a695501981b08cfdbc92ab3030abe1939e4b7c5b0b3d5ec74e0f2e271ca8c06776d65428fc3e555427347c22a695f95da2cc9a3424d2ba367b5ee23bb2dbf6edfe4082092efe597be5b1926263127cc9d315312d3c3a809b64b1a35356cb6e5132836f18340391caf49dd86bc0cf00c5206a4f2a1cbccf52fdc71587298dcf1994706c374cf2f9913b4852cd1148980cae15cd06b215f6a8b389538db1e7e9005bbca4901780ce7fd00611f0fe8f03cf9a2be5e4a34e8f6396cd49a801facffa4b9126411192d958a39711d37e12ae2026a7cc65b4a2014dda37d5804bf1aa53d0132c4ba2e9c86c1c413821ac2c76fc721fdb9e1037e1d3f5e2632fbab085cd6c7962aeb5bfda9933c1ea624657119523d14074316ee4008617bf5c113d40c61d37cfd2a6b027b2295805c44c27747d4aaaf7c0eecab007ce52b53bfb48e10b17dd2fabb2871503b422c0b1ff7805f192bf5071838177cddac12e9b15fade6b1eebaaeba8cb5581c20494685fed68fc0b9c51c339d2390bee5be0a471a17f6bb8d37e56320fbf4dfa3f4505736c605df27ebd4f49644210fca7fa2370ef392da4b279cf60482bec4287e8132250360023bac89328143408c0d627aa358f3b4780a223454f27b5be6410872a3c2bc5e0a768fe560f05a0a8568e558421264c8fd2bcbbc52e29eb5dd4e4acd750aa9b76a6da2805b84e5b05f369f55c3b75682cb5952219868a0a68df15e616ae73de763878b2b555b746e2ab5502789d9a28be619aded3397b354730fa3bb34c0fd015bfe98a68afafaf0bb913d5e9240aeb703e12d3e0d0591096f0ab5b83b12845c03794a0552022575f67487371c6581e8c29382737d3ce1b17304ebcffe8c943093edd69a1d22e048e43bc10fe12ea04bb4d66723194a44d597ed9546c5b81035856bf384acba381787c1498819ceff858d3f9333d0ab704e8f9b8de27bf624a3b8cf8b674c1f80df9e7c81bbfffc87eb9baa7c3b6c7ab2d8869e814431996a4d158f5d667d21994020a38c1e09c6c3f1c5c72bd2fab8d0f099388ffdf6ff238dd5ad020ec4e2a11bbbf88048f50d1df9137137fdab0fa5cf5aafe2b0d40468cc51b14002ee3707645005381c023802179c4632760fb5cd7cc91202fbd6677b1106b16422d1e80b68bc432f1d932b70ef2f609771385d1f80cec76d4671ee6f21e29f9736307b3f64affcb85b061760e012c2d68ca6bd1e93bf6e9d2f4066c6fd72039cb74ffe06cad5f96ff094f1a5a9a95cebf4857e776f6825e41126f2c710651ddd2d6da9836fc8d9791fea737344f17711acf9b37381d91f7d4c884b2a0606c1fa6c0deaec349301e7d960c602312f34abfa99da850a9128f2cad616fc75757627b997735351b4b6f55d3d1a14cfe44543b84ea3a75f834660fbdd8a83bc73088cc4dce7f0af4a883c1325e37555fe0e189cfef52261f326f78bb586eb77329cc37c46d6f60f57a8e924fc0c0e87b9e6581f75a547558553db139d1e397933c6ef8d1b1b78ead31dcaa41ae9ffbab11971749324ee913ef8ecaa892bee060705ab0cb90caa2574d6af098099fd07ffef26b5402600f44f004c35f023fcda11b89312897d0198700a8608a8990180b04cc13286c955b96e8287dde5909a08f9276b54f47a722bcc6d2c55f81f384bf16df1d0e6ae2d9e332ee73199452d60daee16e572550cf805737e66e914a9ddb0bdc8ea4456ce3f33500e0b39a5e122e94768904ef6f7bad1b1bdb60f89c543c3f0f75c9460040224e6cef5ecc21f4c1c2b15c2f07c4019c15b70e6ea5f1b01e1445e66a41996f0bcc787cb2b59a6f6101f6a40f58d6be36b62e82bc34c8daece8c765ac80b8f12af39e4e125da0810dc362b116cfcdbdf8023eb8b581529ae155ff85653b5ad75685fe87c09b639c2c6246269fe362dd8c3cc2792028264a43347916fd83badfa9f9698b20ae2606f63f9631215404935cf77f5d48461cb15345797366f99d127153ab8a8ce3c8c33b70575b3c586548576ae8946e92f3d17e633084cc0515bb45673126ae939bbf3761e6fb7ede48e7edc6fcfd0b31ec72e8226d7b6dd1c4219bf241879f0d9b35ffad87a74c8b31e789c93512fd48b2d96b5806c7c71227e9960a5930f086b3756eecd21e3146d2dc951346942cb649ac45e3ffc5763adc85e49dbae484beeed169f65c5a4fb4847a157674e6e13fb89a89b0feda88d138f0f9223a6ee4350542ade5f82882f72d09bc55a107fd05aa7babd9a78a579a8c6af954fd46c847e39f59e308dbb6e1e87356d654f1614a26c13812a9aff4d4df54d17115407b5515e7ae25de86109640fa69db1a9e7fdb27fe8d7aa68ef0eeb979162b1aeff899759e6ed80fd78d084f7e9201dd3670156764c10d0b0a56bacf91c3468d40a5aa73f1608e860bd0d1013bf021888fc8dc70255d02c858fd4969d883c2c5b9571ee44eb0f6c36ebf5a9d54902f57acfb77066268f230f218e5f71cfb2603817c33df05023f411404b47162501e3c75b067345e3eecc1624766f93c82d8891950a27973424b1b7748993d91df2fd7b176028a00ae1b862aedf366c379c0c3cca7f46353c97de3a930baeda6d706086382db895a121094261a2328dad56e02287b1cbb5325a3f992f114bc90a85e03bd5a6e51a983418566a1a422a749d74701ccacc5457101b2cb0768330543cb5595a4557a43a4215d69eed02d997eaa05fac6d07b8393c1c551e32c4a67cf95f05558f63e0b6a9eebd10cba44efd4ba2a3fe09f5ac5af0abbe9cb1fd0a138c54c9a825e3503d99c0eeca6155ce1a394672c5580e8c78b96b328f6705329b358fd434280e904bde7364aaf19beab8ab173448b3e7a76a7ec113588c541c0aa777f54764b1f7008910ab7c93f9493f9f6e2fd8530de9eeb17ce48170219899e83ada8d76e35300f59654b04135e8d55f35aecb7a98070f44ffb009ed5d158e007b17178370fe3bf70b6142db29bcabea90bdc802e1d9c3160b9e864188cab717b5e499f070b17bd61859f8099562b98038b42132a60dbc94fc7428c12a56422ef9e4c84dfd4691663654d218fee80b4bb27716bda47dc205a23dd313763230380acb569d5451da93ed1443265d1007f7aa17e87c50320e7d73804486b8d8a6c127ace5afacbffa31a5c2524eddd29f5e920a74705017a217d780a765c1b3b031075e088c2113ac12cda1dd95dd1ae9b58934c3366aa290c02b92e3cb576410e127c04fdf9abf7e71e3d6eb7259b67980cc12d5b07c9434e88bc2ec3375c6bbbf0b549be849972aa85ffa6c9fd697e0ef3566af2fbef08c9236550ab64c593977ca5f871d036159a98a55947d4ea6e56bf316a5c14eacc4366fa15be31b3520f7118c969cbcb59073fa83aa869e51cd86928e9cd8972e86895a26a5b59ce01b1ad9c72fcf89a90b6699996d311c09086bb4f40cebf5d018f025ddb82c4ddec2c6738220efd89b9a1c4419c677a6bbe2537a23b1d22850d4bb8b430a6fae36100706ca10580de6e38871cdd106fe08a66b2a30b4312a28e07b99c5d2a601215972b0cd58adcdb8b7c832df8cd753fb6ea1552ea365159da44b973cdedb2ea46d52e42aac3036c5dc165647a8dc15e90a2dd373615884970d00a2c5be963a6a2a1cf69cff7ce1c373a852ace53eebf24b1ce11f0e4c7f4969ffd30b399d88986e0214d9d8177bdc92d47b0aaf273294939d16f0aee7ed66bbf98f6ba5918d99398a2faa9881936fc9553ef447c2dd62893186e2aca043f438cf5364dd78e2efa3d3189a688efc32a466655be70049d5a65ed2147c54f3418c18dc1402def57d3373ef88f7adb4380b67858c60d59fb75acd32b2eed4f52a4139ae81af65803f3b635426b08ad54e73f71aacb0f2b9b3cb80a213089f302931a95b0e0041868480744e002e6d5768a3918ab2ce413d5fba3963aeb8d9c4f3f8154483e82dd4c6584da6f205b5c64da9141c60b1be74168d018e309b9e7f9a894841cfc74ea89e497c22244535f31fd24ed1282c79f42e8ce1ea04bb2cf9d8ffa6629185d20cb6ecd5c1944fb02e283a7b1007dddd21c69933e87886f09879f630dec574a7d800d86886af31715f5e80483aa6ae249c7b9f71c72ec78eaf83925817d67cab96ef91d2a7aa7abf2c0a2e5a8be5d9c9cd2264afa8edcf9f661a503eb359360c040eec29b486bc853ce82eefc88960f18728d7e52455d855d1b0a61a8196e65f56b19d8b64f1a5a14a97ef25fae83ad73829582e07c4ce7cf48faef0c113005731bf30bd2e2357671992c72c1e31622b4c5367e6d6e0167503fee105966c97df40aef6761b83a73664c9eaa903441cba3e3df415163b249865d2b4ff9e75e9be1338ff2a1b682a47f4cefd978897588684c956266a18a26a61c67aef331015ea583c1c8f1dbb34f6d0f0097636b1befcc9e590ddd111b94cebae0a6b3c1812c784fc2c18015a54df57c16167ad12d71c708a3fc5f23992751f7d40735b1a16dcd5839d61ee6b89c3fbfa247a833ce191d3a070080aad839a00335c3877361b45bf306aad3228b0b8571b89def2cb8fd4d19207fb6fb005bebb4d51bdf1afb5ac9afe31e0371eb46a9334b04eaebbb48259eaabad01b675b627a62326bba27333b77daf85ed40f8dc9e618d41900f1fba49898904fa1f80e2cfc8bef8672cedcff46e60b14488ffd7adabaa3a0372884918b8a070d765c57fc6320120b86d960e9fdb605d82bb38d656facf3cb4c34e19ac83586b1c213d14de5049ca23f0547435b4e3ab539f3a9d465e7db467ddc7f49e767603e64050c52355844edbcf0ede1b45f01483b65b3d78f947634a0be0c0feb47525609ffaee62784bec826233bf9b3202678ce81c9320a136ef5f8948a4e9c1f2dbd7634a40d784cae46e11cd7d0b97a20c3f7c3edb80f376f0c382c00dc02adb937061f44f575e773117fdbd4c557e318d681e2b8d18980bb1e544e3057257f51c08f0bd4bb69573c881d1c24f65dc0ee5df857bb317e807028cadab1d7f8c597da67987a7f0cdc7bce6dbe83dbeb169224683fd57e998b0b8f7b18636e457eab398144364904a91b95540c09fee07c0f90e88a223a978e96e6c3f5a73115dec1d2d12125f3e8acb5cf068d1a7aef0f72a394904a8aaf70b129f02fc54d4a1e4860873c7941b82e65427b5c33e7fa1fdcdc598397986bb4236ef95fa96e7cf183b1c659d3a34ecb5d84893f450604321a73483eace04827074b3fcc75b98a40c924fa255eb392ff33cf521e8ebf957a9143a9037d031f25ea9f95f96d084ac257a2bfe88481b98a77b7e5bc8edd623e254678f8b54692b812a6fe873e4957837ee34dbea021e0a5f96a7d497af1ad3e9731061b019611837956785b26c24ab84e2bb9af9595461843091b808a9e2ae8b63fbb4cab3b782267f5b8dc691ecdd8de002cbcc2278f589413b7a82fd853ad3f76f35885462d4856c9dffba0b6d65273f2651a14b86261d6f1dd898ad5cc7585b55079efc3849e3a4b660e4967cdfe270a199fd8bbfa43d4a4f07d6768dcf919ad84d423859aae94ccfad746039329a0e07974d27d755fab971f633497c451f3a844477e842a71892c3f02a358e7174ec405b0d6368926a365722c8020da9a2ab47a830ebf1394a818d336ad8b2f5c6d89a1388e5d6bb498ee33aeccc2ed52904bbebb872aea2e0ba85b11bb154bab4e5423d027122e557f8bdcf2ad9c43db0dc4973718e565b7d1dd14a6144c65548a290c3dc8c976d314a46cb4714e12fa11d0d31ec57c50ea4e3070a7755b0eea0208d408639dfd29e1cb8cf596e2fbbba03bdcb3e9e7adbccd969187aad60b98e263a9498088866e6c7444ad76e4277597a0f5f336b75d181c45fe64da3c4a9123e8219a482ab999e25039572e444bfeedd50d9317014d70cd544d91b0e5c4005ee430e06aa6d0af2e4132d30dc3d24c9d4826e9cfeb216c4db5136df8bada395e66c831a3cbe54b70cc3ea114cfb801b60bc8172e952b0db11cdac0545e49255c85baf0f2063bc27bb7ea2890dd46bb250f006f60d62498bbc1f97960fd92cd0478c8ef9fd101bb7fb8df95d765484e9d79a7a044f9f0fb94622aed6f1ce973c8ba4f22d34d3acb3595efae7e37ae18723bfbe9da1a87d98315d279869d58ce1eebaae849b7faa0c59c93d08d613811fc1042cc2b1c4658ee0c06cf3991c123668b9a8234a125aed1aa1704f389e8f67d081bca7fb24e73b742b09170bbb0350d8b3898a05cea75b57328e0b4d5214a96e90705f06b7c1c7eebfbcee706847960f43c5ec765dca183fb88c0486f5c6e369986686d81148365eee218dca458a9fb29c1a32c237ec67ea4cc94b2bcd446773564ca8972a81631e8e3081e33533aa0fe587f1d396b7ac6294dab6cb91d885edb8eccc8337acd62d4f5274bbd1d87e4359b7d97aac95349c36f12097880671db5beee71b231dbac8e98d87fa5ac53b6ba2791df85e59485b82cbdce74a1b3c20c12f154f773b305839e41b121bccb7ea1a1e36ec779f6cc4ef823aa76e5bf46b2377c366866ac1ee4324a83ca5522cab4ff5c155c3c113c5b6745a042a62286234700500ff95f757333a2d19b0a3ab7b71f6cbff52165ad4e34be7590abb5dd5a674e33961ee7450d73bc12d8ce9a036f11e2804ae8060180a9c7964d6076c80b6a212506bb1ab28d393ba6e8c9bf59b6aad56339d81a2a1716cd15a8e58af5aacdca859843826f0eca67a5e083d7fae617e1e9933aa035cac0a0be9196ba4b0504829fac7ef6fe43fe1c291c136449e37f1084b809468877485e78c74b20465e38934f351dbf7542335c76554eb6e6533e4dd04d69ac51e6aede9d50a94522f1b3849719554450f277ced2e9e82fc8c8eecaea7cfff2be9f01155f4896ae06cb42806938676ff09e02b7ed967d8e07b053c2a99940f85d406c0db1dc75b6c6f5843e7bb1920c5b8a27fe2654bc1946a94af02b0a37f8ea043d4300e19d7aea10841cb35a6f3dd39831e1ed05e062427e47396475ea4a2e52b0acd5bf8a7dcee161b6ca3d151b85b93508d2e4b9c13137477ffc5e6497660c5608a2f67972ba4cf8581cae04063f1bee8e2df9fd3e79a0273ab20c572637330a8f7e4656a6576bcf261e0ad42e4008490549860b35ae4b7a72399f194a4aec165f5203f147bf362ff414d15adfd6cd37be8855f5a3b8955e622020d2a11426af4a9fd1456b9cb3789e5ccdd95d8c62ed6a572a62e700ec6581fa411a95058bb9cd741346514d7d967214a39ff146e7a2f6f9cf0d8b43bf6a24b862548252633d613f6df10bf771955c806c36942c9d1dc786b1e843e03f0ad50dd7b308a6d690c47814670fa48a27734d90efb569f704ef7c14358fdb8249df7ee61b3650bf19066306c998d114a761266bd1d7e33cb886ed7d0f7b69b5eb854c365b2ac4756d84242f86e11055af5410ffe77d8c8d806c44a20e73e555a52694a5c986b42363c50949737354c9cfb5bc4c61c173fdf1d248b55eec49aaae2e087f4cdd07dddb094efdf33531c08626c756e2eea18a8ad11f595f41f0a54ec68ea8e7721a7010dbc32a6b7301a7da4af9fd1c9be15d85f87824ec2b5cbbe421d3eb90da33c829d20cd7b2971d205c0762c32d6e354a03fc4af012aef5e63ae8ee59b15c81cd055029f4c20dfd3c6e77c7547601788e81549854900447e40e42ca82b6d952d9b642c925b8bb7752e7010ab53b1b91854444bc648e58ced19cad8999f5403c589c87e196495b95660446f8c5d02909f3e572207da877e6dcb3c413bc4bd5ef99ca36dfb7ecc5cbfd85b224e36782b5ca856551272167fb26fe20361eff1391448fd689401f4e54f7bcda048ff53e3d314978ffe306269bd9d8aa2c28f8ef0a34e35a438b9225992c601ccead1acc8ff77d053870ec5493f9266b70cc95b3ff7341b0e74833f14a0a714889e53949d8c79d021245df21376bfb8399399562c144b6cf95a74bfc2cd1f6e2e0263ed3ddbb3ae81dcc1e0066d5663ac744227af0c1105a635355c733d903a31439b4cf0ec72a11e10132966a064589e8ac90feaa472945fe4f6c910ca7cd4b09be61572a1317a38d8cfe19dcbfe29e6b75c9672a0c33e56c4c30b0a2be68f62af967cba0fe38ef80ead76eaab51526542b93f52c7641e9d4cd0a7aeaad4e6fc87ed395801758ea1ab662f9b1613f6c59cde9b86215cb89915d3aa3276eda3b26b0349dcb0297519bbea8291eb2ce4e72c0c08895d8104402c9959528ce119a1b0e8b313f0e8ee9b8caf9493b4ca4e74dd8ecd2eb667c975e99ee62847b1ca8be9168d6bed2c854f022aac75cc18d5be8b9141d189fd029486192f6c58962478d44e899cb3dfef791a373c6311c29f8b09322443689b86e450e2db109449ced3ab5709abf1ec9cfadf6213a79dabcc9aa69aa781f9e24d2f4ea3d31840e27668bd79da50a9c79b4b592e7a3555ec2088f57351ada4068665904f6cb491583b94d0d9cbaa671a2a61f10e6503d815e8d7200a4710b0d1bda139c9481719a6c5db9f408b6aa151ff41316f84e3d5b68fd9f3044eb74fe1d58353a21655f9a9432257e7ee4eafdf37a6c8a7f66fedd81f976b749bc33e5e48add0a239b75c0d5c2a61d6fa5fe067ec1110580fa36eff9af69d25461e521298ac4351866c498f12ece62acd71f297bfda3c8c76df65b31b5e1778daafe366ff83788e411efd98dca420ff4a53b582c3d263d458b3d414c27315a169d51cfb79d736558125340ad076f60576ced9f711edd19d5dc3de9fdedd734774cecad3d79ada17c36ad6b070972d5a9400f36caca4d8a40d100784b46b4962f9bb494149a0748604d37b67e308bdba10c016fb8514623217e8c991897dd45fc8ce402458d6eaedb203bd8a25e9436873599d34cc4299a820f92fad716eb8c4db92ab9bc02e8a351f77196b17192e24a232dba06c35d55e9c6ab458fab28eeee53bbd113c190a13a8bfdc5ee834d50ec3dfaf973420fe4d9107f929e65a291ff8b1bfcad9ef277ad416de52b7d560d6d2f2aae3951c005f591dcff33e540cd44e6adbcdb5e71f68247d468f553054e6d41b6c2f0d8cc02dbe414228bd533a502e010f99dc907e6cd9d7ef6e22fa8d2cfc72fa132ba5e734ae28785a6462db9dfe8dbc84403cc32900a1288130e0d289838e11c033b24aa4bdf9565a85094c38791d66340437ac67aad95407a835cb4f56b5f140287a8dcc1743307f201fd0f55fec31a804134ab43e4a522e97c23c3b94338598edcba7be39e9bab85de6d9dcde701cda1095c8cf6f97db60cf5650b53ae16e74c6171d87bd34c7074e31ba4d4ad2df9cefe788c6c873bbe45852933201bc1deb4d66adf185770ec8f10b2e78d159b6543621299ab1b3162e9c61b381da19bf742ed4962fb3258466d2ca7e44f5912ed0f399cab3555674c3640ee63e9850582bebaf95573d6ab7d9e04843704d977dd1e44b2fc650892752e1b23a6cdb08cd65f80f52e0bdbe3477cbba6e0865cd1894d6c15be23f03c110a1064a756f997f0c0b51229b486a422513e9c256cb23664fa7fe72d9c4e93bcf1ba9cc60d481cda4062d60d5d78ff2f2b21f631d4e5a3122f28ec25a4f17b6f8250ad0da5820c56a27af44ba854194b6312acff6b805333a55c9bb15fa0b2721cdb6a76ac0259fd2196fe67c58d1f2b5b0608dd9ca620326bba681b885252ebbcb7d04f1ab4627c6486225777748a1a457328c68a342a0207def7e85692a01e8b0f5beed7c28f63e914cd2fffa195c4b0734eda8cd335591dc5fadcfd5dfe297c1ad85bc135f4d44163bce8f1785dd4a8238e1dc1bb5e1710287a376c7444199097aec88489a77043ea15639895c612e5d960f303643ceb90b3196f1e8cdfaefbda74d4275d83916dd2840a5af6a68c103bbeef016a8dd07909c3e4a16e8008b49b1b7b367da0975041424adf58dfc5c5b295dcd9b0ae1b9144a26eb2e24391849f2a2932d565f394ef38cb9482ea9d31448ab4eb7d4312607fda69bb2be822a4ead72b9bb45306c915b1bdfd1561e5528bba3cb547ef323d29e7b14ca1187e3666d39007cdf78aa9da72c4b766e1a0239505668b7674917e8ca5b22736209962e8d6623c4700834edda5de23864226d35d40388368c5e54262402e644dafbe6639ba606daa8421bffad62e1b185fccb2ca05552a8b09109d3fa6c3af1a23a8013eebc47cbfc8cb1b2ddb0b7d1747617171f0812def3176c56437566fc16355b7ca818a3c14c130d5dd32c96cd899cdda8f5a7591de657411c40be6bc21990e5dd3fd7f554530e16b9907d8a04795f7ab1f81c108f6656914e8507b78ec10f3479906b40241d6168ec21283f297304f0254900a8a53d41e4138281640a69dc0ac37af330c0b067cba29a9dba95fa4b73acedf2c516fb302c199884f7f7a8a154dc169224b89874cc1c9492f9499124b4a42e2e9776fc845e3acbf1060daeb9b95fb9d8982e6e35309caed00579196daded921b9da99186c74c5f83a01a34d8767f60ae597885ccd585810bb8cc4ea50a8fe56cc0c83ff3dbe068085848e0c6d9dfd80e12aba8d5f7bafcd3b6c400d266f8023ca7f7a95a9ae432baa6db37f8944c119e36d8eadfa9382f4480ab2661c612ae96aba75b03d6ed9987434d2ad646da4142e43f09045335971ea9e1a203069e556211246bd11cf9f77efa81e48f2a94bd3d3e9a119a0d1e01430c8b11336c03d010801fb05895bb74deac9b2d550bb65eee696db0a9b779c3338316cb7cdd2489dd6f265cfe4d8718e416b6cdb0a74a82c8dac48faa4aa36e238095ee74f381384aa29e9792dedad3734d7d5a5f9222c8b33e737be754389932208bc11b27f3b4e653b18f82a6d9a4993304157ad9615b50ddd7226bcbab75e764844e68641b3ef06d94625c812f4fe198ad3e567cbe243cd7ccc4adf824e545f193d6d4ce1a9a5c0a0e8cebb089e7cec0f458a8ff24aca151b644b43638bfbbadbea09baf911a6b41a3a3c32f6c1b3245ee391f8259a8ef6a45893be122fe376dc0c07a2f59e01f883ebab856e6f2d2f4f8e863d758581613232229a5acdb606a7ddd2c44cab6df6ba93e47abfad3e979e6993b41375d25c54a9aa89e9ecd108985ea4ce6deefd70e9c1d222fc331d3100c3b11eebff08bae746fbaaeb33a5bb6251822955ebb1aa3011a2c91a6e2a61d1da23f6d26607fcc4098e4ec1acaddbfc5ba860e40cdeea4f6d07beaecf503b684ed2c0466fd00cf77c36f00ffa1474ccae48bdf509329796b707b40cd32a8ed14a03073c701247c5ff1cdf1a66e08fd7a2bd198c96f2aec2dbd04b973088d1bce1ba523972e907a402c8f33c610afdcd1b53cf98c6f821b06fc33d7008851d2c0bc2e3a93b9ff4b8d4c3851e3c004148aaa702670c3590ee19b104a8bf8b0ecb34fe4b8168832009a6fc2e3023e27ba05c6fb326434a715a446a323940dee809fd6a95c162ee1dbfb72832c2d6832397a72cf5af569f4cc275722f7dbde6c97cef370f1a14a877bb33ef797332ba85f8f0e9b20006424525976d227cb4177e00ed9329f8385183392c40824cdf71bf0b9ce4bb25b0ac78c3ac82fd6a7f8ef453dec14e5b44ac3718801de9cbeb107c1099fb95fa87e8aa113bda348157ff227e94bcd36a6367eb81e66526f88b2b381e63f8f0eb73897905f7ce65bcb54ccbc2ef336168a3c340dacc94e8de896fdc122a7cb7b7c7a23746d68ea485b0a953ae33ecdb7bcd71deda5b7651436640aca6785eb366e670379f528ffdb22766fa7daf19e51e4c72b61654aca07f5c14532bbb435b26316e7406fa11eeadb4daab26d9b78f0ed21bd16fc18de7a678cd658220de551fc8c40a72d3fc6080ece6f6cc206265ca309fbba4c764924b0771ada59e4255cb7fd070dd65f146c8e66c78c5d9ac3a836919cb8b6276576261f27df58f512965c0b2f7a6fecff44ef15eb2be0872c88dfbb8b8b7df89d068121aa0e4a54a979566924c53d2a14a13465fba26d318d6869993f4b324e71b4583b8013e42138d2dcd9116a997380f30fdec1fa018438a839c45d480f0b6a1b38b1cd0c0e89cef97cd78c3e1d6a4492eb50cc42a80611f7129f02b5da743c94604ef6dac63cbb83d81190e20e4cbd707e4f15b25bb49532d6872fcbcc70b8d00653354cc1a7b8a4038f36fdfde5b73f608ee1f6defd5fe0991a8b735a3087d7a987e094934b729f5e01b5284fe6e5455f7c1fca15a341f111f5a07ba0081f6aea176bb8e0925f39e99c907d6967d476171ed68ec19897baa1a4e3108887b828bd3aeed8d0e981b23cab805dccbcfe48f0ab662c98424c43538a3869b13e9a4cbad1779f8d775d763cff69fe90d99dec240bb5a18195a13e7d273d56aee2f05c4215e67c910328f967e7ea809fa3f09dc723bb224c8a31c536d70b15768fbf70206084342f5f59711f58cc9b5a654da6870b19c4103c669cb1a93a55df95458ce58ab2e1ac60ff28c75b75059a80fe20430c5e1fc61133f7321840e3549bdc1005271dccf417555919b61de7925dcee437611e8e9fb498dd31f29838d7533563e77f688746beb2b8ee116dbdb9e33f20cb8cec2569dc35010149f5ebd3ae13a12e21e6d3527c949909aab2edba3794acc1ecf007c8ccbf3a3bf7a8a62d4fa2185fed7b508a7d6a139792ce751ee99177053878c631ed2df7dbc1251c4d93d7b005a07bc95d29dffff777e6fab907e36a89228a4e16eba78a2898d156325499240b6f4b31e627b98c2c254d1ad38dda22c2b7cab0a4d44a24c79bf601e5baa35b56506a9691385ae47aa4da60c3e17283bc0df7910003ec4c9c162302ff63b5bb431df58091f340ffcfecc05734d1359cb34d0d41b5b92965d276fb5759c8d1047bb15f622a00f8059551a5465ae4284adbdd5cf59506bfac5c408fa6bdf3b40912041b91b7052c052e83090d40f407274439f8111845e938a18c4bbd6e75eb4d8d3bd97aa4a2928c94b6cbde5b2b5b9df1050fe2c33328fd09e30d36e4884a56605964ef6870fdd1269ae8e357158b9766b743b3ba46ecd467a429a1af3ac33558f0d48577ecca5184163afc1685b6df27c25288809a967cf0f51391112bfe552d56673f249c8263ac239be7c0309d82a023dc51f3a94134d6d5879be1eceed1f991068e8a742e54a40b137261e26347fd331fbf40bd593eae118838d115c3f4c07a4465e4a4921556f27d087d500c5bde6ef8e1c390fb08890d3ce3afd681c38db77a55813d421fb10366df94d9a202d103a8da468495b63740ebb7d8a7975889d258f5a5d13a9bb6bb188a7b65df3a365fb9b120e286ca49c1cb793ac64c743dace4331bc63aba1c87f80e02d1703ab94d0d6498f9c519c6b6606ff8403c7aad2e5d05536b336ea02f0e134477af025a22f1f28dd580254b842ddbe35ebe4e70cd274d43a55e8d4af814341973b8d3de050bb668d36e53d85210008afc025d07b0748fa7bf96fcf1a9ea59b91a172e86fc0cc9c727da4682e6408efff6175b70cd42062f9da6a915acc5e1f69bc1704e4c5bbe7c1326f9e968198270ffacfb9c9a4d9de3eb70e2ab45da5352d65d2404bd79bb311af71c9630fb93e83abeab63adfdfeb464a9872655ef096c78d591073e4a24a2fb42042c13e6f4572d3a07581248c22800ee6551171e361bce322b2dffc1a59c0eac8b9b32e47578269293c235828422ddf88ce643851e3f0882ce1d64977d0004adb4bbedc554a4fc7f9891fc09d46ce57462d144b41b77a31d69601a8f079a41559a478e409c7ac068206360f4209d934287d467e44428169bc39d4e8e704fb8bcaaf7d995fd593b1eeb26b6ee24772f1ace4bd4b50217ed5d57aabbcd1c72b864ce1d351ca5b87d70d408fbd91df594cb93e5314cb2c24a2c14867cef8cb9bcb5ac0bf13491d22d0e5e46a306f36704f4444f52343d2c1a825d43a2ac8130aa9ddc82d23fbbca6f050edfad129b82f144e509a9052e06c558910099d24f817fbd71f17697b351442b2e53a138cf7b39775c2abdc98fc0d825bbfce70e432277550685d638b11395bc5f1f0473e1bc51404b7000c014676abd69df8d34db276a157958411f105fce2afb1e5e17a3f78c9893c46d8be77de3c2decb6125f9c537288bd05f8872bd3960edce6af99c33e21ab0e3e897e711b3a4e8b4c6442d184bfe47e14d8be81184e0403b0c4ab91a595b7c5d9f7170f17f9a667450ba2e4c21d116d4926ccc3060f341b6206de6d791a44f199dce26f370c0fd73b520d7beeab1a7b03f049390e37245b5e8a7c7986bcd1fffaf22f6c48d2126a5c6d5cb1873008cd661f386568c67b43abfde026c7f5431dcde6fa4637f40660c8e3d2a823427756f607a268b2453c135030ff9dbac259603541ef811ecdbbc58425e383fc268c3e8a8399f122bb7a31799b2c81e5f63fc61f4ed796295e6ef22d72c0a6df4ccf28a50b01976d1cc4433730f346b83746d2874d168e93fa2f99cf11d9555e886184ed26b256bf4bebfa2ac310f2abc2a0efc2629822b9b89af1ced9c59a39a1283e3b9fc3065c4863cdd2cceb95fdd00e7ce0a8d0add773b4f1e07b26f3bce3a8696d2847715cf826d16b2be6693cfca4edd9e916fab3d384b75923527e4f029e67464369023ebfb90e3403888a6c6fc7eda2a6e738f0776715569b729ed19af1afabefedfce4f2b307d8c1b7e2aecfa5c85d2f35960d6595d9749866da70ffc6e4801e5a2e7195e92c6899d6bcb76148c57c13c9766482c172c336d35a03271c5c49f9e2d9fcdcc46bc1e9a246716b5f4d14cbf5f73dc3fb9aa560cc59acc91aafd658033dff68e02576e066fdd3b81037ecb1ad1c8ac18ed7e52c320d21dd104d2fe60215a6ee4be0e7cf041c5f6900e6ff3299353bfb05886ef2fc7fc2ad1e0d201923ea7cf4c25580303ac17359d42d71ecdfdeaa424c92b564c66c9db7a28af687d610ce2a70da00ca2ae61e2cdee80d857495f3f603c352181fe69f070e56ec94081eff6d047f5618188da97c1dfc52c822fcd185a5017544d584e311454a2f624ee7435692cd24200f9d5b25769e463e69a5bd8becb7f901bb0897aee905ea2fca5c460c97ea153ccd41f0db8ae90181bb55d561eaee0c949e4b7942555f9f598abcd720f1d77e2cb7eb7c350fb2f1e5852accf39b6780fbde2fb585b68aa1d79136bfcf0aea0ea6202ebfec05b3417703153871b8e4655d8fd34d1fca1845eece49a07e85f6294159f3a36219da78533a4a7fc0718539bba540304a03d2ba21396e2bf7b5c30bc9ba54bf32574104213e8124477ea41040b03a5e1bf85ca4f52a85718083c7a560544939ab53b0392d85acfc1d66fbe7f245bc3b4a2f0f28648ce77ee89b025027f05f4339a62383a7f5335e038e7f03cc3688c51c958db630c7ecf8bf61d9bd0a789f881f341c7eae92ca5e45c6ac1365d26f012b3579b344087a38d0f6f0510e776de7245c0d9f7f5e3bf48f354ce49e27e5cd60cdd93a524d72ba8246b2cc481f57ef21a38d5a006983e8d9e761604f1b997503cf7eacc11549352535db13fe39ca04d622b46611f80d8f6aa9e45e8ce8e5a4d8e4bf9a3ef8351ab68d4be0ad6b113f097ea5588446ff8b48bd7a4d9873e9a2c4d37f4fa53408b1cc7b922fb2353cae0f44fe3d2b294b64bb506805a83beb8194a9d5d7479aa615ba7a153fbab1446da74752468268d8305e321ef5250a50f1c3e7e2655dc7702bf6a90b297873e8c726f5a94e330e4d3c537255a74931843246d1a560505b9ad4856f43f70d78fe6dd98d3e27ce29befa98f767a5ea8ccde2a34b4f2b5fac3888145f1909208d5d9d35c79cbfcf06e6e3c1121e9ab947fe3c09127cc735dfde46a3a70cdeabd9774c2cd38b42e53b430a1aaf94ae75e8c5524cab6acc96ab74f8f4bda07afdcede7873a455628f6f17e90f89a02a768d105e7b3e62f1e3b5d868b918f7f702462d0084ae56d5280ed462ea68b1e87c812cecb1b8925f0e82d7a5245f2360d474ac4e251b59e74900ecd428d1e51f6bd2e4c1157ce9d71c1cb195a833b529a528d4b14c7523966944065ceaece747a56e31c9b4cc6f1b68bef0d15045fe6625ab150ef7a36f361e589897db552e3dac405387b5401d980bd40ce1b32f4952406de20a513b2d874a1c76f1836cf18eea782a1cb810b7933f3b28e64602490a9dfec5730b58c261f8a4d0666cf021060c1243ab062dfdecfbd2820d14e070fe9db5a4715fccfe3827d4fa9560a86486106d1fed191495ddcdcf42ab177764bcc743085cce7df9cce6e0509581dfb084085badfb5da765d6658020c9a1e08e398ccaf5acf9dae367bbcb21b8a8b531fb5ef7e5bc7a7d15935b72c4dd722fefc7d7b3ce1379945480b6d579b375143623fc6bcac39324ae9e12a2faa5cbd4084a6b3941f3a376ca28a49e84feef5fb8724e8690a3560b8eabb7ce89e41bd7b55957d598193f3655e18a9632c74228cf5fb55f610dcbc81c20810e72510bcc6bda9a094188c2337c9600034c5b7ee7d63624cda22573fc3cc107ec14abf4c11c09fe206fe69e457d550ac21242316640c92829eaeaaa11674f14d22dd6c06089a877ad4724b2d922684ee8a8969e7f1b015bf2ececabc3bb74d31564c728c6140d78f2b6fd8ae324bd15a8172d7628966fee598d44e50f0be1122aebc44441cab83092a1ffb6a4dcc4a42f6b65323fce436a08ecfe2d59f35e272653ced4bcebeffa2ad5c40d27d39ee1444b1c3d39c6a91328a3bde690d7037b6039f0699b21ebb02205c9243956f5d113a78f6bcccbd2592b2f1a141c94e63c34742612de1041f6d802f15cb47f05a902ea574fa2f3b3ef11cb680158416ddc9e8dba5718347fcc25552dbae270071ebb51055f44cd5cba7b5531c04b21cbba3a3ef04be300f5030b4ad01206529693ac3bc2c32f9d1374cc479c2b9601bdef835a525ae8a22c0a87f7445511c92a6433824eba0c4a206b21abfe65b5a8eaa6c07bb095aa3e9ac82d071cd8efce109cd5d2c41c14a9dbd3dcceba70c57c185e1cec7ca3be898869cc71d8bfcb69f8c69061d93de5e1f74b7592e4e03bcbcf7a1bdaa636c89a20734b443bc84e4a75f03a3f3e586e551eccaf4dacc38b37a26abaecb73d67deebd38e414b40e08b6006dbfcdf8c3d5eabcf6cb93dba5169a2b4af788fe275b5065c9e5ad57d99ec7380eac32ffdd88f28a40dfc891fcf3580443de267d96bf6d83ec174fda96ae8b22df1d71101399bd781802d8ff71e082240d4d212ae244e11d79de9690370a333156f833a89e181c4e60fdb9d3d6e4a67d9273b62c4d528327f4e3d26f0b9d7b7cb08acbaa661d407a00445c2ba7fa4d42b8e1f72f382269b847beb55b767c503248642f55cfa141abf9ac95ea69a44a64867e56ab626b5a134ae018b7a47faf19e554661ce795a3b1088e9f341767fb4415e53b9cc1aaebd71bfd97cf0189a17acc95bf0362708b77616fb6fbaf88ea81602d8b4d8bfb588722d1fdf0d16fc4739b23819c9e95c87ecd9b1e71eb40d3ee805feb36cf75169e02be046cec1fc3902bf6546dafdbc7c62f8dda57abd2da82ee8cdf321468de6fc0fae503ea11289378c9ed5f62db518143e4e3ca16ee65ce0d1c1140b8d5d8bb6481c7fd5c7150c3e391df6c6abf34d4e9d7ceb54204caadf453b9b40c575cff2da8a283157bcad765d65cd57cd72e21d5d0c9defb0fb270fdf31f1bff924ac5d449628a5da4809f17718855eb906e4a71519617cacd492b13da64408bfd9515da5fc7784444d51a69c8f585468f7c549ec691f4503f688b1c789b2d7f5e5a7f3861652f21284733d1813e32782674314029e60db9951ae9f21e7d5675274d9c122458e8c98a5ae2e558f183bc6cb090432f3661af4f6d44145689148d29c5ac03e395523c63da4258cfda463bd185a36cf96712532f323eddbe497427f2674e0fc98c40b0152c1f87886350ddb6b802f139114b5e04dfc690569dfdc77287ff3347c099e1ef4345cd6bb54a6c763d89f0e20d6c50b1ef570ea57eef8a6f89ac0ddf18506d61d281c25b8917d2462af0e325eb0fbcb12733f8cad1437e688504cb9b6e88accc3ac1fe156bacd02171bde5067cb198a0c48bee7e21699eda00174a41ea63c6b4549477a3d12e3e626aab370d535c06ae707740504195977dded26cbd0a7ab915c9de2010d73664ad847291935fea712124b5dc6aa04ee27fc227a105d5e403ca2a4b2ec0f917624726b14e36bb028eb256a7bc2cac579f3efd959bc4b6f9218233314f72ac7354503f84327711d8d3c32d3493a38f1838488ccd6eb14d7a952aebc2391ecfe1bc527b5eb1e704c403650128859898f765391fbbc51dc5c5b61edd164a067bcd52158d500afa3795e14ca6f50021b0f22f35818d6b2aa5a04c9a57b5c0afc44368363ac61ee09b51033f63c4e683d2c48b296eec80622019f5f6f7e9846ff25ea64addf8d1048e94daedb93d72377fe15e5680b2fdf620f8498b0322bf1dbfd088122c153d598a719d0024584ccbf03e001f9ccc8fb60ebc3cbb91b4527be515932fd780360082a7b9afac375e8d4db4948832c51ecef5edc998f522942431142ab40d029e21939672e00af3863c275e5339747f52590c30fc063c22d2e61bf4b21d39a3438b5d70dd6b661ec8bd2fc218ac944d75e7784426e4cc03a9d0d4cf5ff91c92794f0a4c5190a4ab2367d3828858166be0edb543e0081da3bc67a82fe81e8766f71f07de228d1e9959dcad77b0b577187c5b6ce1b8189af56a1f81ed2306ea607ee0d6b560869f556cc5f6d3e0d11adb313ef6cd1520dfc23bf868c5003cc9405cc1bd6e2c509f28f101f4c6c09010ff2ac16b38b9ec21ee8ec30119044f8fe2e74349e7023376afc415da1a57b45ea683cba26614987a96423459d695ca3e0c0d732617fee9e8006c36422c9557828a9a9409f535fdf8daef973b5bb5df89cd65e7cea4659f8ebe0475e8479939e0fb111f7967c368a79957c6797dc88405fc81f9cbbffedb683f08a3d12586a0cfdacac3aa0d895ce3a6c7add657458acb34018859dff1eb084ed17672f242a434fc93b2d997c85fc9dee808f038590f5b454237613778b0e71f860fc75f4d6de03e5c6499a8828edb66b1af3ce44ffd48fc08248b30141b54f809dd2e48aaa3ae7d5da4b2daf2579ef1338e805d68c2bff2e4451ca2346c799d2287d60089d241f69ff4e130b53234563312fe03a3b583ceb592fd4a63af415f73aec8df3508c548ce35ba0f6550722a7fd0c3760230cfe09defb034dc4eb618baab1f366290889851d8e152c204438f140620351b8ca6486883fabd3adc380dd14fe58d555c2e7db3aa2419e0fda3e8342b76e97cfd9f8e7d3710abe8995f73ddf025e0232fcfe644094086c210f44a0838ee84e432584cfd295e7470ac9268b9c26a24dccc776102000d4f37c8f322facbfeef17264a6ca5e9b164a5121e25f377ecc269751f94c167ec2164b487ffcb7f243b00b6b376436ad108ae2c329457baa2777c382892602cf46062376404004e33627beae5d0dd15d91e4ce8bbeb5a84990e8aee4a48b2be49365a08a5f367d7d7b4b032761efe683d3eb748754a2e1f5a6433fbae61b64a42256dd4acc8b5c594af8ef3c09cf275ab03b5caab54fcbdaa1d79d7c9cef14cb86a8a6138bda20f8bc0382baa16dbb98786cfaf584d0e4f044171fdae1d71f25506ebb35e3fc1adc1b4bf688149216f1c11618902059735fcc0cd1bbe3f8ea2ff8bac74145d0e614891c6b69953d6f593a2c8997ac71d61df5b4f05dc1addf48562c3381def253bb552eb9d99fa827deb56332f567425d949b02d4f65d20e6a3a262d8ffe69f84fa8b31fba430e88f6475d52a488bf8e59abdcc4eb85a5db8cf422137e07f27070fec139898f693ac910b8bd8b9491d7d667c5368d42092bd0232bde53bdfafa56daa27447496ab34f6cff6f52686c06e44bc53b20df71c5abfa3768325f13f6fe58288a1b592f55f1ce523edaf39c7f453eb7ba619dc59f25115425d030ec92d19313dee3e597edeae78b2bf455ab7a7c8c0984250f356c56f1d72adf19048dc5d3c315f559ed9202857428601fe6ced6992ce0d8e71ca95d7328868c0be2678332d5e41e735852b7fd5ab014f1c6b82331d931d241174755721c9ed4e3fede0f608881cea9f9f2d4563bffe8f4f0bfe994ee58041bf6e7d6f194dbd76badd3227f54605351936390ce850b1fc9541c6dca6a8b0b06620c0e8148ea122d41f30c58fe5426ff7eeaeb8c7d1edc9ff705f245c2a04594f055724fa2f90144c60d5d269bc9597d7ad5fdbaab7c1fcf38bc635ffb2138af9c92c48695da75726076d8024713d519b8961c76e66339137c3f5370c2ce70deb2a821d3a83f7a0ee7a3cc489fed3df9e9dee003f76416f275e0bfe32c5620d57d5a7fd860730b38e68e7de9b9d7498b13436d07a2ae5a3e9c867d7d7c18d96f132f058231acb3b2bece5dd383806e0f443699f5827493820cef164e84a752f5e263c063e891b04d4447eb8c03224e6c7ddae3494d08abf69e645407e7bb95ffcc891ea46e14eaec58272bb0fcb1fb95086a8a2a33f8cd1c443a045a5e62d3e11860e34d18cd5d086ac755669ef95716f3542ce24e18dc6c4eb881045282c9effc2daacc6b71a5fe525058e9f615b7cb31f50d594f295f45a942ce1af900d965bbb6077c6e853ce9dfe622bd02475def34057483709541df92b9bbc1addeff33651dfaeb59f381ffcb4c889cbf04d34b9d36b2c454cf4198fb1abfa55d4788f37fb48c56530c8a5a4aafe2baa7f5b5c02f8f583e9e7d03778076c20b40a50036e08519c565ada5c4e23b1944da6c369a22ea810ad1fcee53e697e14a01bac6605e1eefdd3596096b643b67918ab54c3ec58cbceaf69c8af628cdb69f2e6f74587b6e5603878e3410c1b1bcf2b52a73fd85640b4db8c86df4b9ad104458aeb8b7312312e23f129d52f1cdf9f0d06c3a6cfef58f90819298fc5f6768a34387276526a518f12be99aec11da5982a874929ed98a1e7b5cde39f36638633aa77a1146d6a58ce4797418a96d72924dd59c2d4b51a849a18c3da6c969f46d8f0582e9731dd304e21224770e9327307cacef51028bbbae8c2475366c2043f4130c5d77550302a099e4ba02e6ddb0f9b321482fd6a3be70d6c884621ee87703770229ea922f2a1d74cf113d2816876da01f8a8331db416fef5baf728b345a3c551de4ad62498ae621962cf0976b72d15f0d69a9a2eca49b7efecf52006dbee233a943613aeed94a76717724d17efdeca6cc3b157a29dabfaa34012f16a7cd78a38e82b5b8bc85f8d7dcf59c0be2e5a104c3eb254a01e1b0a5dfdbdc9bbb65a68c8d0e7765e2d2de23c4925180e613629026832cb37ba347bb0bc4dd6a2444e6d51c86fcb16edf0af901d38f817b2060d308737c27a1e18444bc7085efa0002d5ac00b94b8220e115efbc5b05f2ce4166358444c95f78249ac93ea6efa07e3f7b7c3bcefee75ae6e63949bb4e83c75079a4f6fd83768083baf906ee796ef0dceaeb14f884fc761b3104ebe9d0a1e4373243a72f924e30621892b87c1c62838f206f04cdabc8cf4e6590eca1b79f44adea15ecf2e84ee1b73fdcd26601ead846c9815da163e006fe45a69e96793fa11767d032d13afe24ca89182070ee9ada0f5e52449aa3fc571c1baaf3010d20ab997d39dc6ac346421bfd4d263cbede578a925cff300bb3fca059445516168b23d2349232970e964343d5d45f3fc280bb4be9e1a4c8292bccd3da875916e9ea143302f76a1c25c879d6c62611f6c8217d0489adc48717ad10bab9e2c8a75b808147abdd5dc8a980da0fb23a4b3eb6821e4d66c66fae73cc7c9782ade20745490bad6dadbe28e89bb74c4988f897b1e2889f8b59d1acbba580fc6da6abebcc7b100248f3c00ce8999e2e2dc343eadf81a11f5c0738029a2941e20f40b9af4f7fa52b1eb7fa52fa3455aa07c240a67cb52c86020cc7d3cfaea3f67b911b155b07cc351970cbb6a36f1eae7ea7c4b409938a9d99f75fc4226f455fa52749f980630a96a37db136d2232c85ef2bd7ff22ffc2a2e328b5e558eaf2bf62a9364cf86ae8363966cbc05aecfea6e1acd5ae9dc7a8be757b4c19a4cd432cccb9ed07279edb406a33ee2e9374423cee9589c97bac9dd6a1c10c0d7ab6ef5e69853143aa69ce5fb728ce401af1469551f73db78f7170b1e49f3d72e95e2e87d579666891b06b2309919255edfe3fcd5f9fee1828741cd0649ebabbe3a388cab1c7ad5d3991317af061261e649c3c238e188e95563f4f310704a81ae88d676d42e45a4bf1cb63b9518fd527068683966cfd6d692fc3b106a1342bf55ed914ce5b77314004f98a7c6fd20376a3fb28f98b1c9080f9b79da16fa97bb84bea9c4c1b96c2e9950f89bf0b29b7d5ed08be8e03ca20238968e0df87632a4eae5161ff65764cf8b7de2ea099e7b4d87d4ff29f5c86fee7400b7047992d1de8b90787078116f977391ecff846204e1bc02cbdfdf53240641fba82f20a94346d1093d2827cae5cd4d9ef3adf868361eb693ef073076728fbe67216fea17fe43be37fa33ee1527a9803df6b35c4b9792eb862a269f8c0f888fa2eb34f301450cb57f58427d66bd1bae67fd9876be15b457e1df3431fd1b28cfe4753eb0f6efb66c6bdba13eeabe0cedff0a8fcc710bf2edb57dabbcc6359ff3b31763187fa5421c87e8ea4d77b837429d5a6f0b42f8b136b0dbf315d6feeaa36438f02dd3a52c4b07baecf9d6245ce9fe4a34401653ac88f56d966f233179d63ff202177441aab8bdd0f9cb464933181ba3dd31ccce9ffa6273ceaf3357bbc812aa1e1f4a9aff37cf080aea8ae705faeded7d9bf2dfea9ef7d8b728b3b19e153f9994a4a3c0ccc0a8d6485e633dedeec43e665741003661a9cdfc2bb55dbc04264faee83fe93589c100d8b73d840825bca9978af19231c173a648bd800aeb23aa9ba65f19bbe5aed88f510d6517b7107679eeafb264a46dfe9f039c1df73cf2615b2fbd842297162b2b120eeecb680ef84cc7ce0b2c750c6f9bf982abd427f53aa30e1f63b4ae9ceea6b7a1c7335ff31b3e950a6f7d0a34459891b25aaad9db74d7945c429712306d1841632a3d884992e0a544adf23c90c87f2c71daabef421ca29c45d3f1ec7187497a6dfd215e31a7f1256dbac29be4a5af4e6951406f7c87033e45b54d297ad00a589bcac53a72f8f4a10cc73ac0ad1eb634bca764d4c986bfdddea3b219262f922a05a9dff566131f79bd66538dc027a931dc4d41b90feece6aa2a958adbaf40635c37912157a3d2a742925ea5b33850bda8f3281beeaafd83da5607d447ba68ce8798def3f1f1928a874c3c7d0102868fa7a6b0798bdeaf5383f235b00a22e620c5325f24ca49f78a2d6da08871af9d55c7c2a875c1207f961bbbb33540726888575e6af12fb09cf605941cc50c070378af3f55299bb3fc55e222d069702dc1705e86245b6ead79eb512527126771c9646d16259009550b66fe5edf467937965cd4aa3f21b415c354fee06dc7109efa903d6beef692ba3efcaac32ed74238a99b163fab5eaf08949ccfdd258bca79c1db309a665b54c0eec7bbf573711b2319fc14150df72ca1b9f2c54f817aa8fe08d3bfdfc63a5f7c137bd66422ee6b2b68fd85d05c62e4f711150d835f933dd912700f865a5200f3a7bd6d7acf70f47611aaf4579a6700ec4b37e68bfd55518f0dbb1359f22fe086561f866c810b24320cdeec9d971df22ec6f8514f5bf84f1a8fe865815b13747b818abda20b8974a671d37b574574945582416ef9ca53e0a6a26316804d18a23d38959b083ef20db8a108fc064b2737ca83206d2df74b69e1062e9b6fedf794bcee0a0213d7253e1eeb17a4acf879ba2d0ed1ccdbc3ab07fc1401934b6943ddc463fca46d158edd880fd5b5d4fdd13818031ed8fa6da6d642f3147f6e7047c61ad7ff86ba450d7c6f259b483dc0af7077bc1abaf9b4bbf6135a8e6dcf5391ec42081eb58720ebe4be2296b721256be34e47e6f139ee10af86ca3ddcad2b9f19463aeb852d99f58a2de2f57c04ab98d9141157625b47cd97acb019d6fdc5328b6f5a43327d9db556cee90bc3f9a6277cc1c64b881e90e524f961c51e07e57a8afb0ed76f9fb8e605b8d79da8257bff64fe03bbf0900012169ebcae5d4a2e3f90cceb950be36077ce104ee726579bbd5b33be1f08bccd749f554e602c082c424035723745dbf4b14b1834fc37afcf35c77c7f03851d512f73d74ed264e88568887cfe8bc9ccd5acd27615c1bffa57f37370796265df8fade53d14bb008d67162cd5c5f532ac7cfdbaa416ce6112adc1639c239185cbf64eb2251a4dd8d3c3b9e573bd7bbbdcacdbf1579c851a311144086f10e09fcf329008ef95c38e2a3ec683639817ad55aa922f70b57af2e16dbb06c61e5f41945b2eed428ed17467aa319cf3ab9d21b626b83fb3b8ae4446ae653377db19e655408daccc8db354616bf42e2131b763b16f492edf11a831e15fe3e03713d7d0c642bbf4995e67d1b54733680e6fd5af39eeb0b290f07eff66f1494f14003f6631b978520a38d234204459d43d18786ff56cb0737b043f46e99a8418c31e5cdcd693ff8454618907adbfbfa718b88b0c15f606f3cda052b81004efa4f707fe3e43da0397a98c27df24ac57d8a00158c94971a8b1a3ef77efb70bbe07b63fe75c20fdf21136e67ee5f53ee51a12a7eb0e66ddd749a00dfb6b621ad1e0b3b80dc3929915dc6b92f0d234efacf0e9f8949b1eb759200d32ddf33210d856ccd3e374887dfc6800c252ee161071b84460486b0232df6526051776990157069be71eafcd440baf598dcd79f54a7ce9bff0f43025024d829260a8dc378ef19b45f2715a89be7ce48c09eb9ce13a3ed043bebeb914c596ea0c2d2eb4bbf0bbad1f7f5a9ca5c5b51b581b54a7be2a1b4bea2785c05faa33b4a2f1823138d59141b1ae39b48010c592dd7a93dcee091412daec1f610cf4f12b658a6e01fea39fc116adc9ac15b5340cc59b710c464ab2e0b6231bea05536c3efb2268af8f6c1006f989ad3383fc4d64fe09782ac65d43004e25484b03e21122607f598aeeb60cdfd2d55c3b01768d45683fa7526f463c0e871b0fdaa49f377499ab34b189f263f5cc49fa55efa0302ccbe70740036339199d0830f6223cbabb6755fa880948541a458e213a654189d44e146539f6ca3cab80b53dddcd9c6b0b33153d6151468f2e6ce18f39cf334747d3456d50e7513f2d0f9bf34ae986bd1c60ee51bbdcaddbc0d2196be7de2cc074796294fac8fe2c036b01d02e340a7e6007d8567f03b17cdba3d1f9b06563553979b80ae49220f2871b644d4fe695e8ed886111f62dc5eb4a0ffbd4f946b4c072f3a51c3e7ce161b41527321942a9718146683e0084553dd3a0bf681f065e366c631183cbca90a933ef14559c69726aed080117a2676af37d7ccede4c5ca03b889c2a31fbed1e01e1bb7efda4a1dbf7281980b7f07aa640ae794f689a3b4899ab2f3c25f1d47c0bc831e91c2b2b56263f1511aa6ad55fc9e3dd8d9b8ac8bb144543c7303d5a5c6319278b8a14972fbb11fdbe9ce923a347497cf3e426f6c36661c613f37f3bfb43b976d5329edbca0f00de2b5f9def979d51d7d51b6346b79ab2d79f594680228827ebd9c75d6fb7038a4f00c2d92c83d19a755a1288b0f39af48bcd1a439e3bf43fbc9a7b69997a3a6619b986d98429b479997e09f7d79cb24773ca9eba3e2d2f22308b05371e9a44c6a338c6601698d0a2a227a6343520e52d4db7be422314946e965c7413a000a134fbd2c927b3e48bedb5683e6af8562ef11982ba26aa77272f10a66007052b0ce40636eebbcd42912884c4fe2e0467a103f3fb5322a587f85bba377e4535043dc6b2de7381bcc9446b851328abaf195a8327bf41ae989ebf7329d270737502a4b898647fd6c3ac977887ee95dae24a4f6207cb7031d0c7a1847b919af7a2bdc38193981f918d41fa3ebfb191b0379cc59d16d06abf8303e7b4d43be375b0dd04a4de6b0738ea913643cf9f5d9e6c7f20b7383b7c42bf3d3a2e377b3d9edb5c81380f5a58a3ec169937db1ffb496bafc19d59d87ab5652c3202cc3e4e215f14b21e76e2e75120c8e3f3a9381927e2e5adb91912878662327e7a29873d34508e4dc284d7e299efab8f7f6293537c182065612ab4b2e50decc3884e77ae5ae439acdf5c3611863ceece5220c316632f620e3a87ffe8b5fcf87abc71e46a565b741bef323dc7fc0a9905e06ee34549cf3badd15f8723d9908e03e340b1c85338decb43eb2e1d67649159a7afe49aca6822a7e035f941831909cb7dec377ada0f7b8412a26f86c6b5c1e98763d1c47f2ed4a739d703e5d7548b6006987bb1f5cb3cc277b0253f19d8a966113dd84bd7ee6770e13a2cee60812434c23f27d112b19ed4f12d5c41089cc3e1ab4bae46f7cb51ce8ea2c751892ff014164f7a27db0c9e62b724afaf26f9dff6a234f8545d86af2a2850d0bbeda68287c797df5b41ecc5ac805d11e76f143a024930a51b13a37b34ddfe9dcf1c16bb612fb315d864f9dfcf56fa8b5146465f29f14a2202b79ae9c1c01565589e39db595e989a3a067acff9500da03922acf309b341820457d5b5171ec5674be219de73736926d7027b2d4b107086a2a0f63a8296414ee34170e2f30944e5bdbb91cb9b0987288fa80b63def0cb3b63b72a9be50e5f83fd5a46361bde60d9b112d0abb9c12a7eaaae00efd193f95004d95f9a50eeb4429b1136aeca5ff82c7362e0a1fd98247e52113ffaec213751e6920ba26b7ccf258f113b22e1eb1d7eba5cedc2069ab29ea18a1103ed9b41094f49bb662b637457c6477c9f683bc8e685b0341410c88f0709462520b03206559f4c35383c3333635980d3e6db35757b79ff9a92e1ceae4b02aba442a3c3595773437010a19b7a962158662d0457b48a362972a07893dcc83c8953e3fc994674c32fb723e413995027cfb1d2cd6a892313ae53eac5eac1978233327d389d32b3b80f8d40232e61431bb345f827a099e11230fb90fa74b18962f9af436532a1d23e3641fd1137f3ab1ea9b4f338010f76d2fb2a305eb757e84d7e5f0ced45d147ea615f2d1b5b88c459636d0c8725226a246f4915785f61e23d0de77493543dac91620d13e2c5e5e8e77f1b1e4517b287fbfb1baeec838967dc2cfefd8182912bea34d929e5f10642370bf1792cc8253e27eb3b8313337216c3a548869e8c349b714dde7f92cc06075df29f59683e2fd662ab42180c026f8080ea2e764a24a23514be4dfabb836c70000e36d51be58f071dc34417f621159e0d2a49c3b5cd6c76bfbc7d430113dcab13abf65c5c5dfceed4853bd5227fe3f94ac1ef896d4a2d50ae32a5df4095da7c755785359ea45bc3e8c4f48c47cfe2f9c2bdca70382fd19231700f7944989536983d23978c711c8f7abd8650acd9b20d24a6354ccd10b4e49fb442d5eb7d8b2f5a3954129722e0cba1e67e107765f2bacf5ccb988c8136e5d41aa7014b76ae82666c595395a4ea9a92f3322fd889b94ca9f434e95fe038aad7c09b94447f6619a3acf4c827dcae2939556a2858c81cc0ff58092a9f9b4afde88f58fe208326f6387272e7235c3df86532f65e0eb243bf46ed4660a760a32798424c5826b4600e93e423dc51f6809576311695ca94ae5ab34bc0e61a4dc9e433d69a7bc78d3ace84770902b0793d6d6641240772df6508e892fc9ac24b52ce1047dfa4acf21591a729512ab0585933243c74afa5a0fd876c5e65cb75779fa86cd907c1069b36202f6dba6a45a0a982553af96d9df090f5837c6287c564e6c8f8075c43bff9e9b43dc5bbbab93755e87959bf88218bab937e37744398f94d528518087f4464db4fe91e794802c2b418f3ae7806bab92099a4167ea77eb0ad398ffad0ea6393dd4075649fca136575cfd2aac597075b102b6fc70a30626c23df14b65d1f4fc725701c4fec853c8d368538eabbf3b821d2d5f7498e557c460bf42a2badca9cc20a70f167f79f13c388a72cce65114eaa1f69749a045f67561692d1328aef4eeea1e5d7e190fac70872a454534f0eef64a434710a24057cb0a0f00ee42d9b87ecb3d8f8310485cc7749eca152548d57a3063810f9cb34de0679c4ea87701adc4f18de1f267eb57b8b96f374fca7886244c2b03e096331527ce494547659af9a3e732b2d83e229b190cdde2c601729593018004fde5fe3c3565ac2bdbaf8bc4d61004aa62d403f404c38995b6c027880a1329aff3c38bd9b52bc3b9dcc96ff38f723e1d349da91f2f70d48ae608fce7e46f76d85ed52af906aa5dc45971e44b63fe8239a23f1f0133f0cb5710af11e84cc9bbc7b649584d326fb8a98407d286185980bf3a76405db2b6f74b59c7f6f24611b51a99f887fc22714da58c1f855bbb64d7337b169e5ae6d8ed66a8f9008f25339aac2f3b85a038ef0aa4e309be052e0f29092d5e9feecf6db54f15e8e17f533c07fd09890d77b15ef1f1aa53e72d3f9ec7c642bc65b676aa01ca2a9b9f42473cd12463477b04c50a7ccc2ae4cc803d64d23f9d95778e40d6ef8e38faf655da37ac5a5adc8a309ab971c9b93e0576d776141babfdc67d9239895c44a0721d8813b6081269b93bd0fa805df45ce3eefc0dd0c7041b3c1c2b50899892fe154a44771dc907a796cab545fa72bd8c7befc479679ca829ad86269a9b896da46ed003f497f30657feb96c00e43da6afdfb8cb8228a0ba9989cd736bcaba95084cee20fb654bdf86f973d009fb2c8fff9126fcc40b806f4d0d0868c33ba6393931c6f108a0f8efd8ade0eadada5f34a0e0b9a6ce33520d6229549066385c80c4b16df82b3f116fc84a1883b2167c7bf9e47f15ea4619f8f399ad06b72439fbef605e689a4adee23d00ad166cbba46b7ef91654f2f37b48f5a7421d39a063f6f57497f87b7b1f44ddc7c0354f3c3762cb875f277ce239ad633ab5e11d266d5f73d127dea37deb9579c8efe4abe2b1675af3a0be8d29f90bdc0a8cc480f1d9473a2e222843e5b9ecb59ac27eba0b828451a31440dede3c707e7479f4614f3d1cc40ea3ace27f9fef76f4da13c3d318369e7784c058da2f34a55296c6dcff13e541b18c8a89ac970c48542d084a0987318140462125407fbef695645259421ee14998751e8ef751819fc2ff57a8464599006c99701812ed6c6c77b7d5647f90ad3c795ec1b7c16d16418692efae504eb6211a9a28eb6738721099f64180a877661d5a91d5d21c309c282a0360c0138f06e55c10efb9e8e4e34616021e059640ca39f6acea1033e8f96927fadd5876bcc3db196f0cad3293ed317289d01104a70da0f3c43214f804c251e59fa41374e777d8fb11bc2500a397025ad533e9e6b204c4292ce7611e23445425680f30a829bf6cf3e3244a8aacb977a58524a52e452eba7c8e580a335184d0e4f54e0182415eee734c8c365dcdfb016581bc30963932cd1d8dcb70aecdb6d9f5a184351461d7d7da97b7247070913cf2c83bc82beec07d8ce4cf2d01c13163c13072bb9ae737915c97b68224420555de5d985dc613edaeef56de8815b05cb55b800d8627a571fca070a91773fd94dd2e4dfa15e91f16b7de70c5d8aec25acbe22fc54ed930c075bea06dffff182a8990fb38ce60d19d62f94e32995c021c55c08bb4af2fbb0bb92f8da7602347ba262971cb38b8e310aef560261bdff9be76c3bc3681915e6f526d9c6647e5ba98a01fc9bac7a28aaab0dee4140bc0fdeb4bb8f7e8dbb17b8e14214521d213a4a33bd02099146b79db9f1f380322c56bcb71c4ffdac6da3c9d43458899de862011486e722eae6b720807776c978c3c5e682cdb8748067df32aef5da5f8696cc45292b78dd410ca5a4f3be16b2389ef100f9b9690055b642a11f24a6f5bc73bd02b15f13592145ccf4bc6af91ee8ee988f5f0825d4ffa79d9ed82c3b18c4dc1f2911786ccea2ab790c53d6d744dcd878d1eb229b5dd385f392e5a281869e5c27ca0f0fbf4fe075809b5a65356069a90fe86fa273ca6197b2e56e07489a7938f1a3ee2df2a2a7c2917899e3148408cb7de3322e6a1d80a555a674b78a300c499b6a93ea73555b8472e9e0a149469ea16bfc4a266c6da253aaea732d2601a8b3fd4852e8656991e650c91fb42d91795128e5ba19af0402fea411b113616d9debc2a11c5e96bbf8374d056438eaec9891fe74f6e5076d3f2d7f24a714058eceb8b682d9d6295c4fcd4546649323a2dc533ddfe33024dbd9ffffc6bcc29967f9125c06bcb417484ea8e7a68e7a2dc8aba7ab732bef23eada1d3a894f2fa50d9c0b6a411f52ed26c65303224fcc5fd51a84af3c7206d6579c8d44469104b26a83fc80ed19bd8b1c2750b1e4a8304c8ad16d12cad084e0f7010bbedd1a8827e8918377b9da41fd9fb104a812f47ee0df66d83db7d7ce51825c7025f11a83ae43cc7d09948834b0f41543f7fa42d5c6e49a5dbda3eeb7d947eaf648700c49269113f67331246f8cde26179764cdb3b69bb30b9b2d507ac4f64d2eb7de6e204dbe91d12e55c69282157e5c6d217543dbbb5cddbc879f9ec360cf6cf546c2faeb8e2b8cb5952fa2aa5fb92d87750346cd967ba37ece52d83d729866085933909adc8cc3495f53f503a10cab56b6b1d7ba9c5549dee4ce07e524d61a4d62926927908ac9a52a9481ba32ea328773360c2f539f6b6ca02e5e0a4a646d5b6423e34bfdc717141d269592f4f31076d9db698ab8b5b12d49a4c4b00831d68e5a7cc48e08104f5b00ceec0bbb2aa70b2c0e7027de5b30476612dd187e0da49083a38fedc9bf47e7d8e3aa71fd95703f19c388bbb02273232185d743c547546cf5fbe1133d1ed76edd46fbdff95a9566f011b184806f2b6e3e12df3e8452f89d857415b53baa2ba5133729654ce03bb9f463892e2c1499ee67fe9aa1005f1f7d71180ffed77815fb1063cb7ca0149da1089b0cdf97ba1db771ea42bcb3b1947faf767bf13a5789d19b627ccec2f543d68d6b9665b533d90b7b1adfe1921610083e6daa8cde0c374d520ef4e582e6964cc389280ce3e201f3f7f23c5dda36cf53454f28b3ceb186f9cfff66c6d354770d286747cb6036754848eccbd51388ce2de7ec1d34cdaf0cc8edf4b0308b43f2afc927a6519a850035a9b7aeb2d01ec1ad8aa42d036170624833d1503a7c325cddc098b62d9df52b18acae198cef234fa3c7f1a501473b5d7ec577e3f4d46ede5113ed739afc87a7d5886380ae3da2f33243c342477d1a9dd16135417365c35ac679213c8ceb2ecb782da7efb4c1f7363efc2d01e2150340c7a2c268a520c0ea6bb2933db0281c32e2bda8092d0869d2dd632badc7a17ba3d33b57bcc8a7ba0b78cdbb18fdde2c5bbecbc2c2cef1a3b737e49bb145a74c5012eeb9f31a0156ca6666fdb172565eb2cdb9d8a51b8d9cdb8fdbd591710e99ff1d97d9b89da56c1645b0e7f609bcfaae2ab03734a3841c0d09b3bc4ac9ef98a3e56aac4064e3e5ef8217280cf30118062123ba26dbc111b6604acee2cb8b31b50dc44bc11a9b05c9381c13235e6f920c200c42ad8005d08729822047927e191772621a50b146373ef7bf1af73a6e14e16c41eb0b6e81010ecfaa605b1d1a16e7545c0bbe8c193946b268faf936db97e6b29aad457c6f0bae8be4ba11d5c7592bb6975d887dfa44a172d77fe8b23fa850f6be722ca7eedf75d30b44638e6300d1a118ddcbcbf4a2b2a7cbc99b31f3be744703a99f93cd093a3216badbbf9c633e1581f42d251584cc0ed362d3dccdc1405957ca452ea0cb3b0bd6583ca4154f3d4e67ce26c5109d4d4eba1e2d9b49f05dbe87b150ddb058a36a8df3a5b3ff6d2da32ba5b30bb62c8aeb4df7841e92a3ac9ec82b4eb5b45015eb79ea93dc0f3fa78521d687288d35b6933cb6d838fc586ca524bfdc770f0d3f5475d6c8cb3d27f729763692be4d27b652ebc144658689abad574a31b60d2eaa23cdccb24435cb7052df4c248a2631ac78ae7bfa26a88e4d6ac7f4adb377e03191e261e5f195530072f76c160b48dae2b2069c04d1680f2f7869954d18e997c66c243170e63506a6cc5a7f2fa7d7cd2f2b04821643bf5531b6c9207297918423d0b5de2f3a361aa1af5d0d524dcd1f0cb7a4fc2fe0f4a382fae4fff297fd172de5a661dc7288769355e40b726e847e9519df346d20d5cc91a77fae501cd7493e83dd58dd49cee97c04bb0a52fb0080b70e1cfec0f70bf68921836e9d944775ec9fbed092406d8fa8c0c9adee115bf42cf7ce9a79a3814704521bc88cb755e7e26da61f72b9ac11f26709fa6eb010f346d2fb42c285b7ba537e93d529569f090c36bfb184a5fea81f81c9d61f37b9a15b898b5e537584019528682c87b93c99e581979e9143cd27c908f0c4a0c2be35c76109abba842d7046f34ded505ecc25f810204f25ccb59a106fe0dcb2a2f6f7c0b9ced1dc7dc7e3e3b6beb8359eb42ef4423a776ab7e10b27da0cee53320f193e896f695635414825ed4a1c99d2d935c4d9203b66941be79d5d3d649ba8bdad36d046c8b92643bf09e99f7ac7fbca7561192dcbd1d57bd92593031c76b9e7147cdf78c9be89ac7ef0efbd585012e8434d2033f4837fc8dac90324289eb69d0e88b9d81f5caad3024149a5dc8c8af8a47834828244769a59837e88ee42e9f87da557964b863b08a8e37dd9068f84347d4fc021b8e2b52b8709caa13d280e7266b30d1819da1c8f9735c319d1bcee85af113246cae04b4a6910e51f29330b81c4e9b0578a0cd4bb5eec74c4a8087193583cdc808a32c6a59371f60b23d42bbd41064d028e79e365e471c57b6509a069e00aad1c25913cd946bf53ce6698b576381755bdffdd5df05b3fd228ff467f38c2e4a45d57029a3dfe9e31d1a80ce9c17733c71d6c3001c360ded50164400b998dd637f3f6c3aeaffb59275bbb56086963c806b6ee8be56d739b3bc54ff28772b7a6186f5e4649f21822f73dc8ec921f52aad1f4068ee7b4b40cb15ec2df37f68bb2b95b12d1a4ee1a304597e3badfa4e8efed19a863e24c295839292aa910b1aefd785daabc9812571e37516221225db9abbaed1f19f0aa7165706ca8ecec3e381a4c3f8259e717743e6c160dd566e047c827c40670c4d8fa922aa2cf0641bcb4d9112fe91c6f5fcba98d61308c4d5dfb255c705c27641ae4be84a2e0309249fc1619884c88a159570b1b2f3938362324a270efd224a946da6ab00b09de26142cf1aaf35998cf5b81fa1be6ea932a8acc9696bbab02abb04a9798ead4846a7a4de62387a39e3be21d61c153b20918db667124f48ffd32287db35f3ee3e39bfbd6d0fc9c9c139e271610ffa1f791e3632bd3aefe2e4799e083053c90708df4e55f1e69b22d263f635408cb6bcd3cb3fa44e641c24d7a446443a09e73f4687395483fc0904b18ead516b678784095ca829a8bb08c950ae5eddf5b2eb1a1c5c8270f56868f6f607f14e3c564e0b864a8550c9aebcd9975909685ab87c10f5aab3897e5d3bc364c882933377e7e39ada1485ca1b87f18ebd64693bf4f66f35d6735e23c6534f5663ee11269d25ab2f9fd5ce931a201625e5e18b7199a351d0fc9038ffb974a3a6fb34392d7a3887e8d47ef78363cf76d1c3ec01554d4e09b9f387f05c01eac37dcc1d0b0ee59e40499a17b3fc06aae5fb47cc3b34daece160ba89388cd795ab252a8fbde7d16ceefaf83656b64f40ebe154a178134351aecbc8d3e8a1c2586da9a79e3c0c845e352f8642a9fd984883867985b6772192b833eb71cd0883c04a7416fa14d831606fcb8a095c1c8c805956c1419d7e3a6e445fa4ad317fcbadba1481a54e43cf4b2c334a73bcdb877aeaa9a9f071b1ffc8a0969408770b7162c06e862fe3c56b53bcbc5eb8ba1ae4a68cbb73c576fc959a205872d46c80a9d47f416526ab30818d0e6606eb2d7dce4044517cdb5bd199746067c903492dec5cfbba6501c1d00a36c8472a9ab53fa46fdbf5e892e248fa2d21089bd92650e9357fa33e385484413ab7369f91f28ed33061cd664dcd0c96267f8701d3ba8f15e2b82fe3c2bf340f498a24daff936f73debd185717e44661b96de2f43a426486d0e46d1d24c5f55aa8687e03a63fecc81fea2b19df547e7785e511460f38f2a846ed914e90266933337cac84841d65eda2941430ab9ecf4cacedd113794edfd1dcee15b863d25502c71f12cae7ee3513d688dfc391f19311c2bfd84ea5ef755c8200b63bda86e62da6fe43db41b46e08d03ecf97baec629309e478c479c03626892a4fd6a85b04687e77df78530aae18a9d1803a3860c70a806d85c396d903760861dc0cd71b14f0f551d23dece42bac61324494b1183d60c6a2da2e9e0555d73b8359cf9e4ae31c5878263442c92f517ad62ecf4f1e3d204cfe0254eabe5a6b96f4f4b94876c9aeaa500d6ae5bfbf207216752016c843062e218159950229356f6158f6b5ede2ca77849da527f3c67917f727180c1a939ec144b245375e2f78a7aee23273723faac6ffbf318c167ce8b90c0203e222b5c616dff5f715de00550d5176fd33483c6b5aaa9b756fbbb9c77218dc2883fe4a7a256aa02a3571f54496aed3a1f73e3ecdd060387bb0509a8defb0882fe372dbd9f9b0543092455c7aa6bd92817571a0603c4cd91db984e487068d86006ea550228e6668e3fdcebda2ea9cfcc8988e80e94f70de92ccd505841f0276083db3d6d288651465c99fb5bc9e444d6766f7e64036baa5e3e7a88a1f51eeb9a66086c5c1ef4a0136e2c6b4e1c19efe5310463dc23015936a98587c3795455f85afde8abf0a1c9aac05274b359fa3401e81423bfcfb691b41d792474296b737080d651ddffe2bd9de5619972b6ae691557c576d22556284b3a8eeee628e5924c966e196cba9f0a5ae741c5bbb1c5301cbbdae05ece4ddb54ee684d1dc744ff27a876b26490c090ed9fbe49037d9ac09c59f2c476aaaec69afcf38055da5e05a4fad6b3baa3cf67319ec36c2865ff2aa6ae45aff5ee42658db0229c9d52c397c291c6884fed3186b1da3f244b9b6f4f28b185ce1524049851714630d8eef20436fa2eccbfe68a7aa51b43f7a20b0668693ab1b3531d5c01c3f36b90559cd60f246aee62bcc3457ed06885c5e8bc55cd1713c7cc71ade68d546ad02e74a7a19d9d269505189bf124187095338109caa768127dd5b7ca4e619eade67b224f2a7e93e7f86a2618c127b1bb2dc6d94e0b2302411f4a8ab5f70b76b6e65b2e22d203ad690a5544de2a31ae4ae6b04260815061dfe233f2430ad5e59a31e62db8fa92a16631209bdbe25d5f998070e49778666061a681d596ddc4f0bcfba24dc2fc80f6f0233142ca03ea00e167d913197f9b39f2eedc2260eba324ab45127dba6beb8af0ef9175d628f28a498a336fb8d141fb643da5ce68732a3516c49b623a2a07a8bae8db4bc0a91d29e240c12dc8050f79dcd8aaf792e35fbc7d5e202bc214ef46a29d7f6387daddf4dbf3b24b79b26b33ae79011aeda91626ae9e67207d7aba64982bdfb26477afc8710236d0af8f5f4806feff1488d47e91f4fe80446182ddcf19a454360235b470cdb639e302deb3115f66a6e06707a99d8d244c7637643c69b48512d07732218726c3b3d2710ec47e8cb080a770925f0f688f4ab1f15443a15e186a111cbc5b32b5e740242704597592350276f220c13b3103d7f470d72f64344387f289170b6515bee6606aea35d7af7a1497aee4ce8a4b18c4be772aaf26074d9b4e2b0e238bc96d80122c3ae9877b61b8328457fc4fd76b4f686515e7302ce91ade7c47fc54c66e695477d65bed89e354768ee2d67c2f798f6dd4aaae873cf2a671cb9ec5527b63312be58d9cd0044ec9be5f25e5516d67de913a836a767b79dc0f34e3d11b4681bf125d54cf1db8ae940e5401442705c8c2bd9d9bf08877a89fe92b38c4ae562fa96c535e80e1f7371304be70fefb9e4374b601ea5246a0625ccfa3ffbd79ea21a5d5ea25aa8609215f5e755b63ca810cc31edce763e0a211b481316f5590692ad6b23654635651a50edae4765a13c8870262e62468acfb5c455b4c4f3a606787ba40faf1d486cb27f308f59811146b615c27074fdca3bc9a84934dc7cbdb969b34ad7d416f78a431ce299533b220ebe549266d9b725623bd7a6af59616c67f22a246a8357cd846a75180d0749c008ab78e01cea5567c136f0b11ae7a9e75de56ac8256acb2774f1e6b52148bc3281a13e5ea1b552a4993169a55f04df8410c23289f8bbef72a40f927fb4fab872382b91414fe83d01622fd9f0b8a8fd03d4810857a36c922f64a4bcda558f5ecf39f0bca6f1cce3172d69c910693cb0fb2ad7ad161e7daa4375bf6d851f20da1177e351dc48c1a075fc4a7200d74192d3f03c4ceca05e7b0f5cf68fcd206909c0968906e10e6c1688a26a515c37f886cc7d6c2f8808fcd883f046d4644c3872b892f65b3a3b2dd9579fc2e45a95807b6ff66bc1ae27af0306c8381e2946bab04c4c197900edf8df0066fa7a10feda4c9fe2454d577284c1943d5a96e249c19dde19e1f8a8486bb8d94cc40959f6f75b86d08cee31625013267d266e8ebde6dd276f34371ce82ef3d65f820cc77d1d3151add7b394513e017803757d6b42223ea8ed266aa44d5288e4bd596f65470c972f0d1de0a89910c0d7681c7d3dda71f81a35a657e24640613b1851ffe2ab0a6a5508d0d14806ebac673c6d14d031443dc08597d9c41d58826863546877c89b0af6af4b9fc4a7db11e05504df155e78ec6d4ace5d2960e8210627df37de74cee0a3be1f00fe395b078fa9c42a0e1fb0cdd403b0a729173ca88f694778b9855be59d7498b6c8005443f79aba01ed9e9f8f6ba8c5ff41626fb7789e8e938985273beb9b53302f82107ce58d499bd8b9904952623d9ab94fc2ffaaeea59183f2607aae4d5603e6e29f7009bc2fc6526d58ab753cca2799be2d4968506076a0d68e20612cb3dd347d80b284b9fe90ce29a748e9a96a93efc45af6e06fbec4a707470ab50b86f93b904ca251a4f8796861f4fcf4170fda6b419ebcb20616da12ecc42efd5adb4f58034f3471671428428b8e2b405c5744fd400cd3173dd3be143485c3ac5925c48bc6837332fbb162a203b9ac43274205ddd4db1d8a97816b860b1577126130416a2127b54350cf4af64d95835029d01b7159f48136cab88b2ffe9c70da75ecf7a62bfa3b6cb5691352092984aeb17ac3743742b40de56ff5499f43122b864c5699a64ffe0a906481a050f65e428157bb4228df8d2495251ea04115b7c02183922f5058e5335e5adbb6e5c585dd83d51ef0e16ef8bbb5f11612198e3d21a787acbf6cb895efe830d8cd6b5c325dab0d3e0ee2042b94a0a717850f226c67dc357132f9ed16f88126bc0793d23a6dff00094099b9e5155351e27a0e89215333d5bb70653fe2e2a426fc69a344f975761753423dffa86ddf8adc59a19ccfd6cf94669c44fc598999480eab7469841b0f2cc37ef0a7788bb5f85a7bf9299294718f425e3b33bea5be69d76fc3a00763c8deff2988b609abcd9e5e7585b47b6197a00ed627f8eee838a94cbae80028c36ff62e513ad5489bbd3efaef5b7badc7e0bf3866c3daff6c09ad4ef09df62a6aa932b41161a1b4094c225fbb9e06daf6e888574396c500c9cd6f57eabbe114b3096509140a5fefa85f1b1d88600655bf05068b7a43a833a465e29428087eaa314d6880f483c3884ba5e4d30dd3e285f26eed2f0a635bd5779b359857b6d237dca91ce272335259f9a0d4bf4716b205b9dc3def91e5b8161f36e644f7160a1951b5fcd6f322ec6beafcb25ab16cdc8de95614e76a3aeb2268e62053ed00dad00a704e3d4f2b5a80bd5263402f1acf656eda6f7afaf742d495b8de452551425232fc3329a48135f84b93be482b3a55b9aabd342f122dc3d3cb02fed2f77e4b8c8a56e9fc37719fc421e8ecf94f3919d27287b99127f5f772d73cf9149951301b2e42ccdfe19c2024b37ca9dc85d0c1a0d0ea33aba3ede5ca5c10915ae3c99f30316bb81a23ee11a2acbe3cb691b5e64ac5a448f9ca2180cf2c7d2a2a1579dd9aa5f9cc6dca6fc6110c69413c0c747904784e05ead4e78458fecc725216f0f480e46b69ec631b39efe7a8b389d0aa81719bc1c5bd0ad6d689ff1ce028ee5a8bf7d5a939fa09ca2c42ed47f1ae700d9cf71036221f9ef660d24e2fec73232f640ea5e18ea8ce4f219d0e415bb22324298fae0ef21cfee4de122a9d534504a861e24ad78b8bf34df50b9b6a491f8153c8b61d156593047aa2a449a10954ebd2915a2cd968f3e3cd176d715ee9bab7db74e92747318172c359b3817666d7f8d3892778890045f95dbfb8e211f695fb89e02d49dc24a976a6cb09eb95d41baa9d8c42ed9bb8cb8ccc73a6440704e9c17c69e9f98f18366033d5124fc59ecdce10b2bacf452017fd270fa4ca67c5f973b8c1016c1fa39908b8ea702c17e2feab4c0b6512fc83ad82a737b5447f1b845952ef22af849132446b951a769a5e1ad7074dd59b43a4ea8a4390b230431dec95a1c5b355b6b969dc31df1049299f9a868db3c408af8e99be282248a1a1083e2bbb45844eccbaab0555d5021aeda340601588cd51c49c385e7d3676dd5fe42ac01ee772a939162b9e443297d295215672a9625e355d6eb2b9ddb0bc89ff6b98f5448d6937f19114b73c87f1d7522ce6ad0801d9e6fc8445e6c94471ce8263df62752f37c4ef83d6fd350909eb05ab7f38a5466bf511294cfbe282acbc4b127db430252cab0aaccee0c1ff79b3e84c257af767d3f6b6e134f5cf06e902b8fd0d1323654cdab01cd65e613273066da5372c229c78b4d13c6085249679d3985db35a48f340715fc2885588239f970d71295990a89d1de9f8676dad02578252b8e53e0cacc390f441ed07d47aa6bc8929f8aa3d5ce9ba03675a7b6fa9759b7d147c707ac9ec34206b79842a6435e71dbe45794b68985feb42d1c13780e461333ede338c2709498f6bff1848fdad2dd9581ab3a0a0677df40058769778d649a27c0f11a6a2d99900aeb378ec450e40e4ebe8b0ad13df9fe3e096c741947364eda3ceaedf29ba3193cd6d033bc3a02bf44eb5da02a82bc9636d37d48859f87ce6fbdd77de8580091afc65a27f88075be2eaaed8d6ed3b5eacc8eea165c8094c736e6f5a5fe247d763c1bdabffa0b365547e1a24080271a03e69cf58818868012cc10649fffbac2e5a16f757e19700bd25ba182e37e6e46115a48a4b7df01bf7c0c58f51ee0ec690f902ef68d7224c62bd203bf1a8284b645b9163de865d288a3db2a15c77e5bf09c37c77b66d8297b7f3e120c00c7225d77de49758568ddedcb3fbdc8ea1e5985d5f5833dfffe4c284cbcd0b495edde6e6ed571a364cf4044a582ad86aba2a5e9ff6c3e662fa87c4b11313adbe06ec22ad3392265cd45d13d5a2e16703511ea614251b087f360dff64f9822aeb62a55850d578b2a50710a8f4b1451fe5fe9bbf245b9403df4907883146827d05cad4d7468d01472c0297812e64397f61950df7ab137f535201184a5364d606b1450a1a07fd133562780983f1103c80a013190cf5625176f450aca643de4fada51838a20897866503808fcd8a383aa69f6421c5f4902f1afc6fd66fc95c2dce2e0b9f165d4ab0ccf49a9f62d099d1af5f51dde00e04dce800c23304da0e0ece5568860e0584249afcaf379ce4049c46f4ed9cded11ed238ef778192f6ed88109faba11b198e4069d762adaa68b59bb367e1447edbe5db054a267836b4dbcff743e8810a8b1b776ae1de57add17286b1459d21a35f4cc5e87037313c6a83bf0d8cd87694b3e61221d2fb5035996ee35135d7569a76a337deea0782d8b28b30afdba86d4d2fc7da79a1e71832e08d9c21e77be56e1ec2c92eb8880ba9fc33af2b4a3dc70124f57d31793edee1c2f18a900e45294f694993188adf7451c67484e2305113357907f415a580fdb906a938eecd646fa6ba8aee7c14265d1e6e3fce73e68f6d7ce815d7e6148d5aaca73c02931a2aec8010db9de40e0cb9cd221a09e1144600f0090f01ebc1840e245699b19ef64620a4513d0da0a883d555653702d747a6b6a988762b84a9c3c1a4abad2a1d28f7453ef5f079c52f536729709440d97038e9296f066f4b194b1d5441fcada5a5dac2e7f499ea33b949ace93e3fdd1b7c7efb8fe6b7d3a2c8ca3711d5484c4fb34f594e717cc0c06717647bbd7b8024e4462e382a85864a431e4cf1065a530f17d77740feac2bf2a2086bad95202cf4d80a961f25cda337a8f905e663a578244146f28b53600a3ef98245a6cc87c7d5845eca6d4e250a043d216fd2afd4d90c940c685bf125166ed6fa283540d8ddb1abeebe9f951fa9b95573714703bbe743ab216a4105ecbb6d11a4f9310c422dc7565bdf6b95bf006edf9f9e85f05f5794cbd9de3c45b796efe75fbe71b296d32940f6039ce517b300883eaa7be7646d18317aed987549d525765feedf052c35991260e9e8d514cccf009e55d4d45f0ef951d9f9893b0fac51252ea6cc7aaac7a280a921ebd9ad2bc094be5466bb9086bfd300732114d4115252a58639867aefc7ad65faf67a852eba724ea3aff93936b6d7753d48151a3fc0a325fcf381ca1cc9ea45d58e60feb76be4a498ba633b095ef75af06b2f2d4c6acf0512e12f6465f2c33393891144adea5e53f6874f73ace4096c8d4ea15535944928f1794858beedce82027e7ee11097155c51810b29116f3fed05882e4fbd4d15ab18a0661d55201d6ba9be008beefb2cac371261abbb021229f62d0129d8576f0a6eb80f96afabca90718b81de6ca21ded8aaafec44a50f48ff561dd0a28c55120796314abe9a8c8fdece6faee11b7f9bff59d1a7bf89d371a6be6d438bce86f7df367ba0c699ceb95eef18d45d63058a7d3e086f720fc44225cf4b9276636117819b2841bd908e0e5b50a34030924e353f29157713520fc312ecf6fa9c651e6436440694ffb5c87cdc36e30703e272e6dfe6659b7353692ff573fb1e71f8d08f6704fe8f631afbc2c607efdc03a8a17560d25b94b150a3a242e33f97297cebc514fe7447479738ea8f0c2523b8e705670bbca52d427a5ca7329cfc27b78c5779f695728c2f7a96bf607ec32c1a22dba24381d4bcca3e334f4c27520d40b222c6fe2c2e4fd42f240087e31dde54a421c16f7e8408b67eb65f2c4e9cc4a438b2f482af7b63b2d9d8c07a11a334845fe42ece0512979e597254c2c041691514c6fe3b5aa8af27bebaaf1f03d8c5385c3a22a5d95ac1bb9c228f4e082a9e904bebaa7f85953ebace1352223a333326e24a358dd549a62b7f064dbe742bc69bd8d71de6ac94921ef7147e57d0fecb14385f444a1b8e5ad25e6f6576718ceb3382c6ba09f13ed8e637ff89021793e308e6619bdc953c5f236ef28bcca08b9e4459f36a3273035851c13c3a8dcf7d19794c47a3e81f0f2d6736977bff735cd6f407cb81e32876728df7187e63481062aef132367c5fd908ad520ad6481e7e80b4d743c21a499dccf0659d292ab67395e9ec34b040522d6b48249df63adafddf03880013cc175ebee1e247014384a1747f576bc9a46250c0a878d7bd1571d1af5dc466c2972a6a1fc8d3a8e6399532359eabaa7f3180a90921a0f0ce47801fa1756fbe1cf1b55c8be6722a81d18eb7573b0bb82863fb343f9c2b54b9771b691344c72178694ea9063489c0048b378d4fc0f9443143553b375e9490397771146c64ba4b3dea83cade48e4909d3e22d229658d364362b08cda01e8d4b5e89e777840cb07e82140747e236e70c9e4167b7a6f78dc9f8f7b948ce9feb6f1c3e83f772dd421239c27dddb414545bedad23e3a32f34d277cac033bf18f44bbea30a1a1f9f68d9788b9c3989bc68a0450f9bd85214f88a0fde5a136f16bce33f99ed9c079cbfb41fc2434a8d947f8936a0b752cc5e15caca6e1a5977b5ded37479580ed47b6035cc08024233454342d1628f05f25f9ad88bbd5275dddbdb0734b847b0fa17b5b409217b2b6bb9654df125d28ee76f1c509763eadf5c1aa132ba066ed9a8e00d89fa0cad81bf21febcc3c281cadc5a93d0a6fe95e7564016a597f5e409da6054f0be9bdf041f0631f844f003cb6a146308829852577210231d7c1b921de6ac27567f324cbc510674452c0043c83f9eeaf0b8e2d8b2c7a52704e0974c93b782875c29be89e8d190377fa84b86a9faab98e51960120c93e9afe011d00200ee2b9f6313c89bfc092442b4344e296c554825b633c5a69c4563faef06699541f1ef242b9bfbe1cdde3e04d7eb27488665b528e3c23fd55434bc0f029c7b1feae5d9458ff06f333cefb4427194d931e729a1ad2f8e3795a80e51038b7ef455e532ecc36a0385019dbe8b208a99ddc22bf4fc2c4c4b760f307a5600239d085007aa7dacabbae37895d0b3c48a190ac166b1bbe7bea7c37f3c02e1678fcda875bf78cf6f517b4521177a6c79f6cffd16a27e93b088f8481326326e6f208788f69ef452fd7af4381aa42e165897ec618eee806ce440e119886a9c85dc3dd5e42eaa6b599b95e086e38179da56fb63c751643cfd0c35cfa3017f78d3c83552cd7524af4005b20e9d722b02ac3fa47d4b86680f2364b64fdc43134d0ea337aaaeb21310a3ab0ad52d4c8d59ee82b0dd318c5b7dac642abea90bc2508f2ff7928a1d9ac70c6d291e273b9d4a792040572bd2674e3f4167fee57678f6a33860bbb9c170a3ee77eeb3b2585a10b24499ad59bc9ff36c9d09e7d58c69eedec72dda5fbba9f52877077d2a05c68bc69a3efb56f16e3d3ceed2f5129f0dfc958367de6c992a87affcc787a4f1b8f4d1bb7a3bae2c407e0e1eb9b932be5a7c3f357bbb150155a3e19617825de869ead9512f6b8df4e8277dc6f3ae32f53c3499652b5d5b3060d37585e820f7ef3fbe723707f1220868f03d9a10cd71f7eed6440c89537be86c4e310bd77d003fb1f1cdfbbbd6ecb72eb825fa4044ec0de97b9675143af899c4d8362a3ba4512adb2ffdbd9570ac287107fe3b9ccf06db48e7b07132c924d10e93eb536523ae6170638f03b8e80e637db7fe7b257731c82a6239dc30113d4ffe41b00b995b24ff84ecf0fed34d042a1b07df278d55205e2c485a8872154eb072a27f578fd6e28399758e6ef1dc3e1b262d4f63c6e53cf194d28ed7879f793df6707cbcbd4507eabb1ad519c314eaa1a5fce372f8f6c44a0500e357bd469d4267d9f8cfff6b61ef04201e201921b0d20a1f776a73defcd27db4c1b63e359c9328204c44e0c5634567845c986d985ef8e68e0d4d1e9c6aa42253f8047c9fbe4c1f42d0471ef9ef8094886b03c1754a1c4d87247c5b63b15a681b15c0031f9bb5dbcde62897ca1f484f6542dc1dcf189b06039d0715d2f5b93c1acd08c0635ad86cc2c18d329a472306743c27bb745dc056240a434f7ca0b81ba5722b6231fc299dc63aa8086d751f5c5f644a2f9bc923fa75e34d28db4cf85396f26a3c8bc7394ade22b74ab9792e15208aeb2ff36654f5cddd6438bd007c8c880361e1ae638cc1f3c4fde612361e4751363debd2394419f245847ba1dcb275215872e8d91c1ebf8e32b78958dc6be54d60bb2ba26a2df20cae8698e30bf9f720cde3f0bde354349fb4f20a428133138ba5c2261c4ef5afb14c71896cb81f324645fd507fcb4f338cbdc17daeb3807f289f9429e05784049fbe7a7f91312dee1082debd486b882cb4298f74e1b4f3b43a4a3b309bc377b1fb8d83caf228d603eb3dd3c6110da9279cd52a3e51d501e71260b191e1b92644e513181fe3df5b97f39942708503d9d82198328fbe656122582603b42231a7a43124ff52db088e589c925732893a692b9796f807690d70b706ba4a65d4aed387fb52265cbd537d585fec2c6cff6c35f0939f4779056a77ee847cf8d45c67fa1d6527b56df4447aba51e587148a7871fb58ba52c2c6aad383463da7715a4bc1bf652375872631952e89b9d1a9e24b742b831b17c6f394a2790dc1be9699ab285f72692adad25ae0e4b0e6a6435036b70abf83cc6dc9457e4b697906d8f54846782523bc2834731b87eca77e9963115d15747952c59f490a5aa749964ff676572abe279bc015a26eab645d62753748854233bfc70a5967343356f30f4f7f9315cda04bef4fe1ccbdf64589c19e3aaabb4670d8e6681ac82c8bba6cbd7f191ca2aa95ab4815326b334ffc14883f8fdc236e3edc8c6233544e540f723c6a98199c918a859ea4ddb28fe09c5271aa71f52a7ad58416eba5b9ea53233681bfd7620dbea60c3ba6fd8746ae3e68dcfce48049d676768fb19ba59d6fb7018620b8a4fe5e87f6e2bf705b528fd4ef879ff6b3b0792f94343ccbc8f9db2ee3eda184f8db26f9864f848812863c3d5639ca42a73307d1f338d74d4fbbc54b4ee4a37e1dbe8ded21172cc734b7c90006e99472900f99c899d5719cbddcb1571db17d1725caf0745166d0ddf274aab87c6dd1796a0166795765016d417ea0c3d506b82d71b4008baee61865d74066ce1bd07a1a2b4a1051c4a0a294567f8b53cdb6633669960b0fc4b8df562f1147c075f8ebcb7d8ef66fb800d5d22fad1f0e39684a72a532107b0259ba6792704f3666b5ca035964caa36560a1a177e69fb38b1bfef33650bc52840d062eb39960036e515d823934ecb9ad47c73aa923976d6c1fce41c82bb46ad47fca1153aa1cb2671879e11f9b65358d4a6b7a23141182ee7c7f174d3c44b5356e28bc74ddd8d00f57a528871e83716619be14c4bd08df5f43674be9b0b203f7c74944ea60b4a618f878f6cb882ec35a59ce4d52d5a133f5496e06ccbbbf83334cd5071fb06a71c7e3e04fcd8840e63811922269a55a1cf977a11ba0c56508d63799f9fc054476a5747edf720385d8f5c4fd51b43dce5057d6a459d686ff9cf1ccf8e57e43ce2d8a2bbf87568d24910871568e86abfe90c5383d916aff7cf89a892fc3f157ca4a8d71824053143b4da6098a041cf88d14181d018408d7059c852512db39c3a045d797f0d39ff758043755992b6c384bfbc265e8b85c34142260951871f3d0b655f840ffa3c2b47547507fd6ae00034ae709723a8e80f8ce5801b3e3b2aa6c029844fe53ab52b63b5af347f8be891469838b4495339a89eda0e986d8e20f60373581ccf4cfca7cac838b1f175eeec086a279f10d4eb11b921c40ee7864cf043a096ade4c6439986b52ed2b775f6ca3f942f107bdfa7a67f940dd79b098fbea671ac3f4a79087e951ee21ddbb2bc45b08257a7aadd3216b7f46e8f112a4a71883e9ee3c53feadc5b912da44aacdbecc8707e5400e8b4878bf62a475b2e28115b90f187ed54b9cada907d1131d63f5de0be5b0462b9954a75a3dc0211eb1fca66f77e50a1166379973425ce75054e30e09e8aafe278cedd6272310ac06929dcd10d2b92d0fef6e41e0b93c0bc95d10a46a149a01121aae51f67d9d3a777093df7801378b4745be0db86bc809821c4b463cbe0be3ca458a5e565c723b71b02efff650ad6eef5e89e045ee539b971fd05f001014268c729abe4e93c9bf7a191b34d8d4140f202d654dfc1e07482df07893fca9e736ade16c6d062d9cc0ca03a118ea7b05eb7463fa1d69ef3049ebf4b4f31a1b82b3c27b69d8fa4d6469117fc45a7fe280b483b8d8a2f277125ebd9d69bf6a54d956dfe1a1041d5881728127a6c30e3a2fc2612ef8b1e716d398d4d76d3b1beb60594dceb08761fa2376379a9f66bf2c75bf19dc949bf6c36665acc3317ff6718a1114afddd31fffcc9e74c22c326b29da3a68c42e297b18c11bd13383c718e912155d0aa088bc225e4d52cff4686f49a557ecb6ffe90c78eb4a63459b83f0d0618fb5801e24b715b3d0ca48086c9f6f24165e3f43339766f1f069d86ea65297ba4ec3718b92fc0969e06596b83a3c90a478cd8c7684f967656e49a3c9439478c4564ffbcbcdc2f60ba8b238ca4d06f173f9daeab34757431050922a53e1fb6b9323a15433f858ddc70b64a0dcdc8e6ea8918c5785b87f6c5784bf0b066eb548c8d298ab7ed1bcb4e6a2245767637c312ccc1d9e5ac5e86569e976feb1a569f6ee5e4bc22ab814a46f9f74dfcaf240528024ef04ba732b2c</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-up">
      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-up">内容已加密，请输入密码后阅读</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>华为杯</title>
    <url>/2023/09/27/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%8D%8E%E4%B8%BA%E6%9D%AF/</url>
    <content><![CDATA[<p>有幸参与研究生赛事</p>
<span id="more"></span>



<h1 id="next-prime"><a href="#next-prime" class="headerlink" title="next_prime"></a>next_prime</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime, iroot</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> flag[<span class="number">0</span>:<span class="number">4</span>]==<span class="string">b&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> size(m)&lt;<span class="number">500</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n=&#x27;</span>, n&gt;&gt;<span class="number">520</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c=&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 28576274811010794362153160897556935178530640825011441539841241257190782139295561904323347128956873569754645071205043238985141474388531008367238218822591</span></span><br><span class="line"><span class="string">c= 49502875285578675438052554215266678403659290915102322948363030271494959804587081871467110614683972929037615883922743651431683465100061968204901334627149795829429950385848753728500177164800064208215503246868631076011505268371936586645321659884527055007299822625570713613996139223348709621258028349513737798120</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>注意到$p,q$很接近，把移位后的$n$开2次方，可以得到$p$的高252位，随后进行爆破。</p>
<p>再利用<code>size(m)&lt;500</code>，可以把$p$当作模数进行求解</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">n = n &lt;&lt; <span class="number">520</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    p = gmpy2.next_prime(p)</span><br><span class="line">    d = gmpy2.invert(<span class="number">65537</span>,p-<span class="number">1</span>)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        </span><br><span class="line"><span class="comment">#flag&#123;90b344ca-867d-002e-915c-4a897faf0bbe&#125;</span></span><br></pre></td></tr></table></figure>













<h1 id="Step-By-step"><a href="#Step-By-step" class="headerlink" title="Step By step"></a>Step By step</h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line">flag = base64.b64encode(flag)</span><br><span class="line">part_size = <span class="built_in">len</span>(flag)//<span class="number">3</span></span><br><span class="line">part1 = flag[:part_size]</span><br><span class="line">part2 = flag[part_size:<span class="number">2</span> * part_size]</span><br><span class="line">part3 = flag[<span class="number">2</span> * part_size:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_keys</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(bits)</span><br><span class="line">        q = getPrime(bits)</span><br><span class="line">        n = p * q</span><br><span class="line">        k = random.randint(<span class="number">1</span>, n)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(p ** <span class="number">2</span> * k, (p - <span class="number">1</span>) // <span class="number">2</span>, p) + <span class="built_in">pow</span>(q ** <span class="number">2</span> * k, (q - <span class="number">1</span>) // <span class="number">2</span>, q) == p + q - <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> p, q, n, k</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bit_enc</span>(<span class="params">m,n</span>):</span><br><span class="line">    enc = []</span><br><span class="line">    m = <span class="built_in">bin</span>(bytes_to_long(m))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> m:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            r = random.randint(<span class="number">1</span>, n)</span><br><span class="line">            <span class="keyword">if</span> GCD(r, k) == <span class="number">1</span>:</span><br><span class="line">                enc.append((k ** <span class="built_in">int</span>(x) * r ** <span class="number">2</span>) % n)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;stepbystep.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;part_size = <span class="subst">&#123;part_size&#125;</span>\n&#x27;</span>)</span><br><span class="line">    p, q, n, k = gen_keys(<span class="number">1024</span>)</span><br><span class="line">    y = p ^ (bytes_to_long(part1) &lt;&lt; <span class="number">0x100</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;y = <span class="subst">&#123;y&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    enc1 = bit_enc(part2,n)</span><br><span class="line">    f.write(<span class="string">f&#x27;enc1 = <span class="subst">&#123;enc1&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    r = getPrime(<span class="number">1024</span>)</span><br><span class="line">    m = bytes_to_long(part3 + os.urandom(<span class="number">128</span>))</span><br><span class="line">    M = m % r</span><br><span class="line">    f.write(<span class="string">f&#x27;r = <span class="subst">&#123;r&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;M = <span class="subst">&#123;M&#125;</span>\n&#x27;</span>)</span><br><span class="line">    enc2 = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line">    f.write(<span class="string">f&#x27;enc2 = <span class="subst">&#123;enc2&#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">part_size = 32</span><br><span class="line">n = 28170615394813994128829444311922294768047711140557403853945487107089509134737767942656361548230221829951460844271639575394883663959935517401286468610803533794281322932272016151070004303694003064267127894498582758474889399072435632149814773794006700377495059535551601562497404157228212268055301420382159240876926718366155907065534007141933306379265213201601388196980959461243178574169497366868119687674891554278269534759630337252574501733517956676373291013127781435489132751470026441547613876124640645867844110455115246109355929378020562498143759261535211073747144498765678339037517382156239422037334011910477313579931</span><br><span class="line">y = 159220553107177193400023378107257900962478698517628796905876914005522464561698874246291191230998317763194901894991385290134307075261722076436131488895536910117912445041560442858379826501161163372467275224931272546634069502187842680578039864204499755434023932362315829340273816781101788682876410192428287564079</span><br><span class="line">enc1 = [4329764817812315828446029000904364191239990958949637574084938083315209184240421156324999952393657484925498565152021256494607879128908781983114161386773233877761015360983150476152188879673067820402780130089700234129678611683354395212212616575718773607360822879598080203335407111382268368008498423027220051792096684674912425386483869259429764331916468811184020204779565213639519259278266016641928177176668484572535689566444224491072932507222288855987783823718650822063130328026187325690601907181365773159771647515865731116111372566720244303612037805449124454939086529470633611352065816971120268530728617860742920668013, 26668102306639364855135856355763651227683599333397083188819835683451303632831224609344031930961740446795900402520462583445400552909615946843059401192100910201841816229508757135726985951926987254237392600963224841455347415104392678060751388564657835841678373873209753477434733262088722901011893389887593511574052919706851005017073735526827306446891363250896007919302191459506719320391480012172844938736519505482481406503986666696161645192008846926597435017915216589460545777594359492467091985478709953982838302464831161242492848401325292544174501237871845069969084700905686488816372729433646006791567262944455367739016, 6844078125337651272775424607620668866522240485694693608842649470742610100703425439968455577976969394181852381193846044735543995223768807347325967616379848732239727126570457351656175240931305247537451607658865181607891575819762943756479594541607562994075489557957332744121327416528927981226677030790670370640078284587335236530078507373446459043062236968758547005348378476768772011619000621368672432728997054226366429816199951693412308899897968044713019924726280740771455976700359519568818130969138209012053461667209340382107028989805200907615360055495697672636347124990777030067436694515895639282902832746618060610970, 16445916587011829288117477177744806954591866562333561291832896404767183745244588735028840851831708196817618686169345759919432768858117592036431399504568962310535059702868237188826277314810601217464923182498196049452748354829783565314615454005459893895098586259552023305027839163986536128682806093761197049332210752980672492994539760957319570771975078883263186215598624948074759626368175827647426656915331375203332203324216346867563573977484890640704861986659613265604060703424208018740052203374736459826889522082329823305009154365945214783049938660165171170531461498791201459397225185841341216331874697009036199986145, 22211432664265304825402740997238420168359181441282545342939168479723537519183885648429179373305869165607584021882005663420276620263886591107779135608972968690973425417716026815718229937987528308399623496352531489877608239338522248798736082632701162005616072647430047387419780667327844154816381472891171271106501621739721500965584580369568376933265860654010818096252518098549747470761119348553857928221419551983596081363326579972596648845402599354997168509533057268732555329346033143960638061942818923185209244429449278676686606068130877402399091827473858206997117238285641217592726457541201204393326812984144130286104, 16511232779912735072087490417595658551949968840055295914774841388154482033353432639030993940893907068034497970839592131576195272005629158445284845414139905286994063469467030298331711589743775359735931721642462645226340648278173659513085274755670895169310008219251006975203617791469761592470211801182901548636764670705016760114196708237453754643250912222907150769662702187456741276197200957629587032061417719824875911805802895943586708855675945895616117452718265880493364353726225157794273382562571497564629888571168472410804997637794113489283469847358173166655086168833941157071796878957132040997623213992744979717590, 27512480094103097276307227465314611547545346858211648942054525881667004167524830965569385257882995654409585906198988173817349347814674260381899986053289145982003908272056309665692702173697240608733910614419763821588941042143009788065303073634276352996799620386230711091221131240957848193094545073959784199926078237201427935735886744019644204079278430155818821118887092122691263007926633695313048672080827413326406179502240718781369712852614873058209447394875677790270956701259666548396273225360873370415081738047237391974759717107484394752280110411548830097447062784942716689970058190244679531253251236327882210489795, 26306532550457050485448815474301792204568917582934053647330750736906199558569339168158370210379253220431750531157286197635880817765270930826302265678510033908447481720905618769489494792965215447236454399227671298394255979900552517351237034015364922473318355366879192522833310772714750870855033934172693598635789568876667795263771308949609856175586072310213554484941517625618519654008863414698486200041977448647195631878675272608320938876533096920985369764810030732738355440108877024103126997372154602090678286147586682667933869240139315932721357276712877773098745428930877528886970034172240563829783902676727613469193, 9131267818786433114599619311362547055465175530253186866323428380004866131594635843841501249841686261174544336816994649394164202586959016200180745975746879086950709593786805148720138317793246967590914350437743731128046489169933445458607969773360388674060983405855013901402342317088931405101510475629583790001873450975810616065593474437693115366974331785770998527841784898750879578507668774413686200526727818846295097955990956309484172671784645930448294837960580539186913930454225187754163489018439011617635993103588325075527965649525422783908235490904887449991172484278972504658230450046804198707099537114621447899421, 12203699652864825912477971520136437121937440368649208171349786179885623451564743111590364508451654668415829793824178163535126143117530010798374620309649791333088807035522722209672161559755236536821303038837056513142962599576414048713872148613275313274094015373204422422010829484890388026088104989811785410352326638179743581937225537608450940852337069824236961553572414544157787927022837631664099139077640024883792378914296516636418168763906671141470291816312694962098415800429405553157733772735363984884052938687786734816628224981471142107014047349647001951529180497513120746906941093760413192282141658320585608311139, 20977447534293715276322934329345531084445260725534334850363011767717308861013736268335771084266777649936788312260818595161356604347097692475305854167279316998319033341373603164873935236410761117869000195922009064006201892787553151581326191897902679997662267251908210137505970942448675483263077081788342060104992998849070908987922008977597032022005189336482990484466887978809454188927983073014275289617432582859500906765971938594306218945145383348528551465534190076013646743595549792039933969792206269742981822765759375071009861443178831540308439073616458887238235174195573698391045229138378919224657930929272515335658, 22465073906413630105458956774632089589417389129704913381392841312216966186401259394147394213977429057445364385128674471768933060295390037913528215759779104754168520958835774213657359361109700100921698641908933197820277684740882703632993417153477618189682678172762980997612715664629128999735441370810193604768014394607142956284212757223919494092945332063152320935929251843951667193532881479975015337690687720466831597364201491667928952337934460997039749620727908983165004861946285560906127928264619049080114676909943356028636243742690563678521190941460525004111230626143362841283846412355587570290111948658430017336183, 3838517841103502313572694492344121913369386246866103636988930210837447543068679013388451740353238379111571560759447443235817506451097234728517204583175140392885192525119360189802153333867029331336945528452982104418420831366763206726445685074593701656215707559430928725303206313075557995703567722978861684440582728415616935260622130187911162586241437459374722672189211143848316594202032823364580311345618679076959922039906533048821203766064566438185775049012239074297738959103662308912079177329511839300928122806467173940092484304506640517700060614287748065375591705043074580786103438294126051507480272484576244810481, 25778799676245427936212845871451495109416323897589052712730145578317604816047290002351007327670652724145604612337696606722248647444724138285933318742143106903264811952002174815302602904272730010223041065205557965825809931399243505715420876206170035115394282112563224384973067924656887651601290183158795508195120376726739465841565917122550030616894516681404394386821072803009811236181667614684014469932087649651137775545462109035794363756847852660718173602416623551981977991751333999395943853629114614792455404447490778064387253000235814200592680174827990403705004759565664872486103776345104110990635045788034766811080, 2613327744100828691384465683450050784456977599449080697275221441118127874394066169654973689195803274309024059311164914899548367985147198106626020893082144268269471965928080835260319688707048473242132111203086975235834058957411648177601833134097201544818371911824700034562917634312861128370359564565116780710684979436532783465953695955186664908017546464902395276058644163756343220285168692290448155591910695900300550470656724061102851678767233939546189979842525853363169638440060571765241539037766577964809698764769613335701041335821466628352944265025939561051520179826884663371412524267975807120517099832505831272890, 8989639114313514632532783540841758616251903100393942242943730381138365743361262551964894081671051660442517788701470267404594453329426097713722427693818786657203082689609687724664807011166787960424252077447470730374684735267364398370360984831744782515142406080140650630689145450036046559508868465600446488642810839684800782567706356452671502541137116721915293569415578030248844485929688557064554336250794718659133841520137958208377746215513963640163185509376518508409399321496795210376618137754008925636840481296572845076452388754525187133737784949050911247591969022911646162103506046354544418545551873736720925790305, 20931313637219439952000007290536797104514079056746727100484937472570386795649559796480449298187608020337162216072917141373541903776567767352643461461722435081621219809478567771575557727639489055363988083951715025470493386894402641193480812674359872478330461782650878426250069953775187645254397593805069845047851186217756491807206389754282291655078325040960201809490814632998706189272721567824560360436626422612598294621690767073172130888170101377477859681488846626725401955404396981426279510315796212493622221740224577253830123735128030904246824427136736652039335749210399118009396828005653130298195221359615175268598, 7949279045319911820097441951312300779930785976399242690667162876182951256987415504736581682705035804115839562053466847318940146578889117539564476374799231304182973445573067897633397058123635121447651674994316238288055895563111254285684259601062397713071596220630489560726277659319157689038326189441307341158591375505970642111407531640054819328746280444660425381200050804453634302767778665434501644813365868515026819190560586573465107050060907215973332177239420429003914320360922959850611354243078821512191301076507207838574469529678065178914123960199234213869330792709700704776629646031888226416059974253098941809739, 27718427434995587916886703338452332174865252003660155612225708821755742468376323383404928220635551239723191212315945108304146835440700714329695577263583174476207090309139597750314014961613611619581959355337746870626258052841745664441195506484736116221222983702013786192061115658819852655053980190201910912091818852366637947464854229913713972820307314882855156784606400847518850987242104202449959634171223565572430889409902514591697395015551248756757786233719671753893186210607558083946261490323161708016165621086066389730908714651134951339190114075184266082469368624917783584183141752781797306203517252572348410142075, 8913647011767229054262485199804973151893156127440063738628134944908199784239723634412049869550792942391544599169370024025502343844147081452676190712534771312613457855865364324812684151798735372239785030559261681737709483070734038752902370003417873358125543955016115302890204432477578538835848762263320000649094452012566488760374141009316670432438057118591596380193599255070995815293333896788723833946322614504870396774306482599913489010319677797813475984159716493392314281392051842269287964441665480744908615348863904060955924809797319682418476115215509374358452939616319916595409100076347828470806108254161754892047, 5074253918528053953609771606143596554586027947842237605567537902638675417289397631945743807620415200078979753038623410843891913147617510170357031562570888242156069684897821507858441598732015048765676411154433397892515778633743597429832354210316560443581815256918249842128897473984309508497731259670851342726444217112696790829241339940561108823165688217936825603843449868045321769033979946301817735902384815914498209712233914580544589729684581110507789618169839332033578763157397025267750965426110724120922459357247102200489526516453394695182189232857820672903155093318304843162647865501401868778915222350934686565417, 12955068678963694200124556180215517062087568040733501314688312165084418062847011131962501151071651708125218858643723452954662439757196975687845017674064631785709480977841671976713397154346241105444676345356194358174552391568529167058633038149555505016050836173716492756026751383442968600556493633451803241120793777071495413583315251094712609313212440022629399210878124037634873051272132342201981914640923216308078157170848941934612035277678943264141746645828135265758363820496424016637846770525400574680805683535686783273422785309419988942412353839774688124457978733785050115302334852907666944287354771884631119822043, 3642460082158592853776769931136726272962424189660105990994792219865551895368327828874648776449478250244971591793458438595934718631178602136522988245339893704644186636299083478282241422070851918888308942581777650526021771192906502759251761684239927576394501129999872035374114518911128175033431547349805204011057889667505799788003346979432691635346577830612910355090901888253067870969375784335790728709957579933380861257833741224157486614239289893385144354262084580830094799938160992267265792911813704891469371555477517855272580327925799911118962085878124362604681360072329410595333081110651192331390822728874240329397, 5166750541605161816509347461319051246196828188598313556384772643738743990361076356263261095128654246390634842568011900472149583193345591728128501268693534936493235958457391730763572960869841122765738066250779149480518189223416475264109774586433970717417623635455705671807416161914973362342686251503521716942940525181997254379373186356976847612806287432776139012200933413881593373721621687694207321390364955296734863836974867975577780864451253796093164756185549394979118848264193765644307097263881956289444534936268872884309801160842335305121014166758954356312873779887896207277080613654470072721852802698373511200148, 6093961619594833775221263098571093663245595037087631733811692201358413159700381422981640080997589780579201336475029669984610933656205198826215611408872773565637446985195560594046065448747898702450232707029597320681670719653890522218541237307878510508477291585164645351533795600297317807848631243866576228025374751881954227958229116873297138971937614123309808929391165552633558297615290551850110925782947075676058684907841873435618731288060401562496873598845178866282751959923985296895411859203966257489280550786960157117247672716952627734319509782897748031438066395942842839143152175797316547241379616365084779355202, 21455802952003267464531527415990439491953063167864525348660387781224692299499911555426762777927278620148928006696821885196185314946262826401762163520774308918130643557979470423013016851168148536000697942754068103415105207061367832097417129557370046524575222644825726775799053685384914602176070127514365229914161706441809669765602615170528497758435542498366443718943620579582024720709301004986900085265543725030468140393719039075883840435605126538335859505420727999877176343426743933287559764510940062835545861427122983692065712100588567248224526324308555058982291003837737800018312818046265103590208331068188803379205, 9886619406464975116821162439203665144760128138549336630767651231502965119225959986657225909264119421700892086154360893315660606657515619175248429402120402085495850956721926322630459966409731052577313441904331794958007781098961608673816691365977303126955850227849879342250902061569708333862362725039673345380524552237676311029140076655861175405673019194902854804795708290709371382438545056611529853993343043909576128240363211560003782134240776641891811990335580527704091316107583017724145287601960134289241241236828089220360292108028044262083366755606799975881904832157086151354139067311436042511741243526675413427832, 10543870043145184589598135994189204846325435698717723919689594400126649136437303037438842775386929876102856324726078932456048764307503896456931579507284923270960715914050584856778335167261492857616666785172920530225005039483098464292807273070807341084496113325145704973409141290652580584350070881743017912724850431833754382210887218056039048157775159533144870239204709888934837984292801058937680157091954728532494672660870886686280921904202901446236870547682725708598050675704461192959430105322430548846921860874558360174269682693479222305099553208072202445247544416492478359837800802533934040587695103320450268350056, 3862789116089687763271777668069568090699261546216877884587184367602657629577062191729510959704603562749367169242393208996995144782782727547300626100279078317866863305847248934030562714901279695998489192766882643978237657012852698396930412979467634862661814667112891842012124945672211146123759866576681338450336868429530316030792157393591004906680429057987394070498553664296976008114473641384985653916669354004856850145606144334819354982313458009312997556165187870202357426251549829211573117823450362406430740520833360385900537691312111373464399028288005800592685720544245105483678676512888440429001960886157153453022, 19422937240544989971016075745123272243575865034532093638601568117378990848092067776501926269219664362716977352964171431850476509677841175911264311638202958787269602430985034928217482621431712987362764128097726538371327989834560056984460560943547037346466905700971407751223199543026250738702042996773665753691786149939215702946509200567509073553003548904354591211446418314210790591426448369133939937684035642785712730826482523597860763521558122428425575506501642139963921470109680437286142212167639848665254669765144876799009843003666134359611069860186211646214651897310219709573278320953254450131690339667100194179978, 13039631445387105446699484310062794799138291232189492853933743242003584379444356985823361780310710715788295423840990349747759734878046259432175936582332959437707616389785739887338181004561546630771848569858805640576111945869244529576942228055393770981898926871473660087837048638986310598964833959107577868478414641803337707285756855257749708699275838820951953056099747563406492384576490331099552895304664013381796568006567631326422378482946840065205655781147751770018748429788323738217417717442989318561283507796904086887086703075701369976608396766293347625287160911224046825488081020435288162579155450225796155373918, 12941976470609893861458984715589269870307271179414842121441943769960786422652134875942453122593819450230452121172726837234442189555186400574762846884398362530187253523036027884876608477434854415810087615876163935664250685253449365098784445717304596516714508825485154853931043876556438851800144567010602350584634595185044104941147048885746734288979291429535865151023055045843686913224416341934414890136068659392702066253724388563319268490386409741839354631906979873433040597413944786089170448931351419551456274785959253336300713458973918108079428868036398788719725374218627426148854705949903219636891283670485882361669, 17059192418742209540110440610803004367017332689815981838285234302416943715610940509925887353432600181892828159654521751179793810701018308539180274332798488149053363770339048721517205078721793470565268874930318758009892049886264775952994722139069845274599254967394288107349209183369977938263486285654721141697350641864300431572061574192903962160710197726860015635563366730161453124080744681476708620988581053286372818027532588711664923796604547226308688216049418729804141189950272073350475186595689690537383144670554794855015202279311549578948114549496640406192145691101402459636503051804917919632752170719416666338687, 24483487005019952063092904974630311651599954798139598954933184517291521147237054004571507610663313616731613892186410107871912549077905874150305560476736311617352834528041646291566324344151304540651773889798511003379037570409502674863353856414885241854264593587858757335736356637738000021741298499819161723553915730172440351937854508566403943082317717700415973475312133415303245651387250181495269404026733885921604647181882556587765521522077719591141233664439202763565883311357674505268512459795363493717529768696120454275519571028281232577329687509774132117207123429343144531562947382881460601154902801584610067800804, 13834989912724533598545682746238093531359563869308503695212481835831597862145243782961184878389373071977031228722241722884100634110344088995484412190509377400756857817566203243190474815942426595892796302240560174241012033680326134210222521796177819062676127225914638754116835994423155135510996950809958813842227486123668284573773995786748972365362390504447868641531948748446618994530060209402064654951543248722758849251706483570500947267168279640321089546289471774661100898580957231213532571391102343590120329576905912690308561102922580749685791851542383338447686079604508866910977302418517335162793072421985642351012, 20539892074054957109730723471250931250651403162091355793468909858320740901018845346338614626812730079398010843547138247222119489396799804194528633745930739022034469454771979633745390791064862901984484710871892684559503249922407525233215879531661629636499770323378655824637489913067741978083441493010268277257632174844046983686898969010445746723227245924176165531411189290705850313362548616476040111635215397881138247916273310154951004382692717028306911124573110553879075134713158740173257441451862023089724666630938456678373104308707156916449022798339527510664776324806419005663505567897925148018644676253125921680051, 12298536618150676219722059226807103901448157840354776628163581898169085530234194647689648179745460165576083827892392208574129435698753998200830435178051814784236137183727815279135524884152773873639273126781088753833381329681751512986820339944235361375244101642904430898208509102692158455195109359121935507259208291443432324864554954454166617881831565940853142934739377016668893515849115156361237877577982728356810583866216894538630667527191415502202720764350878850172294706700288423733130268577776451638583281546443790341625211861151195874361408168368350985419722596639470952509859011850715064482072351337686110995734, 16451959737755692861441974344163583107033119202323859115077739555237207527986305864477283285572361788198715591926534326480479008753834441167229455739851755944213399046694183211577473454395523536050371898905702318077456826483996286165790087312037110797046080327503571048734280508587179151442434628596229594131463943095913162945409956822272173368654259613677093429115421290395908779942952392385583850091025225598010572565841933978529497323836040272663625798072164497749187168173299144316116567978967400838588810183416187107813714108315060884773242396310464872316643609792705096781390597728962618589398264546093636161417, 18292714258467659909962112396780549598260457460046744933968030932078648597282311342069588838227241234014699458965633143878589105107593099562979536289488772671125501896934299687063926112094633389298542355843723863621686173623567775511285591173336689480705430195353170265504001896770283950114579638192787849850006891411686409864981355947977087744110852464193643324402850316726378982267232274124180792950060041498435967507735028616826563266845534126625586550734366255000035227291609435571384234798443510659538469558670635878299407671256406252579921979997203552642287142887747740385187313529682084484293187176926603526413, 11947175014309930243460711562525752972551280403945553320089168750563938371993629613287287430302199885409790484384034746455963237692316982929693810225468687508511401173091040095741545963363577595598799146682597983888094052675179540392184017410806459566469369708779678494087554626305412450279904696984088437052546561147651822427798855537859668447355171854745888335902707459362912593851728312113035743018080557752710494921859035315504385225746236733811429513175871674676624406659305033511264226082960346234660769202294047545429696983186577688269612150748780525774879486633527533847350917969874353742659093571624635747901, 7523731393313857905961009157735705524362919935213253045769006855676255490002634136608983754027761334102742947587971363858915094399789397459075979917689883259764092235483425158739255245380562402494562702400021734793758184374579177969048959989188346917535110199161505454866821849183959342644404743034565742753344285709838915843201577568630540364392561605382208563366040082331553692938039782805278046399964455666473498057099643953064180319483046119328440881603149968047883229224123845074945192590835417442090398561772103835745066024662528290910259970844518693341876779905253064769500441940439840569379963015453498148548, 11387491549999282604473026373123327639544347269145663100284694647732742566207128354972945447384764959041021769136133767859956145124185632201178445596305402385195148578957473570452265812135084980217279491804345119219899535598917540403440805352356792322782373870976881359664217555475759628714393323565418669357222204725226602953179506953444632617281581732443392771514644735063048457335135277888885998253585140401393483662262918181734687591372021543533079306380557236312058969160494419058669083781496549008087480116151293341081306396120179498514129869123550083129850283703075652642728103230590213195981650047924264447762, 12960813842809939694413473065553598618005600913521088242956094113367962581176805671584311206293236352262318456776365952208448342837829132941611025748509181895250696992599826896991348907308555303504472000956710178537466316134450364457199922133555867358592604121812364955693454201952600315035058778411960225222721571369310644131699363519979929343590101267204883661314114432605864665622690374344784319926111381572617392359088117443618722563664472443216323525356972069961417701292966992572738576547965839396557464303666550934527207264955836620340906742966866710745596496076850448057435164795636542646715043051425487453728, 15340085496132082317796322660450658040422692974957680797453670937524963817286226018085593715130008676428289815097283794065166511342319866190920859763654938113556187119846209520035154651521665453299768531875912522598518112437008827383273054132354911401134831228357120608537083381662031584997002575806219586867072190958556145707457893236947553857060437228866541815625736827959935753439899991905153130623957566924027234721366619205241931245697748674391505476062615283747736676328521634667214794085850798598738921499243454424107384295914645270074245150187522522189695801348105167858980744286852379767977143544012095820483, 11431486122537028552973820592057387615931124673223903588515291969613945399068378273599744852236436396511555555804704677141497497471022750303687426308463961697914772738039963301031667613634584676961717058628954190709284989970094249321049397134903223159494819459159955301370181032145021782781184243212660312108109342495477858146284789568210956652198170266822233213381031858324801847038810050101845946541760477340718433316217656138342319316719264405761066200926870141651738732774899369093547905760171635659640451523315466561321609067104444896994423648968057120169347266443048802902253400281247140012238713184461525482339, 13701313919957104438975348293448069715578284892105983893763943107039764685543313323453929075713811974408833003487716291990653971731018294660859463684650253936378631267502936983929420095459409139636148484563004583040832806607536250689480741548242118266872702824501739830107375479354199992671875731527443878660256203235884692240623686894460888293510039048591965240841714571037069026381490937843112299450446511100268159493059821530405043155562073153885482992682103847682015304144754362588728500455964337504426609628824955547423708090171879541145956012278276726344396315633053377690280183575254652217220420002852646166363, 23653201980406821060511574463469927286915811843587244502865197528731907767997684862570049110096233093060913134085447688115097350353688693253610377932778179606539140602982802138381988155036736183812356573552197097847137232543153831221712010051293652466788152887211522778621746535052902675222348395816127370360227008969190693932278632449916286266037601666010666411532759202166602209851650340081603866925535180230240994799470598221713669331334348945312410563779657156091151600057115993769512922978603203881795273627039121889992229719256344000254637720346071672866883420333243081366835074789208301773562539148270834545741, 816953932336804343449143333341737489487723611801566598815287965084690708948172686274378426265339464347318737025686195008676751256968246117079246731343205279089239919111050564795723529769976846726554798472972458921182487930936075429435640820748595501645516241618899263870960686423283858254946707378114852998317169501239790561563720658733858979878493499585391097344844948000619720387701201573416703483101890730904898999633137286221143694379203095854434533624614745314008931239938727728996873602107776472966943422795908048196795438152786861388160004723609530958268007456820419867136853247532453257127106298675988569857, 5944859788885576200475703888722699697574203982432129651554047609698247337343896325978967201485439963524225439852512922901796441253780746334614838001435833678445546096111035046046055819171482252031912233522810576662293260626112843543509633123118382160551072845518865430305233136539111251313169058669262112075641728734931037374956902850368181478927587402370057285006677872448575415070177181975589894615651075673663694670611633346207701352316698240925885850988954639170643570910740323202327847562646212793876009814914727396979288451098209194220219824339916899015006363819278906424227462446273294815874545014274673041507, 24427738111434277422590473670818387851876538871403765153461727290644497420789576448474761755998583109264891844937733350303730997997163829853236226467419015776924903419427006954180902826537880606001845186771681748165277280001819982487673375819222934157234919357381108903749416577305464520621179809519201700731534308373222880106828366146236781740291172953968568125773868931708545299709583724682908528005176506161574968235859557307619131236623143304595092593336769265754509145869108972447335165751153657781460251333208494426845493664533161383158440971463083438599385907890207568512220382541820099378009911324079698403116, 684712598971276613107936330293189204689268410783857138591625317046138995169260253189285424377730691473603282716561322601164434282840602288991190326456823386369239741359236411961591963011366376627520006367076197958647521619562958560633528999696694412887147793388603229338592066018515505352599628782243896672931009436968535494621238184276137736145842769328322229372617074994432251565144165324536674742375866156440655501716105813657179143225691281280508517970757749909758947789029808895867409286736948046518942867197327045913917865628336919931499910688910535916602309071706753622519926053513794002475167869682157890352, 16636194938881213830177271590175850044166898631952946630176580718835146862184700385532752842836031631025594030303788013850486575735772857667122219847112784559025782784554803011398699035848347539853167873360316767693124020459701565964622373306878626821223074989993197012815635181713087310851421077726362595404723656490217022848330271080530099039734653126457363463410234630593559095110998745978185991221691590037863939139814612781558013359439171133024661109070359675641150303632482801486680638673301548023352244475389569257242843438611739163952452849345468642206786992045456203828933002077639378670750647586716131057606, 27324681317898426218323838475717291035765262696669638541150817896311489344001203350666885542822436814966913425481097323188283276203075270086615191390646585536460852285239371919471605471500128539502098833794137231402517334081524522754969916626763358993780584817819871717779343024605784513864330577503355547001557689507204516422944637364495252902633338658436526167121709849818096900583253252070578603537422975875859278473425884739097182816857580283834922402170737644846506849252125858261484059273631119594152264938110307520803190906852348529906107510482363755546847289391333724985572793433151120633057194317248805974466, 6932986404564470389587133605835344896733779876300127153975082396142691375564097410960084304884693961031209316076331691047110974927189723694534566349740947339139545107490856155801774856042892792743382166400631981048750820148258664087947120684299075861647325549351313954669547845454492285251950575892256515335965137403168741011055348166111124937139187079375905295597694058552937503093037099146266058679363640184385207609862719204454593354148957241698931843717128821147584427303042231971395678447400989721580022738964070677144475279737155202380264271118034873515370295425767523736203797172913770077593247283499852772285, 7133656668590082527273064383813601558404554318298066792395448037157723981169083910837328677797584817576112057031407702823037669087060528114080148589637680418443812394474830063026458445160512920319208023670573049265601492189427280342471551024100376034118954346821361424768528031392385535889445049100910814959793841771014020311554495158224169020253362047980885712014741520352026974223809716033327211574609193398207905955199850445480283810591672243098360022987732750808423488362360091532542106346377235899391780137756711039722716474271932787519187013197533371668582003656453692600210614152729971653522386603615254395080, 14173614704960412308407652205364320701885213677808904239376724663019068987497361427539716306909110586451786952812322891330526172884789837713200288850581342873201716583433973680451218130630761280978900769041610371823441280857756719423158597268080841901393373181626228902035642889247361745661341024971192946867810020834812294229688125788517906067082732660611495133333389724950175580747493050114732775460968282442719709255675512514710408432301572925956845086869652980112315221221512158056677477073589747843933995946995092961267060099690024315987687597893225815646294309471046638883800405282568722646771137524557900687896, 11046785263286603962222963090984604982099694631591596186952374990026636959121170369451868395939013711107424193713366450174086413631423934307497925626870708009042000266022583928928278041004211623757915918952124938564754505437260795542911589917981554066060352211464178093774520998687567085884065235203681915333403443538214020178475149942380830239943028894026423092860790183667135226762965594220203730483246064022889870270852841695140419605470933748056126328006389038861845411658543797597332177053670311559750600247915650446385164543248230385522678626169380196130318748763474099271487023451479317929388300487700069711868, 24897302153176208691546154525087706752117105078602929046549992427026297665124439323400414065625717095084046892311614464027195008220004831405354521838132769561161864834080941650680504840485164907966905497961943572019638753243551917410480529174804958477514783605137933733462733324047686011172902900695672010570614535410418922811055829777964117231387532889791325259400395567729897360192495151245661957274264905217987381465973339274951894742896240108243586342979909926092502476976372650810236755527579022098082930202342248372106928225855976450283660443397267578095122178349107521371202093711487507988320443050273686845292, 25599469696366314882423479442058493137778891071280123062481122767282423920575185024563197857352053783460173476661414977416131628822635736468615020147280450061707807978109529012970234904176848947322962223150979968402542629368544410520755754516726919896955140733741683506467667822681899791396545505669309134240179806015840728347668413613942187420993670897816661966772787020188255686257835139026619994395984893698409929310995499918418994207279928042469054876252674389698259884300840173365294428563663049338496171345611561316060265465190458795929384558458538521314091497831684736929607863700583832622225396309764229422986, 1756278511126445926049024131640928016968753101820672715449129906003877792210827960372686851275989207399419738488031448295411748197192676560418792756199390092415162234412731763412369901794559730794206568517029099540928044936968680711406659408889446047542101531880777253563387938295439776251449447500222987896199131499567098918631757829807947151501363881557263665565372065436528927929352651466750362774953245745243289189140131554324285120599637089359609551950133893519757757795568246192285783010941390837904360369214296330802667931469576209456033223693705277350223965858261639844289546284022908949973584157558413509376, 13437145063162592732569412728126413847581331925638236914038522570871195816623265841481876960502591368493877051569531234844628672428865357687454517523711727046094747386806625155107943875431777657343602548706423099566638880470227712094926168077326863226349662084586388185370048416633191209936109943087811620429238601642595051179157836659671520942415724887296135598454275931001483201498903923209530263909854841625999643454181387554126062235547089879910875743586373229810573034134110981845472408438072573170667681937610068915720545709081595945895341751479551762132561062942117804079201925254806259837555777525272443686172, 20818832529184391009004487291131730168676613474905815164716937044798094819711378180370815881201216101580153768128934868621533276039047583062562053273467797244795023957989682011598894617881501454149862075344881293358541344465504033468253738918458136305435224888296118879410252220919674466690609781104583552063347724548191167359817523352872295804948170198472474958940741425623290829380374897608432748736562716073100776048404024153433356445339833973156442560298702943540636137601508466100359515620292368805688286142868051990737697634500685197413303380459490302810110537840620727887782948999347981343029094796478303734808, 11836134440596001782394282036155393775718421551147088418328216028553844443475930123669168890032375988670935597249483151363065124888770489705509326149131404490032896237132181995028938129280109556953807212763353805737483027206843083279456023810738241218368882102396643026633175764138644933966094924212794574840646413967215487173745992862951940806926102588015075801058507266594151774792477147314949532391930988625125849669674137813473208398476096973873711839716501921179283364972307606436756895875226583811330496267010204220680370167447868269517900801486700436495103338254732812207922895162967326098087038549707058087573, 21882161899886189603169623003385989579817932169525961189819249368264292348009527514824582971274092242897810891859587084460522455530435770094292339151136260355367267438267240608347330881330126776388836510457406171297851719313859598516078527689828402822025182013169044620045589432285994823013832375299686869717145294374037491837132489548206156732875322275747863717031408901700585617068714142441496685940428947160173849873270398108387062845427772332030657956886859437333884768247063723572597587915340423215414485854782899009639222680231055137025953174604318099099554925423778263718526813680482091393365033964415567279270, 714795503340941412102529332171097365216710060715697569817109218310200050126278222342546882955062165855740281252683155631488908697812547318607451203785207292880827279536750941870934148418014360400298143048274815185700224561430276366083895986107939063306347848011219324948724570689591046127080650326379014258640432157999806201886566552657297365549587746135859733660783469711164672699791994025775999573309845621305995243990745969023435987639369563829107904016352499288219497688615632939107076381272472711709724662834320437030271487278673706222034566211816555341650996200871106461988430454062664884187133136293390016975, 21522127884551800491726359181600647456956914793121999034090173813944429742367405401955060770163234591094601292260987034534330584876284913005341333534424057877158369787872682055107726736903614519564294031037642887810636789665195467898230007379159179311819007830628012779690050388726014649580608963926723887085947312088311060544466519794921279619872706366038345097978329227549252968878809921912034527027141093762162457434041188301202834221682045701286367700025529188367321092669040561511449724687379229199217321037625209256994619584219902211511693906345906998866718060241868106045803145933990446400095760421105538009303, 9339102517425115600113256980659933692971379673966209825261314308072388658566364636640010428590611644269923299278019570342488062455908554998937320790725012867016267036756890166889855399747808001347040790274188744602199784085486929754696719111259191993952116390002654344817294584492704633647867390980340625643181388188520114250868905577819988175580586106016904003290289728356932326528448835372050105733542236134317013412963531346057394505973598469301781488087421756937407266266750522182183199681195244787405269292918356741486865145614524898457588168617787930755841766205231150101247071261298321373129173865295720022538, 12243839251193940925639495601454511285201532844504728025564040176461024381774024812694939429499860735297357891516126468321356988961912335397340030768041350509769833810067238571754588055173477931316403589891631064621077852128582669956522213136243525888884734827297287842859283066691488426962782190264046630270794848145718640036054763372412503206359244945726041369191574459956739498746114206953279625641359792927468351340788802571981133181827410518823031204448668066385380876145599077901034288062069590495277649945710373557655608895072175776005388233343669627748808103089308435719375202909597782115797164080427936308168, 15907359151477343642605465276361830747679246283678938599880917071588058679082088449078592827058262281046936301569000711036212167697435415720707444090881878193178880326261625018870703858200071573750878168459671151820893051902364729368684550746637531398540031496923271744043026801599361087571876969901675350677288736938114489159800039072736576644198764607970045204543372424655740359823322540666582857468987670105794676931228367892580001642714730161707013455288871806183681173978475928551943313406007701046042700272371525946426055027825758031827945462945499260236897229109176885516580912316727542287369691328208139583601, 10118031262175796753455980862284587830651571137415064337230749641138182513934553542718411849408662098819781064513838726661774141773869663860724556116040941743423350402244434881177109834558348996244222751748400531780275408188044809590988825103963706769333588390445751166218613522283007945099903464645048052092663933814957352708299858347918271079578212237554566469635034229567810695802137225099378392231340746856191381117328974547608756907377105362729095472731315401302054300330158093340509476027440243788474974417184824485370739075249922373932805071524442892151377244532846795137735968402299995331137770240305040542275, 22645021465682381913972098084309867980555223569389427147134528497757769324827891740228743599758807977315825655117598127588463969789578893793414482965807520374794071258658415278713401506932184291639727959355256566921589399641892144109925099430010299345941852138890845073077154779030288380184958363304751937212457974914632805294778787598370899904913035908292525653081661470827080054183421979056818110343945811530545803075233006531407822008009396228955512152166943403962745216494098874314659639195738126764783512187090979815342966933988370198181679185910484129183813009804348274690245751193122709605749765995783420754058, 5917262712792988617203990520402758271272100924543573547921220991485764235118616234028511278223629609802183291569802291375836925476616176778564140404844263504219623329337097286290799277177357607103128934616672083287902461702592149582237746194125517374304215688848041704463458969064971488369862866742757868207063523684470214636075306907608154889216835439022701182544122737847011326691101512703261035928967050332597939739166682582348112443383703143861300693345396934544551194648733787872967591631076602481396333361897405091744534993667042793481484393866890392163513319353168825542267658510791222272731036886098839955824, 22200923609187753188486086735695114881430731376548027149555991003936594620209240893537588980806284786437307000510023455359946976346274230845459347249984595716225743204530925926087364986158736378235696629057839214962657669191618852573447907290489450311424493811407635954841611524498410194436367752075721799325781888086471314173028627869417083130370095917929079519281400345617592782216333559582708630721536077290766627784188003662708380471758656020101593353999394050116479909704795250387069723953883102662627932123236752985149043867559981896360817766105425244365525307978388553158665661264622645486985249905771249466605, 12128254803469893060614818928216627564056722435231881409617272537445510275256438965168757618256292138041725983087518432199631681639053889669992100179859425395510759128180954788655519009050444002658080996202623210582513226693900876415723227833086563366120275115812045312143288062429667644961562387213542470455897226666739986360245967678807199959784158610137094632540777731478482172214004792215626608134695373075909856416625902875759909021975308701185475436274922898641454038557946771739208476409691748824876617374124260262228189876081219378040275934923843941127101585066409447045553637030964416463144385747097458213887, 12434913281590840433874450376418274592044682439099417576474103743448778229626764299506949725671904964681155168956420791743412900162939783466919696333551155522728950890045483934761451055445831543044981959516972932565122543356239561366172753118358163664729768685825199329956528159025977985360038376945999166813170420511587499652099661615418138776976200282846009279339147082221356788779674269653905804434647490020524875020628031668758840448970668940047140194332854275640258501398490495562215113660302277892671664398665924947462433162990158045678722325476218837517721294013034019403648900797126484377159577336844801674838, 1981207300912909845843267885193660430063257718721963552951846473709628499632835399309461562418766225287899574200983659819654476527110152124536444222573693821002709144700191865313035896136180735849786720937809195408274899520444993641641351753570343524888378750976481185650202092827560361481917593867200717418394004203810575042164041765334470406948760337436759098846550090077361703039349931337238793087952687243333643091176410706793416548495471119775500995768436273388727753601270412011745598548413274848309701889408601423403159904712430678842775816668679426258640428385447579233599501329466800176976439298544862296398, 16018144871842652681165738258617089986702006223292052704961687736189985247387396261148912089615211018069642146519525325646346243771579156375073478999474696977570262990426040167882993515565343818571056325715244695035002495204251584514399375491982744727488101954402036315590216253878538411159725817871848638142000223987296735054223103288130755974213341325104132986395501417077124910065318867524706906232054989368573822135236293377952755266126772319994790485302223586555478423515138247102893666541841000281057736364489151662132005757538760720614967005462343862294267491675059104488203632639209152962398840733618186097960, 27898261777012671035990599293836467073153972471632976324708019637834083321524254178036382696158977643306113010078659086613233035604383610223166834427960891490412103328767979030547852308627987012918839495355004385237294087030815263572028077282042949550250920745903352873555863590792803982544668367976475905266789056706435269603255863267028525423005015100489180636162683095314929004076476206324073692819965496341485179528557668520363968447938016045375494094882062834940818528306579139184760355828342181986768486081394385688776957816025895722112124403734753731140239083664856929640913883932299277927059704733383870781241, 25963316206898315830036446641925689576648438914384584217197172442011276736424054282425053529412234795583663212159152495421297177580669212631662721843537928754129872974856666384079715180294262881950851872027715606554225477902253556842570488027569361641148748262975145839903867089010696537393403960436717689023989237359450761826681961173109895968697916356486842116792189273737298759883613397955449007771107452315187000727324164014668274561164282427713135622690702518481269382339226876323320207587816334860799029061526417681320076124182471586026390049531787254653198884765332690438295726684630537354097316171800997811224, 11992329544100638860759411886405094465770962037867965195986661716647623366630640212554899049074606164785795948776431224368123210754305965772042214185503147413786824297358405076683682975320188616086742011635421736205714082045080081666443822588823173626042526423698478101685503581252676725426684884218225366643024395943226141215745048116703879297746327720686060280862279955209905660648641569299599458904187373624686489171025003821631700676944141920990597097081061234476835140216162028694573688267446007210640581842477348586115041928876771947200118094783914433175250503842521808343714479683152163341707316307716948059429, 23995678447633244966005009840800559998446502614251911096054530470989228860465580323863202465946476462987885364029078421647915578578759616801781289087671262795394052665040466124481106427997872322977398087700818623706888431109341460092434141553919453664568991836538537560789145876694240322533212407966085492280303926888036756790445486432435371934828683137155340797717312123344248103571622776642733539159480716267838828976018821148808393412266074614063631776436015285645371803999112685991470551773489500317771952065892266463049644918344772401652681651071862229008482642539985541897094648646958158934837311499005098692628, 14527089553162909779090273852005842181586512028523092999721874296699513271104250651010351043650077644815845284878695088697198120025882685653564121519871864892273138718213266149522660600369932041844615422880871233398490637753401378285632710183894094592006186876655075071351987762911472134971662469996555197163869347942978342374176952807882616192368409851707605715215619159893055362801133206923691427775089659352780756859191374046990878316683715699505062152983085677279081946858472976238130495670137849343345672046920781531771798147103109963566143978785032050523016124532369125510411246341356345346702778869280582994280, 8610783396637818967701568331655326479143189814919392460232837600435237987730234656995232460736296575711006999636225863791905694525632096589073304255370318476002608497775438000705813610937426494996092725426474361487108343916704804364634464871195809164721272871532571050715836753237308049718988030287995558590897199099187584886248095783715579905938694550431039923147352521775774552935338940295447359969117675413813339600284610351257998013817131455119803837555373592076198002474784040279966165475064334583319015254959170685199491370133446717508577220959611016697931349473966951629991467739613819675985865719833973991960, 7788693329377125947842721047834642703571549910470482836382639737645031678556792985140866500582361878683163690437565921668887520025180664668071637220904270555192360983265956847567008166011528146609905576163713725600113397134415944614141836286732959020228855253993087111307430313154040523879249625363755750296288836620139682334281219885530203600708582939845741105924724350246205966713656644061924444910727551045075093121298518605585752203211976010897527263038468797576615360352046497317975539358243696972083490758090088369947487239141565456752310521099085662079357398898356731057154754235017757653678383944955182561887, 22506089329043990515612188809085051138283844763783748269122814121598635626173611105234158412076952704737606590159843773657272020348205443954972780412094496013656290794698305233692278333975013818410716263446778270178756656301334619398354212324891275617576396229248245480082642097237190659535457394689645985102057927253790795274214287339205760667924041203314978140307987989939511012270892268601879882970337498417142953862718349759202589379381482903879432463116103270783063969819859656291161906348268081801852690789889858202548233876918637215236664774076884245912144205165509251725373118408080507541462236728102146138847, 26393865457021841263606167658988912437977947754488740169081358613278603203731053187786814352197578145268335762030374164577496674215303376011271554235411468260855441993485788238343045020497860487887256005901528885780393343014316415685906701884445450118586864198965567047640610753509195585957508864528910425209274723936790456224059537640532623970388576343295593897134285505771695633509870341142918578527189094856241884648067249229846724241565678606316439097111560693479426142384722945272274667727698742193326501248332037857892336828971823049093541424983549780578571627459114433119986957091317256774896657017200286368295, 16471237161475508655582729528127180862131345146451549091738327631552222445805692166488036414365793628278574014132406257830581653095647064741500278709884572510614549977732777387831721301463933220381584636534991912395953978696873830727877733878572465489110023720403835828042111154509995085446771845812913813628558316718960035811619205707886339839799847241482036364748282015273821884642741788330373595642400375235483829521306619164130746421243793442077439107236596041765821373345297548501186589571775287524720604773915750895721755455354251665288981740740980512855044625166323575995830402824688080357589483027307113985527, 19838357274663152358602269358774057003061213815925654342593918274513620792249367818955208645495758194483147329540754972143378655595944051835481757579379577911658510628429154846761210899569093905956129760899172238068502375456181667632255335137062844924672988077534483868371343658882673058151684101686381330643404702578077464893169408399263426765349614883359511965141810228150254591166766086857047258018261091481404935569034007386729377916216451715962852994330073123598753027132250790649309732138782319297135705084549306286175588815029728984898824645828234875901511373270019247719102063096288697931177869763843633705155, 22656270850226275596153459179418929542134730746349633940658149105120544710645455654970302061883389437001122462865494890806158237580265743282285605788788683058815372622855325214564733232283225973611342245954195104164209410258204237497057472502564062945382847475767316802413424492180633295735785764108633850705784593283736693468391613196131193522379171289378873867457217060655100953599922050123527009815848862676842385891199147931668289498668715607827836307214598197101647154041685242699011706103391889189235219435070557490843701493851686771051990562558674423939637415826779289547753984626367038896860077263628812183384, 25428235693062300625603888702037260664900578803888777219236749986007594085195484764122317257887565621666729739249808061795123256085709142021967163842501568106294574873751823285118390200088088300728592491380628031319230010703192332371830530649931251342052266552227748708589161442559169626426085228900480974765302199372726222978582589002102017148438676313724685045194995569939507744682670683113720674690162093965253212770960712292515393317035812161304708824010159647900658446771106685915294181266056592418933657830445696790781140155971307075826167357347348122447378330870017765478235413089146649053450280054601395045962, 15326474566270494163231420750249824467090803237364103835360777203279083173975991377918724750917262258404487587152470129615812330475863019004743906386099752423784225847506401529156353421546817494329053924053194644714998950886391516409852923416182221242190213966800854151743114366790521627894724783520561070050211542365165811134341268030903173786398776853540658514154656597164074555964194594511762123861954251158785824824692565877982555042728358641102494633774050004246225153178308394925153307069700559340358243438956768228366640137711069765272910397933650308239625175742947317542390004668024088695704143459331669461741, 24765221351512304860131044348226710693685511349818699079154586327945985534092760019480083063384366524628985062493458509952689109302265710381923831348100122831342958202636084247355194211643538187518607739727697811849578292038421897372068623459414040510190496935903665107932807243660356991627049464989496051761673704913349488289662437402144528650417727270587687709282732174676502236293988416477523073012105561556377019616174595982122535298073960146649360833219315172086328084971515884928104573551477595259456731087098577899749128690810258596992113900640558489259347465974675807144270565442344286765362973805762749957130, 21239590076578992387700180434997992552265400431937571701441095962121807224647749825357949831167486883609241154980742149476904650336660249256029485355143813109738802160028911461728331560292686686789720115328262273503143334436220606989766010914882823225859925169874141653126700645733405293026240138888843265309807888600775994035290986598595392903364795827214986499747984764494576605898823233869664512517534577198989391650922296501546385655485522658659077068832693945815863782923493143460414158507086983644948490494481974415245202133183777430890431782451388513165350522848111972526575659905806667665315348430382963322064, 7225702668132147494966827859227558795567840968841308998294405033179492191144096882436069651800266762180796547431258827051969419212534988299984096405455086692994519646990829335298813016500927798707521293796101683280910526956985498265435524550003652313703102783644952310748268438044760129875505037706022586214811366575388939114485934619635374408364230271856998414159076081451436427856117214276186281131907566337193883080234531636619445142010443722671716788833825072272509041940156336940567522834716948689460429923699969050193489104798366339120609438118995701104762698166436414230508525270581298340318975141082335530436, 4617491755897506978599298066770311573421695753748863522395533260038336937046524841480833979951795645181253299256777054771496815697964990712136557527624061895479275131758110946065106707444264265349628310375805092711590853286238041466845062449861498344964124859455380551272808275736976078896314820447559949034283010131958481403638034331796044596644521482980454639010290280695963429663774814623387214108825542616329195155799438270147568122128890195232766082846968643794452900469958622264563341948787959199836768870143964179857475625567666219953175691854346861188206506821940652502917752151214777356448962035760023184688, 16717393813657486594680886765026240828399749415965965966053296983272880221758017605784255498079660847331835975172726241129975333434478550227074438593441540305475485849097206481615599304917309891544195683666411563745683379085841968297812280649280353098906282819991910002029486274567802373206733501384152571781736577504454886359310482572436276013871632517606183492110067344014353249438309357398666824377919112673724357881071913116343959577491724900032313279716000617565852365835370106354144039356317424701518272370961201505355019857575720783397082370014313451996185667832294143748923492002472072006840989921206204057206, 28134021743434053422622700713163970763133083199771240886358639537329389110968332341641748162806312401112935415675563045775778852369089677486150615244968755765947363791775746720968638088698750438622168475804799786419655552202609507760867340323015659280056712199210784792212397740836267016053447729789034344433665335673110047683056907381482297699859212748523649408370023265289308449893969552075307315677276253726275896199157172832853390229781771724617739786135219133538415886593497924186044304327882440887743950841231514270635607286226816407054373573714799610271299627758876179366224814508260461080887141578068650839710, 19226153915529925076803592096840540579190789929735106306853965883784561049681986482857023238995781851604619783534470396087369223762461900235665448821975173471089680982035819379882363286762322291641613761727157964412370542467594042214237503503284831071640604259384305373156222719264782888879710262276940798021743230953776245581242928437303159478133336079292248899529158788802182984366972225035433127677094081643774999691641453587692974005542322118853661057668121189259187823162543141429569833148084921146688858713968337802429707832525031079872740648136887945138796731736512451796305097871820150085408550895453537985268, 6132026012752355490970271369864380735174449086713331052284925412666291496343530543169333875949215723437717388507391160960194795373214569515209484694917505955293238896681093195094001026874776310619757753016164098350877015366870760421730840526428041470972700179486332023653995137984934244004221058865476138531782477035485830111579442888167647112990288614256667199813195811911337722563758001778839502542983867178966441131592127863023057946070973123851228738128205830538750175894512825025532250959719349130348069824618366813119558524140717804073495589710973361422091659630789355533196073870755757007198418051713101702949, 13098758155129360205475954111288719739067885898010130786038151346096831783086982789090184050366191501473934233567313492009573222688963571553166443978713700557214702376270048481401285726133866714588058615957972726128070335574620908140215292377009501801385891294861672677374034403226618302998656363583969666034736929492351910810164259111570064070116162072428562240319853819068421587233089648644374842929379021702876463552628453805795714443568561761626252602161509069214628469062441291775853957665263175100337317754654935124249355378249954764857091742077681330532369747712637671387931165357756336813621378581353672030756, 26542999689447305919957907493821622961164172065668810714458828543883375437812490136095092139602654017934749877511953771560133352559595458374601915049094917558968686939804225656427708946262911590147503884355535919839902185653082429516834723397268570975568720648488113862848023337995900798723983143805365468120584452731650379048842955420286880179440249129608058748454459603098565038657384980071851836228953340237117664409745673528470519687382889480171927635159918070638155045628112345800492824403920124085939636673351616808193225843536832505486376794798036469142956734888306625648391484011979497687590125653425161879377, 15910921333782905184285985698882825498813694935426428161604740807033205291899062993000789860129728657378791079218757043953569285917252699362892254360766890575331475432295567023716999042589335204106489733203896467967533510034867160905287163240595208128849475049702724880470395309053136275123766356151881079707447541605142732238173656692744063152801800279848245357114041394538982820505674999446635212436368181243552495624831173267855232980547033563579178629595251258581323518092862486892250290570621633229507913724619673288494065137690655016476621804896737676526152179561433859270928991760171635150062354538795950534001, 2934219715941826764969979633989166209781301925717344972178504194603152258344017842601703267061463439635170622709705620509939037496130777792533703047681622232686391841418329486715886544323083606178207335733376700964199990049593639236501550330371193414047181606523731521308569926528227222493653194178910561081489300256366351400553394398198424860561181464787158472678361209705022203471373010858171252694942910795090954395476977309379052818826724255148716255148595199289436433220046404967942373103520659790499779444765713613000617066338052995367975661176840236355664016019086170508519319583396798302620821736306055865461, 1791135171718240888931297913211778905465179550224476295279759369523182843035687513358783781014052854247571357855249708150646487106283439344020384104836802789842407141051267292112061412872459847750009248433676717214363678691523929125027560454443131481192667967883634158843803202975279516656729668767584507939987793772542692610838710166793460899073277466513600106927978491817681800834168165821564676232836186716710695644558811643465087949981818902349163904522357558120038416030965665243218038377053473723050933675649937191513345487761394372414049390729269481437780540946065634168478559559102429319879396942670851936673, 1188609736407921027916499646564228769742582588528776277195090477210438809408320722370191982234438475225790283032231015267918493064209113033134145684319614455239706387552891329895560386632750542790143920899235186825836852348327471764865884755544975041557559325423944933435333305808698309225177626108456895169187224214779989969275275296372656615253698102890680743822381582534672418533351220919929608819542400571608151903297774050924543300555715961686857248635164868797025241674416002440562486828640805343673272086003662722035847893784933741490533870694311213721843871482283550603363580447953468535573978163271376619639, 24597269303908667375327051925657776192091743499475618834126256577037826315846551880904642394401154268235370101731372777624645912175719328583258920684986068594322934299967380403827874880164016665402560730949611206329546221067293314948884243268057772516888246607048081663775050602572184667490888589158237532225586594401621597201242162304928658104183205576637989632943465253230708215028156974661681122239666470446151416561737388345231333493934948350378215775907289720626265634940707195747930614411162961609462775551611941714467138617429977218879680043854891688519841078701531836511083609039452669756420612574944013996444, 21820531503513443982834120277891043746325657445781715620970222845259893590884322768538352503248204256683651241644429565941980904045737911888074905903980319509871405909752673621495866219854866253263761453572866112178084356715358501076021583226520585878800357218809289394393617339485486276161516564014041108434423757751629502975797844439879257610595798490797476574721824914646295346182137523540398488621840164121396711360928879517751012852041902835203486061399441788216172579236611334065526141684707326667161379397638123180740405585413046891899348402048392492673418005212582072716369483380724692046147724176014362758899, 23951478899466423415137467336666391522891180989367328678009249267137269486486402687932028162699994094315641584173257267339723534195035627747760636834583445008257566428457027447656308717593720607611256047235151436482490489139491588469253322705775386779520484556703742964329467209192190075568295425760777320884772892580169033161399481457471618692069845243233392776535933546683839802716025012677054984721531428653315164921202570913231121451406164209426097605719975192578866239222455060049825562728976277509280596634476124330119443954594885152259059299772397317328791521037445057457164947187040771255391055992458718023930, 11275800173426291747923369810815277873037845163739634490909926106713242752700926493840399185286693635815973755385128436374740227605802286040542662258277169566872935070334570934826930767236091789874309553177063049420141466112809797136529664733280218095344467942350257603227084571564119174102009843587902110275933570518444844376002864535999108964261707570848904184036020576596095734980598810351041456400454733443209229166313152141696078804365053897050715066615156650630875512235977379623968922782082483426555137479208697007596332601866054747259030353774969357390367423257278431938848608642253101330911549966585352465354, 9824130094038964869180975306400534260825844005479151505482365357016838018069961141762627054590897426001301240070593856421709638684566795738023236142033489597052089624431967989903771172729796465504765177841523746390006695665433791239307502908621492919297192008017759699019437065863308938193341909798396245912019754815638768772056718152183491299433864549150882034010559947019685219627676220416601140211530200662164403738022796126075602346597712896305725557437624297722526867082662849184436817018677717878607551141675251837169760722716346965752160351289195771902416628617255277068500282919961983529333398810082746335677, 24096133473569088942128598273457194130413127477625812721049758921586886971879466967335488668053481225903224990407890073284205809023034795465306391918013805619720644766568395910905268911912034700375585404091444453619033561284990709967662065550105634591419280336441916470157847602127373332329403554220930559603119233002475610105109801957472578411422187605373080539698404137071528714636588186183220847535808737951361706545760810411173354234496422731369976398540968803815302153515488158751498478805364686040377535604249314445319557588359752543110578763472867508168696413059929542355455857568537219785625787038302880032139, 13509222392710587595030061206648505008253404630588519573468273156222076313100483391102951663156772510364399315611551559843750380352420641832195823937221567404121698194214527140567326080626021798285982451317132002834769704165964232788299196072980593230398858686263610204172178522408762031367557849422467001122985014822561193610938315145286155959302879282823951141763257195470945789668487684638864779793064442452609367353295236851453408535284878015210057682151541072726481810348272511016830622648553657329913449014470932720842641863449259516325702234978666433270267444155444508570436441309047995506624738787109999574280, 27005300694832578020194265930373795369365987768293528950637431192608651091450283811410188305844719944435640951313629927544896698635579593272545657780628644117141369074425432176406803772573253687364349403154270533703787611330122430361937559602109420649081086844570749551230688271575357361761236424355925922960845186086523898670020396130002595110203816149106701811737923911166331653978493287404642013448282640791281024604048986563039855537796621135324396148989904169009728862511060900519706206651123444935767247316064325302503460589254491077738370563008119103179317323811670725616961542028399582123144469418803384946625, 25425660095944630873853100560644393489081375355433959724998386718381621497549127528068699012459250609990035645863750746666454402819247377597581942409349486493900234975724933626266717922089797736823552810803971620313142820419700973290583839478378104490125796039886611928922696592061967493134251680110942045616491809296234057145216771728797596806260062555500529284484863122722484831497845613721941948110718153414322430939932022739978343321499214095610942074283140304523271170534754594653919135293102311410509529801188958061067399835418840174872759036801568164812137831695348374897987105323150380562686198887041242536151, 10312935059494582040960620471627669493116282335962586231937041123433569297899888065038022431535543257523373628732456750029425401554841529525314645635518368536344721979327248788862667895900864053301973774927001438855055103721519339080646670396300738289327093036746400492227495696202448582939149080941642457129335364625390129923049556086835503656864837638761483172655485061855867345644772533960928885495687078502614704245419066172264849311927525147741990939276675852266058085869665245416260116286866292927569054225137587348112615393812644769068216116198684484714575222794400645254481063604936861484819761640553712786387, 733574902554054488058061803487643785303822716757252949172618951549388912520293005713841616304728552868534343108446064001603034433684935968432275583612392224594959146181864002127891747910158395433031859872202767392463336835968770208000465868940495359618352504522035030004334676803165234569021306776763508898590540531629011605496527897862738588612568202833450264402189582312545178855318866781139295514429552117970364827559392010520619337736998387599635996868841021556600134039059927889633622070455497107948393005379568694997678617525125810923535783435018237895824311891967697974577993421050581673073716165109391399365, 6673544432922012099903513736663524364649485709548329797778690908882405141621877610384138544000829471662780290672965827176165991203700426345049827058350828200418013059704923961621440697681353263782330092618616439511030309790901094153600077412142227694236623441829593348662610831946346690355801231990494531468792853130378933226607186966349344822035433828998483548104978256142760360047806522071511629241018106631787912490416993542331092868139157615363865631889398935166973232683773086010375731539782341850527688093046749926416728545547430474685297089682657484316307665578211929587638006445444634221133225646763479862805, 22646222935725765794957627342912292103028863622588467873182633321675083537146270104246090298168025371577292941225948299171114371647533660372763835804771879996186357740456230463646845705764080603136363044614108333319564315226956178752347987919564427457359727958412488498406017982387343983003604016416957254211659894546511507314388547726252543783824000871091438823073276780529458000324514969771933831077501162230948508199078765560873504166739271967102018985523214282959829482923025562520694139833335201579076979996583625979519583068047634372353172878369415884271519124056441441262763833816738070963296020088876214933543, 11816875083696368935612044983341927310608953461282081707642780617744815190934964511473171944450003122091418037278487131198640166216736564389110588067969909006479418388464192722883129589473645198765027514398689045892599335159612518394407729882046839823090733684325613948829140342905057855679836889586336388445029114117827662105077512145890094636132929530525315033136885909443705562038740944070752611492154334210920317496998589151795393089624105222138779121382175423352565731361232608100311883730292243024132813043261799322350639220688912727186844100458073707603843166978511960569605545267900331638598935395542320424442, 26286202380611826267595099143353105563584296475099760173023244952096317613524168273259549288601427878514222400847685610951236867694027165347007553771487538489111358570327941034581470457537658100295032476088252733900054111454207865320508092992881057551743314949110371037585787895088583411996689844001746494045696946081736993443150894300748446803757100236798425921570240975641181029553216189930929994224540532815477176039477132884886069503947978292526346758488704905472571165649762365734382863237783155792281189743872534902401791207646494397226847224588647206783066261736205074284068831693634039917806044332322791300948, 17495568107345263090916685711840727890351545836313090176438165675137194943923601544389670385213175014284561144803146595485813084370743493620963017720908208552269970783126100488312860222166530499435116883099753245574362236038672043581561971350875661283006212581581339423681363972873598509438674276010330947926270594523469051959583258154212019284188817512551012501657209769557526450343963392192975044711751029244140904224231257499314978842461689940965081133864876125777757676177945013462876389723952720278659193919065694224665656925896166255359105966228037825458249157054258798357805251277594891910349553794461788458006, 13717269992424529596293011341517548838698239654399027483939915425649066658336349181512439093044202308571996215442460174796195163788672759010981923722288132804945918413139444146560711746822726482471696572308997303524695239557342416970397997191472037804899395737201230072985899759045009463687288784327644148759141576460666293987302994882690920029594262181379724175129639375265849052639014639313873114420072122761910099104956681602419182415778154347466569201743734359299016013199145734683011055835069219167625094301699438106572257812630132456523493127209097333043300084635631014614567218548733845228031509314798680865161, 2760604977931093276492213728465131191109071832244134869977704484509372567794705384082673244570868690410459799832924017742047271318938954020125520230417630529920021823896942185016650345692944476965283516013566816562106220688125890696642959017098193634587417861139202892540052117666439392720179976761526319756356581005036883390429196595151978647806149300435704826909232496447679070001190685961960836895833265716445341705797913809058812686039327322738651836588164891408641200065552943824684467234519189654004201958614026468174225396033581018576415989445371294146106374029989298722233370790268688189101771839019414899566, 4045787354298035725298340969719599720933457863314414060226420635667537060861716735092020994222115387664424423124721513133113909040916618436964405200985445242140613136911397590475854630527121064083544243664074622662351794486104089235836448579241708556091786450610987736350550341794333028210008326520552844344703390910903958708282230750925690533497586328593098161087800566801465688428602475127574441844531909443602177293110276770212113920015589758302649342164524875967976071958514707919397726573169792088028872010184231770263336178537688486740512915918750787543768181286161715354278624822172151773452361519924849164658, 6933763877016907852593292929081315353360001071490106161464967798504119956499356004270855328015756505681967727658302343818047493174409224979544531738656749465907840865023086951508914381045225531191020890227947839505169614353052464095059998293056680194607011802397083959517781763623365310427787675688616506130689774273037969850864803602002280257540324943569664957529947779139010877022194542172204757905521718636243044155483901070591839004907321368678874197057183288886040276056909906260346365973366363850397956569028198625949981485393699432686786642923892872881014534260730239058806701087314961088574127114106920930364, 16404874203551880024548333721182518101154526572657613094355891323366711733171960836422014372983730034587731615641167172059663127671179316233447256739877874037722980305409955290679862147340911299108923869338110734506499176774325993033010702857080434652122388005231789669562076480857635669876639278998434242762149004348735653061335815953066292966823026105225386049827727426861332902997840326966718434778082690645407097990890788241679829136073027579436231759929447880813057819391752042075560682326809659501480054782218168737910475341961756845586497607483095477735648395109327002093145799919590541915716562207665676102016, 26816342547690160288120575122622916799444253047907754523689445291152246682768611444670772461541846145478058045436085093621272632918192429216315312794878368601244664890636603881139718185879312500956210754078321078675317681650968774327931334236114394526015564008942933794973454163982638988058083505366905827975865794186519591748777166854032624288005678207166391846836010105558893272621183847227307387256517736508279507453553897084860459017090857546235785772126126296847604065971926859054374156670291853399205496688236313326443733228038790588976545188107437965601552280423960953493184383426565193023083689731454251146952, 5381588196008792303859303936398084637025653703662783739429586301836265216626866264895706826871417035230010228473381410283207176321140101112153093903198968639820980551816076264191679560391508240375266846335869727356852609464709191222183676468993524650223888303280308939638379622708711642954239229923510200730254430811814980704850079037624528172311033310607608055896129982150611431682682880258808721307667621585974477123910306746541486881123507388003037947049296560212760168214163398951762600976305214619206656723194044768717138024329940051772025897813564471302180441407773462986644949259425749447945382630514932050432, 26695054247643287468889780649951969482523154870233180910100411533398453485401700761238766944010737736647636776198805307260098835434619183741384617855097143149656128526477801529298820227558115453042151019026385545023934701619828897524258582513926933387486668815864759200077957888891204477968905265949725606672822151724441895655583428661496505356351109196304605771294852454533042235467474642343796893090095978959590442404545583320748613162818125455332250525148390732300916525993966451618186453444645926250563454266341004622780086824910983570178297475760809768526127740558090305046131612589282501949049614548002431673909, 7667729229139116055511627568537593638718647498032929028191394578131568187157233534564262426318192820117016145566979179857169725593279048769744866666672086331321284576516300173676788060487637047944238131581666455343402072317868441305284245815158998207915564524778066787953252307518634471733183514909513462093715750064450754656696803339025035830385672919582496292247761033800142649413423571581002619973139294821302352475784952106035345615552213324816331626459088587796512241802026754777066842380536872029194447336805857247216622751181851902368026692409436654430501993282144873721360862955911307706566609476776711232514, 16592156564488574380352624023135324860604045897512670066669621897560639341994085466519880862423662358800161286256363937262455759540318162219516911983442468097087918681345041743015414309900421375649568526237297170245416983792437048050375255712673020055554803370812741065042353389787306359986746536859318782002818921364487267799936181042609507304142088583321823543868421037700739324269930103234201567530417662255404580488676335079804987074531673838636600130629885472102701933894476353475061907610139589877319018809892899885139651767700824604424080496479206967839512914680630061715030566577795118956608694908436060537203, 12578486790016994461157748069667745388853345750311790074747916416160715888574541871863253277787284529382433510295148348522849113458924109621410016738234722886900366085711977562410715490672862377527268579244081891905501824295303362803044874308201888895966228130668853161513435575778618742638190766716568737451385571884921841361187523662475584320032182924893780117311327347391146906818075242145683211733974042372895873549429295637050151354097126481660945729074682333786973939124152194396259533276503452100410342299326744560977089947238227269493122860383727289001469097982254568830872291351392377796624052984295867845090, 4503233655291552226905300639139039024525134183763759516843553472321592782895275708064714669918606973831517257339588416181761637949092506127031187742980933462533977683621775722689563764358364250266159580621843891715740320965815183034451230879556192808302188359023032334205578009771340194966322023534562459091140677055414724197982422306472930636732068839828379830323150582365881404149983317724984300606162228107473762015093408032585052939057426948177967193283431050797035598775426882275897998425660878653561769365157227965807492224711913994352711404791692747818671882092489452065176226581899179713881073047411258672971, 15219866440917088102777156663268655157524519410622106400920591412478127221453155614149066125463437219431121591689666303920935807507961192406310835911705933281702001548556572101218680839536898677411954315389715412529019193703858494987649805572689303273925484280369062195056175156984385953860749653717480849301563498489318532115660340611187560603676981789089840907887580962824004584909646836532807715632487320164240825368912443929776711250469632006901037071450947815265286435119303488978106907171570342215410444864631920280153213378993338140381941364777729894114626176967641273268974616334263296824028270677462131591172, 9989776335555526483415441852951567180058483830708552555181326531955053811159228898684757897440101332896030167172270915200233494479000939251508840729591447796662052228817313202296072936827466878569122114471022663173374693778921642739053100705860813781462271968494192986747842112036702848822266450651228678088444566945884511074097372634426529594646377934590955986712219309913583171068072865405663728260915698860684245225007744190861657830320492143048658986022425284193635853596808798724921280635251661289411366439541515144178185137438562517524654592636501005402477587953565245966062353937565908799984697286114357720927, 193557968287654855103438829582741459346661749467444799612729868038745174003241540603696560042683870544137896596033270948172653728737332737932929156957483070877539680095727271244887368236920571547695716151452981203126562489108413307344764996551358157383754117036272048035187167035454577244564556696508224823525535820010406504324046944364857632257307728228608607950855516398541365140419762527211833772530306284139936393542841601600362320659868009967452413094769434433980688549842965976542550318976053312136079503454929690666712102708765783805289780210374248589529876808903397143726898209229361726497545716202219877457, 6771567955976011923852040665854322359323839227025038531275025045777086828725069527113789824530964997682029464001575908915288271640152744322997227259033904388424957109133063268170852998741169375806620977931003770487096379512742098871657997950049888423817821439746040652830994198020654942662160572665139340020761599176489983483218196746651317142801276266266278443360388715255554268592292363902073937646759900410245836617105705475058792071519545168244166378497067496071653796670770619854744061192257681746521170729677122198644380163391561470164439791727875333660670660038687151279738694950875702953498341597473463421068, 138327548835608404491976202065945819962044803955049139686036181449062023318780899323722260599316836999939224641867986876725694368046746456595051356673660514190794414299679104707437276813144652278635740328848855709447927151843666186462205194607480435003536707981018864987515494618887753014750318524931012532449189198864455675783454703858592626164675817468475542163819930304444723374892354804700493447938104207550684307191248054491067859868570503495611085283187601724919051979270499196662655605284935438183781410923815004479517338919672852931590893187992346972011179528746551720792602564960126301826645394953879291405, 25486418087984775310183936248200453697530173232657489993172466374249886438438265251702178114076415995688131488939348424783051331310811415266929984113964172031487293540804769071508229322670105987501942855811466014263257793381043486960136187007158393797978389941560210012186368242516778701955990931843126720502411041785284352087660769154784187925960965484686398777202804112953821908077612046561941128856402625704069439477270941475003339766201681420892337689784498300757778397453842110027152493447765840087070924761610082369787144097423328755103924909876906486297711456139904369973764027602859990852191410552173365004227, 7090523455582340798136887471779229013703258980308572406827844202656315829394792266632051005134242842779769703085596124416723101191688318139731764075919708878265306292111610278374640497602215186501359188001992541532301784441456760777755496418017976060395163402041292081560589812921209404981167173896590249076784376708859070014940534221347972768340566081478873999873977627335100399896598905298035733286134844475080102885117197390724364089774168588556583614780996949495280795619260961418068028090670178462148126698250812785671457145152120207736960494605539298306941577587917758222863988180245513924426638756146159092192, 23667295328946276613055324586149564147577827966342052245154133784552006846458900317468275237182264861146576242659046896866197435309142082949816383537340596370318351563776312322253371969941367347024374547416842135382140182412844151061085714215285609139158947329677826909014917203865155335793961567048929091681982326853929218672283009607688628559030290547428271583146679897799701030252254082320943050194422162711025859743515564725884781212617172277319042541319593965129125966862730098474118277242505886061063816537864134168670459739777583107282963058305714795415915049875252002186820633899500976832056197117917338452058, 4962652565444622331867819947333335276072229163132428939403185594217766892259639954985923769150183084794955838537225396977204810213821783946474745744012960109016408261082396277607832514926782010237771099267617598966372091083877839265873248724332192000851070295888955907127651670556189046348219749047743081965103385717124357492165729835575165521919039712053281071764676804857929667362013523114600454037834489663006469704571415605962573388771217242378222798052934590319488604924705210346399347985448098845139001901284680193708118562341786138643383139022118935233641632278904815095860655300106987321374327807109839778206, 27143679406621572216374300089655935464636775593883745074541590741799137009571447942193452947657280486223141579714044057161965025677490917042466564711231776127135583339254595454152326459236270594709852763181242658818491119858141856391811575231766725427757521512783668118924754040052264576944480377797127027631281610266554979572867560077515793929574614260626346041498183315032234646679083638590781110743436164155598259125883724814772187468153030534774344648069651820833603440314854584697403997666424951487839443549419841423109587441615040392403683909342123168590829409217069958881811209295232276451872949361071413145417, 17068652179504265903346182847679786991165884365498493955059076511417884443066795215623320879711567828502579368773660925465112511783921250132051722510900751909256337826891971652137469678541013158600707517609200470574970962814768292600843520105384752698963581203524486484849748134107024767294679306656267714804249352740691865565922056216719049852061001682847254083886263133773578032752854229093377736747606436503414514507351685585974983185817315681296680181480341667013331943707496089850099246400242780627091506691723625518477826609609915759483497728035806171395046492806512811876062277095085731077291713694940193742008, 22666809328727862457573014572032610368120398610398316230468303650309174974508708975402326808120500522600372808816845726497255848337046173076713432217266630673822650225177417244765784386586145216268902712894657347314058341920580122601811109601074170297242667464193747121062835998332160873427884094279787715965382392373572585758803960054852619376786093055339969227974161659148495716858515832948315320096859538740259642796822805566944514335724703096679451155092897640139821865510246680096410649014778117668289184567997278597522903571094179280038044406596085346086738350971048324913767106778451307727461215714912474500981, 8229154293230133402742379777492862546882607683091656776238017493777705440455795935431440946490809617821715514050084272305517850675671069660697430534841761398710987196327178523190330848786231946108758276906846727338258184686512128886468195960136375274335133650828594426882026721279240075554996771434856759169370327451529652735326870456561927126798856895240234855664125722262213951406167235607451352967497647440586180130873145744627223104169919420538176653701572185631147028177333998142871394902832536856801892825488868782045075193646129396673692988801557806999205627892719101298932399031783963785988485495530174087990, 14817219564662088105413253654686598360644318500841785465916012868635572086799048686080425899416482676522354802110302837046995609215516225220297631723239454324350178344477804242876867609090766893601283858708864291043650921051870792131846710159537442354596351203670003833751416348231631431167462342247890756210053684248588247102715906271236827074821653631393134059686550442480009557352825802531096972800140184634254907930410927711789926980101223950018236748945260720536651901533063821674697180051116854580775042671444012033330133944245603228309828342069421377551298374334467231345199909631092973053556955953817797496563, 26143669182342255853219265936362906419283356554965128625211816418180395625967002393553516256350804301266234400954628339614175980045666209676654990776582984426841057095700162440794014105048783838479763669367972631418372819882502931283602508054739311874010052053862614259087842972348846781970419965700528049402882813571301122364512053713522760035446340285704084180504610778875245368367884628940594479173763097406090685693725027956905000937024080549813083503539722989566235138953204971306433430416987919335637566965139557034945330653578424942061715369154488854863672727851917641079202291844427087144260605266586852496961, 8793902621856240065791631431329623753897557848174159883422102042496572273995980927531015293553552263133897057409746715636865311828803998944416908113409049491715504848537512059953664321655575107580765317542770144486800940988012765850584941305436493636972244283025904813355969094554801229119261716039830551362280969758251956314466080113852612711559959645193164267392077206445901529482311216354106407517832705066807283044716347999996314914217190004633931088306908092002940651718321441214691824840397009461288933837415156277197468712134810298375250776427259784823889434098262583501310893589489223629045587517372752273971, 14892680669767106404121249820129219941243419138960677555175796476563377095879528949948151860242578159972029717549446383495321889814686194592007673170188342386793273597537657268723564052078533733817300614571431068190725525255017150858174893235643759393233373449493716988284535400429105401328469734506794337871260157186497108488651120252648959976340450278582745427400262750041164888843760481494315213074874557928592563352114802739525465930043461928150171912301833831782796065890429744390281827964951362665296312080847980894602739089961721813076411136574275839910746021905700248361087814530330065409246535566875842732420, 7555306458477834614570741791464881836972017326457833445776431276591970508847627123881866747774129481373758842189193499965352048552719641981522526648008013005530033007337394074654599895143355523710479347600430267490570759245956529808762522192589351545349151888077404256064645742094214790256807481553423868588189342229170657039950151991885778782659911545655613074870088063414190113123588605690683245173285627434934272040560375386861296299743937452116523067994499172889732613604226474381440035322219796407695412997199976044441693181137052249191502626057228419420001482482032591969041750032399916060037174745548738818324, 27753049013940809974797416642432623421718650357500174042953108186728483883904917261374856800547671239010546421731921568803698754678691504967515932307384019922733092283764731014777750011445813324819270948941827414453557029100414188241210790892701969561598877920707592320127532048451861423542945825017006897117790196522254022648033006089315479129520111627631627539661414287912335392042089523454332669151932599391095410861686942424081012667742183493375485930933955588321467555453615677457711880726787095417029849460475526769742774316258936895955247565373276080304687489433235123219142573964692651746274608546228349234880, 11633083764695977730569012980073574256501771849186660604317191257574886776959525919446783901920954367575115822087750675376748689398613378772484640836093050162844925581943512858913295974277592186530895613978482510964991284797141108297861048078237631398377844682823396130425953241760707179791667795251657182149693051708292900789818168991239761603917214163339839291785844537178496051458174354617479648129926572902742663271119414557834777085919410225060698088353501782807417047808464259079133614327726159486253402733635758889999075215716609556653681000398315689510180434284254538941597142915614364577002206688044615948907, 14356245846415433387787876318214239140704353238070358708358444250232978332880074581566195738440489090348953376869953631208980279831297491219456036974223338614757408387106761280143044807480742770073281428064150201236873047229192065964835485430241209877848375285005023413011611291305905754651162662487602484715810732822691804192997118722182187359705731018599204892553316792817687303472348947025997450064028087333492236497670241126963304654659593408098452128596078323455639780184830634419368152371819714156007096050879159622361907345821665304948624888387435120359416742043546039736749014571216667985512026387677365511388, 9745613356768798274197589843795010260315822122923011282187529082863330295425251005202273271068951781328178058812959373297319207066866005288063174449454282783685548340394044188708483110042380118544754485733988048580022226645618992065440359283399897102406752359275687645025047242545965203992027716749329986431681093718913724564736705867059535053683131537972512211851007149971415383461456889556589279664953428318279943943912846089510747825812954008808706269640598069993635638614897561915044556324329934245706407992558213816841386671942050026570706711787757616443971449478560980322950411951740173707205381797706417303120, 13074410044619096795953071580345231323853876024418598606264365173289638829909745305045486910374784914820344563899059579781082048693706521831736576051677589246035940923295539185027751870435065869452998660203162283981122489027414654200429618918473499871706868175063550117323554780679505032933249439636588581459708392274052552891522750180773027184704636683158507843646916594930046965117746906619798000560663838218685926121832314947640536724847534761179749566113441721477565325163421051108295444486572187165314310902728230353153565667936098613694685562332155209580291342030519064864527857791054611514547914554319151545786, 21082118099859059200081974218874330895931896188742903098265345912657892977034070094840354264230717015533702204252817041632236788151656959672632102373428720331299260966137678104451149235716450241145471121770994897229685660012072153138401205920633599866087426730044061170170613867999722715055058935264871363850679774763936111445451097120407818046636060892482305269069223852064845639125042335603518932729856302940131749153187825925189900618258860312698739213772221354640164907803146574720660660770597281655211144721155118996345694134990605870391599987340997695901971509317164235436567408104248314571258511814495277895591, 14118326352139340974045544828174890946184860043309198817155329881671840998289129254630209492894228948118409779764926585179680131620829382713665945177925910088313996045346878608308227933188342614305996864262444887550761371285346911865490642813584000554796055465166826597733434007715435343687583471183815527988352107918529034905635152746971146761828096619418135174531038674974072733796628265306163906370331801004774373026475559113483512069890418232233142688467238990853402531817788574608792798141355117185624940181324158162399274721599321414230971072402435187072439972524435221368056216549967862211031860190308815172807, 17135860101666533596725703145870621536898264682635633883044358920414851907029799837354971782701685446727265177734530084602742013882735454640133874728250883102904486619744978677460186708767300011435955856424075817925522334105335228293602748038889750843043056123238872758444289409127573565674935410167106422203543779372301417983101015004707453953661145728093124826028082171765580571503848065345977718195428290373156509577063914423172468934586676905032043820237667125018558667049592703978644215636212434645109257995472099768769551180619662645889572665186818916497022536541267034944379157730457467020743879887350378227847, 10230092645466382284797265274724930790216403898154392286241546921148160280735045500181767872568751916058957139995736145814577159187733592120736147183929590911743676225273535324642696750162462015059919719952657772376671932744931478323790765229071447104227317328225339619525117026536615000631431279726968653921924024326063408877938084854988029135254444970024127341684878463968511446866529879756464362691724713083088577976691629151765802212293938078521429050844796742093975440554901420412129593373949637069291537839402050252594401749001141363474704890729812771850740259593203314369352800891371534966690591918849934165382, 18451752966977811577586471438818286705364312609405074615965207396914349793309828316143424148623074164958998640535852677675373066915923384470941143598956001766510600134036647261651486138864409056849493804910055533748386476785218338105050612580576587274192651396331631253514419568838557055448945604742417562201910355410119138612678682387615137612089478825138271462818679243597120177312946553762623533507969079970341430825918343241807031614286380926310649426056864866257805985407003599536367995317825331111153435389935785838142143604335304216172169794035359370210380218272203822093952644569877534254535101722383307396008, 21262313535757497067300540374126866871878319425218941288000977392263540817664018212972640293722519465367738738479103854621382029652050909180014127162004124326094023114438163745770447452307203092714411191770481679992163827261480821883267279311492385913094539053442609973962983489678525592341562449907828532867421734153788355087518067908094417149957250114158256282542484193961349148365561037653070371330565343353611215253927004715071759925060524768779477508936167966781120503064169785503484575509477573559270171328970503715819751235829623296928005268746375014935538509637030884359046182970971712941532638039365274443336, 14216142423971403024784527731692845734927650986092387613400676060692718096553911580298993813817083651596494091984500799082028719317510203935364141260314104931784636094509489693005130353230971635732838143258386760421175843113317396328889238811342222343542532564695749423157384268415121078853095723093754493029503617201901418120319881779842451793366834263884452667082470795589441479281212366255750551672798355412151371317919867792650803726060555887402079031584058522219335636562369097506188991640071274483678119154601203031609394529415558779733616966736975902689426235805574646732490712720782473495446711092382737239841, 28125855530156848233959297766909744558852850097229609104626966259099826231226973595149895575172325103194053084708479506234734145098725127282381931348820532536507740218607003300594879514980068459757845229140307498275061580921907780910035032561858907374812760247137626962224812873844384864880539483165602327966473963297411296071046449687000725379813677581530819794919406237160792258646665323139789782742231457777048900079366432830942562220744272133233835803656118589888773755811463943144336653724879902375170699657116833836817814269315249832867991284083192281716611159516555649827494620177483055408715435552225080772052, 21744246506054233397988045508729748017946188944616325376377076969022644034492469236887620985958064219506017447945513199008124582665907062568303983520453658080421945751070057424141644118538323198076123990649930032528390510918675901993193619542333156110292913664812726808528288242738974841802453271122359393149915020273462841631186925038625172559420715368920337945167195491246189286490015725771475908344600965611655345907463650067728717549050444287880415181322915420464869069645562143488471813036685436548718974520115670229487167874767920062078610810611535512240082829770276639984624032079650340811672057100188099339307, 9831014383414970869422845188318826211798801182480862367616692810303867253828877177175252885748418071211157417174858473060447743818704336925230442300567812662303693385485235462167227489229731959506477720845342023943810281418553769188481669598936189607860838901999528629104110915099412450059828993686142323378456686064952319401419282713714834562279238021358095793314331096546730840805281140394306863439831077995946528865750945049449151664617561260714569038779714151200319492218277544850499265886433672751516848303158690895630796162415702430115769604369144578989918312894065036624689613249480534428415156083055373661549, 21951639848929388461230874984661107307622324681315817285888023816699139745923959906096705434403583950322503757145996921529313545428404544517465925898185502245262299364628857057496857326953456894289275505138714283767115141402129168110793259642375011757483024378472009080437461965310107125706273480586330321439518274863347132834906110172650324409313140837507583012974323115599019924244088766364916149464436169757028403106430750482936041675570975029317374705919661580637701073619584786496150305360659759229067940732794347790321666706251637177374833845773449943040561411515942267539173761132340656917177933238305377910628, 27282166646374911543734744435770018950130522840824291847254224118595463118913375958297087111459589485092639117503091653526156276110726846760530783881681534163793892700332508810543332697674423487090474007651569522643081494293248377056528349406341216575997995804987577268743355660120434122455678138846228380982588090010313961926030029930729195244520665628364578275233496485066742550250125922846216002904953204885304266124387995518913718273219799645643483130604874784071018998852009633673846382700334637273689432741176475455902545784986043511521929455019874361695641184302971095302368412074337404873971351215962678860305, 14234541514850490580418846976629323399159290006417291277586005153483776368376361299526117356755041783164547723349472262177443793534921593011537695383777912579588644111796362411517316789651432305359157455220211777852653988909852727886714228145678666858614455631360304128991071064237622929279592945445347372767874598486415956344655151133864471286663094053137931585276003472840882784247496641459892442383246115545542151051606604193172086125545509663548813812390703880697964613538658814744582933927831354693222994243718082417298136860571854402699441906041809675411813057922642403963330105674979130591661701651010683922022, 13207757965302258214166877355659838080740237971678936175277630213935014895994142413157911470595898219559992138440629341846248888144344656446074806622819543579008082320366997838719909997770609686724637986989475858437429725756213265917711586866764631299394045921894194929806003631323871812614182527553251687678825867698675716344428388075710016518824615966750559079589866682382517415825781486151370861078987958798587026964714079157455613704682186190589151823463578436638876350068735977116927685149648109003445848110208125326828806398652591969943102859349883282905787721208965727559543311979036977739752959228282113529296, 3279759620115776042289246771240504540019334337934813864593273613773419872871053358425960362045590825744032049849674484507185497663278037051964902484189551867642833748949762262134637823153698415040770575254958339782694768523892602865721628159540549225696775996421305370448644959119280235893687566045241059417657139473360432050520340257908317067771717958904913069139579792414478920712977369524887442949884007269319011625369649784129146810431846462466649340515612791613792565849981801739356324964100408926354298561272819093646238453975502294684731717300990239225495790063718205600805694163912023563492331610602945065858, 9362730119042940314233383246810088609887168882898238606774947766744571650706537479160785749609328101454779252642618932288389256458263091002055629032866735001194688468172239341548438395852546377846631099319935593330617218440229480839297836952534477175162111118775382457875604389620191779114588235775319304771940517116986396090423618123453901869140251216768668973045156257876180528021373777961682320241111739384298655387485710422973151246009563143678496080882308705178588119758966512382340970752249948655894735446340791633218968830964718832907149785373591653445617368351341392616633282908083764422690791172303772674934, 1122331994844179344637772355337215494853057789310908722864275569520424102342443284318409085459076893683385958440797795887729105981619335411602569463917751124433548158162120287323719415900373853085894166448690811077418131816118533889953554100854420280196244039753029538801906356436387238387000497747609860890847486227117635108791930480785901373081530509049041209296030414665466423223354825602064654318183594906726366167469450977106140456070386453976707460149424343271235483016028473636296090794894726367431614338455468101508794120452906864911807081077413126005609564016495112826687898659706373991852075102652047021958, 22535438150133094255206218064298615404669808620477310473618781008113219356229037606999317640829627282629677311518074113784399071298854956866764237488277432116158870823041442143625662063555780680914994677782446464253915285274511874300675946528607141688137340273563047820453464441550822132255872928469977160883981290034346631404612236252871932854420873018331850090519963987251095779926569367524596031280765110247034963238031413153286723269536825729701678975480516020642451526046361653144795770280410308769601566770608559595824304654716151674411315965629376829641455411364959385340930214749224662746784912444379083040027, 27108764684214360050343624743289423371308590167109157341816098457955287626048255698303372900718826266403308660134360434173264890953340864859021798875038395925294913496003834289583676005495113799591667885605066092102923548574414936342030956824008848526483891765692508134824852650702580222978340035735296847410553208317349887672112425907752480791687405799299453231786378158229521060564790436866716037345189096845655558209020932457764550272907082929246250476856656374304192414555803142955645377588091434240725224279316894210422501981383634770499211820210935585794908355905333162019365658618182695415888670649445584539874, 8559958537332873537894039279843738323245116593425227592847309780495317547663788847236444902778515917038261003391884665007058436424867078949191680922783489602742982763759147340518856303300516555483952653519485506576206103717019239804254366127465467567970133138326604013803529318706139370578439390808638374188262174833010533569419442247241974446241747780100936008831170324293053887284879962393885565272710856894758247375944095319551526492838775429634219166902415991113177313227800702353129339198770198753512897490331385862138982349984852039181121616109337667298804105322557075594184137807569757471856849266775339843251, 27626838561402701586706090686459848728806005207196816004866060652344101352334928335939636005795423560341318654947704027040895832803828435019559141750861442412060247181112453448367270747989475150100200965924052872185985991622846392482630579860918426120140368638779901276053276179114172856167829896515512931276647031430926884226008096073002161731762645008889561663615545118758101010331076629989604903241638684771792893541056975073038506930628429219514176767162000491211435997642172466309425731012094735146167928119787268061057824369699690072226210771724812526382542853294467420748632671841701103024454519124900369591943, 19345222174574486689463938356051625776503444622091950083250608411725630954275803502029052104526881464341201143690205494403097859718028938086882221191135634938744218057553694939485690309146321407892426846781856877003643839184484640868433022122448281660957706502237589506882304726099622656380493364574526949090612131708704200883879594689296769905700119539988680662071932465969613669253383206798945676398839011627069715523744603052286078814343689219402223029884148881214187056515113213703686867419691165128613087556019806144008989576043190757673841346471448492194965877312707928206042864925570520435424351859931342136586, 1035884263191670762751701007885736472153174395955923268959643053140222511549384926855716853471055928602281064059369460795421351841501442868224790727727669872512347501111384648941493497444036730649695718869609870226041000265121843340801144561494281065332674418388804429250282454454542246772607629897961215232154824248528120295001350755568729810448634225130232574046261981439188438830144734674101969820305269866195440167305359212133832904191258612434206179098933716117764842992497339951399238145666065870307083535653277008325874850052840769086240577962373489330854801945542133597284908119351448039968991407105286036547, 16418451519097400599340416865375667330832198318008688895042253784283167410578287057408555576614509861619550260463568790922536172670489096236883873156764143795958052724804622494621269107166388287148286708092897904742051025811043138491514081955068037170774728997980683214240590247612173254897244060962635647145389544835821975113644965877817478853245566757233571601068923940135524949789939834407492339871445531417743394411224685200683974266285054703515694592053086525718220027005072311997098877477118558475907524578159251942667009998727309627733048866816616640322865762713569081778777415870877515540284461315275029995321, 13192469542162968906334035790249481252226694762299161522575540509396528876762286669826777898084347869999882517577050099981233218064176150709724589746303062935087939736419700854498543643074378225432667504019295360791343131826641717808234690081515319500186406458972955356942092827119412830074237831326620961747180702873859084511608782685232852176458374889065054624814624281246535529677041063018376367543757045125452332056583150551593604550326963538951983809891443012752792899764188830162579955401375156689643156382507977853000753614279640213393453671898679012692881183198135931436570115095900648348580368661698916467738, 4456617429799560019467458802874565317065690246708918651146196568420064367233524631509185582757281190625693475672012780710719157292319570760069377544308393310777168007063156935590505636338017757804189687814053782068638409507952568879871960468785449188563838318837652237617288956814995925239914493312295525033422687719824101397942210448765216195758352858659875354263758115275198722790549301656264931801922274296804483624481267919234825045791728416783815930802002104443765840255949262149064590864265463893007136607960107117406484825881468653132125653108912746984603892582815539441708386719046762293907559070176387305558, 2036306619714661975208085313903627253461372571556329366837922504159549282574356984264023676687318246603508092126228603698622020434136954268839347158371760476518458109358313308789424692542758012751537574052915254401248600997033650664341157016081271267391255107355410183466965526854007508116650448623433825745306994021900382265229034311010939065542392460294572016329923961436928992864443401836566735449339286550378325729316363647063663446607005456337986033608671779846101207928070946756410835749068298116518640317046530823612162599942245556503540057962029451359027650677830840898369551644809141118092002496203928643177, 21742675039237337032242744374154974382209196791288792156900779873624596165312937948586317322360479224825341583943906562897820735778102416962891531769079305300431702453459709840912269190560177154072792026649678689360101219143349506234026827935967988321565519958439239350115672968283715660789354334730981866135357152642027081226945379414789987849760945106702024419157128783890039609461260527890921250284238500044531792511784709622179102112165963230456174877091110174050718540495262460348626177982615458821461855368144176021047152073136860231726897670835047288754869953891729863150285544088818846703863180103417970707769, 17485698829743330590136014868135143449926503021735113783894947342794446692018124727529337829872591274690205812693084650239400588472971004445563061980953109846494064672828934864525898142275253823174217610636028808154286666334773515495402991835743395676275522765188931443977881669674335777217851264538655635008787270386374701050970704055386507485084831024959323374193108522043921522648827696406767411550868834165059770056658778082972024644436285926576271000136481058818528828099434436737415094331438970526021284345853230304553075416356028532775248439717948654874712762404347824976258665820716424989761259376776803759168, 12619048262369913808290997420968422727037640949354467483103684419881609194888547956737529747571140699122170157566675432916854570522513911439266726011836288899172501945653490395519932715340026966068085472771945063539194493083100335359227821634373424463102116832603253934032714369969989521786182218795207256140176875217603341864947910016883948002051489594059989685835494511935473499007521483669341681541787998263985375677263140397443398565752194559025085233287139697334287951474161818756832573780611080062280102907614041287268330632526084398411667801131640771039477942436777163316089445817338577404477777974745598648216, 20689465943712472355257184711175321302325472932947707209674533194782938228835784795144239883468822544988385098401170433414752296784854850024486790745877388625260390640131027422920809493932383438094707246979146711821637088930976510159209181344282359149088712891200698038877852351617980876728264802562458403063152707154340748010817031064960638529065712192526491848759031219506986481714905845727963212491495967591928355306911132583271217750085817797351756835580872211985600357096701030995060556781651179625628696956220061851467198684766390344830397256496882560080354021760650797077330642490878817053661225671025836145101, 23516918039437692907870603829024828251571998892910241488899816209961364178942070652515829137295359180772966387626654910408314634302580347693783499392366091658661452579206291452847199132149917573651888505741860276549548803660170439810829750728084070736687382793794177221340856677970859849913168075746032119667638384926990610346124753763095360758342138277979776833026765167699444145573532460344503978988589470012241804793543925961469420082152885004054967296001963446766892667408296257757623010025715241834111105167555162067680459995749154650479214411591138153256911764360956141088269285362124601255385482807899373700737, 3422947011776485064276097858224276204483964817494032275779025329493877405044977722544938835374231238853577501208276467690583266937288193222739651248400886304418302137315876043219960202825641183536434700803691767918226957094070124906644611035071917157089146295893565642048833012800714350224720813567415563513308778524344426497864540849908323813694057256217209250761827591097424187122230358872942248210895132799868831176917966535204311164795583694633974668360518448758865796891414465575197048083615184301012766865371122877385941683573419214915694473478638884845845103235764307786965256833641677855394886377151900094152, 18175742357200085111977821836048532080199321036400144478806045104235733584625708095735727247216857853823971322960734495498679598866082263220546195499240803039831714588930925229464454945312200930736438117720467435225488861659497200668547337742752685432155802323183643167013716961027551845805652922287187846123292938274000255548511850452154921060277439182055604889531702890203660162588673635072575736009614332071580750694551151648061632874224220049188789376912733978982634421346461703078324502309439329092829951115015396408675543380489276227269293144639396431923702096325108938692779912354893961133270809680637191193685, 20817570777682167773730428754157903475010681466290222661910604828151972009421736702969787523720332074501559220789677301721076783893778155522417814498811856255716194339282036203012090693944545498482985811456931030111673328318134036244298606383077969950991551966648140170992659370934731615256189310393720185806554425017583056009553624832836012873707066089489124123920412464421924440214687056773615625683894471250635354912756868137546362141362275450502589479047176154124104866637996836021462259680743081958943546214968531106034450040589961390288931351598285568827169712380529712060582740810440451626437401143421580073967, 14251425345135229012483383762134688563346179782044190729811298426821892281664588367041448830542661857324513595997788188740760053720566548803206109623649692131962163992842380603008761564031916189227552921793667315256415574282088843613998360788790525414947915079962783960213461045444355176447785226029634834941413329195622295667702568307772530971581930589528610652510736047715652232094959868355664380585620058532552972006012671451590998772833140376519912295194640432779252741820023461354074523609673850367142429398716711783017158871521973051560247369540190253383584708902024302256634328162613261800261025638268030267071, 2472553588550317315791071305382535967462184655427386356103494020636864001337243268952138805752351862907362036208297265681208455934756693180476407048534851320315913492356653964857864716798078224399091274210568986753831025338224777402329651471657223810385740906332083550196775818673987782257568746574116650528992051507049725303293090916767166520942588684350458445237800565321476607351549841752091655206552942385102661173498234278316850159660849953346084015178018395006310254214113291666031335415985636355415085411562196723651372784717571234668992279318777998329368027337711936371284164242673949941968573480590767309374, 14189486717388355157570518548152654165979888500953782046929979336854382271064766872419593110607615398251964790083448262851560957145995342089767602503254506283595124973805004131004482265713511850078251876828894933504486820618352030695659915023995780362202935904627673879228381218167896492523619627569213789818852093324803744283854039608612161974515363280946261595145549564487435949337179152627405955742778241989679433312571020303898564155316238853963755658850813333768350170024256259106425095583185493332627262846032951346535483072605698012076075276568822737746984601867453638402582324437378209934613079621296905982536, 1413164562298373932704260066552219138595631545081902756580114452114417181170905590533676008565515674837573602650777039660383078592288145479076514934230755325069823984608268926002459657099668719584051148284640627955357455774001096692812848679428278538702916806006489525758545988100095855358116289301707347944044044054578069893915300487844697017010417045023402593134488909649716602733823129440966620702477889461683747236557889602097239530932499691169199936752778209604366509616907358169396732918729744870852569999546524011484509018012766474524711737894862876277611819851078981124947868831931205226367306072957366508991, 12136321070845865571853405612753510643366279004750384666756876152876812377997529846474307370176999780989337821612322930551927996522584637925537962852434924282512411092078920666596932712431953040339433019999967287121741903392102928283614650396141600465389660310869463868221012653132699719316078628136949020887490205842604204446706963376211048850622533026598799436630515673868454439749319743603974388916531721471986348182616220232318097586663956982704648129614752903842650436833357988480194131729327548111135290302177336666358144780939842681680382002102863403074340207921560251132170523765736051911425313198354623436799, 4867895685627314098350533054237648741066563208379965753667112345089755017172572535478770289531717646830719914669023348142711181461880863766419879723140554605603099463614387649214447790095740099554923549397759069138545176968395719875693752606883453554247091556697488311718810033905971669152420857273922889210592899591391690223745883937172790007380929694176481601637642748070457768505613552423086361996738160418039053345535717512303012389529544330270109357133316494321266158129953003891890514995456168175987790422577062931687275784757550841644504324759968137858732024996721999252872044934397769392010101367782852566394, 13823617813035805778704190650249348287735440361294180059235674143591342618511535921652511683724868435932515287678817331400066924565516892600212179337146089321293593988279579787175198848886373991312159369185236190740956633423173890619735953661567028834419355137162424441195841662737845652382367317900397905193578624988610643156558688545454290574203850632050250169264212816457323399712513595277942519098453294946794744306834129008621370954295413548299248541796753894594347840725661556442621632930756635052692387931703122682381307489799672388759003851185260692705046687841218632295899694374827221811150354660862490970809, 8164402904086899989464358286497061710943062398060435054988627760171842197088745075117510239654030021184579449145824508426161337025203894655627680566067124844799738659592425866751581911937735419811776381473580323305993400796588830134324882199999551966982399813024123808524858492015353985025676073064926310173508018996377411379513055887822548026087506278670972754314225605874960301529110584085150565514966009162189870781829083537669763091316049896268818517715735524144248343651478291438416966960491977600587135485537174769118499677396109481862441498787202611853236480928398042706684987940311418329857727393118521555699, 7655062531285080613730471260512305630228850195599489765379987942817454328861069810106570645337456419272056693588484142873552774903604269741519146812986371997833118163502635909613783259498041678268113788944557189612666076806333966231681476780499185518244084212773959525150302636969914265768717104055524663236624319271666881091419159214442669820007979007850073161692381733988845959430736630280882005653832634328604316097775519768813633272039368921441661302986855139309887338091233180639459376122795556902261124136521674413646745614847022756996947811103412960833912595349529373877011519025016562519066936986460665933063, 18635210719857507711203086509743245952734543081314646065099714075240716269616692506078391941968662890977650042080229124184086589897965388046567988786760660210671472117833337157296429671270440796097543491740816103459743380937000825905070336710398137913284699156710443262178286360319799753757715772987137230840967616732512997325538875759417677259601007584413947172217070945411725333691491339783590340374819769247138787929655430564775645816319716601076270311935019893333173195819933459847530839595771832513666945418480063623704554705352669329545665071195819531756801720147518495493594510856397280727134107606289602649227, 22009490859045358206298821639355573515542887868903437043206720635025259243813006172433258448035259251462394929318853850304215109498430504290233713167275825904874765918310238137109450241399075932419575770937193424603223086075454256615539632778061772059160075231991612918702709161717416911299267557402443354144872290116019948316423317489806089101834136777739853120623526598472770301967724326554631213178452843782278224281351717282038309369383762402629431367248041647311835646221178088104048623762054881617803843581878746832691622259685883053764870611715340458072798382612677701580365317677518255812092491906405413171379, 10552332235154288402717561690697320254813629299654963819909929243796756467325911802743097218909522359710117790715306987398806255987952864906265404730916742969640868441292088842470983003042136924185385703387052099809433920492300004855883957488717581774017351845124222544143017354393591592329753330462277488136234342059860670663895663973480847334117012115551216300185111489154394991604308831397726894465823888382495185583326760393313745868157854013606876453145869480634290417834917359167175169214159610637493082753170429424648414061321547354928377802264215703086962721898790581452701017204205024362213563189877148101776, 25939543752073939595675301419888650723993738776229749563820050399779328806607598104646243666365102783534790742536516825154053465342019877527592071360927987027862194324522984027545996853916978545200675137372595287082244260292018237247525940786760451802839896112591907644577232085656154324306824838836054640497454805445094183651315677262271151932807269425889086130038988542992189999483205163243923366232937754834694617414069294922752790568941542046266498648333182434392528917718697192912512925764726687395556373945897168961714205467749385875223953193032528438556798251800753327866589181884491866165293661188435035645461, 6936758592963604962770710695663152410682364505667600595527411109117066338952871909376862235497579300618262169060077045889481785916505357161514906997050134617335220092907687453161004312758383034392312226330867884596709297770081885352990283398200281959426983630593220148821615693797720688402763549569962927222101722905589365565628192590923759389077526440569468069914414527947596356887389910683447457162114275538500313453447670604234233153132911571223416221164987868848316815778711509248151043218504034556636280158649183464419493760402177880914803157591278972785351750372368776003862118992373353103311258516004050850840, 2299423436244900878822248292364970631276176249215058402689514677526859859057604811092751113772948104500188305875671422318047401980418646826175945446227211302759291670597143219647307098834569752481904133973808618036307277897916091013994192893661512256114545802389627848508796183658177291685518990512944643930122303635939322292120112032898557126600794226348961909274651755973563762039063997881552017548402047947876335446363837980793163483533051973886570556864974358602308388473409015766343064469529765104711839414600053737097902553348525315995549750005200204596598736334619776341032377009219568851155329247025590878357, 2491627543539151375784542221288346411205931744578725597170715369845225287388919133186636916563721042389381977420678125981455271212903308157063584167046388981733490818830357121497696383918130130016237352205813999852719725469471103109327539409271025742957175589874000501968763114985940217522693802575165460333419367155611372871850273603667163696029906487102045567629336035056647718399093255561660536314903961808652164016200666786308472372675858596483734264467554473323909427026352255746696496982644340793646272466728412912510600933979429117076787403366917472871460367349810993488361912599752264457136591930564408783528, 24381226428568816120731289619484868364351694964151142981556109630040572798997016780149129475350337214788365396714714031425441909446887797769114305100817062998788969525089086380296104832837342201966267973087538663949334414057982678923810052868540211155789266237423275832398954304937628508188715347728640269814408655013207693443394992221324818764780117757122614511836010280566579580038950456280304828641540136537658851136604404483661616382204784534987118027906385913555201090746973986309805930277905675087491481967827594403100789580045418420140277935187888721891620508833895725260476199970110007314670240335190128027750, 7334697526453675587560774905362862151500015382306508928159641300120546553255665542963006340389489156749489873647937099525768459618174721572640748209368200145938433622952258799187350327006386615163117060212345772236720088978026010623858139732237149028710921410654553805830073301188197269212450933164970680509384982101334649949611937651180921875702475638735238753221678777316018988224349575355143127695673249472647201877917953369602145155853339242429331148630962382036229603415762652900874143059048857493304090675062260942256771611348159780535087701153343678448841709436643302430739361963186920342196846685219483973553, 3145084011914188080894894134413452085539992222726242278755772050609805265759340891865613862447242704958787544866440851547767777850209226230725333797317225802476038030228358683321106398510696417538055441562948785180059679160080727542652908701247599606121862953575374332308093513765074285200893980625934773006154189561422275138020385148288803958022807053495613639832675196839592968098448199317182472475587379098028360436230292608211166957393895950667204633991518981300299059173888003058280314201038366012094115026156798072057908572787864318019049936309353930724419997263170294092848446464560574931541797797265980522049, 19129750728406863878839692442134889282552613144277861803839960743095408590957464897972724742716763636653978646235058684881327511647254205088059440869289160144942896706980805047692299812302920300500606285164031239704262918311737560529834018599310033361663555460664767697148732560130444180319107764685440616361524072621252917688466427863419279181476158173048988846640736786729562206021676206653608743820317286595321958945456544254446098196062847633646762658861329537292845202083424472765505443513064004283020516471759288384545280801918193554436574587754153436578260395241436226008248789962409218666677991036875301784599, 8032841803800369652660373636976665111933233467143380844305750039841806062943807420044091101010155003587419330822604939303328848390224216847208423567607166847708936662640865175515630489208345040042468612881536155587129204333879123393567767958057746884141821510643749008353216849684410990875782957041478907992497435467379398778305325496632009965330240932373298085535760209499825039007257338623621909579456311119223580437024839649253882920421693899515355060358829649287374403141839876577534372385732999946970557115548289895248887979021134896327543691103606398388240278754474487283364471208237194960049973109804457436753, 17275450967178548220370935099764886305950359704630836822725296249434086353395776320389714552944364063807301444824871804651485846731439629267544438402544888066341731163446775738491423886863226207499842119135019868712912085057026226039732208955832159205955905411499677693694717442092996866539820174052833351814547070695741727706637940707671879862653254955288711290865712333083787053488026345330581139199061606175041167495448556134458067048062454813093118110283618890553346518335375364252086884654560643525185474179746412237538596773008910777762938399027760819097636509003839875741468934221956815639162541398023965306411, 17866773147598131255485884775404661592204210828572070427988253700167658787421976978267349624555986767860804602271307381699063951986715221117955284505763900820755137852671029711468058154730537259530198964906910355702909646645958780136273299824976439977535333730176023192508285073152088710066873885138853473132146832364924768773867081409714483531981381401370518053077852519857641980877963901687054347321385052940504485618970209279540441476630353088749381346861544830732508689029618936032662417854302957306636425158307139928461421755668305889967364758413828329731268867015432978330900978220022659598498736307376672546975, 23590673998574398613507924928195732206120732270474522469315711369670300965883620987654439117089055697959967127997619653994387194237051541479657099637472415023123925009995867640812500535697693095732628911471638230679537185175143936005753960993328483694814017251110143637207936096936201307797162751806844213383252006526826211539406379230517640988042139278731071689593049969032147409785596901236944575084768648421975779942269750523800869267685851250586092997541518489835350501082828826258931104383180533961925378223686772014225781931718004913168560156188586619468618181520512888565600480292235612430582281235345779824803, 1793737423889141761759924476601863192456196623721657619999901594813435073045736916589814276872179679911749795632849473494297781131760698210039646883197574744384058562556457765385584725567333705064296902184095718538872273399009656779006276293790791688814616994887173181277615591181712238151871427267370002292543981057567598677859979382963711318852757413981282441042966504301136825174750486730667576685065847872248865674208267027056140775884490226090874291910894994775383124686520693469272588786068934437869382888750766324841324531276199306060883494917753206491078282693894496825232909073370641663470423873711343183893, 4975734740918430691831148628167796443146013131364802182560964228406902821419943049704723057141553057145497085807809761785857686176805905448229415464004499882628808441993438844017736578170037322086623295558088256978568026440602068127860779753711038421721805850243362486743575453839729756581554871572632070990020060665840791724058428356518432926293408710613381117680135589504441438638929914100444038058124694633997760096684103872294674286241210810586023322118699918330610601096159128262832689679652231147415861064740958308939881219544828218621709418058214285307219831971916645861042835982398371718807353720677463887801, 25726937273457753950137390175022699656045307046146620764321605325481603919222037713801170531000468866168824421200974538308727007987230470123630255259667242477122214519047783981199312526773147392529394815023238608980167994087830182243138236927604473448955086890922526567312847736745722016016552312598225519296035575678112612750410168619283641979593886697521353896456195041798531436296043906526389395576491817513476264182244570318951814342809646981083231070224443680367938410132469028600131487237003992202723148517766058448817186318485842876641475316266829504637813226522440976057033274996303474183383339190838920416303, 22350885461855590667974015724593498742140280129294476825410552581380589615049994101609356052395164548267483395229130904196562011397994389019289106785410189815275370652601398314348466345552864736708037946440243296556984253837111085989663763552950869197864616420132785423602829940277183379858458054956217321575492470278422296678884936623596045458879488905917543614491185548961420768004880984011157845802696667994669178662054048601681201558012183869275788170446032946623515344802462821000639027940843106891513520411491825715760262351406947918228111352512136783199449957572211695898840021348439233946325079962809919735049, 10479691983778985869299243489762077009549514516192865640331392739561278072961327635588172899428043838583730708262963553929800850300557563649059867988373229866916664272375607132190089038639713056190935814275791562933814969466923167819347857315369925904463724279063743157428620453598638860375631306380616851333569467343828203796272935284169234353294355260388884118120799183886951674700085594220165724578285143375297173331493655229979867748760214324787031508066796345421212144712286145598132596329163303293582152323456785248777053507523778152517252857467660259244212625289548511083110271241095926442434488428636856998699, 2113431103027497205438939296654579310494763872157990996837326430747464502333160088817588816056465525508693326673524455055462113681578598826748793855727217746670744025582114152761722017125115128497608783870911341953304344727514151529131418516561164235523260396491331564146999694820293153162207934851984387707486355883017796822561433797433911681224187210006358992510899076554768632676474275059440722625700969411133445645023165113900539322360698758009425187918707149890695474004524909194575687349959086975391599491621447152452242366007791178192636283347193995948387691596109639276614176281276618075741167119518400592349, 15859822270252280372339776415268635032195190181491480977985915825121793186263423343463436038406869463864009749115856404730546715251066134820571288324492366563722337191144433865452032453848131594930587492115034276931326585687606552355695151388681281361872004010646132219524506415970786824097227983352246575683315205401348705822997948215817694589153464437850005539833810415911478834371171480515268353583305076910138184090427124267789057943195538110804201994355928465415370531829688685389600599153164585567849530040470770223243099191752592016003993917749082622993242652281011734811034291639296826280644963006840432733241, 12879596294708263759954798140990614730590766745347940529435173144510515921827087986158892789515827464521037345327242512768364043376524884022880416281533593704331657879622857512593799020031977820476676836714462547987391624375072171027285559368112962856530962323641879208939497802915281827005083677409640087967394417447638511807863543331843269811207901123673801533866692618075357439483502172400803085184772393911537539010128842778697917622254746004674228954957295239616676594815975133477273094722645244213591333735328876600329856727847212562182277655276648421564999671572993010559148403933687785975135954888804406119728, 1488926874904067375750484959152891272145455453083181163754975764555915213245246182810476193573817185405417276691036619111756908070052732655808053987666015148126796516421850122828684894797291806630032446691445560098092917026412919602431631671974398012398539654918804524365996977894330385285676403627858352641448260263943490363064115161290116366746958524682358122096047488669356975381220847628541855869473460505587976184706502787066466011699271176294676990393358957761117573352479742594465274557280825922672361313697043833956806174363279945040326504114608688979667640422943643308768408623173660145091611321083360836343, 9065983188070880818452426178305413215794555698200091841248077513593821633901321549516402600968124155262291444407549645433454383845205891108119735522543718560229737561374506394787469878567287995066979474617195633968051886053066114244319661782149626953997385663684137658029452404582045003886730691052813064018211743750438192887621447155326699767914249548700875102617985302085640305546792522685508322409735713487730863535056135531933156486667772249786632814255043194521174744347039784549770130839158613425054585301563593218656195250611235910653924098195655701652909478069828694198569704451681430735773076454953162806495, 27895046711741019858850360543103762381016645411688971938347586823508147222072571256335620040932832632847016074982868953565707247335049028683864448988459474218911520424409449629890409581387073411027854616674337440010048642435683977644612614328798406576948669035625682867879200126086108046033606312133832060151924911156797883715783945672243140207283862911531614287542128868297265918306495115946667812282661810883685215336349742709320111564399587497743755618876322820052810044200497131103555418281614853420974438507136752493780576453554212278337282804011139131371193467638260246568583778958920808944744927087045353372935, 21852737738873958738028027208395925213425587180893575510866622794828487527056251828221879486810591103374547840445172347882865461939541230046427268154026242819451664607689964345399545272992636495957348474798569121802283464067722180309289374347259783630859137900359857491671409211922329025349200328625751330217204798830085991021964065677348089300001150015587000326090540283377243346868903172520116959546584119204554914999658686555987790326969119357961968168904179168729451027158835444958259208110339256866213624427213858033980339004527463786675701487016103748528158976340939088712741479446759161582253074770227063390255, 23526733219863215801711786002214998072189689433369158491673660677177771068585244642012584639563250444525649988440721549014413914682976084863419297094558852732491215807040553671277633757218047191090496568326756324935369780996299200434967247599378169648667783388531071419296713082412225694878532532652906196241213523251365080999728963257040802300780147269999618484877705252091903648039782943522652719049641082357443659273310662377297801935252499706575730760940943043583363983865388909271904286762497228926092648887130309172707679391282753442139865797066435133654415198414472810015543278752806207354901074980425640477018, 9900538671827866715602876230752284531906053906291363053681149789572627223386096653537667454824520834489701395421726051840481560321548959856580234236238080493863619810709867197986406339718597158886749797774813747493050724506713102315210378847926997008570275785792810878003612097286024556030747030514787497369694310276267534164750128250423235574584478938622368208913393049429166903557187543775402572127624462514480482282890794252598885614052758807152343343331384376955707164506990871495359164708306884567997319170363241719409427109372481318985406714381352011028139375273531330515671884730719884752517212333955409137947, 13309062570006029078827704721257069621665581366679891801756885214629068724290859585063521130716737105026173550035216141563484239259729666967128733975423210003036075356471248570132644217108136987109172223571326026685892137538556793792413212139662107711097463223668191979543234123583510046139220785160219568740237163751290764186730288326368698371622316842330999659824664623378209605365829062106690574775524069743237845340486992803388433721094299218163304388348971239851037939852534196195049512760131110235233974748369717676370118419087048467294033090844990602900123341188527324757569258017359170899667129506095081683797, 10407111070076667043599934703233718453101422589262864741339095538340842765818128172514822650555230042194716237845471121548845610000123719808190745919814592912032241224567239912068343300102659166181979491854582608450007099354712202342894682142405884188288811842905454517394261597730942396983391253885067454184160250615023157253564570786826172122788005718451660612080581350675836642373726717029840433469680453285047888618166042113012722789891788880084133327125681452281252220515296812504397446813907973980281490544864898557429337697250154923628276561790510139715490079157790284181546251056484921004475331437621666447688, 23993097007925251432818485069238206556965703264612571199051193590786756889055386769848360600402676220634124608150292185778665773953211551724153365177826439792489322267054179590132197646317842030301895351757073845783969053757724336410054218844783303801220719761751117929339035030399311289123677319490327753171925319512917194110999173276088998368906287467103365349492755802060501257713299603920657284610289246343085876532287619285269339617603884003112663881108245059015942532619906799889861720668623070534178312841755975108228680268826803728135885558651064141803586807253755275066081582406992718919227944919055948130241, 11086745566745834652566478375028336589252778267664282286366923549705945111477717080716115520085894701683344475520314942709275861356186720792389789260468031667883043429932760738635912569148830308313807509247475049769118081220908685503420911371481761000052994934520430689776221120330131627052931990503333957341686052465120952122458122888271891995810206331429471319484448058323727336923326288895002550274578652209109375157569953819420148523797094775990362985362513203942914318227834787920405891176567779980721773774093950747349568069317022337417028626833327193815870840522409735787597982107668778770178800813996409431509, 18887053599016036121678357161013618838393027477952737533983129225422901498593774706591503749627038057357724024960765243773781100902858446596963297369789092484850048883861099844295538344292746703733370545561263374131944301349963764769740469957376515977736926873712557916908738253879575442321491457796970077764968278456531243925394677955662115605903720074735401626965418049985460169196982253113825839073657455341035479136300632177327555523616012963584790241214978897319486491600108762118805215237727911532443822846885857105560220986767737618878903107274042731143645906341952035407142186694743300414078987816163097029794, 4851078221144093459868367291594241467586517889451676720901174917667659760953882385846367980786456054934078963332795344078311957272478029033280910310472883640685284073845355080124631609021062354396043377607768115136682337331622403819220363566829423803941292866133097178855216697960455000284577237514853486381192308405260007998854210612686574518472621898930545153294161032189971650939564627905576293554561790694885473962121455752696296447519417139288434299188656874151017320942136435475801620337444048759678635288846243935566386313991067472670435609367178274562108796420562331056164444778920789629554600857024753950032, 12030077633907429313864254216950056948029567697949650433504193261205622454338565064966681752706340396729370608348717243772261655791134237503601318571087939313691503097701370376421701997657160000536130076639270854218463509043776949340970737629595194775342629519023734349068825347272864243880544924206217124895282434595796357868497560470401377241015789530362839184894516233709312905004720006458215608744676388507303369071681856359951752197720564244999968601772290100727269714642058960903349001756002422164855581057067341321089776435767699814559991673874384425748481465789674594921259030184779333796176070583011714244694, 27797602399802118830472025365939148958144751963507110830635099042873605389783756454420724248731483951522798207240273618156592487277705979173049513577934133701100966996850617940259019960753426321957548815373716079319501068218676913996914997627895359865555884174462132821148875369885121072493884888842559986915351004218403488366223255424002186603481592568981103596686809459705119245886264607190360872055670334753138388861122410053413555453612475921813533082530603914185680995619455999081820565261497709324105898232201777109107270404724669433055987645090004780888953910025635109780584322417209880244113068699529973204835, 20586928783594709807526116009860540482548728095832819817930397875016827125538134555539356073326007982330081197892815642451351965290813895476008692561693049433166898348304463480682708614765591671292825692605699322412861999382842996921855995950943700145140010624563329452510542355236626162055456474063094214771253734228876480933165522245186845361427790497450479197731579434741807606577507957937380395449844633313400573937223444644454065397563027744081214878813406260616272681678885423648893873742324947313781773447828147831534755875820896244761898478934754537183624255612835033466751897171258083448837189789946089329331, 11140327811294623263274042938381539686712369241307875075292387960052171853383872926659820727764419765101047061065339151660815110665926272344822143063631198279764530300286928317066282409586919743550837851960592119185170399849945799485036638865565297201724922776305154593653358259151394607026141773889544619804533138612156035434669667018515049196173532723128754441494928361870764609098095557597258483950533017127090540305667300740694836494399332885607314821835707501610894178433038383582120437250493736686169618568967312214651505240649082610679333182813668411754415508711148716531318456453615560332663738415368275653463, 13225198326935654847621094577913831505298352521052561037824230295146352936993638365310505229608208293126258432646436423283378768016731138787150950427827299253492105067038901300487419883018255651981019335557356974460730517322171524097176232523328133280125887902764903596411062687530206149451073108580598038982173274490715507925091181368660339231912747687194433559243414224981381403337092807193873589016442549233884451368026731545038576430355927104438943994355081822720884644149098947750494086501879635306432896897776093237470848493886245979740971119315708568975721631862798100411643824288056480300849040919640708604892, 9745084012670825207312746435956006624983675694719403682485839093226938209226363513366690905043956946268910151232468864739224303369560046587848253202638172661525238178581616027672971480122417437009108867810725406065548371250870753288040116322384366720135639761829489868660552628618161235588489429838548622367780768778323146900598356261305185941378764043379481157763681431118961764872440530303303387574345867598739180952029668237061330718454132524175349136363200725769101315848332965227309019331666170943402231871661114602708779464812780981577786932100863637303717025870388725612651983185846368854016807674508197430306, 18213413640193731293064744211234468441180370542033858354671888384831258869617634399035599490173965883137136265548646290560620431992221547553534767309684134097123550354889499198890372775206476721585410464839077288594525956162120780439925748884371214022147866050235610242818961795879650502017484135371926516512760147280251962242549686030022402752841685718465082421565331235417472982115676236179709808678959993462060121329307691179036429343352910083594926243442825666717450848088890238674656960789613405603132124324098540423523169518185802098022990902499990733552704339179545883212929026306134432478467184068498407727055, 20469809091903264716857290841835962312392258342689393998664076291386163043761307645322716349886708183640913802963133306298924925586901360503874277195552303219242312392806366017846159256583179604524660320096184446383291305370047208393657679101100684537776183791183317651120363627261121161989953881193756852914915177923618064131985440903795826008884672785454629415520109417629344492994675960516029651822765459565932575154321472078142968237253618249330546995723573021320938479542044101639239617498388424544183635546485647224824843020203393267556486191553525528623860220644802041509843810798357282947899108563592542086247, 14328482516354605011066934428912803230438640057111455368085406025872551415178258694922636859145733184503646620730368493697091858955244755258812111112843141112320928350518528591636880586491968855239449496288286575692803138551630163172770286583168893989619420111041730956519446920565691857856825663731194621720727617068477479567532759159943896280245777987382137367682879060524704222827324341790520210046972749345006669443712634506641442088883558935693550933776954487689356487365988173237635746119204403130220538514970583795411760610861887711931268323951403752483332896366017233573010404731798106542094530488718203435419, 5795060867402191176591562973885534546905088773475846480649270299410301249983876817530420601711504384445167873536334117750162337205169871007051434095343168889655433123305076901244850380866936445194089985708834800347534462092505140964448158159911893625978685806620812698704476961366503838118845732363286213359200235377005729274920693255210560143106958602798006717095870522281463341740974393056507532662050963801096310489678546312627471329139602668237783541214359521786063089192572896521095800665439303361222866285832851271716148230073115126273702880316120459679454453387046936678819903683900771302169469303377809175237, 11140532419998605957415175686088844375830885720297666477015001564597284810635026223519107114541689938709582724493613115589956687472025611175077934608053522684857926072124518657062942162644750808439204499947482912625254624286031812771746318656578480738088530253623590004550923066922800208129823285045967569753830836919094921800602608427603260941006981492041485711417365632741997969913962583907898491015932380174857566397308285681370835984789713244468436258287971214459178825128885567602272658034020705801817530283581323428086285688290234033935537204796928451280192612150283530370938337321395022309916226745465641658469, 19955768620912828769971038618040057963434368481095635859862059713148848683215826866557285002579580075034795681917743306610940926671359594678317585488167435846871386934193239897443744655872073088595559688263433118072090626728382581672671162151265348673895216952400882233369589042648053585916209597410517139682776206556680541919025508002424940461946655078188806215831172448835304371289597505929474607583479473389410500162979845132892888598167973115821839276205439162640542329713987468071529180279003920913591549192460374463176277259780223064340358184780616380152752281326892043208205426644090773657547786779360366393832, 8910019532912763472380614876136513758997464261747455398164477111971186655072344040070331482437378395099358809633337626327621816043182392645821213726592500025750500022018260567279073861734867925089111967277981346853174506769108475120408398276427758318304987037407082102955744519930832631600359982218788001105993828170002052565947333965914147249985922927983476413871259736114839646315129969623555195788687678017056772708868188696946676863011657517910536827738707477397381441227594327466422408811064033207600825090134014557113430712356101734568003864054010929380312694384197547560612244160539924622391609487647050115475, 25035702073785033554612284168061826658641057220805720115665713181128532288500278106049231385192899725205538563872512918745822353304790757873001051184176840736697792788320078887190942326624601353219026144392267270574682894758403021445763749720448642684229665127722554676636718862229465087277909621661377847296991823641584625068253706190803879477637370169437024913303810872295434331808756639890569239789019794848228734202753205801291203511196922195216064204133978667711666848568981097943210952801219616797738093232166006879408997874195836748262549907391017281359644369352708908571683083598402247855095215124012883085596, 19664593289518201193490275514890375166113391638954408949552627901544537885257299470814009404080284403185091292202650541909462803872278164170432950817181539030678528692790344569216072710419536854731804858565480261573897110697649589070148419499033919449141919709241862540391378514429900581916300487733232751793981932012735022029645214229153641762679185779781342184833743495976023429287230754365055768227346220102090180687236051834895073039442766493121632731614723884671965698226903696732050934598769999686869863598902612147877414344371626440872498938913754375659268257115499012463007943519724518959411525623995037740645, 23613609997954241324467366077312263058868722829267911053872475988595685489581613355294288583783070291097168240965991696020337583083399851749390931861700557934660891096750907574991952253216522488550737075006691297154261589123548036555115615492811003426887236325971853593006282703815727236329603481653239349174061933949031880117954515580282730487920046913283924048791351105115229999617819779336341887320403704568326895022977901859895615008384008878794553559026299878732643045177305830518071823553016946930357426672681729229494750872138777699223418992445407740519110982436234872890956037797231553583695323311469799564598, 18972094931497158833066527349147471388202959692586831768637494132580153605583562753909482798818124232816396749347286855378223852357629774568264410739825047391983296560502964651198867777305044718080596951350259795026669416401321035796502400608028285307006943841022254935088367566315107281918663198682596170952762169711799658036957076367358050991719873819355531447026053308975272372612882264793441015865749486108850862535704295780954617749320488817551146054484908016227772572605175700668387163528760237989586978241588415477428983938327503756799288789680721858732486938281486609210912609083890842259780441858656593871438, 9089879396502158831731746586832388209952005852211232094378510483627742657769219918092476583140354461495961215370560999728943159551102471980673349494391786989181631636714679206708456953132837156041878685614680717106851359825750608507168471283522699762053438076216495255786422223511478915854926497662874161372898564788838370406804423723590517352629066793394240993587369777324905259890850394347480952296370681683176124361880370499583573893435749769691841231242586764097762531660714328332861806532407596847828991738169163562467771859794373044187197380988336483873358875275700482927091248097133796295507817795003992256190, 21930398802769683896379173507995664726683086656075708580841007504040973130109742104263119826768693546078608188716624418068760445387295823952845395465332012201826158521632468359234399784637740941815545032078058934401247281751934613440912205877211311432064106295820599405281887700738514388625006356941400832139099797709813420088362546610753076591720168808143692961151008766431495649372345854475613765636522999442178381231433812370266605480327560514581579092438056752903045405800468162321017292955465809134893733862281043379001985010097825468051058560760055537646809446188489558535727033833294845501138601005424786093580, 13915948438293695431721691672451068680456285611206744758817419329159129861911014525681402198033408447231862197242513747817161567602619605590281063951549135404843507222985869162389996675804421732448908985646070179356530601811772574582228411154455218227846053392077384987381922332711930104004377994584052952966006404945999520380905313376976146245954196072110798159126675610129242028624351659324027227330024100848319940183634826731634998699142248972425526474101033828804917997412826939081940290586776897951226613200873703327546638254699868697107546304277678803913502948126081477985044410195251965069203834566565153816271]</span><br><span class="line">r = 93549208091522943157523889855147971756339952408014900465237079549147321642184605352106076825075471647946551417457797445371594401297547607606554921501239662351004696055416766322360074764155873771691904894277891317076059387107629281872952247903070858893854519963946004933092428964179404235822710307390762443997</span><br><span class="line">M = 41114562773057591509703798019081726715938195388792207483716010974789826658609043370184495922299754629166062481798971234172682345725464787827933687171665115253731281252387251668805119315677910253579731618701676377111463086179935234982471957816896707984220800374578967269143044956222576420557100741943571288295</span><br><span class="line">enc2 = 3308959603655783037626701651449897306691054491531277011007239956503226856416291050447522118208505181328835654445067869891209022570372449235908057926971720202776819863989791528582562270047426782371075056370483172178853004208276586218043687123444373535519007051969960162889822736022485151723842157816601130568321361182105375979062860034971261145125640309251608819317332361754077108485716298746870151841624987872455719817354570871513465617937552265477428311051737704837212011740627884815342732601532604444076319807464313504969470749988374578293008881546119868431456512406342629832650219747911308702089872865087547016692</span><br></pre></td></tr></table></figure>

<h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><p><code>y = p ^ (bytes_to_long(part1) &lt;&lt; 0x100)</code></p>
<p>$part1 \approx 2^{256}$，异或后不影响p的高512位和低256位，于是我们可以得到p的高512位和低256位，再用copper即可恢复p</p>
<p>恢复p以后异或回去即可</p>
<h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>参考<a href="https://ctftime.org/writeup/21878">https://ctftime.org/writeup/21878</a></p>
<p>有关二次剩余（本人对二次剩余了解太少了，只能套套脚本）😭</p>
<p><code>pow(p ** 2 * k, (p - 1) // 2, p) + pow(q ** 2 * k, (q - 1) // 2, q)</code></p>
<p>因为计算上式的值得出的结果一直都是0，所以怀疑题目代码有点问题，认为正确的代码应该是</p>
<p><code>if pow(p ** 2 * k, (q - 1) // 2, q) + pow(q ** 2 * k, (p - 1) // 2, p) == p + q - 2:</code></p>
<p>$(kp^2)^{\frac{q-1}{2}}\mod q + (kq^2)^{\frac{p-1}{2}} \mod p &#x3D; p + q - 2$</p>
<p>$\longrightarrow (k^{\frac{q-1}{2}} \mod q)\times (p^{q-1} \mod q) + (k^{\frac{p-1}{2}}\mod p) \times (q^{p-1} \mod p) &#x3D; p + q -2 $</p>
<p>$\longrightarrow k^{\frac{q-1}{2}} \mod q + k^{\frac{p-1}{2}} \mod p &#x3D; p + q - 2$</p>
<p>$\therefore k^{\frac{q-1}{2}} \equiv -1 \mod q$，且$k^{\frac{p-1}{2}} \equiv -1 \mod p$，因为只有这样</p>
<p>$k^{\frac{q-1}{2}} \mod q + k^{\frac{p-1}{2}} \mod p &#x3D; (q-1) + (p - 1)$才能满足上式</p>
<p>所以，我们有$k^{\frac{q-1}{2}} \equiv -1 \mod q$，$k^{\frac{p-1}{2}} \equiv -1 \mod p$</p>
<p>$\because$ <code>enc.append((k ** int(x) * r ** 2) % n)</code>，即$c \equiv k^{x}\times r^2 \mod n$<br>$$<br>\therefore<br>\left{\begin{matrix}<br>c \equiv r^2 \mod n \quad x &#x3D; 0\<br>c \equiv kr^2 \mod n \quad x &#x3D; 1<br>\end{matrix}\right.\<br>\longrightarrow\<br>\therefore<br>\left{\begin{matrix}<br>c^{\frac{p-1}{2}} &#x3D; (kr^2)^{\frac{p-1}{2}} \equiv (k^{\frac{p-1}{2}} \mod p) \times(r^{p-1}\mod p) \equiv -1 \mod p \quad ,\color{red}x&#x3D;0 \<br>c^{\frac{p-1}{2}} &#x3D; (r^2)^{\frac{p-1}{2}} &#x3D; r^{p-1} \equiv 1\mod p \quad ,\color{red}x&#x3D;1<br>\end{matrix}\right.\<br>$$<br>$q$同理</p>
<p>根据$c^{\frac{p-1}{2}}$或者$c^{\frac{q-1}{2}}$的值，我们就能判断<code>x</code>的值了</p>
<h2 id="part3"><a href="#part3" class="headerlink" title="part3"></a>part3</h2><h3 id="解法1"><a href="#解法1" class="headerlink" title="解法1"></a>解法1</h3><p>$\because M \equiv m \mod r$</p>
<p>$\therefore m &#x3D; M + kr$</p>
<p>$\therefore c \equiv (M+kr)^3 \mod n$</p>
<p>解上面这个方程，即可求得k</p>
<h3 id="解法2"><a href="#解法2" class="headerlink" title="解法2"></a>解法2</h3><p>构造格：</p>
<p><img src="/../../images/Lattice/28.png"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">r = </span><br><span class="line">M = </span><br><span class="line">enc2 = </span><br><span class="line">n = </span><br><span class="line"></span><br><span class="line">K = <span class="number">2</span>^<span class="number">270</span></span><br><span class="line">t = <span class="number">2</span>^<span class="number">254</span></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,K*r^<span class="number">3</span>],</span><br><span class="line">    [<span class="number">0</span>,t,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,K*<span class="number">3</span>*M*r^<span class="number">2</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,t^<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,K*<span class="number">3</span>*M^<span class="number">2</span>*r],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,t^<span class="number">3</span>,<span class="number">0</span>,K*M^<span class="number">3</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,t^<span class="number">3</span>,K*enc2],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,K*n]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">2</span>]) == t^<span class="number">3</span>:</span><br><span class="line">        k = <span class="built_in">abs</span>(i[<span class="number">2</span>]) // t^<span class="number">2</span></span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="解法3"><a href="#解法3" class="headerlink" title="解法3"></a>解法3</h3><p>已知p,q,e求逆元解RSA</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">3</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><p>整题exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">y = </span><br><span class="line">enc1 = []</span><br><span class="line">r = </span><br><span class="line">M = </span><br><span class="line">enc2 = </span><br><span class="line"></span><br><span class="line"><span class="comment">#part1</span></span><br><span class="line">phigh = y &gt;&gt; <span class="number">512</span></span><br><span class="line">biny = <span class="built_in">bin</span>(y)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">plow = <span class="built_in">int</span>(biny[-<span class="number">256</span>:],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">phigh = phigh &lt;&lt; <span class="number">512</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = phigh + x*<span class="number">2</span>**<span class="number">256</span> + plow</span><br><span class="line">f = f.monic()</span><br><span class="line">root = f.small_roots(X=<span class="number">2</span>^<span class="number">256</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> root:</span><br><span class="line">    p = <span class="built_in">int</span>(phigh + root[<span class="number">0</span>]*<span class="number">2</span>**<span class="number">256</span>+plow)</span><br><span class="line">    <span class="comment">#print(&quot;p=&quot;,p)</span></span><br><span class="line">    q = n // p</span><br><span class="line">    <span class="comment">#print(&quot;q=&quot;,q)</span></span><br><span class="line">    part1 = long_to_bytes((p^^y)&gt;&gt;<span class="number">256</span>)</span><br><span class="line">    <span class="built_in">print</span>(part1)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line">bin_flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> enc1:</span><br><span class="line">    <span class="keyword">if</span> kronecker(e,p) == <span class="number">1</span>:<span class="comment">#或者if pow(e,(p-1)//2,p) == 1:(q也同理)</span></span><br><span class="line">        bin_flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bin_flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">part2 = long_to_bytes(<span class="built_in">int</span>(bin_flag,<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(part2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part3</span></span><br><span class="line">R.&lt;k&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (k*r + M)^<span class="number">3</span> - enc2</span><br><span class="line">f = f.monic()</span><br><span class="line">ans = f.small_roots()</span><br><span class="line"><span class="keyword">if</span> ans:</span><br><span class="line">    k = ans[<span class="number">0</span>]</span><br><span class="line">    m = k*r + M</span><br><span class="line">    part3 = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"></span><br><span class="line">flag = part1 + part2 + part3</span><br><span class="line">flag = base64.b64decode(flag)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;8f63777132edd6be6c6b884d2112229ab69a0b3d983c7846cac0b066468ba6b0&#125;</span></span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>黑龙江省赛</title>
    <url>/2023/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E8%B5%9B/</url>
    <content><![CDATA[<p>从其他师傅那里拿到一些赛题</p>
<span id="more"></span>

<h1 id="初赛"><a href="#初赛" class="headerlink" title="初赛"></a>初赛</h1><h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">n_bits = <span class="number">1024</span></span><br><span class="line">beta = <span class="number">0.29</span></span><br><span class="line">delta = <span class="number">0.45</span></span><br><span class="line"><span class="keyword">assert</span> delta &lt; (<span class="number">3</span>/<span class="number">4</span> - beta)</span><br><span class="line">flag1 = pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>], n_bits//<span class="number">16</span>)</span><br><span class="line">p = next_prime(bytes_to_long(flag1))</span><br><span class="line">pqdiff_bound = <span class="number">1</span> &lt;&lt; <span class="built_in">int</span>(n_bits * beta)</span><br><span class="line">pqdiff_lower_bound = <span class="number">1</span> &lt;&lt; <span class="built_in">int</span>(n_bits * beta - <span class="number">1</span>)</span><br><span class="line">q = next_prime(p - random_prime(pqdiff_bound, lbound=pqdiff_lower_bound))</span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d_bound = <span class="number">1</span> &lt;&lt; <span class="built_in">int</span>(n_bits*delta)</span><br><span class="line">d_lower_bound = <span class="number">1</span> &lt;&lt; <span class="built_in">int</span>(n_bits * delta - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d = random_prime(d_bound, lbound=d_lower_bound)</span><br><span class="line">    <span class="keyword">if</span> gcd(d, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse_mod(d, phi)</span><br><span class="line">        <span class="keyword">if</span> gcd(e, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag2 = pad(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:], n_bits//<span class="number">8</span>-<span class="number">1</span>)</span><br><span class="line">m = bytes_to_long(flag2)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 12779292788328507635646485236446323990578456114967808016182263578178494180795370424798860493650480053570371250811905773960481750940458827979861184722353108227092212225595979824252209841697659509529606215126716440565931530812981595774746754816326511322383070955072647153550727568166534351477967896890021106177</span></span><br><span class="line"><span class="string">e = 9127521457923354456069487334973053064242751338553190692058159575640567634725596267894601092335626785885309669456842153792617210853891969129983736241476545935575261789952791385304618176639748270574246664480305757268659559315780221543289523307886165842999070576207133912422055150609884199685294091097607124409</span></span><br><span class="line"><span class="string">c = 4715199541938838482829660474842815637758774748907642018610952495675409399919781649074418880398481916563366285817131200590553788510331744823499159289515632966376454919605434679417642103846284370991583023683038608112090557964515005763676931627459252593722505464252259469202165279234233266578704442372964772018</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>自己拿点数据测试了一下，<code>p.bit_length() = 511</code></p>
<p>根据</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pqdiff_bound = <span class="number">1</span> &lt;&lt; <span class="built_in">int</span>(n_bits * beta)</span><br><span class="line">pqdiff_lower_bound = <span class="number">1</span> &lt;&lt; <span class="built_in">int</span>(n_bits * beta - <span class="number">1</span>)</span><br><span class="line">q = next_prime(p - random_prime(pqdiff_bound, lbound=pqdiff_lower_bound))</span><br></pre></td></tr></table></figure>

<p><code>pqdiff</code>介于$2^{296}—2^{297}$，所以$q$的高(511 - 297)位和$p$一样。</p>
<p>把$n$的高位开根号即可得到$p,q$的高(511-297)位</p>
<p>转成byte即可取出flag1</p>
<p>再把flag1带回</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">flag1 = pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>], n_bits//<span class="number">16</span>)</span><br><span class="line">p = next_prime(bytes_to_long(flag1))</span><br></pre></td></tr></table></figure>

<p>再爆破一些位数即可得到p</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">12779292788328507635646485236446323990578456114967808016182263578178494180795370424798860493650480053570371250811905773960481750940458827979861184722353108227092212225595979824252209841697659509529606215126716440565931530812981595774746754816326511322383070955072647153550727568166534351477967896890021106177</span></span><br><span class="line">c = <span class="number">4715199541938838482829660474842815637758774748907642018610952495675409399919781649074418880398481916563366285817131200590553788510331744823499159289515632966376454919605434679417642103846284370991583023683038608112090557964515005763676931627459252593722505464252259469202165279234233266578704442372964772018</span></span><br><span class="line">e = <span class="number">9127521457923354456069487334973053064242751338553190692058159575640567634725596267894601092335626785885309669456842153792617210853891969129983736241476545935575261789952791385304618176639748270574246664480305757268659559315780221543289523307886165842999070576207133912422055150609884199685294091097607124409</span></span><br><span class="line"></span><br><span class="line">n_bits = <span class="number">1024</span></span><br><span class="line">n_ = n &gt;&gt; (<span class="number">1024</span>-<span class="number">428</span>)</span><br><span class="line"><span class="comment"># print(gmpy2.iroot(n_,2))</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">7019637774422141444612401478000362521900151189205476410764462730</span> &lt;&lt; (<span class="number">511</span> - <span class="number">213</span>)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">flag1 = long_to_bytes(p)</span><br><span class="line"><span class="comment"># print(flag1)</span></span><br><span class="line"></span><br><span class="line">flag1 = <span class="string">b&#x27;DASCTF&#123;9a697216-6900-4&#x27;</span></span><br><span class="line">flag1 = pad(flag1, n_bits//<span class="number">16</span>)</span><br><span class="line"><span class="comment"># print(flag1)</span></span><br><span class="line"></span><br><span class="line">p = bytes_to_long(flag1)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**(<span class="number">511</span>-<span class="number">213</span>)):</span><br><span class="line">    p = p + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        q = n // p</span><br><span class="line">        phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        d = gmpy2.invert(e,phi)</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        flag2 = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">        flag = <span class="string">b&#x27;DASCTF&#123;9a697216-6900-4&#x27;</span> + flag2</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># DASCTF&#123;9a697216-6900-4a72-92e1-e3eefd98794f&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="决赛"><a href="#决赛" class="headerlink" title="决赛"></a>决赛</h1><h2 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getpq</span>(<span class="params">nbit</span>):</span><br><span class="line">    p = getPrime(nbit)</span><br><span class="line">    q = getPrime(nbit)</span><br><span class="line">    <span class="keyword">if</span> p &gt; q:</span><br><span class="line">        <span class="keyword">return</span> p, q</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> q, p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = getpq(<span class="number">512</span>)</span><br><span class="line">P = (p - q) &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">130</span>) - <span class="number">1</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">leak_p = p &gt;&gt; <span class="number">256</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>((<span class="number">1</span> + P * n), m, n ** <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;leak_p =&#x27;</span>, leak_p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 135133139540786818977969958456509467902948924003478556140490841984247464940261764739984274397650928404945721248284577232814352745333641188749824519153271662051302477973525156608141358709265683759057060630360909926255299541198485901065352661702656282587105799982740927802530997159098015074633017964344230291287</span></span><br><span class="line"><span class="comment"># leak_p = 115314121469787984258489158421056136177545051135641551928888818017665807264468</span></span><br><span class="line"><span class="comment"># c = 1836794759996264077871820946090708779709415760553736759453665641907562256633157424959089180650539327925671892742819931875681606982615287882656254828326465758462357812873839261469783652663796071814218493268788421243190729887313099383264588659922912876424206670310928514588754069909128149471326084547056385690037197908766053620702238356084124023146075698878494434053246157524775269473152458661801907641122308756667762880284617915774590075511686821816948174618196839335059944389423693187930672934293905608970421003536691336581450927887931599275461176935079227494931457562345640133982771901848553204154760760399724074615092290799119053032875792219794072963200108352944441876206386518960615891547166767499506114294860833404421893612197040731184031783165365621722947731966143226777081983415797778111715332055871302609049501876860012070502369090417942239749695034267695710324328867728296996779</span></span><br></pre></td></tr></table></figure>

<p>给出p的高256位，把<code>epsilon</code>改成0.01，爆破8位即可恢复p</p>
<p>根据$c \equiv (1+Pn)^m \mod n^3$</p>
<p>展开得到$c \equiv 1^m + mPn + \frac{m(m-1)}{2}P^2n^2 +…+(Pn)^m\mod n^3$<br>$\therefore c \equiv 1 + mPn + \frac{m(m-1)}{2}P^2n^2 \mod n^3$</p>
<p>$c-1 &#x3D; mPn + \frac{m(m-1)}{2}P^2n^2$，<strong>这个方程解不出来</strong></p>
<p>同除$n$得到</p>
<p>$\frac{c-1}{n} &#x3D; mP + \frac{m(m-1)}{2}P^2n$</p>
<p>解这个方程</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">n = </span><br><span class="line">leak_p = <span class="number">115314121469787984258489158421056136177545051135641551928888818017665807264468</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line">p_high = leak_p</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">8</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">     p4 = p_high&lt;&lt;<span class="number">8</span>    <span class="comment">#这里需要先爆破8位，使得知道264位以后再恢复p</span></span><br><span class="line">     p4 = p4 + i</span><br><span class="line">     kbits = pbits - p4.nbits()</span><br><span class="line">     p4 = p4 &lt;&lt; kbits</span><br><span class="line">     R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">     f = x + p4</span><br><span class="line">     x1 = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>, epsilon=<span class="number">0.01</span>)</span><br><span class="line">     <span class="keyword">if</span> x1:</span><br><span class="line">         p = p4 + <span class="built_in">int</span>(x1[<span class="number">0</span>])</span><br><span class="line">         <span class="keyword">if</span> <span class="built_in">int</span>(p).bit_length() == pbits:</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line">             q = n // p</span><br><span class="line">             <span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">             <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;over&#x27;</span>)</span><br><span class="line"></span><br><span class="line">P = (p - q) &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">130</span>) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">c1 = (c-<span class="number">1</span>) // n</span><br><span class="line">var(<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">f = m*P + (m*(m-<span class="number">1</span>)/<span class="number">2</span>) * P^<span class="number">2</span>*n - c1 </span><br><span class="line">ans = solve(f,m)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"><span class="comment">#m = 569500674440382718231575264852597803870681506457438686903594776739090860497616821068120838321533</span></span><br><span class="line"><span class="comment"># DASCTF&#123;365d0d2cda3a3836a19bf1f46760d875&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> flag, e1, e2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成素数</span></span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">ec1 = <span class="built_in">pow</span>(bytes_to_long(<span class="built_in">str</span>(e1).ljust(<span class="number">20</span>, <span class="string">&quot;D&quot;</span>).encode()), <span class="number">3</span>, p * q)</span><br><span class="line">ec2 = <span class="built_in">pow</span>(bytes_to_long(<span class="built_in">str</span>(e2).ljust(<span class="number">20</span>, <span class="string">&quot;A&quot;</span>).encode()), <span class="number">5</span>, p * q)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">n = p * q</span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ec1=&quot;</span>, ec1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1=&quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ec2=&quot;</span>, ec2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2=&quot;</span>, c2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n1= 27929259512873502442719286790227037320417984116570178470037376373267390909685621247157535458203218619293705428397911754453556082799420494496904478215709219317542924547049229150153308059698341011305505985823374280465467094476511869541135508518055946815227085548571701115773386101962695795789178321155174729047033298389886321980592410739667139376075568555729949442873964097042006391886635957242436522435588904492484342259494858627609438654632887244523845583473711604632109405043439047289868784236481926074763997559971182741918345193506253460323445846136663027639802131457594564405906763806426256107923417802076262573737</span></span><br><span class="line"><span class="comment"># ec1= 24979839185643431898760549059477070141596292955202172081572583839065034831779499992829742773873064296311713734486020739853343887094398935731264</span></span><br><span class="line"><span class="comment"># c1= 17695186679431856780362905635257355413310120106982055323913669124182832151093921194946365178919380690844190324897933591567360925332869903671651849060145290581360223200011298757871213149464298017718829480721410479504940393501845624196721013966839230696831321482946841011452400364600924503121451272593970649100410603943321149604376033957124800064565646929720179239631538966228020882733213221035707244692798307971636126058586394357032072695921642665492919186476321028415907982915011972040971875733852055633796811898421692604356476773910338982400925245494707729878821466569634334862311750349321720627252469986162120031838</span></span><br><span class="line"><span class="comment"># n2= 27929259512873502442719286790227037320417984116570178470037376373267390909685621247157535458203218619293705428397911754453556082799420494496904478215709219317542924547049229150153308059698341011305505985823374280465467094476511869541135508518055946815227085548571701115773386101962695795789178321155174729047033298389886321980592410739667139376075568555729949442873964097042006391886635957242436522435588904492484342259494858627609438654632887244523845583473711604632109405043439047289868784236481926074763997559971182741918345193506253460323445846136663027639802131457594564405906763806426256107923417802076262573737</span></span><br><span class="line"><span class="comment"># ec2= 2838620519239658396968146844964839207179863729944843241951228382052657801460586137213053314019699976475855578055607417923815486109050614096157077528657405905877896929808094661904905136761365045387901486261011216958309860644255996588189249</span></span><br><span class="line"><span class="comment"># c2= 10770781309274554738409447671578241895686779262243081931452089039730277591151694112684863740412412713684216227740930573490322958500198235497947657939304932868457999239593145330718657422535271157683896034543125292529800047408131765376686654378173684648427311300423776510153307756388404568013401217965931456538849277670384454454507752525534110389604969437991055504757081225690155489265359117617764571537216746554060783131168749700810806387918510612057149583061938836035963175555630655718716139689761210220525955656039741684390906935720406757364893793459339618913268943282961044530062475057887777134887741597041684698119</span></span><br></pre></td></tr></table></figure>

<p>低加密指数＋共模攻击</p>
<p>需要注意的是$e_1$，$e_2$公因数为3</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">ec1= </span><br><span class="line">ec2= </span><br><span class="line">c1= </span><br><span class="line">c2= </span><br><span class="line"></span><br><span class="line">me1 = gmpy2.iroot(ec1,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">me2 = gmpy2.iroot(ec2,<span class="number">5</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(me1))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(me2))</span><br><span class="line">e1 = <span class="number">34967</span></span><br><span class="line">e2 = <span class="number">65535</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(e1,e2)</span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line"><span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)) % n</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        m = gmpy2.iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)%n + k*n),t)</span><br><span class="line">        <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">             k += <span class="number">1</span></span><br><span class="line"><span class="comment"># DASCTF&#123;afd2eabdb2be11eda3a094085339ce84&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="逆向工程"><a href="#逆向工程" class="headerlink" title="逆向工程"></a>逆向工程</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">8eeb2dfb89f4b617abf9b6ac7bae3ee2777e85ec7e85a85a</span><br></pre></td></tr></table></figure>

<p>出题人非碳基生物</p>
<p>先转byte，再base64<strong>加密</strong></p>
<p>确认一下，你没有看错，就是<strong>base64加密</strong>，原来逆向工程指的是这个啊</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;8eeb2dfb89f4b617abf9b6ac7bae3ee2777e85ec7e85a85a&quot;</span></span><br><span class="line">c1 = long_to_bytes(<span class="built_in">int</span>(c,<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(c1)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;DASCTF&#123;&quot;</span> + base64.b64encode(c1) + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># DASCTF&#123;just+4n0ther+base64+4nd+hex+haha&#125;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>ECC</title>
    <url>/2023/07/25/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/ECC/</url>
    <content><![CDATA[<p>记录笔者学习椭圆曲线加密算法</p>
<span id="more"></span>



<h1 id="什么是椭圆曲线"><a href="#什么是椭圆曲线" class="headerlink" title="什么是椭圆曲线"></a>什么是椭圆曲线</h1><p>书本上椭圆曲线的定义相对复杂。</p>
<p>定义如下</p>
<p>一条椭圆曲线是在射影平面上满足威尔斯特拉斯方程（Weierstrass）所有点的集合。<br>$$<br>Y^2Z + a_1XYZ + a_3YZ^2 &#x3D; X^3+a_2X^2Z +a_4XZ^2+a_6Z^3<br>$$</p>
<p>我们讲简化版的Weierstrass方程：<br>$$<br>E_p:y^2 \equiv x^3 + ax + b \mod p<br>$$</p>
<p>其中，</p>
<p>(1)$ \Delta$ &#x3D; − 16 (4a^3 + 27 b) ≠ 0,用来保证曲线是光滑的，即曲线上的所有点都没有两个或者两个以上不同的切线</p>
<p>(2) a,b $\in$ K,K为E的基础域</p>
<p>(3) 点$O_{\infty}$是曲线唯一的无穷远点</p>
<h2 id="椭圆曲线上的加法"><a href="#椭圆曲线上的加法" class="headerlink" title="椭圆曲线上的加法"></a>椭圆曲线上的加法</h2><p>设$P&#x3D;(x_1,y_1),Q&#x3D;(x_2,y_2)\in E_p(a,b)$，则$P+Q&#x3D;(x_3,y_3)$</p>
<p>其中$x_3 \equiv k^2-x_1-x_2 \mod p$，$y_3 \equiv k(x_1-x_3)-y_1 \mod p$</p>
<p><img src="/../../images/ECC/1.png"></p>
<h1 id="什么是ECC？"><a href="#什么是ECC？" class="headerlink" title="什么是ECC？"></a>什么是ECC？</h1><p>ECC全称为椭圆曲线加密(EllipseCurve Cryptography)，是一种基于椭圆曲线数学的公钥密码。</p>
<p>这里给一个加密实例:</p>
<p><img src="/../../images/ECC/0.png"></p>
<p>其分为三个过程：</p>
<h2 id="1-密钥生成："><a href="#1-密钥生成：" class="headerlink" title="1.密钥生成："></a>1.密钥生成：</h2><p>$$<br>用户A先选择一条椭圆曲线E_p(a,b),然后选择上面一点G，称为基点。基点会公开,p也会公开<br>$$</p>
<p>$$<br>然后选择一个大整数作为私钥k,并计算公钥K &#x3D; k×G<br>$$</p>
<p>$$<br>这个乘法不是简单数值上相乘，而是需要通过加的方式实现<br>$$</p>
<p>$$<br>例如，nP &#x3D; P + (n-1))P<br>$$</p>
<p>$$<br>而加法也不是简单的加法，而是需要满足一些规则<br>$$</p>
<p>详情见：<a href="https://zhuanlan.zhihu.com/p/42629724">ECC椭圆曲线密码学的原理、公式推导、例子、Python实现和应用 - 知乎 (zhihu.com)</a><br>$$<br>公钥会公开，私钥不公开<br>$$</p>
<h2 id="2-加密"><a href="#2-加密" class="headerlink" title="2.加密"></a>2.加密</h2><p>$$<br>假设用户B把需要传送的信息编码为椭圆曲线E_p上的一点M<br>$$</p>
<p>$$<br>然后计算点C_1 &#x3D; M + rK,C_2 &#x3D; rG<br>$$</p>
<p>$$<br>再把C_1,C_2传给用户A<br>$$</p>
<h2 id="3-解密"><a href="#3-解密" class="headerlink" title="3.解密"></a>3.解密</h2><p>$$<br>用户A在接受到C_1,C_2后计算用私钥k计算C_1-kC_2<br>$$</p>
<p>$$<br>\because C_1-kC_2 &#x3D; M+rK-k(rG)，把K &#x3D; kG带入得：<br>$$</p>
<p>$$<br>C_1-kC_2 &#x3D; M+rkG - krG &#x3D; M<br>$$</p>
<p>$$<br>这样就完成了解密<br>$$</p>
<h1 id="sagemath实现"><a href="#sagemath实现" class="headerlink" title="sagemath实现"></a>sagemath实现</h1><h2 id="用上的函数"><a href="#用上的函数" class="headerlink" title="用上的函数"></a>用上的函数</h2><ol>
<li><p><code>E = EllipticCurve(GF(p),[a,b]) </code> <strong>:建立有限域p上的椭圆曲线E，参数为</strong><code>a</code>,<code>b</code><strong>即椭圆曲线方程为：</strong><br>$$<br>y^2 &#x3D; x^3 + ax + b<br>$$</p>
</li>
<li><p><code>E.random_point()</code><strong>:在椭圆曲线E上随机取一点</strong></p>
</li>
<li><p><code>E.set_order()</code><strong>:设置椭圆曲线的阶</strong></p>
</li>
<li><p><code>E.point((x,y))</code><strong>:创建一个椭圆曲线上的点对象，该点对象的坐标为</strong><code>(x,y)</code></p>
</li>
<li><p><strong>求解私钥，自动选择bsgs或Pohlig Hellman算法</strong><br><code>discrete_log(K,G,operation=&#39;+&#39;)</code></p>
<p><strong>等价于</strong><code>G.discrete_log(K)</code></p>
<p>其含义是：<br>$$<br>返回一个整数x，使其满足<br>$$</p>
<p>$$<br>K &#x3D; xG<br>$$</p>
</li>
<li><p><code>E.order()</code>：计算椭圆曲线上点的阶。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(factor(E.order()))</span><br><span class="line"><span class="comment"># 2 * 3^3 * 5 * 7 * 212117 * 302426983 * 10362951863095936421891634612647340060175499</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(*factor(E.order()))</span><br><span class="line"><span class="comment">#(2, 1) (3, 3) (5, 1) (7, 1) (212117, 1) (302426983, 1) (10362951863095936421891634612647340060175499, 1)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>用Pollard rho算法求解私钥</strong><br><code>discrete_log_rho(K,G,operation=&#39;+&#39;)</code></p>
</li>
<li><p><strong>用Pollard Lambda算法求解私钥，能够确定所求值在某一小范围时效率较高</strong><br><code>discrete_log_lambda(K,G,bound,operation=&#39;+&#39;)</code></p>
</li>
</ol>
<p>这里其实我有点疑惑<br>$$<br>公钥K &#x3D; kG<br>$$</p>
<p>$$<br>为什么说它是求解离散对数的问题<br>$$</p>
<h2 id="加密实例"><a href="#加密实例" class="headerlink" title="加密实例:"></a>加密实例:</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">加密</span><br><span class="line">椭圆曲线选取时，模数p应是一个大质数</span><br><span class="line">常用的有几个公开的椭圆曲线，如Secp256k1、Secp256r1等</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p = 115792089210356248762697446949407573530086143415290314195533631308867097853951</span><br><span class="line">a = 115792089210356248762697446949407573530086143415290314195533631308867097853948</span><br><span class="line">b = 41058363725152142129326129780047268409114441015993725554835256314039467401291</span><br><span class="line">E = EllipticCurve(GF(p),[a,b]) #建立椭圆曲线E</span><br><span class="line">G = E(101981543389703054444906888236965100227902100585263327233246492901054535785571,105947302391877180514060433855403037184838385483621546199124860815209826713886) #选择一点作为基点</span><br><span class="line">n = G.order() #G的阶数</span><br><span class="line">k = 78772200542717449282831156601030024198219944170436309154595818823706214492400</span><br><span class="line">K = k*G</span><br><span class="line">r = 3546765</span><br><span class="line">m = E(80764032034929976879602863302323059647882062252124869895215418422992624743795,4964654783828069942602279691168356721024126126864424301508238062949726916347) #取E上一点m作为明文</span><br><span class="line">c1 = m+r*K</span><br><span class="line">c2 = r*G</span><br><span class="line">print(c1)</span><br><span class="line">print(c2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="解密实例"><a href="#解密实例" class="headerlink" title="解密实例:"></a>解密实例:</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;解密&#x27;&#x27;&#x27;</span><br><span class="line">p = 115792089210356248762697446949407573530086143415290314195533631308867097853951</span><br><span class="line">a = 115792089210356248762697446949407573530086143415290314195533631308867097853948</span><br><span class="line">b = 41058363725152142129326129780047268409114441015993725554835256314039467401291</span><br><span class="line">k = 78772200542717449282831156601030024198219944170436309154595818823706214492400</span><br><span class="line">E = EllipticCurve(GF(p),[a,b]) #建立椭圆曲线E</span><br><span class="line">c1 = E(55527726590533087179712343802771216661752045890626636388680526348340802301667,99976146729305231192119179111453136971828647307627310904093286590128902629941)</span><br><span class="line">c2 = E(85460365972589567444123006081329559170090723413178386022601904195400422637884,58249081362527056631776731740177334121295518073095154119886890634279528757192)</span><br><span class="line">m = c1-k*c2</span><br><span class="line">print(m)</span><br></pre></td></tr></table></figure>

<h2 id="用Crypto库生成ECC密钥"><a href="#用Crypto库生成ECC密钥" class="headerlink" title="用Crypto库生成ECC密钥"></a>用Crypto库生成ECC密钥</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.PublicKey import ECC</span><br><span class="line"></span><br><span class="line">#生成ECC密钥</span><br><span class="line">key = ECC.generate(curve=&#x27;NIST P-256&#x27;) #使用椭圆曲线NIST P-256</span><br><span class="line"></span><br><span class="line">#输出密钥（包括私钥k，基点G）</span><br><span class="line">print(key)</span><br><span class="line"></span><br><span class="line">#公钥（point_x，point_y是基点G的坐标）</span><br><span class="line">print(key.public_key())</span><br><span class="line"></span><br><span class="line">#椭圆曲线</span><br><span class="line">print(key.curve)</span><br><span class="line"></span><br><span class="line">#私钥k</span><br><span class="line">print(key.d)</span><br><span class="line"></span><br><span class="line">#导出为pem密钥文件</span><br><span class="line">print(key.export_key(format=&#x27;PEM&#x27;))</span><br><span class="line"></span><br><span class="line">#导入密钥文件</span><br><span class="line">key = ECC.import_key(f.read())</span><br></pre></td></tr></table></figure>

<h2 id="几种公开椭圆曲线的参数"><a href="#几种公开椭圆曲线的参数" class="headerlink" title="几种公开椭圆曲线的参数"></a>几种公开椭圆曲线的参数</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#NIST P-256（Secp256r1）</span><br><span class="line">#p = 2^224(2^32 − 1) + 2^192 + 2^96 − 1</span><br><span class="line">p = 115792089210356248762697446949407573530086143415290314195533631308867097853951</span><br><span class="line">a = 115792089210356248762697446949407573530086143415290314195533631308867097853948</span><br><span class="line">b = 41058363725152142129326129780047268409114441015993725554835256314039467401291</span><br><span class="line"></span><br><span class="line">#Secp256k1（比特币使用）</span><br><span class="line">#p = 2^256 − 2^32 − 2^9 − 2^8 − 2^7 − 2^6 − 2^4 − 1 = 2^256 – 2^32 – 977 </span><br><span class="line">p = 115792089237316195423570985008687907853269984665640564039457584007908834671663</span><br><span class="line">a = 0</span><br><span class="line">b = 7</span><br><span class="line"></span><br><span class="line">#NIST P-384</span><br><span class="line">#p = 2^384 – 2^128 – 2^96 + 2^32 – 1</span><br><span class="line">p = 39402006196394479212279040100143613805079739270465446667948293404245721771496870329047266088258938001861606973112319</span><br><span class="line">a = -3</span><br><span class="line">b = 27580193559959705877849011840389048093056905856361568521428707301988689241309860865136260764883745107765439761230575</span><br><span class="line"></span><br><span class="line">#NIST P-521</span><br><span class="line">p = 6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span><br><span class="line">a = -3</span><br><span class="line">b = 1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span><br></pre></td></tr></table></figure>

<h1 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h1><h2 id="题目给的不是生成元"><a href="#题目给的不是生成元" class="headerlink" title="题目给的不是生成元"></a>题目给的不是生成元</h2><p>处理方法是用阶来当作生成元</p>
<p>例题是广东强网杯 2021 团队组——DLP</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">assert(flag[:5] == b&quot;flag&#123;&quot; and flag[-1:] == b&quot;&#125;&quot;)</span><br><span class="line"></span><br><span class="line">flag = flag[5:-1]</span><br><span class="line"></span><br><span class="line">d1 = bytes_to_long(flag[:len(flag)//2])</span><br><span class="line">d2 = bytes_to_long(flag[len(flag)//2:])</span><br><span class="line"></span><br><span class="line">N1 = 27544759469094453505371358768052861416297003882211878831861112512567899543941</span><br><span class="line">A1 = 4208715803791813173086894172778966025419787767340027559010619240548499823390</span><br><span class="line">B1 = 11846440123913040489420209031751160809904311707943252241515965930654415480691</span><br><span class="line">P1x = 479750084250968709343887919962436485997147832319843477221083468203689368148</span><br><span class="line">P1y = 15452861783577624143044213767588871736433639621547613407582902947429567101675</span><br><span class="line"></span><br><span class="line">P1 = (P1x,P1y)</span><br><span class="line">E1 = EllipticCurve(Zmod(N1), [0, 0, 0, A1, B1])</span><br><span class="line">P1 = E1(P1)</span><br><span class="line">Q1 = d1 * P1</span><br><span class="line"></span><br><span class="line">N2 = 6471339743593595797696002766822660599108196938080465998531085409467</span><br><span class="line">A2 = 3199218821393204771660095172457569312269694438403110131957204042314</span><br><span class="line">B2 = 762889472027318213897694878260359911054972690369935049954326689904</span><br><span class="line">P2x = 2557373437970770011124755960432555084678930336188254243278984381842</span><br><span class="line">P2y = 4442763096366920105760404533052204677305995021662082361185473321644</span><br><span class="line"></span><br><span class="line">P2 = (P2x,P2y)</span><br><span class="line">E2 = EllipticCurve(Zmod(N2), [0, 0, 0, A2, B2])</span><br><span class="line">P2 = E2(P2)</span><br><span class="line">Q2 = d2 * P2</span><br><span class="line"></span><br><span class="line">print(Q1)</span><br><span class="line">print(Q2)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">(14736970297054248276364510675718632926198693034158620007675880103924809577805 : 3447209262654420855289144268810543114387612255490962015335062266658385100211 : 1)</span><br><span class="line">(4834036103940457959470026215023033401071737087504569417466448644066 : 5511016821581393405975510064568222454318072088628361854656950557373 : 1)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>首先对于$\mod n$，且$n&#x3D;pq$的椭圆曲线，可以拆成$\mod p$和$\mod q$，分别求离散对数，再用中国剩余定理。</p>
<p>不过需要注意的是，<strong>这题选取的P都不是生成元</strong>，所以用中国剩余定理组合起来的时候，需要用$P$的阶，而不是椭圆曲线的阶。</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">N1 = <span class="number">27544759469094453505371358768052861416297003882211878831861112512567899543941</span></span><br><span class="line">A1 = <span class="number">4208715803791813173086894172778966025419787767340027559010619240548499823390</span></span><br><span class="line">B1 = <span class="number">11846440123913040489420209031751160809904311707943252241515965930654415480691</span></span><br><span class="line">P1x = <span class="number">479750084250968709343887919962436485997147832319843477221083468203689368148</span></span><br><span class="line">P1y = <span class="number">15452861783577624143044213767588871736433639621547613407582902947429567101675</span></span><br><span class="line"></span><br><span class="line">Q1x = <span class="number">14736970297054248276364510675718632926198693034158620007675880103924809577805</span> </span><br><span class="line">Q1y = <span class="number">3447209262654420855289144268810543114387612255490962015335062266658385100211</span> </span><br><span class="line"></span><br><span class="line">p1 = <span class="number">92636417177965240871815246762704348071</span></span><br><span class="line">q1 = N1 // p1</span><br><span class="line"></span><br><span class="line">P1 = (P1x, P1y)</span><br><span class="line">Q1 = (Q1x, Q1y)</span><br><span class="line">E1p = EllipticCurve(Zmod(p1), [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, A1, B1])</span><br><span class="line">n1p = E1p.order()</span><br><span class="line">P1p = E1p(P1)</span><br><span class="line">Q1p = E1p(Q1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pohlig Hellman</span></span><br><span class="line">d1p = P1p.discrete_log(Q1p)</span><br><span class="line"></span><br><span class="line">E1q = EllipticCurve(Zmod(q1), [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, A1, B1])</span><br><span class="line">n1q = E1q.order()</span><br><span class="line">P1q = E1q(P1)</span><br><span class="line">Q1q = E1q(Q1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Smart</span></span><br><span class="line">d1q = SmartAttack(P1q, Q1q, q1)</span><br><span class="line"></span><br><span class="line">d1 = crt([d1p, d1q], [P1p.order(), P1q.order()])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d1=&quot;</span>,d1)</span><br><span class="line"></span><br><span class="line">N2 = <span class="number">6471339743593595797696002766822660599108196938080465998531085409467</span></span><br><span class="line">A2 = <span class="number">3199218821393204771660095172457569312269694438403110131957204042314</span></span><br><span class="line">B2 = <span class="number">762889472027318213897694878260359911054972690369935049954326689904</span></span><br><span class="line">P2x = <span class="number">2557373437970770011124755960432555084678930336188254243278984381842</span></span><br><span class="line">P2y = <span class="number">4442763096366920105760404533052204677305995021662082361185473321644</span></span><br><span class="line">Q2x = <span class="number">4834036103940457959470026215023033401071737087504569417466448644066</span> </span><br><span class="line">Q2y = <span class="number">5511016821581393405975510064568222454318072088628361854656950557373</span> </span><br><span class="line"></span><br><span class="line">p2 = <span class="number">69857405335111415530599248077</span></span><br><span class="line">q2 = <span class="number">92636417177965240871815246762704348071</span></span><br><span class="line"></span><br><span class="line">P2 = (P2x,P2y)</span><br><span class="line">Q2 = (Q2x,Q2y)</span><br><span class="line">E2p = EllipticCurve(Zmod(p2), [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, A2, B2])</span><br><span class="line">n2p = E2p.order()</span><br><span class="line">P2p = E2p(P2)</span><br><span class="line">Q2p = E2p(Q2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pohlig Hellman</span></span><br><span class="line">d2p = P2p.discrete_log(Q2p)</span><br><span class="line"></span><br><span class="line">E2q = EllipticCurve(Zmod(q2), [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, A2, B2])</span><br><span class="line">n2q = E2q.order()</span><br><span class="line">P2q = E2q(P2)</span><br><span class="line">Q2q = E2q(Q2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pohlig Hellman</span></span><br><span class="line">d2q = P2q.discrete_log(Q2q)</span><br><span class="line"></span><br><span class="line">d2 = crt([d2p, d2q], [P2p.order(), P2q.order()])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d2=&quot;</span>,d2)</span><br><span class="line"></span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">int</span>(d1))</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(d2))</span><br><span class="line"><span class="built_in">print</span>(flag1+flag2)</span><br></pre></td></tr></table></figure>



<h2 id="2022巅峰极客——point-power"><a href="#2022巅峰极客——point-power" class="headerlink" title="2022巅峰极客——point-power"></a>2022巅峰极客——point-power</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">42</span></span><br><span class="line">p=getPrime(<span class="number">600</span>)</span><br><span class="line">a=bytes_to_long(flag)</span><br><span class="line">b=randrange(<span class="number">2</span>,p-<span class="number">1</span>)</span><br><span class="line">E=EllipticCurve(GF(p),[a,b])</span><br><span class="line">G=E.random_element()</span><br><span class="line"></span><br><span class="line">x1,y1,_=G</span><br><span class="line">G=<span class="number">2</span>*G</span><br><span class="line">x2,y2,_=G</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x1 = <span class="subst">&#123;x1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x2 = <span class="subst">&#123;x2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 3660057339895840489386133099442699911046732928957592389841707990239494988668972633881890332850396642253648817739844121432749159024098337289268574006090698602263783482687565322890623</span></span><br><span class="line"><span class="string">b = 1515231655397326550194746635613443276271228200149130229724363232017068662367771757907474495021697632810542820366098372870766155947779533427141016826904160784021630942035315049381147</span></span><br><span class="line"><span class="string">x1 = 2157670468952062330453195482606118809236127827872293893648601570707609637499023981195730090033076249237356704253400517059411180554022652893726903447990650895219926989469443306189740</span></span><br><span class="line"><span class="string">x2 = 1991876990606943816638852425122739062927245775025232944491452039354255349384430261036766896859410449488871048192397922549895939187691682643754284061389348874990018070631239671589727</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>根据椭圆曲线的加法</p>
<p>易知$x_2 \equiv k^2-2x_1 \mod p$，$k &#x3D; \frac{3x_1^2+a}{2y_1}$，又因为$y_1^2 \equiv x^3 + ax+b \mod p$</p>
<p>于是能得到$x_2 \equiv \frac{9x_1^4+6x_1^2a+a}{4(x_1^3+ax_1+b)}-2x_1 \mod p$</p>
<p>稍微变化一下，令$tmp &#x3D; 4(x_1^3+ax_1+b)$</p>
<p>解这个方程即可$9x_1^4+6x_1^2a+a-(2x_1+x_2)×tmp \equiv 0 \mod p$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sagemath 9.3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">b = </span><br><span class="line">x1 = </span><br><span class="line">x2 = </span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = PolynomialRing(Zmod(p))</span><br><span class="line"></span><br><span class="line">tmp = <span class="number">4</span>*(x1^<span class="number">3</span> + a*x1 + b)</span><br><span class="line"></span><br><span class="line">f = <span class="number">9</span>*x1^<span class="number">4</span> + <span class="number">6</span>*x1^<span class="number">2</span>*a + a^<span class="number">2</span> - (<span class="number">2</span>*x1+x2)*tmp</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.roots()</span><br><span class="line"><span class="comment"># print(roots)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> roots:</span><br><span class="line">    m = i[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>





<h2 id="watevrCTF-2019-ECC-RSA"><a href="#watevrCTF-2019-ECC-RSA" class="headerlink" title="[watevrCTF 2019]ECC-RSA"></a>[watevrCTF 2019]ECC-RSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastecdsa.curve <span class="keyword">import</span> P521 <span class="keyword">as</span> Curve</span><br><span class="line"><span class="keyword">from</span> fastecdsa.point <span class="keyword">import</span> Point</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, isPrime</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_rsa_primes</span>(<span class="params">G</span>):</span><br><span class="line">	urand = bytes_to_long(urandom(<span class="number">521</span>//<span class="number">8</span>))</span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		s = getrandbits(<span class="number">521</span>) ^ urand</span><br><span class="line"></span><br><span class="line">		Q = s*G</span><br><span class="line">		<span class="keyword">if</span> isPrime(Q.x) <span class="keyword">and</span> isPrime(Q.y):</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;ECC Private key:&quot;</span>, <span class="built_in">hex</span>(s))</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;RSA primes:&quot;</span>, <span class="built_in">hex</span>(Q.x), <span class="built_in">hex</span>(Q.y))</span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&quot;Modulo:&quot;</span>, <span class="built_in">hex</span>(Q.x * Q.y))</span><br><span class="line">			<span class="keyword">return</span> (Q.x, Q.y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">int</span>.from_bytes(<span class="built_in">input</span>(), byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">ecc_p = Curve.p</span><br><span class="line">a = Curve.a</span><br><span class="line">b = Curve.b</span><br><span class="line"></span><br><span class="line">Gx = Curve.gx</span><br><span class="line">Gy = Curve.gy</span><br><span class="line">G = Point(Gx, Gy, curve=Curve)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">p, q = gen_rsa_primes(G)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_out = <span class="built_in">open</span>(<span class="string">&quot;downloads/ecc-rsa.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;ECC Curve Prime: &quot;</span> + <span class="built_in">hex</span>(ecc_p) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Curve a: &quot;</span> + <span class="built_in">hex</span>(a) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Curve b: &quot;</span> + <span class="built_in">hex</span>(b) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Gx: &quot;</span> + <span class="built_in">hex</span>(Gx) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Gy: &quot;</span> + <span class="built_in">hex</span>(Gy) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;e: &quot;</span> + <span class="built_in">hex</span>(e) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;p * q: &quot;</span> + <span class="built_in">hex</span>(n) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line">file_out.write(<span class="string">&quot;ciphertext: &quot;</span> + <span class="built_in">hex</span>(c) + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>已知椭圆曲线参数$p,a,b$即椭圆曲线方程为$y^2 \equiv x^3 + ax + b \mod p$</p>
<p>$\therefore q^2 \equiv p^3 + ap + b \mod p$ 同乘$p^2$得$n^2 \equiv p^5 + ap^3 + bp^2 \mod p$</p>
<p>解方程求$p$</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">ecc_p = <span class="number">0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span></span><br><span class="line">a = -<span class="number">3</span></span><br><span class="line">b = <span class="number">0x51953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00</span></span><br><span class="line">Gx = <span class="number">0xc6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66</span></span><br><span class="line">Gy = <span class="number">0x11839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">n = <span class="number">0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28f</span></span><br><span class="line">c = <span class="number">0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9e</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(ecc_p))</span><br><span class="line"></span><br><span class="line">f = x^<span class="number">5</span> + a*x^<span class="number">3</span> + b*x^<span class="number">2</span> - n^<span class="number">2</span></span><br><span class="line"></span><br><span class="line">p = f.roots()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    t = gcd(Integer(i[<span class="number">0</span>]),n)</span><br><span class="line">    <span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">        p = t</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>需要注意的是，一般我们在sagemath中赋值的变量都是<code>sage.rings.integer.Integer</code>的数据类型</p>
<p>而解出来的$p$是<code>sage.rings.finite_rings.integer_mod.IntegerMod_gmp</code></p>
<p>两个数据类型做gcd运算会获得1，所以我们需要先把$p$转成<code>int</code>或者<code>Integer</code></p>
<h2 id="第五空间-2021-ecc"><a href="#第五空间-2021-ecc" class="headerlink" title="[第五空间 2021]ecc"></a>[第五空间 2021]ecc</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">print &#x27;Try to solve the 3 ECC&#x27;</span><br><span class="line"></span><br><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">assert(flag[:5]==&#x27;flag&#123;&#x27;)</span><br><span class="line">flag = flag[5:-1]</span><br><span class="line">num1 = bytes_to_long(flag[:7])</span><br><span class="line">num2 = bytes_to_long(flag[7:14])</span><br><span class="line">num3 = bytes_to_long(flag[14:])</span><br><span class="line"></span><br><span class="line">def ECC1(num):</span><br><span class="line">	p = 146808027458411567</span><br><span class="line">	A = 46056180</span><br><span class="line">	B = 2316783294673</span><br><span class="line">	E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">	P = E.random_point() </span><br><span class="line">	Q = num*P</span><br><span class="line">	print E</span><br><span class="line">	print &#x27;P:&#x27;,P</span><br><span class="line">	print &#x27;Q:&#x27;,Q</span><br><span class="line"></span><br><span class="line">def ECC2(num):</span><br><span class="line">	p = 1256438680873352167711863680253958927079458741172412327087203</span><br><span class="line">	#import random</span><br><span class="line">	#A = random.randrange(389718923781273978681723687163812)</span><br><span class="line">	#B = random.randrange(816378675675716537126387613131232121431231)</span><br><span class="line">	A = 377999945830334462584412960368612</span><br><span class="line">	B = 604811648267717218711247799143415167229480</span><br><span class="line">	E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">	P = E.random_point() </span><br><span class="line">	Q = num*P</span><br><span class="line">	print E</span><br><span class="line">	print &#x27;P:&#x27;,P</span><br><span class="line">	print &#x27;Q:&#x27;,Q</span><br><span class="line">	factors, exponents = zip(*factor(E.order()))</span><br><span class="line">	primes = [factors[i] ^ exponents[i] for i in range(len(factors))][:-1]</span><br><span class="line">	print primes</span><br><span class="line">	dlogs = []</span><br><span class="line">	for fac in primes:</span><br><span class="line">		t = int(int(P.order()) / int(fac))</span><br><span class="line">		dlog = discrete_log(t*Q,t*P,operation=&quot;+&quot;)</span><br><span class="line">		dlogs += [dlog]</span><br><span class="line">		print(&quot;factor: &quot;+str(fac)+&quot;, Discrete Log: &quot;+str(dlog)) #calculates discrete logarithm for each prime order</span><br><span class="line">	print num</span><br><span class="line">	print crt(dlogs,primes)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def ECC3(num):</span><br><span class="line">	p = 0xd3ceec4c84af8fa5f3e9af91e00cabacaaaecec3da619400e29a25abececfdc9bd678e2708a58acb1bd15370acc39c596807dab6229dca11fd3a217510258d1b</span><br><span class="line">	A = 0x95fc77eb3119991a0022168c83eee7178e6c3eeaf75e0fdf1853b8ef4cb97a9058c271ee193b8b27938a07052f918c35eccb027b0b168b4e2566b247b91dc07</span><br><span class="line">	B = 0x926b0e42376d112ca971569a8d3b3eda12172dfb4929aea13da7f10fb81f3b96bf1e28b4a396a1fcf38d80b463582e45d06a548e0dc0d567fc668bd119c346b2</span><br><span class="line">	E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">	P = E.random_point() </span><br><span class="line">	Q = num*P</span><br><span class="line">	print E</span><br><span class="line">	print &#x27;P:&#x27;,P</span><br><span class="line">	print &#x27;Q:&#x27;,Q</span><br><span class="line"></span><br><span class="line">ECC1(num1)</span><br><span class="line">print &#x27;==============&#x27;</span><br><span class="line">ECC2(num2)</span><br><span class="line">print &#x27;==============&#x27;</span><br><span class="line">ECC3(num3)</span><br></pre></td></tr></table></figure>

<h3 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h3><p>第一部分就是基础解$Q &#x3D; kP$这个式子的k</p>
<h3 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h3><p>第二部分是利用中国剩余定理解离散对数问题，代码已经在附件里面了，需要把<code>/</code>改成<code>//</code>，不然跑不出来</p>
<h3 id="part3"><a href="#part3" class="headerlink" title="part3"></a>part3</h3><p>第三部分考察模数p和曲线的阶相等，用SmartAttack</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="comment">#part1</span></span><br><span class="line">p1 = <span class="number">146808027458411567</span></span><br><span class="line">A1 = <span class="number">46056180</span></span><br><span class="line">B1 = <span class="number">2316783294673</span></span><br><span class="line">E1 = EllipticCurve(GF(p1),[A1,B1])</span><br><span class="line">P1 = E1(<span class="number">119851377153561800</span>,<span class="number">50725039619018388</span>)</span><br><span class="line">Q1 = E1(<span class="number">22306318711744209</span>,<span class="number">111808951703508717</span>)</span><br><span class="line"></span><br><span class="line">m1 = P1.discrete_log(Q1)        <span class="comment"># flag1 = discrete_log(Q1,P1,operation=&#x27;+&#x27;)</span></span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">int</span>(m1))</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part2</span></span><br><span class="line">p2 = <span class="number">1256438680873352167711863680253958927079458741172412327087203</span></span><br><span class="line">A2 = <span class="number">377999945830334462584412960368612</span></span><br><span class="line">B2 = <span class="number">604811648267717218711247799143415167229480</span></span><br><span class="line">E2 = EllipticCurve(GF(p2),[A2,B2])</span><br><span class="line">P2 = E2(<span class="number">550637390822762334900354060650869238926454800955557622817950</span>,<span class="number">700751312208881169841494663466728684704743091638451132521079</span>)</span><br><span class="line">Q2 = E2(<span class="number">1152079922659509908913443110457333432642379532625238229329830</span>,<span class="number">819973744403969324837069647827669815566569448190043645544592</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">P,Q,E</span>):</span><br><span class="line">    factors, exponents = <span class="built_in">zip</span>(*factor(E.order()))</span><br><span class="line">    primes = [factors[i] ^ exponents[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(factors))][:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(primes)</span><br><span class="line">    dlogs = []</span><br><span class="line">    <span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">        t = <span class="built_in">int</span>(<span class="built_in">int</span>(P.order()) // <span class="built_in">int</span>(fac))</span><br><span class="line">        dlog = discrete_log(t*Q,t*P,operation=<span class="string">&quot;+&quot;</span>)</span><br><span class="line">        dlogs += [dlog]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;factor: &quot;</span>+<span class="built_in">str</span>(fac)+<span class="string">&quot;, Discrete Log: &quot;</span>+<span class="built_in">str</span>(dlog)) <span class="comment">#calculates discrete logarithm for each prime order</span></span><br><span class="line">    m = CRT_list(dlogs,primes)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">m2 = solve(P2,Q2,E2)</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(m2))</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br><span class="line"></span><br><span class="line"><span class="comment">#part3</span></span><br><span class="line">p3 = <span class="number">0xd3ceec4c84af8fa5f3e9af91e00cabacaaaecec3da619400e29a25abececfdc9bd678e2708a58acb1bd15370acc39c596807dab6229dca11fd3a217510258d1b</span></span><br><span class="line">A3 = <span class="number">0x95fc77eb3119991a0022168c83eee7178e6c3eeaf75e0fdf1853b8ef4cb97a9058c271ee193b8b27938a07052f918c35eccb027b0b168b4e2566b247b91dc07</span></span><br><span class="line">B3 = <span class="number">0x926b0e42376d112ca971569a8d3b3eda12172dfb4929aea13da7f10fb81f3b96bf1e28b4a396a1fcf38d80b463582e45d06a548e0dc0d567fc668bd119c346b2</span></span><br><span class="line">E3 = EllipticCurve(GF(p3),[A3,B3])</span><br><span class="line">P3 = E3(<span class="number">10121571443191913072732572831490534620810835306892634555532657696255506898960536955568544782337611042739846570602400973952350443413585203452769205144937861</span> ,<span class="number">8425218582467077730409837945083571362745388328043930511865174847436798990397124804357982565055918658197831123970115905304092351218676660067914209199149610</span> )</span><br><span class="line">Q3 = E3(<span class="number">964864009142237137341389653756165935542611153576641370639729304570649749004810980672415306977194223081235401355646820597987366171212332294914445469010927</span> ,<span class="number">5162185780511783278449342529269970453734248460302908455520831950343371147566682530583160574217543701164101226640565768860451999819324219344705421407572537</span> )</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(p3 == E3.order())</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">m3 = SmartAttack(P3,Q3,p3)</span><br><span class="line">flag3 = long_to_bytes(<span class="built_in">int</span>(m3))</span><br><span class="line"><span class="built_in">print</span>(flag3)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span> + flag1 + flag2 + flag3 + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h2 id="领航杯江苏省赛-2021-ECC"><a href="#领航杯江苏省赛-2021-ECC" class="headerlink" title="[领航杯江苏省赛 2021]ECC"></a>[领航杯江苏省赛 2021]ECC</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">64464091191308356774703439660771627086045800299627641179047457478059588557461</span></span><br><span class="line">a = <span class="number">31926335967105564755113987930261069322507794703287741857397622356704769886356</span></span><br><span class="line">b = <span class="number">34835808070187351680507689900273321615070127680320357724483770400791707112940</span></span><br><span class="line">Gx = <span class="number">2053202552422630348010474635096983783565667661786369125783579647572276572403</span></span><br><span class="line">Gy = <span class="number">51320753844844801021362329076409450910659564359017581255542897537756778371539</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">&quot;CnHongKe&#123;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag[-<span class="number">1</span>] == <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">k = bytes_to_long(flag[<span class="number">9</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">assert</span> k &lt; <span class="number">32000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line">Zp = Zmod(P)</span><br><span class="line">EC = EllipticCurve(Zp, [a, b])</span><br><span class="line">G = EC(Gx, Gy)</span><br><span class="line">K = k * G</span><br><span class="line"><span class="built_in">print</span> K</span><br><span class="line"></span><br><span class="line"><span class="comment"># (31981799071949968743482831587417174146463993877255771340814476669214408840460 : 15144025062588325012239455117890516531350002058200271280110877844265896081387 : 1)</span></span><br></pre></td></tr></table></figure>

<p>曲线的阶能分解</p>
<p>用CRT解出一个特解，发现只有$74bit$，而正确的$k$不超过95bit</p>
<p>爆破一下即可</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">64464091191308356774703439660771627086045800299627641179047457478059588557461</span></span><br><span class="line">a = <span class="number">31926335967105564755113987930261069322507794703287741857397622356704769886356</span></span><br><span class="line">b = <span class="number">34835808070187351680507689900273321615070127680320357724483770400791707112940</span></span><br><span class="line">Gx = <span class="number">2053202552422630348010474635096983783565667661786369125783579647572276572403</span></span><br><span class="line">Gy = <span class="number">51320753844844801021362329076409450910659564359017581255542897537756778371539</span></span><br><span class="line"></span><br><span class="line">Zp = Zmod(p)</span><br><span class="line">EC = EllipticCurve(Zp, [a, b])</span><br><span class="line">G = EC(Gx, Gy)</span><br><span class="line"></span><br><span class="line">K = EC(<span class="number">31981799071949968743482831587417174146463993877255771340814476669214408840460</span>,<span class="number">15144025062588325012239455117890516531350002058200271280110877844265896081387</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>(<span class="params">P,Q,E</span>):</span><br><span class="line">    factors, exponents = <span class="built_in">zip</span>(*factor(E.order()))</span><br><span class="line">    primes = [factors[i] ^ exponents[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(factors))][:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(primes)</span><br><span class="line">    dlogs = []</span><br><span class="line">    <span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">        t = <span class="built_in">int</span>(<span class="built_in">int</span>(P.order()) // <span class="built_in">int</span>(fac))</span><br><span class="line">        dlog = discrete_log(t*Q,t*P,operation=<span class="string">&quot;+&quot;</span>)</span><br><span class="line">        dlogs += [dlog]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;factor: &quot;</span>+<span class="built_in">str</span>(fac)+<span class="string">&quot;, Discrete Log: &quot;</span>+<span class="built_in">str</span>(dlog)) <span class="comment">#calculates discrete logarithm for each prime order</span></span><br><span class="line">    m = CRT_list(dlogs,primes)</span><br><span class="line">    n = prod(primes)</span><br><span class="line">    <span class="keyword">return</span> m,n</span><br><span class="line"></span><br><span class="line">d,n = solve(G,K,EC)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(d).bit_length())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">2</span>^<span class="number">21</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    flag = d + k*n</span><br><span class="line">    P = flag * G</span><br><span class="line">    <span class="keyword">if</span> P == K:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">b&quot;NSSCTF&#123;&quot;</span> + long_to_bytes(flag) + <span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h2 id="HGAME-2023-week4-ECRSA"><a href="#HGAME-2023-week4-ECRSA" class="headerlink" title="[HGAME 2023 week4]ECRSA"></a>[HGAME 2023 week4]ECRSA</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.all_cmdline <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">Nbits = <span class="number">512</span></span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_pubkey</span>(<span class="params">Nbits</span>):</span><br><span class="line">    p = getPrime(Nbits // <span class="number">2</span>)</span><br><span class="line">    q = getPrime(Nbits // <span class="number">2</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomInteger(Nbits // <span class="number">2</span>)</span><br><span class="line">        b = getRandomInteger(Nbits // <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> gcd(<span class="number">4</span>*a**<span class="number">3</span> + <span class="number">27</span>*b**<span class="number">2</span>, n) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">    e = getPrime(<span class="number">64</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> n, E, e</span><br><span class="line"></span><br><span class="line">n, E, e = gen_pubkey(Nbits)</span><br><span class="line">pt = E.lift_x(Integer(x))</span><br><span class="line">ct = pt * e</span><br><span class="line">f.write(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>\na = <span class="subst">&#123;E.a4()&#125;</span>\nb = <span class="subst">&#123;E.a6()&#125;</span>\ne = <span class="subst">&#123;e&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;ciphertext = <span class="subst">&#123;long_to_bytes(<span class="built_in">int</span>(ct.xy()[<span class="number">0</span>]))&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>已知$Ct &#x3D; Pt×e$</p>
<p>给出$Ct$的横坐标$x$</p>
<p>想利用<code>E.lift_x(Integer(x))</code><strong>来求$Ct$的纵坐标$y$，发现算不出来</strong></p>
<p>改用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">R.&lt;y&gt; = Zmod(n)[]</span><br><span class="line">f = x^<span class="number">3</span> + a*x + b - y^<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(f.roots())</span><br></pre></td></tr></table></figure>

<p>依然跑不出，做个推导</p>
<p>$\because y^2 \equiv x^3 + ax+b \mod n$，$n &#x3D; p \times q$</p>
<p>$\therefore y$同时满足下列方程组<br>$$<br>\left{\begin{matrix}<br>y^2 \equiv x^3 + ax + b \mod p\<br>y^2 \equiv x^3 + ax + b \mod q<br>\end{matrix}\right.<br>$$<br>$x$代入计算得<br>$$<br>\left{\begin{matrix}<br>y^2 \equiv y_p^2 \mod p\<br>y^2 \equiv y_q^2 \mod q<br>\end{matrix}\right.<br>$$</p>
<p>对于$y^2 \equiv y_p^2 \mod p$</p>
<p>有$(y+y_p)(y-y_p) \equiv 0 \mod p$</p>
<p>$\therefore y \equiv y_p \mod p$</p>
<p>同理</p>
<p>$y \equiv y_q \mod q$</p>
<p>$\therefore y &#x3D; y_p + k_1p &#x3D; y_q + k_2q$</p>
<p>$k_1p &#x3D; y_q-y_p+k_2q$</p>
<p>同模q得$k_1p \equiv y_q-y_p \mod q$</p>
<p>则$k_1 \equiv (y_q-y_p)p^1 \mod q$</p>
<p>带回$y &#x3D; y_p + k_1p$得$y &#x3D; y_p + (y_q-y_p)pp^{-1}$</p>
<p>模n后即可得到y</p>
<p><strong>感觉这个推导有些麻烦了，用中国剩余定理应该就可以了</strong></p>
<p><strong>下面这个推导才重要</strong></p>
<p>$\because Ct \equiv Pt \times e$</p>
<p>已知$e$和$Ct$，需要求$Pt$</p>
<p>记$Pt$生成元的阶为$n$，即$nPt &#x3D; 0$</p>
<p>$e$与$n$互素时，设$e^{-1}$为$e$对$n$的逆元，即$ee^{-1} \equiv 1 \mod n \longrightarrow ee^{-1} &#x3D; kn+1$</p>
<p>$\therefore ee^{-1}P &#x3D;e^{-1}Q &#x3D; knP+P &#x3D; P$</p>
<p>$\therefore P &#x3D; e^{-1}Q$</p>
<p>实际操作过程中发现，$n$不是素数，所以求不出阶$Zmod(n)$的椭圆曲线的阶。</p>
<p><strong>先求模p,q下的阶，再相乘(这个没理解)</strong></p>
<p>在求解$Ct$的纵坐标时，我选择用中国剩余定理</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">115192265954802311941399019598810724669437369433680905425676691661793518967453</span></span><br><span class="line">q = <span class="number">109900879774346908739236130854229171067533592200824652124389936543716603840487</span></span><br><span class="line">n = <span class="number">12659731371633323406361071735480743870942884407511647144758055911931321534333057725377899993936046070028289182446615763391740446071787318153462098556669611</span></span><br><span class="line">a = <span class="number">34573016245861396068378040882622992245754693028152290874131112955018884485688</span></span><br><span class="line">b = <span class="number">103282137133820948206682036569671566996381438254897510344289164039717355513886</span></span><br><span class="line">e = <span class="number">11415307674045871669</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;f\xb1\xae\x08`\xe8\xeb\x14\x8a\x87\xd6\x18\x82\xaf1q\xe4\x84\xf0\x87\xde\xedF\x99\xe0\xf7\xdcH\x9ai\x04[\x8b\xbbHR\xd6\xa0\xa2B\x0e\xd4\xdbr\xcc\xad\x1e\xa6\xba\xad\xe9L\xde\x94\xa4\xffKP\xcc\x00\x907\xf3\xea&#x27;</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line"></span><br><span class="line">cx = bytes_to_long(ciphertext)</span><br><span class="line"><span class="comment"># cx = 5378524437009518839112103581484521575801169404987837300959984214542709038676856596473597472098329866932106236703753833875049687476896652097889558230201322</span></span><br><span class="line"><span class="comment"># cy = E.lift_x(Integer(cx))    太慢了</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># R.&lt;cy&gt; = Zmod(n)[]</span></span><br><span class="line"><span class="comment"># f = cx^3 + a*cx + b - cy^2</span></span><br><span class="line"><span class="comment"># print(f.roots())           跑不出</span></span><br><span class="line"></span><br><span class="line">R.&lt;y&gt; = Zmod(p)[]</span><br><span class="line">f = cx^<span class="number">3</span> + a*cx + b - y^<span class="number">2</span></span><br><span class="line">mps = f.roots()</span><br><span class="line"><span class="comment"># print(mps)</span></span><br><span class="line"></span><br><span class="line">R.&lt;y&gt; = Zmod(q)[]</span><br><span class="line">f = cx^<span class="number">3</span> + a*cx + b - y^<span class="number">2</span></span><br><span class="line">mqs = f.roots()</span><br><span class="line"><span class="comment"># print(mqs)</span></span><br><span class="line"></span><br><span class="line">cy_all = []</span><br><span class="line"><span class="keyword">for</span> mpp <span class="keyword">in</span> mps:</span><br><span class="line">    x = mpp[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> mqq <span class="keyword">in</span> mqs:</span><br><span class="line">        y = mqq[<span class="number">0</span>]</span><br><span class="line">        cy_all.append(CRT_list([<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)], [p, q]))</span><br><span class="line">        </span><br><span class="line">E1 = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">E2 = EllipticCurve(Zmod(q), [a, b])</span><br><span class="line"></span><br><span class="line">order1 = E1.order()</span><br><span class="line">order2 = E2.order()</span><br><span class="line">d = gmpy2.invert(e,order1*order2)</span><br><span class="line"><span class="keyword">for</span> cy <span class="keyword">in</span> cy_all:</span><br><span class="line">    Ct = E(cx,cy)</span><br><span class="line">    mx,my = (<span class="built_in">int</span>(d) * Ct).xy()</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(mx)))</span><br></pre></td></tr></table></figure>

<p>脚本来源：<a href="https://lazzzaro.github.io/2023/02/06/match-HGAME-2023-Week-4/index.html">HGAME 2023 Week 4 | Lazzaro (lazzzaro.github.io)</a></p>
<p>思路来源：<a href="https://blog.csdn.net/vvbbnn00/article/details/128877524">HGame 2023 Week4 部分Writeup_不做评论的博客-CSDN博客</a></p>
<h1 id="参考文章："><a href="#参考文章：" class="headerlink" title="参考文章："></a>参考文章：</h1><p>[ECC椭圆曲线加密算法—加解密（SageMath实现） - lnjoy - 博客园 (cnblogs.com)](<a href="https://www.cnblogs.com/lnjoy/archive/2020/10/12/ecc.html#:~:text=%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BFEp">https://www.cnblogs.com/lnjoy/archive/2020/10/12/ecc.html#:~:text=椭圆曲线Ep</a> (a%2Cb)（p为模数），基点（生成元）G (x%2Cy)，G点的阶数n，私钥k，公钥K (x%2Cy)，随机整数r，明文为一点m (x%2Cy)，密文为两点 c1 (x%2Cy)和 c2,m %3D c1 -k* c2 （%3D c1 -r*K))</p>
<p>[ECC - CTF Wiki (ctf-wiki.org)](<a href="https://ctf-wiki.org/crypto/asymmetric/discrete-log/ecc/#:~:text=ECC">https://ctf-wiki.org/crypto/asymmetric/discrete-log/ecc/#:~:text=ECC</a> - CTF Wiki ECC 概述,ECC 全称为椭圆曲线加密，EllipseCurve Cryptography，是一种基于椭圆曲线数学的公钥密码。 与传统的基于大质数因子分解困难性的加密方法不同，ECC 依赖于解决椭圆曲线离散对数问题的困难性。 它的优势主要在于相对于其它方法，它可以在使用较短密钥长度的同时保持相同的密码强度。)</p>
<p><a href="https://blog.csdn.net/qq_45198339/article/details/128756070">(10条消息) CTF学习笔记二——ECC加密_ecc加密 代码_457591978的博客-CSDN博客</a></p>
<p><a href="https://blog.csdn.net/sitebus/article/details/82835492">(10条消息) ECC椭圆曲线加解密原理详解(配图)_ecc加解密_NFTDigger的博客-CSDN博客</a></p>
<p><a href="http://www.leonlist.top/2020/09/29/CTF%E5%AF%86%E7%A0%81%E5%AD%A6-ECC/">CTF密码学-ECC | Leonlist’s Blog</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/42629724">ECC椭圆曲线密码学的原理、公式推导、例子、Python实现和应用 - 知乎 (zhihu.com)</a></p>
<p><a href="https://wumansgy.github.io/2018/10/30/%E6%A4%AD%E5%9C%86%E6%9B%B2%E7%BA%BF%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E8%AF%A6%E8%A7%A3/">椭圆曲线加密算法详解 | Wuman’s Blog (wumansgy.github.io)</a></p>
]]></content>
      <categories>
        <category>现代密码-非对称加密</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>非对称加密</tag>
        <tag>ECC</tag>
      </tags>
  </entry>
  <entry>
    <title>RSA(一)</title>
    <url>/2023/07/06/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA1/</url>
    <content><![CDATA[<p><strong>世上无所谓正解，我们只是在做自己</strong></p>
<span id="more"></span>

<p><strong>记录笔者RSA学习过程</strong></p>
<h1 id="RSA算法原理简介"><a href="#RSA算法原理简介" class="headerlink" title="RSA算法原理简介"></a>RSA算法原理简介</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.选择两个大素数p和q，计算模n=p*q</span><br><span class="line">2.计算φ(n)=(p-1)*(q-1) 这里是因为，素数p的欧拉函数φ(p)=p-1，同理φ(q)=q-1，又因为n=p*q，所以φ(n)=(p-1)*(q-1)</span><br><span class="line">3.取e的模反数为d(逆元)，计算方法：e*d ≡ 1(mod φ(n))</span><br><span class="line">4.对明文m进行加密：</span><br><span class="line">	密文c = m^e (mod n)</span><br><span class="line"></span><br><span class="line">解密：</span><br><span class="line">m = c^d (mod n) </span><br></pre></td></tr></table></figure>

<p>欧拉函数另外一种算法：</p>
<p>若$n$可以分解为某个素数的$k$次方，即$n &#x3D; p^k$，则$\phi(n) &#x3D; p^{k-1}(p-1)$</p>
<p><strong>数论知识：</strong></p>
<p>欧拉定理：若$n,a$为正整数，且$n,a$互素，则$a^{\phi(n)} \equiv 1 \mod n$</p>
<p>费马小定理：若$p$是素数，且$a,p$互素，则$a^p \equiv a\mod p$，$a^{p-1} \equiv 1 \mod p$</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">模运算：</span><br><span class="line">(a + b) % p = (a % p + b % p) % p</span><br><span class="line">(a - b) % p = (a % p - b % p) % p</span><br><span class="line">(a × b) % p = (a % p × b % p) % p</span><br><span class="line">a^b % p = ((a % p)^b) % p </span><br><span class="line">结合律：</span><br><span class="line">((a + b) % p + c) = (a + (b + c) % p) % p </span><br><span class="line">((a × b) % p × c) = (a × (b × c) % p) % p</span><br><span class="line">交换律：</span><br><span class="line">(a + b) % p = (b + a) % p</span><br><span class="line">(a * b) % p = (b * a) % p</span><br><span class="line">分配律：</span><br><span class="line">(a + b) % p = (a % p + b % p) % p</span><br><span class="line">((a + b) % p * c) % p = (((a * c) % p) + ((b * c) % p)) % p</span><br></pre></td></tr></table></figure>

<p>重要定理：</p>
<ol>
<li><p>若$a\equiv b \mod p$，对于任意的$c$，有$(a+c) \equiv (b+c) \mod p$</p>
</li>
<li><p>若$a \equiv b \mod p$，对于任意的$c$，有$(a×c) \equiv (b×c) \mod p$</p>
</li>
<li><p>若$a\equiv b \mod p$，$c \equiv d \mod p$。</p>
<p>有$(a±c) \equiv (b±d) \mod p$，$(a×c)\equiv (b×d) \mod p$，$\frac{a}{c}\equiv \frac{b}{d} \mod p$</p>
</li>
</ol>
<p><strong>逆元</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a mod p 的逆元，设为x，就是可以使得 a * x (mod p) = 1的最小x</span><br></pre></td></tr></table></figure>

<p>证明$m \equiv c^d \mod n$的正确性</p>
<p>$\because c \equiv m^e \mod n$，$m \equiv c^d \mod  n$</p>
<p>$\therefore m \equiv (m^e\mod n)^d \mod n \longrightarrow m \equiv (m^e)^d \mod n$</p>
<p>根据$(a \mod p)b \mod p \equiv a^b \mod p$</p>
<p>$\therefore m\equiv m^{ed} \mod n$，又$ed \equiv 1 \mod \phi(n) \longrightarrow ed &#x3D; k\phi(n)+1$</p>
<p>$\therefore m \equiv m ^{k\phi(n)+1} \mod n \longrightarrow m \equiv (m^{\phi(n)})^k×m \mod n$</p>
<p>由费马小定理得$m^{\phi(n)} \equiv 1 \mod n $</p>
<p>$\therefore m \equiv 1^k ×m \mod n$，$\therefore m \equiv c^d \mod n$</p>
<h1 id="一、基于分解n的题目"><a href="#一、基于分解n的题目" class="headerlink" title="一、基于分解n的题目"></a>一、基于分解n的题目</h1><h2 id="1-用yafu分解"><a href="#1-用yafu分解" class="headerlink" title="1.用yafu分解"></a>1.用yafu分解</h2><h2 id="2-网站分解"><a href="#2-网站分解" class="headerlink" title="2.网站分解"></a>2.网站分解</h2><h2 id="3-费马分解"><a href="#3-费马分解" class="headerlink" title="3.费马分解"></a>3.费马分解</h2><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n = 12627644643778588563638920097915399454513514338804142285365906525498881036764131263143503359846189659273574532609463345820199502529021505655249992763681092637840409087205147095497477412031460598408163901210084467516709264700724398765301043908384308244747517893224665577128486689416162459250095126318456522046726204794830519283112518017007468770465828497144764208737754275011224549145753948172880930824906241704072415618131966725150546352452195727712056875106693907690990407658130836472884891082069644890044024145259903993177177196801509187283280149791400422260709944706691099262186583269852628892867781015062638406807</span><br><span class="line">e = 65537</span><br><span class="line">c = 3591154430994525075059034292233285219547469362782194889629270181283842636528606554393490851841066761509914849524082427752928544931823147005056532710833510595339404286404496491815089547021604266428940702481584786412593056050015881926826382036205406303525545716475450640777471292475111436226636460600345957363695624982558394414290121846251722500596533341384706714159205414604934501768918663557451374023537565102442827170460775303421150229829840660742855663501969208548706192593969737261023358057081741247088819534013372830024084918363322257487890942468889177188305118367719047889896681307253995123323963920988776643105</span><br></pre></td></tr></table></figure>

<p>分解个n就行了</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n = <span class="number">12627644643778588563638920097915399454513514338804142285365906525498881036764131263143503359846189659273574532609463345820199502529021505655249992763681092637840409087205147095497477412031460598408163901210084467516709264700724398765301043908384308244747517893224665577128486689416162459250095126318456522046726204794830519283112518017007468770465828497144764208737754275011224549145753948172880930824906241704072415618131966725150546352452195727712056875106693907690990407658130836472884891082069644890044024145259903993177177196801509187283280149791400422260709944706691099262186583269852628892867781015062638406807</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c =<span class="number">3591154430994525075059034292233285219547469362782194889629270181283842636528606554393490851841066761509914849524082427752928544931823147005056532710833510595339404286404496491815089547021604266428940702481584786412593056050015881926826382036205406303525545716475450640777471292475111436226636460600345957363695624982558394414290121846251722500596533341384706714159205414604934501768918663557451374023537565102442827170460775303421150229829840660742855663501969208548706192593969737261023358057081741247088819534013372830024084918363322257487890942468889177188305118367719047889896681307253995123323963920988776643105</span></span><br><span class="line">p = <span class="number">112372793165332455233644051831703093065233917285171435667727396467617869514267375433546885241603527682450490525106056020927668059639131922631965832681267028908272712604839741417231722918220018271377173404939261706593582911881852334650278053606220270970895872789340580971511712537114765669110273199402053062671</span></span><br><span class="line">q = n//p</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>



<h1 id="二、密钥生成和读取"><a href="#二、密钥生成和读取" class="headerlink" title="二、密钥生成和读取"></a>二、密钥生成和读取</h1><h2 id="密钥生成"><a href="#密钥生成" class="headerlink" title="密钥生成"></a>密钥生成</h2><p>通过<code>Crypto.PublicKey.RSA</code>中的<code>construct</code>函数可以生成公钥和私钥。</p>
<p>对于生成公钥，需要两个参数$n,e$，生成私钥需要$n,e,d$</p>
<p>需要配合<code>exprot_Key</code>使用</p>
<h3 id="生成公钥"><a href="#生成公钥" class="headerlink" title="生成公钥"></a>生成公钥</h3><p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">a = (n,e)</span><br><span class="line">publickey = RSA.construct(a)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;publickey.pem&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(publickey.export_key())</span><br></pre></td></tr></table></figure>

<p><strong>注意要先把n,e括起来</strong></p>
<h3 id="生成私钥"><a href="#生成私钥" class="headerlink" title="生成私钥"></a>生成私钥</h3><p>传入的数据是$n,e,d,p,q$	其中$p,q$可以不传</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">a = (n,e)</span><br><span class="line">b = (n,e,<span class="built_in">int</span>(d))</span><br><span class="line"></span><br><span class="line">publickey = RSA.construct(a)</span><br><span class="line">privatekey = RSA.construct(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;publickey.pem&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(publickey.export_key())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;privatekey.pem&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">    f2.write(privatekey.export_key())</span><br></pre></td></tr></table></figure>

<p>这里注意要把d变成int型，因为invert出来的d是mpz数据</p>
<p><strong><code>mpz</code>是GMP（GNU Multiple Precision Arithmetic Library）库中的一个数据类型，表示任意精度整数（Arbitrary precision integer）。它可以表示任意大小的整数，不受机器字长的限制</strong></p>
<p>这样就成功生成了公私钥，试了一下把.pem改成.txt，也能运行</p>
<p>从gpt那里了解了一下pem文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PEM（Privacy-Enhanced Mail）是一种用于加密和解密电子邮件的加密标准，也是一种常用的加密文件格式，常用于存储各种类型的加密密钥和证书。</span><br><span class="line"></span><br><span class="line">PEM文件的格式是基于Base64编码的文本文件，通常以.pem、.crt、.cer、.key、.p12、.pfx等扩展名结尾。PEM文件可以存储各种类型的加密密钥和证书，包括RSA和DSA密钥、X.509证书、PKCS#7证书链、PKCS#8私钥等。</span><br></pre></td></tr></table></figure>

<h2 id="读取密钥"><a href="#读取密钥" class="headerlink" title="读取密钥"></a>读取密钥</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">key = RSA.import_Key(文件)</span><br></pre></td></tr></table></figure>

<p>key中有p,q,n,e,d五个属性</p>
<p>我感觉一般就用到n,e</p>
<h3 id="例题1-泄露私钥"><a href="#例题1-泄露私钥" class="headerlink" title="例题1 泄露私钥"></a>例题1 泄露私钥</h3><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">#</span><br><span class="line">c1 = libnum.n2s(int(c))</span><br><span class="line"></span><br><span class="line">with open(&quot;flag.pem&quot;, &quot;wb&quot;) as f:</span><br><span class="line">    f.write(c1)</span><br><span class="line"># 生成公钥</span><br><span class="line">rsa_components = (int(n), int(e), int(d))</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;pubckey.pem&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">    f.write(keypair.exportKey())</span><br></pre></td></tr></table></figure>

<p><strong>题目中把d也传入数据了，所以可以直接把d提了</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = bytes_to_long(<span class="built_in">open</span>(<span class="string">&quot;flag.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">key = RSA.import_key(<span class="built_in">open</span>(<span class="string">&quot;publickey.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">e = key.e</span><br><span class="line">n = key.n</span><br><span class="line">d = key.d</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;947ce8a3-40ee-46c0-a00e-0026e583f8da&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="例题2-公钥分解"><a href="#例题2-公钥分解" class="headerlink" title="例题2 公钥分解"></a>例题2 公钥分解</h3><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">#</span><br><span class="line">c1 = libnum.n2s(int(c))</span><br><span class="line"></span><br><span class="line">with open(&quot;flag1.pem&quot;, &quot;wb&quot;) as f:</span><br><span class="line">    f.write(c1)</span><br><span class="line"># 生成公钥</span><br><span class="line">rsa_components = (int(n), int(e))</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;pubckey1.pem&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">    f.write(keypair.exportKey())</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>首选网站分解n，发现不大行</strong></p>
<p><strong>再试了一下开根号，发现还是不行</strong></p>
<p><strong>最后试了next_prime(开根号得到的值)，解成功</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = bytes_to_long(<span class="built_in">open</span>(<span class="string">&quot;flag1.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">key = RSA.import_key(<span class="built_in">open</span>(<span class="string">&quot;pubckey1.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">e = key.e</span><br><span class="line">n = key.n</span><br><span class="line"></span><br><span class="line">p1 = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = gmpy2.next_prime(p1)</span><br><span class="line">q = n//p</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;a959ffca-06c5-47df-8313-4f9c38db4920&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="例题3-OAEP"><a href="#例题3-OAEP" class="headerlink" title="例题3 OAEP"></a>例题3 OAEP</h3><p>了解一下OAEP</p>
<p><strong>OAEP是一种用于公钥加密的填充方案，用来提供概率加密。</strong></p>
<p><strong>OAEP作为一种填充方案被开发出来，用于提供概率加密。它的工作原理是在加密之前向消息添加随机数据，使得攻击者更难确定原始消息。他应用于RSA加密算法，但不局限于RSA加密算法</strong></p>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.PublicKey import RSA</span><br><span class="line">from Crypto.Cipher import PKCS1_OAEP</span><br><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">flag = flag.encode()</span><br><span class="line"></span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># 生成公钥</span><br><span class="line">rsa_components = (int(n), int(e), int(d))</span><br><span class="line">keypair = RSA.construct(rsa_components)</span><br><span class="line">with open(&#x27;prikey2.pem&#x27;, &#x27;wb&#x27;) as f:</span><br><span class="line">    f.write(keypair.exportKey())</span><br><span class="line"></span><br><span class="line">rsa_components = (int(n), e,)</span><br><span class="line">arsa = RSA.construct(rsa_components)</span><br><span class="line">rsakey = RSA.importKey(arsa.exportKey())</span><br><span class="line">rsakey = PKCS1_OAEP.new(rsakey)</span><br><span class="line">c = rsakey.encrypt(flag)</span><br><span class="line">with open(&quot;flag2.pem&quot;, &quot;wb&quot;) as f:</span><br><span class="line">    f.write(c)</span><br></pre></td></tr></table></figure>

<p>了解了一下函数</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">PKCS1_OAEP.new(key, hashAlgo=<span class="literal">None</span>, mgfunc=<span class="literal">None</span>, label=<span class="string">b&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>参数含义如下：</p>
<ul>
<li><code>key</code>: RSA密钥，可以是公钥或私钥；</li>
<li><code>hashAlgo</code>: 哈希算法，默认为SHA-1；</li>
<li><code>mgfunc</code>: 消息生成函数，默认为MGF1；</li>
<li><code>label</code>: 可选的附加数据，默认为空。</li>
</ul>
<p>key是必需参数</p>
<p>使用<code>PKCS1_OAEP.new</code>初始化后，可以调用其实例方法<code>encrypt</code>和<code>decrypt</code>实现RSA-OAEP算法的加密和解密操作</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey.RSA <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">&quot;flag2.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">key = import_key(<span class="built_in">open</span>(<span class="string">&quot;prikey2.pem&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line"></span><br><span class="line">newkey = PKCS1_OAEP.new(key)</span><br><span class="line">m = newkey.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(m).</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;04bbaad0-9241-42a4-9fd4-7d6e0d8bc5f1&#125;</span></span><br></pre></td></tr></table></figure>

<p>解题中学到在这种题目中：</p>
<p><strong>c不需要转成整型</strong></p>
<p><strong>decrypt接受的数据是byte类型的密文</strong></p>
<h3 id="攻防世界——cr4-poor-rsa"><a href="#攻防世界——cr4-poor-rsa" class="headerlink" title="攻防世界——cr4-poor-rsa"></a>攻防世界——cr4-poor-rsa</h3><p>题目给了个无后缀的文件，拖到010发现里面有藏两个文件，于是把后缀改成了zip</p>
<p>打开后得到两个文件，<strong>分别是key.pub和flag.b64</strong></p>
<p>key.pub:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">ME0wDQYJKoZIhvcNAQEBBQADPAAwOQIyUqmeJJ7nzzwMv5Y6AJZhdyvJzfbh4/v8</span><br><span class="line">bkSgel4PiURXqfgcOuEyrFaD01soulwyQkMCAwEAAQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<p>flag.b64:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Ni45iH4UnXSttNuf0Oy80+G5J7tm8sBJuDNN7qfTIdEKJow4siF2cpSbP/qIWDjSi+w=</span><br></pre></td></tr></table></figure>

<p>先试着读取公钥，发现n可以分解，于是就按常规流程做了</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey.RSA <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = base64.b64decode(<span class="built_in">open</span>(<span class="string">&quot;flag.b64&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line">c = bytes_to_long(c)</span><br><span class="line">key = import_key(<span class="built_in">open</span>(<span class="string">&quot;key.pub&quot;</span>,<span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line"></span><br><span class="line">p = <span class="number">863653476616376575308866344984576466644942572246900013156919</span></span><br><span class="line">q = <span class="number">965445304326998194798282228842484732438457170595999523426901</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#XCTF&#123;SMALL_PRIMES_ARE_BAD&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="三、共模攻击"><a href="#三、共模攻击" class="headerlink" title="三、共模攻击"></a>三、共模攻击</h1><p>共模攻击：</p>
<p><strong>在对同一明文的加密过程中使用相同的模数n，对同一明文，用不同的密钥e（两个密钥是互素的）进行加密</strong></p>
<p><strong>结果是得到两个不同的c</strong></p>
<p>原理：</p>
<p>$c_1 \equiv m^{e_1} \mod n$，$c_2 \equiv m^{e_2}\mod n$，$gcd(e_1,e_2)&#x3D;1$</p>
<p><strong>根据欧几里得扩展算法</strong>：若$a,b$是两个不全为0的整数，则存在两个整数$x,y$使得$s×a+t×b &#x3D; gcd(a,b)$</p>
<p>在这里有$e_1x+e_2y &#x3D; 1$</p>
<p>$\therefore c_1^x×c_2^y \equiv (m^{e_1} \mod n)^x ×(m^{e_2} \mod n)^y \mod n$</p>
<p>$\therefore c_1^x×c_2^y \equiv m^{e_1x+e_2y} \mod n$</p>
<p>$\because e_1x+e_2y &#x3D; 1$</p>
<p>$\therefore c_1^x×c_2^y \equiv m \mod n$</p>
<h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">n1 = p * q</span><br><span class="line">n2 = p * q</span><br><span class="line">e1 = 2333</span><br><span class="line">e2 = 23333</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">c1 = pow(m, e1, n1)</span><br><span class="line">c2 = pow(m, e2, n2)</span><br><span class="line">print(&quot;n1=&quot;, n1)</span><br><span class="line">print(&quot;n2=&quot;, n2)</span><br><span class="line">print(&quot;e1=&quot;, e1)</span><br><span class="line">print(&quot;e2=&quot;, e2)</span><br><span class="line">print(&quot;c1=&quot;, c1)</span><br><span class="line">print(&quot;c2=&quot;, c2)</span><br><span class="line"></span><br><span class="line">#n1 = 12023886737570921683430494088148056717464277480371493354080633886982376602419433228186314817561301719123238737516332784081267153425832030515178119047675516911098595227477026283152544604891747727831780305507300318674027062554009254728767714650522432836286987070040177863862115871377017779058128916872854380528430193235920536818893053943407063308419618772087299760070707222914961338101044775521373972076936552277418325268112523349134412986872504187930360266568935217397303420305220796347316727211659529079762169876950534044014924448371804442314283893083178368082712851107281302456671010073505430574108861981588149293779</span><br><span class="line">n2 = 12023886737570921683430494088148056717464277480371493354080633886982376602419433228186314817561301719123238737516332784081267153425832030515178119047675516911098595227477026283152544604891747727831780305507300318674027062554009254728767714650522432836286987070040177863862115871377017779058128916872854380528430193235920536818893053943407063308419618772087299760070707222914961338101044775521373972076936552277418325268112523349134412986872504187930360266568935217397303420305220796347316727211659529079762169876950534044014924448371804442314283893083178368082712851107281302456671010073505430574108861981588149293779</span><br><span class="line">e1 = 2333</span><br><span class="line">e2 = 23333</span><br><span class="line">    c1 = 1316116662134770690879814362103839780623420120527248536043840592146479052480574077985474161623763978563721124073172820410730492348846200098142706235343164470686127445583938273863894304189618247054649514955176136464273395879832878841555224421879457659795562326746943199675846414637238040550327393009642569894024250271081839428945999237716296592560124669418322569188493036148885333003876760965512925618500360394774816066758106739359762817644284120811162065280330204951295150904138010974815308787047834776406610525102814356091515999954110712767658162496023213125548829820563945272374105274832862682574678195529192009516</span><br><span class="line">c2 =6485241395763328009719746130709898541269729483150505308808259329749145687803066648274311801821624527910483266170666538736992203392620205417714840881369386852010836477498279266591695876758050686740322941452286584178315830797555697887040771666991377055060541491757349967338300117181859105577325308779010792879713808168285776399372981366988860647334022480774711504685240194804912592209253106123423232743785805952113875347267336118332317990496240807273787216894980604742600774512296661048914646776553393778079057461747246478299158814839681875752645552215714984659603917168300453505504140987829883479097467840565806608012</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">12023886737570921683430494088148056717464277480371493354080633886982376602419433228186314817561301719123238737516332784081267153425832030515178119047675516911098595227477026283152544604891747727831780305507300318674027062554009254728767714650522432836286987070040177863862115871377017779058128916872854380528430193235920536818893053943407063308419618772087299760070707222914961338101044775521373972076936552277418325268112523349134412986872504187930360266568935217397303420305220796347316727211659529079762169876950534044014924448371804442314283893083178368082712851107281302456671010073505430574108861981588149293779</span></span><br><span class="line">e1 = <span class="number">2333</span></span><br><span class="line">e2 = <span class="number">23333</span></span><br><span class="line">c1 =<span class="number">1316116662134770690879814362103839780623420120527248536043840592146479052480574077985474161623763978563721124073172820410730492348846200098142706235343164470686127445583938273863894304189618247054649514955176136464273395879832878841555224421879457659795562326746943199675846414637238040550327393009642569894024250271081839428945999237716296592560124669418322569188493036148885333003876760965512925618500360394774816066758106739359762817644284120811162065280330204951295150904138010974815308787047834776406610525102814356091515999954110712767658162496023213125548829820563945272374105274832862682574678195529192009516</span></span><br><span class="line">c2 =<span class="number">6485241395763328009719746130709898541269729483150505308808259329749145687803066648274311801821624527910483266170666538736992203392620205417714840881369386852010836477498279266591695876758050686740322941452286584178315830797555697887040771666991377055060541491757349967338300117181859105577325308779010792879713808168285776399372981366988860647334022480774711504685240194804912592209253106123423232743785805952113875347267336118332317990496240807273787216894980604742600774512296661048914646776553393778079057461747246478299158814839681875752645552215714984659603917168300453505504140987829883479097467840565806608012</span></span><br><span class="line"></span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;01d80670b01b654fe4831a3e81870734&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>gcdext(e1,e2)</code>返回3个元素</p>
<p>第一个元素是$Boolean$类型的数据，判断存不存在$x,y$使得$e_1x+e_2y &#x3D; 1$</p>
<p>返回得第二个和第三个元素是$x,y$</p>
<h2 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag  = &#x27;***************&#x27;</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">m1 = bytes_to_long(bytes(flag.encode()))</span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">e1 = getPrime(32)</span><br><span class="line">e2 = getPrime(32)</span><br><span class="line">print()</span><br><span class="line"></span><br><span class="line">flag1 = pow(m1,e1,n)</span><br><span class="line">flag2 = pow(m1,e2,n)</span><br><span class="line">print(&#x27;flag1= &#x27;+str(flag1))</span><br><span class="line">print(&#x27;flag2= &#x27;+str(flag2))</span><br><span class="line">print(&#x27;e1= &#x27; +str(e1))</span><br><span class="line">print(&#x27;e2= &#x27;+str(e2))</span><br><span class="line">print(&#x27;n= &#x27;+str(n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#flag1= 100156221476910922393504870369139942732039899485715044553913743347065883159136513788649486841774544271396690778274591792200052614669235485675534653358596366535073802301361391007325520975043321423979924560272762579823233787671688669418622502663507796640233829689484044539829008058686075845762979657345727814280</span><br><span class="line">#flag2= 86203582128388484129915298832227259690596162850520078142152482846864345432564143608324463705492416009896246993950991615005717737886323630334871790740288140033046061512799892371429864110237909925611745163785768204802056985016447086450491884472899152778839120484475953828199840871689380584162839244393022471075</span><br><span class="line">#e1= 3247473589</span><br><span class="line">#e2= 3698409173</span><br><span class="line">#n= 103606706829811720151309965777670519601112877713318435398103278099344725459597221064867089950867125892545997503531556048610968847926307322033117328614701432100084574953706259773711412853364463950703468142791390129671097834871371125741564434710151190962389213898270025272913761067078391308880995594218009110313</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">103606706829811720151309965777670519601112877713318435398103278099344725459597221064867089950867125892545997503531556048610968847926307322033117328614701432100084574953706259773711412853364463950703468142791390129671097834871371125741564434710151190962389213898270025272913761067078391308880995594218009110313</span></span><br><span class="line">e1 = <span class="number">3247473589</span></span><br><span class="line">e2 = <span class="number">3698409173</span></span><br><span class="line">c1 =<span class="number">100156221476910922393504870369139942732039899485715044553913743347065883159136513788649486841774544271396690778274591792200052614669235485675534653358596366535073802301361391007325520975043321423979924560272762579823233787671688669418622502663507796640233829689484044539829008058686075845762979657345727814280</span></span><br><span class="line">c2 =<span class="number">86203582128388484129915298832227259690596162850520078142152482846864345432564143608324463705492416009896246993950991615005717737886323630334871790740288140033046061512799892371429864110237909925611745163785768204802056985016447086450491884472899152778839120484475953828199840871689380584162839244393022471075</span></span><br><span class="line"></span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#NSSCTF&#123;xxxxx******xxxxx&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="四、低加密指数攻击"><a href="#四、低加密指数攻击" class="headerlink" title="四、低加密指数攻击"></a>四、低加密指数攻击</h1><p>原理：</p>
<p>加密指数e很小一般是3，导致出现两个情况</p>
<p>第一种情况：$m^e &lt; n $则$c \equiv m^{e} \mod  n \longrightarrow c &#x3D; m^e$这种情况下对c开e次方就可以得到m的值</p>
<p>第二种情况：$m^e &gt; n$则$m^e &#x3D; k*n + c$这种情况需要爆破k</p>
<h2 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">print(gmpy2.bit_length(m ** 3))</span><br><span class="line">while True:</span><br><span class="line">    p = libnum.generate_prime(504)</span><br><span class="line">    q = libnum.generate_prime(504)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi_n = (p - 1) * (q - 1)</span><br><span class="line">    e = 3</span><br><span class="line">    if gmpy2.gcd(e, phi_n) == 1 and  phi_n%e !=0:</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line"></span><br><span class="line">#c= 17567615026662297423639652671128685098763112348521263232850922784902991105809108670614334001294254886850775709702759646022208238160649099765454315761185950859820327234504422026634432251632399712621439201146</span><br><span class="line">3091635444512796333373451321795475333496092463760390199602320265733668648810943598505902205569125</span><br><span class="line">n = 1101676297168703265566511587913652821222614528632844563918598090813090976948138058144049294690727841463413972173051671908835164088465174349647584948964206244648736138253802417241570633968307801570794459668533128958442296813160786428069813867034205462528763830205245218089660432399549540588101288362866463</span><br><span class="line">e = 3</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">1101676297168703265566511587913652821222614528632844563918598090813090976948138058144049294690727841463413972173051671908835164088465174349647584948964206244648736138253802417241570633968307801570794459668533128958442296813160786428069813867034205462528763830205245218089660432399549540588101288362866463</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="number">175676150266622974236396526711286850987631123485212632328509227849029911058091086706143340012942548868507757097027596460222082381606490997654543157611859508598203272345044220266344322516323997126214392011463091635444512796333373451321795475333496092463760390199602320265733668648810943598505902205569125</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.iroot(c,e)</span><br><span class="line"><span class="keyword">if</span> t[<span class="number">1</span>]:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(t[<span class="number">0</span>]))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        m = gmpy2.iroot(k*n+c,e)</span><br><span class="line">        <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h1 id="五、低加密指数广播攻击"><a href="#五、低加密指数广播攻击" class="headerlink" title="五、低加密指数广播攻击"></a>五、低加密指数广播攻击</h1><p>原理：</p>
<p>明文$m$用相同的密钥$e$和不同的模$n$进行加密</p>
<p>一般会得到几组不同的$n$和$c$</p>
<h2 id="第一种情况-多组n"><a href="#第一种情况-多组n" class="headerlink" title="第一种情况 多组n"></a>第一种情况 多组n</h2><p><strong>这些不同的n之间的最大公约数如果不是1的话，会泄露p，就是说最大公约数是p</strong></p>
<h3 id="例题-BUUCTF-RSA5"><a href="#例题-BUUCTF-RSA5" class="headerlink" title="例题 BUUCTF-RSA5"></a>例题 BUUCTF-RSA5</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">m = xxxxxxxx</span><br><span class="line">e = 65537</span><br><span class="line">========== n c ==========</span><br><span class="line">n = 20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span><br><span class="line">c = 974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span><br><span class="line"></span><br><span class="line">n = 20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span><br><span class="line">c = 15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span><br><span class="line"></span><br><span class="line">n = 25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span><br><span class="line">c = 4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span><br><span class="line"></span><br><span class="line">n = 21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span><br><span class="line">c = 4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span><br><span class="line"></span><br><span class="line">n = 22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span><br><span class="line">c = 15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span><br><span class="line"></span><br><span class="line">n = 21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span><br><span class="line">c = 20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span><br><span class="line"></span><br><span class="line">n = 25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span><br><span class="line">c = 19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span><br><span class="line"></span><br><span class="line">n = 22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span><br><span class="line">c = 6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span><br><span class="line"></span><br><span class="line">n = 23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span><br><span class="line">c = 5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span><br><span class="line"></span><br><span class="line">n = 28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span><br><span class="line">c = 9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span><br><span class="line"></span><br><span class="line">n = 22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span><br><span class="line">c = 1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span><br><span class="line"></span><br><span class="line">n = 27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span><br><span class="line">c = 21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span><br><span class="line"></span><br><span class="line">n = 20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span><br><span class="line">c = 14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span><br><span class="line"></span><br><span class="line">n = 27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span><br><span class="line">c = 3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span><br><span class="line"></span><br><span class="line">n = 27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span><br><span class="line">c = 14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span><br><span class="line"></span><br><span class="line">n = 25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span><br><span class="line">c = 17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span><br><span class="line"></span><br><span class="line">n = 23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span><br><span class="line">c = 10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span><br><span class="line"></span><br><span class="line">n = 19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span><br><span class="line">c = 3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span><br><span class="line"></span><br><span class="line">n = 19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span><br><span class="line">c = 6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span><br><span class="line"></span><br><span class="line">n = 26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span><br><span class="line">c = 386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span><br></pre></td></tr></table></figure>

<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>每两个n求一次公约数，看看是否有不为1的一组n，如果有的话，p就是这个公约数，之后就可以求其他量了</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n = [n0,n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19]</span><br><span class="line">c = [c0,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">        <span class="keyword">if</span> (i!=j):</span><br><span class="line">            t = gmpy2.gcd(n[i],n[j])</span><br><span class="line">            <span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">                p = t</span><br><span class="line">                q = n[i] // p</span><br><span class="line">                d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                m = <span class="built_in">pow</span>(c[i],d,n[i])</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">                </span><br><span class="line"><span class="comment">#flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="第二种情况-孙子定理"><a href="#第二种情况-孙子定理" class="headerlink" title="第二种情况 孙子定理"></a>第二种情况 孙子定理</h2><p><img src="/../../images/RSA/8.png"></p>
<p><strong>在张秀平老师那里学的方法是列个表</strong></p>
<table>
<thead>
<tr>
<th align="center">除数</th>
<th align="center">余数</th>
<th align="center">最小公倍数</th>
<th align="center">衍数</th>
<th align="center">乘率</th>
<th align="center">各总</th>
<th align="center">答数</th>
<th align="center">最小答数</th>
</tr>
</thead>
<tbody><tr>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">105</td>
<td align="center">35</td>
<td align="center">2</td>
<td align="center">140</td>
<td align="center">233</td>
<td align="center">23</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">3</td>
<td align="center">105</td>
<td align="center">21</td>
<td align="center">1</td>
<td align="center">63</td>
<td align="center">233</td>
<td align="center">23</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">2</td>
<td align="center">105</td>
<td align="center">15</td>
<td align="center">1</td>
<td align="center">30</td>
<td align="center">233</td>
<td align="center">23</td>
</tr>
</tbody></table>
<p><strong>衍数</strong>：本除数之外的除数之和，eg:除数3的衍数为5×7<br>$$<br>衍数×x \equiv 1\mod 除数<br>$$<br><strong>乘率：</strong>是上式的解<br>$$<br>3的乘率是\\<br>$$</p>
<p>$$<br>35x \equiv 1\mod 3的解，即2<br>$$</p>
<p><strong>各总</strong>：衍数，乘率，余数之积。eg:3的各总是35×2×2&#x3D;140</p>
<p><strong>答数</strong>：各总之和</p>
<p><strong>最小答数：</strong>答数对最小公倍数的余数，eg:<br>$$<br>233 \equiv x \mod 105<br>$$<br><strong>其中x&#x3D;23</strong></p>
<h3 id="关于孙子定理的求解"><a href="#关于孙子定理的求解" class="headerlink" title="关于孙子定理的求解"></a>关于孙子定理的求解</h3><p>推广到一般情况</p>
<p><img src="/../../images/RSA/9.png"></p>
<p>用同样的方法列个表</p>
<p><img src="/../../images/RSA/%E5%88%97%E8%A1%A8%E8%A7%A3%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86.jpg"></p>
<p><img src="/../../images/RSA/10.png"></p>
<p><strong>代码实现：</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Mi</span>(<span class="params">m_list,m</span>):               <span class="comment">#求衍数</span></span><br><span class="line">    M_list = []</span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        M_list.append(m // mi)</span><br><span class="line">    <span class="keyword">return</span> M_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_resMi</span>(<span class="params">M_list,m_list</span>):       <span class="comment">#求乘率</span></span><br><span class="line">    resM_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        resM_list.append(gmpy2.invert(M_list[i],m_list[i]))</span><br><span class="line">    <span class="keyword">return</span> resM_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_result</span>(<span class="params">a_list</span>):				<span class="comment">#求答数</span></span><br><span class="line">    M_list = Get_Mi(m_list,m)</span><br><span class="line">    resM_list = Get_resMi(M_list,m_list)</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        result += M_list[i]*resM_list[i]*a_list[i]</span><br><span class="line">    result %= m						<span class="comment">#最小答数</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">m_list = [...]</span><br><span class="line">a_list = [...]</span><br><span class="line"></span><br><span class="line">m = <span class="number">1</span>								<span class="comment">#求最小公倍数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m_list:</span><br><span class="line">    m *= i</span><br><span class="line"></span><br><span class="line">result = Get_result(a_list)</span><br></pre></td></tr></table></figure>

<h3 id="例题1-1"><a href="#例题1-1" class="headerlink" title="例题1"></a>例题1</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import random</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">n1 = p * q</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">n2 = p * q</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">n3 = p * q</span><br><span class="line">while 1:</span><br><span class="line">    e = random.randint(10, 20)</span><br><span class="line">    print(e)</span><br><span class="line">    if gmpy2.is_prime(e):</span><br><span class="line">        break</span><br><span class="line">c1 = pow(m, e, n1)</span><br><span class="line">c2 = pow(m, e, n2)</span><br><span class="line">c3 = pow(m, e, n3)</span><br><span class="line"></span><br><span class="line">print(&quot;n1=&quot;, n1)</span><br><span class="line">print(&quot;n2=&quot;, n2)</span><br><span class="line">print(&quot;n3=&quot;, n3)</span><br><span class="line"></span><br><span class="line">print(&quot;c1=&quot;, c1)</span><br><span class="line">print(&quot;c2=&quot;, c2)</span><br><span class="line">print(&quot;c3=&quot;, c3)</span><br></pre></td></tr></table></figure>

<p><strong>先根据中国剩余定理求出$m^e$，这题的e只给范围，要爆破一下</strong></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Mi</span>(<span class="params">m_list,m</span>):               <span class="comment">#求衍数</span></span><br><span class="line">    M_list = []</span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        M_list.append(m // mi)</span><br><span class="line">    <span class="keyword">return</span> M_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_resMi</span>(<span class="params">M_list,m_list</span>):       <span class="comment">#求乘率</span></span><br><span class="line">    resM_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        resM_list.append(gmpy2.invert(M_list[i],m_list[i]))</span><br><span class="line">    <span class="keyword">return</span> resM_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_result</span>(<span class="params">a_list</span>):</span><br><span class="line">    M_list = Get_Mi(m_list,m)</span><br><span class="line">    resM_list = Get_resMi(M_list,m_list)</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        result += M_list[i]*resM_list[i]*a_list[i]</span><br><span class="line">    result %= m</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">16655230929893303490818415854457831426545038662809855283873228642358207995734291242944120042612699642460820594813654718158395826755230956722936107927889550129166619245152453353908373751380196656611349200623414836128383308653618062999595622747482867683840133843768870236300348203389275090871132570173650238774275209757683812077533989960172822335488251744796657926473009279723460304257252876756936524918018903158795894385111046938638194925881670388700872760201130485273663156422785999102754192840209476417602399017445296045070405343876349687582470436774316410697773759057621576657298096301937899052773787116133124199739</span></span><br><span class="line">n2 = <span class="number">17197151926745749646602149115445210421300330711044282276861045275221683290586877554048509794473112203880585601275129330843554946888863132721219683639579200702355880529569042889789589005950061966309684759066705732225014741164779016525568884409690021988879475589545329149547046975086877521757237117008484775731784935960191717287332176327498377273179740487245459081737196777751408106728622513560888261855065717079007065635401835089216224111969668029246916986663313301660909538148574652809266532053889578734157117390082522831069594417637550812101652367765364077901612478983024721669687150628356918237152414368862535409859</span></span><br><span class="line">n3 = <span class="number">18719461901666732419189610536735130974364055134601694187780706398369536769336080321122034942831217438281120989017698755904233940669427542442488330152862658754609065361849067002424120904308655036927580582916373684567047102601602588472175947665724244201887952599804681827419266055359412641159981152796138695901074514583606207162167385730873921563442166111892785482387108299191119048884993267729877797586421940344366636285656854837470348603688925980178978612114344024951042846249621559376348599687263736342957456838732355009637030035658212442442824658869094581324944034490700706979663405137522294780606800571433058912041</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">3530761236149189046680124371485374220252032991305088864647979778627799354583229731576585900490173357726425570018182390597284149666834264690795437972634538596441103368165128688664787322126097802985602065455316693754513332761284857157982201975554297034291092099307950246864758375115838291339394148547902128382917596947095456178572561422004708150053706114994560773293625641699691472764190426577272488084620105693964419578988589192873196530900413833531923536786853211065167782657153004342018675666293830194703777994380600060782651326623229047839109994778831432598543154184891096335217588164509636922274833553782288823349</span></span><br><span class="line">c2 = <span class="number">7557835478962501903223351987016911891266554255050134264644805724502475848487138948948076311894495847429608136390014902405718084026208891531815323418707377349405409096779206918831458396991602033494429461919844309109113047361743133772636443322195238900874786548606687215969337920658068807801603115402783849082788527952834594443136756890747461628705174983562847145588532659589787532039981477468881131005056101092222499397893730056830156407331988257383965698358904379729558105489119604343081747549319382873235286788453435066434264212954607441597606413293491628299838317713381567250093086011058119721189087729804152444980</span></span><br><span class="line">c3 =<span class="number">8471234074077377509408346140986116360421840978074779990698043926601850838824365885362094731657766299393262223086536737448516669969503891677808275285733096884405583100485903641986516527279324847718603091709062689898441711907846902050004165404073776422495381050861998133576074526490209080137421773440295749900582039873013319584167081936219517593826232230971430937112005615502869367413205660317010303160932970748420125111225082886082306332340892549579826854620461821084886193470846195356695313518639669516456574134135244251956477677377976434266541164893562226872334598362396368708087248848222008201970781942468960022694</span></span><br><span class="line"></span><br><span class="line">m_list= [n1,n2,n3]</span><br><span class="line">a_list= [c1,c2,c3]</span><br><span class="line"></span><br><span class="line">m = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m_list:</span><br><span class="line">    m *= i</span><br><span class="line"></span><br><span class="line">result = Get_result(a_list)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="number">20</span>):</span><br><span class="line">    m = gmpy2.iroot(result,e)</span><br><span class="line">    <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<h3 id="例题2-鹤城杯2021——Crazy-Tech-RSA"><a href="#例题2-鹤城杯2021——Crazy-Tech-RSA" class="headerlink" title="例题2 鹤城杯2021——Crazy_Tech_RSA"></a>例题2 鹤城杯2021——Crazy_Tech_RSA</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from Crypto.Util.Padding import *</span><br><span class="line"></span><br><span class="line">FLAG = bytes_to_long(pad(b&quot;flag&#123;??????&#125;&quot;,64))</span><br><span class="line">def init_key():</span><br><span class="line">    p, q = getPrime(512), getPrime(512)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = 9</span><br><span class="line">    while(GCD((p-1)*(q-1),e)!=1):</span><br><span class="line">        p, q = getPrime(512), getPrime(512)</span><br><span class="line">        n = p*q</span><br><span class="line">    d = inverse(e,(p-1)*(q-1))</span><br><span class="line">    return n,e,d</span><br><span class="line"></span><br><span class="line">n_list=list()</span><br><span class="line">c_list=list()</span><br><span class="line">for i in range(9):</span><br><span class="line">    N,e,d=init_key()</span><br><span class="line">    n_list.append(N)</span><br><span class="line">    c=pow(FLAG,e,N)</span><br><span class="line">    c_list.append(pow(FLAG,e,N))</span><br><span class="line">    assert(pow(c,d,N)==FLAG)</span><br><span class="line">print(&quot;n_list:&quot;,n_list)</span><br><span class="line">print(&quot;c_list:&quot;,c_list)</span><br></pre></td></tr></table></figure>

<p>先用中国剩余定理解出$m^e$</p>
<p><strong>再开根号</strong></p>
<p>这道题的e是给出，如果e没有给出的话，需要爆破e</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Mi</span>(<span class="params">m_list,m</span>):               <span class="comment">#求衍数</span></span><br><span class="line">    M_list = []</span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        M_list.append(m // mi)</span><br><span class="line">    <span class="keyword">return</span> M_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_resMi</span>(<span class="params">M_list,m_list</span>):       <span class="comment">#求乘率</span></span><br><span class="line">    resM_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        resM_list.append(gmpy2.invert(M_list[i],m_list[i]))</span><br><span class="line">    <span class="keyword">return</span> resM_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_result</span>(<span class="params">a_list</span>):</span><br><span class="line">    M_list = Get_Mi(m_list,m)</span><br><span class="line">    resM_list = Get_resMi(M_list,m_list)</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        result += M_list[i]*resM_list[i]*a_list[i]</span><br><span class="line">    result %= m</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">m_list=[<span class="number">71189786319102608575263218254922479901008514616376166401353025325668690465852130559783959409002115897148828732231478529655075366072137059589917001875303598680931962384468363842379833044123189276199264340224973914079447846845897807085694711541719515881377391200011269924562049643835131619086349617062034608799</span>, <span class="number">92503831027754984321994282254005318198418454777812045042619263533423066848097985191386666241913483806726751133691867010696758828674382946375162423033994046273252417389169779506788545647848951018539441971140081528915876529645525880324658212147388232683347292192795975558548712504744297104487514691170935149949</span>, <span class="number">100993952830138414466948640139083231443558390127247779484027818354177479632421980458019929149817002579508423291678953554090956334137167905685261724759487245658147039684536216616744746196651390112540237050493468689520465897258378216693418610879245129435268327315158194612110422630337395790254881602124839071919</span>, <span class="number">59138293747457431012165762343997972673625934330232909935732464725128776212729547237438509546925172847581735769773563840639187946741161318153031173864953372796950422229629824699580131369991913883136821374596762214064774480548532035315344368010507644630655604478651898097886873485265848973185431559958627423847</span>, <span class="number">66827868958054485359731420968595906328820823695638132426084478524423658597714990545142120448668257273436546456116147999073797943388584861050133103137697812149742551913704341990467090049650721713913812069904136198912314243175309387952328961054617877059134151915723594900209641163321839502908705301293546584147</span>, <span class="number">120940513339890268554625391482989102665030083707530690312336379356969219966820079510946652021721814016286307318930536030308296265425674637215009052078834615196224917417698019787514831973471113022781129000531459800329018133248426080717653298100515701379374786486337920294380753805825328119757649844054966712377</span>, <span class="number">72186594495190221129349814154999705524005203343018940547856004977368023856950836974465616291478257156860734574686154136925776069045232149725101769594505766718123155028300703627531567850035682448632166309129911061492630709698934310123778699316856399909549674138453085885820110724923723830686564968967391721281</span>, <span class="number">69105037583161467265649176715175579387938714721653281201847973223975467813529036844308693237404592381480367515044829190066606146105800243199497182114398931410844901178842049915914390117503986044951461783780327749665912369177733246873697481544777183820939967036346862056795919812693669387731294595126647751951</span>, <span class="number">76194219445824867986050004226602973283400885106636660263597964027139613163638212828932901192009131346530898961165310615466747046710743013409318156266326090650584190382130795884514074647833949281109675170830565650006906028402714868781834693473191228256626654011772428115359653448111208831188721505467497494581</span>]</span><br><span class="line">a_list=[<span class="number">62580922178008480377006528793506649089253164524883696044759651305970802215270721223149734532870729533611357047595181907404222690394917605617029675103788705320032707977225447998111744887898039756375876685711148857676502670812333076878964148863713993853526715855758799502735753454247721711366497722251078739585</span>, <span class="number">46186240819076690248235492196228128599822002268014359444368898414937734806009161030424589993541799877081745454934484263188270879142125136786221625234555265815513136730416539407710862948861531339065039071959576035606192732936477944770308784472646015244527805057990939765708793705044236665364664490419874206900</span>, <span class="number">85756449024868529058704599481168414715291172247059370174556127800630896693021701121075838517372920466708826412897794900729896389468152213884232173410022054605870785910461728567377769960823103334874807744107855490558726013068890632637193410610478514663078901021307258078678427928255699031215654693270240640198</span>, <span class="number">14388767329946097216670270960679686032536707277732968784379505904021622612991917314721678940833050736745004078559116326396233622519356703639737886289595860359630019239654690312132039876082685046329079266785042428947147658321799501605837784127004536996628492065409017175037161261039765340032473048737319069656</span>, <span class="number">1143736792108232890306863524988028098730927600066491485326214420279375304665896453544100447027809433141790331191324806205845009336228331138326163746853197990596700523328423791764843694671580875538251166864957646807184041817863314204516355683663859246677105132100377322669627893863885482167305919925159944839</span>, <span class="number">2978800921927631161807562509445310353414810029862911925227583943849942080514132963605492727604495513988707849133045851539412276254555228149742924149242124724864770049898278052042163392380895275970574317984638058768854065506927848951716677514095183559625442889028813635385408810698294574175092159389388091981</span>, <span class="number">16200944263352278316040095503540249310705602580329203494665614035841657418101517016718103326928336623132935178377208651067093136976383774189554806135146237406248538919915426183225265103769259990252162411307338473817114996409705345401251435268136647166395894099897737607312110866874944619080871831772376466376</span>, <span class="number">31551601425575677138046998360378916515711528548963089502535903329268089950335615563205720969393649713416910860593823506545030969355111753902391336139384464585775439245735448030993755229554555004154084649002801255396359097917380427525820249562148313977941413268787799534165652742114031759562268691233834820996</span>, <span class="number">25288164985739570635307839193110091356864302148147148153228604718807817833935053919412276187989509493755136905193728864674684139319708358686431424793278248263545370628718355096523088238513079652226028236137381367215156975121794485995030822902933639803569133458328681148758392333073624280222354763268512333515</span>]</span><br><span class="line"></span><br><span class="line">m = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m_list:</span><br><span class="line">    m *= i</span><br><span class="line"></span><br><span class="line">result = Get_result(a_list)</span><br><span class="line">e = <span class="number">9</span></span><br><span class="line">m = gmpy2.iroot(result,e)</span><br><span class="line"><span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<h3 id="例题3-攻防世界——OldDriver"><a href="#例题3-攻防世界——OldDriver" class="headerlink" title="例题3 攻防世界——OldDriver"></a>例题3 攻防世界——OldDriver</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_Mi</span>(<span class="params">m_list,m</span>):               <span class="comment">#求衍数</span></span><br><span class="line">    M_list = []</span><br><span class="line">    <span class="keyword">for</span> mi <span class="keyword">in</span> m_list:</span><br><span class="line">        M_list.append(m // mi)</span><br><span class="line">    <span class="keyword">return</span> M_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_resMi</span>(<span class="params">M_list,m_list</span>):       <span class="comment">#求乘率</span></span><br><span class="line">    resM_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        resM_list.append(gmpy2.invert(M_list[i],m_list[i]))</span><br><span class="line">    <span class="keyword">return</span> resM_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Get_result</span>(<span class="params">a_list</span>):</span><br><span class="line">    M_list = Get_Mi(m_list,m)</span><br><span class="line">    resM_list = Get_resMi(M_list,m_list)</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(M_list)):</span><br><span class="line">        result += M_list[i]*resM_list[i]*a_list[i]</span><br><span class="line">    result %= m</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">m_list=[<span class="number">25162507052339714421839688873734596177751124036723831003300959761137811490715205742941738406548150240861779301784133652165908227917415483137585388986274803</span>,<span class="number">23976859589904419798320812097681858652325473791891232710431997202897819580634937070900625213218095330766877190212418023297341732808839488308551126409983193</span>,<span class="number">18503782836858540043974558035601654610948915505645219820150251062305120148745545906567548650191832090823482852604346478335353784501076761922605361848703623</span>,<span class="number">23383087478545512218713157932934746110721706819077423418060220083657713428503582801909807142802647367994289775015595100541168367083097506193809451365010723</span>,<span class="number">31775649089861428671057909076144152870796722528112580479442073365053916012507273433028451755436987054722496057749731758475958301164082755003195632005308493</span>,<span class="number">22246342022943432820696190444155665289928378653841172632283227888174495402248633061010615572642126584591103750338919213945646074833823905521643025879053949</span>,<span class="number">25395461142670631268156106136028325744393358436617528677967249347353524924655001151849544022201772500033280822372661344352607434738696051779095736547813043</span>,<span class="number">32056508892744184901289413287728039891303832311548608141088227876326753674154124775132776928481935378184756756785107540781632570295330486738268173167809047</span>,<span class="number">52849766269541827474228189428820648574162539595985395992261649809907435742263020551050064268890333392877173572811691599841253150460219986817964461970736553</span>,<span class="number">30415984800307578932946399987559088968355638354344823359397204419191241802721772499486615661699080998502439901585573950889047918537906687840725005496238621</span>]</span><br><span class="line">a_list=[<span class="number">7366067574741171461722065133242916080495505913663250330082747465383676893970411476550748394841437418105312353971095003424322679616940371123028982189502042</span>,<span class="number">21962825323300469151795920289886886562790942771546858500842179806566435767103803978885148772139305484319688249368999503784441507383476095946258011317951461</span>,<span class="number">6569689420274066957835983390583585286570087619048110141187700584193792695235405077811544355169290382357149374107076406086154103351897890793598997687053983</span>,<span class="number">4508246168044513518452493882713536390636741541551805821790338973797615971271867248584379813114125478195284692695928668946553625483179633266057122967547052</span>,<span class="number">22966105670291282335588843018244161552764486373117942865966904076191122337435542553276743938817686729554714315494818922753880198945897222422137268427611672</span>,<span class="number">17963313063405045742968136916219838352135561785389534381262979264585397896844470879023686508540355160998533122970239261072020689217153126649390825646712087</span>,<span class="number">1652417534709029450380570653973705320986117679597563873022683140800507482560482948310131540948227797045505390333146191586749269249548168247316404074014639</span>,<span class="number">15585771734488351039456631394040497759568679429510619219766191780807675361741859290490732451112648776648126779759368428205194684721516497026290981786239352</span>,<span class="number">8965123421637694050044216844523379163347478029124815032832813225050732558524239660648746284884140746788823681886010577342254841014594570067467905682359797</span>,<span class="number">13560945756543023008529388108446940847137853038437095244573035888531288577370829065666320069397898394848484847030321018915638381833935580958342719988978247</span>]</span><br><span class="line"></span><br><span class="line">m = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m_list:</span><br><span class="line">    m *= i</span><br><span class="line"></span><br><span class="line">result = Get_result(a_list)</span><br><span class="line">e = <span class="number">10</span></span><br><span class="line">m = gmpy2.iroot(result,e)</span><br><span class="line"><span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<h1 id="六、维纳攻击"><a href="#六、维纳攻击" class="headerlink" title="六、维纳攻击"></a>六、维纳攻击</h1><p>需要运用到连分数的知识，暂时没学，先搁在这里</p>
<p>分享一个题目和脚本</p>
<h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import random</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line"># 生成随机素数</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">m = &quot;flag&#123;20d6e2da95dcc1fa5f5432a436c4be18&#125;&quot;</span><br><span class="line"># 字符串转数字</span><br><span class="line">m = libnum.s2n(m)</span><br><span class="line">n = p * q</span><br><span class="line">phi_n = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line"># 计算d</span><br><span class="line">while True:</span><br><span class="line">    nbits = 1024</span><br><span class="line">    d = random.getrandbits(nbits // 4)</span><br><span class="line">    if (libnum.gcd(d, phi_n) == 1 and 36 * pow(d, 4) &lt; n):</span><br><span class="line">        break</span><br><span class="line"># 计算e</span><br><span class="line">e = libnum.invmod(d, phi_n)</span><br><span class="line"></span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算连分数</span></span><br><span class="line"><span class="string">    :param x: 分子</span></span><br><span class="line"><span class="string">    :param y: 分母</span></span><br><span class="line"><span class="string">    :return: 连分数列表</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算传入列表最后的渐进分数</span></span><br><span class="line"><span class="string">    :param cf: 连分数列表</span></span><br><span class="line"><span class="string">    :return: 该列表最后的渐近分数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        <span class="comment"># 这里的渐进分数分子分母要分开</span></span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pq</span>(<span class="params">a, b, c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;使用韦达定理解出pq，x^2−(p+q)∗x+pq=0</span></span><br><span class="line"><span class="string">    :param a:x^2的系数</span></span><br><span class="line"><span class="string">    :param b:x的系数</span></span><br><span class="line"><span class="string">    :param c:pq</span></span><br><span class="line"><span class="string">    :return:p，q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    par = gmpy2.isqrt(b * b - <span class="number">4</span> * a * c)</span><br><span class="line">    <span class="keyword">return</span> (-b + par) // (<span class="number">2</span> * a), (-b - par) // (<span class="number">2</span> * a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;计算列表所有的渐近分数</span></span><br><span class="line"><span class="string">    :param cf: 连分数列表</span></span><br><span class="line"><span class="string">    :return: 该列表所有的渐近分数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    :param e:</span></span><br><span class="line"><span class="string">    :param n:</span></span><br><span class="line"><span class="string">    :return: 私钥d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> k == <span class="number">0</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">        p, q = solve_pq(<span class="number">1</span>, n - phi + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">113881698992379349039968368927979997900777221951663104697020683691495129639829918739755194174063944178083527489820939138302751895652076620380510013941997706327553964127612610209509889011613768847759318892303231846117914554931459295347697888260576901354448014917692680573408654658384481284699735788978230690197</span></span><br><span class="line">e = <span class="number">39068960413447607023613035707248214114819409621234801785480423979473767995171860917209502861408393208940683687475760366491413173744775811644295874981290403938714121977201901942939425294427737703229098649131737380098596135730392902019429964095866394165971291108245774407908011073271822915371753470010435225545</span></span><br><span class="line">c = <span class="number">32897925577913728659288168937025744709859960639901500169867896018406263110205704273203287172003057450591000201857719871686024077615520906540631374442504017489026298422189715372129838501090730593164075113452055617571409044743698645392909829425374093273187125709095368164744188182156849031225036001381531504057</span></span><br><span class="line"></span><br><span class="line">d = wienerAttack(e, n)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(m).decode())</span><br></pre></td></tr></table></figure>



<h1 id="七、共享素数"><a href="#七、共享素数" class="headerlink" title="七、共享素数"></a>七、共享素数</h1><p>两个n有相同的因子</p>
<h2 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q1 = libnum.generate_prime(1024)</span><br><span class="line">q2 = libnum.generate_prime(1024)</span><br><span class="line">n1 = p * q1</span><br><span class="line">n2 = p * q2</span><br><span class="line">e = 65537</span><br><span class="line">c1 = pow(m, e, n1)</span><br><span class="line">c2 = pow(m, e, n2)</span><br><span class="line">print(&quot;n1=&quot;, n1)</span><br><span class="line">print(&quot;n2=&quot;, n2)</span><br><span class="line">print(&quot;c1=&quot;, c1)</span><br><span class="line">print(&quot;c2=&quot;, c2)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 =<span class="number">22036096414750333101406538757625812613248444424049684758772058140377463618250795867832853117902163257003301132932490853355450673043991381637053778653821758783435921283322439267628837074056789021611782010444749024512216306961829453158759193969454712080047205883631153040900193575534288719429526169135614695862857156639195562501217424283401364740789214390377624598500939079307163832197534297642842744345373413423859103414676878739674227554029537817890874031594311152843060524913028526429344172693584167398664817727426767686424415189580527939256633114120720308173788544194669684834369132677253418971615644691719536820433</span></span><br><span class="line">n2 =<span class="number">17251653165250011947306159769694143433212298910745609670733920118632739529605426957617875166211610794383631191273183964010346725508667657137931394653419082978603166138439632713627832321960586938891805262605225424775586397813147240201440036009395991700175612039074317131837185920131565272816639771739150718839592250080325774556601865770352479323350280393818365902570673799584200153846520860657815432981116910233453207519365604533077996449249223280685559491369393277114405166293011856168173778428700718404816038991911974902005969923746846815798515831172402122367026339135245751136695128279659872423027539333024854133659</span></span><br><span class="line">c1 =<span class="number">1408937404754902028814920445701404613476983383738408959873219805755187459225302977012340464647741276263048769176603562703588286152102079561897286480939341184453940846603761664643956274520695676061184610702912592321357240109665885587701906369214592438887065694062151546241739122722790261888290706296747328780758965559093085406877315628139811554345214347799361309288949307776501119359571116522001853935560023530705364795364624152061166945046882418058831567088890277747158775876953662285842999920594778445526224560016361787941610542255000514402493843548068271595134879195073239601085319795505131267697387692179944010772</span></span><br><span class="line">c2 =<span class="number">12175155463891225370775786368564999885751076529394005420368968241428058465831204925081389807872272508968531564921996276054143112205083003561546962102395368677755381589762565680900651699885381615975236663522025080384481537727180649424984636506390139648492522347366656322729441290553251505232488994951243521740296115895651926783520321289129993169836271218322014443396220481361007479796234525990954874013729001502984583162486353287639655447340498584591591009224750835072707121652727119580764546240945763088815277130694950594020142961659318737857067755125666395542079926757603295535345281657293981259718286213812909191174</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(n1,n2)</span><br><span class="line"><span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">    p = t</span><br><span class="line">    q = n1 // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c1,d,n1)))</span><br></pre></td></tr></table></figure>

<h2 id="例题2-1"><a href="#例题2-1" class="headerlink" title="例题2"></a>例题2</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m1 = libnum.s2n(flag[:21])</span><br><span class="line">m2 = libnum.s2n(flag[21:])</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q1 = libnum.generate_prime(1024)</span><br><span class="line">q2 = libnum.generate_prime(1024)</span><br><span class="line">n1 = p * q1</span><br><span class="line">n2 = p * q2</span><br><span class="line">e = 65537</span><br><span class="line">c1 = pow(m1, e, n1)</span><br><span class="line">c2 = pow(m2, e, n2)</span><br><span class="line">print(&quot;n1=&quot;, n1)</span><br><span class="line">print(&quot;n2=&quot;, n2)</span><br><span class="line">print(&quot;c1=&quot;, c1)</span><br><span class="line">print(&quot;c2=&quot;, c2)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 =<span class="number">18278456416897540360396258822757262982555755869670901090552498586949101988114819983049973792228149331753714211829150091366507963407709639602249698787433863615316934241223748268055507819756435927605756487582004688515855293842338007617018726192787272178786187989919650031295017445246608913808150370396832979736966944101019341527689214911779109999636349425823878126859829147994819384548777027669606291738366823809278767708461221830670665255418591083090040274616328116968600117656658246421927767060728182402210035045881818025673807969254883542917548511100917885959250620704515582518997559286168715792883861074220598943791</span></span><br><span class="line">n2 =<span class="number">14718281935692942246514344466960823739043788561815140598178699003630478731051901387468570752239748871701513260441416821474763710775757545770047001681689286764572928181308278425603577448081174829594272045737613383467853857541067932138008740271004046748970111915370497637083205151943216917589213000669827068183128735055853090146367442283033992973854093411154488547740107755082193303785575614939069343199774715111804373406251308943619862703275132627574605543897680349862262913772613627719842043981943797101165701793459771726617487555152346999588560213302046402911610106668235901710477454671759962352749028587857389680857</span></span><br><span class="line">c1 =<span class="number">14897512957877985291073451370997229971431611442234246383959378368138383843838602186764200234176467559404370286570662411222496252433014380640842874696486877004925614788148596161632851280090237300707166430170067495353446298066772402105814072501891920041154576728250668160351771877215919279860070607769304225631648712101695757447443748349446067746844910191804121935748134960309518439864721866967284850597357412411606643356342075119302860193616589493080428754805797969067310700610860435816047860794169521102300081676745004651672196010599021308459569165202732261338157558377669701207385936984772269758652310839805490426436</span></span><br><span class="line">c2 =<span class="number">8964679463182022749797829546680381147968492022695080270157954224365732346700186653596903802305955380468152204793914476872234000593338240036398422292867781937160592148807729413972520261014124973472761268000048797126209010105345911203497254239189500567762324829782091374108165308434410235044784878269559848498007708005049415987165881413527082350625816180534142506509426576438823347406737583570228393620002029592018404347050644682030278682484606748950839477932988072925403147456191170453590581297805161865533569937880834249663768378358974835993063581854638638010548705670806550267429609766941078881760115520503213998478</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(n1,n2)</span><br><span class="line"><span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">    p = t</span><br><span class="line">    q1 = n1 // p</span><br><span class="line">    q2 = n2 // p</span><br><span class="line">    d1 = gmpy2.invert(e,(p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">    d2 = gmpy2.invert(e,(p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c1,d1,n1))+long_to_bytes(<span class="built_in">pow</span>(c2,d2,n2)))</span><br></pre></td></tr></table></figure>

<h2 id="例题3"><a href="#例题3" class="headerlink" title="例题3"></a>例题3</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from flag import *</span><br><span class="line"></span><br><span class="line">n1 = 103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span><br><span class="line">n2 = 115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m, e, n1)</span><br><span class="line">c = pow(c, e, n2)</span><br><span class="line"></span><br><span class="line">print(&quot;c = %d&quot; % c)</span><br><span class="line"></span><br><span class="line"># output</span><br><span class="line"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>这题不同之处是在于，m进行了两次加密过程</strong></p>
<p><strong>解密两次就可以了，注意两次密钥</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 =<span class="number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span></span><br><span class="line">n2 =<span class="number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span></span><br><span class="line">c = <span class="number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(n1,n2)</span><br><span class="line"><span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">    p = t</span><br><span class="line">    q1 = n1 // p</span><br><span class="line">    q2 = n2 // p</span><br><span class="line">    d1 = gmpy2.invert(e,(p-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">    d2 = gmpy2.invert(e,(p-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d2,n2)</span><br><span class="line">    flag = <span class="built_in">pow</span>(m,d1,n1)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>

<h1 id="八、dp泄露"><a href="#八、dp泄露" class="headerlink" title="八、dp泄露"></a>八、dp泄露</h1><p>通过dp &#x3D; d % (p-1)，以及数论知识求解p</p>
<h2 id="原理推导"><a href="#原理推导" class="headerlink" title="原理推导"></a>原理推导</h2><p>$\because dp \equiv d \mod (p-1)$</p>
<p>左右同乘$e$得</p>
<p>$dp×e \equiv d×e \mod (p-1)$，则$d×e &#x3D; k_1(p-1) +dp×e$</p>
<p>又$\because d×e \equiv 1 \mod \phi(n)$，$\therefore d×e &#x3D; k_2(p-1)(q-1)+1$</p>
<p>$\therefore k_1(p-1)+dp×e &#x3D; k_2(p-1)(q-1)+1$</p>
<p>化简得</p>
<p>$dp×e &#x3D; (p-1)[k_2(q-1)-k_1]$+1</p>
<p>$\because dp &lt; p-1$，$\therefore 0&lt; k_2(q-1)-k_1&lt;e$</p>
<p>遍历$i \in (0,e)$的所有值，如果$dp×e-1$能够整除$i$则，我们可以求得$p-1$</p>
<h3 id="例题1-2"><a href="#例题1-2" class="headerlink" title="例题1"></a>例题1</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">print(&quot;d=&quot;,d)</span><br><span class="line">dp = d % (p - 1)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;dp=&quot;, dp)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">17954000555185130679232377513216924086370205717680723426279833171815673097846434355592747466782173529597978954062272371758852339605432963940809244445748900431763988392120156128524694217746804744076348205536430811607694098089294013508111154514184079159181563040241302764793111632189829652065825442796716027051750043654503172469553222784393034067341575558782690547449884992414106322578261286526556856377419622164651917718772498388922129465042492616904419638034789576380038341882418547113136903862482397767904921157094396562770484669239932933837196899640811033424030302285885080504355934919967693498648701839252087380477</span></span><br><span class="line">c = <span class="number">1808490145328726635638705291306162339133116115672167390186563455429486046847680827004544020052978814401354685508506555963361065725012891622174617670820924531959433674273579973778657669162210657120785539629874456938159379512635932223403818177582242406964621317531188027900758868453176575753681627336133481701182056262584118645398172089436811174776978418919803975809158758707062473122656821152108292060156091196577573172937093806159669057467094718771367509856968694209472630329096814023864642219783061245777457366202879949123915168571990229277326042767587009623951348541055835347386485900505749475571895673653225741649</span></span><br><span class="line">dp =<span class="number">114993440308125678369350484461242628405806013372930792337329972720600942891053460367721272956155528263465552939386621554396883112994907299126303463171544968629898544811159986442249990975328659373544491636958873255689808151391606942912468529923159009459712396428051292828093059494024457367637991626193487727331</span></span><br><span class="line">e =<span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    t = (dp * e - <span class="number">1</span>) % i        <span class="comment">#这是p-1前面的系数</span></span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">        p = (dp * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">            q = n // p</span><br><span class="line">            d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

<p>这里可以用m &#x3D; pow(c,dp,p)求解</p>
<h3 id="例题2-e很大"><a href="#例题2-e很大" class="headerlink" title="例题2 e很大"></a>例题2 e很大</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">e = libnum.generate_prime(128)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"></span><br><span class="line">dp = d % (p - 1)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;dp=&quot;, dp)</span><br></pre></td></tr></table></figure>

<p>$\because dp ×e &#x3D; k(p-1)+1$，$\therefore dp ×e \equiv 1 \mod (p-1)$</p>
<p>假如存在与$p$互素的常数$a$</p>
<p>则$a^{dp×e} \mod p \equiv a^{k(p-1)+1} \mod p \equiv a \mod p$</p>
<p>$\therefore a^{dp×e}-a &#x3D;kp$</p>
<p>同时模n得$a^{dp×e}  - a \equiv kp \mod n$</p>
<p><strong>思路：通过求kp和n的公因数得到p</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">18150086749964030204952772593650655354407282168407543480518017821905322058792108409169209539752974177937328703466169798097779231540410352308736251888449285307132274903811942187361234788236374036493935354342502760429195828731474432692281516115002087485890105917067613983079156790015275611914738187418424730456416770000646598861170179898016595068557049151791620868027603590052357726580431487083778514163249201637184318559165989454489485258667170883129099757366657203826319909509544670881866298317938263281638296241860739828567999093491297970389142395080780768892194380031018324855383292685388767246393785705551231780899</span></span><br><span class="line">e= <span class="number">278817530653170259039233683650169866189</span></span><br><span class="line">c= <span class="number">10813189255953686674328168562592345253502176950586624384555229875947895107088800774325110599057171743065073092283651992594106863499561887773348061509184951920329015539552207920010924284253109754443530283215130327152416667309504455641730629770856098336299767661535526880065006664806270833698497579073641076473649621250873969544362062393319711114090739414415757921473984666129110213417578310035188480139392986280529932137364474426391469019554935239234968517869914506321750458197587849623935306068749435995413807906558975073047215241796461878288003366415184144140612947217041288538376514085070670565572628317388808356563</span></span><br><span class="line">dp= <span class="number">25015362092988139281045705051525732988903355826221062953430054346210238749256645995431509510448988062597830708438496723137288693056422683942336451600173722142331077900759633024803467824277121463213906905346623305038031660927650043841899168305106293747254814365869018331032172781810238397508103692878400636333</span></span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(<span class="built_in">pow</span>(a,dp*e,n)-a,n)    <span class="comment">#pow(a,dp*e,n)-a 就是kp</span></span><br><span class="line">m = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><strong>用两个密钥对都可以解出m</strong></p>
<h3 id="例题3-n未知"><a href="#例题3-n未知" class="headerlink" title="例题3 n未知"></a>例题3 n未知</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnu</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">dp = d % (p - 1)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;dp=&quot;, dp)</span><br></pre></td></tr></table></figure>

<p>求出p之后用dp,e这对密钥解密即可</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,isPrime</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">698357636567367558759711776580320719340933493084285009370699059680075963885649900991785743925476703612566177770615688140828294009342321248532528135717020321638633194236304071227376280469583784324554702187585633554583585613919643029910676079881346779693579198709927276845742333575135345002140882285105432861360786403309179432637837990636999378777874170745714808407518959616602571033295952904233401306613241319072606171376709797219789705532196258388768707986490052624356816398378517468828951464911099476954775258801172030116252779985789332801046195134582313214031366595004401717278610760829369314324849813940651309932</span></span><br><span class="line">dp = <span class="number">39896852438403708406984708916869979312352695661766157959550782921308613421683803903733849015989522374917508903612147241162520188920032456104881051889798874994032331870256031918606780154667124231064537682553043210245224684753512501513527050047942923719661361311254494006713834823643497048108777333495847434963</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">    <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % i == <span class="number">0</span>:</span><br><span class="line">        p = (dp * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            m = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h4 id="关于m-pow-c-dp-p-的证明"><a href="#关于m-pow-c-dp-p-的证明" class="headerlink" title="关于m &#x3D; pow(c,dp,p)的证明"></a>关于m &#x3D; pow(c,dp,p)的证明</h4><p>关于用dp和e也能解密做一个证明：</p>
<p><img src="/../../images/RSA/13.png"><br>$$<br>即c^{dp}(mod \quad p)&#x3D;m<br>$$</p>
<h1 id="九、dp-dq泄露"><a href="#九、dp-dq泄露" class="headerlink" title="九、dp,dq泄露"></a>九、dp,dq泄露</h1><h2 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h2><p>该题型的前提是m&lt;p，m&lt;q</p>
<h2 id="原理推导-1"><a href="#原理推导-1" class="headerlink" title="原理推导"></a>原理推导</h2><p><img src="/../../images/RSA/14.png"><br>$$<br>\therefore m &#x3D; [((m_{2}-m_{1})×p^{-1}(mod \quad q))×p+m_{1}](mod \quad n)<br>$$</p>
<p>接下来的问题是如何通过dp,dq求m1,m2</p>
<p><img src="/../../images/RSA/15.png"></p>
<p><strong>归纳一下所得条件</strong></p>
<p><img src="/../../images/RSA/16.png"></p>
<p>接下来就是写代码了</p>
<h3 id="例题1-3"><a href="#例题1-3" class="headerlink" title="例题1"></a>例题1</h3><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(256)</span><br><span class="line">q = libnum.generate_prime(256)</span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">print(&quot;d=&quot;, d)</span><br><span class="line">dp = d % (p - 1)</span><br><span class="line">dq = d % (q - 1)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">print(&quot;p=&quot;, p)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;dp=&quot;, dp)</span><br><span class="line">print(&quot;dq=&quot;, dq)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">112454994630978850005784651276022327545786198205744597431888680937657203192943</span></span><br><span class="line">q = <span class="number">111081771780978300442208201256251933100607227308819156491182881723714968913833</span></span><br><span class="line">c = <span class="number">7847140580627012782899798457736961376953768684667159008470556786390887805253326211691923724846808704462396746105331991924048819814322540306282164012066426</span></span><br><span class="line">dp = <span class="number">99016059099144522019375365089687785694029213535292918424815544402513220169503</span></span><br><span class="line">dq = <span class="number">79504900574184798493105575420403885224379864982754477219462523963780735261625</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c,dp,p)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c,dq,q)</span><br><span class="line">P = gmpy2.invert(p,q)               <span class="comment">#p的逆元</span></span><br><span class="line">m = ((((m2-m1)*P)%q)*p+m1)%n</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><strong>关于m &#x3D; pow(c,dp,p)的条件是m&lt;p</strong></p>
<h1 id="十、n为p的r次方"><a href="#十、n为p的r次方" class="headerlink" title="十、n为p的r次方"></a>十、n为p的r次方</h1><p>当题型中n可以分解为一个素数的r次方，此时的欧拉函数有以下算法：</p>
<p>当$n &#x3D; p^{k}$，有$\phi(n) &#x3D; p^{k}-p^{k-1}$</p>
<h2 id="例题1-4"><a href="#例题1-4" class="headerlink" title="例题1"></a>例题1</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">n = p ** 5</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">109671394618534156590716540772306636060550711465455829526382945168271125218007503161807386153286648328529071790130095763349089936429151343426469415497138306284842512691195220650548494501337831207724397925027651025644976364368511262187227825083865690186591571250267479440100917127211656877566179258870510690665025580200477574123634259670039152125607834855408269848826938902407472374892693266119859709658788565014195766992713646832624001067898323913639712284673673557898135411273837250194079399384826384835709060797351332323930309379071015140548478132323474993964925055399350661600068568602468295748573856804293659942047543032878436316918991716636681116631322082919386178460096115355963882313682994343822128626370850455024905542367255179074441679461101331332093019368492643</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">83166081100602571613112201467626632459949037182633475449066025299006894059443612622701975752551708249083077180755342065457682925338233793688583913228361068561515321097016501900442865692643652803949920987493441500744743553498018003210308290969303190355756775977367324120441564693220728163622472865572357639056734898022442794130514936425334924283145153496702507951466618177405870656868713199816223765264228006032228439676574053839549440372521050502986043855511540855864034336902304414848547480112182226920285820386643015671106933140105835060319823245206934565859078021518312305243997612804935774414840491355098017977514736057368000596388974956265042651277403519473262257945986199408278855335170546242641727930526697102351648388874227840119205560199015181257296591985205818</span></span><br><span class="line">p = <span class="number">10186351850605898834333098258639828910824016865517013383611935945131883947448223014077315468253377357594775340263769153442019216205089695821439736926082483</span></span><br><span class="line"></span><br><span class="line">phi = p**<span class="number">5</span>-p**<span class="number">4</span></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

<h2 id="例题2-2"><a href="#例题2-2" class="headerlink" title="例题2"></a>例题2</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">n = p ** 3 * q</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br></pre></td></tr></table></figure>

<p>$\because n &#x3D; p^{3}×q$</p>
<p>$\therefore \phi(n) &#x3D; (p^{3}-p^{2})×(q-1)$</p>
<p><strong>exp:</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">q = <span class="number">13345672330679418443866848695749753384841350112452462690350565885192764753702964893062035116023096943358384379827500462723016224486435032522188166109529147</span></span><br><span class="line">n = <span class="number">4663711063632671446966617442890809468548735750386480905820144168615122369358088158709822723959108989276525102755551604204514586528122441075489492157644479194671784485228731421500391142158401889177506319977349707503678947872777602384171260874359045585814189677748712566088220734735479518470883541166059233676170283938881683675790979128058243582825012415020019043126740915522571217495119060031729061070896580899732991209113679151755713858497630999746612658308778711613697038750661479517187094033129979714688161348844542070263109259258937863241431480105798790363889436471998002323269704182369356300287043940743500087239</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">4050303218893912343776312253598257474375000778822229482734626960955864773175090306426885201033332266573903303684635688485414725284644108123459136702775991157244389086147955395682206311752151842740679445903864544823592773331496589661187968392779340028173948172003460012051289357755574536619241969492822938688821287700132262703677149526846356206143053559703859606442209340834979412336031660590507709503830013770022485005101363701272279629510056964018618212014677531338026866748075406283893942248599825641124694672878533987994699411744521757385858889763503705242690212615083634186373933214686193717950163215308138805348</span></span><br><span class="line"></span><br><span class="line">p = n // q </span><br><span class="line">phi = (p**<span class="number">3</span>-p**<span class="number">2</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>



<h1 id="十一、n分解为3个素数"><a href="#十一、n分解为3个素数" class="headerlink" title="十一、n分解为3个素数"></a>十一、n分解为3个素数</h1><h2 id="例题1-5"><a href="#例题1-5" class="headerlink" title="例题1"></a>例题1</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">r = libnum.generate_prime(512)</span><br><span class="line">n = p * q * r</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;r=&quot;, r)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line"></span><br><span class="line">r = 12328943069972158868300333965019293732240349172933398867374450193780676916633106046545397891902123683693837126404908611670219604587587151306224914062663729</span><br><span class="line">n = 928445951911850156618541782850215900925329423880533465612155142015978599609287623859912813317551629221695490535012732781489396534420011145723987610606038091488823086647363964394753700158320900867101659445170118179077194271099520502633316318889163873291574934282498061117736456183503867870294570083013883365868242889035609602940685335912371326827533418614992221705810476710807373254363162373986374486325350746366851935451369892949745302442034805629514003196071631</span><br><span class="line">e = 65537</span><br><span class="line">c = 327716655224470059950709685055600963837116578216483343492948888372401723689223347212508532985781828794786448842515029515358422017875793926582832247025212149474404973170422295165602666360784347416812528617973764432916955654602356835327769633635513894485943553309743509322858937973710628023758816806471875016815994664897320150855163109437521642800230902661034555151514311149333258071668655344069451897282357234220538922127548822361859943829665459953651351620958628</span><br></pre></td></tr></table></figure>

<p>$\phi(n)&#x3D;(p-1)×(q-1)×(r-1)$</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">r = <span class="number">12328943069972158868300333965019293732240349172933398867374450193780676916633106046545397891902123683693837126404908611670219604587587151306224914062663729</span></span><br><span class="line">n = <span class="number">928445951911850156618541782850215900925329423880533465612155142015978599609287623859912813317551629221695490535012732781489396534420011145723987610606038091488823086647363964394753700158320900867101659445170118179077194271099520502633316318889163873291574934282498061117736456183503867870294570083013883365868242889035609602940685335912371326827533418614992221705810476710807373254363162373986374486325350746366851935451369892949745302442034805629514003196071631</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">327716655224470059950709685055600963837116578216483343492948888372401723689223347212508532985781828794786448842515029515358422017875793926582832247025212149474404973170422295165602666360784347416812528617973764432916955654602356835327769633635513894485943553309743509322858937973710628023758816806471875016815994664897320150855163109437521642800230902661034555151514311149333258071668655344069451897282357234220538922127548822361859943829665459953651351620958628</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.iroot(n//r,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = gmpy2.next_prime(t)</span><br><span class="line">q = n // p // r</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

<h2 id="例题2-3"><a href="#例题2-3" class="headerlink" title="例题2"></a>例题2</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">r = libnum.generate_prime(512)</span><br><span class="line">z = libnum.generate_prime(512)</span><br><span class="line">n = p * q * r * z</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;p=&quot;, p)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;r=&quot;, r)</span><br><span class="line">print(&quot;z=&quot;, z)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br></pre></td></tr></table></figure>

<p>$\phi(n) &#x3D; (p-1)×(q-1)×(r-1)×(z-1)$</p>
<p><strong>exp:</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">12213843677002747766848780813863444765635042481765413051856941866086491788109497010943473273572566841660085356963998380859972440509623320585264570870882377</span></span><br><span class="line">q = <span class="number">10902490082251495426199569292732505400137675709524837939357515262329540011464655744129250363907196869656418112808846020897118146863902562367003327272321449</span></span><br><span class="line">r = <span class="number">8245419815086573989912567235897662412607561235885604814025447500079491044202192595152864571279969681042912188605024753854047024662013720379103778526236839</span></span><br><span class="line">z = <span class="number">10917615097508699827805276639030692194611453656058695332553958067645900726083779376328239937088149850336439698089338637703951122165530113430740915375254019</span></span><br><span class="line">n = <span class="number">11987223678888371522590014163574474585984194442215707213681942674682481521159615601278963653710214413966851484769697316184020225580354584969280759516304518930586023758786499707314773352093733555751516210440026493115763715594030219348717378054713330562469489929071833023251985410432681379225722515249114768069799538178471227684886585818611193385720863927599686403372685979041786980765941581357531078866173940675302211156740624961660458364870744891267336542629860728676639340370300143607766541999848139604816244471035977632825191833661785202909345705598016303539579822007932773115520022154167375759849411486420750385893</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">5395740155304669350813446148984001089577243830507792794817942379567952891169689187159605803584012696669416468262913205072505580096612689488031607303556309165510626352159994870224831746393515302036056276128780176510345937509694407306122459125905753373646070294254525528004397615098037040212875934172270348504386498501381675335673389883548268757941289932688918632949813634383348968682753785403890857910581199432899158400152800186245499719012819119582095532181336705889412130586102740186044306846473639210373743145249675886413163898094394917296889841622782268580482112735272818555859742460277831777444758731534129950815</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)*(z-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br></pre></td></tr></table></figure>

<h1 id="十二、e-和phi-n-不互素"><a href="#十二、e-和phi-n-不互素" class="headerlink" title="十二、e 和phi_n 不互素"></a>十二、e 和phi_n 不互素</h1><p>当$e$与$\phi(n)$不互素时，则不存在模$\phi(n)$的逆元$d$使得$ed \equiv 1(mod \quad \phi(n))$</p>
<h2 id="情况处理方式1："><a href="#情况处理方式1：" class="headerlink" title="情况处理方式1："></a>情况处理方式1：</h2><p>令$t &#x3D; gcd(e,\phi(n))$</p>
<p>设$e &#x3D; e’×t$，则$e’ &#x3D; \frac{e}{t}$</p>
<p>则$c \equiv m^e \mod n \longrightarrow c \equiv (m ^t)^{e’} \mod n$</p>
<p>求$e’$对应的$d$，解出$m^t \equiv c^d \mod n$</p>
<p>在$m^t &lt; n$的情况下开根即可获得$m$</p>
<h3 id="例题1-常规"><a href="#例题1-常规" class="headerlink" title="例题1 常规"></a>例题1 常规</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import random</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">while 1:</span><br><span class="line">    e = random.randint(100, 1000)</span><br><span class="line">    p = libnum.generate_prime(1024)</span><br><span class="line">    q = libnum.generate_prime(1024)</span><br><span class="line">    phi_n = (p - 1) * (q - 1)</span><br><span class="line">    t = gmpy2.gcd(e, phi_n)</span><br><span class="line">    if t == e:</span><br><span class="line">        continue</span><br><span class="line">    t1 = e // t</span><br><span class="line">    if gmpy2.invert(t1, phi_n) and t &gt; 1:</span><br><span class="line">        break</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;p=&quot;, p)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">171854505164939390402295426493389586289972154851849140728417624619463988154808053805729538974688869671559032639921300088271234681410193379381085714252211392886408792711387524667824537369266846649573070209815436507363007636943912350208275895292853801665488228125846058987049326903498661007035974420392738723323</span></span><br><span class="line">q = <span class="number">145951936627745243523384785325963094339728144811023266133546816860787405503371056873662508073284279180417626507724315776654624382665743082805910036891739754019932290977071276850239245644056698685966997752654383650764557358649666141576105936215709831181842086893228254304235678475375978464394818353375373451573</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">830</span></span><br><span class="line">c= <span class="number">4413268199893347044741276120215584703428167052744516280494996526431559720190092261631829389527634625276020346166956540800884139234489942113764564139232948414263452549927818365096023041932432723988241639527832673120924732407691135173154085803338322715604275530735968992726708155724384432557207264839248502158712330572704509492520346044648676055223193900826626346707083590815897507927683083455678855000344499804465073698745769989966769567497677402668725931090596642504740789789740965769347050166069295727209131555338513809368814890255851742010120871635378654904140016065148709710206173069000137023824698858539843753921</span></span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">t = gmpy2.gcd(e,phi)</span><br><span class="line"><span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">    <span class="built_in">print</span>(t)</span><br><span class="line">    e1 = e // t</span><br><span class="line">    d = gmpy2.invert(e1,phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(m,t)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<h3 id="例题2-已知lcm-p-1-q-1"><a href="#例题2-已知lcm-p-1-q-1" class="headerlink" title="例题2 已知lcm((p-1),(q-1))"></a>例题2 已知lcm((p-1),(q-1))</h3><p>两个不为$0$的整数$p,q$有以下性质：</p>
<p>$p×q &#x3D; gcd(p,q)×lcm(p,q)$</p>
<p>即两个数的乘积为他们最小公倍数和最大公约数的乘积</p>
<p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line"># print(flag)</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">n=p*q</span><br><span class="line">hint = gmpy2.lcm(p - 1 , q - 1)</span><br><span class="line">e=54722</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;hint=&quot;,hint)</span><br></pre></td></tr></table></figure>

<p>这道题已知$(p-1)$和$(q-1)$的最小公倍数，我们只要知道最大公约数就能求得$\phi(n)$即</p>
<p>首先$lcm((p-1),(q-1))$为$1021bit$，$n&#x3D;1024bit$，这说明$gcd((p-1),(q-1))$只有$3bit$</p>
<p>所以$gcd((p-1),(q-1))$的数值在$[4,8)$之间，只有几位，可以爆破得到$\phi(n)$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">hint = <span class="number">12176993678498230245546088277872780304938463326256069551378199465489519085975397931056456171244584591828814093149962580899089636705985786379467779463476493219517172984909297814745438140651274778256117288586982848108213932163133817644505376344716130049020474232954521634539644016004694898461955741388897934560</span></span><br><span class="line">n = <span class="number">121769936784982302455460882778727803049384633262560695513781994654895190859753979310564561712445845918288140931499625808990896367059857863794677794634764954265917223929188027566735170858722793015537480829986990608756383815655534511937235703892950567493911917178761554143379884176240162037489989420552078127671</span></span><br><span class="line">e = <span class="number">54722</span></span><br><span class="line">c= <span class="number">68207327189131286430765764525947832439888346002213816928140706886898558628392596589715994944626609815778649728495478844245774029669442060829925589118748033844002399193350339069964179052517763638951854264605935062729791334189169468172816314672207667470048850163934061677572210757247460567864055270415151846298</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">8</span>):</span><br><span class="line">    phi = hint*h</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = gmpy2.invert(e,phi)</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            t = gmpy2.gcd(e,phi)</span><br><span class="line">            <span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">                e1 = e // t</span><br><span class="line">                d = gmpy2.invert(e1,phi)</span><br><span class="line">                mt = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">                m = gmpy2.iroot(mt,t)[<span class="number">0</span>]</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>第二种解题：$k\phi(n)$当$\phi(n)$使用</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">hint = <span class="number">12176993678498230245546088277872780304938463326256069551378199465489519085975397931056456171244584591828814093149962580899089636705985786379467779463476493219517172984909297814745438140651274778256117288586982848108213932163133817644505376344716130049020474232954521634539644016004694898461955741388897934560</span></span><br><span class="line">n = <span class="number">121769936784982302455460882778727803049384633262560695513781994654895190859753979310564561712445845918288140931499625808990896367059857863794677794634764954265917223929188027566735170858722793015537480829986990608756383815655534511937235703892950567493911917178761554143379884176240162037489989420552078127671</span></span><br><span class="line">e = <span class="number">54722</span></span><br><span class="line">c= <span class="number">68207327189131286430765764525947832439888346002213816928140706886898558628392596589715994944626609815778649728495478844245774029669442060829925589118748033844002399193350339069964179052517763638951854264605935062729791334189169468172816314672207667470048850163934061677572210757247460567864055270415151846298</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    d = gmpy2.invert(e,hint)</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    t = gmpy2.gcd(e,hint)</span><br><span class="line">    e1 = e // t</span><br><span class="line">    d = gmpy2.invert(e1,hint)</span><br><span class="line">    mt = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    m = gmpy2.iroot(mt,t)</span><br><span class="line">    <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<p>如果$ed \equiv 1 \mod k\phi(n)$</p>
<p>$m \equiv c^d \mod n \longrightarrow m \equiv m^{ed} \mod n \longrightarrow m \equiv m^{k_1×k\phi(n)+1} \mod n$</p>
<p>由费马定理得</p>
<p>$m \equiv (m^{\phi(n)})^{k_1×k}×m \mod n \longrightarrow m \equiv 1×m \mod n \longrightarrow m \equiv m \mod n$</p>
<p>所以$k\phi(n)$当作$\phi(n)$使用是正确的</p>
<p>不过，如果$k\phi(n)$小于$\phi(n)$的话，在一定范围中是可以代替$\phi(n)$的</p>
<h2 id="情况2：用中国剩余定理"><a href="#情况2：用中国剩余定理" class="headerlink" title="情况2：用中国剩余定理"></a>情况2：用中国剩余定理</h2><p>$$<br>如果m^{t}&gt;n，需要用到中国剩余定理<br>$$</p>
<h3 id="2022ctfshow卷王杯"><a href="#2022ctfshow卷王杯" class="headerlink" title="2022ctfshow卷王杯"></a>2022ctfshow卷王杯</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long</span><br><span class="line">from secrets import p,q,r,s,t,flag</span><br><span class="line"></span><br><span class="line">n = p * q * r * s * t</span><br><span class="line">e = 2</span><br><span class="line">m = bytes_to_long(os.urandom(500) + flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(p,q,r,s,t,sep=&#x27;\n&#x27;)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">145332367700944303747548912160113939198078051436029477960348968315913956664143693347226702600438608693933768134575289286283267810723137895903153829001826223446477799895493265422562348917012216790077395795861238257357035152687833639085415763850743538206986781418939737511715957738982536382066693822159860701263</span><br><span class="line">116660458253067608044065523310547233337730583902133756095473339390057738510707447906971188577217274861047379404014140178165569604404468897712846876108444468370709141219302291601408652742006268186059762087155933131837323952675627966299810891805398890428420575425160696531236660480933905879208166090591482794763</span><br><span class="line">157931722402853245421436270609912823260313730941283152856444641969403238646482562190531038393124087232554754746464603598717356255570166081501573727336977292059427220330169044611674973569766966838498453232642731737958791706086957762244686953294662693939604300864961637325536379321027705854708492453330690705531</span><br><span class="line">100973451687449518854742673778783266158999451072058606348222018797891147675959983616210003484476577612134482311993701677242007759556951494382833070563369964294544839433671087037596159753825249018950693369209927951667775267086896180395776150188902057785214767230658487267587289809918132337927575673868568976679</span><br><span class="line">93960345071948255233882121683650797512129333868351496468898834736770441398743300745703393838320587998953678254272245400344928586394089488734271897540051673996675973642347859306921527430850673334243441180183460927865980713929789963587608547554858491264614271309608925634272282292964002897650355047792764365447</span><br><span class="line">9144597920381774885442906257311149465702295057238600973973598305004391534618770363098565074541384771979931799878381439264848137810353858418200992191234142740194489573540381681161219332611454834544291634628456257670178843484698324641739324687497388018406214041657278323855749902661752448796122517061920880552011343608609622885787617238758769398972009949575526258430282648817039091284796330585349957724522615105102735930258969562103112238020133587096826386028128471852377225525357348919204333121695432662339443004327748973224423132988376298843862056631045488285859621661802413201793962883794915513510467912312842687601478117040419013468059983777273699192408773551806581458197324620065210523913467414181480875280203580147077789063808832356486197271376615883221558265591069223727607585313240243619515521180600435114131162272519949101464089935441251751426683447701142156416866113627126765919641034042927519834229168536331952275698122511502745177547569813354280565828372968703810158857859460406828090199683324760956105682902577189283246483314689365570862217407333103243336691401424548702387876409228977278498691200028282744239512091373110111792177228979867318546462714521296256938374618636206565791541769138267080789842400796973226733816939794717596194090232425688504890234304977612220790858557639246367437740975495450011676714198668471438814299689325208882261918460708833888406187912527346628912894921059735420931656953236560178909180587372589456926690219114173193202048332172538564489660440225377822914097420807957784201785024166011709377791129</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>看似白给，其实$e$和$\phi(n)$不互素</p>
<p>而且在flag前面填充了一些数据，导致$m^e &gt; n$，所以直接开根号也不可取</p>
<p><strong>看到e&#x3D;2，应该是类似rabin，一般的rabin是两个素数，这里有5个，说明会有32个解</strong></p>
<p><img src="/../../images/RSA/19.png"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sympy.ntheory.modular import crt</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p = 145332367700944303747548912160113939198078051436029477960348968315913956664143693347226702600438608693933768134575289286283267810723137895903153829001826223446477799895493265422562348917012216790077395795861238257357035152687833639085415763850743538206986781418939737511715957738982536382066693822159860701263</span><br><span class="line">q = 116660458253067608044065523310547233337730583902133756095473339390057738510707447906971188577217274861047379404014140178165569604404468897712846876108444468370709141219302291601408652742006268186059762087155933131837323952675627966299810891805398890428420575425160696531236660480933905879208166090591482794763</span><br><span class="line">r = 157931722402853245421436270609912823260313730941283152856444641969403238646482562190531038393124087232554754746464603598717356255570166081501573727336977292059427220330169044611674973569766966838498453232642731737958791706086957762244686953294662693939604300864961637325536379321027705854708492453330690705531</span><br><span class="line">s = 100973451687449518854742673778783266158999451072058606348222018797891147675959983616210003484476577612134482311993701677242007759556951494382833070563369964294544839433671087037596159753825249018950693369209927951667775267086896180395776150188902057785214767230658487267587289809918132337927575673868568976679</span><br><span class="line">t = 93960345071948255233882121683650797512129333868351496468898834736770441398743300745703393838320587998953678254272245400344928586394089488734271897540051673996675973642347859306921527430850673334243441180183460927865980713929789963587608547554858491264614271309608925634272282292964002897650355047792764365447</span><br><span class="line">c = 9144597920381774885442906257311149465702295057238600973973598305004391534618770363098565074541384771979931799878381439264848137810353858418200992191234142740194489573540381681161219332611454834544291634628456257670178843484698324641739324687497388018406214041657278323855749902661752448796122517061920880552011343608609622885787617238758769398972009949575526258430282648817039091284796330585349957724522615105102735930258969562103112238020133587096826386028128471852377225525357348919204333121695432662339443004327748973224423132988376298843862056631045488285859621661802413201793962883794915513510467912312842687601478117040419013468059983777273699192408773551806581458197324620065210523913467414181480875280203580147077789063808832356486197271376615883221558265591069223727607585313240243619515521180600435114131162272519949101464089935441251751426683447701142156416866113627126765919641034042927519834229168536331952275698122511502745177547569813354280565828372968703810158857859460406828090199683324760956105682902577189283246483314689365570862217407333103243336691401424548702387876409228977278498691200028282744239512091373110111792177228979867318546462714521296256938374618636206565791541769138267080789842400796973226733816939794717596194090232425688504890234304977612220790858557639246367437740975495450011676714198668471438814299689325208882261918460708833888406187912527346628912894921059735420931656953236560178909180587372589456926690219114173193202048332172538564489660440225377822914097420807957784201785024166011709377791129</span><br><span class="line">e = 2</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res1 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">f = x^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res2 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(r))</span><br><span class="line">f = x^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res3 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(s))</span><br><span class="line">f = x^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res4 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(t))</span><br><span class="line">f = x^e - c</span><br><span class="line">f = f.monic()</span><br><span class="line">res5 = f.roots()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in res1:</span><br><span class="line">    for j in res2:</span><br><span class="line">        for k in res3:</span><br><span class="line">            for a in res4:</span><br><span class="line">                for b in res5:</span><br><span class="line">                    m_list = [int(i[0]),int(j[0]),int(k[0]),int(a[0]),int(b[0])]</span><br><span class="line">                    a_list= [p,q,r,s,t]</span><br><span class="line">                    solve = CRT_list(m_list,a_list)</span><br><span class="line">                    flag = long_to_bytes(solve)</span><br><span class="line">                    if b&#x27;ctfshow&#x27; in flag:</span><br><span class="line">                    	print(flag)</span><br><span class="line"># ctfshow&#123;D0_y0u_R3aLly_Kn0w_Ra8IN_alg0RI7HM?&#125;</span><br></pre></td></tr></table></figure>

<p>需要遍历$res1——res5$的所有组合</p>
<h3 id="2018高校运维挑战赛AzureRSA"><a href="#2018高校运维挑战赛AzureRSA" class="headerlink" title="2018高校运维挑战赛AzureRSA"></a>2018高校运维挑战赛AzureRSA</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">n1=0xcfc59d54b4b2e9ab1b5d90920ae88f430d39fee60d18dddbc623d15aae645e4e50db1c07a02d472b2eebb075a547618e1154a15b1657fbf66ed7e714d23ac70bdfba4c809bbb1e27687163cb09258a07ab2533568192e29a3b8e31a5de886050b28b3ed58e81952487714dd7ae012708db30eaf007620cdeb34f150836a4b723L</span><br><span class="line">e1=0xfae3aL</span><br><span class="line">c1=0x81523a330fb15125b6184e4461dadac7601340960840c5213b67a788c84aecfcdc3caf0bf3e27e4c95bb3c154db7055376981972b1565c22c100c47f3fa1dd2994e56090067b4e66f1c3905f9f780145cdf8d0fea88a45bae5113da37c8879c9cdb8ee9a55892bac3bae11fbbabcba0626163d0e2e12c04d99f4eeba5071cbeaL</span><br><span class="line">n2=0xd45304b186dc82e40bd387afc831c32a4c7ba514a64ae051b62f483f27951065a6a04a030d285bdc1cb457b24c2f8701f574094d46d8de37b5a6d55356d1d368b89e16fa71b6603bd037c7f329a3096ce903937bb0c4f112a678c88fd5d84016f745b8281aea8fd5bcc28b68c293e4ef4a62a62e478a8b6cd46f3da73fa34c63L</span><br><span class="line">e2=0x1f9eaeL</span><br><span class="line">c2=0x4d7ceaadf5e662ab2e0149a8d18a4777b4cd4a7712ab825cf913206c325e6abb88954ebc37b2bda19aed16c5938ac43f43966e96a86913129e38c853ecd4ebc89e806f823ffb802e3ddef0ac6c5ba078d3983393a91cd7a1b59660d47d2045c03ff529c341f3ed994235a68c57f8195f75d61fc8cac37e936d9a6b75c4bd2347L</span><br><span class="line">assert pow(flag,e1,n1)==c1</span><br><span class="line">assert pow(flag,e2,n2)==c2</span><br><span class="line">assert gcd(e1,(p1-1)*(q1-1))==14</span><br><span class="line">assert gcd(e2,(p2-1)*(q2-1))==14</span><br></pre></td></tr></table></figure>

<p>有别于上题，这道题两个e和phi都不互素</p>
<p>设$e$和$\phi(n)$的公因数为$t$，则$e &#x3D; e’t$，$e’ &#x3D; \frac{e}{t}$，有$e’d \equiv 1 \mod \phi(n)$</p>
<p>$\therefore m^t \equiv c^d \mod n$</p>
<p>如果$t$不大的话，我们可以直接开根求得$m$，但是这题$t&#x3D;14$，所以我们考虑用中国剩余定理</p>
<p>于是我们有</p>
<p><img src="/../../images/RSA/45.png"></p>
<p>用中国剩余定理解出其特解$res$，即$res \equiv m^{14} \mod lcm(n_1,n_2) \longrightarrow res \equiv m^{14} \mod pq_1q_2$</p>
<p>把它当作一个$e&#x3D;14$的RSA加密</p>
<p>然后重新走一遍上一步的过程，发现还是没解出来</p>
<p>看了大佬的思路是把模数换成$q_1q_2$，即$res \equiv m^{14} \mod q_1q_2$</p>
<p>$res &#x3D; m^{14} + kpq_1q_2$，两边同时模$q_1q_2$，得$res \equiv m^{14} \mod q_1q_2$</p>
<p>换完模数之后对应的$phi &#x3D; (q_1-1)(q_2-1)$</p>
<p>然后发现$e&#x3D;14$和$phi$依旧存在公因数，再套用第一步即可</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n1=0xcfc59d54b4b2e9ab1b5d90920ae88f430d39fee60d18dddbc623d15aae645e4e50db1c07a02d472b2eebb075a547618e1154a15b1657fbf66ed7e714d23ac70bdfba4c809bbb1e27687163cb09258a07ab2533568192e29a3b8e31a5de886050b28b3ed58e81952487714dd7ae012708db30eaf007620cdeb34f150836a4b723L</span><br><span class="line">e1=0xfae3aL</span><br><span class="line">c1=0x81523a330fb15125b6184e4461dadac7601340960840c5213b67a788c84aecfcdc3caf0bf3e27e4c95bb3c154db7055376981972b1565c22c100c47f3fa1dd2994e56090067b4e66f1c3905f9f780145cdf8d0fea88a45bae5113da37c8879c9cdb8ee9a55892bac3bae11fbbabcba0626163d0e2e12c04d99f4eeba5071cbeaL</span><br><span class="line">n2=0xd45304b186dc82e40bd387afc831c32a4c7ba514a64ae051b62f483f27951065a6a04a030d285bdc1cb457b24c2f8701f574094d46d8de37b5a6d55356d1d368b89e16fa71b6603bd037c7f329a3096ce903937bb0c4f112a678c88fd5d84016f745b8281aea8fd5bcc28b68c293e4ef4a62a62e478a8b6cd46f3da73fa34c63L</span><br><span class="line">e2=0x1f9eaeL</span><br><span class="line">c2=0x4d7ceaadf5e662ab2e0149a8d18a4777b4cd4a7712ab825cf913206c325e6abb88954ebc37b2bda19aed16c5938ac43f43966e96a86913129e38c853ecd4ebc89e806f823ffb802e3ddef0ac6c5ba078d3983393a91cd7a1b59660d47d2045c03ff529c341f3ed994235a68c57f8195f75d61fc8cac37e936d9a6b75c4bd2347L</span><br><span class="line">p = gmpy2.gcd(n1,n2)</span><br><span class="line">q1 = n1//p</span><br><span class="line">q2 = n2//p</span><br><span class="line"></span><br><span class="line">phi1 = (p-1)*(q1-1)</span><br><span class="line">phi2 = (p-1)*(q2-1)</span><br><span class="line"></span><br><span class="line">def decrypt(c,e,phi,n):</span><br><span class="line">    t = gmpy2.gcd(e,phi)</span><br><span class="line">    if t != 1:</span><br><span class="line">        e1 = e // t</span><br><span class="line">        d = gmpy2.invert(e1,phi)</span><br><span class="line">        m = pow(c,d,n)</span><br><span class="line">        return m</span><br><span class="line">    </span><br><span class="line">res1 = decrypt(c1,e1,phi1,n1)</span><br><span class="line">res2 = decrypt(c2,e2,phi2,n2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = CRT_list([res1,res2],[n1,n2])</span><br><span class="line">e3 = 14</span><br><span class="line">phi = (q1-1)*(q2-1)</span><br><span class="line">print(gmpy2.gcd(e3,phi))</span><br><span class="line">m = decrypt(c,e3,phi,q1*q2)</span><br><span class="line">print(long_to_bytes(int(gmpy2.iroot(int(m),2)[0])))</span><br></pre></td></tr></table></figure>

<p>怎么说呢，这题目太怪了</p>
<h2 id="情况3："><a href="#情况3：" class="headerlink" title="情况3："></a>情况3：</h2><p>AMM开根</p>
<p>见下一篇博客</p>
<h1 id="十三、NC不互素"><a href="#十三、NC不互素" class="headerlink" title="十三、NC不互素"></a>十三、NC不互素</h1><p>类似于n不互素</p>
<p>这种题目，通过n和c存在公约数求p</p>
<h2 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import random</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">n = p * q</span><br><span class="line">e = 65537</span><br><span class="line">c = pow(m*p, e, n)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br></pre></td></tr></table></figure>

<p>$\because c \equiv (mp)^e \mod n$，$\therefore c &#x3D; kn + m^ep^e \longrightarrow c &#x3D; kpq + m^ep^e \longrightarrow c &#x3D; p(kq+m^ep^{e-1})$</p>
<p>所以可以通过n和c的最大公约数求出p</p>
<p>之后再求出mp,最后求出m</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">n =<span class="number">17483770234884142847456666352881633858141093959507406489438832657811880348544517317886235174580364402693136945332374390980468053811072776178864091768180166876221659675217180437370214612891072604883134760061297589091497848817124108984000363937311663848944163413212471490943544013729793140932153932722897244086933590069840634776188515344586162299372418033246808686151342011111253737930983815234958893340565218112060881945578082230607232140507764864201490541905951630320920698022711376246588071419161730102709168468030659029885654176255175171297966568656762020277408125453099365768353256668477237850688484624314512104837</span></span><br><span class="line">c = <span class="number">7756412419736534306267281137444055853970895832135119947012680801728368453412511898214833061840593207999925914861147437172775590961864429038538036044372917920901477955515874667827839423934284921039793035016663689671993982388770276121107464667278667672531024583000281458905472417802844581894023365347884859881069456113169832521363450118618605256637768282911914962650680421804219666243987097956602779278718190490013281291054728762585198175600573970428128728004843715806947600331454660689313029334295614495527134693874900019066579958992524583794853232795458791635025434351607697221423673529269965794629214578773549342054</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(n,c)</span><br><span class="line"><span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">    p = t</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    mp = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(mp//p))</span><br></pre></td></tr></table></figure>



<h1 id="十四、Rabin"><a href="#十四、Rabin" class="headerlink" title="十四、Rabin"></a>十四、Rabin</h1><p>Rabin加密选取的加密密钥e &#x3D; 2</p>
<h2 id="密钥生成-1"><a href="#密钥生成-1" class="headerlink" title="密钥生成"></a>密钥生成</h2><p>选取两个大素数p,q<br>$$<br>p,q满足：<br>$$<br>$$<br>p \equiv q \equiv 3(mod \quad 4)<br>$$</p>
<p>$$<br>计算n&#x3D;p×q<br>$$</p>
<p>则(p,q)作为私钥，n作为公钥</p>
<h2 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h2><p>$$<br>c \equiv  m^2(mod \quad n)<br>$$</p>
<h2 id="解密过程"><a href="#解密过程" class="headerlink" title="解密过程"></a>解密过程</h2><p>$\because c \equiv m^2 \mod n$</p>
<p>即</p>
<p><img src="/../../images/RSA/0.png"></p>
<p>根据二次剩余得</p>
<p>$c^{\frac{p-1}{2}} \equiv 1 \mod p$同乘c得：$c^{\frac{p+1}{2}} \equiv c \mod p$，开根号得$c^{\frac{p+1}{4}} \mod p$，所以$m_p &#x3D;c^{\frac{p+1}{4}}$</p>
<p>同理$m_q &#x3D; c^{\frac{q+1}{4}}$</p>
<p>解中国剩余定理</p>
<p><img src="/../../images/RSA/1.png"></p>
<p><img src="/../../images/RSA/0.jpg" alt="Rabin中的孙子定理"></p>
<p> <img src="/../../images/RSA/22.png"></p>
<h2 id="存疑"><a href="#存疑" class="headerlink" title="存疑"></a>存疑</h2><p>m3这个解不太理解，<strong>查了点资料，好像解是通过公式求得的：</strong></p>
<p><img src="/../../images/RSA/1.webp" alt="1"></p>
<h2 id="例题-5"><a href="#例题-5" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import random</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">n = p * q</span><br><span class="line">e = 2</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;p=&quot;, p)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p= <span class="number">13314362720917602133969793252481444316247612541287913579795797774897851142465370812511985605994998073433561235021924708067874236781706611485522371488232623</span></span><br><span class="line">q= <span class="number">10711516497864529822020903304369858958930042711451857859791558135232705853374332295320094676061294774680048276363750484537945067473851592618816785752809803</span></span><br><span class="line">n= <span class="number">142617015943661365869136488949628046624950745436416195175536421279851751774402291519010668496730147866462378904972514253007029491632653461771497495733152729212900224242492221133006321373540619376544526943204146111719397605460529531608654329571698129077171108416638061409327725762114841023226929126272738803269</span></span><br><span class="line">c= <span class="number">3136716033731857617369889733308430982192049734478834150612954276064433287574994581343168243135342097712334250357890492021703404008556737899236668582163912130637742227325170121650071435166332685070232329</span></span><br><span class="line">e= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">mq = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">a = (inv_p * p * mq + inv_q * q * mp) % n</span><br><span class="line">b = n - <span class="built_in">int</span>(a)</span><br><span class="line">c = (inv_p * p * mq - inv_q * q * mp) % n</span><br><span class="line">d = n - <span class="built_in">int</span>(c)</span><br><span class="line"><span class="comment"># 因为rabin 加密有四种结果，全部列出。</span></span><br><span class="line">aa = [a, b, c, d]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> aa:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(i)))</span><br></pre></td></tr></table></figure>

<h2 id="多次解Rabin"><a href="#多次解Rabin" class="headerlink" title="多次解Rabin"></a>多次解Rabin</h2><p>题目来源NSSCTF ROUND#11</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> p &gt; q</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65536</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">num1 = (<span class="built_in">pow</span>(p,e,n)-<span class="built_in">pow</span>(q,e,n)) % n</span><br><span class="line">num2 = <span class="built_in">pow</span>(p-q,e,n)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num1=&quot;</span>,num1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;num2=&quot;</span>,num2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">num1= <span class="number">134186458247304184975418956047750205959249518467116558944535042073046353646812210914711656218265319503240074967140027248278994209294869476247136854741631971975560846483033205230015783696055443897579440474585892990793595602095853960468928457703619205343030230201261058516219352855127626321847429189498666288452</span></span><br><span class="line">num2= <span class="number">142252615203395148320392930915384149783801592719030740337592034613073131106036364733480644482188684184951026866672011061092572389846929838149296357261088256882232316029199097203257003822750826537629358422813658558008420810100860520289261141533787464661186681371090873356089237613080052677646446751824502044253</span></span><br><span class="line">n= <span class="number">154128165952806886790805410291540694477027958542517309121222164274741570806324940112942356615458298064007096476638232940977238598879453357856259085001745763666030177657087772721079761302637352680091939676709372354103177660093164629417313468356185431895723026835950366030712541994019375251534778666996491342313</span></span><br><span class="line">c= <span class="number">9061020000447780498751583220055526057707259079063266050917693522289697419950637286020502996753375864826169562714946009146452528404466989211057548905704856329650955828939737304126685040898740775635547039660982064419976700425595503919207903099686497044429265908046033565745195837408532764433870408185128447965</span></span><br><span class="line"></span><br><span class="line">tmp = num1+num2</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(n,tmp)</span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">inv_p = gmpy2.invert(p, q)</span><br><span class="line">inv_q = gmpy2.invert(q, p)</span><br><span class="line"></span><br><span class="line">cs = [c]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> c2 <span class="keyword">in</span> cs:</span><br><span class="line">        r = <span class="built_in">pow</span>(c2, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        s = <span class="built_in">pow</span>(c2, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line">        x = (r * inv_q * q + s * inv_p * p) % n</span><br><span class="line">        y = (r * inv_q * q - s * inv_p * p) % n</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(x)</span><br><span class="line">        <span class="keyword">if</span> n - x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - x)</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(y)</span><br><span class="line">        <span class="keyword">if</span> n - y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - y)</span><br><span class="line">    cs = ps</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> cs:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>现代密码-非对称加密</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>非对称加密</tag>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title>RSA(二)</title>
    <url>/2023/07/09/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA2/</url>
    <content><![CDATA[<p><strong>每个黎明都是崭新的开始</strong></p>
<span id="more"></span>

<p><strong>记录笔者RSA学习过程，继上篇</strong></p>
<h1 id="十五、m高位泄露"><a href="#十五、m高位泄露" class="headerlink" title="十五、m高位泄露"></a>十五、m高位泄露</h1><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m1 = ((m &gt;&gt; <span class="number">12</span>) &lt;&lt; <span class="number">12</span>)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m1=&quot;</span>, m1)</span><br></pre></td></tr></table></figure>

<p>直接用小明文攻击就能解决</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">175676150266417004297584173166433352018610464097263332979457040860199735122833311628588245224087655808166100611110577476473768211724924905653808872550861589950953763432355842437271483012029579464732704952936714503937167618229688691848715162564826927771471544937668578504504217271902336934966580193607269</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(c,<span class="number">3</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<p>$$<br>已知m高位m_h，则m &#x3D; m_h + x<br>$$</p>
<p>$$<br>所以m^e \equiv c (mod \quad n)<br>$$</p>
<p>$$<br>&#x3D;&gt; (m_h+x)^e \equiv c(mod \quad n)<br>$$</p>
<p>$$<br>\therefore 构造f &#x3D; (m_h+x)^e-c<br>$$</p>
<p><strong>SageMath exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line"></span><br><span class="line">n= 151960946972702081117093360145150451962009606399284283949493014851527184623949643832244795119390951664496262788801113061738745471705109651801469941245713981102683597278171804859002235073409069064532316371103411496330579589757997270705141792018944994603558174557515947534514865010671376327712345796006705526541</span><br><span class="line">c= 175676150266417004297584173166433352018610464097263332979457040860199735122833311628588245224087655808166100611110577476473768211724924905653808872550861589950953763432355842437271483012029579464732704952936714503937167618229688691848715162564826927771471544937668578504504217271902336934966580193607269</span><br><span class="line">e= 3</span><br><span class="line">m_high= 56006392793406045855300363310507945362344210576887867606743770445705804994335695867672312071808311296</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">m = m_high + x</span><br><span class="line">f = m^e - c</span><br><span class="line">x = f.small_roots(X = 2^12,beta = 0.4)</span><br><span class="line">if x:</span><br><span class="line">	m = m_high + x[0]</span><br><span class="line">	print(long_to_bytes(int(m))</span><br></pre></td></tr></table></figure>

<h1 id="十六、p高位泄露"><a href="#十六、p高位泄露" class="headerlink" title="十六、p高位泄露"></a>十六、p高位泄露</h1><p><strong>p的高位泄露一般是通过右移和左移操作来实现</strong></p>
<p><strong>一个数右移n位相当于除2的n次方，左移是乘上2的n次方</strong></p>
<p>eg:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">11111111右移3位后得到的是 00011111再左移3位 得到的是 11111000</span><br></pre></td></tr></table></figure>

<p>这样会导致低位的一些值丢失</p>
<h2 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p1 = ((p &gt;&gt; <span class="number">256</span>) &lt;&lt; <span class="number">256</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p1=&quot;</span>, p1)</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong> 这是sagemath脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n = 13825843519571710873428859414579672354315071659439820628244472999485866649052110805457869338590187514116602837815124140432484262117371676976267721436244227104792863856722306533085878006249426437815405943285837409223882200429650139498565410193518318609186404321541002818447049590702693207093178119976930306188313389812258040902404991392273477524090663507230185854302508398487606160947861933574298409247029121725657976002346558116475950788745748638760678901488207720494815927253554983917627634826826305748104732049673766438361103134678640861807396808490547480920918122602522866517282598354247700246018620827186407222291</span><br><span class="line">c = 8069176849119953284725698979637300857649466313773809113683642222085416457809259502704557882469560357376639733126836429991182536164084894508162647211766121557706947090701813794460382373772210944822854491223080171468124365453829931994686613388386398672952889685840411999135073540598959537338763755743580187011320135902778073983544957246842281172553032459418474893043913045926987625022043858637785478142565769241237336503137679001977264793413893322859182579535729775068010748011003277877267258462798570180414065271758061734676359804300115257687481351307213343011733330342628658103765597956044989311340712232509671201918</span><br><span class="line">e = 65537</span><br><span class="line">high_p = 109808212971964883545767217899164260396892558575747412957992952622503445366463665637485518479176308697194263286931473866511191437500214960131113514969332424915850812713465121027047280080223105730986925447033745115390014601545111178800361343308690136190170861353596131750311275899169955729432487964244199866368</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = high_p + x</span><br><span class="line">x = f.small_roots(X = 2^256,beta = 0.4)</span><br><span class="line">if x:</span><br><span class="line">    p = high_p + int(x[0])</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    print(long_to_bytes(int(m)))</span><br></pre></td></tr></table></figure>

<p>解释一些函数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">PolynomialRing函数</span><br><span class="line">它用于定义一个多项式环。在这个例子中，多项式环R的系数来自于整数环Zmod(n)，即在模n下的整数形成的环</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x = f.small_roots(X = 2^256,beta = 0.4)</span><br><span class="line">函数本来的样子</span><br><span class="line">small.roots(f, bound, beta=None, epsilon=0, max_steps=20, verbose=False)</span><br><span class="line">f：一个多项式或多项式列表，其中每个多项式都是SageMath中的Polynomial对象。</span><br><span class="line">bound：一个正整数，表示要查找的根的绝对值的上限。</span><br><span class="line">beta：一个正实数，表示算法中用于控制根的精度的参数。默认值为None，表示使用一个根据f的度数和bound自动确定的值。</span><br><span class="line">epsilon：一个非负实数，表示算法中用于控制根的精度的参数。默认值为0，表示使用一个根据f的度数和bound自动确定的值。</span><br><span class="line">max_steps：一个正整数，表示算法中用于控制迭代次数的参数。默认值为20，表示最多进行20次迭代。</span><br><span class="line">verbose：一个布尔值，表示是否在算法运行时输出详细信息。默认值为False，表示不输出详细信息。</span><br><span class="line"></span><br><span class="line">常常只用两个参数</span><br></pre></td></tr></table></figure>



<h2 id="例题2-2021CISCN-初赛rsa"><a href="#例题2-2021CISCN-初赛rsa" class="headerlink" title="例题2 2021CISCN 初赛rsa"></a>例题2 2021CISCN 初赛rsa</h2><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> text,flag</span><br><span class="line"><span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long,getPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> md5.new(text).hexdigest() == flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">msg1 = text[:xx]</span><br><span class="line">msg2 = text[xx:yy]</span><br><span class="line">msg3 = text[yy:]</span><br><span class="line"></span><br><span class="line">msg1 = bytes_to_long(msg1)</span><br><span class="line">msg2 = bytes_to_long(msg2)</span><br><span class="line">msg3 = bytes_to_long(msg3)</span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">N1 = p1*q1</span><br><span class="line">e1 = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg1,e1,N1)</span><br><span class="line"><span class="built_in">print</span> (e1,N1)</span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">512</span>)</span><br><span class="line">q2 = getPrime(<span class="number">512</span>)</span><br><span class="line">N2 = p2*q2</span><br><span class="line">e2 = <span class="number">17</span></span><br><span class="line">e3 = <span class="number">65537</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg2,e2,N2)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg2,e3,N2)</span><br><span class="line"><span class="built_in">print</span> (e2,N2)</span><br><span class="line"><span class="built_in">print</span> (e3,N2)</span><br><span class="line"></span><br><span class="line">p3 = getPrime(<span class="number">512</span>)</span><br><span class="line">q3 = getPrime(<span class="number">512</span>)</span><br><span class="line">N3 = p3*q3</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(msg3,e3,N3)</span><br><span class="line"><span class="built_in">print</span> (e3,N3)</span><br><span class="line"><span class="built_in">print</span> p3&gt;&gt;<span class="number">200</span></span><br></pre></td></tr></table></figure>

<p><strong>part 1 小明文攻击，part 2 共模攻击，part3 p高位泄露</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">c1 = 19105765285510667553313898813498220212421177527647187802549913914263968945493144633390670605116251064550364704789358830072133349108808799075021540479815182657667763617178044110939458834654922540704196330451979349353031578518479199454480458137984734402248011464467312753683234543319955893</span><br><span class="line">m1 = gmpy2.iroot(c1,3)[0]</span><br><span class="line">print(long_to_bytes(m1))</span><br><span class="line"></span><br><span class="line">c2 = 54995751387258798791895413216172284653407054079765769704170763023830130981480272943338445245689293729308200574217959018462512790523622252479258419498858307898118907076773470253533344877959508766285730509067829684427375759345623701605997067135659404296663877453758701010726561824951602615501078818914410959610</span><br><span class="line">c3 =91290935267458356541959327381220067466104890455391103989639822855753797805354139741959957951983943146108552762756444475545250343766798220348240377590112854890482375744876016191773471853704014735936608436210153669829454288199838827646402742554134017280213707222338496271289894681312606239512924842845268366950</span><br><span class="line">n2 =111381961169589927896512557754289420474877632607334685306667977794938824018345795836303161492076539375959731633270626091498843936401996648820451019811592594528673182109109991384472979198906744569181673282663323892346854520052840694924830064546269187849702880332522636682366270177489467478933966884097824069977</span><br><span class="line">e2 =17</span><br><span class="line">e3 = 65537</span><br><span class="line">r,x,y = gmpy2.gcdext(e2,e3)</span><br><span class="line">m2 = (pow(c2,x,n2)*pow(c3,y,n2))%n2</span><br><span class="line">print(long_to_bytes(int(m2)))</span><br><span class="line"></span><br><span class="line">c4 =59213696442373765895948702611659756779813897653022080905635545636905434038306468935283962686059037461940227618715695875589055593696352594630107082714757036815875497138523738695066811985036315624927897081153190329636864005133757096991035607918106529151451834369442313673849563635248465014289409374291381429646</span><br><span class="line">e4 = 65537</span><br><span class="line">n3 =113432930155033263769270712825121761080813952100666693606866355917116416984149165507231925180593860836255402950358327422447359200689537217528547623691586008952619063846801829802637448874451228957635707553980210685985215887107300416969549087293746310593988908287181025770739538992559714587375763131132963783147</span><br><span class="line">p0 = 7117286695925472918001071846973900342640107770214858928188419765628151478620236042882657992902</span><br><span class="line">p0 = p0&lt;&lt;200</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n3))</span><br><span class="line">f = p0 + x</span><br><span class="line">x = f.small_roots(X = 2^200,beta = 0.4)</span><br><span class="line">if x:</span><br><span class="line">	p = p0+x[0]</span><br><span class="line">	q = n3 // p</span><br><span class="line">	d = gmpy2.invert(e4,(p-1)*(q-1))</span><br><span class="line">	m3 = pow(c4,d,n3)</span><br><span class="line">	print(long_to_bytes(m3))</span><br><span class="line">	txt = long_to_bytes(m1)+long_to_bytes(m2)+long_to_bytes(m3)</span><br><span class="line">	flag = hashlib.md5(txt).hexdigest()</span><br><span class="line">	print(flag)</span><br></pre></td></tr></table></figure>



<h1 id="十七、d低位泄露"><a href="#十七、d低位泄露" class="headerlink" title="十七、d低位泄露"></a>十七、d低位泄露</h1><p>条件：e较小,且已知d的低位</p>
<p>推导：</p>
<p>$$<br>\because e×d \equiv 1(mod \quad (p-1)(q-1))<br>$$</p>
<p>$$<br>&#x3D;&gt; e×d &#x3D; k×(p-1)(q-1) + 1<br>$$</p>
<p>$$<br>&#x3D;&gt;e×d &#x3D; k×(n-p-q+1)+1<br>$$</p>
<p>$$<br>设d的低位为d_0,与n^{\frac{1}{2}}约一个bit长度(这没理解)<br>$$</p>
<p>$$<br>设n的bit长度为L,由e×d&#x3D;k×(n-p-q+1)+1,我们对左右两个式子模2^{\frac{L}{2}}得到:<br>$$</p>
<p>$$<br>e×d_0 \equiv k×(n-p-q+1)+1(mod \quad 2^{\frac{L}{2}}),这里我的理解是d(mod \quad 2^{\frac{L}{2}})就是d_0<br>$$</p>
<p>$$<br>把上式e×d_0 \equiv k×(n-p-q+1)+1(mod \quad 2^{\frac{L}{2}})<br>$$</p>
<p>$$<br>用q &#x3D; \frac{n}{p}代换得到：<br>$$</p>
<p>$$<br>ed_0p \equiv kpn-kp^2-kn+kp+p(mod \quad 2^{\frac{L}{2}})<br>$$</p>
<p>$$<br>用sagemath中的函数解这个同余式就能得到p的低位<br>$$</p>
<p>$$<br>关于k的取值：<br>$$</p>
<p>$$<br>由e×d &#x3D; k×\phi(n) + 1<br>$$</p>
<p>$$<br>\because d&lt;\phi(n),\therefore e&gt;k<br>$$</p>
<p>$$<br>一般e不会太大，爆破k就可以<br>$$</p>
<p><strong>SageMath中解同余式的函数如下：</strong></p>
<p><strong><code>solve_mod(eqs,mods)</code></strong></p>
<p>对于这个例子，则用下式<br>$$<br>X &#x3D; var(‘X’)，定义一个变量<br>$$</p>
<p><img src="/../../images/RSA/34.png"></p>
<h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">while True:</span><br><span class="line">    p = libnum.generate_prime(512)</span><br><span class="line">    q = libnum.generate_prime(512)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi_n = (p - 1) * (q - 1)</span><br><span class="line">    e = 3</span><br><span class="line">    if gmpy2.gcd(e, phi_n) == 1:</span><br><span class="line">        break</span><br><span class="line">d = gmpy2.invert(e, phi_n)</span><br><span class="line">d1 = d &amp; ((1 &lt;&lt; 486) - 1)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;d1=&quot;, d)</span><br></pre></td></tr></table></figure>

<p><strong>这题也可以利用小明文攻击</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">175676150266403937224898870626869248307097859453341599800113943191154294552011908698393750389195590199207971365632903719917006078351629939912360175671032635640354766675409868021903917260597989036476083685690139071290022752606720020238530580507331902326179201548484337939338062870542095137303322195300197</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(c,<span class="number">3</span>)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure>

<p><strong>SageMath</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def getFullP(low_p, n):</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=&#x27;NTL&#x27;)</span><br><span class="line">    p = x * 2 ^ bit + low_p</span><br><span class="line">    root = (p - n).monic().small_roots(X=2 ^ 128, beta=0.4)</span><br><span class="line">    if root:</span><br><span class="line">        return p(root[0])</span><br><span class="line">    return None</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def phase4(low_d,n,c,e):</span><br><span class="line">    maybe_p = []</span><br><span class="line">    for k in range(1, 4):</span><br><span class="line">        p = var(&#x27;p&#x27;)</span><br><span class="line">        p0 = solve_mod([3 * p * low_d == p + k * (n * p - p ^ 2 - n + p)], 2 ^ bit)</span><br><span class="line">        maybe_p += [int(x[0]) for x in p0]</span><br><span class="line">    # print(maybe_p)</span><br><span class="line"></span><br><span class="line">    for x in maybe_p:</span><br><span class="line">        P = getFullP(x, n)</span><br><span class="line">        if P: break</span><br><span class="line"></span><br><span class="line">    P = int(P)</span><br><span class="line">    Q = n // P</span><br><span class="line"></span><br><span class="line">    assert P * Q == n</span><br><span class="line">    print(&quot;P = &quot;,P)</span><br><span class="line">    print(&quot;Q = &quot;,Q)</span><br><span class="line"></span><br><span class="line">    d = inverse_mod(3, (P - 1) * (Q - 1))</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    print(long_to_bytes(int(m)))</span><br><span class="line"></span><br><span class="line">low_d = 66155515334397587206334262409257611903325992908874597061630420749714627092070043054020890948099263820078299031372758328060568322822359627510248831960548842374360111368587702677016263988651746874367056185352095585037936034196599496577057035033718066207964292781685419156037246789689219471468151618592221802699</span><br><span class="line">bit = low_d.nbits()</span><br><span class="line">n = 99233273001596380809501393613886417854988989363311895592445631124571940638105064581031336422148895730117448547059137492090852484233539441265373247940823283633017582469362503632785297924194187912199716752955609363457416190782142095008241313065484612071705711161086869849047664563205898255359661312582650481473</span><br><span class="line">e = 3</span><br><span class="line">c = 175676150266403937224898870626869248307097859453341599800113943191154294552011908698393750389195590199207971365632903719917006078351629939912360175671032635640354766675409868021903917260597989036476083685690139071290022752606720020238530580507331902326179201548484337939338062870542095137303322195300197</span><br><span class="line"></span><br><span class="line">phase4(low_d,n,c,e)</span><br></pre></td></tr></table></figure>

<p>对于<code> root = (p - n).monic().small_roots(X=2 ^ 128, beta=0.4)</code><strong>，</strong><code>monic()</code>的作用是把p的系数变成1</p>
<p>这里的n应该不是我们给的n值</p>
<p>这串代码换成<code> root = p.monic().small_roots(X=2 ^ 128, beta=0.4)</code>，不会影响求解</p>
<h3 id="关于已知p的低位如何恢复p，以下是我的理解："><a href="#关于已知p的低位如何恢复p，以下是我的理解：" class="headerlink" title="关于已知p的低位如何恢复p，以下是我的理解："></a>关于已知p的低位如何恢复p，以下是我的理解：</h3><p>$$<br>设p的低位为p_0,假设p是一个512位的数<br>$$</p>
<p>$$<br>那p&#x3D;x×2^b+p_0，b＜512<br>$$</p>
<p>$$<br>然后因为x的系数不是1，所以需要p.monic()把x的系数变成1<br>$$</p>
<p><strong>如果存在错误，请大佬指出</strong></p>
<h1 id="十八、Franklin-Reiter-相关消息攻击"><a href="#十八、Franklin-Reiter-相关消息攻击" class="headerlink" title="十八、Franklin-Reiter 相关消息攻击"></a>十八、Franklin-Reiter 相关消息攻击</h1><h2 id="攻击条件"><a href="#攻击条件" class="headerlink" title="攻击条件"></a>攻击条件</h2><p>当Alice使用同一公钥对两个具有线性关系的消息$M_1,M_2$进行加密，并将加密后的消息$C_1,C_2$发送给了Bob，我们就可能可以获得对应的消息$M_1,M_2$。假设模数为$N$，$M_1,M_2$的线性关系如下：</p>
<p>$M_1 \equiv f(M_2) \mod N$</p>
<p>其中$f$为一个线性函数，比如$f &#x3D; ax+b$</p>
<p>这一攻击由Franklin，Reiter提出</p>
<h2 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h2><p>首先，我们知道$C_1 \equiv M_1^e \mod N$，并且$M_1 \equiv f(M_2) \mod N$，那么我们可以知道$M_2$是$f(x)^e \equiv C_1 \mod N$的一个解。就是说$M_2$即是方程$f(c)^e -C_1$在模$N$意义下的一个根。$M_2$还是$x^e - C_2$在模$N$意义下的一个根。</p>
<p>所以$x-M_2$<strong>同时整除以上两个多项式</strong>。</p>
<p>因此，我们可以求得两个多项式的最大公因子，如果最大公因子恰好是线性的话，那么我们就求得了$M_2$。</p>
<p>如果最后解的形式是$x - M$这样的，那么最后只要使用sage中的<code>Q.coefficients()[0]</code>提取结果后面的$M$即可</p>
<p><code>Q.coefficients()</code>的作用：提取多项式Q中的系数，并且是升序排列</p>
<p>例子：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">f = x^3 + x^2 - 3x + 4</span><br><span class="line">f.coefficients()</span><br><span class="line">返回列表[4,-3,1,1]	#升序排列</span><br></pre></td></tr></table></figure>

<h2 id="另一个推导"><a href="#另一个推导" class="headerlink" title="另一个推导"></a>另一个推导</h2><p><img src="/../../images/RSA/24.png"></p>
<p><img src="/../../images/RSA/25.png"></p>
<p><strong>Python实现</strong>:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getM2</span>(<span class="params">a,b,c1,c2,n</span>):</span><br><span class="line">    a3 = <span class="built_in">pow</span>(a,<span class="number">3</span>,n)</span><br><span class="line">    b3 = <span class="built_in">pow</span>(b,<span class="number">3</span>,n)</span><br><span class="line">    first = c1-a3*c2+<span class="number">2</span>*b3</span><br><span class="line">    first = first % n</span><br><span class="line">    second = <span class="number">3</span>*b*(a3*c2-b3)</span><br><span class="line">    second = second % n</span><br><span class="line">    third = second*gmpy2.invert(first,n)</span><br><span class="line">    third = third % n</span><br><span class="line">    fourth = (third+b)*gmpy2.invert(a,n)</span><br><span class="line">    <span class="keyword">return</span> fourth % n</span><br></pre></td></tr></table></figure>

<h3 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">n = p * q</span><br><span class="line">e = 3</span><br><span class="line">c1=pow(m,e,n)</span><br><span class="line">c2=pow(m+23,e,n)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;c1=&quot;,c1)</span><br><span class="line">print(&quot;c2=&quot;,c2)</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getM2</span>(<span class="params">a,b,c1,c2,n</span>):</span><br><span class="line">    a3 = <span class="built_in">pow</span>(a,<span class="number">3</span>,n)</span><br><span class="line">    b3 = <span class="built_in">pow</span>(b,<span class="number">3</span>,n)</span><br><span class="line">    first = c1-a3*c2+<span class="number">2</span>*b3</span><br><span class="line">    first = first % n</span><br><span class="line">    second = <span class="number">3</span>*b*(a3*c2-b3)</span><br><span class="line">    second = second % n</span><br><span class="line">    third = second*gmpy2.invert(first,n)</span><br><span class="line">    third = third % n</span><br><span class="line">    fourth = (third+b)*gmpy2.invert(a,n)</span><br><span class="line">    <span class="keyword">return</span> fourth % n</span><br><span class="line"></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">b = -<span class="number">23</span>  <span class="comment">#这里padding1 = 0,padding2 = 23,所以b=-23</span></span><br><span class="line">c1 = <span class="number">175676150266641711916444091445781139277779003156556056759990312014697871894446590460729449316298376008489849677065205914793458959388232066629206406667357155787745931037869574771399224859869367943670440218253278560317330520488399820186869405944311596980008194439252102301970756589691462498043634547537253</span></span><br><span class="line">c2 = <span class="number">175676150266641711916444091445781139277779003156556056759990312014697871894446590460729449316298376224923256004570408208514033791620884417984796834735275720367596862370848324295530654005254716452155315511101075351067155901490533428950707819290823018393253109305648196157485509642713358863483579848456000</span></span><br><span class="line">n = <span class="number">9707282140608521534597213563664893782715260149781186731553485375967064221954996829298350139968314798018284178381942220275007118714479405726997513958731781270336969570682984804304509289064604490389662873420811943298401346416863405802733285090007438244315477659519649397202552302359138760555930108515441728335367340137429696475675969560470475825268961509793587655446220632264103246117705882070495699964049531607741206990087970869961102891452578255653506178059604251931305312230652370649515170079034023689675250251084053161308943618517038440570295690711731360323639242469371943498556697872269814453467858940956177847263</span></span><br><span class="line"></span><br><span class="line">M2 = getM2(a,b,c1,c2,n)</span><br><span class="line">m = M2 - <span class="number">23</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h3 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(flag)</span><br><span class="line">N = getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, N)</span><br><span class="line"></span><br><span class="line">a = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">b = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">m2 = a * m1 + b</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(N, a, b, c1, c2, sep=<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 51296885372346449295388453471330409021784141081351581975478435681552082076338697136130122011636685327781785488670769096434920591920054441921039812310126089859349902066456998315283909435249794317277620588552441456327265553018986591779396701680997794937951231970194353001576159809798153970829987274504038146741</span></span><br><span class="line"><span class="comment"># 13256631249970000274738888132534852767685499642889351632072622194777502848070957827974250425805779856662241409663031192870528911932663995606616763982320967</span></span><br><span class="line"><span class="comment"># 12614470377409090738391280373352373943201882741276992121990944593827605866548572392808272414120477304486154096358852845785437999246453926812759725932442170</span></span><br><span class="line"><span class="comment"># 18617698095122597355752178584860764221736156139844401400942959000560180868595058572264330257490645079792321778926462300410653970722619332098601515399526245808718518153518824404167374361098424325296872587362792839831578589407441739040578339310283844080111189381106274103089079702496168766831316853664552253142</span></span><br><span class="line"><span class="comment"># 14091361528414093900688440242152327115109256507133728799758289918462970724109343410464537203689727409590796472177295835710571700501895484300979622506298961999001641059179449655629481072402234965831697915939034769804437452528921599125823412464950939837343822566667533463393026895985173157447434429906021792720</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line">n=</span><br><span class="line">a=</span><br><span class="line">b=</span><br><span class="line">c1=</span><br><span class="line">c2=</span><br><span class="line">e=<span class="number">17</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2,a,b</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    g1 = (x)^e - c1</span><br><span class="line">    g2 = (a*x+b)^e - c2</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">        <span class="keyword">while</span> g2:</span><br><span class="line">            g1, g2 = g2, g1 % g2</span><br><span class="line">        <span class="keyword">return</span> g1.monic() <span class="comment"># </span></span><br><span class="line">    <span class="keyword">return</span> -gcd(g1, g2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m=franklinReiter(n,e,c1,c2,a,b)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<h3 id="例题3-a1x-b1和a2x-b2"><a href="#例题3-a1x-b1和a2x-b2" class="headerlink" title="例题3 a1x+b1和a2x+b2"></a>例题3 a1x+b1和a2x+b2</h3><p>见SICTF2023</p>
<h1 id="十九、Boneh-Durfee-攻击"><a href="#十九、Boneh-Durfee-攻击" class="headerlink" title="十九、Boneh Durfee 攻击"></a>十九、Boneh Durfee 攻击</h1><h2 id="攻击条件-1"><a href="#攻击条件-1" class="headerlink" title="攻击条件"></a>攻击条件</h2><p>$$<br>当d \le n^{0.292}时，可以使用Boneh Durfee攻击<br>$$</p>
<p>不大理解原理</p>
<p>记个脚本：<a href="https://github.com/Gao-Chuan/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage">Boneh Durfee.sage</a></p>
<p>笔者有进行微小的改动:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import time</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">############################################</span><br><span class="line"># Config</span><br><span class="line">##########################################</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Setting debug to true will display more informations</span><br><span class="line">about the lattice, the bounds, the vectors...</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">debug = True</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Setting strict to true will stop the algorithm (and</span><br><span class="line">return (-1, -1)) if we don&#x27;t have a correct </span><br><span class="line">upperbound on the determinant. Note that this </span><br><span class="line">doesn&#x27;t necesseraly mean that no solutions </span><br><span class="line">will be found since the theoretical upperbound is</span><br><span class="line">usualy far away from actual results. That is why</span><br><span class="line">you should probably use `strict = False`</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">strict = False</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">This is experimental, but has provided remarkable results</span><br><span class="line">so far. It tries to reduce the lattice as much as it can</span><br><span class="line">while keeping its efficiency. I see no reason not to use</span><br><span class="line">this option, but if things don&#x27;t work, you should try</span><br><span class="line">disabling it</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">helpful_only = True</span><br><span class="line">dimension_min = 7 # stop removing if lattice reaches that dimension</span><br><span class="line"></span><br><span class="line">############################################</span><br><span class="line"># Functions</span><br><span class="line">##########################################</span><br><span class="line"></span><br><span class="line"># display stats on helpful vectors</span><br><span class="line">def helpful_vectors(BB, modulus):</span><br><span class="line">    nothelpful = 0</span><br><span class="line">    for ii in range(BB.dimensions()[0]):</span><br><span class="line">        if BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += 1</span><br><span class="line"></span><br><span class="line">    print (nothelpful, &quot;/&quot;, BB.dimensions()[0], &quot; vectors are not helpful&quot;)</span><br><span class="line"></span><br><span class="line"># display matrix picture with 0 and X</span><br><span class="line">def matrix_overview(BB, bound):</span><br><span class="line">    for ii in range(BB.dimensions()[0]):</span><br><span class="line">        a = (&#x27;%02d &#x27; % ii)</span><br><span class="line">        for jj in range(BB.dimensions()[1]):</span><br><span class="line">            a += &#x27;0&#x27; if BB[ii,jj] == 0 else &#x27;X&#x27;</span><br><span class="line">            if BB.dimensions()[0] &lt; 60:</span><br><span class="line">                a += &#x27; &#x27;</span><br><span class="line">        if BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += &#x27;~&#x27;</span><br><span class="line">        print (a)</span><br><span class="line"></span><br><span class="line"># tries to remove unhelpful vectors</span><br><span class="line"># we start at current = n-1 (last vector)</span><br><span class="line">def remove_unhelpful(BB, monomials, bound, current):</span><br><span class="line">    # end of our recursive function</span><br><span class="line">    if current == -1 or BB.dimensions()[0] &lt;= dimension_min:</span><br><span class="line">        return BB</span><br><span class="line"></span><br><span class="line">    # we start by checking from the end</span><br><span class="line">    for ii in range(current, -1, -1):</span><br><span class="line">        # if it is unhelpful:</span><br><span class="line">        if BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = 0</span><br><span class="line">            affected_vector_index = 0</span><br><span class="line">            # let&#x27;s check if it affects other vectors</span><br><span class="line">            for jj in range(ii + 1, BB.dimensions()[0]):</span><br><span class="line">                # if another vector is affected:</span><br><span class="line">                # we increase the count</span><br><span class="line">                if BB[jj, ii] != 0:</span><br><span class="line">                    affected_vectors += 1</span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            # level:0</span><br><span class="line">            # if no other vectors end up affected</span><br><span class="line">            # we remove it</span><br><span class="line">            if affected_vectors == 0:</span><br><span class="line">                print (&quot;* removing unhelpful vector&quot;, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-1)</span><br><span class="line">                return BB</span><br><span class="line"></span><br><span class="line">            # level:1</span><br><span class="line">            # if just one was affected we check</span><br><span class="line">            # if it is affecting someone else</span><br><span class="line">            elif affected_vectors == 1:</span><br><span class="line">                affected_deeper = True</span><br><span class="line">                for kk in range(affected_vector_index + 1, BB.dimensions()[0]):</span><br><span class="line">                    # if it is affecting even one vector</span><br><span class="line">                    # we give up on this one</span><br><span class="line">                    if BB[kk, affected_vector_index] != 0:</span><br><span class="line">                        affected_deeper = False</span><br><span class="line">                # remove both it if no other vector was affected and</span><br><span class="line">                # this helpful vector is not helpful enough</span><br><span class="line">                # compared to our unhelpful one</span><br><span class="line">                if affected_deeper and abs(bound - BB[affected_vector_index, affected_vector_index]) &lt; abs(bound - BB[ii, ii]):</span><br><span class="line">                    print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-1)</span><br><span class="line">                    return BB</span><br><span class="line">    # nothing happened</span><br><span class="line">    return BB</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot; </span><br><span class="line">Returns:</span><br><span class="line">* 0,0   if it fails</span><br><span class="line">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span><br><span class="line">* x0,y0 the solutions of `pol`</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">def boneh_durfee(pol, modulus, mm, tt, XX, YY):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Boneh and Durfee revisited by Herrmann and May</span><br><span class="line">    </span><br><span class="line">    finds a solution if:</span><br><span class="line">    * d &lt; N^delta</span><br><span class="line">    * |x| &lt; e^delta</span><br><span class="line">    * |y| &lt; e^0.5</span><br><span class="line">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">    # substitution (Herrman and May)</span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + 1 - u) # u = xy + 1</span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + 1</span><br><span class="line"></span><br><span class="line">    # x-shifts</span><br><span class="line">    gg = []</span><br><span class="line">    for kk in range(mm + 1):</span><br><span class="line">        for ii in range(mm - kk + 1):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    # x-shifts list of monomials</span><br><span class="line">    monomials = []</span><br><span class="line">    for polynomial in gg:</span><br><span class="line">        for monomial in polynomial.monomials():</span><br><span class="line">            if monomial not in monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    # y-shifts (selected by Herrman and May)</span><br><span class="line">    for jj in range(1, tt + 1):</span><br><span class="line">        for kk in range(floor(mm/tt) * jj, mm + 1):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) # substitution</span><br><span class="line">    </span><br><span class="line">    # y-shifts list of monomials</span><br><span class="line">    for jj in range(1, tt + 1):</span><br><span class="line">        for kk in range(floor(mm/tt) * jj, mm + 1):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    # construct lattice B</span><br><span class="line">    nn = len(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    for ii in range(nn):</span><br><span class="line">        BB[ii, 0] = gg[ii](0, 0, 0)</span><br><span class="line">        for jj in range(1, ii + 1):</span><br><span class="line">            if monomials[jj] in gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    # Prototype to reduce the lattice</span><br><span class="line">    if helpful_only:</span><br><span class="line">        # automatically remove</span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-1)</span><br><span class="line">        # reset dimension</span><br><span class="line">        nn = BB.dimensions()[0]</span><br><span class="line">        if nn == 0:</span><br><span class="line">            print (&quot;failure&quot;)</span><br><span class="line">            return 0,0</span><br><span class="line"></span><br><span class="line">    # check if vectors are helpful</span><br><span class="line">    if debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line">    </span><br><span class="line">    # check if determinant is correctly bounded</span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    if det &gt;= bound:</span><br><span class="line">        print (&quot;We do not have det &lt; bound. Solutions might not be found.&quot;)</span><br><span class="line">        print (&quot;Try with highers m and t.&quot;)</span><br><span class="line">        if debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(2)</span><br><span class="line">            print (&quot;size det(L) - size e^(m*n) = &quot;, floor(diff))</span><br><span class="line">        if strict:</span><br><span class="line">            return -1, -1</span><br><span class="line">    else:</span><br><span class="line">        print (&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;)</span><br><span class="line"></span><br><span class="line">    # display the lattice basis</span><br><span class="line">    if debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    # LLL</span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    # transform vector 1 &amp; 2 -&gt; polynomials 1 &amp; 2</span><br><span class="line">    PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">    pol1 = pol2 = 0</span><br><span class="line">    for jj in range(nn):</span><br><span class="line">        pol1 += monomials[jj](w*z+1,w,z) * BB[0, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">        pol2 += monomials[jj](w*z+1,w,z) * BB[1, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    # resultant</span><br><span class="line">    PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">    rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">    if rr.is_zero() or rr.monomials() == [1]:</span><br><span class="line">        print (&quot;the two first vectors are not independant&quot;)</span><br><span class="line">        return 0, 0</span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    # solutions</span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    if len(soly) == 0:</span><br><span class="line">        print (&quot;Your prediction (delta) is too small&quot;)</span><br><span class="line">        return 0, 0</span><br><span class="line"></span><br><span class="line">    soly = soly[0][0]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[0][0]</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    return solx, soly</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    ############################################</span><br><span class="line">    # How To Use </span><br><span class="line">    ##########################################</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Problem (change those values)</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # the modulus</span><br><span class="line">    N = 0xbadd260d14ea665b62e7d2e634f20a6382ac369cd44017305b69cf3a2694667ee651acded7085e0757d169b090f29f3f86fec255746674ffa8a6a3e1c9e1861003eb39f82cf74d84cc18e345f60865f998b33fc182a1a4ffa71f5ae48a1b5cb4c5f154b0997dc9b001e441815ce59c6c825f064fdca678858758dc2cebbc4d27L</span><br><span class="line"></span><br><span class="line">    # the public exponent</span><br><span class="line">    e = 0x11722b54dd6f3ad9ce81da6f6ecb0acaf2cbc3885841d08b32abc0672d1a7293f9856db8f9407dc05f6f373a2d9246752a7cc7b1b6923f1827adfaeefc811e6e5989cce9f00897cfc1fc57987cce4862b5343bc8e91ddf2bd9e23aea9316a69f28f407cfe324d546a7dde13eb0bd052f694aefe8ec0f5298800277dbab4a33bbL</span><br><span class="line">    c = 0xe3505f41ec936cf6bd8ae344bfec85746dc7d87a5943b3a7136482dd7b980f68f52c887585d1c7ca099310c4da2f70d4d5345d3641428797030177da6cc0d41e7b28d0abce694157c611697df8d0add3d900c00f778ac3428f341f47ecc4d868c6c5de0724b0c3403296d84f26736aa66f7905d498fa1862ca59e97f8f866cL</span><br><span class="line"></span><br><span class="line">    # the hypothesis on the private exponent (max 0.292)</span><br><span class="line">    delta = float(0.26) # d &lt; N^delta</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Lattice (tweak those values)</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # you should tweak this (after a first run)</span><br><span class="line">    m = 4 # size of the lattice (bigger the better/slower)</span><br><span class="line"></span><br><span class="line">    # might not be a good idea to tweak these</span><br><span class="line">    t = int((1-2*delta) * m)  # optimization from Herrmann and May</span><br><span class="line">    X = 2*floor(N^delta)  # this _might_ be too much</span><br><span class="line">    Y = floor(N^(1/2))    # correct if p, q are ~ same size</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Don&#x27;t touch anything below</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # Problem put in equation</span><br><span class="line">    P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    A = int((N+1)/2)</span><br><span class="line">    pol = 1 + x * (A + y)</span><br><span class="line"></span><br><span class="line">    #</span><br><span class="line">    # Find the solutions!</span><br><span class="line">    #</span><br><span class="line"></span><br><span class="line">    # Checking bounds</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;=== checking values ===&quot;)</span><br><span class="line">        print (&quot;* delta:&quot;, delta)</span><br><span class="line">        print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span><br><span class="line">        print (&quot;* size of e:&quot;, int(log(e)/log(2)))</span><br><span class="line">        print (&quot;* size of N:&quot;, int(log(N)/log(2)))</span><br><span class="line">        print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span><br><span class="line"></span><br><span class="line">    # boneh_durfee</span><br><span class="line">    if debug:</span><br><span class="line">        print (&quot;=== running algorithm ===&quot;)</span><br><span class="line">        start_time = time.time()</span><br><span class="line"></span><br><span class="line">    solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"></span><br><span class="line">    if solx &gt; 0:</span><br><span class="line">        print (&quot;=== solutions found ===&quot;)</span><br><span class="line">        if debug:</span><br><span class="line">            print (&quot;x:&quot;, solx)</span><br><span class="line">            print (&quot;y:&quot;, soly)</span><br><span class="line"></span><br><span class="line">        d = int(pol(solx, soly) / e)</span><br><span class="line">        print (&quot;d:&quot;, d)</span><br><span class="line">        m = pow(c,d,N)</span><br><span class="line">        print(long_to_bytes(int(m)))</span><br><span class="line"></span><br><span class="line">    if debug:</span><br><span class="line">        print(&quot;=== %s seconds ===&quot; % (time.time() - start_time))</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<h1 id="二十、AMM开根"><a href="#二十、AMM开根" class="headerlink" title="二十、AMM开根"></a>二十、AMM开根</h1><p>参考：<a href="https://zhuanlan.zhihu.com/p/623410303">宸极实验室—『CTF』AMM 算法详解与应用 - 知乎 (zhihu.com)</a></p>
<p><a href="https://arxiv.org/pdf/1111.4877.pdf">1111.4877.pdf (arxiv.org)</a></p>
<h2 id="算法浅析"><a href="#算法浅析" class="headerlink" title="算法浅析"></a>算法浅析</h2><h3 id="当e-2时"><a href="#当e-2时" class="headerlink" title="当e&#x3D;2时"></a>当e&#x3D;2时</h3><p><img src="/../../images/RSA/46.png"></p>
<p><img src="/../../images/RSA/47.png"></p>
<h3 id="当e-2时-1"><a href="#当e-2时-1" class="headerlink" title="当e&gt;2时"></a>当e&gt;2时</h3><p>证明过程不太理解</p>
<h2 id="2021黑盾杯Crypto1"><a href="#2021黑盾杯Crypto1" class="headerlink" title="2021黑盾杯Crypto1"></a>2021黑盾杯Crypto1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e = 1801</span><br><span class="line">c = pow(m,e,p)</span><br><span class="line"></span><br><span class="line">c =821562155714228494350968286343241874202753771452745916900616612053610190986294297934462409534126095213198464996196364868528238538372119009517541428785632007137206972918081643841690069171088425923887930051635578719252415693144672179185417101210954906623326286804995637775062840407550493095027500638719998 </span><br><span class="line">p =19897846550210846565807788524492364050901480736489979129040638436463635149815428186161001280958415730930156556581274966745574164608778242980049611665461488306439665507971670397595035647317930606555771720849158745264269952668944940061576328219674721623208805067371087817766416300084129945316973502412996143 </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">e = <span class="number">1801</span></span><br><span class="line">c = <span class="number">821562155714228494350968286343241874202753771452745916900616612053610190986294297934462409534126095213198464996196364868528238538372119009517541428785632007137206972918081643841690069171088425923887930051635578719252415693144672179185417101210954906623326286804995637775062840407550493095027500638719998</span></span><br><span class="line">p = <span class="number">19897846550210846565807788524492364050901480736489979129040638436463635149815428186161001280958415730930156556581274966745574164608778242980049611665461488306439665507971670397595035647317930606555771720849158745264269952668944940061576328219674721623208805067371087817766416300084129945316973502412996143</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AMM</span>(<span class="params">o, r, q</span>):</span><br><span class="line">    start = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n----------------------------------------------------------------------------------&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(r, o, q))</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="keyword">while</span> p ^ ((q-<span class="number">1</span>) // r) == <span class="number">1</span>:</span><br><span class="line">        p = g(random.randint(<span class="number">1</span>, q))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find p:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(p))</span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    s = q - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> s % r == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        s = s // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(s, t))</span><br><span class="line">    k = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (k * s + <span class="number">1</span>) % r != <span class="number">0</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">    alp = (k * s + <span class="number">1</span>) // r</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Find alp:&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(alp))</span><br><span class="line">    a = p ^ (r**(t-<span class="number">1</span>) * s)</span><br><span class="line">    b = o ^ (r*alp - <span class="number">1</span>)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t):</span><br><span class="line">        d = b ^ (r^(t-<span class="number">1</span>-i))</span><br><span class="line">        <span class="keyword">if</span> d == <span class="number">1</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Calculating DLP...&#x27;</span>)</span><br><span class="line">            j = - discrete_log(a, d)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;[+] Finish DLP...&#x27;</span>)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c ^ r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Find one solution: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllPRoot</span>(<span class="params">p, e</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(proot) &lt; e:</span><br><span class="line">        proot.add(<span class="built_in">pow</span>(random.randint(<span class="number">2</span>, p-<span class="number">1</span>), (p-<span class="number">1</span>)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> proot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findAllSolutions</span>(<span class="params">mp, proot, cp, p</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;</span>.<span class="built_in">format</span>(e, cp, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> root <span class="keyword">in</span> proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        <span class="keyword">assert</span>(<span class="built_in">pow</span>(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished in &#123;&#125; seconds.&quot;</span>.<span class="built_in">format</span>(end - start))</span><br><span class="line">    <span class="keyword">return</span> all_mp</span><br><span class="line"></span><br><span class="line">mp = AMM(c,e,p)</span><br><span class="line">p_proot = findAllPRoot(p, e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, c, p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> mps:</span><br><span class="line">	flag = long_to_bytes(<span class="built_in">int</span>(i))</span><br><span class="line">	<span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">		<span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="2022NISACTF——rrssaa2"><a href="#2022NISACTF——rrssaa2" class="headerlink" title="2022NISACTF——rrssaa2"></a>2022NISACTF——rrssaa2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">def gen():</span><br><span class="line">    p = 1801 * random.getrandbits(1012) + 1</span><br><span class="line">    while not isPrime(p):</span><br><span class="line">        p = 1801 * random.getrandbits(1012) + 1</span><br><span class="line">    return p</span><br><span class="line">p=gen()</span><br><span class="line">q=gen()</span><br><span class="line">e=1801</span><br><span class="line">n=p*q</span><br><span class="line">flag=&#x27;NSSCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span><br><span class="line">flag=flag+&#x27;yhe92871899hihiohh97709ujojl;lhdiwoqu903YE98Y299HDY8W9EYRW8!$$%!$!$FSR@#$@%FSEGDRYERYHRWER@$%^$^DGTW%$^&amp;GRWR@$%@FASFSFQFSTGW#TWGARWQ$@%WGVDSGADQR@%TGVDSFASDATWEGHWE%@$GSDVSFQATY$^#^%@$!RAFSDGDRTW&#x27;</span><br><span class="line"></span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&#x27;e=&#x27;,e)</span><br><span class="line">print(&#x27;p=&#x27;,p)</span><br><span class="line">print(&#x27;q=&#x27;,q)</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line"></span><br><span class="line">#e= 1801</span><br><span class="line">#p= 49610229352589717245227429186510630298995334563536199979797365135356894947505595171590737127611751124743823204969291853243936699113293137172961540731655194113111189561603261168928406442577570919901769348742992633428864861175880441682752947688509869668929473479230018031647980097396415380123118521799468844841</span><br><span class="line">#q= 21081926656979729045764441706195868361643779935106260715219328461497406780587336009385210898093496090213306812904410650499587043699660339207567766840318127296396962037273317168795761421233687815992929975284592353117739413561939283754964442896468496199833988666060155459156116345763999855126020972915904618043</span><br><span class="line">#c= 601596145172542477058917394071994325109856881057412872218601643742101914635753765731910337249806643258952637146341530783703613931109366648847232809553067941206928974141651198815184695746636818122414926015513095322872645068410957200062317958684872682628646759817233433643987003499153702624673493727886566639667597997520471371146056861227114668317633291934130573158877960548655006208725827943739971068608175370661619328559766977175575896437656636083179668805135271793023165492681941002853661303072959879197775224449456951125268328000206540965011249895216257583247180682482954741912101069920760903900864428405997751199</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import time</span><br><span class="line">import random</span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line">e= 1801</span><br><span class="line">p= 49610229352589717245227429186510630298995334563536199979797365135356894947505595171590737127611751124743823204969291853243936699113293137172961540731655194113111189561603261168928406442577570919901769348742992633428864861175880441682752947688509869668929473479230018031647980097396415380123118521799468844841</span><br><span class="line">q= 21081926656979729045764441706195868361643779935106260715219328461497406780587336009385210898093496090213306812904410650499587043699660339207567766840318127296396962037273317168795761421233687815992929975284592353117739413561939283754964442896468496199833988666060155459156116345763999855126020972915904618043</span><br><span class="line">c= 601596145172542477058917394071994325109856881057412872218601643742101914635753765731910337249806643258952637146341530783703613931109366648847232809553067941206928974141651198815184695746636818122414926015513095322872645068410957200062317958684872682628646759817233433643987003499153702624673493727886566639667597997520471371146056861227114668317633291934130573158877960548655006208725827943739971068608175370661619328559766977175575896437656636083179668805135271793023165492681941002853661303072959879197775224449456951125268328000206540965011249895216257583247180682482954741912101069920760903900864428405997751199</span><br><span class="line"></span><br><span class="line">def AMM(o, r, q):</span><br><span class="line">    start = time.time()</span><br><span class="line">    print(&#x27;\n----------------------------------------------------------------------------------&#x27;)</span><br><span class="line">    print(&#x27;Start to run Adleman-Manders-Miller Root Extraction Method&#x27;)</span><br><span class="line">    print(&#x27;Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;&#x27;.format(r, o, q))</span><br><span class="line">    g = GF(q)</span><br><span class="line">    o = g(o)</span><br><span class="line">    p = g(random.randint(1, q))</span><br><span class="line">    while p ^ ((q-1) // r) == 1:</span><br><span class="line">        p = g(random.randint(1, q))</span><br><span class="line">    print(&#x27;[+] Find p:&#123;&#125;&#x27;.format(p))</span><br><span class="line">    t = 0</span><br><span class="line">    s = q - 1</span><br><span class="line">    while s % r == 0:</span><br><span class="line">        t += 1</span><br><span class="line">        s = s // r</span><br><span class="line">    print(&#x27;[+] Find s:&#123;&#125;, t:&#123;&#125;&#x27;.format(s, t))</span><br><span class="line">    k = 1</span><br><span class="line">    while (k * s + 1) % r != 0:</span><br><span class="line">        k += 1</span><br><span class="line">    alp = (k * s + 1) // r</span><br><span class="line">    print(&#x27;[+] Find alp:&#123;&#125;&#x27;.format(alp))</span><br><span class="line">    a = p ^ (r**(t-1) * s)</span><br><span class="line">    b = o ^ (r*alp - 1)</span><br><span class="line">    c = p ^ s</span><br><span class="line">    h = 1</span><br><span class="line">    for i in range(1, t):</span><br><span class="line">        d = b ^ (r^(t-1-i))</span><br><span class="line">        if d == 1:</span><br><span class="line">            j = 0</span><br><span class="line">        else:</span><br><span class="line">            print(&#x27;[+] Calculating DLP...&#x27;)</span><br><span class="line">            j = - discrete_log(a, d)</span><br><span class="line">            print(&#x27;[+] Finish DLP...&#x27;)</span><br><span class="line">        b = b * (c^r)^j</span><br><span class="line">        h = h * c^j</span><br><span class="line">        c = c ^ r</span><br><span class="line">    result = o^alp * h</span><br><span class="line">    end = time.time()</span><br><span class="line">    print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start))</span><br><span class="line">    print(&#x27;Find one solution: &#123;&#125;&#x27;.format(result))</span><br><span class="line">    return result</span><br><span class="line">def findAllPRoot(p, e):</span><br><span class="line">    print(&quot;Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;.&quot;.format(e, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    proot = set()</span><br><span class="line">    while len(proot) &lt; e:</span><br><span class="line">        proot.add(pow(random.randint(2, p-1), (p-1)//e, p))</span><br><span class="line">    end = time.time()</span><br><span class="line">    print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start))</span><br><span class="line">    return proot</span><br><span class="line"></span><br><span class="line">def findAllSolutions(mp, proot, cp, p):</span><br><span class="line">    print(&quot;Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;.&quot;.format(e, cp, p))</span><br><span class="line">    start = time.time()</span><br><span class="line">    all_mp = set()</span><br><span class="line">    for root in proot:</span><br><span class="line">        mp2 = mp * root % p</span><br><span class="line">        assert(pow(mp2, e, p) == cp)</span><br><span class="line">        all_mp.add(mp2)</span><br><span class="line">    end = time.time()</span><br><span class="line">    print(&quot;Finished in &#123;&#125; seconds.&quot;.format(end - start))</span><br><span class="line">    return all_mp</span><br><span class="line"></span><br><span class="line">cp = c % p</span><br><span class="line">cq = c % q</span><br><span class="line"></span><br><span class="line">mp = AMM(cp,e,p)</span><br><span class="line">mq = AMM(cq,e,q)</span><br><span class="line"></span><br><span class="line">p_proot = findAllPRoot(p,e)</span><br><span class="line">q_proot = findAllPRoot(q,e)</span><br><span class="line">mps = findAllSolutions(mp, p_proot, cp, p)</span><br><span class="line">mqs = findAllSolutions(mq,q_proot,cq,q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#遍历所有可能</span><br><span class="line">for mpp in tqdm(mps):</span><br><span class="line">    for mqq in mqs:</span><br><span class="line">        ai = [int(mpp),int(mqq)]</span><br><span class="line">        mi = [p,q]</span><br><span class="line">        m = CRT_list(ai,mi)</span><br><span class="line">        flag = long_to_bytes(m)</span><br><span class="line">        if b&#x27;NSSCTF&#x27; in flag:</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<p><code>mp = AMM(cp,e,p)</code>，<code>mq = AMM(cq,e,q)</code>解$mp \equiv m^e \mod p$和$mq \equiv m^e \mod q$</p>
<p><code>p_proot = findAllPRoot(p,e)</code>，<code>q_proot = findAllPRoot(q,e)</code>这个不太明白求的啥</p>
<p><code>mps = findAllSolutions(mp, p_proot, cp, p)</code>，<code>mqs = findAllSolutions(mq,q_proot,cq,q)</code>这应该是m的所有情况</p>
<p>最后遍历求解CRT</p>
<h1 id="二十一、共模攻击变形"><a href="#二十一、共模攻击变形" class="headerlink" title="二十一、共模攻击变形"></a>二十一、共模攻击变形</h1><h2 id="情况1：e1-e2不互素"><a href="#情况1：e1-e2不互素" class="headerlink" title="情况1：e1,e2不互素"></a>情况1：e1,e2不互素</h2><p><strong>e1,e2不互素，即gcd(e1,e2)!&#x3D;1</strong></p>
<p><strong>令t &#x3D; gcd(e1,e2)</strong><br>$$<br>由文章前面的共模攻击式子c_{1}^{x}×c_2^{y}(mod \quad n) \equiv m^{t}(mod \quad n)<br>$$</p>
<p>$$<br>则m^{t} &#x3D; k×n + c_{1}^{x}×c_2^{y}<br>$$</p>
<h2 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">k = 1024</span><br><span class="line">while 1:</span><br><span class="line">    flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">    m = libnum.s2n(flag)</span><br><span class="line">    p = libnum.generate_prime(k)</span><br><span class="line">    q = libnum.generate_prime(k)</span><br><span class="line">    n = p * q</span><br><span class="line">    tmp = libnum.generate_prime(4)</span><br><span class="line">    e1 = libnum.generate_prime(5) * tmp</span><br><span class="line">    e2 = libnum.generate_prime(5) * tmp</span><br><span class="line">    tmp2 = gmpy2.bit_length(m ** tmp) - gmpy2.bit_length(n)</span><br><span class="line">    if e1 != e2 and tmp2 &lt; 5:</span><br><span class="line">        break</span><br><span class="line">    k += tmp2 // 2</span><br><span class="line">print(flag)</span><br><span class="line">c1 = pow(m, e1, n)</span><br><span class="line">c2 = pow(m, e2, n)</span><br><span class="line">print(&quot;e1=&quot;, e1)</span><br><span class="line">print(&quot;e2=&quot;, e2)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;c1=&quot;, c1)</span><br><span class="line">print(&quot;c2=&quot;, c2)</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">19474678913649097258390489993698634404112354172317306010023197847156694099670721761327194851970009271581549666788645497433190056135299423904183196428211720097778383008788705222994940143654464858441904620596484596346512546258221838544477940550376396677203257379949758730938581258992871705570847922776599616915733519585215572243928291618659043825329209345158300980691318185817290940425730134338749693091572842746733673342908172635417820608641805710421185052054000066207235255914663558591276027965181111243394719238943210391460931903101227440963377665461618104834863663740849922340905053750264657441352910246039293609643367940051324465147023474243224362152913517822894213761331561654655858920728085714369310139310386378474433039346461001868308134135362298325390206249247092133402040374395517273415606661403933705390825879552537393088886944922940487264224704885259420580277404667343842400220922804505835566052496110575752288394130226305637409179824473762478444360732822396393944426314881434132408204638085190098614163118051368269424038473349620971134861134137603699098720960181628570503797869982072783254713064905276853023938893875178460261697758362279989965392026805157348131834895995251415105178938979192148748647493811243573203145688897449401412372097795961539772849014562325239101253682046332206756094565291781</span></span><br><span class="line">e1 = <span class="number">319</span></span><br><span class="line">e2 = <span class="number">341</span></span><br><span class="line">c1 = <span class="number">16842097487578929747386013933836071311636435180786000333183479444850916208499056286293221277419396487143548868011121687411419006933297728370852363750322035680140458385936896809702003278914760352066710772774379515794440911494571101054875370632979664627428088945978102656878992542056983359586963711617334422080699715850848901481895781439634119925073029944688100348409613155880974748998758622098311059613939789339423339992132464171174123104436742936539749038386100174285273092064872962110961174532333866649632099684432465861670566720188498096950478835609006702822832535569740279550564709018652584734393583891347283516641024482147655707303660809974605932283320751419752851004868386620860461774410841309524864393100974165736049945040671353974167039407791367110609972671777553345885631486896801519491159873075020494968481046661647097363668961350255292613493490519231790196337146698217641580380569238319274538735600036562195973041732846936373910618424923755644620392149451787477945923716935327549760919227680773560668256346588136223461189956081899893679417046303238188505187585679903927787518164246954458038170693402350055866777159897918079058465076803320663064873176102836775732642340270760113509631774744076482366969652954901984726320611635556882140186758717303319295278262405745747267175536641440355265151505738959</span></span><br><span class="line">c2 = <span class="number">11882419292262439388395815852169631237359134106011110793207416772099869060262304736871190266614921889223922727440751243951466369747401979020372872126460796866664490364229918484890553550414970820526722511330604028963190564560830894577762895849951145089870332361493102336506523261215879020663433735193233792538730505795660978392622223090008019752787535539689555015412414444298098846960023750837015644522855346725774495736882904164804735576222229185641453887995254842617056884667691768874085981289380925271203339962843240701273777372488844619509988897713312382774750017391240294108840393576680678601939550735366514705783804254529195233406624997337321421836044641264988646831661593186219714359601246011436856726899017296455579882011341041715930436749266151654712590104320876653590775164982704496112329832684267637475509804745971848571244643987731101962814164824430221486667978354093400800773401904607552500150032713777036941455622982693087120359170639049551330567886289216980990770976252462925360856027498185494737491836702182511810948819989831212562989917938207204621062194173157840590954059982130144900289024500353220236075815227481710808333065928147587957726526698953469304559157057103278333800243155467404900528439556287027032253160322365280145370850141701695659907382027163725331629255756528099014003526137133</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.gcd(e1,e2)</span><br><span class="line"><span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">    s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">    m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n))%n</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        m = gmpy2.iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)+k*n)%n,t)</span><br><span class="line">        <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="情况2：给e1与e2的积"><a href="#情况2：给e1与e2的积" class="headerlink" title="情况2：给e1与e2的积"></a>情况2：给e1与e2的积</h2><p><strong>爆破e1，剩下的步骤和上题一样</strong></p>
<h2 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">k = 1024</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">while 1:</span><br><span class="line">    p = libnum.generate_prime(k)</span><br><span class="line">    q = libnum.generate_prime(k)</span><br><span class="line">    n = p * q</span><br><span class="line">    tmp = libnum.generate_prime(4)</span><br><span class="line">    e1 = libnum.generate_prime(5) * tmp</span><br><span class="line">    e2 = libnum.generate_prime(5) * tmp</span><br><span class="line">    tmp2 = gmpy2.bit_length(m ** tmp) - gmpy2.bit_length(n)</span><br><span class="line">    if e1 != e2 and tmp2 &lt; 5:</span><br><span class="line">        break</span><br><span class="line">    k += tmp2 // 2</span><br><span class="line">print(flag)</span><br><span class="line">c1 = pow(m, e1, n)</span><br><span class="line">c2 = pow(m, e2, n)</span><br><span class="line">print(&quot;e1*e2=&quot;, e1 * e2)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;c1=&quot;, c1)</span><br><span class="line">print(&quot;c2=&quot;, c2)</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e1e2 = <span class="number">83317</span></span><br><span class="line">n = <span class="number">19361442710572745971265661179912428614335978862294499554478708154961900725571203060796104846289397242207304532314240136962004100859120350866177200389723065658762704195258332314791286248842309297348039111045266185355903400590470820183877252896166548216731371364979378507526744861441605219478410567943584909399458417880788827318597539692741384869777249157338164956516233081381729474311604082892186490173033244693551617094635430697205804969501877592642316320873084247185093376277647579480643486369145925195734181193015900482737320548696928588870712293186252013457131251209473809656777543374500592007808404407059561585875569527546497652518580045435210514546460508584320606314122520882426004609258608147903667923350952560862343978526661419457923377730038903725129920335146125419046956321000719022303404018007514471776998828154744785228693422230685108494515083105086516002742258455143048441346760686508352771381755359768486489070279892078844716848637514485979868052449468414483027672075237348001190373461535494802211938683204976566773050049547807712425194913096401165728862378611187510228222428679755307056276133497536735863204478321549958435946853973687386589497836951783399492540878952618631792625025126620608024559471293131768988077589502325651357976822933654550846615039529755326862460868499406888969184042128071</span></span><br><span class="line">c1 = <span class="number">8461455935702774839606732696628583481106108739457157757237961493721249315707058365854463354773540401038228236301572933195823206925383589280380438344346918293151928169930134045632956081184945062566817678757614816611860006425866597730747864519352309046720733870943424680296477704991108084039103348714387678260925701357278152801810444616098214964231942511332731906589339642434586792884729500618636404879133808745489823990051381479316035290316511507860259556699539853817794899071305575419968794233519130191693519669424965740754005557268523536259961342893331243822271702601491251166024629032785331163334845458532041066873062181204642511730061193181806412423310871852101503714865811232852678040552266896756835104015126426669170036333066668010437674021104622132437422087899276215087590613842963706972249810831528040008304175911799215946803926073839260039708714727246670180210772138254229999545871929350538204078637835690649108982156556159082202035891312400182426109033284706424624286874595070797624804888642649414098331802113837492380725023537502746076689560748513729573164798419260068335949704460969862627638288475890309143274515210188524564546972793051029662396980537597835874860939675476734819945549433268818379519178647303476509820821756282974287073312744339124424284365074314353072957540119217061097316369179812</span></span><br><span class="line">c2 = <span class="number">6204846642785521340470513546335239064256758077473460303136152226321426573866713276868303467627807818878464124001025948893472833684203082226317608116339642653526005250588488719287359040352790572959995584093188339849695217956472022875459556871491299322868787108334073007332501731796096022506406756118808831646084743403979543281704069120640233328839980099290857269846287187888156728145277024309531510105331797866833685076835273931526615042292719970926967658919153638762985362453791732734631621502983351581711188066449777097203043897589205329057225446193852593056040301734809364853181753118739604843784216536562612033307359103893806510482236157475021740603255590914121641809865052126419196638531405221094438510231726208366630512008162663744010330103156199459170979721924714894281792427651932643530734043790246173905509400532261288534889712214483873969552991657537356198890952147322594953541508366871552561029095676172024539741525694906063413062943730465813047155464168544196529490081901356676689826701155342513241655234549380041635792150618405682571311160853526719882812618473055821608217492122688669131559593093840370537049894579011917334477512297137182557102626033423909278319394496823138854073015927815382203590762482110896381565689852266596980436613904791614372199019839459027972129220041158226866818118745059</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getM</span>(<span class="params">c1,c2,n,e1,e2</span>):</span><br><span class="line">    t = gmpy2.gcd(e1,e2)</span><br><span class="line">    s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">    <span class="keyword">if</span> t == <span class="number">1</span>:</span><br><span class="line">        m = (<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)) % n</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">            m = gmpy2.iroot((<span class="built_in">pow</span>(c1,x,n)*<span class="built_in">pow</span>(c2,y,n)%n + k*n),t)</span><br><span class="line">            <span class="keyword">if</span> m[<span class="number">1</span>]:</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(m[<span class="number">0</span>]))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> e1 <span class="keyword">in</span> trange(<span class="number">2</span>,e1e2):</span><br><span class="line">    <span class="keyword">if</span> e1e2 % e1 == <span class="number">0</span>:</span><br><span class="line">        e2 = e1e2 // e1</span><br><span class="line">        getM(c1,c2,n,e1,e2)</span><br></pre></td></tr></table></figure>



<h1 id="二十二、有限域开根"><a href="#二十二、有限域开根" class="headerlink" title="二十二、有限域开根"></a>二十二、有限域开根</h1><p><img src="/../../images/RSA/27.png"></p>
<h2 id="例题-5"><a href="#例题-5" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">e = 3</span><br><span class="line">while 1:</span><br><span class="line">    p = libnum.generate_prime(512)</span><br><span class="line">    q = libnum.generate_prime(512)</span><br><span class="line">    if (p-1)%e==0 and (q-1)%e==0:</span><br><span class="line">        break</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(flag)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;p=&quot;, p)</span><br><span class="line">print(&quot;q=&quot;, q)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;e=&quot;, e)</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n= 121176731012001774237554071517040520577093770585955284890111028833900485089366205861576854434071097785955426453274958947131350219079586688700799708437106991966824326227553177949832737829545215209285207091478265075229855158613766143623542365107905898499683217014784504271360637893610456050551417371109126935821</span><br><span class="line">p= 10294176862573184144889118081794828535963562542939700829097058698645551123632548241827576303461162025955304087621384738534602927608805520033003847729857913</span><br><span class="line">q= 11771386156436390390172944429184462613445295630519275927285184850353982566452678162531101585333236216451833768663392626736188991033254470541757714968120117</span><br><span class="line">c= 175676150266389842655713989253086844293109999214244727442799978297124143551654073679017014994908058988402189906092896028837004244573045641687986771129134527809468892554529220740843297716181676421633164172513308088943719087506588619693643820162046871380739428618325418829978973366928721397921633930049637</span><br><span class="line">e= 3</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x^e - c</span><br><span class="line">f.monic()</span><br><span class="line">res1 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">f = x^e - c</span><br><span class="line">f.monic()</span><br><span class="line">res2 = f.roots()</span><br><span class="line"></span><br><span class="line">for i in res1:</span><br><span class="line">    for j in res2:</span><br><span class="line">        n_list = [int(i[0]),int(j[0])]</span><br><span class="line">        a_list = [p,q]</span><br><span class="line">        m = CRT_list(n_list,a_list)</span><br><span class="line">        flag = long_to_bytes(int(m))</span><br><span class="line">        print(flag)</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<h2 id="2022强网杯——ASR"><a href="#2022强网杯——ASR" class="headerlink" title="2022强网杯——ASR"></a>2022强网杯——ASR</h2><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import getPrime</span><br><span class="line">from secret import falg</span><br><span class="line">pad = lambda s:s + bytes([(len(s)-1)%16+1]*((len(s)-1)%16+1))</span><br><span class="line"></span><br><span class="line">n = getPrime(128)**2 * getPrime(128)**2 * getPrime(128)**2 * getPrime(128)**2</span><br><span class="line">e = 3</span><br><span class="line"></span><br><span class="line">flag = pad(flag)</span><br><span class="line">print(flag)</span><br><span class="line">assert(len(flag) &gt;= 48)</span><br><span class="line">m = int.from_bytes(flag,&#x27;big&#x27;)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(f&#x27;n = &#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;e = &#123;e&#125;&#x27;)</span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">n = </span><br><span class="line">e = 3</span><br><span class="line">c = </span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>$m^e &gt; n$，不能直接开e次方</p>
<p>$\because c \equiv m^e \mod n$</p>
<p>发现$n &#x3D; (p×q×r×t)^2$<br>网站分解出$p,q,r,t$<br>则c满足下式</p>
<p><img src="/../../images/RSA/48.png"></p>
<p>有限域开根求出$mp,mq,mr,mt$<br>然后用中国剩余定理</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span><br><span class="line">c = <span class="number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">218566259296037866647273372633238739089</span></span><br><span class="line">q = <span class="number">223213222467584072959434495118689164399</span></span><br><span class="line">r = <span class="number">225933944608558304529179430753170813347</span></span><br><span class="line">t = <span class="number">260594583349478633632570848336184053653</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">mp = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(q))</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">mq = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(r))</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">mr = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(t))</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">mt = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> mp:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> mq:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> mr:</span><br><span class="line">            <span class="keyword">for</span> b <span class="keyword">in</span> mt:</span><br><span class="line">                m_list = [<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>]),<span class="built_in">int</span>(k[<span class="number">0</span>]),<span class="built_in">int</span>(b[<span class="number">0</span>])]</span><br><span class="line">                a_list = [p,q,r,t]</span><br><span class="line">                m = CRT_list(m_list,a_list)</span><br><span class="line">                flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="二十三、三个素数的维纳攻击"><a href="#二十三、三个素数的维纳攻击" class="headerlink" title="二十三、三个素数的维纳攻击"></a>二十三、三个素数的维纳攻击</h1><p>存了个脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def wiener(e, n):</span><br><span class="line">    m = 12345</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    q0 = 1</span><br><span class="line">    list1 = continued_fraction(Integer(e) / Integer(n))</span><br><span class="line">    conv = list1.convergents()</span><br><span class="line">    for i in conv:</span><br><span class="line">        k = i.numerator()</span><br><span class="line">        q1 = i.denominator()</span><br><span class="line">        for r in range(20):</span><br><span class="line">            for s in range(20):</span><br><span class="line">                d = r * q1 + s * q0</span><br><span class="line">                m1 = pow(c, d, n)</span><br><span class="line">                if m1 == m:</span><br><span class="line">                    return d</span><br><span class="line">        q0 = q1</span><br><span class="line"></span><br><span class="line">n = 1051380872316823433883636764584789285333736434524933570584976014001214015195582230652890036553897972507709868668015209942849015953126067065245745528656185713975834472569979390688522786334308265267342203713851528468719085926942222541344057327637925939220941677328780957242592769934672272901444344368132925072596706265951382183962516395989020286284674233929275036820658314907868575906130423049124591076625494555958927499995127864266451094815485831694951169813864579090722449382301556276181043387840715294133205479396272801536638003449150191833236756230648343641542001617352347728075031395009393805016183916046647042759712436405458561551257959973189661621088021485676031370872948254252297718720969276447566410825701049555286286171854286210170310303122812022424180992567945938220732070586725895910160295026510702457152084383868466740490026825254620849716745141621210206706738899418272128830937154184366826368016614460538955646609</span><br><span class="line"># p*r*q</span><br><span class="line">e = 401736266490324552517217032225246450087649254466718075727966287757972026925163477893539047721223580215545684494442007744774900721388024851291175127388784748482162997733029569314385345465782341732251402815344448962923207292061517106665954257137567332560956608813590130048988674456360832136718517222056109287921167927946304453828334895683526480626294649396329610693963520850896266343295069273447109718037817671775114733403154525393468056590686142168244467303584451585069101584798590889529292526446832857035880715351476044875846461493125136227486230514153648388383654116769560511713813660841282782474519612727725715364718394717990336084691567425849567195154254431858216101902309862385524999911892987920197370958210721993073768994565808825036701082088990540391431078200077738350023726344360396487614841476654096629864029557926380538230445278881935443675347998379733770494280427033480933837349115145552011734379818969027809471037</span><br><span class="line">d=wiener(e, n)</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>



<h1 id="二十四、q-inverse-e-p"><a href="#二十四、q-inverse-e-p" class="headerlink" title="二十四、q &#x3D; inverse(e,p)"></a>二十四、q &#x3D; inverse(e,p)</h1><h2 id="例题-6"><a href="#例题-6" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">while 1:</span><br><span class="line">    p = libnum.generate_prime(512)</span><br><span class="line">    q = libnum.invmod(e, p)</span><br><span class="line">    if gmpy2.is_prime(q):</span><br><span class="line">        break</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/28.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">58204114420266684815970658378327773998564393394613074044159240444415512492622689982761518905542522328879289101538953676661805875053162972893258897360344016406294652339343767887745752686437325346837603712186500309908703326587069304255508650910107794737000566778637055164127273830551001009133332601839918695739</span></span><br><span class="line">c = <span class="number">43430611858598126654595145883807180034546121754009334579568652220639483233618841529702503298293207886941913478597477904682701187000781983315547295293641024286170190626012102497319037012751300959255076727985925313853559910457404758461819072120343343943528618993507783981659418177044469142912677141806591464788</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">k = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    t = gmpy2.iroot((<span class="number">4</span>*k*e*n + <span class="number">1</span>),<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> t[<span class="number">1</span>]:</span><br><span class="line">        p = (t[<span class="number">0</span>]-<span class="number">1</span>) // (<span class="number">2</span>*k)</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="built_in">print</span>(q)</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h1 id="二十五、e-2-n-有限域开方"><a href="#二十五、e-2-n-有限域开方" class="headerlink" title="二十五、e &#x3D; 2^n(有限域开方)"></a>二十五、e &#x3D; 2^n(有限域开方)</h1><h2 id="例题-7"><a href="#例题-7" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">e = 2**4</span><br><span class="line">n=libnum.generate_prime(512)</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">n= 6706056417909032146977148210894497447322670892758026214857499040210310599424027594966978579750086907555556785153774781114612452198663154506193494869117293</span><br><span class="line">c= 1242680122077482326416451537576315381462840270521607042121188408927264012190282446465124987976978765626943470962693854431894739138078757743809643142105235</span><br><span class="line">e= 16</span><br></pre></td></tr></table></figure>

<p><strong>类似于上面的有限域开方，这里只需要在modn的域内开方，比上面的少了一步</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n = 6706056417909032146977148210894497447322670892758026214857499040210310599424027594966978579750086907555556785153774781114612452198663154506193494869117293</span><br><span class="line">c = 1242680122077482326416451537576315381462840270521607042121188408927264012190282446465124987976978765626943470962693854431894739138078757743809643142105235</span><br><span class="line">e = 16</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = x^e - c</span><br><span class="line">f.monic()</span><br><span class="line">roots = f.roots()</span><br><span class="line"></span><br><span class="line">for i in roots:</span><br><span class="line">    print(long_to_bytes(int(i[0])))</span><br></pre></td></tr></table></figure>



<h1 id="二十六、inverse-p-q-和inverse-q-p"><a href="#二十六、inverse-p-q-和inverse-q-p" class="headerlink" title="二十六、inverse(p,q)和inverse(q,p)"></a>二十六、inverse(p,q)和inverse(q,p)</h1><h2 id="1-已知phi"><a href="#1-已知phi" class="headerlink" title="1.已知phi"></a>1.已知phi</h2><h3 id="例题-8"><a href="#例题-8" class="headerlink" title="例题"></a>例题</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="comment"># print(flag)</span></span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">pinv = gmpy2.invert(p, q)</span><br><span class="line">qinv = gmpy2.invert(q, p)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e=&quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;phi=&quot;</span>, phi)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pinv=&quot;</span>, pinv)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;qinv=&quot;</span>, qinv)</span><br><span class="line"></span><br><span class="line"><span class="comment">#e = 65537</span></span><br><span class="line"><span class="comment">#phi = 98229890689284912089157469320766533791995454910192245906925225670195818406213091522014617153508961926275340781138620279250871290490873820930414041953789279215193143006258942396087516751221787778485548659324564021606857623517821094138942269722883193348321303203233297445863729579811837657596605227772947768080</span></span><br><span class="line"><span class="comment">#c = 20962649632855841088231373617057756055795073764826640468523117901947795570191538819434503909156672490273164571512993513456958532656058586024929659925126633909116178539998046336126716552474329852733455142305774551889295732464058882055828240152313078876041502758035842268176085433166898402827107253041748761839</span></span><br><span class="line"><span class="comment">#p1 = 9278107621912111502897373552245845971739215588186465664496052995069919521787577753719495078780428864673954897367324663969013147023292682927178810784000630</span></span><br><span class="line"><span class="comment">#q1 = 1888254482465757731585051308443185269531054824465971018646930721602120686960471254468405491101133069657301849498853283496490197246867160626826664577479894</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/29.png"></p>
<p><strong>解方程组就可以得到p,q</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = <span class="number">98229890689284912089157469320766533791995454910192245906925225670195818406213091522014617153508961926275340781138620279250871290490873820930414041953789279215193143006258942396087516751221787778485548659324564021606857623517821094138942269722883193348321303203233297445863729579811837657596605227772947768080</span></span><br><span class="line">c = <span class="number">20962649632855841088231373617057756055795073764826640468523117901947795570191538819434503909156672490273164571512993513456958532656058586024929659925126633909116178539998046336126716552474329852733455142305774551889295732464058882055828240152313078876041502758035842268176085433166898402827107253041748761839</span></span><br><span class="line">p1 = <span class="number">9278107621912111502897373552245845971739215588186465664496052995069919521787577753719495078780428864673954897367324663969013147023292682927178810784000630</span></span><br><span class="line">q1 = <span class="number">1888254482465757731585051308443185269531054824465971018646930721602120686960471254468405491101133069657301849498853283496490197246867160626826664577479894</span></span><br><span class="line"></span><br><span class="line">p = sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1 = p*p1 + q*q1 - <span class="number">1</span> - p*q</span><br><span class="line">f2 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>) - phi</span><br><span class="line"></span><br><span class="line">solve = sympy.solve((f1,f2),(p,q))</span><br><span class="line"></span><br><span class="line">p = solve[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">q = solve[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,<span class="built_in">int</span>(n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">solve = [(22821479829759765249174158952963874504485986220619519269945583682564626268153743665526959332259951623597980273481165822290699158799779287591018079524989452861477827065749603046033438266476630644267862116418758098665007225158018687307221410295239838141742225128229743535936788871193288880270908998572787273667/9278107621912111502897373552245845971739215588186465664496052995069919521787577753719495078780428864673954897367324663969013147023292682927178810784000629, 75408410859525146839983310367802659287509468689572726636979641987631192138059347856487657821249010302677360507657454456960172131691094533339395962428799826353715315940509339350054078484745157134217686542905805922941850398359802406831720859427643355206579078075003553909926940708618548777325696229200160494413/1888254482465757731585051308443185269531054824465971018646930721602120686960471254468405491101133069657301849498853283496490197246867160626826664577479893), (8127563715841478757107960610706814401795230571120378813999159491557998089646611933175962412935611382853782409928576209320232898704593007140413385039209881, 12086019147143011196785992116890856402329280587171998344184616275731354798756009671338164277159323344037197449252782729162677126269020429021047263806975767)]</span><br></pre></td></tr></table></figure>

<p><strong>因为前面的数字太大了，不可能是p,q</strong></p>
<h2 id="2-已知e-d-phi"><a href="#2-已知e-d-phi" class="headerlink" title="2.已知e,d,phi"></a>2.已知e,d,phi</h2><h3 id="例题-9"><a href="#例题-9" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(1024)</span><br><span class="line">q = libnum.generate_prime(1024)</span><br><span class="line">e = 65537</span><br><span class="line">n=p*q</span><br><span class="line">p1=libnum.invmod(p,q)</span><br><span class="line">q1=libnum.invmod(q,p)</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">print(phi)</span><br><span class="line">d=libnum.invmod(e,phi)</span><br><span class="line"></span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;p1=&quot;,p1)</span><br><span class="line">print(&quot;q1=&quot;,q1)</span><br><span class="line">print(&quot;d=&quot;,d)</span><br><span class="line">print(&quot;e=&quot;,e)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br></pre></td></tr></table></figure>

<p><strong>其实给d也没区别，终究是要求p,q</strong></p>
<p><strong>套上面脚本就行，没区别</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p1= <span class="number">97656077071270197914785321263555295398683131376741279762023269752748032446917564784973530125497364995807144029368514414686812526434051342203148587548869714362392149049199571504107521002327725946079985444111124295505554135534791115828253787424842366876671199369039838469527700802048214832651973914615014793434</span></span><br><span class="line">q1= <span class="number">39346433326508892813150536257919182675225716975877498778468626666265319210911093864684217868389854790505495572529483241732413112619372606685748980784688553398278315703981192828280813023954306657912647634729098972136705540024619937335024692325575092594446158807029214788285050359047781519982931005193436553164</span></span><br><span class="line"><span class="comment">#d= 13982206046522221689006948762375515892286671914597370002120896052266280914021885507889789598565474633660266121772385535949954654478591294089438758529565129571215458972099907852294228150256147359389834287744392536374255187239416806275744570662248893522074706262730636918053134499811014564470545819778015584753659205965073426501902382941707278051440033966771995946005135307665514929445057737703258338176975384665564222178081103000139437728386604903444661523794053627011660691133434801451813006697587015285256584456452850523012639216643290392821724776006584995172392016576699118057963479401425915020921720042294733838337</span></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">c= <span class="number">13235028416286929520160810669079534965765212020283157183506000327481359053022089166886460096491962822206497841520395685863417454564782563002357235184688540460362871929729166716636143577909568477095287025119038866855396071566223268818065261766734924398179202129826294778702597618099032226876112654250403885134458713788086798004345808257538019652522209856828455756694071035571007463724635674562294436700546760823969026149755043139120494280665479551005965472492371422616161244117935709924215027494208339801474837499105640735072011664365891939864038690374913413240430803230704628673411107455299647523018041707726365601893</span></span><br><span class="line">phi=<span class="number">16033591784555690839033601641933863819862675274128076669740291933394723758788009352788583792713912217703542497595829207543956085361202366334328595985304274508481724780489075813896396106581346750635700757907059309496772854950127016253035273087412614339939285140337656629662098889174735118835844089284571097739371559723771996652001268037000802800553357819154820449211550823391567258031927998247803081416301018071582489307196620368843405837158330864310134068534625079672858460155583646814590373389203531298114865193213718937686858488611970228064763729093357377320357215677266414126622909951204685623007887150263682313184</span></span><br><span class="line"></span><br><span class="line">p = sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1 = p*p1 + q*q1 - <span class="number">1</span> - p*q</span><br><span class="line">f2 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>) - phi</span><br><span class="line"></span><br><span class="line">solve = sympy.solve((f1,f2),(p,q))</span><br><span class="line"></span><br><span class="line">p = solve[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">q = solve[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,<span class="built_in">int</span>(n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h2 id="3-变形"><a href="#3-变形" class="headerlink" title="3.变形"></a>3.变形</h2><h3 id="例题-10"><a href="#例题-10" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line"># print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">p1 = gmpy2.invert(p, q)-q</span><br><span class="line">q1 = gmpy2.invert(q, p)-p</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">print(&quot;e=&quot;, e)</span><br><span class="line">print(&quot;phi=&quot;, phi)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">print(&quot;p1=&quot;, p1)</span><br><span class="line">print(&quot;q1=&quot;, q1)</span><br></pre></td></tr></table></figure>

<p><strong>给的invert(p,q)-q和invert(q,p)-p</strong></p>
<p><img src="/../../images/RSA/30.png"></p>
<p><img src="/../../images/RSA/31.png"></p>
<p><strong>所以还是解方程组</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">phi= <span class="number">153526208973286457920479376447622546334064100044507994947932972947056601063592943200823498761273906685365632931851181655405163001559274037884326450823919640514634182433839200397012200852498394907718538509040702321554785017853186412670980153149366201235845635320919980848682144430326738538775142630420821822960</span></span><br><span class="line">c= <span class="number">45404866893480020010799585996788902747901025575540655893265307771493992595444010006643443639614244962689890716458286889196613281948316354607540970243071548624687668875908716690311985915197944902857988253464493234021796216923039652003206533181461815990153623141243415592031190212825941414063970906141991979873</span></span><br><span class="line">p1= -<span class="number">11065332660497699825690181811194036599102527446002445107664152730915570503984416572510322521934240155183790860963748546243230674204488210677533190963726687</span></span><br><span class="line">q1= -<span class="number">1516147835082043403956384639695921948575165356837676821387726774997348251688472575043896909177257102383857065378906848506987546488480618072779943395893217</span></span><br><span class="line"></span><br><span class="line">p = sympy.Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = sympy.Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f1 = p*p1 + q*q1 - <span class="number">1</span> + p*q</span><br><span class="line">f2 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>) - phi</span><br><span class="line"></span><br><span class="line">solve = sympy.solve((f1,f2),(p,q))</span><br><span class="line"></span><br><span class="line">p = solve[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">q = solve[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,<span class="built_in">int</span>(n))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="二十七、hint-pow-ap-b-q-n"><a href="#二十七、hint-pow-ap-b-q-n" class="headerlink" title="二十七、hint &#x3D; pow(ap+b,q,n)"></a>二十七、hint &#x3D; pow(ap+b,q,n)</h1><h2 id="例题-11"><a href="#例题-11" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line">import uuid</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line"></span><br><span class="line">e = 65537</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">hint = pow(2020 * p + 2021, q, n)</span><br><span class="line">print(f&#x27;n=&#123;n&#125;&#x27;)</span><br><span class="line">print(f&#x27;c=&#123;c&#125;&#x27;)</span><br><span class="line">print(f&#x27;hint=&#123;hint&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/32.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">27020725261160598541077357737650775795182555998856810737571508044949928734067444441660366270392732456051807439301564552672200975582350577967001486740668193835704559129378410828266554536148151615878808327988333060924165410762016082268322936465413880236634083213834739549234631742766416876749808978934944262651307600621868854944164060642189749365967978497831698002669974744487926082412272998646851047638183126945784060957075393737537570645086672473571281053798891685646561828588448040073373363454584468753860529849749093081434144360661566815886630699933232263079413562069476421802192735693386029862725050469209845710383</span></span><br><span class="line">c = <span class="number">10188807385387617708190575473905502994151677148079820873886980571555051900701810208218351138721306416600688313703084580808183634201231599134123549448962443376514560489130860694363901933597676373555599555647232128717993571185822894818704143675318690577221330618533739592165564396729937983659337232822442555504262694675199751730664450120569727835850996566436129543730932040989365233424791093843941154003052950306359994891955336607690065213304872738280674213630736611351982705373394299097653653497017756036211550125607093109216729483090391729134062236908282557149575812220142872855836932590459512028618076264332235518829</span></span><br><span class="line">hint = <span class="number">15179972145975733285419381814235528011288991423484121653543845156913121513320504879647666067298415751234264897435338898933073713420024176276221164394369781676781604128149168834126855517212300158864797800121336042194751965268493010327202598446572764475343894613152062609436699715193914479572113800212525965140106015838636914979735618606768207651697548364440806425770871133439416876157686985836939255598747973339866125864303982956813846287509191028829738926404992619459242904729015823730553526572575372668559669124599614613391797015393641171177282129497503752370800088634017972208535899870704612274473042064675033593148</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(<span class="built_in">pow</span>(<span class="number">2021</span>,n,n)-hint,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="二十八、hint-pow-ap-b-e-n"><a href="#二十八、hint-pow-ap-b-e-n" class="headerlink" title="二十八、hint &#x3D; pow(ap+b,e,n)"></a>二十八、hint &#x3D; pow(ap+b,e,n)</h1><p><img src="/../../images/RSA/33.png"></p>
<h2 id="例题-12"><a href="#例题-12" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line"></span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">m = libnum.s2n(flag)</span><br><span class="line">p = libnum.generate_prime(512)</span><br><span class="line">q = libnum.generate_prime(512)</span><br><span class="line">e = 65537</span><br><span class="line">n = p * q</span><br><span class="line">h = 20211102</span><br><span class="line">hc = pow(h + p * 1111, e, n)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">print(&quot;hc=&quot;, hc)</span><br><span class="line">print(&quot;n=&quot;, n)</span><br><span class="line">print(&quot;c=&quot;, c)</span><br><span class="line">hc = 71505320953946158049530109094654497075489963071106175336722892393493112481336409391299522595724154571954223093317880494307263262649833222750675105885636892419350501821324979706283867758665536771783209816719106279467902518895579024290387800216711663670572861182058425925280993190282267615052256942516011995207</span><br><span class="line">n = 76856511192427852645963041043072791148703422665129663050712492700760489247788743818199589072069758934570218804936479267319288093436111548055922916898782764333246946326823653877357695179165138863843657328764265204547147092074499832221138997131011222722917338444675582832114206750168113207646100633238664244737</span><br><span class="line">c = 39246179387125192271554620313966311736032348078183121707012959204367908070472764506984235827179206718838172586811066682034907967943722841257765922283692526422653916506577810629430853963448057701574209912936660396486847365579797147723437378122880075493171892191049105237005801787649587080840600670585409293046</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">hint = <span class="number">71505320953946158049530109094654497075489963071106175336722892393493112481336409391299522595724154571954223093317880494307263262649833222750675105885636892419350501821324979706283867758665536771783209816719106279467902518895579024290387800216711663670572861182058425925280993190282267615052256942516011995207</span></span><br><span class="line">n = <span class="number">76856511192427852645963041043072791148703422665129663050712492700760489247788743818199589072069758934570218804936479267319288093436111548055922916898782764333246946326823653877357695179165138863843657328764265204547147092074499832221138997131011222722917338444675582832114206750168113207646100633238664244737</span></span><br><span class="line">c = <span class="number">39246179387125192271554620313966311736032348078183121707012959204367908070472764506984235827179206718838172586811066682034907967943722841257765922283692526422653916506577810629430853963448057701574209912936660396486847365579797147723437378122880075493171892191049105237005801787649587080840600670585409293046</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">b = <span class="number">20211102</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(hint-<span class="built_in">pow</span>(b,e,n),n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>











]]></content>
      <categories>
        <category>现代密码-非对称加密</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>非对称加密</tag>
        <tag>RSA</tag>
      </tags>
  </entry>
  <entry>
    <title>密钥交换协议(DH)</title>
    <url>/2023/07/24/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AE-DH/</url>
    <content><![CDATA[<p>简述密钥交换协议(DH)</p>
<span id="more"></span>



<p>参考文章：</p>
<p>[(8条消息) Diffie-Hellman密钥交换协议及其中间人攻击_Memories off的博客-CSDN博客](<a href="https://blog.csdn.net/happy_single/article/details/106175275?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%AF%86%E9%92%A5%E4%BA%A4%E6%8D%A2%E5%8D%8F%E8%AE%AE">https://blog.csdn.net/happy_single/article/details/106175275?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=密钥交换协议</a> 中间人攻击&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-0-106175275.142^v9^control,157^v4^new_style&amp;spm&#x3D;1018.2226.3001.4187)</p>
<p><a href="https://harry0597.com/2022/05/11/%E7%A6%BB%E6%95%A3%C2%B7DH%C2%B7Elgamal/">离散对数 ｜ DH ｜ ElGamal | Harry’s Blog (harry0597.com)</a></p>
<p>密钥交换协议<strong>不是</strong>一种<strong>加密明文的算法</strong>，而是<strong>生成</strong>一个较为安全的<strong>密钥的算法</strong></p>
<h1 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h1><p><img src="/../../images/DH/0.png"></p>
<p><strong>Diffie-Hellman的安全性是基于离散对数求解的困难性的，然而，存在可能的中间人攻击，对Diffie-Hellman协议的安全性造成威胁。</strong></p>
<h1 id="中间人攻击"><a href="#中间人攻击" class="headerlink" title="中间人攻击"></a>中间人攻击</h1><p><img src="/../../images/DH/1.png"></p>
<p><strong>简述一下攻击流程</strong></p>
<p>$$<br>假设攻击人为Darth<br>$$</p>
<p>$$<br>1.Darth截取了Alice发给Bob的公钥Y_A<br>$$</p>
<p>$$<br>2.Darth选取了自己的私钥X_{D_1},并计算Y_{D_{1}}&#x3D;g^{X_{D_1}} \mod p<br>$$</p>
<p>$$<br>3.Darth把Y_{D_{1}}发送给Bob，同时Darth计算\color{red}K_2&#x3D;Y_A^{X_{D_2}} &#x3D; g^{X_AX_{D_2}}\mod p<br>$$</p>
<p>$$<br>4.Bob收到Darth发送的Y_{D_1},并计算\color{blue}K_1 &#x3D; Y_{D_1}^{X_B} &#x3D; g^{X_{D_1}X_B} \mod p<br>$$</p>
<p>$$<br>5.Bob把Y_B发送给Alice<br>$$</p>
<p>$$<br>6.Darth截取Y_B,并把Y_{D_2}发送欸Alice。Darth计算\color{blue}K_1 &#x3D; Y_{B}^{X_{D_1}} &#x3D; g^{X_B{X_{D_1}}} \mod p<br>$$</p>
<p>$$<br>7.Alice收到Y_{D_2},并计算\color{red}K_2&#x3D;Y_{D_2}^{X_A} &#x3D; g^{X_{D_2}X_A}\mod p<br>$$</p>
<p>$$<br>此时,Alice和Bob移位他们共享了密钥，但实际上却是:<br>$$</p>
<p>$$<br>\color{red} Alice和Darth共享密钥K_2<br>$$</p>
<p>$$<br>\color{blue} Bob和Darth共享密钥K_1<br>$$</p>
<p>$$<br>接下来，Alice和Bob之间的通信将以下列方式泄密：<br>$$</p>
<p>$$<br>1.Alice发送了一份加密的消息M:E(K_2,M),表示用密钥K_2对消息M加密<br>$$</p>
<p>$$<br>2.Darth截获了该密文，并解密，知晓了M<br>$$</p>
<p>$$<br>3.Darth把E(K_1,M)或者把E(K_1,M’)发送给Bob，其中M’是修改后的信息<br>$$</p>
<p>$$<br>如果Darth把E(K_1,M)发送给Bob，表明他只是偷听消息，而没有进行修改<br>$$</p>
<p>$$<br>如果Darth把E(K_1,M’)发送给Bob，说明他修改了Alice原本想传给Bob的消息<br>$$</p>
]]></content>
      <categories>
        <category>现代密码-非对称加密</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>非对称加密</tag>
        <tag>DH</tag>
      </tags>
  </entry>
  <entry>
    <title>巅峰极客2023——Crypto</title>
    <url>/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/</url>
    <content><![CDATA[<p>复现巅峰极客2023密码方向赛题</p>
<span id="more"></span>

<h1 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import random</span><br><span class="line">import binascii</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">g, r1, r2 = [getRandomRange(1, N) for _ in range(3)]</span><br><span class="line">g1 = pow(g, r1 * (p - 1), N)</span><br><span class="line">g2 = pow(g, r2 * (q - 1), N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(m):</span><br><span class="line">    s1, s2 = [getRandomRange(1, N) for _ in range(2)]</span><br><span class="line">    c1 = (m * pow(g1, s1, N)) % N</span><br><span class="line">    c2 = (m * pow(g2, s2, N)) % N</span><br><span class="line">    print(&quot;c1=&quot;, c1)</span><br><span class="line">    print(&quot;c2=&quot;, c2)</span><br><span class="line">    return (c1, c2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = encrypt(bytes_to_long(flag[:len(flag) // 2]))</span><br><span class="line">print(&#x27;N=&#x27;, N)</span><br><span class="line">print(&#x27;g1=&#x27;, g1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pad(msg, length):</span><br><span class="line">    l = len(msg)</span><br><span class="line">    return msg + (length - l) * chr(length - l).encode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">assert (p != q)</span><br><span class="line">n = p * q</span><br><span class="line">e = 5</span><br><span class="line">d = inverse(e, (p - 1) * (q - 1))</span><br><span class="line">assert (e * d % (p - 1) * (q - 1))</span><br><span class="line"></span><br><span class="line">flag = pad(flag[len(flag) // 2:], 48)</span><br><span class="line">m = [int(binascii.b2a_hex(flag[i * 16:i * 16 + 16]).decode(&#x27;utf-8&#x27;), 16) for i in range(3)]</span><br><span class="line">print(&#x27;S=&#x27;, sum(m) % n)</span><br><span class="line">cnt = len(m)</span><br><span class="line">A = [(i + 128) ** 2 for i in range(cnt)]</span><br><span class="line">B = [(i + 1024) for i in range(cnt)]</span><br><span class="line">C = [(i + 512) for i in range(cnt)]</span><br><span class="line">Cs = [int(pow((A[i] * m[i] ** 2 + B[i] * m[i] + C[i]), e, n)) for i in range(cnt)]</span><br><span class="line">print(&#x27;N=&#x27;, n)</span><br><span class="line">print(&#x27;e=&#x27;, e)</span><br><span class="line">print(&#x27;Cs=&#x27;, Cs)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c1= 19024563955839349902897822692180949371550067644378624199902067434708278125346234824900117853598997270022872667319428613147809325929092749312310446754419305096891122211944442338664613779595641268298482084259741784281927857614814220279055840825157115551456554287395502655358453270843601870807174309121367449335110327991187235786798374254470758957844690258594070043388827157981964323699747450405814713722613265012947852856714100237325256114904705539465145676960232769502207049858752573601516773952294218843901330100257234517481221811887136295727396712894842769582824157206825592614684804626241036297918244781918275524254</span><br><span class="line">c2= 11387447548457075057390997630590504043679006922775566653728699416828036980076318372839900947303061300878930517069527835771992393657157069014534366482903388936689298175411163666849237525549902527846826224853407226289495201341719277080550962118551001246017511651688883675152554449310329664415179464488725227120033786305900106544217117526923607211746947511746335071162308591288281572603417532523345271340113176743703809868369623401559713179927002634217140206608963086656140258643119596968929437114459557916757824682496866029297120246221557017875892921591955181714167913310050483382235498906247018171409256534124073270350</span><br><span class="line">N= 21831630625212912450058787218272832615084640356500740162478776482071876178684642739065105728423872548532056206845637492058465613779973193354996353323494373418215019445325632104575415991984764454753263189235376127871742444636236132111097548997063091478794422370043984009615893441148901566420508196170556189546911391716595983110030778046242014896752388438535131806524968952947016059907135882390507706966746973544598457963945671064540465259211834751973065197550500334726779434679470160463944292619173904064826217284899341554269864669620477774678605962276256707036721407638013951236957603286867871199275024050690034901963</span><br><span class="line">g1= 20303501619435729000675510820217420636246553663472832286487504757515586157679361170332171306491820918722752848685645096611030558245362578422584797889428493611704976472409942840368080016946977234874471779189922713887914075985648876516896823599078349725871578446532134614410886658001724864915073768678394238725788245439086601955497248593286832679485832319756671985505398841701463782272300202981842733576006152153012355980197830911700112001441621619417349747262257225469106511527467526286661082010163334100555372381681421874165851063816598907314117035131618062582953512203870615406642787786668571083042463072230605649134</span><br><span class="line">S= 234626762558445335519229319778735528295</span><br><span class="line">N= 28053749721930780797243137464055357921262616541619976645795810707701031602793034889886420385567169222962145128498131170577184276590698976531070900776293344109534005057067680663813430093397821366071365221453788763262381958185404224319153945950416725302184077952893435265051402645871699132910860011753502307815457636525137171681463817731190311682277171396235160056504317959832747279317829283601814707551094074778796108136141845755357784361312469124392408642823375413433759572121658646203123677327551421440655322226192031542368496829102050186550793124020718643243789525477209493783347317576783265671566724068427349961101</span><br><span class="line">e= 5</span><br><span class="line">Cs= [1693447496400753735762426750097282582203894511485112615865753001679557182840033040705025720548835476996498244081423052953952745813186793687790496086492136043098444304128963237489862776988389256298142843070384268907160020751319313970887199939345096232529143204442168808703063568295924663998456534264361495136412078324133263733409362366768460625508816378362979251599475109499727808021609000751360638976, 2240772849203381534975484679127982642973364801722576637731411892969654368457130801503103210570803728830063876118483596474389109772469014349453490395147031665061733965097301661933389406031214242680246638201663845183194937353509302694926811282026475913703306789097162693368337210584494881249909346643289510493724709324540062077619696056842225526183938442535866325407085768724148771697260859350213678910949, 5082341111246153817896279104775187112534431783418388292800705085458704665057344175657566751627976149342406406594179073777431676597641200321859622633948317181914562670909686170531929552301852027606377778515019377168677204310642500744387041601260593120417053741977533047412729373182842984761689443959266049421034949822673159561609487404082536872314636928727833394518122974630386280495027169465342976]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>flag分成了两段进行加密</p>
<h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><p>$$<br>\because g_1 \equiv g^{r_1(p-1)} \mod N<br>$$</p>
<p>$$<br>\therefore g_1 &#x3D; g^{r_1(p-1)}+kN<br>$$</p>
<p>$$<br>两边同模p得：<br>$$</p>
<p>$$<br>g_1 \equiv g^{r_1(p-1)} \mod p<br>$$</p>
<p>$$<br>由费马定理得:<br>$$</p>
<p>$$<br>g_1 \equiv 1 \mod p<br>$$</p>
<p>$$<br>\therefore kp &#x3D; g_1 - 1<br>$$</p>
<p><strong>通过kp和N求出p,q</strong><br>$$<br>又\because c_1 \equiv m×(g_1^{s_1} \mod N) \mod N<br>$$</p>
<p>$$<br>\therefore c_1 &#x3D; (m×(g_1^{s_1} + k_1N))+k_2N<br>$$</p>
<p>$$<br>\therefore c_1 &#x3D; mg_1^{s_1}+k_1mN + k_2N<br>$$</p>
<p>$$<br>两边同模p得:<br>$$</p>
<p>$$<br>c_1 \equiv mg_1^{s_1} \mod p<br>$$</p>
<p>$$<br>即c_1 \equiv (m \mod p)×(g_1^{s_1} \mod p) \mod p<br>$$</p>
<p>$$<br>又\because 1 \equiv g_1^{s_1} \mod p<br>$$</p>
<p>$$<br>\therefore c_1 \equiv m \mod p<br>$$</p>
<h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>解方程就行<br>$$<br>\because (A_im_i^2+B_im_i+C)^5 \equiv Cs_i \mod n<br>$$<br>$$<br>先对Cs_i开根号后<br>$$</p>
<p>$$<br>分别解3个方程:<br>$$</p>
<p>$$<br>A_ix^2+B_ix+C &#x3D; tep<br>$$</p>
<p>$$<br>其中tmp &#x3D; Cs_i^{\frac{1}{5}}<br>$$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"></span><br><span class="line">c1= <span class="number">19024563955839349902897822692180949371550067644378624199902067434708278125346234824900117853598997270022872667319428613147809325929092749312310446754419305096891122211944442338664613779595641268298482084259741784281927857614814220279055840825157115551456554287395502655358453270843601870807174309121367449335110327991187235786798374254470758957844690258594070043388827157981964323699747450405814713722613265012947852856714100237325256114904705539465145676960232769502207049858752573601516773952294218843901330100257234517481221811887136295727396712894842769582824157206825592614684804626241036297918244781918275524254</span></span><br><span class="line">c2= <span class="number">11387447548457075057390997630590504043679006922775566653728699416828036980076318372839900947303061300878930517069527835771992393657157069014534366482903388936689298175411163666849237525549902527846826224853407226289495201341719277080550962118551001246017511651688883675152554449310329664415179464488725227120033786305900106544217117526923607211746947511746335071162308591288281572603417532523345271340113176743703809868369623401559713179927002634217140206608963086656140258643119596968929437114459557916757824682496866029297120246221557017875892921591955181714167913310050483382235498906247018171409256534124073270350</span></span><br><span class="line">N= <span class="number">21831630625212912450058787218272832615084640356500740162478776482071876178684642739065105728423872548532056206845637492058465613779973193354996353323494373418215019445325632104575415991984764454753263189235376127871742444636236132111097548997063091478794422370043984009615893441148901566420508196170556189546911391716595983110030778046242014896752388438535131806524968952947016059907135882390507706966746973544598457963945671064540465259211834751973065197550500334726779434679470160463944292619173904064826217284899341554269864669620477774678605962276256707036721407638013951236957603286867871199275024050690034901963</span></span><br><span class="line">g1= <span class="number">20303501619435729000675510820217420636246553663472832286487504757515586157679361170332171306491820918722752848685645096611030558245362578422584797889428493611704976472409942840368080016946977234874471779189922713887914075985648876516896823599078349725871578446532134614410886658001724864915073768678394238725788245439086601955497248593286832679485832319756671985505398841701463782272300202981842733576006152153012355980197830911700112001441621619417349747262257225469106511527467526286661082010163334100555372381681421874165851063816598907314117035131618062582953512203870615406642787786668571083042463072230605649134</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(g1-<span class="number">1</span>,N)</span><br><span class="line">q = N // p </span><br><span class="line">m = c1 % p</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="comment">#print(long_to_bytes(m))</span></span><br><span class="line"></span><br><span class="line">N= <span class="number">28053749721930780797243137464055357921262616541619976645795810707701031602793034889886420385567169222962145128498131170577184276590698976531070900776293344109534005057067680663813430093397821366071365221453788763262381958185404224319153945950416725302184077952893435265051402645871699132910860011753502307815457636525137171681463817731190311682277171396235160056504317959832747279317829283601814707551094074778796108136141845755357784361312469124392408642823375413433759572121658646203123677327551421440655322226192031542368496829102050186550793124020718643243789525477209493783347317576783265671566724068427349961101</span></span><br><span class="line">e= <span class="number">5</span></span><br><span class="line">Cs= [<span class="number">1693447496400753735762426750097282582203894511485112615865753001679557182840033040705025720548835476996498244081423052953952745813186793687790496086492136043098444304128963237489862776988389256298142843070384268907160020751319313970887199939345096232529143204442168808703063568295924663998456534264361495136412078324133263733409362366768460625508816378362979251599475109499727808021609000751360638976</span>, <span class="number">2240772849203381534975484679127982642973364801722576637731411892969654368457130801503103210570803728830063876118483596474389109772469014349453490395147031665061733965097301661933389406031214242680246638201663845183194937353509302694926811282026475913703306789097162693368337210584494881249909346643289510493724709324540062077619696056842225526183938442535866325407085768724148771697260859350213678910949</span>, <span class="number">5082341111246153817896279104775187112534431783418388292800705085458704665057344175657566751627976149342406406594179073777431676597641200321859622633948317181914562670909686170531929552301852027606377778515019377168677204310642500744387041601260593120417053741977533047412729373182842984761689443959266049421034949822673159561609487404082536872314636928727833394518122974630386280495027169465342976</span>]</span><br><span class="line">A = [(i + <span class="number">128</span>) ** <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">B = [(i + <span class="number">1024</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">C = [(i + <span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">tmp = [gmpy2.iroot(i,<span class="number">5</span>)[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> Cs]</span><br><span class="line"></span><br><span class="line">x1 = symbols(<span class="string">&#x27;x1&#x27;</span>)</span><br><span class="line">x2 = symbols(<span class="string">&#x27;x2&#x27;</span>)</span><br><span class="line">x3 = symbols(<span class="string">&#x27;x3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eq1 = A[<span class="number">0</span>]*x1**<span class="number">2</span> + B[<span class="number">0</span>]*x1 + C[<span class="number">0</span>]-tmp[<span class="number">0</span>]</span><br><span class="line">eq2 = A[<span class="number">1</span>]*x2**<span class="number">2</span> + B[<span class="number">1</span>]*x2 + C[<span class="number">1</span>]-tmp[<span class="number">1</span>]</span><br><span class="line">eq3 = A[<span class="number">2</span>]*x3**<span class="number">2</span> + B[<span class="number">2</span>]*x3 + C[<span class="number">2</span>]-tmp[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">x1 = solve(eq1,x1)</span><br><span class="line">x2 = solve(eq2,x2)</span><br><span class="line">x3 = solve(eq3,x3)</span><br><span class="line"><span class="comment">#print(x1,x2,x3,sep=&#x27;\n&#x27;)</span></span><br><span class="line">flag = flag +long_to_bytes(x1[<span class="number">1</span>]) + long_to_bytes(x2[<span class="number">1</span>]) + long_to_bytes(x3[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<p>sagemath:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">c1= 19024563955839349902897822692180949371550067644378624199902067434708278125346234824900117853598997270022872667319428613147809325929092749312310446754419305096891122211944442338664613779595641268298482084259741784281927857614814220279055840825157115551456554287395502655358453270843601870807174309121367449335110327991187235786798374254470758957844690258594070043388827157981964323699747450405814713722613265012947852856714100237325256114904705539465145676960232769502207049858752573601516773952294218843901330100257234517481221811887136295727396712894842769582824157206825592614684804626241036297918244781918275524254</span><br><span class="line">c2= 11387447548457075057390997630590504043679006922775566653728699416828036980076318372839900947303061300878930517069527835771992393657157069014534366482903388936689298175411163666849237525549902527846826224853407226289495201341719277080550962118551001246017511651688883675152554449310329664415179464488725227120033786305900106544217117526923607211746947511746335071162308591288281572603417532523345271340113176743703809868369623401559713179927002634217140206608963086656140258643119596968929437114459557916757824682496866029297120246221557017875892921591955181714167913310050483382235498906247018171409256534124073270350</span><br><span class="line">N= 21831630625212912450058787218272832615084640356500740162478776482071876178684642739065105728423872548532056206845637492058465613779973193354996353323494373418215019445325632104575415991984764454753263189235376127871742444636236132111097548997063091478794422370043984009615893441148901566420508196170556189546911391716595983110030778046242014896752388438535131806524968952947016059907135882390507706966746973544598457963945671064540465259211834751973065197550500334726779434679470160463944292619173904064826217284899341554269864669620477774678605962276256707036721407638013951236957603286867871199275024050690034901963</span><br><span class="line">g1= 20303501619435729000675510820217420636246553663472832286487504757515586157679361170332171306491820918722752848685645096611030558245362578422584797889428493611704976472409942840368080016946977234874471779189922713887914075985648876516896823599078349725871578446532134614410886658001724864915073768678394238725788245439086601955497248593286832679485832319756671985505398841701463782272300202981842733576006152153012355980197830911700112001441621619417349747262257225469106511527467526286661082010163334100555372381681421874165851063816598907314117035131618062582953512203870615406642787786668571083042463072230605649134</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(g1-1,N)</span><br><span class="line">m = c1 % p</span><br><span class="line">flag = libnum.n2s(int(m))</span><br><span class="line"># print(flag)</span><br><span class="line"></span><br><span class="line">S= 234626762558445335519229319778735528295</span><br><span class="line">n= 28053749721930780797243137464055357921262616541619976645795810707701031602793034889886420385567169222962145128498131170577184276590698976531070900776293344109534005057067680663813430093397821366071365221453788763262381958185404224319153945950416725302184077952893435265051402645871699132910860011753502307815457636525137171681463817731190311682277171396235160056504317959832747279317829283601814707551094074778796108136141845755357784361312469124392408642823375413433759572121658646203123677327551421440655322226192031542368496829102050186550793124020718643243789525477209493783347317576783265671566724068427349961101</span><br><span class="line">e= 5</span><br><span class="line">Cs= [1693447496400753735762426750097282582203894511485112615865753001679557182840033040705025720548835476996498244081423052953952745813186793687790496086492136043098444304128963237489862776988389256298142843070384268907160020751319313970887199939345096232529143204442168808703063568295924663998456534264361495136412078324133263733409362366768460625508816378362979251599475109499727808021609000751360638976, 2240772849203381534975484679127982642973364801722576637731411892969654368457130801503103210570803728830063876118483596474389109772469014349453490395147031665061733965097301661933389406031214242680246638201663845183194937353509302694926811282026475913703306789097162693368337210584494881249909346643289510493724709324540062077619696056842225526183938442535866325407085768724148771697260859350213678910949, 5082341111246153817896279104775187112534431783418388292800705085458704665057344175657566751627976149342406406594179073777431676597641200321859622633948317181914562670909686170531929552301852027606377778515019377168677204310642500744387041601260593120417053741977533047412729373182842984761689443959266049421034949822673159561609487404082536872314636928727833394518122974630386280495027169465342976]</span><br><span class="line"></span><br><span class="line">A = [(i + 128) ** 2 for i in range(3)]</span><br><span class="line">B = [(i + 1024) for i in range(3)]</span><br><span class="line">C = [(i + 512) for i in range(3)]</span><br><span class="line">tmp = [int(gmpy2.iroot(i,5)[0]) for i in Cs]</span><br><span class="line"></span><br><span class="line">R.&lt;x1&gt; = Zmod()[]</span><br><span class="line">R.&lt;x2&gt; = Zmod()[]</span><br><span class="line">R.&lt;x3&gt; = Zmod()[]</span><br><span class="line"></span><br><span class="line">f1 = A[0]*x1**2 + B[0]*x1 + C[0]-tmp[0]</span><br><span class="line">f2 = A[1]*x2**2 + B[1]*x2 + C[1]-tmp[1]</span><br><span class="line">f3 = A[2]*x3**2 + B[2]*x3 + C[2]-tmp[2]</span><br><span class="line"></span><br><span class="line">x1 = f1.roots()</span><br><span class="line">x2 = f2.roots()</span><br><span class="line">x3 = f3.roots()</span><br><span class="line"></span><br><span class="line">flag = flag + libnum.n2s(int(x1[0][0])) + libnum.n2s(int(x2[0][0])) + libnum.n2s(int(x3[0][0]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>



<h1 id="数学但高中"><a href="#数学但高中" class="headerlink" title="数学但高中"></a>数学但高中</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x=4&#123;0&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">y=4&#123;2&lt;x&lt;6,17&lt;x&lt;18,28&lt;x&lt;30,41&lt;x&lt;42&#125;</span><br><span class="line"></span><br><span class="line">y=6&#123;4&lt;x&lt;6,15&lt;x&lt;16,17&lt;x&lt;19,41&lt;x&lt;43,50&lt;x&lt;51&#125;</span><br><span class="line"></span><br><span class="line">x=7&#123;0&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">(x-9)^2+(y-3)^2=1</span><br><span class="line"></span><br><span class="line">x=10&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-12)^2+(y-3)^2=1</span><br><span class="line"></span><br><span class="line">x=13&#123;0&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">y=0&#123;11&lt;x&lt;13,15&lt;x&lt;16,50&lt;x&lt;51&#125;</span><br><span class="line"></span><br><span class="line">y=-x+17&#123;14&lt;x&lt;15&#125;</span><br><span class="line"></span><br><span class="line">y=x-11&#123;14&lt;x&lt;15&#125;</span><br><span class="line"></span><br><span class="line">x=15&#123;0&lt;y&lt;2,4&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">x=17&#123;1&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">x=19&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=21&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">(x-20)^2+(y-3)^2=1&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-23)^2+(y-3)^2=1&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=22&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=24&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-26)^2+(y-3)^2=1&#123;25&lt;x&lt;26&#125;</span><br><span class="line"></span><br><span class="line">y=0.5x-11&#123;26&lt;x&lt;27&#125;</span><br><span class="line"></span><br><span class="line">y=-0.5x+17&#123;26&lt;x&lt;27&#125;</span><br><span class="line"></span><br><span class="line">y=2&#123;29&lt;x&lt;30,31&lt;x&lt;33,39&lt;x&lt;40&#125;</span><br><span class="line"></span><br><span class="line">x=29&#123;2&lt;y&lt;5&#125;</span><br><span class="line"></span><br><span class="line">x=32&#123;2&lt;y&lt;5&#125;</span><br><span class="line"></span><br><span class="line">y=x-27&#123;31&lt;x&lt;32&#125;</span><br><span class="line"></span><br><span class="line">(x-34)^2+((y-3.5)^2)/(1.5^2)=1</span><br><span class="line"></span><br><span class="line">x=36&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-37)^2+(y-3)^2=1&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=38&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=41&#123;2&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">x=44&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">(x-45)^2+(y-3)^2=1&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=46&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=47&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-48)^2+(y-3)^2=1&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=49&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=51&#123;0&lt;y&lt;2,4&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">y=x-49&#123;51&lt;x&lt;52&#125;</span><br><span class="line"></span><br><span class="line">y=-x+55&#123;51&lt;x&lt;52&#125;</span><br></pre></td></tr></table></figure>

<p><strong>网站画图</strong></p>
<p><a href="https://www.desmos.com/calculator?lang=zh-CN">图形计算器 (desmos.com)</a></p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/0.png"></p>
<p><code>flag&#123;Funct10n_Fun&#125;</code></p>
<h1 id="Rosita"><a href="#Rosita" class="headerlink" title="Rosita"></a>Rosita</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Problem by rec, without any sleep at all.</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, a, b, flag</span><br><span class="line"></span><br><span class="line">ECC = EllipticCurve(GF(p), [a, b])</span><br><span class="line">R, E, C = [ECC.random_point() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> m: urandom(<span class="number">8</span>) + m + <span class="string">b&#x27;\x00&#x27;</span> * (ZZ(p).nbits() // <span class="number">8</span> - <span class="built_in">len</span>(m) - <span class="number">8</span> - <span class="number">1</span>)</span><br><span class="line">out = <span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    m = pad(<span class="built_in">chr</span>(flag[i]).encode())</span><br><span class="line">    nonce = urandom(<span class="number">16</span>)</span><br><span class="line">    sh = sha256(nonce + m).digest()</span><br><span class="line">    </span><br><span class="line">    Q = b2l(m)*R + b2l(nonce)*E + b2l(sh)*C</span><br><span class="line">    out.append(Q.xy())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.tuo&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(out))</span><br></pre></td></tr></table></figure>

<p>本题椭圆曲线的参数$p,a,b$全部没有给出，$R,E,C$是椭圆曲线上的点，$pad$是一种填充方式</p>
<p>$m$是$flag$经过$pad$填充后的，$nonce$是16字节的字符串，$sh$是$sha256(nonce+m)$</p>
<p>之后把$m,nonce,sh$全部转为数值，产生$Q点$</p>
<p>我们唯一拿到的就是一系列$Q点$</p>
<h2 id="First"><a href="#First" class="headerlink" title="First"></a>First</h2><p>先通过$Q$点恢复椭圆曲线的参数</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import GCD,isPrime</span><br><span class="line">def recover_para(Q):</span><br><span class="line"> x1,y1 = Q[0]</span><br><span class="line"> x2,y2 = Q[1]</span><br><span class="line"> x3,y3 = Q[2]</span><br><span class="line"> x4,y4 = Q[3]</span><br><span class="line"> t12_13 = ((y1**2 - x1**3)-(y2**2 - x2**3)) * (x1-x3)</span><br><span class="line"> t13_12 = ((y1**2 - x1**3)-(y3**2 - x3**3)) * (x1-x2)</span><br><span class="line"> k1p = t12_13-t13_12</span><br><span class="line"></span><br><span class="line"> t12_14 = ((y1**2 - x1**3)-(y2**2 - x2**3)) * (x1-x4)</span><br><span class="line"> t14_12 = ((y1**2 - x1**3)-(y4**2 - x4**3)) * (x1-x2)</span><br><span class="line"> k2p = t12_14-t14_12</span><br><span class="line"></span><br><span class="line"> p = factor(GCD(k1p,k2p))[-1][0]</span><br><span class="line"> assert isPrime(int(p))</span><br><span class="line"></span><br><span class="line"> a = ((y1^2-x1^3)-(y2^2-x2^3))/(x1-x2) % p</span><br><span class="line"> b = (y1^2-x1^3-a*x1) % p</span><br><span class="line"></span><br><span class="line"> E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"></span><br><span class="line"> assert E(Q[0])</span><br><span class="line"> return E,a,b,p</span><br><span class="line"></span><br><span class="line">Q = [(4713513545399586887294281187501009141689080934674926984853052046637141607331993392136186920709675152470824454822335527736604585312216293390500894812356575, 10152198551269550712132843544953877513974069303791371586626547671550636936369607844350995807520993189830394615282586805640124173078292476320861958178531199), (8497709856659541496506566158438727086633064779296427286612559352247045304592577869075723270252557382159636274220949698085489427175611575498725494187042219, 9116811362014883884879981282521462123463402369273722016008105935084826801111377968641225157887930975588405833350168170885178864192235006321249285744756607), (9370988588550376568847533229569651406006327680521920971380933472551236466257993862023372207379492794618019196741718902793769742423589142369766582541381456, 2964764716081715738931864218952095017577031943078710662273038672326443429898927649838098895380036049701254956968440876093577389832396678079667784517400438), (9780561431490704165761200835168742342147019392307027843608906950941244751705916411353543429159840043103272583252784603317509552870673884311510395715589823, 4512360262119206250842086638048812502384840258083296584133384225879227543325169341795597008831855800692604773248185325609068166181249185285419214480894245)]</span><br><span class="line"></span><br><span class="line">E,a,b,p = recover_para(Q)</span><br><span class="line"></span><br><span class="line">print(&quot;a=&quot;,a)</span><br><span class="line">print(&quot;b=&quot;,b)</span><br><span class="line">print(&quot;p=&quot;,p)</span><br></pre></td></tr></table></figure>

<p>原理如下图，来源于<strong>Van1sh的公众号</strong><a href="https://mp.weixin.qq.com/s/e8iipjHVVXk0xTGZpNOeJQ">2023 巅峰极客-Rosita (qq.com)</a></p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/1.png"></p>
<h2 id="Second"><a href="#Second" class="headerlink" title="Second"></a>Second</h2><p>我们已知$Q &#x3D; m×R+nonce×E + sh×C$，需要注意的是每个$m,nounce,sh$都是不同的</p>
<p>一共给了73个$Q$点，所以我们有</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/2.png"></p>
<p>需要注意的是，我们选择椭圆曲线上的生成元$G$，则必定有$R&#x3D;rG,E&#x3D;eG,C&#x3D;cG$</p>
<p>所以上式可以转换成</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/3.png"></p>
<p>上述矩阵分别记为$M,C,A$</p>
<p>因为曲线的阶和$p$相等，所以$A_i$可以通过<code>smart_attack</code>恢复</p>
<p>这其实就是一个HSSP问题</p>
<p>假设存在一个与$A$正交的矩阵$T$</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/4.png"></p>
<p>则</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/5.png"></p>
<p>那么有下式，我不确定这一点的原理</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/6.png"></p>
<p>构造格</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/7.png"></p>
<p>通过LLL算法格基规约后，理想情况下，最后一列D均被规约成0</p>
<h3 id="我的理解"><a href="#我的理解" class="headerlink" title="我的理解"></a>我的理解</h3><p>我的理解是，把上面这个矩阵的每一行看成行向量，因为LLL算法实际是对每个行向量进行线性组合</p>
<p>即$z&#x3D;y_1A_1+y_2A_2+…+y_{73}A_{73}$，最后一列就是这个组合生成的$z$的值，前面73列分别就是$y_1\longrightarrow y_{73}$的值</p>
<p>这样，每一行前73列的值就是$T矩阵$某行的73个值了。所以最后一列为0即是我们的判断条件。</p>
<p>大佬说不一定能把所有行都能规约成正交矩阵T。这题73行，有70行被规约成与A正交</p>
<p>强网杯2022 Lattice的wp这里只要满足$n&gt;\frac{m}{2}$就能通过右核矩阵还原出$M$。其中n是规约后正交的行数，$m$为给出的数据行数</p>
<p>所以对于得到的70行足够还原出小向量。</p>
<h2 id="Thrid"><a href="#Thrid" class="headerlink" title="Thrid"></a>Thrid</h2><p>恢复不完全的矩阵$T$之后，我们求解</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/8.png"></p>
<p>所以M的每一列是矩阵$T$的右核解，我们要求$M$的第一列，它在$T$的右核的格上</p>
<p>且$M$的第一列是短向量，期望对$T$求右核矩阵然后<strong>规约</strong>即可还原出M的第一列。</p>
<p>最后这一步还得琢磨琢磨</p>
<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a= <span class="number">490963434153515882934487973185142842357175523008183292296815140698999054658777820556076794490414610737654365807063916602037816955706321036900113929329671</span></span><br><span class="line">b= <span class="number">7668542654793784988436499086739239442915170287346121645884096222948338279165302213440060079141960679678526016348025029558335977042712382611197995002316466</span></span><br><span class="line">p= <span class="number">11093300438765357787693823122068501933326829181518693650897090781749379503427651954028543076247583697669597230934286751428880673539155279232304301123931419</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">out = []</span><br><span class="line">G = E.gens()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    point = E(i[<span class="number">0</span>],i[<span class="number">1</span>])</span><br><span class="line">    tmp = SmartAttack(G,point,p)</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    A.append(tmp)</span><br><span class="line">    </span><br><span class="line">Ge = Matrix(ZZ,<span class="number">74</span>,<span class="number">74</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">73</span>):</span><br><span class="line">    Ge[i,i] = <span class="number">1</span></span><br><span class="line">    Ge[i,-<span class="number">1</span>] = A[i]</span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;求解T&quot;</span>)</span><br><span class="line">T = []</span><br><span class="line">L = Ge.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       	T.append(i[:-<span class="number">1</span>])</span><br><span class="line">       	</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(T))</span><br><span class="line">T = Matrix(ZZ,T)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;求解T结束&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;还原M&quot;</span>)</span><br><span class="line">M = Matrix(ZZ,T.right_kernel().basis()).LLL()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;还原M结束&quot;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M:</span><br><span class="line">    flag += <span class="built_in">chr</span>(long_to_bytes(i)[-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>T.right_kernel().</code>：用于计算$T$的右核。右核是指所有使得线性变换或矩阵作用于其上结果为零向量的向量的集合。</p>
<p><code>T.right_kernel().basis()</code>：用于获取$T$右核的基向量</p>
<p>这道题花了太多时间，对于求解右核然后格基规约这一过程还很迷糊</p>
]]></content>
      <categories>
        <category>Wp</category>
      </categories>
      <tags>
        <tag>Wp</tag>
      </tags>
  </entry>
  <entry>
    <title>RSA(三)</title>
    <url>/2023/07/09/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/RSA3/</url>
    <content><![CDATA[<p><strong>少年的书桌上没有虚度的光阴</strong></p>
<span id="more"></span>

<p><strong>记录笔者RSA学习过程，继上篇</strong></p>
<h1 id="二十九、费马分解法"><a href="#二十九、费马分解法" class="headerlink" title="二十九、费马分解法"></a>二十九、费马分解法</h1><p>对于$\because n &#x3D; p×q$，$\therefore n &#x3D; \frac{(p+q)^2}{4} - \frac{(p-q)^2}{4}$</p>
<p>费马分解法就是不断循环尝试找到两个数$a &#x3D; \frac{p+q}{2}$，$b &#x3D; \frac{p-q}{2}$</p>
<p>找到这两个数之后，</p>
<p>$\because n &#x3D;\frac{(p+q)^2}{4} - \frac{(p-q)^2}{4} &#x3D; a^2-b^2 &#x3D; (a+b)(a-b) $</p>
<p>$\therefore p &#x3D; a+b$，$q &#x3D; a-b$</p>
<p>让$a$从$\sqrt n$开始，不断加1，直到有一个$a$满足$a^2-n$是平方数，这个平方数就是b</p>
<p>例:</p>
<p>$n &#x3D; 10379$，取$a&#x3D; \sqrt n \approx101.9$</p>
<p>从$a&#x3D;102$开始算，$a^2-n &#x3D; 102^2-10379 &#x3D; 25 &#x3D; 5^2$</p>
<p>所以$n &#x3D; 10379 &#x3D; 102^2-5^2$</p>
<p>$\therefore n &#x3D; (102+5)(102-5) &#x3D; 107×97$</p>
<h2 id="zer0pts-CTF-2022-Anti-Fermat"><a href="#zer0pts-CTF-2022-Anti-Fermat" class="headerlink" title="zer0pts CTF 2022 Anti-Fermat"></a>zer0pts CTF 2022 Anti-Fermat</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, getStrongPrime</span><br><span class="line"><span class="keyword">from</span> gmpy <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="comment"># Anti-Fermat Key Generation</span></span><br><span class="line">p = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p ^ ((<span class="number">1</span>&lt;&lt;<span class="number">1024</span>)-<span class="number">1</span>))</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Encryption</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(n)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(c)))</span><br><span class="line"><span class="comment">#n = 0x1ffc7dc6b9667b0dcd00d6ae92fb34ed0f3d84285364c73fbf6a572c9081931be0b0610464152de7e0468ca7452c738611656f1f9217a944e64ca2b3a89d889ffc06e6503cfec3ccb491e9b6176ec468687bf4763c6591f89e750bf1e4f9d6855752c19de4289d1a7cea33b077bdcda3c84f6f3762dc9d96d2853f94cc688b3c9d8e67386a147524a2b23b1092f0be1aa286f2aa13aafba62604435acbaa79f4e53dea93ae8a22655287f4d2fa95269877991c57da6fdeeb3d46270cd69b6bfa537bfd14c926cf39b94d0f06228313d21ec6be2311f526e6515069dbb1b06fe3cf1f62c0962da2bc98fa4808c201e4efe7a252f9f823e710d6ad2fb974949751</span></span><br><span class="line"><span class="comment">#c = 0x60160bfed79384048d0d46b807322e65c037fa90fac9fd08b512a3931b6dca2a745443a9b90de2fa47aaf8a250287e34563e6b1a6761dc0ccb99cb9d67ae1c9f49699651eafb71a74b097fc0def77cf287010f1e7bd614dccfb411cdccbb84c60830e515c05481769bd95e656d839337d430db66abcd3a869c6348616b78d06eb903f8abd121c851696bd4cb2a1a40a07eea17c4e33c6a1beafb79d881d595472ab6ce3c61d6d62c4ef6fa8903149435c844a3fab9286d212da72b2548f087e37105f4657d5a946afd12b1822ceb99c3b407bb40e21163c1466d116d67c16a2a3a79e5cc9d1f6a1054d6be6731e3cd19abbd9e9b23309f87bfe51a822410a62</span></span><br></pre></td></tr></table></figure>

<h3 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h3><p>因为<code>q = next_prime(p^((1&lt;&lt;1024)-1))</code>，q是p取反后的下一个素数。我们知道p和取反后的p相加等于$2^{1024}-1$</p>
<p>所以$p+q$略大于$2^{1024}-1$</p>
<p>根据费马分解$n &#x3D; \frac{(p+q)^2}{4}-\frac{(p-q)^2}{4}$</p>
<p>我们已知$p+q \approx 2^{1024}$</p>
<p>$\therefore n &#x3D; \frac{2^{2048}}{4} - \frac{(p-q)^2}{4}$</p>
<p>$4n &#x3D; 2^{2048}-(p-q)^2$，$p-q &#x3D; \sqrt{2^{2048} -4n}$</p>
<p>再结合$p+q &#x3D; 2^{1024}$，$p &#x3D; \frac{\sqrt{2^{2048}-4n}+2^{1024}}{2}$</p>
<p>这样求出的p是比原来的p略小一点的，需要爆破一点p</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x1ffc7dc6b9667b0dcd00d6ae92fb34ed0f3d84285364c73fbf6a572c9081931be0b0610464152de7e0468ca7452c738611656f1f9217a944e64ca2b3a89d889ffc06e6503cfec3ccb491e9b6176ec468687bf4763c6591f89e750bf1e4f9d6855752c19de4289d1a7cea33b077bdcda3c84f6f3762dc9d96d2853f94cc688b3c9d8e67386a147524a2b23b1092f0be1aa286f2aa13aafba62604435acbaa79f4e53dea93ae8a22655287f4d2fa95269877991c57da6fdeeb3d46270cd69b6bfa537bfd14c926cf39b94d0f06228313d21ec6be2311f526e6515069dbb1b06fe3cf1f62c0962da2bc98fa4808c201e4efe7a252f9f823e710d6ad2fb974949751</span></span><br><span class="line">c = <span class="number">0x60160bfed79384048d0d46b807322e65c037fa90fac9fd08b512a3931b6dca2a745443a9b90de2fa47aaf8a250287e34563e6b1a6761dc0ccb99cb9d67ae1c9f49699651eafb71a74b097fc0def77cf287010f1e7bd614dccfb411cdccbb84c60830e515c05481769bd95e656d839337d430db66abcd3a869c6348616b78d06eb903f8abd121c851696bd4cb2a1a40a07eea17c4e33c6a1beafb79d881d595472ab6ce3c61d6d62c4ef6fa8903149435c844a3fab9286d212da72b2548f087e37105f4657d5a946afd12b1822ceb99c3b407bb40e21163c1466d116d67c16a2a3a79e5cc9d1f6a1054d6be6731e3cd19abbd9e9b23309f87bfe51a822410a62</span></span><br><span class="line"></span><br><span class="line">tmp = gmpy2.iroot((<span class="number">2</span>**<span class="number">2048</span>-<span class="number">4</span>*n),<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = (tmp + <span class="number">2</span>**<span class="number">1024</span>) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p = gmpy2.next_prime(p)</span><br><span class="line">    <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h3 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h3><p>因为$q$是$p$取反后的下一个素数，设$p-q &#x3D; r$</p>
<p>则$p+q &#x3D; 2^{1024}-1 + r$</p>
<p>$\because n &#x3D; \frac{(p+q)^2}{4}-\frac{(p-q)^2}{4} \longrightarrow 4n &#x3D; (p+q)^2-(p-q)^2$</p>
<p>$\therefore (p-q) &#x3D; \sqrt{(p+q)^2-4n}$</p>
<p>把$p+q &#x3D; 2^{1024}-1+r$代入，爆破r，直到$(p+q)^2-4n$可以开根</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x1ffc7dc6b9667b0dcd00d6ae92fb34ed0f3d84285364c73fbf6a572c9081931be0b0610464152de7e0468ca7452c738611656f1f9217a944e64ca2b3a89d889ffc06e6503cfec3ccb491e9b6176ec468687bf4763c6591f89e750bf1e4f9d6855752c19de4289d1a7cea33b077bdcda3c84f6f3762dc9d96d2853f94cc688b3c9d8e67386a147524a2b23b1092f0be1aa286f2aa13aafba62604435acbaa79f4e53dea93ae8a22655287f4d2fa95269877991c57da6fdeeb3d46270cd69b6bfa537bfd14c926cf39b94d0f06228313d21ec6be2311f526e6515069dbb1b06fe3cf1f62c0962da2bc98fa4808c201e4efe7a252f9f823e710d6ad2fb974949751</span></span><br><span class="line">c = <span class="number">0x60160bfed79384048d0d46b807322e65c037fa90fac9fd08b512a3931b6dca2a745443a9b90de2fa47aaf8a250287e34563e6b1a6761dc0ccb99cb9d67ae1c9f49699651eafb71a74b097fc0def77cf287010f1e7bd614dccfb411cdccbb84c60830e515c05481769bd95e656d839337d430db66abcd3a869c6348616b78d06eb903f8abd121c851696bd4cb2a1a40a07eea17c4e33c6a1beafb79d881d595472ab6ce3c61d6d62c4ef6fa8903149435c844a3fab9286d212da72b2548f087e37105f4657d5a946afd12b1822ceb99c3b407bb40e21163c1466d116d67c16a2a3a79e5cc9d1f6a1054d6be6731e3cd19abbd9e9b23309f87bfe51a822410a62</span></span><br><span class="line"></span><br><span class="line">r = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    x = <span class="number">2</span>**<span class="number">1024</span> -<span class="number">1</span> + r</span><br><span class="line">    tmp = x ** <span class="number">2</span> - <span class="number">4</span>*n</span><br><span class="line">    y = gmpy2.iroot(tmp,<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> y[<span class="number">1</span>]:</span><br><span class="line">        p = (x+y[<span class="number">0</span>]) // <span class="number">2</span></span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        <span class="built_in">print</span>(r)					<span class="comment">#r = 2031</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r += <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h2 id="1-n-p×p1×q×q1"><a href="#1-n-p×p1×q×q1" class="headerlink" title="1.n &#x3D; p×p1×q×q1"></a>1.n &#x3D; p×p1×q×q1</h2><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag = &#x27;flag&#123;&#x27;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">flag=flag.encode()</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">p1 = gmpy2.next_prime(p)</span><br><span class="line">q= getPrime(512)</span><br><span class="line">q1= gmpy2.next_prime(q)</span><br><span class="line"></span><br><span class="line">n = p*q*p1*q1</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">c= 9949542934673249601822379710110536682375274333294212429688584989332571435120688962792756767799023906332576991820877786082142174075762351091472858450420524999000438499038246804892307015253501997557003507879115010365751701766309706931191167213901685725286428926861333201965004869326873632404052661985741631906479109023390455968199954361183959446992180809970004376995201084933073767278979855530735756096072840384641334181432769063314242300512881491103946010394543208395998872730145780806025267971492301568490427293141120807461902093932052106811061648537600125019831876736538658644780471805555396705702634885360657660235</span><br><span class="line">n= 14775235844515544576473611382698284004133861994231391972299917039113871334718108546717938305388267655285590882177982603418940337565701637106925368292676630781520319110700106306029357476649553934570683454139537943486518666101218072140043084858740684805876092240053196287287330188619164273915005792335974297620475140547828827559062269649682393716241864595363863867012095487700403514116433664086346056485373014640655316422588972338531776150881686013955605480910803097642414475309381073364181798620439167561641939844350252283317699576359402716770493658380425200603092475286870303441165147435503582004675788584686434009043</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c= <span class="number">9949542934673249601822379710110536682375274333294212429688584989332571435120688962792756767799023906332576991820877786082142174075762351091472858450420524999000438499038246804892307015253501997557003507879115010365751701766309706931191167213901685725286428926861333201965004869326873632404052661985741631906479109023390455968199954361183959446992180809970004376995201084933073767278979855530735756096072840384641334181432769063314242300512881491103946010394543208395998872730145780806025267971492301568490427293141120807461902093932052106811061648537600125019831876736538658644780471805555396705702634885360657660235</span></span><br><span class="line">n= <span class="number">14775235844515544576473611382698284004133861994231391972299917039113871334718108546717938305388267655285590882177982603418940337565701637106925368292676630781520319110700106306029357476649553934570683454139537943486518666101218072140043084858740684805876092240053196287287330188619164273915005792335974297620475140547828827559062269649682393716241864595363863867012095487700403514116433664086346056485373014640655316422588972338531776150881686013955605480910803097642414475309381073364181798620439167561641939844350252283317699576359402716770493658380425200603092475286870303441165147435503582004675788584686434009043</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">a=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">lt=[]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a+=<span class="number">1</span></span><br><span class="line">    b2=<span class="built_in">pow</span>(a,<span class="number">2</span>)-n</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">        tmp=[]</span><br><span class="line">        b=gmpy2.iroot(b2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        x1=a-b</span><br><span class="line">        x2=a+b</span><br><span class="line">        tmp.append(<span class="built_in">int</span>(x1))</span><br><span class="line">        tmp.append(<span class="built_in">int</span>(x2))</span><br><span class="line">        lt.append(tmp)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(lt)&gt;=<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(lt)</span><br><span class="line"><span class="keyword">assert</span> lt[<span class="number">0</span>][<span class="number">1</span>]*lt[<span class="number">0</span>][<span class="number">0</span>]==n</span><br><span class="line"><span class="keyword">assert</span> lt[<span class="number">1</span>][<span class="number">1</span>]*lt[<span class="number">1</span>][<span class="number">0</span>]==n</span><br><span class="line">p=libnum.gcd(lt[<span class="number">0</span>][<span class="number">0</span>],lt[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.is_prime(p))</span><br><span class="line">p1=gmpy2.next_prime(p)</span><br><span class="line"><span class="built_in">print</span>(p1)</span><br><span class="line">q=libnum.gcd(lt[<span class="number">0</span>][<span class="number">1</span>],lt[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.is_prime(q))</span><br><span class="line">q1=gmpy2.next_prime(q)</span><br><span class="line"><span class="built_in">print</span>(q1)</span><br><span class="line"><span class="built_in">print</span>(n==p*p1*q*q1)</span><br><span class="line">phi=(p-<span class="number">1</span>)</span><br><span class="line">d=libnum.invmod(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p><strong>遍历求出的x1是p,q,p1,q1任意两个数的积，因此后面需要用到gcd</strong></p>
<p><strong>最后phi &#x3D; (p-1)我不大理解</strong></p>
<h2 id="2-yafu无法分解"><a href="#2-yafu无法分解" class="headerlink" title="2.yafu无法分解"></a>2.yafu无法分解</h2><h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag = &#x27;flag&#123;&#x27;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">flag=flag.encode()</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = getPrime(2048)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">for i in range(3600):</span><br><span class="line">    if i%100 ==0:</span><br><span class="line">        print(i)</span><br><span class="line">        q = gmpy2.next_prime(q)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line"></span><br><span class="line">c= 672211618947965669743140453815925311571913536792006320455451623329504768032653294195423386000169883889423130760702613901378226812991253672513808102582219125394975375184975680670477893616071731840578283372003364948041569480819988957797304000908767353945393438677325246806404776535366574244075168385686413998057429677446479345637389931707590541292174569539214514406772616679574446429577154994658300264395963743399028585579405127133850937684035755385536903177249615680095525438385801267848518932540742850864828339907387436386589615141301315094268048540705754105909152114279580297245086066527476038499949395262133426884691004953583259542925926790804058362169131721101062567084072161757158556850613589003126629288335943625835227353239228779420777075183829735033060565964497198340990191457681711972006273381600852029426480042505732976038791175365941723190939561137761147915067500934001302644947570092730510410631121938241136026914524548262047531029183007578603005500736114268512900086177419819102734670936080786880709408049475188517563383396936699006425388577265810859020768191320288121742321413664684223757832512232195144286087827718142083017087556701405737637649721698260338198824299502881114161665693663517201464044647997804424204974158</span><br><span class="line">n= 720239742676276892125180297266754203107040753393792061819109788620051632698640388878164710563582551395398417339060158866293057237682628696160289176629921331485290769277668335946098043360398735897380648863281934217401247716885835600015902679721336644611726200751169780657177537142181503044265719975692160293076414714427014863104317576606190229434103615882007838099640939570363751985038883738622768287033043747426059699658000045440922380571398371705698665874788485742224933932126886052739997477581453575568873105033061557099207861338425715849944147722082093066073450898210944979122392845654525731562948599513722685350626329020621203929679566003766926450933409172107168029480058053562850582746440505733686649603099598891890233020681944859657534362524449703843503708875743380789764830334189231182948902486001101574574542624002055351308194659501208428214278013747062791484983332159726081847473539435746845527406013789541657402799211822281010775911725885529125479685615597338584834382753602860489834851310346307067835494249861848527198787408591551265511901573927692939919503175252790601381174213220684859419625471536435635703766410175026305548524401754345447084444023478365533640647989603192253820896160603674343007718854266899300948742261</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>用费马分解法求出p</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c= <span class="number">672211618947965669743140453815925311571913536792006320455451623329504768032653294195423386000169883889423130760702613901378226812991253672513808102582219125394975375184975680670477893616071731840578283372003364948041569480819988957797304000908767353945393438677325246806404776535366574244075168385686413998057429677446479345637389931707590541292174569539214514406772616679574446429577154994658300264395963743399028585579405127133850937684035755385536903177249615680095525438385801267848518932540742850864828339907387436386589615141301315094268048540705754105909152114279580297245086066527476038499949395262133426884691004953583259542925926790804058362169131721101062567084072161757158556850613589003126629288335943625835227353239228779420777075183829735033060565964497198340990191457681711972006273381600852029426480042505732976038791175365941723190939561137761147915067500934001302644947570092730510410631121938241136026914524548262047531029183007578603005500736114268512900086177419819102734670936080786880709408049475188517563383396936699006425388577265810859020768191320288121742321413664684223757832512232195144286087827718142083017087556701405737637649721698260338198824299502881114161665693663517201464044647997804424204974158</span></span><br><span class="line">n= <span class="number">720239742676276892125180297266754203107040753393792061819109788620051632698640388878164710563582551395398417339060158866293057237682628696160289176629921331485290769277668335946098043360398735897380648863281934217401247716885835600015902679721336644611726200751169780657177537142181503044265719975692160293076414714427014863104317576606190229434103615882007838099640939570363751985038883738622768287033043747426059699658000045440922380571398371705698665874788485742224933932126886052739997477581453575568873105033061557099207861338425715849944147722082093066073450898210944979122392845654525731562948599513722685350626329020621203929679566003766926450933409172107168029480058053562850582746440505733686649603099598891890233020681944859657534362524449703843503708875743380789764830334189231182948902486001101574574542624002055351308194659501208428214278013747062791484983332159726081847473539435746845527406013789541657402799211822281010775911725885529125479685615597338584834382753602860489834851310346307067835494249861848527198787408591551265511901573927692939919503175252790601381174213220684859419625471536435635703766410175026305548524401754345447084444023478365533640647989603192253820896160603674343007718854266899300948742261</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">a = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a += <span class="number">1</span></span><br><span class="line">    b2 = <span class="built_in">pow</span>(a,<span class="number">2</span>)-n</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">        b = gmpy2.iroot(b2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        p = a+b</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        </span><br><span class="line"><span class="comment">#b&#x27;flag&#123;e45a7d01-2639-4d21-830d-4fe00c5d69d9&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="三十、pow-m-p-n-和pow-m-q-n"><a href="#三十、pow-m-p-n-和pow-m-q-n" class="headerlink" title="三十、pow(m,p,n)和pow(m,q,n)"></a>三十、pow(m,p,n)和pow(m,q,n)</h1><h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line">n=p*q</span><br><span class="line">x=pow(m,p,n)</span><br><span class="line">y=pow(m,q,n)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;x=&quot;,x)</span><br><span class="line">print(&quot;y=&quot;,y)</span><br><span class="line">n= 49134891668897345591333219711303339144007670596441894829337290952093400283298630665826095289165809681961208520996265436195389904640720636719133734406693433810554096598929737422594980883724481297143537076662178576926253446582535294294231165454562659420944920445437433494540727083960515996626310138062984512331</span><br><span class="line">x= 24898114380189083075249478644617176345363769858290571489415603903447660857572376734333314388004344067870622511211551400003900882292855408080408530612898712604821849194436116203045876702326786310101264912258598823736415425063797050123512802647807994402065186878212852202204820369988512984137386942003350601013</span><br><span class="line">y= 16329839654620902472571665649919967371160409036961382290481165859731193710305989211665714814452109039568075053785039634104665516076749524765980529291699849764465433749870986860914147427598112865371747917109336808548762214669827404524571735460653099723747061723390924856171469660835909151652929700638010039801</span><br></pre></td></tr></table></figure>

<h3 id="推导1"><a href="#推导1" class="headerlink" title="推导1"></a>推导1</h3><p><img src="/../../images/RSA/37.png"></p>
<p><strong>求公因数得到p</strong></p>
<p><strong>留意一下密文是x和加密密钥是p或者y和q</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">49134891668897345591333219711303339144007670596441894829337290952093400283298630665826095289165809681961208520996265436195389904640720636719133734406693433810554096598929737422594980883724481297143537076662178576926253446582535294294231165454562659420944920445437433494540727083960515996626310138062984512331</span></span><br><span class="line">x= <span class="number">24898114380189083075249478644617176345363769858290571489415603903447660857572376734333314388004344067870622511211551400003900882292855408080408530612898712604821849194436116203045876702326786310101264912258598823736415425063797050123512802647807994402065186878212852202204820369988512984137386942003350601013</span></span><br><span class="line">y= <span class="number">16329839654620902472571665649919967371160409036961382290481165859731193710305989211665714814452109039568075053785039634104665516076749524765980529291699849764465433749870986860914147427598112865371747917109336808548762214669827404524571735460653099723747061723390924856171469660835909151652929700638010039801</span></span><br><span class="line"></span><br><span class="line">tmp = <span class="built_in">pow</span>(x,n,n)-y</span><br><span class="line">p = gmpy2.gcd(tmp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d1 = gmpy2.invert(p,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(x,d1,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line"></span><br><span class="line">d2 = gmpy2.invert(q,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m2 = <span class="built_in">pow</span>(y,d2,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m2))</span><br></pre></td></tr></table></figure>

<h3 id="推导2"><a href="#推导2" class="headerlink" title="推导2"></a>推导2</h3><p><img src="/../../images/RSA/38.png"></p>
<p><strong>根据最后一个式子解方程即可</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n= 49134891668897345591333219711303339144007670596441894829337290952093400283298630665826095289165809681961208520996265436195389904640720636719133734406693433810554096598929737422594980883724481297143537076662178576926253446582535294294231165454562659420944920445437433494540727083960515996626310138062984512331</span><br><span class="line">x= 24898114380189083075249478644617176345363769858290571489415603903447660857572376734333314388004344067870622511211551400003900882292855408080408530612898712604821849194436116203045876702326786310101264912258598823736415425063797050123512802647807994402065186878212852202204820369988512984137386942003350601013</span><br><span class="line">y= 16329839654620902472571665649919967371160409036961382290481165859731193710305989211665714814452109039568075053785039634104665516076749524765980529291699849764465433749870986860914147427598112865371747917109336808548762214669827404524571735460653099723747061723390924856171469660835909151652929700638010039801</span><br><span class="line"></span><br><span class="line">R.&lt;m&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = m**2 + x*y -(x+y)*m</span><br><span class="line">f = f.monic()</span><br><span class="line">root = f.small_roots(X=2^430)</span><br><span class="line">if root:</span><br><span class="line">    print(long_to_bytes(int(root[0])))</span><br><span class="line">else:</span><br><span class="line">    print(0)</span><br></pre></td></tr></table></figure>

<p><strong>不太明白这个上界为什么取的2^430</strong></p>
<h1 id="三十一、leak-n-p-q-1"><a href="#三十一、leak-n-p-q-1" class="headerlink" title="三十一、leak &#x3D; (n+p) % (q-1)"></a>三十一、leak &#x3D; (n+p) % (q-1)</h1><h2 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line">if p &lt;= q:</span><br><span class="line">    p, q = q, p</span><br><span class="line">e = 0x10001</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">leak = (n + p) % (q-1)</span><br><span class="line">print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">#e = 65537</span><br><span class="line">#c = 846622880180923496523897101093587388412673197929101816777894080453907929979417582433675846206418833989406082027835614960931951892393700870678469052366477889491688459558189367255658278968722099012534045477993924284003153851171132420751750724394405070269223797513951991873714156884423926582172189394011114952</span><br><span class="line">#n = 159452716285492879108396025652299064897348745847754101475050126796260046052685162344131542880739092630022413124977374334652652450809186959288635651980201026825896903174847709657312399801033678426271413442323084354665643010763178857967804623680894444913369256168333223214048037661178587978535722147091129404833</span><br><span class="line">#leak = 2669103705669857828725305123419482758456336465207378766363532584323475128597302561377245054918781031448710846825859151788151496659511563529987056456136018</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/39.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> solve,symbols</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">846622880180923496523897101093587388412673197929101816777894080453907929979417582433675846206418833989406082027835614960931951892393700870678469052366477889491688459558189367255658278968722099012534045477993924284003153851171132420751750724394405070269223797513951991873714156884423926582172189394011114952</span></span><br><span class="line">n = <span class="number">159452716285492879108396025652299064897348745847754101475050126796260046052685162344131542880739092630022413124977374334652652450809186959288635651980201026825896903174847709657312399801033678426271413442323084354665643010763178857967804623680894444913369256168333223214048037661178587978535722147091129404833</span></span><br><span class="line">leak = <span class="number">2669103705669857828725305123419482758456336465207378766363532584323475128597302561377245054918781031448710846825859151788151496659511563529987056456136018</span></span><br><span class="line"></span><br><span class="line">p = symbols(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = symbols(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq1 = <span class="number">2</span>*(p-q+<span class="number">1</span>) - leak</span><br><span class="line">eq2 = p*q - n</span><br><span class="line"></span><br><span class="line">solution = solve((eq1,eq2),(p,q))</span><br><span class="line"><span class="built_in">print</span>(solution)</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(solution[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">q = <span class="built_in">int</span>(solution[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h1 id="三十二、leak-d-p-q"><a href="#三十二、leak-d-p-q" class="headerlink" title="三十二、leak &#x3D; d+p+q"></a>三十二、leak &#x3D; d+p+q</h1><h2 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">d=libnum.invmod(e,(p-1)*(q-1))</span><br><span class="line">leak = d+p+q</span><br><span class="line">print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">#e = 65537</span><br><span class="line">#c = 65194823373091792824101730983124740337276083358867621564067880339279446092377567969207237986613196892737474455781661885696122256698478429450971196633786693648866129636737262041654769618993094832127875251068775632567036646408374963058703320605733921797230106462440860984746880466416824674570639694481298708147</span><br><span class="line">#n = 101929257180069933443442160085713121307068880188090652033345240568607589666231813199686824369361640378636124324844158355533056421197926269617986872835671463371353540696806173813019752742218460997272803573114119876536384486655117245296360474103378827486280279523273344156760793016731778663058274770626116861407</span><br><span class="line">#leak = 87007773233816810147344015772388866522443114032719766646343787373996588014373656496789294836431302130125588646180886383013958151442324020038131736683796464202667423644714259545194662934238144990354387370533656134036753530002005551694211595695927699196016268145816389892292091218491443784193805171731592693841</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/40.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">65194823373091792824101730983124740337276083358867621564067880339279446092377567969207237986613196892737474455781661885696122256698478429450971196633786693648866129636737262041654769618993094832127875251068775632567036646408374963058703320605733921797230106462440860984746880466416824674570639694481298708147</span></span><br><span class="line">n = <span class="number">101929257180069933443442160085713121307068880188090652033345240568607589666231813199686824369361640378636124324844158355533056421197926269617986872835671463371353540696806173813019752742218460997272803573114119876536384486655117245296360474103378827486280279523273344156760793016731778663058274770626116861407</span></span><br><span class="line">leak = <span class="number">87007773233816810147344015772388866522443114032719766646343787373996588014373656496789294836431302130125588646180886383013958151442324020038131736683796464202667423644714259545194662934238144990354387370533656134036753530002005551694211595695927699196016268145816389892292091218491443784193805171731592693841</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,leak-n-<span class="number">1</span>,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="三十三、leak-pow-p-q-n-pow-q-p-n-n"><a href="#三十三、leak-pow-p-q-n-pow-q-p-n-n" class="headerlink" title="三十三、leak &#x3D; pow(p,q,n)+pow(q,p,n)%n"></a>三十三、leak &#x3D; pow(p,q,n)+pow(q,p,n)%n</h1><h2 id="例题-5"><a href="#例题-5" class="headerlink" title="例题"></a>例题</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">leak = (pow(p, q, n) + pow(q, p, n)) % n</span><br><span class="line">print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;leak = &#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/42.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"></span><br><span class="line">p = symbols(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = symbols(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">59662555342583061013008608133060203475725526601468647442902301335538953096485921516133656618941085620436784211565880744663573927593670579237831797055934897166262528476227281479029026508166848256301828084036716500159067642101104810756620735383857351274773983199968924981397675373272878756685629789497697821620</span></span><br><span class="line">n = <span class="number">83332115751539889489689110273690067288993797655970253065863170986174973047785854940017477990345318506407680986257706329521142524295434171889087917406552261883625775754882538291980506944585738241124811588555071095223782766762626040473256423491630224616140407276984106458673447870374272906086783555489477673207</span></span><br><span class="line">leak = <span class="number">18881487897809480964326513919135880296801378921812225600834164247018332292886076618571738627353925482046410714540439662613766662197119044934743578662330528</span></span><br><span class="line"></span><br><span class="line">eq1 = p + q - leak</span><br><span class="line">eq2 = p * q - n</span><br><span class="line"></span><br><span class="line">solution = solve((eq1,eq2),(p,q))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> solution:</span><br><span class="line">    p,q = <span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(i[<span class="number">1</span>])</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<p><strong>考点三十一，三十二，三十三来自2023 数据安全产业人才能力挑战赛—math_exam</strong></p>
<h2 id="2023数据安全产业人才能力挑战赛——math-exam"><a href="#2023数据安全产业人才能力挑战赛——math-exam" class="headerlink" title="2023数据安全产业人才能力挑战赛——math_exam"></a>2023数据安全产业人才能力挑战赛——math_exam</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import os</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">bits = 512</span><br><span class="line"></span><br><span class="line">def pad(msg, length):</span><br><span class="line">    pad_length = length - len(msg) - 1</span><br><span class="line">    pad_data = os.urandom(pad_length)</span><br><span class="line">    return msg + b&#x27;\x00&#x27; + pad_data</span><br><span class="line"></span><br><span class="line">def unpad(msg):</span><br><span class="line">    return msg.split(b&quot;\x00&quot;)[0]</span><br><span class="line"></span><br><span class="line">def challenge1(m):</span><br><span class="line">    p, q = [getPrime(bits) for i in range(2)]</span><br><span class="line">    if p &lt;= q:</span><br><span class="line">        p, q = q, p</span><br><span class="line">    e = 0x10001</span><br><span class="line">    n = p * q</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    leak = (n + p) % (q-1)</span><br><span class="line">    print(&#x27;-------- challenge 1 --------&#x27;)</span><br><span class="line">    print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">def challenge2(m):</span><br><span class="line">    p, q = [getPrime(bits) for i in range(2)]</span><br><span class="line">    e = 0x10001</span><br><span class="line">    n = p * q</span><br><span class="line">    d = inverse(e, (p-1)*(q-1))</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    leak = d + p + q</span><br><span class="line">    print(&#x27;-------- challenge 2 --------&#x27;)</span><br><span class="line">    print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">def challenge3(m):</span><br><span class="line">    p, q = [getPrime(bits) for i in range(2)]</span><br><span class="line">    e = 0x10001</span><br><span class="line">    n = p * q</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    leak = (pow(p, q, n) + pow(q, p, n)) % n</span><br><span class="line">    print(&#x27;-------- challenge 3 --------&#x27;)</span><br><span class="line">    print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">assert len(flag) == 42</span><br><span class="line">ms = []</span><br><span class="line">for i in range(0, 42, 14):</span><br><span class="line">    ms.append(bytes_to_long(pad(flag[i:i+14], bits//4-1)))</span><br><span class="line"></span><br><span class="line">m1, m2, m3 = ms</span><br><span class="line">challenge1(m1)</span><br><span class="line">challenge2(m2)</span><br><span class="line">challenge3(m3)</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">-------- challenge 1 --------</span><br><span class="line">e = 65537</span><br><span class="line">c = 112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span><br><span class="line">n = 121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span><br><span class="line">leak = 216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span><br><span class="line">-------- challenge 2 --------</span><br><span class="line">e = 65537</span><br><span class="line">c = 7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span><br><span class="line">n = 140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span><br><span class="line">leak = 58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span><br><span class="line">-------- challenge 3 --------</span><br><span class="line">e = 65537</span><br><span class="line">c = 54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span><br><span class="line">n = 88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span><br><span class="line">leak = 19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span></span><br><span class="line">n1 = <span class="number">121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span></span><br><span class="line">leak1 = <span class="number">216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span></span><br><span class="line"></span><br><span class="line">p1 = symbols(<span class="string">&#x27;p1&#x27;</span>)</span><br><span class="line">q1 = symbols(<span class="string">&#x27;q1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq1 = <span class="number">2</span>*(p1-q1+<span class="number">1</span>)-leak1</span><br><span class="line">eq2 = p1 * q1- n1</span><br><span class="line"></span><br><span class="line">solution1 = solve((eq1,eq2),(p1,q1))</span><br><span class="line"></span><br><span class="line">p1,q1 = <span class="built_in">int</span>(solution1[<span class="number">1</span>][<span class="number">0</span>]),<span class="built_in">int</span>(solution1[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">d1 = gmpy2.invert(e,(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">flag1 = long_to_bytes(m1)[:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">c2 = <span class="number">7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span></span><br><span class="line">n2 = <span class="number">140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span></span><br><span class="line">leak2 = <span class="number">58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span></span><br><span class="line"></span><br><span class="line">tmp = leak2 - n2 -<span class="number">1</span></span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,tmp,n2)</span><br><span class="line">flag2 = long_to_bytes(m2)[:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">c3 = <span class="number">54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span></span><br><span class="line">n3 = <span class="number">88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span></span><br><span class="line">leak3 = <span class="number">19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span></span><br><span class="line"></span><br><span class="line">p3 = symbols(<span class="string">&#x27;p3&#x27;</span>)</span><br><span class="line">q3 = symbols(<span class="string">&#x27;q3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq3 = p3 + q3 - leak3</span><br><span class="line">eq4 = p3 * q3 - n3</span><br><span class="line"></span><br><span class="line">solution3 = solve((eq3,eq4),(p3,q3))</span><br><span class="line"></span><br><span class="line">p3,q3 = <span class="built_in">int</span>(solution3[<span class="number">0</span>][<span class="number">0</span>]),<span class="built_in">int</span>(solution3[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">d3 = gmpy2.invert(e,(p3-<span class="number">1</span>)*(q3-<span class="number">1</span>))</span><br><span class="line">m3 = <span class="built_in">pow</span>(c3,d3,n3)</span><br><span class="line">flag3 = long_to_bytes(m3)[:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="三十四、扩展欧几里得求逆元d1-d2"><a href="#三十四、扩展欧几里得求逆元d1-d2" class="headerlink" title="三十四、扩展欧几里得求逆元d1-d2"></a>三十四、扩展欧几里得求逆元d1-d2</h1><h2 id="例题-6"><a href="#例题-6" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag = &#x27;flag&#123;&#x27;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">flag1=flag[:21]</span><br><span class="line">flag2=flag[21:]</span><br><span class="line">m1=libnum.s2n(flag1)</span><br><span class="line">m2=libnum.s2n(flag2)</span><br><span class="line"></span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q= getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">e1 =  getPrime(16)</span><br><span class="line">e2 =  getPrime(16)</span><br><span class="line">d1 =libnum.invmod(e1,phi)</span><br><span class="line">d2 =libnum.invmod(e2,phi)</span><br><span class="line">dd=d2-d1</span><br><span class="line"></span><br><span class="line">c1=pow(m1,e1,n)</span><br><span class="line">c2=pow(m2,e2,n)</span><br><span class="line">print(&quot;c1=&quot;,c1)</span><br><span class="line">print(&quot;c2=&quot;,c2)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;e1=&quot;,e1)</span><br><span class="line">print(&quot;e2=&quot;,e2)</span><br><span class="line">print(&quot;dd=&quot;,dd)</span><br><span class="line">c1= 6733838789459931199058149670308727260843741096811449715444872676794872013183754622858142358860953409090471275056663852093255382831595445093389027611418533073251542228105122098655672243201566013269049673257545950265921334769453660794260369460626145929789420379373117970169521395700109883829930832864801056074877674941597582088285235646759637909087476295147786527873676567410566717421523346422950182870668646809884825822209501435038703929387996244766422894277224634645939878481756200099084364167558964681594043169720137522542692333678325260048812579899748925536673077066928758276593208971988942663469169538691035047694</span><br><span class="line">c2= 8366277709764400685046974874556048480052496413928056769515579166359481224673400489772756573250767790594839615839083763898307048126689342195264524356874243599245090238779605753249119610170611143039424214272370993787185091949643348010978753622976256276642743234789172453774761354256683433570844983636116313586831018168267526012235746840937969827190549583438830654378812487809058974682282579118375227701868159940746116268326846677193441199872518360781657796776416813543201068186698175639943920727192924592723876352818832499607933389909348997360827293372712297925074254469038243598148632369617179529428124887418815513980</span><br><span class="line">n= 18817594671090743657272253762944576150137162885923542977286206265757425414985090758109410978146720356103998948718214270184508716827830409430441234706995168712344420950028012950634922410416769515072316211057242302962478172436850591043456595538065256499508407496097561437670387166881800267145313078814265201339439524924036116421018006462379533497424347501070705658003620710859122307390256199828928801036473297236708659050799043830928526868538891939761670420670258518198985039020439020541730747119429222464031076670255708095414432621713513727172536335364200547007022393362808026249379896670380908869775413898849075996507</span><br><span class="line">e1= 41981</span><br><span class="line">e2= 36209</span><br><span class="line">dd= 1053704841024395437174966126533190981616292415576606812740918909121096916949302531783101209289389200245384407349748603292561596667558819619086001066677101374394170513370717808658925536480708691940905153090874424365353443644389110969859064875481674601586495481715770875127506827571256652900931272013627123620403523296244399421027877414684962334619785788986710188422499709843593365835744664902744928748656403821851709598285463439355756235533416138015740467498790254173390459329436575772984367497189565361716119512393162905231586789553789322178062842452918483776810036444979996001994632844167024771563150952249751416556</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/43.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1= <span class="number">6733838789459931199058149670308727260843741096811449715444872676794872013183754622858142358860953409090471275056663852093255382831595445093389027611418533073251542228105122098655672243201566013269049673257545950265921334769453660794260369460626145929789420379373117970169521395700109883829930832864801056074877674941597582088285235646759637909087476295147786527873676567410566717421523346422950182870668646809884825822209501435038703929387996244766422894277224634645939878481756200099084364167558964681594043169720137522542692333678325260048812579899748925536673077066928758276593208971988942663469169538691035047694</span></span><br><span class="line">c2= <span class="number">8366277709764400685046974874556048480052496413928056769515579166359481224673400489772756573250767790594839615839083763898307048126689342195264524356874243599245090238779605753249119610170611143039424214272370993787185091949643348010978753622976256276642743234789172453774761354256683433570844983636116313586831018168267526012235746840937969827190549583438830654378812487809058974682282579118375227701868159940746116268326846677193441199872518360781657796776416813543201068186698175639943920727192924592723876352818832499607933389909348997360827293372712297925074254469038243598148632369617179529428124887418815513980</span></span><br><span class="line">n= <span class="number">18817594671090743657272253762944576150137162885923542977286206265757425414985090758109410978146720356103998948718214270184508716827830409430441234706995168712344420950028012950634922410416769515072316211057242302962478172436850591043456595538065256499508407496097561437670387166881800267145313078814265201339439524924036116421018006462379533497424347501070705658003620710859122307390256199828928801036473297236708659050799043830928526868538891939761670420670258518198985039020439020541730747119429222464031076670255708095414432621713513727172536335364200547007022393362808026249379896670380908869775413898849075996507</span></span><br><span class="line">e1= <span class="number">41981</span></span><br><span class="line">e2= <span class="number">36209</span></span><br><span class="line">dd= <span class="number">1053704841024395437174966126533190981616292415576606812740918909121096916949302531783101209289389200245384407349748603292561596667558819619086001066677101374394170513370717808658925536480708691940905153090874424365353443644389110969859064875481674601586495481715770875127506827571256652900931272013627123620403523296244399421027877414684962334619785788986710188422499709843593365835744664902744928748656403821851709598285463439355756235533416138015740467498790254173390459329436575772984367497189565361716119512393162905231586789553789322178062842452918483776810036444979996001994632844167024771563150952249751416556</span></span><br><span class="line"></span><br><span class="line">kphi = dd*e1*e2 + (e2-e1)</span><br><span class="line"></span><br><span class="line">d1 = gmpy2.invert(e1,kphi)</span><br><span class="line">d2 = gmpy2.invert(e2,kphi)</span><br><span class="line"></span><br><span class="line"><span class="comment">#r,d1,_ = gmpy2.gcdext(e1,kphi)			用扩展欧几里得算法求逆元也可</span></span><br><span class="line"><span class="comment">#r,d2,_ = gmpy2.gcdext(e2,kphi)</span></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n)</span><br><span class="line">flag = long_to_bytes(m1) + long_to_bytes(m2)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="三十五"><a href="#三十五" class="headerlink" title="三十五"></a>三十五</h1><h1 id="三十六、离散对数c-pow-m-flag-n"><a href="#三十六、离散对数c-pow-m-flag-n" class="headerlink" title="三十六、离散对数c &#x3D; pow(m,flag,n)"></a>三十六、离散对数c &#x3D; pow(m,flag,n)</h1><p>先了解一下什么是离散对数</p>
<h2 id="离散对数的定义"><a href="#离散对数的定义" class="headerlink" title="离散对数的定义"></a>离散对数的定义</h2><p>$$<br>当模n有原根时，设l为模n的一个原根，则当x\equiv l^k(mod \quad n)时:<br>$$</p>
<p>$$<br>Ind_lx \equiv k (mod \quad n),Ind_lx是整数l为底，x为真数，模n的离散对数值<br>$$</p>
<p>我的理解是，离散对数就是求解这个x的值，不过是在整数中求解，而不是在实数中<br>$$<br>a^x \equiv b(mod \quad n)<br>$$<br>详细的看这篇文章：<a href="https://zh.wikipedia.org/zh-hans/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0">离散对数 - 维基百科，自由的百科全书 (wikipedia.org)</a></p>
<h2 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h2><p>$$<br>对于互素的整数a,m<br>$$</p>
<p>$$<br>假设存在x使得a^x \equiv 1(mod \quad m),且这个x是所有解中最小的，而且x&#x3D;\phi(m)<br>$$</p>
<p>$$<br>此时称a为模m的原根<br>$$</p>
<p>详细的看这篇文章：<a href="https://zh.wikipedia.org/zh-hans/%E5%8E%9F%E6%A0%B9">原根 - 维基百科，自由的百科全书 (wikipedia.org)</a></p>
<h2 id="怎么求解离散对数"><a href="#怎么求解离散对数" class="headerlink" title="怎么求解离散对数"></a>怎么求解离散对数</h2><p><strong>据我了解到</strong><code>sympy.discrete_log(n,a,b)</code><strong>能求解下式的x</strong><br>$$<br>b^x \equiv a(mod \quad n)<br>$$<br>其源码：<a href="https://github.com/sympy/sympy/blob/d2be7bacd2604e98a642f74028e8f0d7d6084f78/sympy/ntheory/residue_ntheory.py#L1357-L1402">sympy&#x2F;sympy&#x2F;ntheory&#x2F;residue_ntheory.py at d2be7bacd2604e98a642f74028e8f0d7d6084f78 · sympy&#x2F;sympy (github.com)</a></p>
<p><strong>以下是求解普通对数的函数</strong></p>
<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center">numpy.log(x)</td>
<td align="center">以e为底的对数</td>
</tr>
<tr>
<td align="center">numpy.log10(x)</td>
<td align="center">以10为底的对数</td>
</tr>
<tr>
<td align="center">numpy.log2(x)</td>
<td align="center">以2为底的对数</td>
</tr>
<tr>
<td align="center">numpy.log1p(x)</td>
<td align="center">相当于numpy.log(x+1)</td>
</tr>
<tr>
<td align="center">math.log(x)</td>
<td align="center">以e为底的对数</td>
</tr>
<tr>
<td align="center">math.log10(x)</td>
<td align="center">以10为底的对数</td>
</tr>
<tr>
<td align="center">math.log2(x)</td>
<td align="center">以2为底的对数</td>
</tr>
<tr>
<td align="center">math.log1p(x)</td>
<td align="center">相当于math.log(x+1)</td>
</tr>
</tbody></table>
<p><code>math.log(x,n)</code>：计算以n为底，x为真数的值</p>
<h2 id="例题-7"><a href="#例题-7" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">import random</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">e= libnum.s2n(flag)</span><br><span class="line">n=2**512</span><br><span class="line">m = random.randint(2, n-1) | 1</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;m=&quot;,m)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">m= 159288671018830898156155351952186977642819454341811868237859009749383960869982923115380878290375192847504545108933927464025163205891819917678534983817309</span><br><span class="line">c= 12714803532028941243809606974437987862326521262004726834999494702689747253925210908627215296516631899337657950072189903034513687791841244487330214554784973</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m= <span class="number">159288671018830898156155351952186977642819454341811868237859009749383960869982923115380878290375192847504545108933927464025163205891819917678534983817309</span></span><br><span class="line">c= <span class="number">12714803532028941243809606974437987862326521262004726834999494702689747253925210908627215296516631899337657950072189903034513687791841244487330214554784973</span></span><br><span class="line">n = <span class="number">2</span>**<span class="number">512</span></span><br><span class="line"></span><br><span class="line">flag = sympy.discrete_log(n,c,m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>



<h1 id="三十七、m-n"><a href="#三十七、m-n" class="headerlink" title="三十七、m &gt; n"></a>三十七、m &gt; n</h1><h2 id="例题-8"><a href="#例题-8" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2 as gp</span><br><span class="line">from secert import flag</span><br><span class="line">assert len(flag)==42</span><br><span class="line">e=0x10001</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getPrime(160)</span><br><span class="line">q=gp.next_prime(p)</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&#x27;n=&#x27;,n)</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">n= 1938198674432811161450690669878250944830265839396906617662062291196152960227589796372087441130963</span><br><span class="line">c= 90170164274936424192415483102025065297184726282389841586708984518420677588910796600189918035116</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/RSA/44.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">1938198674432811161450690669878250944830265839396906617662062291196152960227589796372087441130963</span></span><br><span class="line">c= <span class="number">90170164274936424192415483102025065297184726282389841586708984518420677588910796600189918035116</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = gmpy2.next_prime(t)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>,<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    m = m1 + k*n</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="三十八、ppp和ppq"><a href="#三十八、ppp和ppq" class="headerlink" title="三十八、ppp和ppq"></a>三十八、ppp和ppq</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">flag = b&quot;flag&#123;xxxxxx&#125;&quot;</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">e = 65537</span><br><span class="line">n = p*p*q</span><br><span class="line">t = p*p*p</span><br><span class="line">c = powmod(m, e, n)</span><br><span class="line">print(c)</span><br><span class="line">print(n)</span><br><span class="line">print(t)</span><br><span class="line"></span><br><span class="line"># 695811613220508521533410410135903763704380792345313822348335925535019364085287973391006658091756337941388790850576390425798691514904654108730064898721482454942897809486946732327567166790987988769649339266791907850313832700513155194190805272799105846921535231183458026312210254181900390502309417588847104213793231394168583827484833346266655392107254900891316034825295594615584454126662183967495486871019315836843964142146438253642093949267821928660254775556448682535996878217802620757735862588509198138308229216540912203307177130148261480033848867147610177292359480179993393430101548639801133574244188591918478576785400355882470444135385837723688465703459098247158590332167802098779963168624783522306380012451430590453130321881597629274617390265737278952430391455292129197120724233266227673065462001473529262207830010588159156853973215615518415224386700532070174251781750417203041543631328597659473610199473825400069638203715</span><br><span class="line"># 1103142672269025650462929198164640404493425942265040323371207998377200145961695641048087337404972402560194267711668479433180851107371884950953570911657090487495216386781924343363213345312692741516666557796484628501590914827387171553761258413087800091632213720047678961681727564158606220008125433169164157150198004730103285226539823741065685538894369776994256049396334124080247371292445543852118777801692107831636409684364527162627188519199064013189168290873007156380530155343171815296016451575866508168728518236121071519646489851701773457562537221387306293985011019040423572239157745630631563892081210964602524396761067561161422635793249097955070576281428534742447903449072401000345617064665752070967341863838984791405144869303448662169933201623421080650216122814985967041163663854812030159367202820911939914186148267664571396203542821594364250609009816872825447917845472311564561269905225280796615586133341770795940714518373</span><br><span class="line"># 1352157133681616199949626085859887520183044653936717410198546937928330648087119395184417755928058157424764679366526294873446661771336360719004981235527982326342186212780230888122434477779310176780131887691097470115061291877918798366484343129280364265571974776435297187299058517674913907506344826320352532394679559865918025267583173757096064690288877037701829014463065076789753953054738098985305066307636180043889030783678919407771611169741555877144593927382649961986384716532446388338376466150688150609936293316903617335385558920141250240529204636396228961938978325120385146208552506658553610353813640686759609897131817533377973931149277140553678119548578402674858651748611808600372129132750796909828079961432457264127651812438564831345298563698676305419952826466259729378236885089128224289161328570151277873778313473830713469181909893871432564345696475759124658962121070495959528237764331872929513704863754771030741820729657</span><br></pre></td></tr></table></figure>

<p><strong>把t开根号就能得到p，然后就是解RSA</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">695811613220508521533410410135903763704380792345313822348335925535019364085287973391006658091756337941388790850576390425798691514904654108730064898721482454942897809486946732327567166790987988769649339266791907850313832700513155194190805272799105846921535231183458026312210254181900390502309417588847104213793231394168583827484833346266655392107254900891316034825295594615584454126662183967495486871019315836843964142146438253642093949267821928660254775556448682535996878217802620757735862588509198138308229216540912203307177130148261480033848867147610177292359480179993393430101548639801133574244188591918478576785400355882470444135385837723688465703459098247158590332167802098779963168624783522306380012451430590453130321881597629274617390265737278952430391455292129197120724233266227673065462001473529262207830010588159156853973215615518415224386700532070174251781750417203041543631328597659473610199473825400069638203715</span></span><br><span class="line">n = <span class="number">1103142672269025650462929198164640404493425942265040323371207998377200145961695641048087337404972402560194267711668479433180851107371884950953570911657090487495216386781924343363213345312692741516666557796484628501590914827387171553761258413087800091632213720047678961681727564158606220008125433169164157150198004730103285226539823741065685538894369776994256049396334124080247371292445543852118777801692107831636409684364527162627188519199064013189168290873007156380530155343171815296016451575866508168728518236121071519646489851701773457562537221387306293985011019040423572239157745630631563892081210964602524396761067561161422635793249097955070576281428534742447903449072401000345617064665752070967341863838984791405144869303448662169933201623421080650216122814985967041163663854812030159367202820911939914186148267664571396203542821594364250609009816872825447917845472311564561269905225280796615586133341770795940714518373</span></span><br><span class="line">t = <span class="number">1352157133681616199949626085859887520183044653936717410198546937928330648087119395184417755928058157424764679366526294873446661771336360719004981235527982326342186212780230888122434477779310176780131887691097470115061291877918798366484343129280364265571974776435297187299058517674913907506344826320352532394679559865918025267583173757096064690288877037701829014463065076789753953054738098985305066307636180043889030783678919407771611169741555877144593927382649961986384716532446388338376466150688150609936293316903617335385558920141250240529204636396228961938978325120385146208552506658553610353813640686759609897131817533377973931149277140553678119548578402674858651748611808600372129132750796909828079961432457264127651812438564831345298563698676305419952826466259729378236885089128224289161328570151277873778313473830713469181909893871432564345696475759124658962121070495959528237764331872929513704863754771030741820729657</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(t,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">q = n // p**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">phi = (p**<span class="number">2</span>-p)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,(phi))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;Now_u_kn0w_GCD_and_s1mpl3_RSA&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="三十九、扩展中国剩余定理"><a href="#三十九、扩展中国剩余定理" class="headerlink" title="三十九、扩展中国剩余定理"></a>三十九、扩展中国剩余定理</h1><h2 id="1-求d"><a href="#1-求d" class="headerlink" title="1.求d"></a>1.求d</h2><h3 id="例题-9"><a href="#例题-9" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">r = getPrime(512)</span><br><span class="line">e = getPrime(32)</span><br><span class="line">print(e)</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-1)*(q-1)*(r-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">dp = d%((q-1)*(r-1))</span><br><span class="line">dq = d%((p-1)*(r-1))</span><br><span class="line">dr = d%((p-1)*(q-1))</span><br><span class="line">flag = &#x27;flag&#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#125;&#x27;</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">print(r)</span><br><span class="line">print(dp)</span><br><span class="line">print(dq)</span><br><span class="line">print(dr)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">p=12922128058767029848676385650461975663483632970994721128398090402671357430399910236576943902580268365115559040908171487273491136108931171215963673857907721</span><br><span class="line">q=10395910293559541454979782434227114401257890224810826672485874938639616819909368963527556812339196570118998080877100587760101646884011742783881592586607483</span><br><span class="line">r=8104533688439480164488403019957173637520526666352540480766865791142556044817828133446063428255474375204188144310967625626318466189746446739697284656837499</span><br><span class="line">dp=73360412924315743410612858109886169233122608813546859531995431159702281180116580962235297605024326120716590757069707814371806343766956894408106019058184354279568525768909190843389534908163730972765221403797428735591146943727032277163147380538250142612444372315262195455266292156566943804557623319253942627829</span><br><span class="line">dq=40011003982913118920477233564329052389422276107266243287367766124357736739027781899850422097218506350119257015460291153483339485727984512959771805645640899525080850525273304988145509506962755664208407488807873672040970416096459662677968243781070751482234692575943914243633982505045357475070019527351586080273</span><br><span class="line">dr=21504040939112983125383942214187695383459556831904800061168077060846983552476434854825475457749096404504088696171780970907072305495623953811379179449789142049817703543458498244186699984858401903729236362439659600561895931051597248170420055792553353578915848063216831827095100173180270649367917678965552672673</span><br><span class="line">c=220428832901130282093087304800127910055992783874826238869471313726515822196746908777026147887315019800546695346099376727742597231512404648514329911088048902389321230640565683145565701498095660019604419213310866468276943241155853029934366950674139215056682438149221374543291202295130547776549069333898123270448986380025937093195496539532193583979030254746589985556996040224572481200667498253900563663950531345601763949337787268884688982469744380006435119997310653</span><br></pre></td></tr></table></figure>

<p>$$<br>用中国剩余定理解\<br>\left{\begin{matrix}<br>dp \equiv d \mod (q-1)(r-1)\<br>dq \equiv d \mod (p-1)(r-1)\<br>dr \equiv d \mod (p-1)(q-1)<br>\end{matrix}\right.<br>$$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">12922128058767029848676385650461975663483632970994721128398090402671357430399910236576943902580268365115559040908171487273491136108931171215963673857907721</span></span><br><span class="line">q=<span class="number">10395910293559541454979782434227114401257890224810826672485874938639616819909368963527556812339196570118998080877100587760101646884011742783881592586607483</span></span><br><span class="line">r=<span class="number">8104533688439480164488403019957173637520526666352540480766865791142556044817828133446063428255474375204188144310967625626318466189746446739697284656837499</span></span><br><span class="line">dp=<span class="number">73360412924315743410612858109886169233122608813546859531995431159702281180116580962235297605024326120716590757069707814371806343766956894408106019058184354279568525768909190843389534908163730972765221403797428735591146943727032277163147380538250142612444372315262195455266292156566943804557623319253942627829</span></span><br><span class="line">dq=<span class="number">40011003982913118920477233564329052389422276107266243287367766124357736739027781899850422097218506350119257015460291153483339485727984512959771805645640899525080850525273304988145509506962755664208407488807873672040970416096459662677968243781070751482234692575943914243633982505045357475070019527351586080273</span></span><br><span class="line">dr=<span class="number">21504040939112983125383942214187695383459556831904800061168077060846983552476434854825475457749096404504088696171780970907072305495623953811379179449789142049817703543458498244186699984858401903729236362439659600561895931051597248170420055792553353578915848063216831827095100173180270649367917678965552672673</span></span><br><span class="line">c=<span class="number">220428832901130282093087304800127910055992783874826238869471313726515822196746908777026147887315019800546695346099376727742597231512404648514329911088048902389321230640565683145565701498095660019604419213310866468276943241155853029934366950674139215056682438149221374543291202295130547776549069333898123270448986380025937093195496539532193583979030254746589985556996040224572481200667498253900563663950531345601763949337787268884688982469744380006435119997310653</span></span><br><span class="line"></span><br><span class="line">b1 = (q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">b2 = (p-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">b3 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = crt([b1,b2,b3],[dp,dq,dr])	<span class="comment">#crt([模],[余数])</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d[i],p*q*r)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;8ec820e5251db6e7a1758543a1123824&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-求c"><a href="#2-求c" class="headerlink" title="2.求c"></a>2.求c</h2><h3 id="例题-10"><a href="#例题-10" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line"># from secret import flag</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">table=&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">pad=100-len(flag)</span><br><span class="line">for i in range(pad):</span><br><span class="line">    flag+=random.choice(table).encode()</span><br><span class="line">e=343284449</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">assert m&gt;(1&lt;&lt;512)</span><br><span class="line">assert m&lt;(1&lt;&lt;1024)</span><br><span class="line">p=getPrime(512)</span><br><span class="line">q=getPrime(512)</span><br><span class="line">r=getPrime(512)</span><br><span class="line">print(&#x27;p=&#x27;,p)</span><br><span class="line">print(&#x27;q=&#x27;,q)</span><br><span class="line">print(&#x27;r=&#x27;,r)</span><br><span class="line">n1=p*q</span><br><span class="line">n2=q*r</span><br><span class="line">c1=pow(m,e,n1)</span><br><span class="line">c2=pow(m,e,n2)</span><br><span class="line">print(&#x27;c1=&#x27;,c1)</span><br><span class="line">print(&#x27;c2=&#x27;,c2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p= 11820891196647569262137841192985418014377132106496147254821784946481523526822939129065042819464351666077658751406165276121125571355594004514547517855730743</span><br><span class="line">q= 10450390015864176713581330969519712299844487112687677452105216477861582967322473997670559995588440097951786576039009337782247912476227937589298529580432797</span><br><span class="line">r= 9484954066160968219229920429258150817546418633451929876581842443665029377287119340232501682142185708534413073877473741393278935479791561681402673403009771</span><br><span class="line"></span><br><span class="line">c1= 69574855207460025252857869494766338442370688922127811393280455950372371842144946699073877876005649281006116543528211809466226185922844601714337317797534664683681334132261584497953105754257846471069875622054326463757746293958069752489458646460121725019594141157667480846709081917530190233900184428943585065316</span><br><span class="line">c2= 66183492015178047844987766781469734325646160179923242098082430373061510938987908656007752256556018402101435698352339429316390909525615464024332856855411414576031970267795270882896721069952171988506477519737923165566896609181813523905810373359029413963666924039857159685161563252396502381297700252749204993228</span><br></pre></td></tr></table></figure>

<p>$$<br>先用中国剩余定理解出c\<br>得到的这个c是满足c \equiv m^e \mod lcm(n_1,n_2)\<br>即c \equiv m^e \mod pqr\<br>推出c \equiv m^e \mod pr<br>$$</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p= <span class="number">11820891196647569262137841192985418014377132106496147254821784946481523526822939129065042819464351666077658751406165276121125571355594004514547517855730743</span></span><br><span class="line">q= <span class="number">10450390015864176713581330969519712299844487112687677452105216477861582967322473997670559995588440097951786576039009337782247912476227937589298529580432797</span></span><br><span class="line">r= <span class="number">9484954066160968219229920429258150817546418633451929876581842443665029377287119340232501682142185708534413073877473741393278935479791561681402673403009771</span></span><br><span class="line">e= <span class="number">343284449</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1= <span class="number">69574855207460025252857869494766338442370688922127811393280455950372371842144946699073877876005649281006116543528211809466226185922844601714337317797534664683681334132261584497953105754257846471069875622054326463757746293958069752489458646460121725019594141157667480846709081917530190233900184428943585065316</span></span><br><span class="line">c2= <span class="number">66183492015178047844987766781469734325646160179923242098082430373061510938987908656007752256556018402101435698352339429316390909525615464024332856855411414576031970267795270882896721069952171988506477519737923165566896609181813523905810373359029413963666924039857159685161563252396502381297700252749204993228</span></span><br><span class="line"></span><br><span class="line">n1 = p*q</span><br><span class="line">n2 = q*r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = crt([n1,n2],[c1,c2])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    n = p*r</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c[i],d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><strong>解密的时候适当化简一下？</strong></p>
<h1 id="四十、e和phi不互素，用中国剩余定理"><a href="#四十、e和phi不互素，用中国剩余定理" class="headerlink" title="四十、e和phi不互素，用中国剩余定理"></a>四十、e和phi不互素，用中国剩余定理</h1>]]></content>
      <categories>
        <category>现代密码-非对称加密</category>
      </categories>
      <tags>
        <tag>现代密码</tag>
        <tag>非对称加密</tag>
        <tag>RSA</tag>
      </tags>
  </entry>
</search>
