<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="隐藏数问题（HNP &#x2F; Hidden Number Problem）">
<meta property="og:type" content="article">
<meta property="og:title" content="HNP">
<meta property="og:url" content="https://dexterjie.github.io/2023/09/23/HNP/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="隐藏数问题（HNP &#x2F; Hidden Number Problem）">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/HNP/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/HNP/1.png">
<meta property="article:published_time" content="2023-09-23T13:29:24.000Z">
<meta property="article:modified_time" content="2023-09-24T09:22:58.029Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Lattice">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/HNP/0.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/09/23/HNP/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/09/23/HNP/","path":"2023/09/23/HNP/","title":"HNP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>HNP | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-number">1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Level1"><span class="nav-number">2.</span> <span class="nav-text">Level1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E9%81%93%E4%BE%8B%E9%A2%98"><span class="nav-number">2.1.</span> <span class="nav-text">一道例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E6%A0%BC-p-%E5%92%8C-p-%E5%85%B6%E5%AE%9E%E6%98%AF%E4%B8%80%E6%A0%B7%E7%9A%84%EF%BC%8C%E5%8F%AA%E4%B8%8D%E8%BF%87%E6%9C%80%E5%90%8E%E8%A7%84%E7%BA%A6%E7%9A%84%E7%BB%93%E6%9E%9C%E5%B7%AE%E4%BA%86%E6%AD%A3%E8%B4%9F-begin-pmatrix-k-1-k-2-%E2%80%A6-k-14-b-0-1-end-pmatrix-begin-pmatrix-p-0-%E2%80%A6-0-0-0-0-p-%E2%80%A6-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-%E2%80%A6-p-0-0-E-1-E-2-%E2%80%A6-E-14-1-0-D-1-D-2-%E2%80%A6-D-14-0-R-end-pmatrix"><span class="nav-number">3.</span> <span class="nav-text">构造格($p$和$-p$其实是一样的，只不过最后规约的结果差了正负)$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; b_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R\end{pmatrix}</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Level2"><span class="nav-number">4.</span> <span class="nav-text">Level2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E6%A0%BC-begin-pmatrix-k-1-k-2-%E2%80%A6-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-%E2%80%A6-0-0-0-0-p-%E2%80%A6-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-%E2%80%A6-p-0-0-E-1-E-2-%E2%80%A6-E-n-1-1-0-D-1-D-2-%E2%80%A6-D-n-1-0-R-end-pmatrix"><span class="nav-number">5.</span> <span class="nav-text">构造格$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{n-1} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{n-1} &amp; 0 &amp; R\end{pmatrix}</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E9%81%93%E4%BE%8B%E9%A2%98-1"><span class="nav-number">5.1.</span> <span class="nav-text">一道例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9E%84%E9%80%A0-begin-pmatrix-k-1-k-2-%E2%80%A6-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-%E2%80%A6-0-0-0-0-p-%E2%80%A6-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-%E2%80%A6-p-0-0-E-1-E-2-%E2%80%A6-E-14-1-0-D-1-D-2-%E2%80%A6-D-14-0-R-end-pmatrix"><span class="nav-number">6.</span> <span class="nav-text">构造$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R\end{pmatrix}</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Level3"><span class="nav-number">7.</span> <span class="nav-text">Level3</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE-R-2-s-3-T-3-2-s-3-s-1-%EF%BC%8C%E6%9E%84%E9%80%A0%E6%A0%BC-begin-pmatrix-k-1-b-1-1-k-2-b-2-1-%E2%80%A6-k-n-1-b-n-1-1-b-0-3-b-0-1-1-end-pmatrix-begin-pmatrix-q-0-0-0-%E2%80%A6-0-0-0-0-0-T-1-T-3-0-0-%E2%80%A6-0-0-0-0-0-0-0-q-0-%E2%80%A6-0-0-0-0-0-0-0-T-1-T-3-%E2%80%A6-0-0-0-0-0-vdots-vdots-vdots-vdots-ddots-vdots-vdots-vdots-vdots-vdots-0-0-0-0-%E2%80%A6-q-0-0-0-0-0-0-0-0-%E2%80%A6-T-1-T-3-0-0-0-F-1-0-F-2-0-%E2%80%A6-F-n-1-0-1-0-0-E-1-0-E-2-0-%E2%80%A6-E-n-1-0-0-T-3-0-D-1-0-D-2-0-%E2%80%A6-D-n-1-0-0-0-R-end-pmatrix-2n-1-times-2n-1"><span class="nav-number">8.</span> <span class="nav-text">设$R&#x3D;2^{s_3}$,$T_3&#x3D;2^{s_3-s_1}$，构造格$$\begin{pmatrix}k_1 &amp; b_{1,1} &amp; k_2 &amp; b_{2,1} &amp;… &amp; k_{n-1} &amp; b_{n-1,1} &amp; b_{0,3} &amp; b_{0,1} &amp; 1\end{pmatrix}\begin{pmatrix}-q &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\-T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\0 &amp; 0 &amp; -q &amp;0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\0 &amp; 0 &amp; -T_1 &amp; T_3 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots &amp; \vdots &amp; \vdots &amp; \vdots \0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -q &amp; 0 &amp; 0&amp; 0&amp; 0\0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; 0\F_1 &amp; 0 &amp; F_2 &amp; 0 &amp; … &amp; F_{n-1} &amp; 0 &amp; 1 &amp; 0 &amp; 0\E_1 &amp; 0 &amp; E_2 &amp; 0 &amp; … &amp; E_{n-1} &amp; 0 &amp; 0 &amp; T_3 &amp; 0\D_1 &amp; 0 &amp; D_2 &amp; 0 &amp; … &amp; D_{n-1} &amp; 0 &amp; 0 &amp; 0 &amp; R\end{pmatrix}_{(2n+1)\times (2n+1)}</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Level4"><span class="nav-number">9.</span> <span class="nav-text">Level4</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">64</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/09/23/HNP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="HNP | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HNP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-23 21:29:24" itemprop="dateCreated datePublished" datetime="2023-09-23T21:29:24+08:00">2023-09-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-09-24 17:22:58" itemprop="dateModified" datetime="2023-09-24T17:22:58+08:00">2023-09-24</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/09/23/HNP/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/09/23/HNP/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>13 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>隐藏数问题（HNP &#x2F; Hidden Number Problem）</p>
<span id="more"></span>

<p>本文章参考：<a target="_blank" rel="noopener" href="https://tover.xyz/p/HNP-note">HNP学习笔记 | Tover’ Blog</a></p>
<h1 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h1><p><img src="/../images/HNP/0.png"></p>
<p>给出n组方程：$\beta_i \equiv A_ix \mod q$</p>
<p>给出$q$,每组方程中完整的$A_i$和每组方程中$\beta_i$的一部分，目标是求出$x$（每组使用一样的$x$）</p>
<h1 id="Level1"><a href="#Level1" class="headerlink" title="Level1"></a>Level1</h1><blockquote>
<p>泄露高位</p>
</blockquote>
<p>$n &#x3D; 35$，$m &#x3D; 256$，$q &#x3D; 2^m$，泄露$\beta_i$的高$s&#x3D;8$位</p>
<p>根据$A_ix \equiv B_i \mod q$，把$\beta_i$拆成高低位相加，即$A_ix \equiv B_i + b_i \mod q$</p>
<p><strong>根据使用格规约的经验，未知数越小越好，如果未知数过大的话需要一定的技巧转换成小的未知数。</strong>现在有$x$和$b_i$两个未知数，$x&#x3D;mbit$，$b_i&#x3D;(m-s)bit$，如果可以把$x$的未知量转换成$(m-s)bit$以下或者消去的话是最好的（按以前的经验，如果有未知数和模数一样大的话问题大概率不能解，不过也要看具体问题）。</p>
<p>下面把$x$消去</p>
<p>由$A_0x \equiv B_0+b_0 \mod q \longrightarrow x \equiv A_0^{-1}(B_0+b_0) \mod q$</p>
<p>再把$x$代入到$A_ix \equiv B_i+b_i \mod q$</p>
<p>可得$A_0^{-1}A_iB_0 + A_0^{-1}A_ib_0 \equiv B_i + b_i \mod q$</p>
<p>$\longrightarrow A_0^{-1}A_iB_0 + A_0^{-1}A_ib_0-B_i \equiv b_i \mod q$</p>
<p>化简$A_0^{-1}(A_iB_0+A_0B_i)+A_0^{-1}A_ib_0 \equiv b_i \mod q$，括号里的$A_0$是为了凑成$B_i &#x3D; A_0A_0^{-1}B_i$</p>
<p>记$D_i \equiv A_0^{-1}(A_iB_0-A_0B_i) \mod q$，$E_i \equiv A_0^{-1}A_i \mod q$</p>
<p>于是可以得到$D_i + E_ib_0 -k_iq &#x3D; b_i$</p>
<p>其中$D_i+E_ib_0-b_i$大概$(2m-s)bit$，$q &#x3D; 2^{m}$，所以$k_i \approx (m-s)bit$，最终所有未知数都是$(m-s)bit$</p>
<p><strong>具体问题具体分析</strong></p>
<p>构造格</p>
<p><img src="/../images/HNP/1.png"></p>
<p>目标向量的大小约$2^{m-s}$，记为$||\vec{w}||$</p>
<p>格的行列式大约$2^{\frac{n\times m -s}{n+1}}$，记为$||L(B)||$</p>
<p>如果$||\vec{w}|| \le ||L(B)||$，即$m-s \le \frac{n\times m-s}{n+1}$</p>
<p>$\longrightarrow m \le s\times n$</p>
<p>$\longrightarrow n \ge \frac{m}{s} &#x3D; \frac{256}{8} &#x3D; 32$，有32组$A_i$和$B_i$就可以求解</p>
<p>实际应用的时候有个技巧：$\beta_i$拆成$B_i + b_i$中，$b_i$恒为正，如果在$B_i$中加上一个$2^{m-s-1}$（<strong>这里有点疑惑</strong>），$b_i$就可以为负数，于是$|b_i| &#x3D; 2^{m-s-1}$，比原来小了一位。</p>
<p>此时目标向量的大小$||\vec{w}||$约$2^{m-s-1}$</p>
<p>格的行列式$||L(B)|| \approx 2^{\frac{n\times m - s-1}{n+1}}$</p>
<p>此时只需要$m-s-1 \le \frac{n\times m -s -1}{n+1}$</p>
<p>$\longrightarrow m \le s\times(n+1)$</p>
<p>$n \ge \frac{m}{s} -1 &#x3D; \frac{m}{s} &#x3D; \frac{256}{8}-1 &#x3D; 31$</p>
<p>给出大佬的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            <span class="keyword">if</span> BB[ii, jj] == <span class="number">0</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                a += <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = <span class="number">256</span></span><br><span class="line">s = <span class="number">8</span></span><br><span class="line">A = [<span class="number">18552404646625607802031743110914366573746520337013211033858024804225024940105</span>, <span class="number">56740036082990036588497013242271054916308856321570552305509938130173539445472</span>, <span class="number">59151439106786023980294355710672227931867183624220164412449673201752454427530</span>, <span class="number">13237216641371845192978293178609922091717977301070743799393539700879904443882</span>, <span class="number">25521989498907374126270233511179332613176188357074084516145063870461587530079</span>, <span class="number">110373287726565132556868199791116743883479507462720789643002594117884198700321</span>, <span class="number">23164903547736414155098856552696538941671109145839680706777330348132893758376</span>, <span class="number">112317341520121361103394518162080142791337563371930821607290630212762885866685</span>, <span class="number">73602790104232639616117254612617322979502450981103933805801785995687212573454</span>, <span class="number">113145039363502017094862783201370026372300556734287986351718168665459193502214</span>, <span class="number">66752470834028806678996615611836368933193481054193671954744443482353362530351</span>, <span class="number">37885763745636944137222355249634741567990575810143646003783562456845747212235</span>, <span class="number">60674901228684783253438467293302465286904156079948039750087902536773550538257</span>, <span class="number">4029135120952255935577861138157768103871099891225580456050557442883221381899</span>, <span class="number">87110291743288015103684657507788672501671197995888766138553136615049440922626</span>, <span class="number">108475696248983352880061369263551813906495341629323964921505055957988023812980</span>, <span class="number">83416621974706382829277243604100354890139141581042882194438954088524849887867</span>, <span class="number">19245862793444813607481767285049756188815676201896743690081204143253700135972</span>, <span class="number">11702220320346004623919485591819310523698914037766103494194186271288684604641</span>, <span class="number">53650697128270898439439820062869718897508959394971208739178865364160828587866</span>, <span class="number">86298488282944797651846585796016081710178675335636660102781089976336154593543</span>, <span class="number">4136525846891367151846727671338730252074102602553586165236438384243069631589</span>, <span class="number">82731569222552504414520663913443330663589973089453084218485394614125745573229</span>, <span class="number">6986076680374526547120184745403321767740390008363348862463722663630672347111</span>, <span class="number">106422889487655896671519650526514700237258388781502173490854830949789400690408</span>, <span class="number">16775350122321655684381538675737891240435560437644501095997285211841162830283</span>, <span class="number">60715724258075207854441574832820200049713413790161572118914663705964318813735</span>, <span class="number">86378073558442926717305615013480837417875785095929960716238520861353373828520</span>, <span class="number">99622486470993628308838394020972502717831728969329149849214388815946885810359</span>, <span class="number">28456916048865657422674440109984009630438622667667220911784018502270764868902</span>, <span class="number">25892885988982356203939786181343425231879915890968667040243364248452242057900</span>, <span class="number">17413022025348865115063748077713569507127705504386172745313237025251904211992</span>, <span class="number">51234147496890033975981358744482850570851594626878797842820311130273807392120</span>, <span class="number">36008458362103302836895934732945996322469327525421388029129389086179170566920</span>, <span class="number">107550710275116422568739631767667910493746227681937454697899115874888730378358</span>]</span><br><span class="line">B = [<span class="number">157</span>, <span class="number">217</span>, <span class="number">80</span>, <span class="number">79</span>, <span class="number">34</span>, <span class="number">141</span>, <span class="number">103</span>, <span class="number">194</span>, <span class="number">254</span>, <span class="number">201</span>, <span class="number">217</span>, <span class="number">149</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">77</span>, <span class="number">4</span>, <span class="number">143</span>, <span class="number">218</span>, <span class="number">125</span>, <span class="number">124</span>, <span class="number">22</span>, <span class="number">208</span>, <span class="number">219</span>, <span class="number">23</span>, <span class="number">172</span>, <span class="number">127</span>, <span class="number">198</span>, <span class="number">61</span>, <span class="number">77</span>, <span class="number">25</span>, <span class="number">18</span>, <span class="number">38</span>, <span class="number">59</span>, <span class="number">183</span>, <span class="number">62</span>]</span><br><span class="line"></span><br><span class="line">AAA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">BBB = [x <span class="keyword">for</span> x <span class="keyword">in</span> B]</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AAA]</span><br><span class="line">  B = [x <span class="keyword">for</span> x <span class="keyword">in</span> BBB]</span><br><span class="line">  <span class="comment">#B = [x &lt;&lt; (m-s) for x in B]</span></span><br><span class="line">  B = [(x &lt;&lt; (m-s)) + (<span class="number">1</span> &lt;&lt; (m-s-<span class="number">1</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> B]</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">len</span>(A) == <span class="built_in">len</span>(B)</span><br><span class="line">  q = <span class="number">2</span>^m</span><br><span class="line"></span><br><span class="line">  n = <span class="built_in">len</span>(A)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">  AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">  BB = [x <span class="keyword">for</span> x <span class="keyword">in</span> B]</span><br><span class="line">  <span class="keyword">for</span> choice <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AA]</span><br><span class="line">    B = [x <span class="keyword">for</span> x <span class="keyword">in</span> BB]</span><br><span class="line">    <span class="keyword">if</span> A[choice] % <span class="number">2</span> != <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    A0 = A[choice]</span><br><span class="line">    A0i = A0.inverse_mod(q)</span><br><span class="line">    B0 = B[choice]</span><br><span class="line">    <span class="keyword">del</span> A[choice]</span><br><span class="line">    <span class="keyword">del</span> B[choice]</span><br><span class="line">    <span class="keyword">assert</span> gcd(A0, q) == <span class="number">1</span></span><br><span class="line">    Mt = matrix(ZZ, n+<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">      Mt[i, i]  = -q</span><br><span class="line">      Mt[-<span class="number">2</span>, i] = A0i*A[i] % q</span><br><span class="line">      Mt[-<span class="number">1</span>, i] = A0i*(A[i]*B0 - A0*B[i]) % q</span><br><span class="line">    Mt[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    R = <span class="number">2</span>^(m-s-<span class="number">1</span>)</span><br><span class="line">    Mt[-<span class="number">1</span>, -<span class="number">1</span>] = R</span><br><span class="line">    <span class="comment">#print(det(Mt) == 0)</span></span><br><span class="line">    <span class="comment">#matrix_overview(Mt)</span></span><br><span class="line"></span><br><span class="line">    L = Mt.BKZ()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">      <span class="keyword">if</span> l[-<span class="number">1</span>] == R:</span><br><span class="line">        b = vector(l)</span><br><span class="line"></span><br><span class="line">        b0 = b[-<span class="number">2</span>]</span><br><span class="line">        <span class="comment">#print(b0)</span></span><br><span class="line"></span><br><span class="line">        x0 = (B0+b0) * A0.inverse_mod(q) % q</span><br><span class="line"></span><br><span class="line">        test1 = [bi &gt;&gt; (m-s) <span class="keyword">for</span> bi <span class="keyword">in</span> B] </span><br><span class="line">        test2 = [(ai*x0 % q) &gt;&gt; (m-s) <span class="keyword">for</span> ai <span class="keyword">in</span> A]</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(x0)</span><br><span class="line">        <span class="built_in">print</span>(test1)</span><br><span class="line">        <span class="built_in">print</span>(test2)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> test1 == test2:</span><br><span class="line">          <span class="built_in">print</span>(<span class="string">&#x27;get: %d&#x27;</span> % x0)</span><br><span class="line">          exit(<span class="number">0</span>)</span><br><span class="line">          <span class="comment"># 78144589840853375593166683982569465121561954434303166342212446896078204238395</span></span><br></pre></td></tr></table></figure>

<h2 id="一道例题"><a href="#一道例题" class="headerlink" title="一道例题"></a>一道例题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag&#123;xxxxxxx&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">38</span></span><br><span class="line">p = getPrime(<span class="number">300</span>)</span><br><span class="line">t = <span class="number">30</span></span><br><span class="line">x1,x2 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    a = random.randint(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        b = (a * x1 % p) &gt;&gt; (<span class="number">300</span> - <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        b = (a * x2 % p) &amp; (<span class="number">2</span> ** <span class="number">30</span> - <span class="number">1</span>)</span><br><span class="line">    A.append(a)</span><br><span class="line">    B.append(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = [<span class="number">463887498379837178289434930796937204555475877586622290749258048874370169798799337104469937</span>, <span class="number">773107696240723064348524874255963716154847723824140324851906738257594371092025839092322618</span>, <span class="number">959382311121888872352942066453176913016345159699733628226033809692442378255600652170133603</span>, <span class="number">1475439387312927400751305948540244549759336332552059673660666894619118830047069015157686938</span>, <span class="number">849526462831348819335657678027942464464758618063917043187129057068191653250289714276486390</span>, <span class="number">1334127037206856127523941580821068150671372041649866724020399671459149591275291992977444717</span>, <span class="number">270665083631525557759154548751201812246030483353898310710004039080238333516013780476382216</span>, <span class="number">1018902660322104052776222955411066044807125950939527765041383184188103427291053881056928575</span>, <span class="number">209244905602559751670010690327768486619524571513992042827189611303489897515540986981111728</span>, <span class="number">1448752767778370938295347623067314667365820805495380149782146153110745097342875410404772323</span>, <span class="number">259828604923763561672700195721292502767730876290458742290887049867931720014196470106481233</span>, <span class="number">64955927829662789888801246059321257505518334913081564868033981302809434355859085577340789</span>, <span class="number">541853690860409175470448997776819435952775864942641589293140819248380415841093286149509439</span>, <span class="number">1139888865143435145477538463183158820201430904436762627802923622604703492742131126856361559</span>, <span class="number">1275201358819804049372292362561266777547371187070453684762542985512809430125709931354890689</span>, <span class="number">369607296264184981154638102500387132578476452666540211313258531786190436544288889435124252</span>, <span class="number">806708347908045807047609135976903208402075815467445877191713196364943763493569595760618980</span>, <span class="number">1455987609449801976533130312961654430816056114205781282886620693328977276162282426493869107</span>, <span class="number">78240737983903215239118749844347047542830586146993600511897384363311151546231920353144287</span>, <span class="number">178433523161741238741165004364134882377268446191666891015503424004703296483616704501522431</span>, <span class="number">160833029194895051498255704447576591540146606885321132274228852060778655408117052809405842</span>, <span class="number">665439140689838885724776126488323057267424913454382363615180272084605737991756925728109752</span>, <span class="number">1212399960630524647715423021430580541043060607704004760594818883478379710374660040225211737</span>, <span class="number">1024104693386208450852231949868224748229315263011728008967767316172947909984939303025784616</span>, <span class="number">1172245617567690331560150298653167704336960464136186977917753583487333782434094205711336284</span>, <span class="number">783927796969236661199653579569651324291785925516516459946058680074574047025620354913449506</span>, <span class="number">662785009487244748764576805406718936165913097166011574087131710238816769129253409163197996</span>, <span class="number">176622195892476124982696054672313827341938528038522227778420609502821124526352064161794848</span>, <span class="number">1207882741313080019507286406568893562247091201154746129221516369048603742944945854959243209</span>, <span class="number">865971631872293774191772297150903858147356635890878227481230935983612340880935090288780814</span>]</span><br><span class="line">B = [<span class="number">213262950</span>, <span class="number">338585619</span>, <span class="number">651186563</span>, <span class="number">161224022</span>, <span class="number">614133782</span>, <span class="number">358709201</span>, <span class="number">81465247</span>, <span class="number">606102220</span>, <span class="number">333896117</span>, <span class="number">244095320</span>, <span class="number">29938894</span>, <span class="number">126014939</span>, <span class="number">555731335</span>, <span class="number">373319033</span>, <span class="number">662799251</span>, <span class="number">517458562</span>, <span class="number">33441774</span>, <span class="number">922070946</span>, <span class="number">236657217</span>, <span class="number">323031182</span>, <span class="number">143007144</span>, <span class="number">9082131</span>, <span class="number">230128400</span>, <span class="number">805207434</span>, <span class="number">699486605</span>, <span class="number">511887222</span>, <span class="number">957047430</span>, <span class="number">474639197</span>, <span class="number">74284022</span>, <span class="number">547483878</span>]</span><br><span class="line">p = <span class="number">1515897080671400659075132434127277346281580386706329236487649363388239277840368389427768563</span></span><br></pre></td></tr></table></figure>

<p>前半部分考点就是泄露高30位</p>
<p>本题需要满足$n \ge \frac{300}{30} &#x3D; 10$，即需要10组方程进行求解</p>
<h1 id="构造格-p-和-p-其实是一样的，只不过最后规约的结果差了正负-begin-pmatrix-k-1-k-2-…-k-14-b-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix"><a href="#构造格-p-和-p-其实是一样的，只不过最后规约的结果差了正负-begin-pmatrix-k-1-k-2-…-k-14-b-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix" class="headerlink" title="构造格($p$和$-p$其实是一样的，只不过最后规约的结果差了正负)$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; b_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R\end{pmatrix}"></a>构造格($p$和$-p$其实是一样的，只不过最后规约的结果差了正负)<br>$$<br>\begin{pmatrix}<br>k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; b_0 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\<br>E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\<br>D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>b_1 &amp; b_2 &amp; … &amp; b_{14} &amp; b_0 &amp; R<br>\end{pmatrix}<br>$$<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = <span class="number">300</span>                        </span><br><span class="line">s = <span class="number">30</span></span><br><span class="line">A = [...]</span><br><span class="line">B = [...]</span><br><span class="line">p = </span><br><span class="line"></span><br><span class="line">A1 = A[:<span class="number">15</span>]</span><br><span class="line">B1 = [x &lt;&lt; (m-s) <span class="keyword">for</span> x <span class="keyword">in</span> B[:<span class="number">15</span>]]       <span class="comment">#记得移位</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(A1) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):         <span class="comment">#把每个A都当作一次A0</span></span><br><span class="line">    AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A1]</span><br><span class="line">    BB = [x <span class="keyword">for</span> x <span class="keyword">in</span> B1]</span><br><span class="line">    A0 = AA[i]</span><br><span class="line">    B0 = BB[i]</span><br><span class="line">    </span><br><span class="line">    A0i = gmpy2.invert(A0,p)</span><br><span class="line">    <span class="keyword">del</span> AA[i]              <span class="comment">#从AA中删去A0</span></span><br><span class="line">    <span class="keyword">del</span> BB[i]              <span class="comment">#同理</span></span><br><span class="line">    </span><br><span class="line">    D = []</span><br><span class="line">    E = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(AA)):</span><br><span class="line">        d = A0i * (AA[j]*B0 - A0*BB[j]) % p</span><br><span class="line">        D.append(d)</span><br><span class="line">        e = A0i * AA[j] % p</span><br><span class="line">        E.append(e)</span><br><span class="line">        </span><br><span class="line">    Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Ge[j,j] = p</span><br><span class="line">        Ge[-<span class="number">2</span>,j] = E[j]</span><br><span class="line">        Ge[-<span class="number">1</span>,j] = D[j]</span><br><span class="line">    R = <span class="number">2</span>^(m-s)</span><br><span class="line">    Ge[-<span class="number">1</span>,-<span class="number">1</span>] = R</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(line[-<span class="number">1</span>]) == R:</span><br><span class="line">            b0 = <span class="built_in">abs</span>(line[-<span class="number">2</span>])</span><br><span class="line">            x0 = (B0+b0) * A0i % p</span><br><span class="line">            <span class="built_in">print</span>(x0)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x0)))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="Level2"><a href="#Level2" class="headerlink" title="Level2"></a>Level2</h1><blockquote>
<p>泄露低位</p>
</blockquote>
<p>$n &#x3D; 35$，$m &#x3D; 256$，$p &#x3D; 2^m$，泄露$\beta_i$的低$s&#x3D;8$位</p>
<p>令$T&#x3D;2^s$，$B_i$为$\beta_i$的高$(m-s)$位，$b_i$为泄露的低$s$位</p>
<p>于是$A_ix \equiv \beta \mod p$变为</p>
<p>$A_ix \equiv TB_i + b_i \mod p$</p>
<p>和泄露高位一样，消去$x$</p>
<p>由$A_ix \equiv TB_i + b_i \mod p$得$x \equiv A_0^{-1}(TB_0+b_0) \mod p$</p>
<p>代入得$A_iA_0^{-1}TB_0 + A_iA_0^{-1}b_0 \equiv TB_i + b_i \mod p$</p>
<p>再同乘$T^{-1}$得$A_iA_0^{-1}B_0 + (TA_0)^{-1}A_ib_0 - T^{-1}b_i \equiv B_i \mod p$</p>
<p>化简一下得到$(TA_0)^{-1}(A_ib_0 - A_0b_i) +(A_0^{-1}A_i)B_0 \equiv B_i \mod p$</p>
<p>令$D_i \equiv (TA_0)^{-1}(A_ib_0 - A_0b_i) \mod p$，$E_i \equiv (A_0^{-1}A_i) \mod p$</p>
<p>则有$D_i + E_iB_0 -k_ip &#x3D; B_i$</p>
<p>$D_i\approx 256bit,E_iB_0 \approx 256+(m-s)bit$，$\therefore k_i$大概$(m-s)bit$</p>
<h1 id="构造格-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-n-1-1-0-D-1-D-2-…-D-n-1-0-R-end-pmatrix"><a href="#构造格-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-n-1-1-0-D-1-D-2-…-D-n-1-0-R-end-pmatrix" class="headerlink" title="构造格$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{n-1} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{n-1} &amp; 0 &amp; R\end{pmatrix}"></a>构造格<br>$$<br>\begin{pmatrix}<br>k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\<br>E_1 &amp; E_2 &amp; … &amp;E_{n-1} &amp; 1 &amp; 0\<br>D_1 &amp; D_2 &amp; … &amp;D_{n-1} &amp; 0 &amp; R<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>B_1 &amp; B_2 &amp; … &amp; B_{n-1} &amp; B_0 &amp; R<br>\end{pmatrix}<br>$$<br>目标向量的大小约$2^{m-s}$，记为$||\vec{w}||$</p>
<p>格的行列式大约$2^{\frac{n\times m -s}{n+1}}$，记为$||L(B)||$</p>
<p>和level1一样需要满足$s\times n \ge m$，当$n\ge \frac{256}{8}&#x3D;32$时，即可求解</p>
<p>同样可以类似地给每个$b_i$加上一个$S &#x3D; 2^{m-1}$，以缩小$|B_i|$，最后同样算出需要$s\times(n+1) \ge m$，当$n\ge \frac{256}{8}-1 &#x3D; 31$时，即可求解</p>
<p>大佬的exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">256</span></span><br><span class="line">s = <span class="number">8</span></span><br><span class="line">q = <span class="number">115489892924193056836132383269279333763560438068210655617495986590734951348939</span></span><br><span class="line">A = [<span class="number">88343870158530321655131443357178261426174895372868830504272120303037917055013</span>, <span class="number">85325303175048321004526613601928244614666767838733487462001976992406756134576</span>, <span class="number">90882364208421865383373693892883461160089951040169826835449248853396593827733</span>, <span class="number">48914354030973321553237573953543292277797421300981960367879618295795824538320</span>, <span class="number">54807516969335094120648558162272221993576047935493515314772824356732246459169</span>, <span class="number">36812706430304694201746706101182856438293116568179945850376468523555258664980</span>, <span class="number">82131367704052948529124949596528379797191577328465393163417792351565563409081</span>, <span class="number">79831902260187536843981833314825687645917600445250894882694033518072492615411</span>, <span class="number">66451378066281903908400021310571865791652283484940347282384194834125438807669</span>, <span class="number">32608010020001240619280738531261961681212354978314347253538745087986905117352</span>, <span class="number">7860885267345608425989913131759834056868685988803386261763395690366879022243</span>, <span class="number">37222587210728314208398619915821886964807914912901991406229349412326449418179</span>, <span class="number">56977280188144899274798380397415402131167271269654342143740837856150016067047</span>, <span class="number">76914199480415217940069930651954512153166917821529826063118308350202255002671</span>, <span class="number">18482272857234951157518933548282264533448787764627865284794057957457833764067</span>, <span class="number">107785071766998271581871821738453393552452017028698961365332240900866426857020</span>, <span class="number">190580133668087354680103117288389841931579854419397703359087694916128442143</span>, <span class="number">87853755322161944258340024647448387411527829155020919155674005583828401150896</span>, <span class="number">76207892917006659328380688401842000960522284878422213324432301551629799359509</span>, <span class="number">89980437739540931413898766918299076236852227002328442545512525695266247961371</span>, <span class="number">29608262839130429904290779751973451938444466286918205057729003916606001439172</span>, <span class="number">115767332930668164788424928332158725353720265911370328402436011707488227509170</span>, <span class="number">23454937519042942777425481684992940005179760184276271526453270580778964069005</span>, <span class="number">51653856405431150848646432136923921761643227936128812898907620835063712753107</span>, <span class="number">38088856145419492865333380128661037442170218303908041272254133861517117697079</span>, <span class="number">75111121637244940656922292991292429644427922643078727610936163720627826376691</span>, <span class="number">37679596638329344601154736576807084398120494208842456132545479949504134442217</span>, <span class="number">19578501816856097058106840236189238165953876832209668961625428053694596718313</span>, <span class="number">106766811019229785397297997988809755521283473820331287599956272493657323971569</span>, <span class="number">43832604772584623719595136819589206777192799798556704267698095619303307189174</span>, <span class="number">70061885003643620468669941804388700557128540127031943407678737766857349689523</span>, <span class="number">37279712184962201746108339606086267909697185360173358859124878886903891176335</span>, <span class="number">11376435694200796618267405577538644656116405689070455991895178888164192367660</span>, <span class="number">1508734971460809891010884694302107503995322143407596431243044985641741988731</span>, <span class="number">60348216835678499133215105211752499387941826826503028490323295859278352333263</span> ]</span><br><span class="line">b = [ <span class="number">93</span>, <span class="number">101</span>, <span class="number">97</span>, <span class="number">64</span>, <span class="number">150</span>, <span class="number">73</span>, <span class="number">243</span>, <span class="number">36</span>, <span class="number">158</span>, <span class="number">102</span>, <span class="number">14</span>, <span class="number">250</span>, <span class="number">20</span>, <span class="number">101</span>, <span class="number">25</span>, <span class="number">167</span>, <span class="number">18</span>, <span class="number">241</span>, <span class="number">106</span>, <span class="number">198</span>, <span class="number">63</span>, <span class="number">110</span>, <span class="number">239</span>, <span class="number">254</span>, <span class="number">192</span>, <span class="number">132</span>, <span class="number">23</span>, <span class="number">62</span>, <span class="number">228</span>, <span class="number">100</span>, <span class="number">120</span>, <span class="number">233</span>, <span class="number">90</span>, <span class="number">14</span>, <span class="number">140</span> ]</span><br><span class="line">T = <span class="number">2</span>^s</span><br><span class="line">Ti = T.inverse_mod(q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(A) == <span class="built_in">len</span>(b)</span><br><span class="line">AAA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">bbb = [x <span class="keyword">for</span> x <span class="keyword">in</span> b]</span><br><span class="line"></span><br><span class="line"><span class="comment">#Z = sorted(list(zip(AAA, bbb)), reverse=True)[:m//s+1]</span></span><br><span class="line">Z = <span class="built_in">sorted</span>(<span class="built_in">list</span>(<span class="built_in">zip</span>(AAA, bbb)), reverse=<span class="literal">True</span>)</span><br><span class="line">A = [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">b = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">S = <span class="number">2</span>^(m-<span class="number">1</span>)</span><br><span class="line">b = [x + S <span class="keyword">for</span> x <span class="keyword">in</span> b]</span><br><span class="line">n = <span class="built_in">len</span>(A)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">bb = [x <span class="keyword">for</span> x <span class="keyword">in</span> b]</span><br><span class="line"><span class="keyword">for</span> choice <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">  A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AA]</span><br><span class="line">  b = [x <span class="keyword">for</span> x <span class="keyword">in</span> bb]</span><br><span class="line"></span><br><span class="line">  A0 = A[choice]</span><br><span class="line">  A0i = A0.inverse_mod(q)</span><br><span class="line">  b0 = b[choice]</span><br><span class="line">  <span class="keyword">del</span> A[choice]</span><br><span class="line">  <span class="keyword">del</span> b[choice]</span><br><span class="line">  <span class="keyword">assert</span> gcd(A0, q) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  Mt = matrix(ZZ, n+<span class="number">2</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Mt[i, i]  = -q</span><br><span class="line">    Mt[-<span class="number">2</span>, i] = A0i*A[i] % q</span><br><span class="line">    Mt[-<span class="number">1</span>, i] = A0i*Ti*(A[i]*b0 - A0*b[i]) % q</span><br><span class="line">  Mt[-<span class="number">2</span>, -<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">  R = <span class="number">2</span>^(m-s-<span class="number">1</span>) + <span class="number">2</span>^(m-s-<span class="number">2</span>)</span><br><span class="line">  Mt[-<span class="number">1</span>, -<span class="number">1</span>] = R</span><br><span class="line"></span><br><span class="line">  L = Mt.BKZ(block_size=Mt.rank())</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> l[-<span class="number">1</span>] == R:</span><br><span class="line">      B = vector(l)</span><br><span class="line"></span><br><span class="line">      B0 = B[-<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">      x0 = (T*B0+b0) * A0i % q</span><br><span class="line"></span><br><span class="line">      test1 = [bi <span class="keyword">for</span> bi <span class="keyword">in</span> bbb] </span><br><span class="line">      test2 = [(ai*x0 % q) &amp; ((<span class="number">1</span>&lt;&lt;s) - <span class="number">1</span>) <span class="keyword">for</span> ai <span class="keyword">in</span> AAA]</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(x0)</span><br><span class="line">      <span class="built_in">print</span>([test1[x]-test2[x] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test1))])</span><br><span class="line">      <span class="comment">#print(test1)</span></span><br><span class="line">      <span class="comment">#print(test2)</span></span><br><span class="line">      <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> test1 == test2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get: %d&#x27;</span> % x0)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 14784001462013082660879013393081171292907080173178221189428088561527208747939</span></span><br></pre></td></tr></table></figure>



<h2 id="一道例题-1"><a href="#一道例题-1" class="headerlink" title="一道例题"></a>一道例题</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;flag&#123;xxxxxxx&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">38</span></span><br><span class="line">p = getPrime(<span class="number">300</span>)</span><br><span class="line">t = <span class="number">30</span></span><br><span class="line">x1,x2 = bytes_to_long(flag[:<span class="built_in">len</span>(flag) // <span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag) // <span class="number">2</span>:])</span><br><span class="line">A = []</span><br><span class="line">B = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    a = random.randint(<span class="number">0</span>,p)</span><br><span class="line">    <span class="keyword">if</span> i &lt; <span class="number">15</span>:</span><br><span class="line">        b = (a * x1 % p) &gt;&gt; (<span class="number">300</span> - <span class="number">30</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        b = (a * x2 % p) &amp; (<span class="number">2</span> ** <span class="number">30</span> - <span class="number">1</span>)</span><br><span class="line">    A.append(a)</span><br><span class="line">    B.append(b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;A = <span class="subst">&#123;A&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;B = <span class="subst">&#123;B&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">A = </span><br><span class="line">B = </span><br><span class="line">p = </span><br></pre></td></tr></table></figure>

<p>同上面的题，这回解的是后半部分</p>
<h1 id="构造-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix"><a href="#构造-begin-pmatrix-k-1-k-2-…-k-14-B-0-1-end-pmatrix-begin-pmatrix-p-0-…-0-0-0-0-p-…-0-0-0-vdots-vdots-ddots-vdots-vdots-vdots-0-0-…-p-0-0-E-1-E-2-…-E-14-1-0-D-1-D-2-…-D-14-0-R-end-pmatrix" class="headerlink" title="构造$$\begin{pmatrix}k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1\end{pmatrix}\begin{pmatrix}p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R\end{pmatrix}"></a>构造<br>$$<br>\begin{pmatrix}<br>k_1 &amp; k_2 &amp; … &amp; k_{14} &amp; B_0 &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>p &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; p &amp; … &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots\<br>0 &amp; 0 &amp; … &amp; p &amp; 0 &amp; 0\<br>E_1 &amp; E_2 &amp; … &amp;E_{14} &amp; 1 &amp; 0\<br>D_1 &amp; D_2 &amp; … &amp;D_{14} &amp; 0 &amp; R<br>\end{pmatrix}</h1><p>\begin{pmatrix}<br>B_1 &amp; B_2 &amp; … &amp; B_{14} &amp; B_0 &amp; R<br>\end{pmatrix}<br>$$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = <span class="number">300</span></span><br><span class="line">s = <span class="number">30</span></span><br><span class="line">A = [...]</span><br><span class="line">B = [...]</span><br><span class="line">p = </span><br><span class="line"></span><br><span class="line">A2 = A[<span class="number">15</span>:]</span><br><span class="line">B2 = B[<span class="number">15</span>:]</span><br><span class="line"></span><br><span class="line">T = <span class="number">2</span>^s</span><br><span class="line">Ti = gmpy2.invert(T,p)</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(A2) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):         <span class="comment">#把每个A都当作一次A0</span></span><br><span class="line">    AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A2]</span><br><span class="line">    bb = [x <span class="keyword">for</span> x <span class="keyword">in</span> B2]</span><br><span class="line">    A0 = AA[i]</span><br><span class="line">    b0 = bb[i]</span><br><span class="line">    </span><br><span class="line">    A0i = gmpy2.invert(A0,p)</span><br><span class="line">    <span class="keyword">del</span> AA[i]              <span class="comment">#从AA中删去A0</span></span><br><span class="line">    <span class="keyword">del</span> bb[i]              <span class="comment">#同理</span></span><br><span class="line">    </span><br><span class="line">    D = []</span><br><span class="line">    E = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(AA)):</span><br><span class="line">        d = (Ti*A0i) * (AA[j]*b0 - A0*bb[j]) % p</span><br><span class="line">        D.append(d)</span><br><span class="line">        e = A0i * AA[j] % p</span><br><span class="line">        E.append(e)</span><br><span class="line">        </span><br><span class="line">    Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        Ge[j,j] = p</span><br><span class="line">        Ge[-<span class="number">2</span>,j] = E[j]</span><br><span class="line">        Ge[-<span class="number">1</span>,j] = D[j]</span><br><span class="line">    R = <span class="number">2</span>^(m-s)</span><br><span class="line">    Ge[-<span class="number">1</span>,-<span class="number">1</span>] = R</span><br><span class="line">    Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(line[-<span class="number">1</span>]) == R:</span><br><span class="line">            B0 = <span class="built_in">abs</span>(line[-<span class="number">2</span>])</span><br><span class="line">            x0 = (T*B0+b0) * A0i % p</span><br><span class="line">            <span class="built_in">print</span>(x0)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x0)))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="Level3"><a href="#Level3" class="headerlink" title="Level3"></a>Level3</h1><blockquote>
<p>泄露中间位数</p>
</blockquote>
<p>前提条件</p>
<p>$n&#x3D;45$，$m&#x3D;512$，$q$是$m$bit的素数，$\beta_i$的高$s_1 &#x3D; 128bit$和低$s_3&#x3D;360bit$未知，泄露$\beta_i$中间$s_2&#x3D;24bit$</p>
<p>先把$\beta_i$划分为3块:<br>$$<br>\beta_i &#x3D; b_{i,1}(s_1\quad bit)\quad ||\quad b_{i,2}(s_2\quad bit)\quad ||\quad b_{i,3}(s_3\quad bit)<br>$$<br>令$T_1 &#x3D; 2^{s_2+s_3}$，$T_2 &#x3D; 2^{s_3}$，问题可以表述为：<br>$$<br>A_ix \equiv T_1b_{i,1} + T_2b_{i,2} + b_{i,3} \mod q<br>$$<br>同样消去$x$<br>$$<br>x \equiv A_0^{-1}(T_1b_{0,1} + T_2b_{0,2} + b_{0,3}) \mod q<br>$$</p>
<p>$$<br>\therefore A_i(A_0^{-1}T_1b_{0,1} + A_0^{-1}T_2b_{0,2} + A_0^{-1}b_{0,3})\equiv T_1b_{i,1} + T_2b_{i,2} + b_{i,3} \mod q<br>$$</p>
<p>化简一下，把$b_{i,3}$放右边，得到$T_2A_0^{-1}(A_ib_{0,2}-A_0b_{i,2})+(T_1A_0^{-1}A_i)b_{0,1}-T_1b_{i,1}+(A_0^{-1}A_i)b_{0,3} \equiv b_{i,3} \mod q$</p>
<p>令$D_i \equiv T_2A_0^{-1}(A_ib_{0,2}-A_0b_{i,2}) \mod q$、$E_i \equiv T_1A_0^{-1}A_i \mod q$、$F_i \equiv A_0^{-1}A_i \mod q$</p>
<p>于是有$b_{i,3} &#x3D; D_i + E_ib_{0,1}-T_1b_{i,1} + F_ib_{0,3} - k_iq$</p>
<h1 id="设-R-2-s-3-T-3-2-s-3-s-1-，构造格-begin-pmatrix-k-1-b-1-1-k-2-b-2-1-…-k-n-1-b-n-1-1-b-0-3-b-0-1-1-end-pmatrix-begin-pmatrix-q-0-0-0-…-0-0-0-0-0-T-1-T-3-0-0-…-0-0-0-0-0-0-0-q-0-…-0-0-0-0-0-0-0-T-1-T-3-…-0-0-0-0-0-vdots-vdots-vdots-vdots-ddots-vdots-vdots-vdots-vdots-vdots-0-0-0-0-…-q-0-0-0-0-0-0-0-0-…-T-1-T-3-0-0-0-F-1-0-F-2-0-…-F-n-1-0-1-0-0-E-1-0-E-2-0-…-E-n-1-0-0-T-3-0-D-1-0-D-2-0-…-D-n-1-0-0-0-R-end-pmatrix-2n-1-times-2n-1"><a href="#设-R-2-s-3-T-3-2-s-3-s-1-，构造格-begin-pmatrix-k-1-b-1-1-k-2-b-2-1-…-k-n-1-b-n-1-1-b-0-3-b-0-1-1-end-pmatrix-begin-pmatrix-q-0-0-0-…-0-0-0-0-0-T-1-T-3-0-0-…-0-0-0-0-0-0-0-q-0-…-0-0-0-0-0-0-0-T-1-T-3-…-0-0-0-0-0-vdots-vdots-vdots-vdots-ddots-vdots-vdots-vdots-vdots-vdots-0-0-0-0-…-q-0-0-0-0-0-0-0-0-…-T-1-T-3-0-0-0-F-1-0-F-2-0-…-F-n-1-0-1-0-0-E-1-0-E-2-0-…-E-n-1-0-0-T-3-0-D-1-0-D-2-0-…-D-n-1-0-0-0-R-end-pmatrix-2n-1-times-2n-1" class="headerlink" title="设$R&#x3D;2^{s_3}$,$T_3&#x3D;2^{s_3-s_1}$，构造格$$\begin{pmatrix}k_1 &amp; b_{1,1} &amp; k_2 &amp; b_{2,1} &amp;… &amp; k_{n-1} &amp; b_{n-1,1} &amp; b_{0,3} &amp; b_{0,1} &amp; 1\end{pmatrix}\begin{pmatrix}-q &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\-T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\0 &amp; 0 &amp; -q &amp;0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\0 &amp; 0 &amp; -T_1 &amp; T_3 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots &amp; \vdots &amp; \vdots &amp; \vdots \0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -q &amp; 0 &amp; 0&amp; 0&amp; 0\0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; 0\F_1 &amp; 0 &amp; F_2 &amp; 0 &amp; … &amp; F_{n-1} &amp; 0 &amp; 1 &amp; 0 &amp; 0\E_1 &amp; 0 &amp; E_2 &amp; 0 &amp; … &amp; E_{n-1} &amp; 0 &amp; 0 &amp; T_3 &amp; 0\D_1 &amp; 0 &amp; D_2 &amp; 0 &amp; … &amp; D_{n-1} &amp; 0 &amp; 0 &amp; 0 &amp; R\end{pmatrix}_{(2n+1)\times (2n+1)}"></a>设$R&#x3D;2^{s_3}$,$T_3&#x3D;2^{s_3-s_1}$，构造格<br>$$<br>\begin{pmatrix}<br>k_1 &amp; b_{1,1} &amp; k_2 &amp; b_{2,1} &amp;… &amp; k_{n-1} &amp; b_{n-1,1} &amp; b_{0,3} &amp; b_{0,1} &amp; 1<br>\end{pmatrix}<br>\begin{pmatrix}<br>-q &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>-T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; 0 &amp; -q &amp;0 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>0 &amp; 0 &amp; -T_1 &amp; T_3 &amp; … &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\<br>\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots &amp; \vdots &amp; \vdots &amp; \vdots \<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -q &amp; 0 &amp; 0&amp; 0&amp; 0\<br>0 &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; -T_1 &amp; T_3 &amp; 0 &amp; 0 &amp; 0\<br>F_1 &amp; 0 &amp; F_2 &amp; 0 &amp; … &amp; F_{n-1} &amp; 0 &amp; 1 &amp; 0 &amp; 0\<br>E_1 &amp; 0 &amp; E_2 &amp; 0 &amp; … &amp; E_{n-1} &amp; 0 &amp; 0 &amp; T_3 &amp; 0\<br>D_1 &amp; 0 &amp; D_2 &amp; 0 &amp; … &amp; D_{n-1} &amp; 0 &amp; 0 &amp; 0 &amp; R<br>\end{pmatrix}_{(2n+1)\times (2n+1)}</h1><p>\begin{pmatrix}<br>b_{1,3} &amp; T_3b_{1,1} &amp; b_{2,3} &amp; T_3b_{2,1} &amp; … &amp;b_{n-1,3} &amp;T_3b_{n-1,1} &amp;b_{0,3} &amp;T_3b_{0,1} &amp; R<br>\end{pmatrix}<br>$$<br><strong>格的规模和大佬博客的有点不同，我就按我理解的来写了</strong></p>
<p>目标向量大小$||\vec{w}|| &#x3D; 2^{s_3}$</p>
<p>格的行列式$||L(B)||&#x3D;2^{\frac{(n-1)(m+s_3-s_1)+2s_3-s_1}{2n+1}}$</p>
<p>若$||\vec{w}||\le ||L(B)||$，即$s_3 \le \frac{(n-1)(m+s_3-s_1)+2s_3-s_1}{2n+1} \longrightarrow n \ge\frac{m}{m-s_1-s_3}$</p>
<p>$\because s_2 &#x3D; m-s_1-s_3$,$\therefore n \ge \frac{m}{s_2}$</p>
<p><strong>优化</strong>：</p>
<p>在已知的$T_2b_{i,2}$部分加上一个$S &#x3D; 2^{m-1}+2^{s_3-1}$，原理和前面类似，就是加上未知数的最高比特，以降低对应未知数的绝对值规模。优化后设置$R&#x3D;2^{s_3-1}$，重新计算<br>$$<br>||\vec{w}|| &#x3D; 2^{s_3-1}<br>$$</p>
<p>$$<br>||L(B)|| &#x3D; 2^{\frac{(n-1)(m+s_3-s_1)+2s_3-s_1-1}{2n+1}}<br>$$</p>
<p>最后算得$n\ge \frac{m}{s_2+2}$</p>
<p>给出大佬的exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"></span><br><span class="line">m = <span class="number">512</span></span><br><span class="line">s1 = <span class="number">128</span></span><br><span class="line">s2 = <span class="number">24</span></span><br><span class="line">s3 = <span class="number">360</span></span><br><span class="line">q = <span class="number">9560792366438456408260738854830723707433313518273338023048084562934319966293294896329095798633420211864817785355567299335123635073425044586190935062371363</span></span><br><span class="line">A = [<span class="number">2693023266307193674130753259922304868222107145570752971321007609478208087950819230325973514861186073885406878323592121469513656969622896317188548446633784</span>, <span class="number">8785512325992763455825199692000460571517834183218755569097223618124106341652451821725892116772650362553591671412077856105898073665095841079486256807067306</span>, <span class="number">12386289199153705766782197687938287187000534145958433894804423142406910927880264185439922256995188378449480018881406273420386620869540926421199629319647214</span>, <span class="number">7416095351737790251022594980817779580684613694979242480002719542428840160491315637681443454956529880170329111614984846032248249259911860552600555136208543</span>, <span class="number">7697974016683042748266020943554913338612433987626989480302426333302909435256004459432900364006268423433788538012565206603339344715546753584818471442207073</span>, <span class="number">4186354864979832730408458284993041599021589619327814632942270492428908405693989535739742148508857495973220315565598757360076249931180977910829693610071891</span>, <span class="number">8727275754915947728643624783163551337534904428297453305136805895543553182595432520579697527391391207848721688173924870776124365612055802346338933900117239</span>, <span class="number">10941460446434501439298848596995106284490140699259548358480147265518996095012828504465005060130558534722968630468802709976609939848406120023146576837789583</span>, <span class="number">8259883991308211154289511718368156026109384650285845641402046351030049037220401142270393361746354406841219671539116472122632627493574700196002513172485655</span>, <span class="number">3983079465191700245062514565458583381962198195683763307819686217487379339901644377536201141397807766062401800178625442075271729346326076527442103453210202</span>, <span class="number">5244702264977327278320870012491074210221462948223915976821656413017924909705064903684162565154071789839960019633013970334716585108365220072590755374703278</span>, <span class="number">5291151012558614600583010230995646257041300794353193390525609590490561648982999435942132384399188745286887878565229424830159154790573275766853617555652411</span>, <span class="number">13376537998776012009314970194028929991069169432509877179648764336298411856607226670179358946433850379350530415443255113457650490622848610735722940367531094</span>, <span class="number">1320577928055881865833264931386525876645366275702245535366485903629214773012241182720232084428261256805275074154279381451085217023438842777730231838805521</span>, <span class="number">4624205834183746767055351710577116259387874270879587844541751892197439724205857803167685894994409036200702335468011492225335415292502168575607445133447261</span>, <span class="number">5563895391050356518337061896431670935091032239251555132293790411864743553590087783206226280221040770267886936512621844705804976864068059070358358625202920</span>, <span class="number">12827790893444989733048776469648788267135383128079693878482232328430354535768514103994571882959591390682332549005644128031384797039513739686323606259957957</span>, <span class="number">12252084608783729245990158175591620197924800323228850960323690735815309501075168493847345371800576057769133986754671778456671004657079586235930970854187752</span>, <span class="number">1657921198563869880350990075690523102625863816457321518288521999596639875255490216514151103766541394560935153182967313558771102516581898630710822943099174</span>,</span><br><span class="line"><span class="number">9219274536121877500448871260238231221042400890788027802089860137401522984959977056772350114877037870187756679617067504051344563745814435804183381170494284</span>, <span class="number">1748460868318530291399045242989575093142552407759686279682576514582197400071186886395009927678257744714825012099081776085396477000150503562703015340857425</span>, <span class="number">12097420237566579272043307832790245960963890522311189050238104792484832017686368855370935990254305211595492665130600310022589959454951879833116897750998428</span>, <span class="number">12358535390937351447732841924647470567841972439921307596541967297460841844333495080824576160065074382448269455680525372581785700464333699293602661448790154</span>, <span class="number">12063760154733402287249071777313421846696267413115226792803495046285138326035281596187883853756001696856539738553227620458124718565607875758917149908543506</span>, <span class="number">2303658006732630530354362396576218217479774096634534067678087368027750523261362874798354672335259847545900339345320813999099554374757386588053933181889964</span>, <span class="number">13080614939780066645485672444555381463913395720598258604233598986511005716421252998376368573125975001945335843989208119713852278971834347770656477810390640</span>, <span class="number">5806228512723887021559003555949389380932506538248366411493934436815507516241692504983935053410147217801131533144935042742154118845215080408645310891794156</span>, <span class="number">4158253803818053710419974676436028020497988289801823810387506682141523891053076010353682008145357553080443635351513680778972858476261005805183169130672271</span>, <span class="number">901720231210245767072309739431942352926185462937666048714174644408372682935523179329498708201825222154246682262800752865190660440778449118418985533094105</span>, <span class="number">10454374169436877663990756889544098958877556026137736165229918458867781739533254573244560790380897040566402158107540558451293997491671638018951381047912688</span>, <span class="number">4974181555682685751542705093313153126511169197799896261763621164887216237401002638750101176367544196892004854663483430137887313549820050138364998675721991</span>, <span class="number">1723335526511535197701833346493128234713348824370996430890310949384112731946661560478260786626542758303897097215563427063632687987122688865533351393834073</span>, <span class="number">10546556973596660252639285860361898932107787308127931983505944003487107775352695197716642212915033191540651979295391343598456422942843486373224024873409627</span>, <span class="number">9079284206247739353345950504298981119615132261207265682594246042963238725134024067814797639517217401860251060295710421418556645862224293836835103902130785</span>, <span class="number">7219827103328150187732953138499280095751899064289748344301075686667703871746653497117283061823025573836231487034678682402057188765887097511436390378979980</span>, <span class="number">4214104343592383857759084728462440814891423459187541675664471381293469160797252117342999154248530698738781467754755294136424903864170164991693886487632855</span>, <span class="number">780191582642434041483668147859478052817167039884006235620769823182094343517569155176753126373426127761829929481146772802353065926975260652961203760272382</span>, <span class="number">2997255382397979337191133019326169357740317929898745842898952849013871743749567559616653759513797345195607539811536780699668359411121434334107663291809383</span>, <span class="number">1090117073747541792795748263189869393635595289682444585726732356599933824574908622345909231267216210206951834470495157839963988798335949836661678705960697</span>, <span class="number">6685657284087595818164753915190068685879934409072315258463222789646095024039544522635167243294747439306676127931109541703671436504324038998479410454735510</span>, <span class="number">3081817971013143842377901811479602610471065791726379727948626375189132386050379067031289551463731722240568637555525105876622277032975228495259350635961603</span>,</span><br><span class="line"><span class="number">7527577790068874896244157688824820434374562845873036315647414123459469674644499728420036444653022289097224618221708343262838243341509907332837392280607606</span>, <span class="number">12903219833816188592504821841083999004930835076092663002731204321979289494552142011690947952258526676858708529308953530978836941060082450559697065146316293</span>, <span class="number">2198565616610080020634243830034549917750482951041529281656489536841785141219855252440954587802988241603984121500632708261676889613560608370887146407895858</span>, <span class="number">3827731453472306068045050791958062181645057625114707438579450671441759582703011636443816013820165485857176842513391210353735870371767070755645538120025864</span> ]</span><br><span class="line">b2 = [ <span class="number">981527</span>, <span class="number">11519059</span>, <span class="number">9672240</span>, <span class="number">10356594</span>, <span class="number">5561848</span>, <span class="number">9422894</span>, <span class="number">16657092</span>, <span class="number">14792987</span>, <span class="number">2713471</span>, <span class="number">9879125</span>, <span class="number">14071330</span>, <span class="number">1576336</span>, <span class="number">1487926</span>, <span class="number">13135164</span>, <span class="number">4134979</span>, <span class="number">1593074</span>, <span class="number">3555191</span>, <span class="number">7304939</span>, <span class="number">15289618</span>, <span class="number">9894255</span>, <span class="number">15950778</span>, <span class="number">9459653</span>, <span class="number">1839077</span>, <span class="number">3882171</span>, <span class="number">2646805</span>, <span class="number">1871250</span>, <span class="number">2837712</span>, <span class="number">7964306</span>, <span class="number">5870823</span>, <span class="number">11468538</span>, <span class="number">12185042</span>, <span class="number">14376056</span>, <span class="number">3815630</span>, <span class="number">7553412</span>, <span class="number">954291</span>, <span class="number">9315730</span>, <span class="number">7777161</span>, <span class="number">10019167</span>, <span class="number">2747540</span>, <span class="number">927416</span>, <span class="number">6882280</span>, <span class="number">8199291</span>, <span class="number">8427358</span>, <span class="number">12316018</span>, <span class="number">5138533</span> ]</span><br><span class="line">T1 = <span class="number">2</span>^(s2+s3)</span><br><span class="line">T2 = <span class="number">2</span>^(s3)</span><br><span class="line">T3 = <span class="number">2</span>^(s3-s1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(A) == <span class="built_in">len</span>(b2)</span><br><span class="line">Aorg = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">b2org = [x <span class="keyword">for</span> x <span class="keyword">in</span> b2]</span><br><span class="line"></span><br><span class="line"><span class="comment">#Z = list(zip(Aorg, b2org))</span></span><br><span class="line"><span class="comment">#Z = list(zip(Aorg, b2org))[:ceil((m-s2)/s2)]</span></span><br><span class="line">Z = <span class="built_in">sorted</span>(<span class="built_in">list</span>(<span class="built_in">zip</span>(Aorg, b2org)), reverse=<span class="literal">True</span>)[:ceil((s1+s3)/s2)+<span class="number">5</span>]</span><br><span class="line">A = [x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">b2 = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> Z]</span><br><span class="line">S = <span class="number">2</span>^(m-<span class="number">1</span>) + <span class="number">2</span>^(s3-<span class="number">1</span>)</span><br><span class="line"><span class="comment">#S = 0</span></span><br><span class="line">b2 = [T2 * x + S <span class="keyword">for</span> x <span class="keyword">in</span> b2]</span><br><span class="line">n = <span class="built_in">len</span>(A)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line">AA = [x <span class="keyword">for</span> x <span class="keyword">in</span> A]</span><br><span class="line">bb2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> b2]</span><br><span class="line"><span class="keyword">for</span> choice <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">  A = [x <span class="keyword">for</span> x <span class="keyword">in</span> AA]</span><br><span class="line">  b2 = [x <span class="keyword">for</span> x <span class="keyword">in</span> bb2]</span><br><span class="line"></span><br><span class="line">  A0 = A[choice]</span><br><span class="line">  A0i = A0.inverse_mod(q)</span><br><span class="line">  b02 = b2[choice]</span><br><span class="line">  <span class="keyword">del</span> A[choice]</span><br><span class="line">  <span class="keyword">del</span> b2[choice]</span><br><span class="line">  <span class="keyword">assert</span> gcd(A0, q) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  Mt = matrix(ZZ, <span class="number">2</span>*n+<span class="number">3</span>)</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Mt[<span class="number">2</span>*i, <span class="number">2</span>*i]  = -q</span><br><span class="line">    Mt[<span class="number">2</span>*i+<span class="number">1</span>, <span class="number">2</span>*i]  = -T1</span><br><span class="line">    Mt[<span class="number">2</span>*i+<span class="number">1</span>, <span class="number">2</span>*i+<span class="number">1</span>]  = T3</span><br><span class="line">    Mt[-<span class="number">3</span>, <span class="number">2</span>*i] = A0i*A[i] % q</span><br><span class="line">    Mt[-<span class="number">2</span>, <span class="number">2</span>*i] = T1*A0i*A[i] % q</span><br><span class="line">    Mt[-<span class="number">1</span>, <span class="number">2</span>*i] = A0i*(A[i]*b02 - A0*b2[i]) % q</span><br><span class="line">  Mt[-<span class="number">3</span>, -<span class="number">3</span>] = <span class="number">1</span></span><br><span class="line">  Mt[-<span class="number">2</span>, -<span class="number">2</span>] = T3</span><br><span class="line">  R = <span class="number">2</span>^(s3-<span class="number">1</span>)</span><br><span class="line">  Mt[-<span class="number">1</span>, -<span class="number">1</span>] = R</span><br><span class="line">  <span class="comment">#matrix_overview(Mt)</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#L = Mt.BKZ(block_size=Mt.rank())</span></span><br><span class="line">  L = Mt.BKZ(block_size=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> l <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> l[-<span class="number">1</span>] == R <span class="keyword">and</span> l[-<span class="number">2</span>]%T3 == <span class="number">0</span> <span class="keyword">and</span> l[-<span class="number">4</span>]%T3 == <span class="number">0</span>:</span><br><span class="line">      b0 = vector(l)</span><br><span class="line"></span><br><span class="line">      b01 = b0[-<span class="number">2</span>] // T3</span><br><span class="line">      b03 = b0[-<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">      x0 = (T1*b01 + b02 + b03) * A0i % q</span><br><span class="line"></span><br><span class="line">      test1 = [bi <span class="keyword">for</span> bi <span class="keyword">in</span> b2org] </span><br><span class="line">      test2 = [((ai*x0 % q) &gt;&gt; s3) % (<span class="number">1</span>&lt;&lt;s2) <span class="keyword">for</span> ai <span class="keyword">in</span> Aorg]</span><br><span class="line"></span><br><span class="line">      <span class="built_in">print</span>(A0, x0)</span><br><span class="line">      <span class="built_in">print</span>([test1[x]-test2[x] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(test1))])</span><br><span class="line">      <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> test1 == test2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;get: %d&#x27;</span> % x0)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">        <span class="comment"># 11175003251502357065368374725827220048766874529296813908783514847111854792422701846999086919622254945359048568224138155336743512330734172901570038320078871117500325150235706536837472582722004876687452929681390878351484711185479242270184699908691962225494535904856822413815533674351233073417290157003832007887</span></span><br></pre></td></tr></table></figure>



<h1 id="Level4"><a href="#Level4" class="headerlink" title="Level4"></a>Level4</h1><blockquote>
<p>分为5个部分</p>
</blockquote>
<p>$n &#x3D; 30$，$m &#x3D; 512$，$q是mbit$的素数，$\beta_i$切成了5段，情况如下：<br>$$<br>\beta_i &#x3D; b_{i,1}(s_1\quad bit)\quad ||\quad b_{i,2}(s_2\quad bit)\quad ||\quad b_{i,3}(s_3\quad bit)\quad || \quad b_{i,4}(s_4 \quad bit) \quad || b_{i,5}(s_5 \quad bit)<br>$$<br>知道每组的$b_{i,2}$和$b_{i,4}$，其中$s_1&#x3D;s_3&#x3D;s_5&#x3D;154$，$s_2&#x3D;s_4&#x3D;25$。</p>
<p>令$s_{135}&#x3D;154$、$s_{24} &#x3D; 25$，再令<br>$$<br>T_1 &#x3D; 2^{s_2+s_3+s_4+s_5} &#x3D; 2^{2s_{135}+2s_{24}}<br>$$</p>
<p>$$<br>T_2&#x3D;2^{s_3+s_4+s_5} &#x3D; 2^{2s_{135}+s_{24}}<br>$$</p>
<p>$$<br>T_3 &#x3D; 2^{s_4+s_5} &#x3D; 2^{s_{135}+s_{24}}<br>$$</p>
<p>$$<br>T_4 &#x3D; 2^{s_5}<br>$$</p>
<p>问题即表述为：<br>$$<br>A_ix \equiv T_1b_{i,1} + T_2b_{i,2}+ T_3b{i,3}+T_4b_{i,4}+b_{i,5}<br>$$<br>还是消去x</p>
<p>得到$A_0^{-1}(T_2(A_ib_{0,2}-A_0b_{i,2})+T_4(A_ib_{0,4}-A_0b_{i,4}))+(T_1A_0^{-1}A_i)b_{0,1}-T_1b_{i,1}+(T_3A_0^{-1}A_i)b_{0,3}-T_3b_{i,3}+(A_0^{-1}A_i)b_{0,5} \equiv b_{i,5} \mod q$</p>
<p>令<br>$$<br>D_i \equiv A_0^{-1}(T_2(A_ib_{0,2}-A_0b_{i,2})+T_4(A_ib_{0,4}-A_0b_{i,4}))\mod q<br>$$</p>
<p>$$<br>E_i \equiv T_1A_0^{-1}A_i \mod q<br>$$</p>
<p>$$<br>F_i \equiv T_3A_0^{-1}A_i \mod q<br>$$</p>
<p>$$<br>G_i \equiv A_0^{-1}A_i \mod q<br>$$</p>
<p>最后化简为$b_{i,5} &#x3D; D_i -T_3b_{i,3}-T_1b_{i,1} +E_ib_{0,1}+F_ib_{0,3}+G_ib_{0,5}-k_iq$</p>
<p>构造格<br>$$<br>\begin{pmatrix}<br>k_1 &amp; b_{1,3} &amp; b_{1,1} &amp; 0 &amp; 0 &amp; 0 &amp; … &amp; k_{n-1}<br>\end{pmatrix}<br>$$</p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/09/23/HNP/" title="HNP">https://dexterjie.github.io/2023/09/23/HNP/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Lattice/" rel="tag"># Lattice</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/09/17/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E9%BB%91%E9%BE%99%E6%B1%9F%E7%9C%81%E8%B5%9B/" rel="prev" title="黑龙江省赛">
                  <i class="fa fa-chevron-left"></i> 黑龙江省赛
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/09/25/SystemView/" rel="next" title="SystemView">
                  SystemView <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">194k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">11:45</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2023/09/23/HNP/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
