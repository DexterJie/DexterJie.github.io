<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录一些未知来源的题目">
<meta property="og:type" content="article">
<meta property="og:title" content="挨打日记">
<meta property="og:url" content="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录一些未知来源的题目">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-07T11:43:13.000Z">
<meta property="article:modified_time" content="2023-09-17T12:25:38.983Z">
<meta property="article:author" content="DexterJie">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/","path":"2023/09/07/挨打日记/","title":"挨打日记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>挨打日记 | DexterJie'Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RSA2%E2%80%94%E2%80%94%E6%9C%AA%E5%AE%8C%E6%88%90"><span class="nav-number">1.</span> <span class="nav-text">RSA2——未完成</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1"><span class="nav-number">2.</span> <span class="nav-text">1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2"><span class="nav-number">3.</span> <span class="nav-text">2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3"><span class="nav-number">4.</span> <span class="nav-text">3</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2023%E6%B1%9F%E8%8B%8F%E7%9C%81%E9%A6%96%E5%B1%8A%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B"><span class="nav-number">5.</span> <span class="nav-text">2023江苏省首届数据安全竞赛</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A5%A5%E4%BA%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%EF%BC%88%E9%AB%98%E6%A0%A1%E7%BB%84%EF%BC%89"><span class="nav-number">6.</span> <span class="nav-text">祥云杯线下（高校组）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ezmath"><span class="nav-number">6.1.</span> <span class="nav-text">ezmath</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="挨打日记 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          挨打日记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-07 19:43:13" itemprop="dateCreated datePublished" datetime="2023-09-07T19:43:13+08:00">2023-09-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-09-17 20:25:38" itemprop="dateModified" datetime="2023-09-17T20:25:38+08:00">2023-09-17</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录一些未知来源的题目</p>
<span id="more"></span>

<h1 id="RSA2——未完成"><a href="#RSA2——未完成" class="headerlink" title="RSA2——未完成"></a>RSA2——未完成</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd ,invert</span><br><span class="line"><span class="keyword">import</span> os,random</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line">flag = <span class="string">&#x27;flag&#123;*****&#125;&#x27;</span></span><br><span class="line">nbit = <span class="number">2048</span></span><br><span class="line">pbit = <span class="number">658</span></span><br><span class="line">qbit = nbit-pbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCRT</span>(<span class="params">mi, ai</span>):</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">isinstance</span>(mi, <span class="built_in">list</span>) <span class="keyword">and</span> <span class="built_in">isinstance</span>(ai, <span class="built_in">list</span>))</span><br><span class="line">    curm, cura = mi[<span class="number">0</span>], ai[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> (m, a) <span class="keyword">in</span> <span class="built_in">zip</span>(mi[<span class="number">1</span>:], ai[<span class="number">1</span>:]):</span><br><span class="line">        d = gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>)</span><br><span class="line">        K = c / d * invert(curm / d, m / d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m / d</span><br><span class="line">    <span class="keyword">return</span> (cura % curm, curm)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>():</span><br><span class="line">    p = getPrime(pbit)</span><br><span class="line">    q = getPrime(qbit)</span><br><span class="line">    <span class="keyword">assert</span>(gcd(p-<span class="number">1</span>,(q-<span class="number">1</span>)//<span class="number">2</span>) != <span class="number">1</span> <span class="keyword">and</span> q &gt;= <span class="built_in">int</span>(<span class="built_in">pow</span>(p*q,qbit//nbit)))</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        dp,dq = random.getrandbits(<span class="number">50</span>), getPrime(<span class="number">50</span>)</span><br><span class="line">        d = GCRT([p-<span class="number">1</span>,q-<span class="number">1</span>],[dp,dq])[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span>(gcd(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)) == <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    e = invert(d,(p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> n,e</span><br><span class="line"></span><br><span class="line">n,e= genkey()</span><br><span class="line"></span><br><span class="line">flag = flag + os.urandom(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span>(flag&lt;n)</span><br><span class="line"><span class="built_in">print</span> n</span><br><span class="line"><span class="comment">#24520888125100345615044288264230762903878924272518571342713995342063192899124989891699091460914318368533612522321639660343147487234147817765379565866063142022911783047710228071012334390251457138278189863078398353697056081286846816500611712981402958876560909958985941278622099006464269427107124576069124593580390423932176305639686809675964840679026457045269910781753881177055233058940084858058581167930068081780478893848660425039669034700316924547379360271738374641525963541506226468912132334624110432284070298157810487695608530792082901545749959813831607311669250447276755584806773237811351439714525063949561215550447</span></span><br><span class="line"><span class="built_in">print</span> e</span><br><span class="line"><span class="comment">#11548167381567878954504039302995879760887384446160403678508673015926195316468675715911159300590761428446214638046840120602736300464514722774979925843178572277878822181099753174300465194145931556418080206026501299370963578262848611390583954955739032904548821443452579845787053497638128869038124506082956880448426261524733275521093477566421849134936014202472024600125629690903426235360356780817248587939756911284609010060687156927329496321413981116298392504514093379768896049697560475240887866765045884356249775891064190431436570827123388038801414013274666867432944085999838452709199063561463786334483612953109675470299</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="comment">#7903942109284616971177039757063852086984176476936099228234294937286044560458869922921692962367056335407203285911162833729143727236259599183118544731181209893499971239166798975272362502847869401536913310597050934868114362409772188138668288760287305966467890063175096408668396691058313701210130473560756912616590509776003076415730640467731466851294845080825312579944440742910769345079740436037310725065646739277834041891837233390010487460412084089630786396822488869754420904734966722826157548254882580507819654527378643632759059506306290252851428488883937359516531613654502801727220504711666666550673928496325962262842</span></span><br></pre></td></tr></table></figure>

<h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">BITS = <span class="number">233</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">broken</span>(<span class="params">x, bits</span>):</span><br><span class="line">    <span class="keyword">return</span> x&gt;&gt;bits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    p,q = getPrime(<span class="number">512</span>),getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    <span class="keyword">return</span> n, broken(p+q, BITS)</span><br><span class="line"></span><br><span class="line">n, hint = gen()</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">107847645025513535850791225440130707186374273414737521825714442885442542984529827092766916748308266623066053421754530398675086374798530909982183476265477598220972320436343536618913608933549054793948336438240303192183575843300257235195070331758555882832698815894168120103459360566404203412796086643598204242029</span></span><br><span class="line"><span class="string">1505246122706281178983443268987790509406564031452059494152554645294649335244676839890</span></span><br><span class="line"><span class="string">16589212605025468264862689939961340646400626438824064459026078002373801735937861932598660491280834517490394340315480853421268981930217857435669572426110105938015092688880859031418213297139875807487434491329423279700179082306961439610731922669459168752958192842026918421354512654494583087220572962719510130677</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>爆破。好久好久</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">N = <span class="number">107847645025513535850791225440130707186374273414737521825714442885442542984529827092766916748308266623066053421754530398675086374798530909982183476265477598220972320436343536618913608933549054793948336438240303192183575843300257235195070331758555882832698815894168120103459360566404203412796086643598204242029</span></span><br><span class="line">gift = <span class="number">1505246122706281178983443268987790509406564031452059494152554645294649335244676839890</span></span><br><span class="line">gift = gift&lt;&lt;<span class="number">233</span></span><br><span class="line"> </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">ok = <span class="literal">False</span></span><br><span class="line">test=<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pq_add</span>(<span class="params">tp,tq,tgift,idx</span>):</span><br><span class="line">    <span class="keyword">global</span> ok </span><br><span class="line">    <span class="keyword">global</span> test</span><br><span class="line">    <span class="keyword">if</span> ok:</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span> tp*tq&gt;N:</span><br><span class="line">        <span class="comment">#print(&#x27;&gt;&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (tp+(<span class="number">2</span>&lt;&lt;idx))*(tq+(<span class="number">2</span>&lt;&lt;idx))&lt;N:</span><br><span class="line">        <span class="comment">#print(&#x27;&lt;&#x27;, hex((tp+(1&lt;&lt;(idx+2))))[:20], hex(tq+(2&lt;&lt;idx))[:20], hex(N)[:20])</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> idx&lt;=<span class="number">233</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            test += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(test)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">                tpp = tp+(i&lt;&lt;<span class="number">223</span>)</span><br><span class="line">                f = tpp + x </span><br><span class="line">                test += <span class="number">1</span></span><br><span class="line">                rr = f.monic().small_roots(X=<span class="number">2</span>^<span class="number">223</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">                <span class="keyword">if</span> rr != []:</span><br><span class="line">                    <span class="built_in">print</span>(rr)</span><br><span class="line">                    <span class="built_in">print</span>(tpp)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>,f(rr[<span class="number">0</span>]))</span><br><span class="line">                    ok = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    idx -=<span class="number">1</span></span><br><span class="line">    b = tgift &gt;&gt;idx </span><br><span class="line">    one = <span class="number">1</span>&lt;&lt;idx</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#print(hex(tp)[:20],hex(tq)[:20],hex(tgift)[:20],idx,b)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">0</span> <span class="keyword">or</span> b==<span class="number">1</span>:</span><br><span class="line">        pq_add(tp,tq,tgift,idx)    </span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">1</span> <span class="keyword">or</span> b==<span class="number">2</span>:</span><br><span class="line">        pq_add(tp+one,tq,tgift-one,idx)</span><br><span class="line">        pq_add(tp,tq+one,tgift-one,idx)</span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">2</span> <span class="keyword">or</span> b==<span class="number">3</span>:</span><br><span class="line">        pq_add(tp+one,tq+one,tgift-(one&lt;&lt;<span class="number">1</span>),idx)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">tp = <span class="number">1</span>&lt;&lt;<span class="number">511</span></span><br><span class="line">tq = <span class="number">1</span>&lt;&lt;<span class="number">511</span></span><br><span class="line">tgift = gift -tp -tq </span><br><span class="line">pq_add(tp,tq,tgift,<span class="number">511</span>)</span><br><span class="line"><span class="built_in">print</span>(test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;111111111111&quot;</span>)</span><br><span class="line"><span class="comment"># p = 10671810890705142935923698352497956126372923054885272713948800012376136275817384032407712447142702386637160839942871245602734437654810217233791561733480407</span></span><br></pre></td></tr></table></figure>

<p>求出p后，正常求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">p = <span class="number">10671810890705142935923698352497956126372923054885272713948800012376136275817384032407712447142702386637160839942871245602734437654810217233791561733480407</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;ccc2e285-7bb1-484e-ad62-58cc474ef9d4&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_secretkeys</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        m = <span class="number">2</span> ** <span class="number">3</span></span><br><span class="line">        a = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        b = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">if</span> a &gt; b :</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> b &gt; <span class="number">2</span> * a:<span class="number">7</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        ra_ = randint(<span class="number">1000</span>,<span class="number">10000</span>)</span><br><span class="line">        p_ = <span class="built_in">pow</span>(a,m) + ra_</span><br><span class="line">        p = next_prime(p_)</span><br><span class="line">        ra = p - p_ + ra_</span><br><span class="line">        rb_ = randint(<span class="number">1000</span>, <span class="number">10000</span>)</span><br><span class="line">        q_ = <span class="built_in">pow</span>(b, m) + rb_</span><br><span class="line">        q = next_prime(q_)</span><br><span class="line">        rb = q - q_ + rb_</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ra &gt; <span class="number">100000</span> <span class="keyword">or</span> rb &gt; <span class="number">100000</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> b &gt; iroot(<span class="number">2</span> * <span class="built_in">pow</span>(a, m) + ra, m)[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> ra &gt; <span class="number">2</span> * iroot(a,m//<span class="number">2</span>)[<span class="number">0</span>] <span class="keyword">or</span> rb &gt; <span class="number">2</span> * iroot(b,m//<span class="number">2</span>)[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, ra, <span class="built_in">int</span>(p).bit_length(), q, rb, <span class="built_in">int</span>(q).bit_length()</span><br><span class="line"></span><br><span class="line">p, ra, len_p, q, rb, len_q = get_secretkeys()</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">ct = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ra = <span class="subst">&#123;ra&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;rb = <span class="subst">&#123;rb&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len_p = <span class="subst">&#123;len_p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len_q = <span class="subst">&#123;len_q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ct = <span class="subst">&#123;ct&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ra = 8607</span></span><br><span class="line"><span class="string">rb = 7150</span></span><br><span class="line"><span class="string">len_p = 1024</span></span><br><span class="line"><span class="string">len_q = 1024</span></span><br><span class="line"><span class="string">n = 28098722633030488893312283528887829649553659514053781575839443778746567710358683558509768930786261053897116586758341172713231425712608663734433267335002333760261583976848753337338129716792124202066388265994360580739266657504481707827816610267011366001142300093926601793983384666604377328323493638248481764153911921310476848622133065363121266256704484624454408157373499690818152144645904269865423396689289703578108901228755055729490144039004436875090060394642072739901593627031008002995026214521011417826487454434739123729500727953687489123493596702814564384266479646307886530097993679086392267067430262508230063492593</span></span><br><span class="line"><span class="string">ct = 1361368491194202361715607865372797868849909740139730895054740999951755977992724940480130958163781061991384502597774968578284702191375825258332749459177999721414531960173967638050842294432428891589365478524879091438660354502169037756949918455465931069407443747905678846811248473459896942787043705093661155283970943862884656259675846526304020149516360300122739147864690004414833366319773397061007864065322841302908571648122903295064833926287970664637537668175501504866705196230324464962122113398544393881450146243000410853975781504185685414280739943390199620950135398253008721600717727922668728798959184802994979420495</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$\because q_ &#x3D; b^8 +rb_ $</p>
<p>$q - q_ &#x3D;q - b^8 - rb_$</p>
<p>$q-q_ + rb_ &#x3D; q-b^8$</p>
<p>$\therefore rb &#x3D; q - b^8$</p>
<p>同理</p>
<p>$ra &#x3D; p - a^8$</p>
<p>$\therefore p &#x3D; a^8 + ra$，$q &#x3D; b^8 + rb$</p>
<p>$\therefore n &#x3D; pq &#x3D; (a^8+ra)(b^8+rb) &#x3D; (ab)^8 + ra\times b^8+rb\times a^8 + ra\times rb$</p>
<p>因为$a^8 + ra \approx a^8$，$\therefore n \approx a^8b^8$</p>
<p>n开8次方得到$ab$，再结合 $n&#x3D;(ab)^8 + ra\times b^8+rb\times a^8 + ra\times rb$解方程组</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ra = <span class="number">8607</span></span><br><span class="line">rb = <span class="number">7150</span></span><br><span class="line">n = </span><br><span class="line">ct = </span><br><span class="line"></span><br><span class="line"><span class="comment"># ab = int(gmpy2.iroot(n,8)[0])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># var(&quot;a,b&quot;)</span></span><br><span class="line"><span class="comment"># f1 = a*b - ab</span></span><br><span class="line"><span class="comment"># f2 = ab^8 + ra*b^8 + rb * a^8 + ra*rb - n</span></span><br><span class="line"><span class="comment"># ans = solve([f1,f2],[a,b])</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">334500267976593357847948592364017458136</span></span><br><span class="line">b = <span class="number">340164785123729724868130765428093274671</span></span><br><span class="line"><span class="comment"># print(isPrime(b))</span></span><br><span class="line"><span class="comment"># print(int(b).bit_length())</span></span><br><span class="line">p = a^<span class="number">8</span> + ra</span><br><span class="line">q = b^<span class="number">8</span> + rb</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ct,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>注意一下a和b的大小即可</p>
<h1 id="3"><a href="#3" class="headerlink" title="3"></a>3</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt;= <span class="number">35</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">t = getPrime(<span class="number">32</span>)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">hint = ((t+q)**<span class="number">4</span>+(t+q)**<span class="number">3</span>+(t+q)**<span class="number">2</span>+(t+q)+<span class="number">2023</span>) % n</span><br><span class="line"></span><br><span class="line">r = <span class="number">11779674470989201650533406519886591289516202072957618550910646323186300227953911</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(t,m,r)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6580860405834148836110773014414875358234621644983930335529135801623195480368832</span></span><br><span class="line"><span class="comment"># 139415227833650606627481949032630333904915784502498383402775795770352459104117035911044614539656661779065034631025979910419387363425628162982061251276669112098757186870838748231794731153245273066810769109396532311364451556967782895742561287251234088360088678874714586399626016737310602036235187097500522638791</span></span><br><span class="line"><span class="comment"># 43691909620514553907337084747877613125770180914725560231672822190047048268654323014909857087117101555550872581680976037673609645072816688179430921113411189775681186282652913102207473404267361338845128228750191128828347979058211793191911795538917687509092140331114867217314732225741963090158157118956958361667</span></span><br></pre></td></tr></table></figure>

<p>$hint \equiv (t+q)^4+(t+q)^3+(t+q)^2+(t+q) + 2023 \mod n$</p>
<p>展开后发现$hint \equiv t^4 + t^3 + t^2 + t + 2023 + 很多q\mod n$</p>
<p>在Coppersmith下模n，会把q全部模完，所以可以直接求出$t$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hint = <span class="number">43691909620514553907337084747877613125770180914725560231672822190047048268654323014909857087117101555550872581680976037673609645072816688179430921113411189775681186282652913102207473404267361338845128228750191128828347979058211793191911795538917687509092140331114867217314732225741963090158157118956958361667</span></span><br><span class="line">n = <span class="number">139415227833650606627481949032630333904915784502498383402775795770352459104117035911044614539656661779065034631025979910419387363425628162982061251276669112098757186870838748231794731153245273066810769109396532311364451556967782895742561287251234088360088678874714586399626016737310602036235187097500522638791</span></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x^<span class="number">4</span> + x^<span class="number">3</span> + x^<span class="number">2</span> + x + <span class="number">2023</span> - hint</span><br><span class="line">res = f.small_roots(X=<span class="number">2</span>^<span class="number">32</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># res = [4000655279]</span></span><br></pre></td></tr></table></figure>

<p>$\therefore t &#x3D; 4000655279$</p>
<p>$\because c\equiv t^m \mod r$</p>
<p>注意到$ len(flag) \le 35 \therefore m \le 2^{280}$，但是<code>r.bit_length()</code>只有263</p>
<p>通过$c \equiv t^m \mod r$求出的$m’$是缺失后的m。</p>
<p>$c \equiv t ^{m} \mod r \longrightarrow t ^{m’} \times t^{\phi(r)} \mod r$</p>
<p>所以$m &#x3D; m’ + k\times \phi(r)$</p>
<p><strong>发现m一直出不来，怀疑数据有问题，自己生成了一段数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">4137560691961718739425091763048204826246959556735333974068696193052111117736453</span></span><br><span class="line">n = <span class="number">86601146891444074456956817892770288311475988322265302838984237580231651859629274475035744328825382202048914060822444105427683352708309881334364203096281689276996522731222677104664324360842817909734370275307581489510464608534413529746798578300893242561668699805039088505923390582961646156539509555519633683481</span></span><br><span class="line">hint = <span class="number">51301250958957185881448512504234182680376619692496967874471014061919485062523459109807826901303643096803496187324129647601172411558722614620741746891647406746358348531784312173885812701563244883422722916122675824886592476043582415303390561692687548141851593610708466592094080775902506766915088060053520879968</span></span><br><span class="line">r = <span class="number">11779674470989201650533406519886591289516202072957618550910646323186300227953911</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">4137560691961718739425091763048204826246959556735333974068696193052111117736453</span></span><br><span class="line">n = <span class="number">86601146891444074456956817892770288311475988322265302838984237580231651859629274475035744328825382202048914060822444105427683352708309881334364203096281689276996522731222677104664324360842817909734370275307581489510464608534413529746798578300893242561668699805039088505923390582961646156539509555519633683481</span></span><br><span class="line">hint = <span class="number">51301250958957185881448512504234182680376619692496967874471014061919485062523459109807826901303643096803496187324129647601172411558722614620741746891647406746358348531784312173885812701563244883422722916122675824886592476043582415303390561692687548141851593610708466592094080775902506766915088060053520879968</span></span><br><span class="line">r = <span class="number">11779674470989201650533406519886591289516202072957618550910646323186300227953911</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = x^<span class="number">4</span> + x^<span class="number">3</span> + x^<span class="number">2</span> + x + <span class="number">2023</span> - hint</span><br><span class="line">res = f.small_roots(X=<span class="number">2</span>^<span class="number">32</span>,beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="comment"># print(res)</span></span><br><span class="line">t = res[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(t)</span><br><span class="line"></span><br><span class="line">m = discrete_log(mod(c,r),mod(t,r))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>^<span class="number">17</span>):</span><br><span class="line">    m += r-<span class="number">1</span></span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h1 id="2023江苏省首届数据安全竞赛"><a href="#2023江苏省首届数据安全竞赛" class="headerlink" title="2023江苏省首届数据安全竞赛"></a>2023江苏省首届数据安全竞赛</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">day</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;# == Day Time == #&quot;</span>)</span><br><span class="line">    A = [getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">30</span>, <span class="number">1</span> &lt;&lt; <span class="number">40</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01234&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> notebook <span class="keyword">import</span> pubkeys</span><br><span class="line">    hint = <span class="built_in">str</span>(A)[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;, &#x27;</span>, <span class="string">&#x27;||&#x27;</span>).encode()</span><br><span class="line">    hint = bytes_to_long(pad(hint))</span><br><span class="line">    package = []</span><br><span class="line">    <span class="keyword">for</span> pubkey <span class="keyword">in</span> pubkeys:</span><br><span class="line">        e, n = pubkey</span><br><span class="line">        package.append(<span class="built_in">pow</span>(hint, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;package = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">night</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;# == Night Time == #&quot;</span>)</span><br><span class="line">    <span class="keyword">from</span> secrets <span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line">    p, q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">    e, n = <span class="number">0x10001</span>, p * q</span><br><span class="line">    message = bytes_to_long(pad(secret))</span><br><span class="line">    ciphertext = <span class="built_in">pow</span>(message, e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    core = getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">70</span>, <span class="number">1</span> &lt;&lt; <span class="number">80</span>)</span><br><span class="line">    box = (A[<span class="number">4</span>] * p ** <span class="number">4</span> + A[<span class="number">3</span>] * p ** <span class="number">3</span> + A[<span class="number">2</span>] * p ** <span class="number">2</span> + A[<span class="number">1</span>] * p ** <span class="number">1</span> + core) % n</span><br><span class="line">    shell = (A[<span class="number">4</span>] * box ** <span class="number">4</span> + A[<span class="number">3</span>] * box ** <span class="number">3</span> + A[<span class="number">2</span>] * box ** <span class="number">2</span> + A[<span class="number">1</span>] * box ** <span class="number">1</span> + A[<span class="number">0</span>]) % n</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">A = day()</span><br><span class="line">night(A)</span><br></pre></td></tr></table></figure>

<p>附件1：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># == Day Time == #</span></span><br><span class="line">package = [<span class="number">11348275592172789430802632398715397831929456592129727148350341695822097922745546634103895397114240780119492097879709874341733998189314701220819602086989170395665694216144611451695210776788208725517321710496401109614989729783280209806513298851774400705822274570042128297336679615535569295725037051009221966882907606741910671983811835353310553679554656322510247012465612842055583530354825164440556725066351429241835394579392892121937744444324723509039593320520073762479405487678614235658010109343868772211070874500834820005557924944766175445227592086997786601600141172729543326022039897279215360210475222205314199752358</span>, <span class="number">11817047514083750028443306573161291960303002458276716688201587284992675854178250185695613342603396451495053496021018943618684096193774851513377343785523373066637422156529843356640438514917147007662989366432951340073247573347091422478343675687872524102452812391963856179412214914106817415620613886827405526709334122157218264253412138947978859771457788135381194396144386611627935519990330309154612803264373276472523863776757124489507206744895878709136339189551422814752920383697719212261820943113370067423118794871570596583232694067119303936516491830190746798281923693136901268220982292626728815051587839682733501582997</span>, <span class="number">3131427695639074007646625687827523632044624200167725001731246731463369200890045250738898155425873822581405723445926216099453276470655307513244478613248253397941362848890729091875615893643288181126353294271063912991208029628896380928878098320509891044728414542705582996774991148116051162157848421643082210867849206627757941596203046799655123006406284498009424107637970927771132706399889289085811447333980744767367889464364519571965014435281718495338752896521777070285880327861778156398424643033288480056322928449210425585380975486759287881877636187364299666207762828705236236071045450767253946524067440138527952996304</span>, <span class="number">3345060634868343217881273515503289974894457362066685037297545772310131198850220025672843957153107490874807599311288876818421468275658855183857485067696603798636556327070411528170381402923911922437076616994460720931230980991440337397730061039967493443152767007916713160518618697678791358770766857737217910848181657393760417031865203943283074078341988117567851667858026108335625589177179258992930648353570238327435125409871028669479754623782967450462280802423233657422873275069133939005033872391235288329468886849808534906305377008408076775145268714146937205940659708210819711903273898505450411746796296074348301840443</span>, <span class="number">689229715602713064347690095007369004049337459458047359544160409565437783924368962797071453687950582019132146435134269723546824657132278724115055713024437048832952574546581164678912794341156478859615959289720931333010836265396177238403118182219901102453660596556053537987705012972371809213618745302576874122654094213771963420178465724399112964705426548207838941065298709968044913923423922781681311806180694571535910059881703228238538782302346351472443730399075812346657046097375387076507982673848430573754749554553794234945423901111974280859817600907619255722739374513108613738135872066592727564964404002462119084702</span>]</span><br><span class="line"><span class="comment"># == Night Time == #</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">19628814650078845889624476490795800811418703155298421183649751922179289373872110164946485468758965499898659860381452920316689731813466611171330082419646032975535828938381971760997472673267667258345915647828047467420412766203712358122436358120743184983881044132767579608354023899206025747277296489890315455139161247982158229333619416375842911027431739437723838483131248360727904613423834627213036877579164949084954352768932164210879329537266501942223360207803513487189832308290555832923018589686990981697562750385892888271329399531648035355662276186237232094775404084845357101354614900716614704579902047366473325519851</span></span><br><span class="line">ciphertext = <span class="number">18231770979476945075115454933498285687471248736331968136534439886998853983159878091479109027681230666670001308495054141682281492473521819495259722942633525843224223138121210743435008344491182811096997837681349401919300801071760448609909297020846949507707329708251861866061443743942558286917774317607571379516986051564317860557772153943821431899226380831989795907857566336085097807330399388077758869632230636727348278392968946952484442630549599469645903047917899063746000458656292320802815605327181346234519795519772619774175495201258591571744214020509439053957080210165266709953654561600989486386199867341092142358249</span></span><br><span class="line">shell = <span class="number">7450311459083436799013470526820816670296314417175130490433500468646960366746415074085735399822973890608046359739147553438015771999419943640758794686461655503899174274852006852675273759918109697488252918038788275865249305840107266839320745067341253227218580768443831238305064450748932813304412926315551102620477056031794884272260575749720364002093756539399717557808977458033683588388899534871439955606629530406662400672087729944642496842353084711242911328651341343429685261174338868058208644730980459845089948243884209259777439653298562832822410224626781415627048867272937969823329086437858777995321438386601575065665</span></span><br></pre></td></tr></table></figure>

<p>附件2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, <span class="number">16966923273393034574368601955241184391111444785998466710722972275633988040568029224272430397635357872449163107278928804572765398970752644900568552514020294813546024733050135082024292481598322682990045855877556853392263676715734911232910368712575738786450510156105046776600566496799942574786503183241332740784997363514285857446938222302824964396227964711868412832852194845619628366554904150230665043909281603861298992421759553638135733037244888585600075655017766713763334284974682754159767494437867386464788270392548503256135412609157993954349845981674000072937143857040970855382655304911806719316346552101453584266121</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">13636547774903694433910615288816366243965221147245493790443257513469643051508482519945160993497983268746607032666514024577996510214003878851754244812785830861056511467944880656887067183093022088006603023892079757597903932697728395729605528467171403935076011715369931494813762896302405865063013876978950952553183445737415893862580946529557997177862386840671940665891984463553509323759394863514802662045074793125218445076375294720405008157895103559623204523371691063630903658360461001806917018298844432738514873530829540084732665560723768831816785580126848217585494349751859982707295270194451027637908966488433591336079</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">13422209706853784863425138450444393536114566510977689013118842078064352816867606066548879016746689784867031499069217146653949323203507755857385123653072875573743110808787259755688613540214185294636104765964080842615717180413731820679997453377899736419007193552970900617704671115646941207925636014254352661937769415565529244046272257822921740649781322893596978112103176487718960676212380426151079825140922318909470514158027009961239217428522970405297292867815726509360369236095377704967444339421311749405316999191339677904499413281713365474466679134722393111495793887387332928227905039036942450742103526490509249576159</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">21746430662648628292439055708644436184530740821098010749514133474681581832957631729292681550968108122182841907644832479495695011213810971334153360397292385819609198743433956578966857749821825621262178208409227379634952172419748956184624505995106932133301461499473823229623656490844764958301835433668618062743327682117611417235819168865744757242990985069648255779083246816509593018812991050741917153961245784296647661659339041115118272068392627299499703962645966495325055378652176922700072734325787550811454984878236039742147547963385471101805136506286953288566035101103034341742923072819774753918471775281464739904101</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">16012920802348742413202394765537959589119609441428117329692661212660781149297315973073063954731746455220386673231725950116051390914388279415796378305381377822621647264088603927560119754278978906758212463937071494263575443156089509654950881813861479449401068535285885349738367249035960528895049222211387021733152221289202030407416118814341241382479971018611239102343929419190892133819275458474489856666791981711793637127167775551296403296397810821548297674986394286293380472089135564385129140069501205054853729781710604489652713172579677128036322403868618295553335257593973027194532512596143733434234439677513237984107</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><code>day</code>主要是把填充后的<code>hint</code>进行5次同<code>e，n</code>的加密。</p>
<p>第一反应应该是用中国剩余定理进行求解，<strong>但是填充后的<code>hint</code>约2048bit</strong>，5组n是不够求解的。</p>
<p>分析<code>pad</code>，发现<code>pad</code>函数只是在<code>msg</code>后面填充上许多<code>00</code></p>
<p>于是根据$c \equiv m^e \mod n$可以推出$c \equiv (m’ \times pad)^e \mod n$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line">A = [getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">30</span>, <span class="number">1</span> &lt;&lt; <span class="number">40</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01234&#x27;</span>]</span><br><span class="line"></span><br><span class="line">hint = <span class="built_in">str</span>(A)[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;, &#x27;</span>, <span class="string">&#x27;||&#x27;</span>).encode()</span><br><span class="line">hint1 = bytes_to_long(hint) </span><br><span class="line">hint2 = bytes_to_long(pad(hint))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(hint2 // hint1))</span><br></pre></td></tr></table></figure>

<p>自己测试几组数据发现填充的内容大概是</p>
<p><code>0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></p>
<p>实际可以把填充内容减少一些0</p>
<p>于是我们有$c \equiv m’^e \times  pad ^e \mod n \longrightarrow m’^e \equiv c \times (pad^e)^{-1} \mod n$</p>
<p><code>m&#39;</code>大约560bit</p>
<p>到此，我们有了5组新的<code>c</code>，可以用中国剩余定理求解了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">package = [, , , , ]</span><br><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ]</span><br><span class="line">]</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    N.append(pubkeys[i][<span class="number">1</span>])</span><br><span class="line">c = []</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">pad = <span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    cc = <span class="built_in">int</span>(package[i] * <span class="built_in">pow</span>(pad,-<span class="number">13</span>,N[i]))</span><br><span class="line">    c.append(cc)</span><br><span class="line">    </span><br><span class="line">C = CRT_list([c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>],c[<span class="number">4</span>]],[N[<span class="number">0</span>],N[<span class="number">1</span>],N[<span class="number">2</span>],N[<span class="number">3</span>],N[<span class="number">4</span>]])</span><br><span class="line">m = gmpy2.iroot(C,e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>

<p>得到<code>hint = 646919678902||598613162045||90472013741||917100488664||838250498519\x00</code></p>
<p>我们便得到了A</p>
<p>想先通过方程<code>shell = (A[4] * box ** 4 + A[3] * box ** 3 + A[2] * box ** 2 + A[1] * box ** 1 + A[0]) % n</code>，来求解<code>box</code></p>
<p>但是没成功</p>
<p><strong>请教了一下Van1sh师傅，他说一般roots解二次方程，而且一般得模素数</strong></p>
<p>换个思路，通过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">core = getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">70</span>, <span class="number">1</span> &lt;&lt; <span class="number">80</span>)</span><br><span class="line">box = (A[<span class="number">4</span>] * p ** <span class="number">4</span> + A[<span class="number">3</span>] * p ** <span class="number">3</span> + A[<span class="number">2</span>] * p ** <span class="number">2</span> + A[<span class="number">1</span>] * p ** <span class="number">1</span> + core) % n</span><br><span class="line">shell = (A[<span class="number">4</span>] * box ** <span class="number">4</span> + A[<span class="number">3</span>] * box ** <span class="number">3</span> + A[<span class="number">2</span>] * box ** <span class="number">2</span> + A[<span class="number">1</span>] * box ** <span class="number">1</span> + A[<span class="number">0</span>]) % n</span><br></pre></td></tr></table></figure>

<p>我们发现$shell \equiv A[4]\times core^4 + A[3]\times core^3 + A[2]\times core^2 + A[1]\times core + A[0] \mod p$</p>
<p>$core$给出范围，可以通过copper求解</p>
<p>求解出$core$后，$kp &#x3D;shell - A[4]\times core^4 + A[3]\times core^3 + A[2]\times core^2 + A[1]\times core + A[0]$ </p>
<p>求$kp$和$n$公因数便可得到p</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">package = [, , , , ]</span><br><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ]</span><br><span class="line">]</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    N.append(pubkeys[i][<span class="number">1</span>])</span><br><span class="line">c = []</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">pad = <span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    cc = <span class="built_in">int</span>(package[i] * <span class="built_in">pow</span>(pad,-<span class="number">13</span>,N[i]))</span><br><span class="line">    c.append(cc)</span><br><span class="line">    </span><br><span class="line">C = CRT_list([c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>],c[<span class="number">4</span>]],[N[<span class="number">0</span>],N[<span class="number">1</span>],N[<span class="number">2</span>],N[<span class="number">3</span>],N[<span class="number">4</span>]])</span><br><span class="line">hint = gmpy2.iroot(C,e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(hint[<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line">A = [,,,,]</span><br><span class="line">shell = </span><br><span class="line">n = </span><br><span class="line">ciphertext = </span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (A[<span class="number">4</span>] * x^<span class="number">4</span> + A[<span class="number">3</span>] * x^<span class="number">3</span> + A[<span class="number">2</span>] * x^<span class="number">2</span> + A[<span class="number">1</span>] * x + A[<span class="number">0</span>]) - shell</span><br><span class="line">f = f.monic()</span><br><span class="line">ans = f.small_roots(X=<span class="number">2</span>^<span class="number">80</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.02</span>)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">core = </span><br><span class="line">kp = shell - (A[<span class="number">4</span>] * core^<span class="number">4</span> + A[<span class="number">3</span>] * core^<span class="number">3</span> + A[<span class="number">2</span>] * core^<span class="number">2</span> + A[<span class="number">1</span>] * core + A[<span class="number">0</span>])</span><br><span class="line">p = gmpy2.gcd(kp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ciphertext,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#b&#x27;Your flag is: flag&#123;8d24d7d491106a7974d5afe9342b2834&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="祥云杯线下（高校组）"><a href="#祥云杯线下（高校组）" class="headerlink" title="祥云杯线下（高校组）"></a>祥云杯线下（高校组）</h1><h2 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">total_bit = <span class="number">512</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_para</span>(<span class="params">bit_size</span>):</span><br><span class="line">    P = getStrongPrime(bit_size)</span><br><span class="line">    Q = getStrongPrime(bit_size)</span><br><span class="line">    N = P * Q</span><br><span class="line">    magic = (N + <span class="number">1</span>) * (N + P + Q + <span class="number">1</span>) + (P - Q) ** <span class="number">2</span> + N</span><br><span class="line">    d = <span class="built_in">int</span>(<span class="number">0.394</span> * bit_size)</span><br><span class="line">    e = inverse(d, magic)</span><br><span class="line">    k = d * e // magic</span><br><span class="line">    <span class="keyword">return</span> (N, e), (P, Q, k)</span><br><span class="line">pubkey, sec_key = make_para(<span class="number">2</span> * total_bit)</span><br><span class="line">flag = bytes_to_long(flag) * sec_key[<span class="number">2</span>]</span><br><span class="line">p = getStrongPrime(total_bit)</span><br><span class="line">q = getStrongPrime(total_bit)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line">t = ((p - getRandomNBitInteger(<span class="number">16</span>)) * sec_key[<span class="number">0</span>] + q) % sec_key[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(pubkey) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>((t, c)))</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N,e=(21136120517038375343657055317361461947217610380415290931285704769845405139443342030139838613845989765254932385503454684656325859309861269837188207923942223163348944160792729101485975484543693998035828762630825174735962679103457025646672449491007685400869138263581883506767852264244013623583813540066115060793144049256890248337903932112449333735324371400873419104520104079223733159263094092843185909770131443506433825708789563521497940390674504488024226655482568491358458107989880756229607524452273305978138461190013290440068226454238375505010225133919526068226837545142734502100757510899741312502285931571783851666429, 291542085122413541028076006933740091355832744332602513957292369860771664833892358795585946753279254101863581542678927529330607906769804928526978686071141386341893467977451552634615917127445748737712286687041822255325772392569586666055711202824870471562051621883329559663555059967665101455578668904247279540014709971958403913939101728330638301270881265277488332145439522278871554725936095617940701105161078332467466405454007283937177070102098256744642045839067405705972784471374421818844770106228499198315920181837950503279178647052157269318876892192700670366858062171759498850112906238502375693099462427930964555274451795362167393410749436026095037695100430810204847979914959732383773952788768239221142673268839750770222737928397507645337714199166919835667638401309062163501094032890215821366318775462220119081175885338966308921205861717088926659072208866126879068213582499260316364548817213314952246293713853884872460934174624844462586276340207505217646013915381902979372875919823493439285174120160656952728493383464761519634974414670811896809158801804891938928244053980210687334268664219571818927285279999791212932795196689285015367417706597781418431735001428656415752334850685705212368666855124013583549768407830008606258798409140)</span></span><br><span class="line"><span class="string">t,c=(18872151984199200051633005759140295224788252451326410141022483203855894790958837408470348915966212063467995292461061069273539234939320647533902914083943444743748789975745514239518406829738286900177972974033143896932863898553599888597165054837513698667686277110587659188172271629973371164557353473146831275972, 47672712219012743425382676880904671136942826695249149129159924785186563239747047304204962529935078111450524236186612259355850306867579998685662967391936502046679744616903469002187225791339629835786750259999982506494377133775859573660632942293353420327987860136624649402598383416748766985203781387716072244402)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>




    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/" title="挨打日记">https://dexterjie.github.io/2023/09/07/挨打日记/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/09/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/" rel="prev" title="2023羊城杯">
                  <i class="fa fa-chevron-left"></i> 2023羊城杯
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/09/10/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTF2023/" rel="next" title="SICTF2023">
                  SICTF2023 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">105k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">6:22</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
