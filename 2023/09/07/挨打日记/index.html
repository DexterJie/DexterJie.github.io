<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录一些未知来源的题目">
<meta property="og:type" content="article">
<meta property="og:title" content="挨打日记">
<meta property="og:url" content="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录一些未知来源的题目">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-07T11:43:13.000Z">
<meta property="article:modified_time" content="2023-09-30T08:53:06.671Z">
<meta property="article:author" content="DexterJie">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/","path":"2023/09/07/挨打日记/","title":"挨打日记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>挨打日记 | DexterJie'Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1"><span class="nav-number">1.</span> <span class="nav-text">1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2"><span class="nav-number">2.</span> <span class="nav-text">2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2023%E6%B1%9F%E8%8B%8F%E7%9C%81%E9%A6%96%E5%B1%8A%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B"><span class="nav-number">3.</span> <span class="nav-text">2023江苏省首届数据安全竞赛</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A5%A5%E4%BA%91%E6%9D%AF%E7%BA%BF%E4%B8%8B%EF%BC%88%E9%AB%98%E6%A0%A1%E7%BB%84%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">祥云杯线下（高校组）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ezmath%E2%80%94%E2%80%94%E6%9C%AA%E8%A7%A3%E5%86%B3"><span class="nav-number">4.1.</span> <span class="nav-text">ezmath——未解决</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%89%E5%BE%BD%E7%9C%81%E7%9C%81%E8%B5%9B%E2%80%94%E2%80%94rwx"><span class="nav-number">5.</span> <span class="nav-text">安徽省省赛——rwx</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="挨打日记 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          挨打日记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-09-07 19:43:13" itemprop="dateCreated datePublished" datetime="2023-09-07T19:43:13+08:00">2023-09-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-09-30 16:53:06" itemprop="dateModified" datetime="2023-09-30T16:53:06+08:00">2023-09-30</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录一些未知来源的题目</p>
<span id="more"></span>





<h1 id="1"><a href="#1" class="headerlink" title="1"></a>1</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">BITS = <span class="number">233</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">broken</span>(<span class="params">x, bits</span>):</span><br><span class="line">    <span class="keyword">return</span> x&gt;&gt;bits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    p,q = getPrime(<span class="number">512</span>),getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    <span class="keyword">return</span> n, broken(p+q, BITS)</span><br><span class="line"></span><br><span class="line">n, hint = gen()</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(hint)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">107847645025513535850791225440130707186374273414737521825714442885442542984529827092766916748308266623066053421754530398675086374798530909982183476265477598220972320436343536618913608933549054793948336438240303192183575843300257235195070331758555882832698815894168120103459360566404203412796086643598204242029</span></span><br><span class="line"><span class="string">1505246122706281178983443268987790509406564031452059494152554645294649335244676839890</span></span><br><span class="line"><span class="string">16589212605025468264862689939961340646400626438824064459026078002373801735937861932598660491280834517490394340315480853421268981930217857435669572426110105938015092688880859031418213297139875807487434491329423279700179082306961439610731922669459168752958192842026918421354512654494583087220572962719510130677</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>爆破。好久好久</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">N = <span class="number">107847645025513535850791225440130707186374273414737521825714442885442542984529827092766916748308266623066053421754530398675086374798530909982183476265477598220972320436343536618913608933549054793948336438240303192183575843300257235195070331758555882832698815894168120103459360566404203412796086643598204242029</span></span><br><span class="line">gift = <span class="number">1505246122706281178983443268987790509406564031452059494152554645294649335244676839890</span></span><br><span class="line">gift = gift&lt;&lt;<span class="number">233</span></span><br><span class="line"> </span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">ok = <span class="literal">False</span></span><br><span class="line">test=<span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pq_add</span>(<span class="params">tp,tq,tgift,idx</span>):</span><br><span class="line">    <span class="keyword">global</span> ok </span><br><span class="line">    <span class="keyword">global</span> test</span><br><span class="line">    <span class="keyword">if</span> ok:</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    <span class="keyword">if</span> tp*tq&gt;N:</span><br><span class="line">        <span class="comment">#print(&#x27;&gt;&#x27;)</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (tp+(<span class="number">2</span>&lt;&lt;idx))*(tq+(<span class="number">2</span>&lt;&lt;idx))&lt;N:</span><br><span class="line">        <span class="comment">#print(&#x27;&lt;&#x27;, hex((tp+(1&lt;&lt;(idx+2))))[:20], hex(tq+(2&lt;&lt;idx))[:20], hex(N)[:20])</span></span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span> idx&lt;=<span class="number">233</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            test += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(test)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1024</span>):</span><br><span class="line">                tpp = tp+(i&lt;&lt;<span class="number">223</span>)</span><br><span class="line">                f = tpp + x </span><br><span class="line">                test += <span class="number">1</span></span><br><span class="line">                rr = f.monic().small_roots(X=<span class="number">2</span>^<span class="number">223</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">                <span class="keyword">if</span> rr != []:</span><br><span class="line">                    <span class="built_in">print</span>(rr)</span><br><span class="line">                    <span class="built_in">print</span>(tpp)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>,f(rr[<span class="number">0</span>]))</span><br><span class="line">                    ok = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    idx -=<span class="number">1</span></span><br><span class="line">    b = tgift &gt;&gt;idx </span><br><span class="line">    one = <span class="number">1</span>&lt;&lt;idx</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#print(hex(tp)[:20],hex(tq)[:20],hex(tgift)[:20],idx,b)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">0</span> <span class="keyword">or</span> b==<span class="number">1</span>:</span><br><span class="line">        pq_add(tp,tq,tgift,idx)    </span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">1</span> <span class="keyword">or</span> b==<span class="number">2</span>:</span><br><span class="line">        pq_add(tp+one,tq,tgift-one,idx)</span><br><span class="line">        pq_add(tp,tq+one,tgift-one,idx)</span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">2</span> <span class="keyword">or</span> b==<span class="number">3</span>:</span><br><span class="line">        pq_add(tp+one,tq+one,tgift-(one&lt;&lt;<span class="number">1</span>),idx)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">tp = <span class="number">1</span>&lt;&lt;<span class="number">511</span></span><br><span class="line">tq = <span class="number">1</span>&lt;&lt;<span class="number">511</span></span><br><span class="line">tgift = gift -tp -tq </span><br><span class="line">pq_add(tp,tq,tgift,<span class="number">511</span>)</span><br><span class="line"><span class="built_in">print</span>(test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;OK&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;111111111111&quot;</span>)</span><br><span class="line"><span class="comment"># p = 10671810890705142935923698352497956126372923054885272713948800012376136275817384032407712447142702386637160839942871245602734437654810217233791561733480407</span></span><br></pre></td></tr></table></figure>

<p>求出p后，正常求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">p = <span class="number">10671810890705142935923698352497956126372923054885272713948800012376136275817384032407712447142702386637160839942871245602734437654810217233791561733480407</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#flag&#123;ccc2e285-7bb1-484e-ad62-58cc474ef9d4&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="2"><a href="#2" class="headerlink" title="2"></a>2</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;xxx&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_secretkeys</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        m = <span class="number">2</span> ** <span class="number">3</span></span><br><span class="line">        a = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        b = getRandomNBitInteger(<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">if</span> a &gt; b :</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> b &gt; <span class="number">2</span> * a:<span class="number">7</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        ra_ = randint(<span class="number">1000</span>,<span class="number">10000</span>)</span><br><span class="line">        p_ = <span class="built_in">pow</span>(a,m) + ra_</span><br><span class="line">        p = next_prime(p_)</span><br><span class="line">        ra = p - p_ + ra_</span><br><span class="line">        rb_ = randint(<span class="number">1000</span>, <span class="number">10000</span>)</span><br><span class="line">        q_ = <span class="built_in">pow</span>(b, m) + rb_</span><br><span class="line">        q = next_prime(q_)</span><br><span class="line">        rb = q - q_ + rb_</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ra &gt; <span class="number">100000</span> <span class="keyword">or</span> rb &gt; <span class="number">100000</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> b &gt; iroot(<span class="number">2</span> * <span class="built_in">pow</span>(a, m) + ra, m)[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> ra &gt; <span class="number">2</span> * iroot(a,m//<span class="number">2</span>)[<span class="number">0</span>] <span class="keyword">or</span> rb &gt; <span class="number">2</span> * iroot(b,m//<span class="number">2</span>)[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p, ra, <span class="built_in">int</span>(p).bit_length(), q, rb, <span class="built_in">int</span>(q).bit_length()</span><br><span class="line"></span><br><span class="line">p, ra, len_p, q, rb, len_q = get_secretkeys()</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">ct = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ra = <span class="subst">&#123;ra&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;rb = <span class="subst">&#123;rb&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len_p = <span class="subst">&#123;len_p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;len_q = <span class="subst">&#123;len_q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ct = <span class="subst">&#123;ct&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">ra = 8607</span></span><br><span class="line"><span class="string">rb = 7150</span></span><br><span class="line"><span class="string">len_p = 1024</span></span><br><span class="line"><span class="string">len_q = 1024</span></span><br><span class="line"><span class="string">n = 28098722633030488893312283528887829649553659514053781575839443778746567710358683558509768930786261053897116586758341172713231425712608663734433267335002333760261583976848753337338129716792124202066388265994360580739266657504481707827816610267011366001142300093926601793983384666604377328323493638248481764153911921310476848622133065363121266256704484624454408157373499690818152144645904269865423396689289703578108901228755055729490144039004436875090060394642072739901593627031008002995026214521011417826487454434739123729500727953687489123493596702814564384266479646307886530097993679086392267067430262508230063492593</span></span><br><span class="line"><span class="string">ct = 1361368491194202361715607865372797868849909740139730895054740999951755977992724940480130958163781061991384502597774968578284702191375825258332749459177999721414531960173967638050842294432428891589365478524879091438660354502169037756949918455465931069407443747905678846811248473459896942787043705093661155283970943862884656259675846526304020149516360300122739147864690004414833366319773397061007864065322841302908571648122903295064833926287970664637537668175501504866705196230324464962122113398544393881450146243000410853975781504185685414280739943390199620950135398253008721600717727922668728798959184802994979420495</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$\because q’ &#x3D; b^8 +rb’ $</p>
<p>$q - q’ &#x3D;q - b^8 - rb’$</p>
<p>$q-q_ + rb_ &#x3D; q-b^8$</p>
<p>$\therefore rb &#x3D; q - b^8$</p>
<p>同理</p>
<p>$ra &#x3D; p - a^8$</p>
<p>$\therefore p &#x3D; a^8 + ra$，$q &#x3D; b^8 + rb$</p>
<p>$\therefore n &#x3D; pq &#x3D; (a^8+ra)(b^8+rb) &#x3D; (ab)^8 + ra\times b^8+rb\times a^8 + ra\times rb$</p>
<p>因为$a^8 + ra \approx a^8$，$\therefore n \approx a^8b^8$</p>
<p>n开8次方得到$ab$，再结合 $n&#x3D;(ab)^8 + ra\times b^8+rb\times a^8 + ra\times rb$解方程组</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ra = <span class="number">8607</span></span><br><span class="line">rb = <span class="number">7150</span></span><br><span class="line">n = </span><br><span class="line">ct = </span><br><span class="line"></span><br><span class="line"><span class="comment"># ab = int(gmpy2.iroot(n,8)[0])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># var(&quot;a,b&quot;)</span></span><br><span class="line"><span class="comment"># f1 = a*b - ab</span></span><br><span class="line"><span class="comment"># f2 = ab^8 + ra*b^8 + rb * a^8 + ra*rb - n</span></span><br><span class="line"><span class="comment"># ans = solve([f1,f2],[a,b])</span></span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">334500267976593357847948592364017458136</span></span><br><span class="line">b = <span class="number">340164785123729724868130765428093274671</span></span><br><span class="line"><span class="comment"># print(isPrime(b))</span></span><br><span class="line"><span class="comment"># print(int(b).bit_length())</span></span><br><span class="line">p = a^<span class="number">8</span> + ra</span><br><span class="line">q = b^<span class="number">8</span> + rb</span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ct,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p>注意一下a和b的大小即可</p>
<h1 id="2023江苏省首届数据安全竞赛"><a href="#2023江苏省首届数据安全竞赛" class="headerlink" title="2023江苏省首届数据安全竞赛"></a>2023江苏省首届数据安全竞赛</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">day</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;# == Day Time == #&quot;</span>)</span><br><span class="line">    A = [getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">30</span>, <span class="number">1</span> &lt;&lt; <span class="number">40</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01234&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> notebook <span class="keyword">import</span> pubkeys</span><br><span class="line">    hint = <span class="built_in">str</span>(A)[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;, &#x27;</span>, <span class="string">&#x27;||&#x27;</span>).encode()</span><br><span class="line">    hint = bytes_to_long(pad(hint))</span><br><span class="line">    package = []</span><br><span class="line">    <span class="keyword">for</span> pubkey <span class="keyword">in</span> pubkeys:</span><br><span class="line">        e, n = pubkey</span><br><span class="line">        package.append(<span class="built_in">pow</span>(hint, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;package = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">night</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;# == Night Time == #&quot;</span>)</span><br><span class="line">    <span class="keyword">from</span> secrets <span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line">    p, q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">    e, n = <span class="number">0x10001</span>, p * q</span><br><span class="line">    message = bytes_to_long(pad(secret))</span><br><span class="line">    ciphertext = <span class="built_in">pow</span>(message, e, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    core = getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">70</span>, <span class="number">1</span> &lt;&lt; <span class="number">80</span>)</span><br><span class="line">    box = (A[<span class="number">4</span>] * p ** <span class="number">4</span> + A[<span class="number">3</span>] * p ** <span class="number">3</span> + A[<span class="number">2</span>] * p ** <span class="number">2</span> + A[<span class="number">1</span>] * p ** <span class="number">1</span> + core) % n</span><br><span class="line">    shell = (A[<span class="number">4</span>] * box ** <span class="number">4</span> + A[<span class="number">3</span>] * box ** <span class="number">3</span> + A[<span class="number">2</span>] * box ** <span class="number">2</span> + A[<span class="number">1</span>] * box ** <span class="number">1</span> + A[<span class="number">0</span>]) % n</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">A = day()</span><br><span class="line">night(A)</span><br></pre></td></tr></table></figure>

<p>附件1：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># == Day Time == #</span></span><br><span class="line">package = [<span class="number">11348275592172789430802632398715397831929456592129727148350341695822097922745546634103895397114240780119492097879709874341733998189314701220819602086989170395665694216144611451695210776788208725517321710496401109614989729783280209806513298851774400705822274570042128297336679615535569295725037051009221966882907606741910671983811835353310553679554656322510247012465612842055583530354825164440556725066351429241835394579392892121937744444324723509039593320520073762479405487678614235658010109343868772211070874500834820005557924944766175445227592086997786601600141172729543326022039897279215360210475222205314199752358</span>, <span class="number">11817047514083750028443306573161291960303002458276716688201587284992675854178250185695613342603396451495053496021018943618684096193774851513377343785523373066637422156529843356640438514917147007662989366432951340073247573347091422478343675687872524102452812391963856179412214914106817415620613886827405526709334122157218264253412138947978859771457788135381194396144386611627935519990330309154612803264373276472523863776757124489507206744895878709136339189551422814752920383697719212261820943113370067423118794871570596583232694067119303936516491830190746798281923693136901268220982292626728815051587839682733501582997</span>, <span class="number">3131427695639074007646625687827523632044624200167725001731246731463369200890045250738898155425873822581405723445926216099453276470655307513244478613248253397941362848890729091875615893643288181126353294271063912991208029628896380928878098320509891044728414542705582996774991148116051162157848421643082210867849206627757941596203046799655123006406284498009424107637970927771132706399889289085811447333980744767367889464364519571965014435281718495338752896521777070285880327861778156398424643033288480056322928449210425585380975486759287881877636187364299666207762828705236236071045450767253946524067440138527952996304</span>, <span class="number">3345060634868343217881273515503289974894457362066685037297545772310131198850220025672843957153107490874807599311288876818421468275658855183857485067696603798636556327070411528170381402923911922437076616994460720931230980991440337397730061039967493443152767007916713160518618697678791358770766857737217910848181657393760417031865203943283074078341988117567851667858026108335625589177179258992930648353570238327435125409871028669479754623782967450462280802423233657422873275069133939005033872391235288329468886849808534906305377008408076775145268714146937205940659708210819711903273898505450411746796296074348301840443</span>, <span class="number">689229715602713064347690095007369004049337459458047359544160409565437783924368962797071453687950582019132146435134269723546824657132278724115055713024437048832952574546581164678912794341156478859615959289720931333010836265396177238403118182219901102453660596556053537987705012972371809213618745302576874122654094213771963420178465724399112964705426548207838941065298709968044913923423922781681311806180694571535910059881703228238538782302346351472443730399075812346657046097375387076507982673848430573754749554553794234945423901111974280859817600907619255722739374513108613738135872066592727564964404002462119084702</span>]</span><br><span class="line"><span class="comment"># == Night Time == #</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">19628814650078845889624476490795800811418703155298421183649751922179289373872110164946485468758965499898659860381452920316689731813466611171330082419646032975535828938381971760997472673267667258345915647828047467420412766203712358122436358120743184983881044132767579608354023899206025747277296489890315455139161247982158229333619416375842911027431739437723838483131248360727904613423834627213036877579164949084954352768932164210879329537266501942223360207803513487189832308290555832923018589686990981697562750385892888271329399531648035355662276186237232094775404084845357101354614900716614704579902047366473325519851</span></span><br><span class="line">ciphertext = <span class="number">18231770979476945075115454933498285687471248736331968136534439886998853983159878091479109027681230666670001308495054141682281492473521819495259722942633525843224223138121210743435008344491182811096997837681349401919300801071760448609909297020846949507707329708251861866061443743942558286917774317607571379516986051564317860557772153943821431899226380831989795907857566336085097807330399388077758869632230636727348278392968946952484442630549599469645903047917899063746000458656292320802815605327181346234519795519772619774175495201258591571744214020509439053957080210165266709953654561600989486386199867341092142358249</span></span><br><span class="line">shell = <span class="number">7450311459083436799013470526820816670296314417175130490433500468646960366746415074085735399822973890608046359739147553438015771999419943640758794686461655503899174274852006852675273759918109697488252918038788275865249305840107266839320745067341253227218580768443831238305064450748932813304412926315551102620477056031794884272260575749720364002093756539399717557808977458033683588388899534871439955606629530406662400672087729944642496842353084711242911328651341343429685261174338868058208644730980459845089948243884209259777439653298562832822410224626781415627048867272937969823329086437858777995321438386601575065665</span></span><br></pre></td></tr></table></figure>

<p>附件2：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, <span class="number">16966923273393034574368601955241184391111444785998466710722972275633988040568029224272430397635357872449163107278928804572765398970752644900568552514020294813546024733050135082024292481598322682990045855877556853392263676715734911232910368712575738786450510156105046776600566496799942574786503183241332740784997363514285857446938222302824964396227964711868412832852194845619628366554904150230665043909281603861298992421759553638135733037244888585600075655017766713763334284974682754159767494437867386464788270392548503256135412609157993954349845981674000072937143857040970855382655304911806719316346552101453584266121</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">13636547774903694433910615288816366243965221147245493790443257513469643051508482519945160993497983268746607032666514024577996510214003878851754244812785830861056511467944880656887067183093022088006603023892079757597903932697728395729605528467171403935076011715369931494813762896302405865063013876978950952553183445737415893862580946529557997177862386840671940665891984463553509323759394863514802662045074793125218445076375294720405008157895103559623204523371691063630903658360461001806917018298844432738514873530829540084732665560723768831816785580126848217585494349751859982707295270194451027637908966488433591336079</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">13422209706853784863425138450444393536114566510977689013118842078064352816867606066548879016746689784867031499069217146653949323203507755857385123653072875573743110808787259755688613540214185294636104765964080842615717180413731820679997453377899736419007193552970900617704671115646941207925636014254352661937769415565529244046272257822921740649781322893596978112103176487718960676212380426151079825140922318909470514158027009961239217428522970405297292867815726509360369236095377704967444339421311749405316999191339677904499413281713365474466679134722393111495793887387332928227905039036942450742103526490509249576159</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">21746430662648628292439055708644436184530740821098010749514133474681581832957631729292681550968108122182841907644832479495695011213810971334153360397292385819609198743433956578966857749821825621262178208409227379634952172419748956184624505995106932133301461499473823229623656490844764958301835433668618062743327682117611417235819168865744757242990985069648255779083246816509593018812991050741917153961245784296647661659339041115118272068392627299499703962645966495325055378652176922700072734325787550811454984878236039742147547963385471101805136506286953288566035101103034341742923072819774753918471775281464739904101</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">16012920802348742413202394765537959589119609441428117329692661212660781149297315973073063954731746455220386673231725950116051390914388279415796378305381377822621647264088603927560119754278978906758212463937071494263575443156089509654950881813861479449401068535285885349738367249035960528895049222211387021733152221289202030407416118814341241382479971018611239102343929419190892133819275458474489856666791981711793637127167775551296403296397810821548297674986394286293380472089135564385129140069501205054853729781710604489652713172579677128036322403868618295553335257593973027194532512596143733434234439677513237984107</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><code>day</code>主要是把填充后的<code>hint</code>进行5次同<code>e，n</code>的加密。</p>
<p>第一反应应该是用中国剩余定理进行求解，<strong>但是填充后的<code>hint</code>约2048bit</strong>，5组n是不够求解的。</p>
<p>分析<code>pad</code>，发现<code>pad</code>函数只是在<code>msg</code>后面填充上许多<code>00</code></p>
<p>于是根据$c \equiv m^e \mod n$可以推出$c \equiv (m’ \times pad)^e \mod n$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> msg + <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">2048</span> // <span class="number">8</span> - <span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line">A = [getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">30</span>, <span class="number">1</span> &lt;&lt; <span class="number">40</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01234&#x27;</span>]</span><br><span class="line"></span><br><span class="line">hint = <span class="built_in">str</span>(A)[<span class="number">1</span>:-<span class="number">1</span>].replace(<span class="string">&#x27;, &#x27;</span>, <span class="string">&#x27;||&#x27;</span>).encode()</span><br><span class="line">hint1 = bytes_to_long(hint) </span><br><span class="line">hint2 = bytes_to_long(pad(hint))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(hint2 // hint1))</span><br></pre></td></tr></table></figure>

<p>自己测试几组数据发现填充的内容大概是</p>
<p><code>0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code></p>
<p>实际可以把填充内容减少一些0</p>
<p>于是我们有$c \equiv m’^e \times  pad ^e \mod n \longrightarrow m’^e \equiv c \times (pad^e)^{-1} \mod n$</p>
<p><code>m&#39;</code>大约560bit</p>
<p>到此，我们有了5组新的<code>c</code>，可以用中国剩余定理求解了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">package = [, , , , ]</span><br><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ]</span><br><span class="line">]</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    N.append(pubkeys[i][<span class="number">1</span>])</span><br><span class="line">c = []</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">pad = <span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    cc = <span class="built_in">int</span>(package[i] * <span class="built_in">pow</span>(pad,-<span class="number">13</span>,N[i]))</span><br><span class="line">    c.append(cc)</span><br><span class="line">    </span><br><span class="line">C = CRT_list([c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>],c[<span class="number">4</span>]],[N[<span class="number">0</span>],N[<span class="number">1</span>],N[<span class="number">2</span>],N[<span class="number">3</span>],N[<span class="number">4</span>]])</span><br><span class="line">m = gmpy2.iroot(C,e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>

<p>得到<code>hint = 646919678902||598613162045||90472013741||917100488664||838250498519\x00</code></p>
<p>我们便得到了A</p>
<p>想先通过方程<code>shell = (A[4] * box ** 4 + A[3] * box ** 3 + A[2] * box ** 2 + A[1] * box ** 1 + A[0]) % n</code>，来求解<code>box</code></p>
<p>但是没成功</p>
<p><strong>请教了一下Van1sh师傅，他说一般roots解二次方程，而且一般得模素数</strong></p>
<p>换个思路，通过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">core = getRandomRange(<span class="number">1</span> &lt;&lt; <span class="number">70</span>, <span class="number">1</span> &lt;&lt; <span class="number">80</span>)</span><br><span class="line">box = (A[<span class="number">4</span>] * p ** <span class="number">4</span> + A[<span class="number">3</span>] * p ** <span class="number">3</span> + A[<span class="number">2</span>] * p ** <span class="number">2</span> + A[<span class="number">1</span>] * p ** <span class="number">1</span> + core) % n</span><br><span class="line">shell = (A[<span class="number">4</span>] * box ** <span class="number">4</span> + A[<span class="number">3</span>] * box ** <span class="number">3</span> + A[<span class="number">2</span>] * box ** <span class="number">2</span> + A[<span class="number">1</span>] * box ** <span class="number">1</span> + A[<span class="number">0</span>]) % n</span><br></pre></td></tr></table></figure>

<p>我们发现$shell \equiv A[4]\times core^4 + A[3]\times core^3 + A[2]\times core^2 + A[1]\times core + A[0] \mod p$</p>
<p>$core$给出范围，可以通过copper求解</p>
<p>求解出$core$后，$kp &#x3D;shell - A[4]\times core^4 + A[3]\times core^3 + A[2]\times core^2 + A[1]\times core + A[0]$ </p>
<p>求$kp$和$n$公因数便可得到p</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">package = [, , , , ]</span><br><span class="line">pubkeys = [</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ],</span><br><span class="line">    [<span class="number">13</span>, ]</span><br><span class="line">]</span><br><span class="line">N = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    N.append(pubkeys[i][<span class="number">1</span>])</span><br><span class="line">c = []</span><br><span class="line">e = <span class="number">13</span></span><br><span class="line">pad = <span class="number">0x10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    cc = <span class="built_in">int</span>(package[i] * <span class="built_in">pow</span>(pad,-<span class="number">13</span>,N[i]))</span><br><span class="line">    c.append(cc)</span><br><span class="line">    </span><br><span class="line">C = CRT_list([c[<span class="number">0</span>],c[<span class="number">1</span>],c[<span class="number">2</span>],c[<span class="number">3</span>],c[<span class="number">4</span>]],[N[<span class="number">0</span>],N[<span class="number">1</span>],N[<span class="number">2</span>],N[<span class="number">3</span>],N[<span class="number">4</span>]])</span><br><span class="line">hint = gmpy2.iroot(C,e)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(hint[<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line">A = [,,,,]</span><br><span class="line">shell = </span><br><span class="line">n = </span><br><span class="line">ciphertext = </span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (A[<span class="number">4</span>] * x^<span class="number">4</span> + A[<span class="number">3</span>] * x^<span class="number">3</span> + A[<span class="number">2</span>] * x^<span class="number">2</span> + A[<span class="number">1</span>] * x + A[<span class="number">0</span>]) - shell</span><br><span class="line">f = f.monic()</span><br><span class="line">ans = f.small_roots(X=<span class="number">2</span>^<span class="number">80</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.02</span>)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line">core = </span><br><span class="line">kp = shell - (A[<span class="number">4</span>] * core^<span class="number">4</span> + A[<span class="number">3</span>] * core^<span class="number">3</span> + A[<span class="number">2</span>] * core^<span class="number">2</span> + A[<span class="number">1</span>] * core + A[<span class="number">0</span>])</span><br><span class="line">p = gmpy2.gcd(kp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(ciphertext,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment">#b&#x27;Your flag is: flag&#123;8d24d7d491106a7974d5afe9342b2834&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="祥云杯线下（高校组）"><a href="#祥云杯线下（高校组）" class="headerlink" title="祥云杯线下（高校组）"></a>祥云杯线下（高校组）</h1><h2 id="ezmath——未解决"><a href="#ezmath——未解决" class="headerlink" title="ezmath——未解决"></a>ezmath——未解决</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">total_bit = <span class="number">512</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_para</span>(<span class="params">bit_size</span>):</span><br><span class="line">    P = getStrongPrime(bit_size)</span><br><span class="line">    Q = getStrongPrime(bit_size)</span><br><span class="line">    N = P * Q</span><br><span class="line">    magic = (N + <span class="number">1</span>) * (N + P + Q + <span class="number">1</span>) + (P - Q) ** <span class="number">2</span> + N</span><br><span class="line">    d = <span class="built_in">int</span>(<span class="number">0.394</span> * bit_size)</span><br><span class="line">    e = inverse(d, magic)</span><br><span class="line">    k = d * e // magic</span><br><span class="line">    <span class="keyword">return</span> (N, e), (P, Q, k)</span><br><span class="line">pubkey, sec_key = make_para(<span class="number">2</span> * total_bit)</span><br><span class="line">flag = bytes_to_long(flag) * sec_key[<span class="number">2</span>]</span><br><span class="line">p = getStrongPrime(total_bit)</span><br><span class="line">q = getStrongPrime(total_bit)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(flag, e, n)</span><br><span class="line">t = ((p - getRandomNBitInteger(<span class="number">16</span>)) * sec_key[<span class="number">0</span>] + q) % sec_key[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(pubkey) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>((t, c)))</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N,e=(21136120517038375343657055317361461947217610380415290931285704769845405139443342030139838613845989765254932385503454684656325859309861269837188207923942223163348944160792729101485975484543693998035828762630825174735962679103457025646672449491007685400869138263581883506767852264244013623583813540066115060793144049256890248337903932112449333735324371400873419104520104079223733159263094092843185909770131443506433825708789563521497940390674504488024226655482568491358458107989880756229607524452273305978138461190013290440068226454238375505010225133919526068226837545142734502100757510899741312502285931571783851666429, 291542085122413541028076006933740091355832744332602513957292369860771664833892358795585946753279254101863581542678927529330607906769804928526978686071141386341893467977451552634615917127445748737712286687041822255325772392569586666055711202824870471562051621883329559663555059967665101455578668904247279540014709971958403913939101728330638301270881265277488332145439522278871554725936095617940701105161078332467466405454007283937177070102098256744642045839067405705972784471374421818844770106228499198315920181837950503279178647052157269318876892192700670366858062171759498850112906238502375693099462427930964555274451795362167393410749436026095037695100430810204847979914959732383773952788768239221142673268839750770222737928397507645337714199166919835667638401309062163501094032890215821366318775462220119081175885338966308921205861717088926659072208866126879068213582499260316364548817213314952246293713853884872460934174624844462586276340207505217646013915381902979372875919823493439285174120160656952728493383464761519634974414670811896809158801804891938928244053980210687334268664219571818927285279999791212932795196689285015367417706597781418431735001428656415752334850685705212368666855124013583549768407830008606258798409140)</span></span><br><span class="line"><span class="string">t,c=(18872151984199200051633005759140295224788252451326410141022483203855894790958837408470348915966212063467995292461061069273539234939320647533902914083943444743748789975745514239518406829738286900177972974033143896932863898553599888597165054837513698667686277110587659188172271629973371164557353473146831275972, 47672712219012743425382676880904671136942826695249149129159924785186563239747047304204962529935078111450524236186612259355850306867579998685662967391936502046679744616903469002187225791339629835786750259999982506494377133775859573660632942293353420327987860136624649402598383416748766985203781387716072244402)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>







<h1 id="安徽省省赛——rwx"><a href="#安徽省省赛——rwx" class="headerlink" title="安徽省省赛——rwx"></a>安徽省省赛——rwx</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">m</span>):</span><br><span class="line">    r=[]</span><br><span class="line">    w=[]</span><br><span class="line">    x=[]</span><br><span class="line">    e=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">        r.append(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[-<span class="number">1</span>])</span><br><span class="line">        w.append(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[-<span class="number">2</span>])</span><br><span class="line">        x.append(<span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[-<span class="number">3</span>])</span><br><span class="line">        e.append(<span class="built_in">ord</span>(i)&gt;&gt;<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">return</span> r,w,e,x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inf</span>(<span class="params">r,w,x,files</span>):</span><br><span class="line">    re=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files)):</span><br><span class="line">        re.append(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">bin</span>(bytes_to_long(files[i]))[<span class="number">2</span>:]+r[i]+w[i]+x[i],<span class="number">2</span>)))</span><br><span class="line">    <span class="keyword">return</span> re</span><br><span class="line"></span><br><span class="line">r,w,e,x=know(flag)</span><br><span class="line">files=[]</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;output&quot;</span>,<span class="string">&quot;wb&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    files.append(urandom(<span class="number">8</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:</span><br><span class="line">    f.write(i.encode(<span class="string">&quot;hex&quot;</span>)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">files=inf(r,w,x,files)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> files:</span><br><span class="line">    f.write(hashlib.sha256(i).hexdigest()+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> e:</span><br><span class="line">    f.write(hashlib.sha256(<span class="built_in">str</span>(i)+urandom(<span class="number">2</span>)).hexdigest()+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> r</span><br><span class="line"><span class="built_in">print</span> w</span><br><span class="line"><span class="built_in">print</span> x</span><br><span class="line"><span class="built_in">print</span> e</span><br></pre></td></tr></table></figure>

<p>output</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">abb490d5efe69766</span><br><span class="line">a42c15dd0717102b</span><br><span class="line">ee0d2fc5c7351947</span><br><span class="line">4876242f69135f77</span><br><span class="line">f7f7e8648cf39204</span><br><span class="line">594b5fb7c4396a5d</span><br><span class="line">5b254e10bc3f2e83</span><br><span class="line">d27b465c51cb56aa</span><br><span class="line">02fde9f77e201f13</span><br><span class="line">5a5a717c5610113c</span><br><span class="line">0228c96208f04be7</span><br><span class="line">1f21b57c69e164c6</span><br><span class="line">eb9ff8ed6de6ae5a</span><br><span class="line">e9ff62161ebfd07f</span><br><span class="line">fc92701a784575fb</span><br><span class="line">246fb05d1f5a6f74</span><br><span class="line">91a9a630e9e91e8b</span><br><span class="line">c27160d38c8b8247</span><br><span class="line">4b473325d4de665c</span><br><span class="line">d1c1b9a58ca6d1e5</span><br><span class="line">818cf44df4d7b088</span><br><span class="line">569014c59066b916</span><br><span class="line">408fb2edb34c77a9</span><br><span class="line">d24576a95ddc151c</span><br><span class="line">9284b46648b92a5c</span><br><span class="line">073f776f6a36eb4a</span><br><span class="line">1b9a6ff58b537364</span><br><span class="line">9a327f0ff86f7687</span><br><span class="line">be0fe6df6ce0726f</span><br><span class="line">98734efb617a527b</span><br><span class="line">3e0e772fd9669166</span><br><span class="line">af8f0e61263ad605</span><br><span class="line">326c9434cc213d55</span><br><span class="line">5d6df6d0425fd13c</span><br><span class="line">c798fca9337f4e09</span><br><span class="line">b8b44901c1e2847c</span><br><span class="line">39c7932c6c9565d8</span><br><span class="line">0df12d3f4023f6cf</span><br><span class="line">df47f8efee88f469</span><br><span class="line">92bbcc351d041479</span><br><span class="line">77b55a5574fa0830</span><br><span class="line">24b60c00c2cda9c2</span><br><span class="line">3c00ce8fad4bdb0e</span><br><span class="line">3368003bfbca99e727ddfe6de1976fe7133392ddcf1e9b858af76aec41a3a0d6</span><br><span class="line">e5cf55af23a0c8b42b4d9f22d1c9dfc2b04a22c0202cd35c783bbf9b82e79525</span><br><span class="line">54ad655d2f450d96eb0198dd620758cbddc8987656b195df04a5e254447e9f19</span><br><span class="line">d093a5e18283d59816ed32156eaaabe64fc2575bc3cee6b4fccf6325d4b669a3</span><br><span class="line">8d32f93d356a459e8c2807c91ab52581c2d3ea225187b8fc2b7d6dc0dbf81500</span><br><span class="line">8778e6d1901c10b1d1090c32cef6aeb36702d37dceac8c0e5a16356473f82a15</span><br><span class="line">090bfe2dd0be43160b406e6b33845c6c5bde6bf47d466d26b7f69ea896eddfdd</span><br><span class="line">91e3ece70e184e3f768925751fb5a0c2cf9369d6bc268464cd2737af38dea781</span><br><span class="line">f16f4fae20ae181dc5a332e423a2a79fb3e2d28f072cb7ba2f8a0b29e2c1c698</span><br><span class="line">b5efdd3705fcf45d3b330202e0387ab9d24c1b79af9577ba0563b669d420723d</span><br><span class="line">d31afdf0eb4149e516658867b07b3032ec3d685f2eb68a565249f4f439a688fa</span><br><span class="line">ac039fae367745a39019561e4f9f953068d0b4639c19a5eaf7a05abc46e734e0</span><br><span class="line">f09637c3a24c14ad0d4fd442ede44009f85f898d506f9ba7a8563650cc4068e5</span><br><span class="line">4bedd3d498e83bd16f363a3eaed9209d1b700f63eeb6f96f775d97ab31cac5f8</span><br><span class="line">33c37802ce6c6dc22d15e60b62e68649ac2d2888ec1ea6fc8c44e01d9869dd75</span><br><span class="line">b5610f79b982ce4666b0df76539cfd74255a00aca06d08acd05eaa7d60084a1c</span><br><span class="line">24a8467f30d49602dc24318cd0665ea57b3333ed22aefde5f161a5f3044272bd</span><br><span class="line">4b1b131e729d9bd102bd27ced202f6d5d800c2c17969c04a30bc7ad29664e59a</span><br><span class="line">19429fd0d54ccf175abd9c4ecc7f24de183f5fee5193c5e895638dcda6a8bc27</span><br><span class="line">6ce1410665315540b25e34c0f1e058567d88ef4fa91e710114f20d62114fd550</span><br><span class="line">fec593226268610fbbc5352d0fb1f41b79a77eab3a2429f731feebaeb23841f7</span><br><span class="line">33935fb947103ab453057052223fd5958a8897b665c8b3650b5cfaf1d8cccdc7</span><br><span class="line">888b1eb7a6d29dc1cef64e6cc539d68b024c109736915630d5ddacc9c636851f</span><br><span class="line">9970385c755daf6275142edb885d03506a738762bf5bfa957f9aadb31f31cb7a</span><br><span class="line">c5ff5de1968b6458758a641d70525d098272c714840e0c2057ba8ec05d531b63</span><br><span class="line">2c208eb6a63a5beca0488ee83d4e5f0eedcc29227f6f25cddd169e87bd07a320</span><br><span class="line">b1d6e133e07eacfa6fbdcd9178344a861599d73c0aa1480b7b0bd7335736d665</span><br><span class="line">aefbae60c94eea15bfbc7a2824f7032b2740f95e19460bde15aae20cae0722ca</span><br><span class="line">6bdfea1b95fd48f168d545e409626e783c272b12b0895cbd17564dbbcf2da66f</span><br><span class="line">02a1b05474d3a86672f76712f0338a00ce95af62b7c6d2aca5492d3d7a8c7305</span><br><span class="line">3a011998e70fe4460f0acdec68a77933b41f6efbad345e66b18cf014cd88af88</span><br><span class="line">cd0fdb32c3e60912b54a2c1f26df90c3243626f636a9c498acbebcbcc2cbebbc</span><br><span class="line">87dc8336d829915f3f98709041cfa033be859e2b1ace2c9478e26c457e4aadc0</span><br><span class="line">d2e84a52aa49ed36237c81ea9f2ff66ca9d48d406df092535971601e80ec31d1</span><br><span class="line">042025bb6c7535549c2cb536a04125348c48454ac6a8210cfef8a71e50813aff</span><br><span class="line">436308db651644f181d02c1b90368c150f5499836d71e6b7ae8e8334811a258e</span><br><span class="line">5b8b9c76b17324ef5f35692b9ee069ec3c6135b1725bb82900bf3fbe953e0586</span><br><span class="line">0506511cdc9561f76e5d85d147120fd746668b043f5a71760148008ebe37d9f0</span><br><span class="line">6d89ad6b0a094a7f9a9bf4ee1ca2f3b0e5ec56f924b7efeb16fbdfbfd41358d3</span><br><span class="line">25019aa8cec744ea6937729fd454100c6f5a589284b007c645c6d7c6ef58c8bc</span><br><span class="line">39322232c9118f9541f6432913384444309fd10a0f627c9ecc2f95309701ab13</span><br><span class="line">115a84ee3ac24122fd5482b0f7eb900ce99382ca41777cc2577c82cec766cab0</span><br><span class="line">ed9f6161c423f30cc7ceac974ae5e432e755f08cb79b47ce3d43452dcf74c76c</span><br><span class="line">a3df8f1e5dd063595188044473fa1c2bc69eec2e29bafaeeb3962c2750585fca</span><br><span class="line">3f8bb91ade38f8e0b0e269a57191d70cf60ac2db4c79518e79b48c08a737f6cb</span><br><span class="line">439190a055187e9c9a0120ed91b15365f716330c8df21cadcf14f6ea0f35b4b8</span><br><span class="line">dd1ce000a01a41ead05d03d74e184345aa1340c14873d75bf99275b6042c66a5</span><br><span class="line">5e2002006de48dc19d2116bd6de751ede5bdcfd96bfafbc41d9a227b06c8f7e6</span><br><span class="line">d05a972e1fa0d36533c88c3d6f51175df426ab3ad3950cbd82fe789907de7178</span><br><span class="line">e108856d6e85ea36e8b0330a5b62489ce939c11f0e3aa673327eef4c87adfdf9</span><br><span class="line">0f673f6397808e53248ce5778e31d669ad9ddcdd4c732a3dcea05a3c03322972</span><br><span class="line">2c6d0af5b1ea6178d647eaad2a41f76bdf0111dce813b136262ab9cbd1a042da</span><br><span class="line">2c4b24bc7213bd16739ac23b0988e27ea3b52fbf87b7c3648cae97d3535449d2</span><br><span class="line">accea9e2c218217fc967bd11d772c442adf4cfbaf6d81c57e13eda48c907a584</span><br><span class="line">befe454b22b4eb940732ab972657e474c211d6d9dfcddd34f68d9628b32d61fe</span><br><span class="line">fc1090ba15ccae04a9648183bfd9050e5513d98035af00a83e9a371bcff72512</span><br><span class="line">d85b886abcdc31f028a2be8fdfa31ef3510c4b7f099baa0f15b9308493f3d2a7</span><br><span class="line">2e631a9a04bf11d2354df921e482d6059684cc746ca1725b6d62952739c75ade</span><br><span class="line">31dcc3a2dd334474173f6d16adcd3546736ddea1dda53d7ae7120bc5bcbc12f1</span><br><span class="line">11d699bf7dcc57780f5b4217b4a6f777c0c4cdbd4269bf76b3daa5b6a6901fcb</span><br><span class="line">02ae1e11650bf5ea33b0f2b9a65e830a0e4ff33b64be2f84eb0c89aeea0718fb</span><br><span class="line">e3d6ba04b3583099db6095205e50eaf338260cbd97c77c3b3d9058522f108892</span><br><span class="line">81f062c17993b7266ce990b4d115721973958d5f81a9f24fa5e7c718b4bfd1be</span><br><span class="line">9dbb8f5215d43034aff34bcb3a2cb950b76c5dc78320bf729739f28c2316c381</span><br><span class="line">b5ce8e8ca3b8e872f7640f0980af6aec31cb8549f48911081264b87c94ed9a16</span><br><span class="line">70cdeb42324021d98cb408f2e0e2425a4be90d6b263a44f05e65af40c842a105</span><br><span class="line">ef679767995bfa61402bf90cd697f388199ed92b24e5a1cd67485f9951b73bf0</span><br><span class="line">ccfb009cacb758e3ed525b4941c61e973d7bc2bc079c3a2bd089f85fbf634a2f</span><br><span class="line">f367d169e7fed794e76f711a4f75c0dbf8ac9426f1da48374bc86f179487d83a</span><br><span class="line">90e786a6c635b110c1a9e8b717809b665d2ea91cf0851e8615ea276628544a6d</span><br><span class="line">926cc73a86228b74a4ef8a386c2ecd56c7ed1c8979f2437dd53aa8c1a15b5513</span><br><span class="line">32e8b07e1f7bb7da7012fff02cdcf84971d976fe056ddba651731657c7bce278</span><br><span class="line">dbd86282a86ce7523cc2920ecd87070f46f436f4c9436667599fff95b0ebdc1b</span><br><span class="line">4ab6a0ad4b50df2e2a178576f4aae0c7289ea00385b9d29be0c4e3b2921b5f2d</span><br><span class="line">1b9a6ed279789ca017162f12586aef68f0d55acbbfb85f7a0ea294ff22a2eacf</span><br><span class="line">07fc3be55d5d43dcb80f69121d6847aa0d093d4d4f723017ef75ab5b09ec555b</span><br><span class="line">efb6468f620d1a0dd71ddfdc66b1a5145a1666c07729db8cba93ccadf66d6363</span><br><span class="line">25164ae1c0e8c1f6243fb7761310c398c607b3be6ff0cdc41fa7583288cece47</span><br><span class="line">01baccd7e9415275d8e9f797b90362496935e279d02bcf68e5bcd89577688934</span><br><span class="line">e6bb9d20c9f7b528dcf323143fde093be6859b63583e58fbe0c319d5f6104cfd</span><br><span class="line">048856baa298e3d69421db8f4777fd44756f25933484edf6574f1ad0c3a35d6a</span><br><span class="line">0799af8cad7311dd6c27f07a1b13e57eb81d9ff79520b05428d6599105d41c37</span><br><span class="line">f34f86804facfee48869f64b42b2f507fab255425001d368078bae02ae660f21</span><br><span class="line">dc658b6bef96c02fd9ddcf1aaa442a5994c4789cc6ab76b2e592a36e0f61e205</span><br><span class="line">8852c503f1fe03706f3a6afffed6f5ad6a9f375f7ef430fc29ecbefc7696d28c</span><br><span class="line">62a37ed7404473449d756a1750ff5d65de9b3e27e10367e63a25e38681a144d3</span><br></pre></td></tr></table></figure>

<p>分析代码知道<code>r</code>,<code>w</code>,<code>x</code>，<code>e</code>分别存放<code>flag</code>每个字符转ASCII码的倒数第一位，倒数第二位，倒数第三位，前<code>x-3</code>位</p>
<p>分析<code>inf(r,w,x,files)</code>函数</p>
<p>根据<code>re.append(long_to_bytes(int(bin(bytes_to_long(files[i]))[2:]+r[i]+w[i]+x[i],2)))</code></p>
<p>发现需要通过加密后的<code>files</code>和加密前的<code>files</code>来恢复<code>r</code>,<code>w</code>,<code>x</code></p>
<p>题目已经给出加密前的<code>files</code>，只需要爆破3位就可以知道<code>r</code>,<code>w</code>,<code>x</code></p>
<p>得到<code>r</code>,<code>w</code>,<code>x</code>以后</p>
<p>根据<code>f.write(hashlib.sha256(str(i)+urandom(2)).hexdigest()+&quot;\n&quot;)</code></p>
<p>来爆破<code>e</code>，因为e是flag每个字符转ASCII码右移3位后的值，所以$1 \le e \le 16$</p>
<p>又因为<code>urandom(2)</code>的值在$2^8 —2^{16}$之间（这个下限一开始找错了，从$2^{15}$一直试到$2^8$），这样以来，我们便确定了爆破范围</p>
<p>然后把<code>e</code>,<code>r</code>,<code>w</code>,<code>x</code>拼接转回字符就行</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;0.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line">files = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">129</span>):</span><br><span class="line">    files.append(f.readline().strip())</span><br><span class="line"></span><br><span class="line">files1 = files[:<span class="number">43</span>]</span><br><span class="line">files2 = files[<span class="number">43</span>:<span class="number">43</span>*<span class="number">2</span>]</span><br><span class="line">files3 = files[<span class="number">43</span>*<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r = []</span><br><span class="line">w = []</span><br><span class="line">x = []</span><br><span class="line">byte = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(files1)):</span><br><span class="line">    byte_f = <span class="built_in">bytes</span>.fromhex(files1[i])</span><br><span class="line">    num_f = bytes_to_long(byte_f)</span><br><span class="line">    bin_f = <span class="built_in">bin</span>(num_f)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> product([<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;0&#x27;</span>],repeat=<span class="number">3</span>):</span><br><span class="line">        may_f = bin_f + <span class="string">&quot;&quot;</span>.join(j)</span><br><span class="line">        hash_f = hashlib.sha256(long_to_bytes(<span class="built_in">int</span>(may_f,<span class="number">2</span>))).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> hash_f == files2[i]:</span><br><span class="line">            r.append(<span class="string">&quot;&quot;</span>.join(j)[-<span class="number">3</span>])</span><br><span class="line">            w.append(<span class="string">&quot;&quot;</span>.join(j)[-<span class="number">2</span>])</span><br><span class="line">            x.append(<span class="string">&quot;&quot;</span>.join(j)[-<span class="number">1</span>])</span><br><span class="line">            byte.append(byte_f)</span><br><span class="line"></span><br><span class="line">e = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> trange(<span class="number">43</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">        may_e = <span class="built_in">str</span>(i).encode()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>,<span class="number">2</span>**<span class="number">8</span>,-<span class="number">1</span>):</span><br><span class="line">            may = may_e + long_to_bytes(j)</span><br><span class="line">            hash_may = hashlib.sha256(may).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> hash_may == files3[k]:</span><br><span class="line">                e.append(may_e)</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">43</span>):</span><br><span class="line">    bin_m = <span class="built_in">bin</span>(<span class="built_in">int</span>(e[i].decode()))[<span class="number">2</span>:] + x[i] + w[i] + r[i]</span><br><span class="line">    mm = <span class="built_in">int</span>(bin_m,<span class="number">2</span>)</span><br><span class="line">    m.append(<span class="built_in">chr</span>(mm))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span>.join(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag=&quot;</span>,flag)</span><br><span class="line"><span class="comment">#flag&#123;8uuuuu_dd_3yyyui_like_the_internet_g0&#125;</span></span><br></pre></td></tr></table></figure>
















    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/09/07/%E6%8C%A8%E6%89%93%E6%97%A5%E8%AE%B0/" title="挨打日记">https://dexterjie.github.io/2023/09/07/挨打日记/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/09/03/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023%E7%BE%8A%E5%9F%8E%E6%9D%AF/" rel="prev" title="2023羊城杯">
                  <i class="fa fa-chevron-left"></i> 2023羊城杯
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/09/10/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SICTF2023/" rel="next" title="SICTF2023">
                  SICTF2023 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">125k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">7:34</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
