<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="少年的书桌上没有虚度的光阴">
<meta property="og:type" content="article">
<meta property="og:title" content="RSA3">
<meta property="og:url" content="https://dexterjie.github.io/2023/07/09/RSA3/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="少年的书桌上没有虚度的光阴">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/35.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/36.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/37.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/38.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/39.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/40.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/42.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/43.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/44.png">
<meta property="article:published_time" content="2023-07-09T03:30:38.000Z">
<meta property="article:modified_time" content="2023-07-31T14:09:18.661Z">
<meta property="article:author" content="Dexter">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/RSA/35.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/07/09/RSA3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/07/09/RSA3/","path":"2023/07/09/RSA3/","title":"RSA3"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>RSA3 | DexterJie'Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E5%8D%81%E4%B9%9D%E3%80%81%E8%B4%B9%E9%A9%AC%E5%88%86%E8%A7%A3%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">二十九、费马分解法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-n-p%C3%97p1%C3%97q%C3%97q1"><span class="nav-number">1.1.</span> <span class="nav-text">1.n &#x3D; p×p1×q×q1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98"><span class="nav-number">1.1.1.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-yafu%E6%97%A0%E6%B3%95%E5%88%86%E8%A7%A3"><span class="nav-number">1.2.</span> <span class="nav-text">2.yafu无法分解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">例题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E3%80%81pow-m-p-n-%E5%92%8Cpow-m-q-n"><span class="nav-number">2.</span> <span class="nav-text">三十、pow(m,p,n)和pow(m,q,n)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-2"><span class="nav-number">2.1.</span> <span class="nav-text">例题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC1"><span class="nav-number">2.1.1.</span> <span class="nav-text">推导1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A8%E5%AF%BC2"><span class="nav-number">2.1.2.</span> <span class="nav-text">推导2</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E4%B8%80%E3%80%81leak-n-p-q-1"><span class="nav-number">3.</span> <span class="nav-text">三十一、leak &#x3D; (n+p) % (q-1)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-3"><span class="nav-number">3.1.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E4%BA%8C%E3%80%81leak-d-p-q"><span class="nav-number">4.</span> <span class="nav-text">三十二、leak &#x3D; d+p+q</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-4"><span class="nav-number">4.1.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E4%B8%89%E3%80%81leak-pow-p-q-n-pow-q-p-n-n"><span class="nav-number">5.</span> <span class="nav-text">三十三、leak &#x3D; pow(p,q,n)+pow(q,p,n)%n</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-5"><span class="nav-number">5.1.</span> <span class="nav-text">例题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2023%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E4%BA%A7%E4%B8%9A%E4%BA%BA%E6%89%8D%E8%83%BD%E5%8A%9B%E6%8C%91%E6%88%98%E8%B5%9B%E2%80%94%E2%80%94math-exam"><span class="nav-number">5.2.</span> <span class="nav-text">2023数据安全产业人才能力挑战赛——math_exam</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E5%9B%9B%E3%80%81%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E6%B1%82%E9%80%86%E5%85%83d1-d2"><span class="nav-number">6.</span> <span class="nav-text">三十四、扩展欧几里得求逆元d1-d2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-6"><span class="nav-number">6.1.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E4%BA%94"><span class="nav-number">7.</span> <span class="nav-text">三十五</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E5%85%AD%E3%80%81%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0c-pow-m-flag-n"><span class="nav-number">8.</span> <span class="nav-text">三十六、离散对数c &#x3D; pow(m,flag,n)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-number">8.1.</span> <span class="nav-text">离散对数的定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E6%A0%B9"><span class="nav-number">8.2.</span> <span class="nav-text">原根</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%8E%E4%B9%88%E6%B1%82%E8%A7%A3%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0"><span class="nav-number">8.3.</span> <span class="nav-text">怎么求解离散对数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-7"><span class="nav-number">8.4.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E4%B8%83%E3%80%81m-n"><span class="nav-number">9.</span> <span class="nav-text">三十七、m &gt; n</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-8"><span class="nav-number">9.1.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E5%85%AB%E3%80%81ppp%E5%92%8Cppq"><span class="nav-number">10.</span> <span class="nav-text">三十八、ppp和ppq</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E5%8D%81%E4%B9%9D%E3%80%81%E6%89%A9%E5%B1%95%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="nav-number">11.</span> <span class="nav-text">三十九、扩展中国剩余定理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%B1%82d"><span class="nav-number">11.1.</span> <span class="nav-text">1.求d</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-9"><span class="nav-number">11.1.1.</span> <span class="nav-text">例题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%B1%82c"><span class="nav-number">11.2.</span> <span class="nav-text">2.求c</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E9%A2%98-10"><span class="nav-number">11.2.1.</span> <span class="nav-text">例题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E5%8D%81%E3%80%81e%E5%92%8Cphi%E4%B8%8D%E4%BA%92%E7%B4%A0%EF%BC%8C%E7%94%A8%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="nav-number">12.</span> <span class="nav-text">四十、e和phi不互素，用中国剩余定理</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dexter"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">Dexter</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">28</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/07/09/RSA3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="Dexter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="RSA3 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RSA3
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-07-09 11:30:38" itemprop="dateCreated datePublished" datetime="2023-07-09T11:30:38+08:00">2023-07-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-07-31 22:09:18" itemprop="dateModified" datetime="2023-07-31T22:09:18+08:00">2023-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/" itemprop="url" rel="index"><span itemprop="name">现代密码-非对称加密</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>10 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><strong>少年的书桌上没有虚度的光阴</strong></p>
<span id="more"></span>

<p><strong>记录笔者RSA学习过程，继上篇</strong></p>
<h1 id="二十九、费马分解法"><a href="#二十九、费马分解法" class="headerlink" title="二十九、费马分解法"></a>二十九、费马分解法</h1><p><img src="/../images/RSA/35.png"></p>
<p><strong>eg:</strong></p>
<p><img src="/../images/RSA/36.png"></p>
<h2 id="1-n-p×p1×q×q1"><a href="#1-n-p×p1×q×q1" class="headerlink" title="1.n &#x3D; p×p1×q×q1"></a>1.n &#x3D; p×p1×q×q1</h2><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag = &#x27;flag&#123;&#x27;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">flag=flag.encode()</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">p1 = gmpy2.next_prime(p)</span><br><span class="line">q= getPrime(512)</span><br><span class="line">q1= gmpy2.next_prime(q)</span><br><span class="line"></span><br><span class="line">n = p*q*p1*q1</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">c= 9949542934673249601822379710110536682375274333294212429688584989332571435120688962792756767799023906332576991820877786082142174075762351091472858450420524999000438499038246804892307015253501997557003507879115010365751701766309706931191167213901685725286428926861333201965004869326873632404052661985741631906479109023390455968199954361183959446992180809970004376995201084933073767278979855530735756096072840384641334181432769063314242300512881491103946010394543208395998872730145780806025267971492301568490427293141120807461902093932052106811061648537600125019831876736538658644780471805555396705702634885360657660235</span><br><span class="line">n= 14775235844515544576473611382698284004133861994231391972299917039113871334718108546717938305388267655285590882177982603418940337565701637106925368292676630781520319110700106306029357476649553934570683454139537943486518666101218072140043084858740684805876092240053196287287330188619164273915005792335974297620475140547828827559062269649682393716241864595363863867012095487700403514116433664086346056485373014640655316422588972338531776150881686013955605480910803097642414475309381073364181798620439167561641939844350252283317699576359402716770493658380425200603092475286870303441165147435503582004675788584686434009043</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c= <span class="number">9949542934673249601822379710110536682375274333294212429688584989332571435120688962792756767799023906332576991820877786082142174075762351091472858450420524999000438499038246804892307015253501997557003507879115010365751701766309706931191167213901685725286428926861333201965004869326873632404052661985741631906479109023390455968199954361183959446992180809970004376995201084933073767278979855530735756096072840384641334181432769063314242300512881491103946010394543208395998872730145780806025267971492301568490427293141120807461902093932052106811061648537600125019831876736538658644780471805555396705702634885360657660235</span></span><br><span class="line">n= <span class="number">14775235844515544576473611382698284004133861994231391972299917039113871334718108546717938305388267655285590882177982603418940337565701637106925368292676630781520319110700106306029357476649553934570683454139537943486518666101218072140043084858740684805876092240053196287287330188619164273915005792335974297620475140547828827559062269649682393716241864595363863867012095487700403514116433664086346056485373014640655316422588972338531776150881686013955605480910803097642414475309381073364181798620439167561641939844350252283317699576359402716770493658380425200603092475286870303441165147435503582004675788584686434009043</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line">a=gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">lt=[]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a+=<span class="number">1</span></span><br><span class="line">    b2=<span class="built_in">pow</span>(a,<span class="number">2</span>)-n</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">        tmp=[]</span><br><span class="line">        b=gmpy2.iroot(b2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        x1=a-b</span><br><span class="line">        x2=a+b</span><br><span class="line">        tmp.append(<span class="built_in">int</span>(x1))</span><br><span class="line">        tmp.append(<span class="built_in">int</span>(x2))</span><br><span class="line">        lt.append(tmp)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(lt)&gt;=<span class="number">2</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(lt)</span><br><span class="line"><span class="keyword">assert</span> lt[<span class="number">0</span>][<span class="number">1</span>]*lt[<span class="number">0</span>][<span class="number">0</span>]==n</span><br><span class="line"><span class="keyword">assert</span> lt[<span class="number">1</span>][<span class="number">1</span>]*lt[<span class="number">1</span>][<span class="number">0</span>]==n</span><br><span class="line">p=libnum.gcd(lt[<span class="number">0</span>][<span class="number">0</span>],lt[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.is_prime(p))</span><br><span class="line">p1=gmpy2.next_prime(p)</span><br><span class="line"><span class="built_in">print</span>(p1)</span><br><span class="line">q=libnum.gcd(lt[<span class="number">0</span>][<span class="number">1</span>],lt[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="built_in">print</span>(gmpy2.is_prime(q))</span><br><span class="line">q1=gmpy2.next_prime(q)</span><br><span class="line"><span class="built_in">print</span>(q1)</span><br><span class="line"><span class="built_in">print</span>(n==p*p1*q*q1)</span><br><span class="line">phi=(p-<span class="number">1</span>)</span><br><span class="line">d=libnum.invmod(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>

<p><strong>遍历求出的x1是p,q,p1,q1任意两个数的积，因此后面需要用到gcd</strong></p>
<p><strong>最后phi &#x3D; (p-1)我不大理解</strong></p>
<h2 id="2-yafu无法分解"><a href="#2-yafu无法分解" class="headerlink" title="2.yafu无法分解"></a>2.yafu无法分解</h2><h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag = &#x27;flag&#123;&#x27;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">flag=flag.encode()</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">p = getPrime(2048)</span><br><span class="line">q = gmpy2.next_prime(p)</span><br><span class="line">for i in range(3600):</span><br><span class="line">    if i%100 ==0:</span><br><span class="line">        print(i)</span><br><span class="line">        q = gmpy2.next_prime(q)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line"></span><br><span class="line">c= 672211618947965669743140453815925311571913536792006320455451623329504768032653294195423386000169883889423130760702613901378226812991253672513808102582219125394975375184975680670477893616071731840578283372003364948041569480819988957797304000908767353945393438677325246806404776535366574244075168385686413998057429677446479345637389931707590541292174569539214514406772616679574446429577154994658300264395963743399028585579405127133850937684035755385536903177249615680095525438385801267848518932540742850864828339907387436386589615141301315094268048540705754105909152114279580297245086066527476038499949395262133426884691004953583259542925926790804058362169131721101062567084072161757158556850613589003126629288335943625835227353239228779420777075183829735033060565964497198340990191457681711972006273381600852029426480042505732976038791175365941723190939561137761147915067500934001302644947570092730510410631121938241136026914524548262047531029183007578603005500736114268512900086177419819102734670936080786880709408049475188517563383396936699006425388577265810859020768191320288121742321413664684223757832512232195144286087827718142083017087556701405737637649721698260338198824299502881114161665693663517201464044647997804424204974158</span><br><span class="line">n= 720239742676276892125180297266754203107040753393792061819109788620051632698640388878164710563582551395398417339060158866293057237682628696160289176629921331485290769277668335946098043360398735897380648863281934217401247716885835600015902679721336644611726200751169780657177537142181503044265719975692160293076414714427014863104317576606190229434103615882007838099640939570363751985038883738622768287033043747426059699658000045440922380571398371705698665874788485742224933932126886052739997477581453575568873105033061557099207861338425715849944147722082093066073450898210944979122392845654525731562948599513722685350626329020621203929679566003766926450933409172107168029480058053562850582746440505733686649603099598891890233020681944859657534362524449703843503708875743380789764830334189231182948902486001101574574542624002055351308194659501208428214278013747062791484983332159726081847473539435746845527406013789541657402799211822281010775911725885529125479685615597338584834382753602860489834851310346307067835494249861848527198787408591551265511901573927692939919503175252790601381174213220684859419625471536435635703766410175026305548524401754345447084444023478365533640647989603192253820896160603674343007718854266899300948742261</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>用费马分解法求出p</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c= <span class="number">672211618947965669743140453815925311571913536792006320455451623329504768032653294195423386000169883889423130760702613901378226812991253672513808102582219125394975375184975680670477893616071731840578283372003364948041569480819988957797304000908767353945393438677325246806404776535366574244075168385686413998057429677446479345637389931707590541292174569539214514406772616679574446429577154994658300264395963743399028585579405127133850937684035755385536903177249615680095525438385801267848518932540742850864828339907387436386589615141301315094268048540705754105909152114279580297245086066527476038499949395262133426884691004953583259542925926790804058362169131721101062567084072161757158556850613589003126629288335943625835227353239228779420777075183829735033060565964497198340990191457681711972006273381600852029426480042505732976038791175365941723190939561137761147915067500934001302644947570092730510410631121938241136026914524548262047531029183007578603005500736114268512900086177419819102734670936080786880709408049475188517563383396936699006425388577265810859020768191320288121742321413664684223757832512232195144286087827718142083017087556701405737637649721698260338198824299502881114161665693663517201464044647997804424204974158</span></span><br><span class="line">n= <span class="number">720239742676276892125180297266754203107040753393792061819109788620051632698640388878164710563582551395398417339060158866293057237682628696160289176629921331485290769277668335946098043360398735897380648863281934217401247716885835600015902679721336644611726200751169780657177537142181503044265719975692160293076414714427014863104317576606190229434103615882007838099640939570363751985038883738622768287033043747426059699658000045440922380571398371705698665874788485742224933932126886052739997477581453575568873105033061557099207861338425715849944147722082093066073450898210944979122392845654525731562948599513722685350626329020621203929679566003766926450933409172107168029480058053562850582746440505733686649603099598891890233020681944859657534362524449703843503708875743380789764830334189231182948902486001101574574542624002055351308194659501208428214278013747062791484983332159726081847473539435746845527406013789541657402799211822281010775911725885529125479685615597338584834382753602860489834851310346307067835494249861848527198787408591551265511901573927692939919503175252790601381174213220684859419625471536435635703766410175026305548524401754345447084444023478365533640647989603192253820896160603674343007718854266899300948742261</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">a = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a += <span class="number">1</span></span><br><span class="line">    b2 = <span class="built_in">pow</span>(a,<span class="number">2</span>)-n</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_square(b2):</span><br><span class="line">        b = gmpy2.iroot(b2,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">        p = a+b</span><br><span class="line">        q = n // p</span><br><span class="line">        d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">        </span><br><span class="line"><span class="comment">#b&#x27;flag&#123;e45a7d01-2639-4d21-830d-4fe00c5d69d9&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="三十、pow-m-p-n-和pow-m-q-n"><a href="#三十、pow-m-p-n-和pow-m-q-n" class="headerlink" title="三十、pow(m,p,n)和pow(m,q,n)"></a>三十、pow(m,p,n)和pow(m,q,n)</h1><h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line">n=p*q</span><br><span class="line">x=pow(m,p,n)</span><br><span class="line">y=pow(m,q,n)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;x=&quot;,x)</span><br><span class="line">print(&quot;y=&quot;,y)</span><br><span class="line">n= 49134891668897345591333219711303339144007670596441894829337290952093400283298630665826095289165809681961208520996265436195389904640720636719133734406693433810554096598929737422594980883724481297143537076662178576926253446582535294294231165454562659420944920445437433494540727083960515996626310138062984512331</span><br><span class="line">x= 24898114380189083075249478644617176345363769858290571489415603903447660857572376734333314388004344067870622511211551400003900882292855408080408530612898712604821849194436116203045876702326786310101264912258598823736415425063797050123512802647807994402065186878212852202204820369988512984137386942003350601013</span><br><span class="line">y= 16329839654620902472571665649919967371160409036961382290481165859731193710305989211665714814452109039568075053785039634104665516076749524765980529291699849764465433749870986860914147427598112865371747917109336808548762214669827404524571735460653099723747061723390924856171469660835909151652929700638010039801</span><br></pre></td></tr></table></figure>

<h3 id="推导1"><a href="#推导1" class="headerlink" title="推导1"></a>推导1</h3><p><img src="/../images/RSA/37.png"></p>
<p><strong>求公因数得到p</strong></p>
<p><strong>留意一下密文是x和加密密钥是p或者y和q</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">49134891668897345591333219711303339144007670596441894829337290952093400283298630665826095289165809681961208520996265436195389904640720636719133734406693433810554096598929737422594980883724481297143537076662178576926253446582535294294231165454562659420944920445437433494540727083960515996626310138062984512331</span></span><br><span class="line">x= <span class="number">24898114380189083075249478644617176345363769858290571489415603903447660857572376734333314388004344067870622511211551400003900882292855408080408530612898712604821849194436116203045876702326786310101264912258598823736415425063797050123512802647807994402065186878212852202204820369988512984137386942003350601013</span></span><br><span class="line">y= <span class="number">16329839654620902472571665649919967371160409036961382290481165859731193710305989211665714814452109039568075053785039634104665516076749524765980529291699849764465433749870986860914147427598112865371747917109336808548762214669827404524571735460653099723747061723390924856171469660835909151652929700638010039801</span></span><br><span class="line"></span><br><span class="line">tmp = <span class="built_in">pow</span>(x,n,n)-y</span><br><span class="line">p = gmpy2.gcd(tmp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d1 = gmpy2.invert(p,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(x,d1,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line"></span><br><span class="line">d2 = gmpy2.invert(q,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m2 = <span class="built_in">pow</span>(y,d2,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m2))</span><br></pre></td></tr></table></figure>

<h3 id="推导2"><a href="#推导2" class="headerlink" title="推导2"></a>推导2</h3><p><img src="/../images/RSA/38.png"></p>
<p><strong>根据最后一个式子解方程即可</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">n= 49134891668897345591333219711303339144007670596441894829337290952093400283298630665826095289165809681961208520996265436195389904640720636719133734406693433810554096598929737422594980883724481297143537076662178576926253446582535294294231165454562659420944920445437433494540727083960515996626310138062984512331</span><br><span class="line">x= 24898114380189083075249478644617176345363769858290571489415603903447660857572376734333314388004344067870622511211551400003900882292855408080408530612898712604821849194436116203045876702326786310101264912258598823736415425063797050123512802647807994402065186878212852202204820369988512984137386942003350601013</span><br><span class="line">y= 16329839654620902472571665649919967371160409036961382290481165859731193710305989211665714814452109039568075053785039634104665516076749524765980529291699849764465433749870986860914147427598112865371747917109336808548762214669827404524571735460653099723747061723390924856171469660835909151652929700638010039801</span><br><span class="line"></span><br><span class="line">R.&lt;m&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = m**2 + x*y -(x+y)*m</span><br><span class="line">f = f.monic()</span><br><span class="line">root = f.small_roots(X=2^430)</span><br><span class="line">if root:</span><br><span class="line">    print(long_to_bytes(int(root[0])))</span><br><span class="line">else:</span><br><span class="line">    print(0)</span><br></pre></td></tr></table></figure>

<p><strong>不太明白这个上界为什么取的2^430</strong></p>
<h1 id="三十一、leak-n-p-q-1"><a href="#三十一、leak-n-p-q-1" class="headerlink" title="三十一、leak &#x3D; (n+p) % (q-1)"></a>三十一、leak &#x3D; (n+p) % (q-1)</h1><h2 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line">if p &lt;= q:</span><br><span class="line">    p, q = q, p</span><br><span class="line">e = 0x10001</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">leak = (n + p) % (q-1)</span><br><span class="line">print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">#e = 65537</span><br><span class="line">#c = 846622880180923496523897101093587388412673197929101816777894080453907929979417582433675846206418833989406082027835614960931951892393700870678469052366477889491688459558189367255658278968722099012534045477993924284003153851171132420751750724394405070269223797513951991873714156884423926582172189394011114952</span><br><span class="line">#n = 159452716285492879108396025652299064897348745847754101475050126796260046052685162344131542880739092630022413124977374334652652450809186959288635651980201026825896903174847709657312399801033678426271413442323084354665643010763178857967804623680894444913369256168333223214048037661178587978535722147091129404833</span><br><span class="line">#leak = 2669103705669857828725305123419482758456336465207378766363532584323475128597302561377245054918781031448710846825859151788151496659511563529987056456136018</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/RSA/39.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> solve,symbols</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">846622880180923496523897101093587388412673197929101816777894080453907929979417582433675846206418833989406082027835614960931951892393700870678469052366477889491688459558189367255658278968722099012534045477993924284003153851171132420751750724394405070269223797513951991873714156884423926582172189394011114952</span></span><br><span class="line">n = <span class="number">159452716285492879108396025652299064897348745847754101475050126796260046052685162344131542880739092630022413124977374334652652450809186959288635651980201026825896903174847709657312399801033678426271413442323084354665643010763178857967804623680894444913369256168333223214048037661178587978535722147091129404833</span></span><br><span class="line">leak = <span class="number">2669103705669857828725305123419482758456336465207378766363532584323475128597302561377245054918781031448710846825859151788151496659511563529987056456136018</span></span><br><span class="line"></span><br><span class="line">p = symbols(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = symbols(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq1 = <span class="number">2</span>*(p-q+<span class="number">1</span>) - leak</span><br><span class="line">eq2 = p*q - n</span><br><span class="line"></span><br><span class="line">solution = solve((eq1,eq2),(p,q))</span><br><span class="line"><span class="built_in">print</span>(solution)</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(solution[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">q = <span class="built_in">int</span>(solution[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<h1 id="三十二、leak-d-p-q"><a href="#三十二、leak-d-p-q" class="headerlink" title="三十二、leak &#x3D; d+p+q"></a>三十二、leak &#x3D; d+p+q</h1><h2 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">d=libnum.invmod(e,(p-1)*(q-1))</span><br><span class="line">leak = d+p+q</span><br><span class="line">print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">#e = 65537</span><br><span class="line">#c = 65194823373091792824101730983124740337276083358867621564067880339279446092377567969207237986613196892737474455781661885696122256698478429450971196633786693648866129636737262041654769618993094832127875251068775632567036646408374963058703320605733921797230106462440860984746880466416824674570639694481298708147</span><br><span class="line">#n = 101929257180069933443442160085713121307068880188090652033345240568607589666231813199686824369361640378636124324844158355533056421197926269617986872835671463371353540696806173813019752742218460997272803573114119876536384486655117245296360474103378827486280279523273344156760793016731778663058274770626116861407</span><br><span class="line">#leak = 87007773233816810147344015772388866522443114032719766646343787373996588014373656496789294836431302130125588646180886383013958151442324020038131736683796464202667423644714259545194662934238144990354387370533656134036753530002005551694211595695927699196016268145816389892292091218491443784193805171731592693841</span><br></pre></td></tr></table></figure>

<p><img src="/../images/RSA/40.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">65194823373091792824101730983124740337276083358867621564067880339279446092377567969207237986613196892737474455781661885696122256698478429450971196633786693648866129636737262041654769618993094832127875251068775632567036646408374963058703320605733921797230106462440860984746880466416824674570639694481298708147</span></span><br><span class="line">n = <span class="number">101929257180069933443442160085713121307068880188090652033345240568607589666231813199686824369361640378636124324844158355533056421197926269617986872835671463371353540696806173813019752742218460997272803573114119876536384486655117245296360474103378827486280279523273344156760793016731778663058274770626116861407</span></span><br><span class="line">leak = <span class="number">87007773233816810147344015772388866522443114032719766646343787373996588014373656496789294836431302130125588646180886383013958151442324020038131736683796464202667423644714259545194662934238144990354387370533656134036753530002005551694211595695927699196016268145816389892292091218491443784193805171731592693841</span></span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(c,leak-n-<span class="number">1</span>,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="三十三、leak-pow-p-q-n-pow-q-p-n-n"><a href="#三十三、leak-pow-p-q-n-pow-q-p-n-n" class="headerlink" title="三十三、leak &#x3D; pow(p,q,n)+pow(q,p,n)%n"></a>三十三、leak &#x3D; pow(p,q,n)+pow(q,p,n)%n</h1><h2 id="例题-5"><a href="#例题-5" class="headerlink" title="例题"></a>例题</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">m=libnum.s2n(flag)</span><br><span class="line">p=libnum.generate_prime(512)</span><br><span class="line">q=libnum.generate_prime(512)</span><br><span class="line"></span><br><span class="line">e = 0x10001</span><br><span class="line">n = p * q</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line">leak = (pow(p, q, n) + pow(q, p, n)) % n</span><br><span class="line">print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">print(f&#x27;&#123;leak = &#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="/../images/RSA/42.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"></span><br><span class="line">p = symbols(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = symbols(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">59662555342583061013008608133060203475725526601468647442902301335538953096485921516133656618941085620436784211565880744663573927593670579237831797055934897166262528476227281479029026508166848256301828084036716500159067642101104810756620735383857351274773983199968924981397675373272878756685629789497697821620</span></span><br><span class="line">n = <span class="number">83332115751539889489689110273690067288993797655970253065863170986174973047785854940017477990345318506407680986257706329521142524295434171889087917406552261883625775754882538291980506944585738241124811588555071095223782766762626040473256423491630224616140407276984106458673447870374272906086783555489477673207</span></span><br><span class="line">leak = <span class="number">18881487897809480964326513919135880296801378921812225600834164247018332292886076618571738627353925482046410714540439662613766662197119044934743578662330528</span></span><br><span class="line"></span><br><span class="line">eq1 = p + q - leak</span><br><span class="line">eq2 = p * q - n</span><br><span class="line"></span><br><span class="line">solution = solve((eq1,eq2),(p,q))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> solution:</span><br><span class="line">    p,q = <span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(i[<span class="number">1</span>])</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<p><strong>考点三十一，三十二，三十三来自2023 数据安全产业人才能力挑战赛—math_exam</strong></p>
<h2 id="2023数据安全产业人才能力挑战赛——math-exam"><a href="#2023数据安全产业人才能力挑战赛——math-exam" class="headerlink" title="2023数据安全产业人才能力挑战赛——math_exam"></a>2023数据安全产业人才能力挑战赛——math_exam</h2><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">bits = 512</span><br><span class="line"></span><br><span class="line">def pad(msg, length):</span><br><span class="line">    pad_length = length - len(msg) - 1</span><br><span class="line">    pad_data = os.urandom(pad_length)</span><br><span class="line">    return msg + b&#x27;\x00&#x27; + pad_data</span><br><span class="line"></span><br><span class="line">def unpad(msg):</span><br><span class="line">    return msg.split(b&quot;\x00&quot;)[0]</span><br><span class="line"></span><br><span class="line">def challenge1(m):</span><br><span class="line">    p, q = [getPrime(bits) for i in range(2)]</span><br><span class="line">    if p &lt;= q:</span><br><span class="line">        p, q = q, p</span><br><span class="line">    e = 0x10001</span><br><span class="line">    n = p * q</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    leak = (n + p) % (q-1)</span><br><span class="line">    print(&#x27;-------- challenge 1 --------&#x27;)</span><br><span class="line">    print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">def challenge2(m):</span><br><span class="line">    p, q = [getPrime(bits) for i in range(2)]</span><br><span class="line">    e = 0x10001</span><br><span class="line">    n = p * q</span><br><span class="line">    d = inverse(e, (p-1)*(q-1))</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    leak = d + p + q</span><br><span class="line">    print(&#x27;-------- challenge 2 --------&#x27;)</span><br><span class="line">    print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">def challenge3(m):</span><br><span class="line">    p, q = [getPrime(bits) for i in range(2)]</span><br><span class="line">    e = 0x10001</span><br><span class="line">    n = p * q</span><br><span class="line">    c = pow(m, e, n)</span><br><span class="line">    leak = (pow(p, q, n) + pow(q, p, n)) % n</span><br><span class="line">    print(&#x27;-------- challenge 3 --------&#x27;)</span><br><span class="line">    print(f&#x27;&#123;e = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;c = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;n = &#125;&#x27;)</span><br><span class="line">    print(f&#x27;&#123;leak = &#125;&#x27;)</span><br><span class="line"></span><br><span class="line">assert len(flag) == 42</span><br><span class="line">ms = []</span><br><span class="line">for i in range(0, 42, 14):</span><br><span class="line">    ms.append(bytes_to_long(pad(flag[i:i+14], bits//4-1)))</span><br><span class="line"></span><br><span class="line">m1, m2, m3 = ms</span><br><span class="line">challenge1(m1)</span><br><span class="line">challenge2(m2)</span><br><span class="line">challenge3(m3)</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">-------- challenge 1 --------</span><br><span class="line">e = 65537</span><br><span class="line">c = 112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span><br><span class="line">n = 121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span><br><span class="line">leak = 216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span><br><span class="line">-------- challenge 2 --------</span><br><span class="line">e = 65537</span><br><span class="line">c = 7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span><br><span class="line">n = 140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span><br><span class="line">leak = 58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span><br><span class="line">-------- challenge 3 --------</span><br><span class="line">e = 65537</span><br><span class="line">c = 54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span><br><span class="line">n = 88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span><br><span class="line">leak = 19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c1 = <span class="number">112742443814287255411540092433156061065388404049949520959549377871297566383025041892192679147481155020865118811016470498351633875090973546567374001852295013083192495299811476604405637385307524194793969533646755764136014187430115618114840780368311166911900457224593131166970676797547489278410997707815915932756</span></span><br><span class="line">n1 = <span class="number">121127425328043404860413278637978444801342472819958112597540188142689720655042880213001676368390521140660355813910726809125567752172921410143437643574528335234973793653775043030021036875866776532570781661875022102733555943967261003246543180935987772711036868216508554536086688819118597075508026787867088355603</span></span><br><span class="line">leak1 = <span class="number">216638862637129382765636503118049146067015523924032194492700294200289728064297722088882791754351329407138196573832392846467607399504585045028165699421278</span></span><br><span class="line"></span><br><span class="line">p1 = symbols(<span class="string">&#x27;p1&#x27;</span>)</span><br><span class="line">q1 = symbols(<span class="string">&#x27;q1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq1 = <span class="number">2</span>*(p1-q1+<span class="number">1</span>)-leak1</span><br><span class="line">eq2 = p1 * q1- n1</span><br><span class="line"></span><br><span class="line">solution1 = solve((eq1,eq2),(p1,q1))</span><br><span class="line"></span><br><span class="line">p1,q1 = <span class="built_in">int</span>(solution1[<span class="number">1</span>][<span class="number">0</span>]),<span class="built_in">int</span>(solution1[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line">d1 = gmpy2.invert(e,(p1-<span class="number">1</span>)*(q1-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n1)</span><br><span class="line">flag1 = long_to_bytes(m1)[:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">c2 = <span class="number">7964477910021153997178145480752641882728907630831216554750778499596527781702830885213467912351097301767341858663701574005489585561370961723264247818377063081744522471774208105250855114831033452448184392499682147532404562876275189577321587660597603848038824026981539659156304028998137796242331160312370913038</span></span><br><span class="line">n2 = <span class="number">140571013522095816880929287025269553867630639381779595547026503691829940612178900269986625350464874598461222087427155791855120339533208468121389480964471710028253589422629569889402475311387750348466199387760629889238062977271925350490110043385800605640905324122017637306715108727700910035925728362455954862209</span></span><br><span class="line">leak2 = <span class="number">58442382248753295429370894053397615609981110383986887405127350139482893508400422595729520437678203735054593866306478994471465948872565590901376309380029015549809468112086393107585011072503638322671608471684607214064187044372418770555236721845694224676090744181562673509234801011420696349507624867568099759003</span></span><br><span class="line"></span><br><span class="line">tmp = leak2 - n2 -<span class="number">1</span></span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,tmp,n2)</span><br><span class="line">flag2 = long_to_bytes(m2)[:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">c3 = <span class="number">54161995127842474543974770981473422085334044100057089719350274921419091368361244533281599379235907845996678762379778310924192757650322930707785543132446159092950451255660204858292974657119337026589911330412367633761103944916751660957776230135927005700707688661350641600954072696774954805514477330339449799540</span></span><br><span class="line">n3 = <span class="number">88207747624007183083381863279444163105330473097729276113333026679597864128605555600000789783468271680476780366740448641311570797876037993255307716167149079618302706650018518487351604778857406170722209469765782625409279109832638886179654096975665134276856272488090272822541461702907181545730309689190333058151</span></span><br><span class="line">leak3 = <span class="number">19596671928335648228117128090384865424885102632642665068992144783391306491716530155291726644158221224616817878768426330717188403310818678195631582453246848</span></span><br><span class="line"></span><br><span class="line">p3 = symbols(<span class="string">&#x27;p3&#x27;</span>)</span><br><span class="line">q3 = symbols(<span class="string">&#x27;q3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">eq3 = p3 + q3 - leak3</span><br><span class="line">eq4 = p3 * q3 - n3</span><br><span class="line"></span><br><span class="line">solution3 = solve((eq3,eq4),(p3,q3))</span><br><span class="line"></span><br><span class="line">p3,q3 = <span class="built_in">int</span>(solution3[<span class="number">0</span>][<span class="number">0</span>]),<span class="built_in">int</span>(solution3[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">d3 = gmpy2.invert(e,(p3-<span class="number">1</span>)*(q3-<span class="number">1</span>))</span><br><span class="line">m3 = <span class="built_in">pow</span>(c3,d3,n3)</span><br><span class="line">flag3 = long_to_bytes(m3)[:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="三十四、扩展欧几里得求逆元d1-d2"><a href="#三十四、扩展欧几里得求逆元d1-d2" class="headerlink" title="三十四、扩展欧几里得求逆元d1-d2"></a>三十四、扩展欧几里得求逆元d1-d2</h1><h2 id="例题-6"><a href="#例题-6" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import uuid</span><br><span class="line">flag = &#x27;flag&#123;&#x27;+str(uuid.uuid4())+&quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">flag1=flag[:21]</span><br><span class="line">flag2=flag[21:]</span><br><span class="line">m1=libnum.s2n(flag1)</span><br><span class="line">m2=libnum.s2n(flag2)</span><br><span class="line"></span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q= getPrime(1024)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-1)*(q-1)</span><br><span class="line">e1 =  getPrime(16)</span><br><span class="line">e2 =  getPrime(16)</span><br><span class="line">d1 =libnum.invmod(e1,phi)</span><br><span class="line">d2 =libnum.invmod(e2,phi)</span><br><span class="line">dd=d2-d1</span><br><span class="line"></span><br><span class="line">c1=pow(m1,e1,n)</span><br><span class="line">c2=pow(m2,e2,n)</span><br><span class="line">print(&quot;c1=&quot;,c1)</span><br><span class="line">print(&quot;c2=&quot;,c2)</span><br><span class="line">print(&quot;n=&quot;,n)</span><br><span class="line">print(&quot;e1=&quot;,e1)</span><br><span class="line">print(&quot;e2=&quot;,e2)</span><br><span class="line">print(&quot;dd=&quot;,dd)</span><br><span class="line">c1= 6733838789459931199058149670308727260843741096811449715444872676794872013183754622858142358860953409090471275056663852093255382831595445093389027611418533073251542228105122098655672243201566013269049673257545950265921334769453660794260369460626145929789420379373117970169521395700109883829930832864801056074877674941597582088285235646759637909087476295147786527873676567410566717421523346422950182870668646809884825822209501435038703929387996244766422894277224634645939878481756200099084364167558964681594043169720137522542692333678325260048812579899748925536673077066928758276593208971988942663469169538691035047694</span><br><span class="line">c2= 8366277709764400685046974874556048480052496413928056769515579166359481224673400489772756573250767790594839615839083763898307048126689342195264524356874243599245090238779605753249119610170611143039424214272370993787185091949643348010978753622976256276642743234789172453774761354256683433570844983636116313586831018168267526012235746840937969827190549583438830654378812487809058974682282579118375227701868159940746116268326846677193441199872518360781657796776416813543201068186698175639943920727192924592723876352818832499607933389909348997360827293372712297925074254469038243598148632369617179529428124887418815513980</span><br><span class="line">n= 18817594671090743657272253762944576150137162885923542977286206265757425414985090758109410978146720356103998948718214270184508716827830409430441234706995168712344420950028012950634922410416769515072316211057242302962478172436850591043456595538065256499508407496097561437670387166881800267145313078814265201339439524924036116421018006462379533497424347501070705658003620710859122307390256199828928801036473297236708659050799043830928526868538891939761670420670258518198985039020439020541730747119429222464031076670255708095414432621713513727172536335364200547007022393362808026249379896670380908869775413898849075996507</span><br><span class="line">e1= 41981</span><br><span class="line">e2= 36209</span><br><span class="line">dd= 1053704841024395437174966126533190981616292415576606812740918909121096916949302531783101209289389200245384407349748603292561596667558819619086001066677101374394170513370717808658925536480708691940905153090874424365353443644389110969859064875481674601586495481715770875127506827571256652900931272013627123620403523296244399421027877414684962334619785788986710188422499709843593365835744664902744928748656403821851709598285463439355756235533416138015740467498790254173390459329436575772984367497189565361716119512393162905231586789553789322178062842452918483776810036444979996001994632844167024771563150952249751416556</span><br></pre></td></tr></table></figure>

<p><img src="/../images/RSA/43.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c1= <span class="number">6733838789459931199058149670308727260843741096811449715444872676794872013183754622858142358860953409090471275056663852093255382831595445093389027611418533073251542228105122098655672243201566013269049673257545950265921334769453660794260369460626145929789420379373117970169521395700109883829930832864801056074877674941597582088285235646759637909087476295147786527873676567410566717421523346422950182870668646809884825822209501435038703929387996244766422894277224634645939878481756200099084364167558964681594043169720137522542692333678325260048812579899748925536673077066928758276593208971988942663469169538691035047694</span></span><br><span class="line">c2= <span class="number">8366277709764400685046974874556048480052496413928056769515579166359481224673400489772756573250767790594839615839083763898307048126689342195264524356874243599245090238779605753249119610170611143039424214272370993787185091949643348010978753622976256276642743234789172453774761354256683433570844983636116313586831018168267526012235746840937969827190549583438830654378812487809058974682282579118375227701868159940746116268326846677193441199872518360781657796776416813543201068186698175639943920727192924592723876352818832499607933389909348997360827293372712297925074254469038243598148632369617179529428124887418815513980</span></span><br><span class="line">n= <span class="number">18817594671090743657272253762944576150137162885923542977286206265757425414985090758109410978146720356103998948718214270184508716827830409430441234706995168712344420950028012950634922410416769515072316211057242302962478172436850591043456595538065256499508407496097561437670387166881800267145313078814265201339439524924036116421018006462379533497424347501070705658003620710859122307390256199828928801036473297236708659050799043830928526868538891939761670420670258518198985039020439020541730747119429222464031076670255708095414432621713513727172536335364200547007022393362808026249379896670380908869775413898849075996507</span></span><br><span class="line">e1= <span class="number">41981</span></span><br><span class="line">e2= <span class="number">36209</span></span><br><span class="line">dd= <span class="number">1053704841024395437174966126533190981616292415576606812740918909121096916949302531783101209289389200245384407349748603292561596667558819619086001066677101374394170513370717808658925536480708691940905153090874424365353443644389110969859064875481674601586495481715770875127506827571256652900931272013627123620403523296244399421027877414684962334619785788986710188422499709843593365835744664902744928748656403821851709598285463439355756235533416138015740467498790254173390459329436575772984367497189565361716119512393162905231586789553789322178062842452918483776810036444979996001994632844167024771563150952249751416556</span></span><br><span class="line"></span><br><span class="line">kphi = dd*e1*e2 + (e2-e1)</span><br><span class="line"></span><br><span class="line">d1 = gmpy2.invert(e1,kphi)</span><br><span class="line">d2 = gmpy2.invert(e2,kphi)</span><br><span class="line"></span><br><span class="line"><span class="comment">#r,d1,_ = gmpy2.gcdext(e1,kphi)			用扩展欧几里得算法求逆元也可</span></span><br><span class="line"><span class="comment">#r,d2,_ = gmpy2.gcdext(e2,kphi)</span></span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1,d1,n)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2,d2,n)</span><br><span class="line">flag = long_to_bytes(m1) + long_to_bytes(m2)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="三十五"><a href="#三十五" class="headerlink" title="三十五"></a>三十五</h1><h1 id="三十六、离散对数c-pow-m-flag-n"><a href="#三十六、离散对数c-pow-m-flag-n" class="headerlink" title="三十六、离散对数c &#x3D; pow(m,flag,n)"></a>三十六、离散对数c &#x3D; pow(m,flag,n)</h1><p>先了解一下什么是离散对数</p>
<h2 id="离散对数的定义"><a href="#离散对数的定义" class="headerlink" title="离散对数的定义"></a>离散对数的定义</h2><p>$$<br>当模n有原根时，设l为模n的一个原根，则当x\equiv l^k(mod \quad n)时:<br>$$</p>
<p>$$<br>Ind_lx \equiv k (mod \quad n),Ind_lx是整数l为底，x为真数，模n的离散对数值<br>$$</p>
<p>我的理解是，离散对数就是求解这个x的值，不过是在整数中求解，而不是在实数中<br>$$<br>a^x \equiv b(mod \quad n)<br>$$<br>详细的看这篇文章：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0">离散对数 - 维基百科，自由的百科全书 (wikipedia.org)</a></p>
<h2 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h2><p>$$<br>对于互素的整数a,m<br>$$</p>
<p>$$<br>假设存在x使得a^x \equiv 1(mod \quad m),且这个x是所有解中最小的，而且x&#x3D;\phi(m)<br>$$</p>
<p>$$<br>此时称a为模m的原根<br>$$</p>
<p>详细的看这篇文章：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-hans/%E5%8E%9F%E6%A0%B9">原根 - 维基百科，自由的百科全书 (wikipedia.org)</a></p>
<h2 id="怎么求解离散对数"><a href="#怎么求解离散对数" class="headerlink" title="怎么求解离散对数"></a>怎么求解离散对数</h2><p><strong>据我了解到</strong><code>sympy.discrete_log(n,a,b)</code><strong>能求解下式的x</strong><br>$$<br>b^x \equiv a(mod \quad n)<br>$$<br>其源码：<a target="_blank" rel="noopener" href="https://github.com/sympy/sympy/blob/d2be7bacd2604e98a642f74028e8f0d7d6084f78/sympy/ntheory/residue_ntheory.py#L1357-L1402">sympy&#x2F;sympy&#x2F;ntheory&#x2F;residue_ntheory.py at d2be7bacd2604e98a642f74028e8f0d7d6084f78 · sympy&#x2F;sympy (github.com)</a></p>
<p><strong>以下是求解普通对数的函数</strong></p>
<table>
<thead>
<tr>
<th align="center">函数</th>
<th align="center">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center">numpy.log(x)</td>
<td align="center">以e为底的对数</td>
</tr>
<tr>
<td align="center">numpy.log10(x)</td>
<td align="center">以10为底的对数</td>
</tr>
<tr>
<td align="center">numpy.log2(x)</td>
<td align="center">以2为底的对数</td>
</tr>
<tr>
<td align="center">numpy.log1p(x)</td>
<td align="center">相当于numpy.log(x+1)</td>
</tr>
<tr>
<td align="center">math.log(x)</td>
<td align="center">以e为底的对数</td>
</tr>
<tr>
<td align="center">math.log10(x)</td>
<td align="center">以10为底的对数</td>
</tr>
<tr>
<td align="center">math.log2(x)</td>
<td align="center">以2为底的对数</td>
</tr>
<tr>
<td align="center">math.log1p(x)</td>
<td align="center">相当于math.log(x+1)</td>
</tr>
</tbody></table>
<p><code>math.log(x,n)</code>：计算以n为底，x为真数的值</p>
<h2 id="例题-7"><a href="#例题-7" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line">import uuid</span><br><span class="line">import random</span><br><span class="line">flag = &quot;flag&#123;&quot; + str(uuid.uuid4()) + &quot;&#125;&quot;</span><br><span class="line">print(flag)</span><br><span class="line">e= libnum.s2n(flag)</span><br><span class="line">n=2**512</span><br><span class="line">m = random.randint(2, n-1) | 1</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&quot;m=&quot;,m)</span><br><span class="line">print(&quot;c=&quot;,c)</span><br><span class="line">m= 159288671018830898156155351952186977642819454341811868237859009749383960869982923115380878290375192847504545108933927464025163205891819917678534983817309</span><br><span class="line">c= 12714803532028941243809606974437987862326521262004726834999494702689747253925210908627215296516631899337657950072189903034513687791841244487330214554784973</span><br></pre></td></tr></table></figure>

<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m= <span class="number">159288671018830898156155351952186977642819454341811868237859009749383960869982923115380878290375192847504545108933927464025163205891819917678534983817309</span></span><br><span class="line">c= <span class="number">12714803532028941243809606974437987862326521262004726834999494702689747253925210908627215296516631899337657950072189903034513687791841244487330214554784973</span></span><br><span class="line">n = <span class="number">2</span>**<span class="number">512</span></span><br><span class="line"></span><br><span class="line">flag = sympy.discrete_log(n,c,m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>



<h1 id="三十七、m-n"><a href="#三十七、m-n" class="headerlink" title="三十七、m &gt; n"></a>三十七、m &gt; n</h1><h2 id="例题-8"><a href="#例题-8" class="headerlink" title="例题"></a>例题</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2 as gp</span><br><span class="line">from secert import flag</span><br><span class="line">assert len(flag)==42</span><br><span class="line">e=0x10001</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">p=getPrime(160)</span><br><span class="line">q=gp.next_prime(p)</span><br><span class="line">n=p*q</span><br><span class="line">c=pow(m,e,n)</span><br><span class="line">print(&#x27;n=&#x27;,n)</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">n= 1938198674432811161450690669878250944830265839396906617662062291196152960227589796372087441130963</span><br><span class="line">c= 90170164274936424192415483102025065297184726282389841586708984518420677588910796600189918035116</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/RSA/44.png"></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n= <span class="number">1938198674432811161450690669878250944830265839396906617662062291196152960227589796372087441130963</span></span><br><span class="line">c= <span class="number">90170164274936424192415483102025065297184726282389841586708984518420677588910796600189918035116</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">t = gmpy2.iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = gmpy2.next_prime(t)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m1 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>,<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    m = m1 + k*n</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<h1 id="三十八、ppp和ppq"><a href="#三十八、ppp和ppq" class="headerlink" title="三十八、ppp和ppq"></a>三十八、ppp和ppq</h1><p>题目：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">flag = b&quot;flag&#123;xxxxxx&#125;&quot;</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">e = 65537</span><br><span class="line">n = p*p*q</span><br><span class="line">t = p*p*p</span><br><span class="line">c = powmod(m, e, n)</span><br><span class="line">print(c)</span><br><span class="line">print(n)</span><br><span class="line">print(t)</span><br><span class="line"></span><br><span class="line"># 695811613220508521533410410135903763704380792345313822348335925535019364085287973391006658091756337941388790850576390425798691514904654108730064898721482454942897809486946732327567166790987988769649339266791907850313832700513155194190805272799105846921535231183458026312210254181900390502309417588847104213793231394168583827484833346266655392107254900891316034825295594615584454126662183967495486871019315836843964142146438253642093949267821928660254775556448682535996878217802620757735862588509198138308229216540912203307177130148261480033848867147610177292359480179993393430101548639801133574244188591918478576785400355882470444135385837723688465703459098247158590332167802098779963168624783522306380012451430590453130321881597629274617390265737278952430391455292129197120724233266227673065462001473529262207830010588159156853973215615518415224386700532070174251781750417203041543631328597659473610199473825400069638203715</span><br><span class="line"># 1103142672269025650462929198164640404493425942265040323371207998377200145961695641048087337404972402560194267711668479433180851107371884950953570911657090487495216386781924343363213345312692741516666557796484628501590914827387171553761258413087800091632213720047678961681727564158606220008125433169164157150198004730103285226539823741065685538894369776994256049396334124080247371292445543852118777801692107831636409684364527162627188519199064013189168290873007156380530155343171815296016451575866508168728518236121071519646489851701773457562537221387306293985011019040423572239157745630631563892081210964602524396761067561161422635793249097955070576281428534742447903449072401000345617064665752070967341863838984791405144869303448662169933201623421080650216122814985967041163663854812030159367202820911939914186148267664571396203542821594364250609009816872825447917845472311564561269905225280796615586133341770795940714518373</span><br><span class="line"># 1352157133681616199949626085859887520183044653936717410198546937928330648087119395184417755928058157424764679366526294873446661771336360719004981235527982326342186212780230888122434477779310176780131887691097470115061291877918798366484343129280364265571974776435297187299058517674913907506344826320352532394679559865918025267583173757096064690288877037701829014463065076789753953054738098985305066307636180043889030783678919407771611169741555877144593927382649961986384716532446388338376466150688150609936293316903617335385558920141250240529204636396228961938978325120385146208552506658553610353813640686759609897131817533377973931149277140553678119548578402674858651748611808600372129132750796909828079961432457264127651812438564831345298563698676305419952826466259729378236885089128224289161328570151277873778313473830713469181909893871432564345696475759124658962121070495959528237764331872929513704863754771030741820729657</span><br></pre></td></tr></table></figure>

<p><strong>把t开根号就能得到p，然后就是解RSA</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">695811613220508521533410410135903763704380792345313822348335925535019364085287973391006658091756337941388790850576390425798691514904654108730064898721482454942897809486946732327567166790987988769649339266791907850313832700513155194190805272799105846921535231183458026312210254181900390502309417588847104213793231394168583827484833346266655392107254900891316034825295594615584454126662183967495486871019315836843964142146438253642093949267821928660254775556448682535996878217802620757735862588509198138308229216540912203307177130148261480033848867147610177292359480179993393430101548639801133574244188591918478576785400355882470444135385837723688465703459098247158590332167802098779963168624783522306380012451430590453130321881597629274617390265737278952430391455292129197120724233266227673065462001473529262207830010588159156853973215615518415224386700532070174251781750417203041543631328597659473610199473825400069638203715</span></span><br><span class="line">n = <span class="number">1103142672269025650462929198164640404493425942265040323371207998377200145961695641048087337404972402560194267711668479433180851107371884950953570911657090487495216386781924343363213345312692741516666557796484628501590914827387171553761258413087800091632213720047678961681727564158606220008125433169164157150198004730103285226539823741065685538894369776994256049396334124080247371292445543852118777801692107831636409684364527162627188519199064013189168290873007156380530155343171815296016451575866508168728518236121071519646489851701773457562537221387306293985011019040423572239157745630631563892081210964602524396761067561161422635793249097955070576281428534742447903449072401000345617064665752070967341863838984791405144869303448662169933201623421080650216122814985967041163663854812030159367202820911939914186148267664571396203542821594364250609009816872825447917845472311564561269905225280796615586133341770795940714518373</span></span><br><span class="line">t = <span class="number">1352157133681616199949626085859887520183044653936717410198546937928330648087119395184417755928058157424764679366526294873446661771336360719004981235527982326342186212780230888122434477779310176780131887691097470115061291877918798366484343129280364265571974776435297187299058517674913907506344826320352532394679559865918025267583173757096064690288877037701829014463065076789753953054738098985305066307636180043889030783678919407771611169741555877144593927382649961986384716532446388338376466150688150609936293316903617335385558920141250240529204636396228961938978325120385146208552506658553610353813640686759609897131817533377973931149277140553678119548578402674858651748611808600372129132750796909828079961432457264127651812438564831345298563698676305419952826466259729378236885089128224289161328570151277873778313473830713469181909893871432564345696475759124658962121070495959528237764331872929513704863754771030741820729657</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(t,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">q = n // p**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">phi = (p**<span class="number">2</span>-p)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,(phi))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;Now_u_kn0w_GCD_and_s1mpl3_RSA&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="三十九、扩展中国剩余定理"><a href="#三十九、扩展中国剩余定理" class="headerlink" title="三十九、扩展中国剩余定理"></a>三十九、扩展中国剩余定理</h1><h2 id="1-求d"><a href="#1-求d" class="headerlink" title="1.求d"></a>1.求d</h2><h3 id="例题-9"><a href="#例题-9" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">q = getPrime(512)</span><br><span class="line">r = getPrime(512)</span><br><span class="line">e = getPrime(32)</span><br><span class="line">print(e)</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-1)*(q-1)*(r-1)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">dp = d%((q-1)*(r-1))</span><br><span class="line">dq = d%((p-1)*(r-1))</span><br><span class="line">dr = d%((p-1)*(q-1))</span><br><span class="line">flag = &#x27;flag&#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#125;&#x27;</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line"></span><br><span class="line">print(p)</span><br><span class="line">print(q)</span><br><span class="line">print(r)</span><br><span class="line">print(dp)</span><br><span class="line">print(dq)</span><br><span class="line">print(dr)</span><br><span class="line">print(c)</span><br><span class="line"></span><br><span class="line">p=12922128058767029848676385650461975663483632970994721128398090402671357430399910236576943902580268365115559040908171487273491136108931171215963673857907721</span><br><span class="line">q=10395910293559541454979782434227114401257890224810826672485874938639616819909368963527556812339196570118998080877100587760101646884011742783881592586607483</span><br><span class="line">r=8104533688439480164488403019957173637520526666352540480766865791142556044817828133446063428255474375204188144310967625626318466189746446739697284656837499</span><br><span class="line">dp=73360412924315743410612858109886169233122608813546859531995431159702281180116580962235297605024326120716590757069707814371806343766956894408106019058184354279568525768909190843389534908163730972765221403797428735591146943727032277163147380538250142612444372315262195455266292156566943804557623319253942627829</span><br><span class="line">dq=40011003982913118920477233564329052389422276107266243287367766124357736739027781899850422097218506350119257015460291153483339485727984512959771805645640899525080850525273304988145509506962755664208407488807873672040970416096459662677968243781070751482234692575943914243633982505045357475070019527351586080273</span><br><span class="line">dr=21504040939112983125383942214187695383459556831904800061168077060846983552476434854825475457749096404504088696171780970907072305495623953811379179449789142049817703543458498244186699984858401903729236362439659600561895931051597248170420055792553353578915848063216831827095100173180270649367917678965552672673</span><br><span class="line">c=220428832901130282093087304800127910055992783874826238869471313726515822196746908777026147887315019800546695346099376727742597231512404648514329911088048902389321230640565683145565701498095660019604419213310866468276943241155853029934366950674139215056682438149221374543291202295130547776549069333898123270448986380025937093195496539532193583979030254746589985556996040224572481200667498253900563663950531345601763949337787268884688982469744380006435119997310653</span><br></pre></td></tr></table></figure>

<p>$$<br>用中国剩余定理解\<br>\left{\begin{matrix}<br>dp \equiv d \mod (q-1)(r-1)\<br>dq \equiv d \mod (p-1)(r-1)\<br>dr \equiv d \mod (p-1)(q-1)<br>\end{matrix}\right.<br>$$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">12922128058767029848676385650461975663483632970994721128398090402671357430399910236576943902580268365115559040908171487273491136108931171215963673857907721</span></span><br><span class="line">q=<span class="number">10395910293559541454979782434227114401257890224810826672485874938639616819909368963527556812339196570118998080877100587760101646884011742783881592586607483</span></span><br><span class="line">r=<span class="number">8104533688439480164488403019957173637520526666352540480766865791142556044817828133446063428255474375204188144310967625626318466189746446739697284656837499</span></span><br><span class="line">dp=<span class="number">73360412924315743410612858109886169233122608813546859531995431159702281180116580962235297605024326120716590757069707814371806343766956894408106019058184354279568525768909190843389534908163730972765221403797428735591146943727032277163147380538250142612444372315262195455266292156566943804557623319253942627829</span></span><br><span class="line">dq=<span class="number">40011003982913118920477233564329052389422276107266243287367766124357736739027781899850422097218506350119257015460291153483339485727984512959771805645640899525080850525273304988145509506962755664208407488807873672040970416096459662677968243781070751482234692575943914243633982505045357475070019527351586080273</span></span><br><span class="line">dr=<span class="number">21504040939112983125383942214187695383459556831904800061168077060846983552476434854825475457749096404504088696171780970907072305495623953811379179449789142049817703543458498244186699984858401903729236362439659600561895931051597248170420055792553353578915848063216831827095100173180270649367917678965552672673</span></span><br><span class="line">c=<span class="number">220428832901130282093087304800127910055992783874826238869471313726515822196746908777026147887315019800546695346099376727742597231512404648514329911088048902389321230640565683145565701498095660019604419213310866468276943241155853029934366950674139215056682438149221374543291202295130547776549069333898123270448986380025937093195496539532193583979030254746589985556996040224572481200667498253900563663950531345601763949337787268884688982469744380006435119997310653</span></span><br><span class="line"></span><br><span class="line">b1 = (q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">b2 = (p-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">b3 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = crt([b1,b2,b3],[dp,dq,dr])	<span class="comment">#crt([模],[余数])</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d)):</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d[i],p*q*r)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment">#DASCTF&#123;8ec820e5251db6e7a1758543a1123824&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-求c"><a href="#2-求c" class="headerlink" title="2.求c"></a>2.求c</h2><h3 id="例题-10"><a href="#例题-10" class="headerlink" title="例题"></a>例题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line"># from secret import flag</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">table=&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">pad=100-len(flag)</span><br><span class="line">for i in range(pad):</span><br><span class="line">    flag+=random.choice(table).encode()</span><br><span class="line">e=343284449</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">assert m&gt;(1&lt;&lt;512)</span><br><span class="line">assert m&lt;(1&lt;&lt;1024)</span><br><span class="line">p=getPrime(512)</span><br><span class="line">q=getPrime(512)</span><br><span class="line">r=getPrime(512)</span><br><span class="line">print(&#x27;p=&#x27;,p)</span><br><span class="line">print(&#x27;q=&#x27;,q)</span><br><span class="line">print(&#x27;r=&#x27;,r)</span><br><span class="line">n1=p*q</span><br><span class="line">n2=q*r</span><br><span class="line">c1=pow(m,e,n1)</span><br><span class="line">c2=pow(m,e,n2)</span><br><span class="line">print(&#x27;c1=&#x27;,c1)</span><br><span class="line">print(&#x27;c2=&#x27;,c2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p= 11820891196647569262137841192985418014377132106496147254821784946481523526822939129065042819464351666077658751406165276121125571355594004514547517855730743</span><br><span class="line">q= 10450390015864176713581330969519712299844487112687677452105216477861582967322473997670559995588440097951786576039009337782247912476227937589298529580432797</span><br><span class="line">r= 9484954066160968219229920429258150817546418633451929876581842443665029377287119340232501682142185708534413073877473741393278935479791561681402673403009771</span><br><span class="line"></span><br><span class="line">c1= 69574855207460025252857869494766338442370688922127811393280455950372371842144946699073877876005649281006116543528211809466226185922844601714337317797534664683681334132261584497953105754257846471069875622054326463757746293958069752489458646460121725019594141157667480846709081917530190233900184428943585065316</span><br><span class="line">c2= 66183492015178047844987766781469734325646160179923242098082430373061510938987908656007752256556018402101435698352339429316390909525615464024332856855411414576031970267795270882896721069952171988506477519737923165566896609181813523905810373359029413963666924039857159685161563252396502381297700252749204993228</span><br></pre></td></tr></table></figure>

<p>$$<br>先用中国剩余定理解出c\<br>得到的这个c是满足c \equiv m^e \mod lcm(n_1,n_2)\<br>即c \equiv m^e \mod pqr\<br>推出c \equiv m^e \mod pr<br>$$</p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p= <span class="number">11820891196647569262137841192985418014377132106496147254821784946481523526822939129065042819464351666077658751406165276121125571355594004514547517855730743</span></span><br><span class="line">q= <span class="number">10450390015864176713581330969519712299844487112687677452105216477861582967322473997670559995588440097951786576039009337782247912476227937589298529580432797</span></span><br><span class="line">r= <span class="number">9484954066160968219229920429258150817546418633451929876581842443665029377287119340232501682142185708534413073877473741393278935479791561681402673403009771</span></span><br><span class="line">e= <span class="number">343284449</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c1= <span class="number">69574855207460025252857869494766338442370688922127811393280455950372371842144946699073877876005649281006116543528211809466226185922844601714337317797534664683681334132261584497953105754257846471069875622054326463757746293958069752489458646460121725019594141157667480846709081917530190233900184428943585065316</span></span><br><span class="line">c2= <span class="number">66183492015178047844987766781469734325646160179923242098082430373061510938987908656007752256556018402101435698352339429316390909525615464024332856855411414576031970267795270882896721069952171988506477519737923165566896609181813523905810373359029413963666924039857159685161563252396502381297700252749204993228</span></span><br><span class="line"></span><br><span class="line">n1 = p*q</span><br><span class="line">n2 = q*r</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = crt([n1,n2],[c1,c2])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    n = p*r</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c[i],d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><strong>解密的时候适当化简一下？</strong></p>
<h1 id="四十、e和phi不互素，用中国剩余定理"><a href="#四十、e和phi不互素，用中国剩余定理" class="headerlink" title="四十、e和phi不互素，用中国剩余定理"></a>四十、e和phi不互素，用中国剩余定理</h1>
    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Dexter
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/07/09/RSA3/" title="RSA3">https://dexterjie.github.io/2023/07/09/RSA3/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/RSA/" rel="tag"># RSA</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/07/09/RSA2/" rel="prev" title="RSA2">
                  <i class="fa fa-chevron-left"></i> RSA2
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/07/10/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81-%E4%BB%A3%E6%8D%A2%E5%AF%86%E7%A0%81/" rel="next" title="古典密码-代换密码">
                  古典密码-代换密码 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dexter</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">70k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:15</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->

<!-- <br /> -->
<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<!-- <span id="times">载入时分秒...</span> -->
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("11/17/2022 8:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); 
        if(String(snum).length ==1 ){snum = "0" + snum;}
        // var times = document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "+hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>
<span id="busuanzi_container_site_uv">
  本站访问次数：<span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>



  
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
