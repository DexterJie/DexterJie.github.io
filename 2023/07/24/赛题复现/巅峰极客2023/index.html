<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="复现巅峰极客2023密码方向赛题">
<meta property="og:type" content="article">
<meta property="og:title" content="巅峰极客2023——Crypto">
<meta property="og:url" content="https://dexterjie.github.io/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="复现巅峰极客2023密码方向赛题">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/5.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/6.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/7.png">
<meta property="og:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/8.png">
<meta property="article:published_time" content="2023-07-24T04:07:35.000Z">
<meta property="article:modified_time" content="2023-08-17T13:35:03.958Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/0.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/","path":"2023/07/24/赛题复现/巅峰极客2023/","title":"巅峰极客2023——Crypto"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>巅峰极客2023——Crypto | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Simple-encryption"><span class="nav-number">1.</span> <span class="nav-text">Simple_encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#part1"><span class="nav-number">1.1.</span> <span class="nav-text">part1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#part2"><span class="nav-number">1.2.</span> <span class="nav-text">part2</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E4%BD%86%E9%AB%98%E4%B8%AD"><span class="nav-number">2.</span> <span class="nav-text">数学但高中</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Rosita"><span class="nav-number">3.</span> <span class="nav-text">Rosita</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#First"><span class="nav-number">3.1.</span> <span class="nav-text">First</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Second"><span class="nav-number">3.2.</span> <span class="nav-text">Second</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%91%E7%9A%84%E7%90%86%E8%A7%A3"><span class="nav-number">3.2.1.</span> <span class="nav-text">我的理解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Thrid"><span class="nav-number">3.3.</span> <span class="nav-text">Thrid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#exp"><span class="nav-number">3.4.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">81</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="巅峰极客2023——Crypto | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          巅峰极客2023——Crypto
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-07-24 12:07:35" itemprop="dateCreated datePublished" datetime="2023-07-24T12:07:35+08:00">2023-07-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-17 21:35:03" itemprop="dateModified" datetime="2023-08-17T21:35:03+08:00">2023-08-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Wp/" itemprop="url" rel="index"><span itemprop="name">Wp</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>8 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>复现巅峰极客2023密码方向赛题</p>
<span id="more"></span>

<h1 id="Simple-encryption"><a href="#Simple-encryption" class="headerlink" title="Simple_encryption"></a>Simple_encryption</h1><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import gmpy2</span><br><span class="line">import random</span><br><span class="line">import binascii</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">g, r1, r2 = [getRandomRange(1, N) for _ in range(3)]</span><br><span class="line">g1 = pow(g, r1 * (p - 1), N)</span><br><span class="line">g2 = pow(g, r2 * (q - 1), N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encrypt(m):</span><br><span class="line">    s1, s2 = [getRandomRange(1, N) for _ in range(2)]</span><br><span class="line">    c1 = (m * pow(g1, s1, N)) % N</span><br><span class="line">    c2 = (m * pow(g2, s2, N)) % N</span><br><span class="line">    print(&quot;c1=&quot;, c1)</span><br><span class="line">    print(&quot;c2=&quot;, c2)</span><br><span class="line">    return (c1, c2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = encrypt(bytes_to_long(flag[:len(flag) // 2]))</span><br><span class="line">print(&#x27;N=&#x27;, N)</span><br><span class="line">print(&#x27;g1=&#x27;, g1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def pad(msg, length):</span><br><span class="line">    l = len(msg)</span><br><span class="line">    return msg + (length - l) * chr(length - l).encode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">assert (p != q)</span><br><span class="line">n = p * q</span><br><span class="line">e = 5</span><br><span class="line">d = inverse(e, (p - 1) * (q - 1))</span><br><span class="line">assert (e * d % (p - 1) * (q - 1))</span><br><span class="line"></span><br><span class="line">flag = pad(flag[len(flag) // 2:], 48)</span><br><span class="line">m = [int(binascii.b2a_hex(flag[i * 16:i * 16 + 16]).decode(&#x27;utf-8&#x27;), 16) for i in range(3)]</span><br><span class="line">print(&#x27;S=&#x27;, sum(m) % n)</span><br><span class="line">cnt = len(m)</span><br><span class="line">A = [(i + 128) ** 2 for i in range(cnt)]</span><br><span class="line">B = [(i + 1024) for i in range(cnt)]</span><br><span class="line">C = [(i + 512) for i in range(cnt)]</span><br><span class="line">Cs = [int(pow((A[i] * m[i] ** 2 + B[i] * m[i] + C[i]), e, n)) for i in range(cnt)]</span><br><span class="line">print(&#x27;N=&#x27;, n)</span><br><span class="line">print(&#x27;e=&#x27;, e)</span><br><span class="line">print(&#x27;Cs=&#x27;, Cs)</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c1= 19024563955839349902897822692180949371550067644378624199902067434708278125346234824900117853598997270022872667319428613147809325929092749312310446754419305096891122211944442338664613779595641268298482084259741784281927857614814220279055840825157115551456554287395502655358453270843601870807174309121367449335110327991187235786798374254470758957844690258594070043388827157981964323699747450405814713722613265012947852856714100237325256114904705539465145676960232769502207049858752573601516773952294218843901330100257234517481221811887136295727396712894842769582824157206825592614684804626241036297918244781918275524254</span><br><span class="line">c2= 11387447548457075057390997630590504043679006922775566653728699416828036980076318372839900947303061300878930517069527835771992393657157069014534366482903388936689298175411163666849237525549902527846826224853407226289495201341719277080550962118551001246017511651688883675152554449310329664415179464488725227120033786305900106544217117526923607211746947511746335071162308591288281572603417532523345271340113176743703809868369623401559713179927002634217140206608963086656140258643119596968929437114459557916757824682496866029297120246221557017875892921591955181714167913310050483382235498906247018171409256534124073270350</span><br><span class="line">N= 21831630625212912450058787218272832615084640356500740162478776482071876178684642739065105728423872548532056206845637492058465613779973193354996353323494373418215019445325632104575415991984764454753263189235376127871742444636236132111097548997063091478794422370043984009615893441148901566420508196170556189546911391716595983110030778046242014896752388438535131806524968952947016059907135882390507706966746973544598457963945671064540465259211834751973065197550500334726779434679470160463944292619173904064826217284899341554269864669620477774678605962276256707036721407638013951236957603286867871199275024050690034901963</span><br><span class="line">g1= 20303501619435729000675510820217420636246553663472832286487504757515586157679361170332171306491820918722752848685645096611030558245362578422584797889428493611704976472409942840368080016946977234874471779189922713887914075985648876516896823599078349725871578446532134614410886658001724864915073768678394238725788245439086601955497248593286832679485832319756671985505398841701463782272300202981842733576006152153012355980197830911700112001441621619417349747262257225469106511527467526286661082010163334100555372381681421874165851063816598907314117035131618062582953512203870615406642787786668571083042463072230605649134</span><br><span class="line">S= 234626762558445335519229319778735528295</span><br><span class="line">N= 28053749721930780797243137464055357921262616541619976645795810707701031602793034889886420385567169222962145128498131170577184276590698976531070900776293344109534005057067680663813430093397821366071365221453788763262381958185404224319153945950416725302184077952893435265051402645871699132910860011753502307815457636525137171681463817731190311682277171396235160056504317959832747279317829283601814707551094074778796108136141845755357784361312469124392408642823375413433759572121658646203123677327551421440655322226192031542368496829102050186550793124020718643243789525477209493783347317576783265671566724068427349961101</span><br><span class="line">e= 5</span><br><span class="line">Cs= [1693447496400753735762426750097282582203894511485112615865753001679557182840033040705025720548835476996498244081423052953952745813186793687790496086492136043098444304128963237489862776988389256298142843070384268907160020751319313970887199939345096232529143204442168808703063568295924663998456534264361495136412078324133263733409362366768460625508816378362979251599475109499727808021609000751360638976, 2240772849203381534975484679127982642973364801722576637731411892969654368457130801503103210570803728830063876118483596474389109772469014349453490395147031665061733965097301661933389406031214242680246638201663845183194937353509302694926811282026475913703306789097162693368337210584494881249909346643289510493724709324540062077619696056842225526183938442535866325407085768724148771697260859350213678910949, 5082341111246153817896279104775187112534431783418388292800705085458704665057344175657566751627976149342406406594179073777431676597641200321859622633948317181914562670909686170531929552301852027606377778515019377168677204310642500744387041601260593120417053741977533047412729373182842984761689443959266049421034949822673159561609487404082536872314636928727833394518122974630386280495027169465342976]</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>flag分成了两段进行加密</p>
<h2 id="part1"><a href="#part1" class="headerlink" title="part1"></a>part1</h2><p>$$<br>\because g_1 \equiv g^{r_1(p-1)} \mod N<br>$$</p>
<p>$$<br>\therefore g_1 &#x3D; g^{r_1(p-1)}+kN<br>$$</p>
<p>$$<br>两边同模p得：<br>$$</p>
<p>$$<br>g_1 \equiv g^{r_1(p-1)} \mod p<br>$$</p>
<p>$$<br>由费马定理得:<br>$$</p>
<p>$$<br>g_1 \equiv 1 \mod p<br>$$</p>
<p>$$<br>\therefore kp &#x3D; g_1 - 1<br>$$</p>
<p><strong>通过kp和N求出p,q</strong><br>$$<br>又\because c_1 \equiv m×(g_1^{s_1} \mod N) \mod N<br>$$</p>
<p>$$<br>\therefore c_1 &#x3D; (m×(g_1^{s_1} + k_1N))+k_2N<br>$$</p>
<p>$$<br>\therefore c_1 &#x3D; mg_1^{s_1}+k_1mN + k_2N<br>$$</p>
<p>$$<br>两边同模p得:<br>$$</p>
<p>$$<br>c_1 \equiv mg_1^{s_1} \mod p<br>$$</p>
<p>$$<br>即c_1 \equiv (m \mod p)×(g_1^{s_1} \mod p) \mod p<br>$$</p>
<p>$$<br>又\because 1 \equiv g_1^{s_1} \mod p<br>$$</p>
<p>$$<br>\therefore c_1 \equiv m \mod p<br>$$</p>
<h2 id="part2"><a href="#part2" class="headerlink" title="part2"></a>part2</h2><p>解方程就行<br>$$<br>\because (A_im_i^2+B_im_i+C)^5 \equiv Cs_i \mod n<br>$$<br>$$<br>先对Cs_i开根号后<br>$$</p>
<p>$$<br>分别解3个方程:<br>$$</p>
<p>$$<br>A_ix^2+B_ix+C &#x3D; tep<br>$$</p>
<p>$$<br>其中tmp &#x3D; Cs_i^{\frac{1}{5}}<br>$$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"></span><br><span class="line">c1= <span class="number">19024563955839349902897822692180949371550067644378624199902067434708278125346234824900117853598997270022872667319428613147809325929092749312310446754419305096891122211944442338664613779595641268298482084259741784281927857614814220279055840825157115551456554287395502655358453270843601870807174309121367449335110327991187235786798374254470758957844690258594070043388827157981964323699747450405814713722613265012947852856714100237325256114904705539465145676960232769502207049858752573601516773952294218843901330100257234517481221811887136295727396712894842769582824157206825592614684804626241036297918244781918275524254</span></span><br><span class="line">c2= <span class="number">11387447548457075057390997630590504043679006922775566653728699416828036980076318372839900947303061300878930517069527835771992393657157069014534366482903388936689298175411163666849237525549902527846826224853407226289495201341719277080550962118551001246017511651688883675152554449310329664415179464488725227120033786305900106544217117526923607211746947511746335071162308591288281572603417532523345271340113176743703809868369623401559713179927002634217140206608963086656140258643119596968929437114459557916757824682496866029297120246221557017875892921591955181714167913310050483382235498906247018171409256534124073270350</span></span><br><span class="line">N= <span class="number">21831630625212912450058787218272832615084640356500740162478776482071876178684642739065105728423872548532056206845637492058465613779973193354996353323494373418215019445325632104575415991984764454753263189235376127871742444636236132111097548997063091478794422370043984009615893441148901566420508196170556189546911391716595983110030778046242014896752388438535131806524968952947016059907135882390507706966746973544598457963945671064540465259211834751973065197550500334726779434679470160463944292619173904064826217284899341554269864669620477774678605962276256707036721407638013951236957603286867871199275024050690034901963</span></span><br><span class="line">g1= <span class="number">20303501619435729000675510820217420636246553663472832286487504757515586157679361170332171306491820918722752848685645096611030558245362578422584797889428493611704976472409942840368080016946977234874471779189922713887914075985648876516896823599078349725871578446532134614410886658001724864915073768678394238725788245439086601955497248593286832679485832319756671985505398841701463782272300202981842733576006152153012355980197830911700112001441621619417349747262257225469106511527467526286661082010163334100555372381681421874165851063816598907314117035131618062582953512203870615406642787786668571083042463072230605649134</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(g1-<span class="number">1</span>,N)</span><br><span class="line">q = N // p </span><br><span class="line">m = c1 % p</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="comment">#print(long_to_bytes(m))</span></span><br><span class="line"></span><br><span class="line">N= <span class="number">28053749721930780797243137464055357921262616541619976645795810707701031602793034889886420385567169222962145128498131170577184276590698976531070900776293344109534005057067680663813430093397821366071365221453788763262381958185404224319153945950416725302184077952893435265051402645871699132910860011753502307815457636525137171681463817731190311682277171396235160056504317959832747279317829283601814707551094074778796108136141845755357784361312469124392408642823375413433759572121658646203123677327551421440655322226192031542368496829102050186550793124020718643243789525477209493783347317576783265671566724068427349961101</span></span><br><span class="line">e= <span class="number">5</span></span><br><span class="line">Cs= [<span class="number">1693447496400753735762426750097282582203894511485112615865753001679557182840033040705025720548835476996498244081423052953952745813186793687790496086492136043098444304128963237489862776988389256298142843070384268907160020751319313970887199939345096232529143204442168808703063568295924663998456534264361495136412078324133263733409362366768460625508816378362979251599475109499727808021609000751360638976</span>, <span class="number">2240772849203381534975484679127982642973364801722576637731411892969654368457130801503103210570803728830063876118483596474389109772469014349453490395147031665061733965097301661933389406031214242680246638201663845183194937353509302694926811282026475913703306789097162693368337210584494881249909346643289510493724709324540062077619696056842225526183938442535866325407085768724148771697260859350213678910949</span>, <span class="number">5082341111246153817896279104775187112534431783418388292800705085458704665057344175657566751627976149342406406594179073777431676597641200321859622633948317181914562670909686170531929552301852027606377778515019377168677204310642500744387041601260593120417053741977533047412729373182842984761689443959266049421034949822673159561609487404082536872314636928727833394518122974630386280495027169465342976</span>]</span><br><span class="line">A = [(i + <span class="number">128</span>) ** <span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">B = [(i + <span class="number">1024</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">C = [(i + <span class="number">512</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">tmp = [gmpy2.iroot(i,<span class="number">5</span>)[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> Cs]</span><br><span class="line"></span><br><span class="line">x1 = symbols(<span class="string">&#x27;x1&#x27;</span>)</span><br><span class="line">x2 = symbols(<span class="string">&#x27;x2&#x27;</span>)</span><br><span class="line">x3 = symbols(<span class="string">&#x27;x3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">eq1 = A[<span class="number">0</span>]*x1**<span class="number">2</span> + B[<span class="number">0</span>]*x1 + C[<span class="number">0</span>]-tmp[<span class="number">0</span>]</span><br><span class="line">eq2 = A[<span class="number">1</span>]*x2**<span class="number">2</span> + B[<span class="number">1</span>]*x2 + C[<span class="number">1</span>]-tmp[<span class="number">1</span>]</span><br><span class="line">eq3 = A[<span class="number">2</span>]*x3**<span class="number">2</span> + B[<span class="number">2</span>]*x3 + C[<span class="number">2</span>]-tmp[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">x1 = solve(eq1,x1)</span><br><span class="line">x2 = solve(eq2,x2)</span><br><span class="line">x3 = solve(eq3,x3)</span><br><span class="line"><span class="comment">#print(x1,x2,x3,sep=&#x27;\n&#x27;)</span></span><br><span class="line">flag = flag +long_to_bytes(x1[<span class="number">1</span>]) + long_to_bytes(x2[<span class="number">1</span>]) + long_to_bytes(x3[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>



<p>sagemath:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">c1= 19024563955839349902897822692180949371550067644378624199902067434708278125346234824900117853598997270022872667319428613147809325929092749312310446754419305096891122211944442338664613779595641268298482084259741784281927857614814220279055840825157115551456554287395502655358453270843601870807174309121367449335110327991187235786798374254470758957844690258594070043388827157981964323699747450405814713722613265012947852856714100237325256114904705539465145676960232769502207049858752573601516773952294218843901330100257234517481221811887136295727396712894842769582824157206825592614684804626241036297918244781918275524254</span><br><span class="line">c2= 11387447548457075057390997630590504043679006922775566653728699416828036980076318372839900947303061300878930517069527835771992393657157069014534366482903388936689298175411163666849237525549902527846826224853407226289495201341719277080550962118551001246017511651688883675152554449310329664415179464488725227120033786305900106544217117526923607211746947511746335071162308591288281572603417532523345271340113176743703809868369623401559713179927002634217140206608963086656140258643119596968929437114459557916757824682496866029297120246221557017875892921591955181714167913310050483382235498906247018171409256534124073270350</span><br><span class="line">N= 21831630625212912450058787218272832615084640356500740162478776482071876178684642739065105728423872548532056206845637492058465613779973193354996353323494373418215019445325632104575415991984764454753263189235376127871742444636236132111097548997063091478794422370043984009615893441148901566420508196170556189546911391716595983110030778046242014896752388438535131806524968952947016059907135882390507706966746973544598457963945671064540465259211834751973065197550500334726779434679470160463944292619173904064826217284899341554269864669620477774678605962276256707036721407638013951236957603286867871199275024050690034901963</span><br><span class="line">g1= 20303501619435729000675510820217420636246553663472832286487504757515586157679361170332171306491820918722752848685645096611030558245362578422584797889428493611704976472409942840368080016946977234874471779189922713887914075985648876516896823599078349725871578446532134614410886658001724864915073768678394238725788245439086601955497248593286832679485832319756671985505398841701463782272300202981842733576006152153012355980197830911700112001441621619417349747262257225469106511527467526286661082010163334100555372381681421874165851063816598907314117035131618062582953512203870615406642787786668571083042463072230605649134</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(g1-1,N)</span><br><span class="line">m = c1 % p</span><br><span class="line">flag = libnum.n2s(int(m))</span><br><span class="line"># print(flag)</span><br><span class="line"></span><br><span class="line">S= 234626762558445335519229319778735528295</span><br><span class="line">n= 28053749721930780797243137464055357921262616541619976645795810707701031602793034889886420385567169222962145128498131170577184276590698976531070900776293344109534005057067680663813430093397821366071365221453788763262381958185404224319153945950416725302184077952893435265051402645871699132910860011753502307815457636525137171681463817731190311682277171396235160056504317959832747279317829283601814707551094074778796108136141845755357784361312469124392408642823375413433759572121658646203123677327551421440655322226192031542368496829102050186550793124020718643243789525477209493783347317576783265671566724068427349961101</span><br><span class="line">e= 5</span><br><span class="line">Cs= [1693447496400753735762426750097282582203894511485112615865753001679557182840033040705025720548835476996498244081423052953952745813186793687790496086492136043098444304128963237489862776988389256298142843070384268907160020751319313970887199939345096232529143204442168808703063568295924663998456534264361495136412078324133263733409362366768460625508816378362979251599475109499727808021609000751360638976, 2240772849203381534975484679127982642973364801722576637731411892969654368457130801503103210570803728830063876118483596474389109772469014349453490395147031665061733965097301661933389406031214242680246638201663845183194937353509302694926811282026475913703306789097162693368337210584494881249909346643289510493724709324540062077619696056842225526183938442535866325407085768724148771697260859350213678910949, 5082341111246153817896279104775187112534431783418388292800705085458704665057344175657566751627976149342406406594179073777431676597641200321859622633948317181914562670909686170531929552301852027606377778515019377168677204310642500744387041601260593120417053741977533047412729373182842984761689443959266049421034949822673159561609487404082536872314636928727833394518122974630386280495027169465342976]</span><br><span class="line"></span><br><span class="line">A = [(i + 128) ** 2 for i in range(3)]</span><br><span class="line">B = [(i + 1024) for i in range(3)]</span><br><span class="line">C = [(i + 512) for i in range(3)]</span><br><span class="line">tmp = [int(gmpy2.iroot(i,5)[0]) for i in Cs]</span><br><span class="line"></span><br><span class="line">R.&lt;x1&gt; = Zmod()[]</span><br><span class="line">R.&lt;x2&gt; = Zmod()[]</span><br><span class="line">R.&lt;x3&gt; = Zmod()[]</span><br><span class="line"></span><br><span class="line">f1 = A[0]*x1**2 + B[0]*x1 + C[0]-tmp[0]</span><br><span class="line">f2 = A[1]*x2**2 + B[1]*x2 + C[1]-tmp[1]</span><br><span class="line">f3 = A[2]*x3**2 + B[2]*x3 + C[2]-tmp[2]</span><br><span class="line"></span><br><span class="line">x1 = f1.roots()</span><br><span class="line">x2 = f2.roots()</span><br><span class="line">x3 = f3.roots()</span><br><span class="line"></span><br><span class="line">flag = flag + libnum.n2s(int(x1[0][0])) + libnum.n2s(int(x2[0][0])) + libnum.n2s(int(x3[0][0]))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>



<h1 id="数学但高中"><a href="#数学但高中" class="headerlink" title="数学但高中"></a>数学但高中</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">x=4&#123;0&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">y=4&#123;2&lt;x&lt;6,17&lt;x&lt;18,28&lt;x&lt;30,41&lt;x&lt;42&#125;</span><br><span class="line"></span><br><span class="line">y=6&#123;4&lt;x&lt;6,15&lt;x&lt;16,17&lt;x&lt;19,41&lt;x&lt;43,50&lt;x&lt;51&#125;</span><br><span class="line"></span><br><span class="line">x=7&#123;0&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">(x-9)^2+(y-3)^2=1</span><br><span class="line"></span><br><span class="line">x=10&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-12)^2+(y-3)^2=1</span><br><span class="line"></span><br><span class="line">x=13&#123;0&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">y=0&#123;11&lt;x&lt;13,15&lt;x&lt;16,50&lt;x&lt;51&#125;</span><br><span class="line"></span><br><span class="line">y=-x+17&#123;14&lt;x&lt;15&#125;</span><br><span class="line"></span><br><span class="line">y=x-11&#123;14&lt;x&lt;15&#125;</span><br><span class="line"></span><br><span class="line">x=15&#123;0&lt;y&lt;2,4&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">x=17&#123;1&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">x=19&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=21&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">(x-20)^2+(y-3)^2=1&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-23)^2+(y-3)^2=1&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=22&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=24&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-26)^2+(y-3)^2=1&#123;25&lt;x&lt;26&#125;</span><br><span class="line"></span><br><span class="line">y=0.5x-11&#123;26&lt;x&lt;27&#125;</span><br><span class="line"></span><br><span class="line">y=-0.5x+17&#123;26&lt;x&lt;27&#125;</span><br><span class="line"></span><br><span class="line">y=2&#123;29&lt;x&lt;30,31&lt;x&lt;33,39&lt;x&lt;40&#125;</span><br><span class="line"></span><br><span class="line">x=29&#123;2&lt;y&lt;5&#125;</span><br><span class="line"></span><br><span class="line">x=32&#123;2&lt;y&lt;5&#125;</span><br><span class="line"></span><br><span class="line">y=x-27&#123;31&lt;x&lt;32&#125;</span><br><span class="line"></span><br><span class="line">(x-34)^2+((y-3.5)^2)/(1.5^2)=1</span><br><span class="line"></span><br><span class="line">x=36&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-37)^2+(y-3)^2=1&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=38&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=41&#123;2&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">x=44&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">(x-45)^2+(y-3)^2=1&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=46&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=47&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">(x-48)^2+(y-3)^2=1&#123;3&lt;y&lt;4&#125;</span><br><span class="line"></span><br><span class="line">x=49&#123;2&lt;y&lt;3&#125;</span><br><span class="line"></span><br><span class="line">x=51&#123;0&lt;y&lt;2,4&lt;y&lt;6&#125;</span><br><span class="line"></span><br><span class="line">y=x-49&#123;51&lt;x&lt;52&#125;</span><br><span class="line"></span><br><span class="line">y=-x+55&#123;51&lt;x&lt;52&#125;</span><br></pre></td></tr></table></figure>

<p><strong>网站画图</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.desmos.com/calculator?lang=zh-CN">图形计算器 (desmos.com)</a></p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/0.png"></p>
<p><code>flag&#123;Funct10n_Fun&#125;</code></p>
<h1 id="Rosita"><a href="#Rosita" class="headerlink" title="Rosita"></a>Rosita</h1><p>题目：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Problem by rec, without any sleep at all.</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, a, b, flag</span><br><span class="line"></span><br><span class="line">ECC = EllipticCurve(GF(p), [a, b])</span><br><span class="line">R, E, C = [ECC.random_point() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">pad = <span class="keyword">lambda</span> m: urandom(<span class="number">8</span>) + m + <span class="string">b&#x27;\x00&#x27;</span> * (ZZ(p).nbits() // <span class="number">8</span> - <span class="built_in">len</span>(m) - <span class="number">8</span> - <span class="number">1</span>)</span><br><span class="line">out = <span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    m = pad(<span class="built_in">chr</span>(flag[i]).encode())</span><br><span class="line">    nonce = urandom(<span class="number">16</span>)</span><br><span class="line">    sh = sha256(nonce + m).digest()</span><br><span class="line">    </span><br><span class="line">    Q = b2l(m)*R + b2l(nonce)*E + b2l(sh)*C</span><br><span class="line">    out.append(Q.xy())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;out.tuo&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(out))</span><br></pre></td></tr></table></figure>

<p>本题椭圆曲线的参数$p,a,b$全部没有给出，$R,E,C$是椭圆曲线上的点，$pad$是一种填充方式</p>
<p>$m$是$flag$经过$pad$填充后的，$nonce$是16字节的字符串，$sh$是$sha256(nonce+m)$</p>
<p>之后把$m,nonce,sh$全部转为数值，产生$Q点$</p>
<p>我们唯一拿到的就是一系列$Q点$</p>
<h2 id="First"><a href="#First" class="headerlink" title="First"></a>First</h2><p>先通过$Q$点恢复椭圆曲线的参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import GCD,isPrime</span><br><span class="line">def recover_para(Q):</span><br><span class="line"> x1,y1 = Q[0]</span><br><span class="line"> x2,y2 = Q[1]</span><br><span class="line"> x3,y3 = Q[2]</span><br><span class="line"> x4,y4 = Q[3]</span><br><span class="line"> t12_13 = ((y1**2 - x1**3)-(y2**2 - x2**3)) * (x1-x3)</span><br><span class="line"> t13_12 = ((y1**2 - x1**3)-(y3**2 - x3**3)) * (x1-x2)</span><br><span class="line"> k1p = t12_13-t13_12</span><br><span class="line"></span><br><span class="line"> t12_14 = ((y1**2 - x1**3)-(y2**2 - x2**3)) * (x1-x4)</span><br><span class="line"> t14_12 = ((y1**2 - x1**3)-(y4**2 - x4**3)) * (x1-x2)</span><br><span class="line"> k2p = t12_14-t14_12</span><br><span class="line"></span><br><span class="line"> p = factor(GCD(k1p,k2p))[-1][0]</span><br><span class="line"> assert isPrime(int(p))</span><br><span class="line"></span><br><span class="line"> a = ((y1^2-x1^3)-(y2^2-x2^3))/(x1-x2) % p</span><br><span class="line"> b = (y1^2-x1^3-a*x1) % p</span><br><span class="line"></span><br><span class="line"> E = EllipticCurve(GF(p),[a,b])</span><br><span class="line"></span><br><span class="line"> assert E(Q[0])</span><br><span class="line"> return E,a,b,p</span><br><span class="line"></span><br><span class="line">Q = [(4713513545399586887294281187501009141689080934674926984853052046637141607331993392136186920709675152470824454822335527736604585312216293390500894812356575, 10152198551269550712132843544953877513974069303791371586626547671550636936369607844350995807520993189830394615282586805640124173078292476320861958178531199), (8497709856659541496506566158438727086633064779296427286612559352247045304592577869075723270252557382159636274220949698085489427175611575498725494187042219, 9116811362014883884879981282521462123463402369273722016008105935084826801111377968641225157887930975588405833350168170885178864192235006321249285744756607), (9370988588550376568847533229569651406006327680521920971380933472551236466257993862023372207379492794618019196741718902793769742423589142369766582541381456, 2964764716081715738931864218952095017577031943078710662273038672326443429898927649838098895380036049701254956968440876093577389832396678079667784517400438), (9780561431490704165761200835168742342147019392307027843608906950941244751705916411353543429159840043103272583252784603317509552870673884311510395715589823, 4512360262119206250842086638048812502384840258083296584133384225879227543325169341795597008831855800692604773248185325609068166181249185285419214480894245)]</span><br><span class="line"></span><br><span class="line">E,a,b,p = recover_para(Q)</span><br><span class="line"></span><br><span class="line">print(&quot;a=&quot;,a)</span><br><span class="line">print(&quot;b=&quot;,b)</span><br><span class="line">print(&quot;p=&quot;,p)</span><br></pre></td></tr></table></figure>

<p>原理如下图，来源于<strong>Van1sh的公众号</strong><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/e8iipjHVVXk0xTGZpNOeJQ">2023 巅峰极客-Rosita (qq.com)</a></p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/1.png"></p>
<h2 id="Second"><a href="#Second" class="headerlink" title="Second"></a>Second</h2><p>我们已知$Q &#x3D; m×R+nonce×E + sh×C$，需要注意的是每个$m,nounce,sh$都是不同的</p>
<p>一共给了73个$Q$点，所以我们有</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/2.png"></p>
<p>需要注意的是，我们选择椭圆曲线上的生成元$G$，则必定有$R&#x3D;rG,E&#x3D;eG,C&#x3D;cG$</p>
<p>所以上式可以转换成</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/3.png"></p>
<p>上述矩阵分别记为$M,C,A$</p>
<p>因为曲线的阶和$p$相等，所以$A_i$可以通过<code>smart_attack</code>恢复</p>
<p>这其实就是一个HSSP问题</p>
<p>假设存在一个与$A$正交的矩阵$T$</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/4.png"></p>
<p>则</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/5.png"></p>
<p>那么有下式，我不确定这一点的原理</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/6.png"></p>
<p>构造格</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/7.png"></p>
<p>通过LLL算法格基规约后，理想情况下，最后一列D均被规约成0</p>
<h3 id="我的理解"><a href="#我的理解" class="headerlink" title="我的理解"></a>我的理解</h3><p>我的理解是，把上面这个矩阵的每一行看成行向量，因为LLL算法实际是对每个行向量进行线性组合</p>
<p>即$z&#x3D;y_1A_1+y_2A_2+…+y_{73}A_{73}$，最后一列就是这个组合生成的$z$的值，前面73列分别就是$y_1\longrightarrow y_{73}$的值</p>
<p>这样，每一行前73列的值就是$T矩阵$某行的73个值了。所以最后一列为0即是我们的判断条件。</p>
<p>大佬说不一定能把所有行都能规约成正交矩阵T。这题73行，有70行被规约成与A正交</p>
<p>强网杯2022 Lattice的wp这里只要满足$n&gt;\frac{m}{2}$就能通过右核矩阵还原出$M$。其中n是规约后正交的行数，$m$为给出的数据行数</p>
<p>所以对于得到的70行足够还原出小向量。</p>
<h2 id="Thrid"><a href="#Thrid" class="headerlink" title="Thrid"></a>Thrid</h2><p>恢复不完全的矩阵$T$之后，我们求解</p>
<p><img src="/../../images/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/8.png"></p>
<p>所以M的每一列是矩阵$T$的右核解，我们要求$M$的第一列，它在$T$的右核的格上</p>
<p>且$M$的第一列是短向量，期望对$T$求右核矩阵然后<strong>规约</strong>即可还原出M的第一列。</p>
<p>最后这一步还得琢磨琢磨</p>
<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a= <span class="number">490963434153515882934487973185142842357175523008183292296815140698999054658777820556076794490414610737654365807063916602037816955706321036900113929329671</span></span><br><span class="line">b= <span class="number">7668542654793784988436499086739239442915170287346121645884096222948338279165302213440060079141960679678526016348025029558335977042712382611197995002316466</span></span><br><span class="line">p= <span class="number">11093300438765357787693823122068501933326829181518693650897090781749379503427651954028543076247583697669597230934286751428880673539155279232304301123931419</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">out = []</span><br><span class="line">G = E.gens()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> out:</span><br><span class="line">    point = E(i[<span class="number">0</span>],i[<span class="number">1</span>])</span><br><span class="line">    tmp = SmartAttack(G,point,p)</span><br><span class="line">    <span class="built_in">print</span>(tmp)</span><br><span class="line">    A.append(tmp)</span><br><span class="line">    </span><br><span class="line">Ge = Matrix(ZZ,<span class="number">74</span>,<span class="number">74</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">73</span>):</span><br><span class="line">    Ge[i,i] = <span class="number">1</span></span><br><span class="line">    Ge[i,-<span class="number">1</span>] = A[i]</span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;求解T&quot;</span>)</span><br><span class="line">T = []</span><br><span class="line">L = Ge.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       	T.append(i[:-<span class="number">1</span>])</span><br><span class="line">       	</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(T))</span><br><span class="line">T = Matrix(ZZ,T)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;求解T结束&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;还原M&quot;</span>)</span><br><span class="line">M = Matrix(ZZ,T.right_kernel().basis()).LLL()[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;还原M结束&quot;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M:</span><br><span class="line">    flag += <span class="built_in">chr</span>(long_to_bytes(i)[-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>T.right_kernel().</code>：用于计算$T$的右核。右核是指所有使得线性变换或矩阵作用于其上结果为零向量的向量的集合。</p>
<p><code>T.right_kernel().basis()</code>：用于获取$T$右核的基向量</p>
<p>这道题花了太多时间，对于求解右核然后格基规约这一过程还很迷糊</p>

    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/" title="巅峰极客2023——Crypto">https://dexterjie.github.io/2023/07/24/赛题复现/巅峰极客2023/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/07/23/%E5%9D%97%E5%AF%86%E7%A0%81/AES/" rel="prev" title="AES">
                  <i class="fa fa-chevron-left"></i> AES
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023DASCTF7%E6%9C%88/" rel="next" title="2023DASCTF暑期挑战赛——Crypto">
                  2023DASCTF暑期挑战赛——Crypto <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">309k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">18:42</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2023/07/24/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22023/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
