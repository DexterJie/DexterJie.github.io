<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录一些长知识的题目">
<meta property="og:type" content="article">
<meta property="og:title" content="题目收集">
<meta property="og:url" content="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录一些长知识的题目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/paper/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/Lattice2/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/Lattice2/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/paper/1.png">
<meta property="article:published_time" content="2023-07-17T12:12:24.000Z">
<meta property="article:modified_time" content="2023-08-19T08:21:24.276Z">
<meta property="article:author" content="Dexter">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/paper/0.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/","path":"2023/07/17/题目收集/","title":"题目收集"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>题目收集 | DexterJie'Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0"><span class="nav-number">1.</span> <span class="nav-text">三胞胎素数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="nav-number">1.1.</span> <span class="nav-text">一些定义：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%AA%E7%94%9F%E7%B4%A0%E6%95%B0"><span class="nav-number">1.1.1.</span> <span class="nav-text">孪生素数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0-1"><span class="nav-number">1.1.2.</span> <span class="nav-text">三胞胎素数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">1.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A5%E4%B8%8B%E6%98%AF%E6%9C%89%E5%85%B3%E8%AE%BA%E6%96%87%E7%9A%84%E9%A2%98%E7%9B%AE"><span class="nav-number">2.</span> <span class="nav-text">以下是有关论文的题目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#N-ma-2-nb-2-mc-2-nd-2"><span class="nav-number">2.1.</span> <span class="nav-text">N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%A5%E6%BA%90-NSSCTF-Round11%E2%80%94%E2%80%94-ez-fac"><span class="nav-number">2.1.1.</span> <span class="nav-text">题目来源 NSSCTF#Round11——[ez_fac]</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#n-p-r%C3%97q"><span class="nav-number">2.2.</span> <span class="nav-text">n &#x3D; p^r×q</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%A5%E6%BA%90-D-3CTF-2022-%E2%80%94%E2%80%94d3factor"><span class="nav-number">2.2.1.</span> <span class="nav-text">题目来源[D^3CTF 2022] ——d3factor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BA%E6%96%87%E5%86%85%E5%AE%B9%E5%8F%8A%E8%AF%81%E6%98%8E%E8%BF%87%E7%A8%8B"><span class="nav-number">2.2.2.</span> <span class="nav-text">论文内容及证明过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E9%A2%98%E8%A7%A3%E7%AD%94"><span class="nav-number">2.2.3.</span> <span class="nav-text">本题解答</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%E4%B8%8E%E6%A0%BC%E7%BB%93%E5%90%88%EF%BC%8C%E4%B8%94%E5%A4%9A%E7%BB%84n-e-c"><span class="nav-number">2.3.</span> <span class="nav-text">RSA与格结合，且多组n,e,c</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%A5%E6%BA%90-NUSTCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E2%80%94%E2%80%94lattice"><span class="nav-number">2.3.1.</span> <span class="nav-text">题目来源[NUSTCTF 2022 新生赛]——lattice</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cve-of-RSA"><span class="nav-number">2.4.</span> <span class="nav-text">cve of RSA</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#coppersmith"><span class="nav-number">3.</span> <span class="nav-text">coppersmith</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#comedy%EF%BC%88%E5%85%88%E6%90%81%E7%9D%80%EF%BC%89"><span class="nav-number">3.1.</span> <span class="nav-text">comedy（先搁着）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB"><span class="nav-number">3.2.</span> <span class="nav-text">高位攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%A8%E5%BC%82%E6%88%96%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%A4%B9%E6%9D%82%E7%A7%BB%E4%BD%8D"><span class="nav-number">3.3.</span> <span class="nav-text">在异或基础上夹杂移位</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB%E7%BB%93%E5%90%88%E5%8A%A0%E6%B3%95"><span class="nav-number">3.4.</span> <span class="nav-text">高位攻击结合加法</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Dexter"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">Dexter</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="Dexter">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="题目收集 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          题目收集
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-07-17 20:12:24" itemprop="dateCreated datePublished" datetime="2023-07-17T20:12:24+08:00">2023-07-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-08-19 16:21:24" itemprop="dateModified" datetime="2023-08-19T16:21:24+08:00">2023-08-19</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.9k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>11 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录一些长知识的题目</p>
<span id="more"></span>



<h1 id="三胞胎素数"><a href="#三胞胎素数" class="headerlink" title="三胞胎素数"></a>三胞胎素数</h1><p>题目来源[TSGCTF 2021]Beginner’s Crypto 2021</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">from secret import e</span><br><span class="line">from Crypto.Util.number import getStrongPrime, isPrime</span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    flag = int.from_bytes(f.read(), &#x27;big&#x27;)</span><br><span class="line"></span><br><span class="line">assert(isPrime(e))</span><br><span class="line">assert(isPrime(e + 2))</span><br><span class="line">assert(isPrime(e + 4))</span><br><span class="line"></span><br><span class="line">e1 = pow(e, 0x10001, phi)</span><br><span class="line">e2 = pow(e + 2, 0x10001, phi)</span><br><span class="line">e3 = pow(e + 4, 0x10001, phi)</span><br><span class="line"></span><br><span class="line">c1 = pow(flag, e1, N)</span><br><span class="line">c2 = pow(flag, e2, N)</span><br><span class="line">c3 = pow(flag, e3, N)</span><br><span class="line"></span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;q = &#123;q&#125;&#x27;)</span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c2&#125;&#x27;)</span><br><span class="line">print(f&#x27;c3 = &#123;c3&#125;&#x27;)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">p = 167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span><br><span class="line">q = 130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span><br><span class="line">c1 = 2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span><br><span class="line">c2 = 9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span><br><span class="line">c3 = 3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">assert(isPrime(e))</span><br><span class="line">assert(isPrime(e + 2))</span><br><span class="line">assert(isPrime(e + 4))</span><br></pre></td></tr></table></figure>

<p>满足这样条件的$e$只有$e&#x3D;3$</p>
<h2 id="一些定义："><a href="#一些定义：" class="headerlink" title="一些定义："></a>一些定义：</h2><h3 id="孪生素数"><a href="#孪生素数" class="headerlink" title="孪生素数"></a>孪生素数</h3><p><strong>指差等于2的两个素数。</strong></p>
<h3 id="三胞胎素数-1"><a href="#三胞胎素数-1" class="headerlink" title="三胞胎素数"></a>三胞胎素数</h3><p><strong>指三个连续素数，使得其中最大的一个减去最小一个的差不超过6</strong>。</p>
<p>事实上，除了最小的两组三胞胎素数：$(2, 3, 5)$ 和 $(3, 5, 7)$，其它的三胞胎素数都是相差达到<strong>6</strong>的三元数组。除了以上两个特例以外，三胞胎素数分为两类：</p>
<p>A类三胞胎素数，构成为$p$，$p+2$，$p+6$，相差2的两个孪生素数在前面，例如：$(5，7，11)$；$(11，13，17)$； $(17，19，23)$；等等。</p>
<p>B类三胞胎素数，构成为$p$，$p+4$，$p+6$，相差2的两个孪生素数在后面，例如：(7，11，13)；(13，17，19)；(37，41，43)；等等。</p>
<p>当素数p 大于3时，可以证明形同$p$，$p+2$，$p+4$的数组不可能是三胞胎素数。事实上，这三个数对3的模两两不同，所以必然有一个能被3整除。然而这三个数都比3要大，因此一定有一个是3的倍数，从而这个数不是素数。</p>
<p>详见：<a target="_blank" rel="noopener" href="https://zh.wikibooks.org/wiki/%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0">三胞胎素数 - 维基教科书，自由的教学读本 (wikibooks.org)</a></p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>知道$e&#x3D;3$之后就已知$e_1,e_2,e_3$，然后共模攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = <span class="number">167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span></span><br><span class="line">q = <span class="number">130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span></span><br><span class="line">c1 = <span class="number">2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span></span><br><span class="line">c2 = <span class="number">9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span></span><br><span class="line">c3 = <span class="number">3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span></span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="built_in">pow</span>(e, <span class="number">0x10001</span>, phi)</span><br><span class="line">e2 = <span class="built_in">pow</span>(e + <span class="number">2</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line">e3 = <span class="built_in">pow</span>(e + <span class="number">4</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line"></span><br><span class="line">ee = [e1,e2,e3]</span><br><span class="line">cc = [c1,c2,c3]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            s,x,y = gmpy2.gcdext(ee[i],ee[j])</span><br><span class="line">            m = <span class="built_in">pow</span>(cc[i],x,N) * <span class="built_in">pow</span>(cc[j],y,N) % N</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">           </span><br></pre></td></tr></table></figure>

<h1 id="以下是有关论文的题目"><a href="#以下是有关论文的题目" class="headerlink" title="以下是有关论文的题目"></a>以下是有关论文的题目</h1><h2 id="N-ma-2-nb-2-mc-2-nd-2"><a href="#N-ma-2-nb-2-mc-2-nd-2" class="headerlink" title="N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2"></a>N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2</h2><p>论文：<a target="_blank" rel="noopener" href="https://www.jstor.org/stable/0b4b4e65-c7fc-3c15-b716-723b58ec2b20?read-now=1&seq=1">A Note on Euler’s Factoring Problem on JSTOR</a></p>
<p>另外一个链接：[elementary number theory - A generalization of Euler Factorization with $N &#x3D; m a^2 + n b^2 &#x3D; m c^2 + n d^2$ - Mathematics Stack Exchange](<a target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/4712807/a-generalization-of-euler-factorization-with-n-m-a2-n-b2-m-c2-n-d2#:~:text=John">https://math.stackexchange.com/questions/4712807/a-generalization-of-euler-factorization-with-n-m-a2-n-b2-m-c2-n-d2#:~:text=John</a> Brillhart discusses a generalization of this method,%3D ma2 %2B nb2 %3D mc2 %2B nd2%2C)</p>
<h3 id="题目来源-NSSCTF-Round11——-ez-fac"><a href="#题目来源-NSSCTF-Round11——-ez-fac" class="headerlink" title="题目来源 NSSCTF#Round11——[ez_fac]"></a>题目来源 NSSCTF#Round11——[ez_fac]</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,a0,a1,b0,b1</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a0=&quot;</span>,a0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a1=&quot;</span>,a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b0=&quot;</span>,b0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b1=&quot;</span>,b1)</span><br></pre></td></tr></table></figure>

<p>论文大体内容就是：</p>
<p>如果$N &#x3D; ma^2 + nb^2$，且$N&#x3D;mc^2+nd^2$</p>
<p>$N$即可分解为$N&#x3D; (N,ad-bc)×\frac{n}{(N,ad-bc)}$，括号就是最大公因数</p>
<p>所以$p &#x3D; gcd(N,ad-bc)$</p>
<p>本题还需要推导一下e</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c= <span class="number">34007465638566836660852768374211870538357285529060206826620688555044780516477877596651414637089490522614456532732711803500304737160162560168303462221485961593760966240770414498297915175227814336224871400766371471776600674705757656616409870237891336752248110367865552469248343708419900511716030176178698949179</span></span><br><span class="line">n= <span class="number">70043427687738872803871163276488213173780425282753969243938124727004843810522473265066937344440899712569316720945145873584064860810161865485251816597432836666987134938760506657782143983431621481190009008491725207321741725979791393566155990005404328775785526238494554357279069151540867533082875900530405903003</span></span><br><span class="line">a0= <span class="number">8369195163678456889416121467476480674288621867182572824570660596055739410903686466334448920102666056798356927389728982948229326705483052970212882852055482</span></span><br><span class="line">a1= <span class="number">8369195163678456889416121462308686152524805984209312455308229689034789710117101859597220211456125364647704791637845189120538925088375209397006380815921158</span></span><br><span class="line">b0= <span class="number">25500181489306553053743739056022091355379036380919737553326529889338409847082228856006303427136881468093863020843230477979</span></span><br><span class="line">b1= <span class="number">31448594528370020763962343185054872105044827103889010592635556324009793301024988530934510929565983517651356856506719032859</span></span><br><span class="line"></span><br><span class="line">tmp = a0*b1 - a1*b0</span><br><span class="line">e = (n - <span class="built_in">pow</span>(a0,<span class="number">2</span>)) // <span class="built_in">pow</span>(b0,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(tmp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="n-p-r×q"><a href="#n-p-r×q" class="headerlink" title="n &#x3D; p^r×q"></a>n &#x3D; p^r×q</h2><h3 id="题目来源-D-3CTF-2022-——d3factor"><a href="#题目来源-D-3CTF-2022-——d3factor" class="headerlink" title="题目来源[D^3CTF 2022] ——d3factor"></a>题目来源[D^3CTF 2022] ——d3factor</h3><p>论文：<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2015/399.pdf">399.pdf (iacr.org)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long, getPrime</span><br><span class="line">from secret import msg</span><br><span class="line">from sympy import nextprime</span><br><span class="line">from gmpy2 import invert</span><br><span class="line">from hashlib import md5</span><br><span class="line"></span><br><span class="line">flag = &#x27;d3ctf&#123;&#x27;+md5(msg).hexdigest()+&#x27;&#125;&#x27;</span><br><span class="line">p = getPrime(256)</span><br><span class="line">q = getPrime(256)</span><br><span class="line">assert p &gt; q</span><br><span class="line">n = p * q</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(msg)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">N = pow(p, 7) * q</span><br><span class="line">phi = pow(p, 6) * (p - 1) * (q - 1)</span><br><span class="line">d1 = getPrime(2000)</span><br><span class="line">d2 = nextprime(d1 + getPrime(1000))</span><br><span class="line">e1 = invert(d1, phi)</span><br><span class="line">e2 = invert(d2, phi)</span><br><span class="line"></span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">print(f&#x27;N = &#123;N&#125;&#x27;)</span><br><span class="line">print(f&#x27;e1 = &#123;e1&#125;&#x27;)</span><br><span class="line">print(f&#x27;e2 = &#123;e2&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c = </span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="论文内容及证明过程"><a href="#论文内容及证明过程" class="headerlink" title="论文内容及证明过程"></a>论文内容及证明过程</h3><p><img src="/../images/paper/0.png"></p>
<p>论文大致内容就是<strong>对于</strong>$N &#x3D; p^rq$，<strong>当两个解密密钥</strong>$d_1$,$d_2$差值不超过$N^{\frac{r(r-1)}{(r+1)^2}}$</p>
<p>即$|d_1-d_2| &lt; N^{\frac{r(r-1)}{(r+1)^2}}$的时候，可以在多项式的时间内分解出$p$</p>
<p>其证明过程如下：</p>
<p>$\because N &#x3D;p^rq$，$\phi(N) &#x3D; p^{r-1}(p-1)(q-1)$</p>
<p>有<br>$$<br>\left{\begin{matrix}<br>e_1d_1 \equiv 1 \mod \phi(N) \quad ①\<br>e_2d_2 \equiv 1 \mod \phi(N) \quad ②\<br>\end{matrix}\right.\<br>$$<br>把①式乘$e_2$，②式乘$e_1$再相减得</p>
<p>$e_1e_2(d_1-d_2)-(e_2-e_1) \equiv 0 \mod \phi(N)$</p>
<p>根据论文，把$\phi(N)$用$p^{r-1}$替代掉</p>
<p>则有$e_1e_2(d_1-d_2)-(e_2-e_1) \equiv 0 \mod p^{r-1}$</p>
<p>$d_1-d_2$就是$e_1e_2x - (e_2-e_1) \equiv 0 \mod p^{r-1}$的根</p>
<p>可以用coppersmith求出$x$</p>
<p>然后计算$gcd(e_1e_2x - (e_2-e_1),N) &#x3D; gcd(k×p^{r-1}(p-1)(q-1),p^rq) &#x3D; g$</p>
<p>利用这个g<br>$$<br>p &#x3D;<br>\left{\begin{matrix}<br>g^{\frac{1}{r-1}},\quad if\quad  g &#x3D; p^{r-1}\<br>g^{\frac{1}{r}},\quad if \quad g &#x3D; p^r\<br>\frac{N}{g},\quad if\quad  g &#x3D; p^{r-1}q<br>\end{matrix}\right.<br>$$</p>
<h3 id="本题解答"><a href="#本题解答" class="headerlink" title="本题解答"></a>本题解答</h3><p>根据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">7</span>) * q</span><br><span class="line">phi = <span class="built_in">pow</span>(p, <span class="number">6</span>) * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d1 = getPrime(<span class="number">2000</span>)</span><br><span class="line">d2 = nextprime(d1 + getPrime(<span class="number">1000</span>))</span><br></pre></td></tr></table></figure>

<p>可以判断出$|d_1-d_2|\approx 1000bit$，$N&#x3D; 2048bbit$，所以$|d_1-d_2|&lt;N^{\frac{r(r-1)}{(r+1)^2}} \approx 1344bit $</p>
<p>满足论文条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">2420624631315473673388732074340410215657378096737020976722603529598864338532404224879219059105950005655100728361198499550862405660043591919681568611707967</span></span><br><span class="line">N = <span class="number">1476751427633071977599571983301151063258376731102955975364111147037204614220376883752032253407881568290520059515340434632858734689439268479399482315506043425541162646523388437842149125178447800616137044219916586942207838674001004007237861470176454543718752182312318068466051713087927370670177514666860822341380494154077020472814706123209865769048722380888175401791873273850281384147394075054950169002165357490796510950852631287689747360436384163758289159710264469722036320819123313773301072777844457895388797742631541101152819089150281489897683508400098693808473542212963868834485233858128220055727804326451310080791</span></span><br><span class="line">e1 = <span class="number">425735006018518321920113858371691046233291394270779139216531379266829453665704656868245884309574741300746121946724344532456337490492263690989727904837374279175606623404025598533405400677329916633307585813849635071097268989906426771864410852556381279117588496262787146588414873723983855041415476840445850171457530977221981125006107741100779529209163446405585696682186452013669643507275620439492021019544922913941472624874102604249376990616323884331293660116156782891935217575308895791623826306100692059131945495084654854521834016181452508329430102813663713333608459898915361745215871305547069325129687311358338082029</span></span><br><span class="line">e2 = <span class="number">1004512650658647383814190582513307789549094672255033373245432814519573537648997991452158231923692387604945039180687417026069655569594454408690445879849410118502279459189421806132654131287284719070037134752526923855821229397612868419416851456578505341237256609343187666849045678291935806441844686439591365338539029504178066823886051731466788474438373839803448380498800384597878814991008672054436093542513518012957106825842251155935855375353004898840663429274565622024673235081082222394015174831078190299524112112571718817712276118850981261489528540025810396786605197437842655180663611669918785635193552649262904644919</span></span><br><span class="line"></span><br><span class="line">a = e1 * e2</span><br><span class="line">b = (e2 - e1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(N))			</span><br><span class="line">f = a*x - b</span><br><span class="line">f = f.monic()</span><br><span class="line">res =  f.small_roots(<span class="number">2</span>^<span class="number">1000</span>,beta = <span class="number">0.4</span>)		<span class="comment">#根据d1-d2大概的范围确定上限</span></span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">int</span>(res[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">g = gcd(a*ans - b,N)</span><br><span class="line"><span class="comment">#print(g.nbits())</span></span><br><span class="line"><span class="comment">#g = 1534bit</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(g,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line">q = N // (p^<span class="number">7</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">msg = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;d3ctf&#123;&quot;</span> + md5(msg).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>$\because g &#x3D; 1534bit$，$\therefore p &#x3D; g^{\frac{1}{6}}$</p>
<h2 id="RSA与格结合，且多组n-e-c"><a href="#RSA与格结合，且多组n-e-c" class="headerlink" title="RSA与格结合，且多组n,e,c"></a>RSA与格结合，且多组n,e,c</h2><h3 id="题目来源-NUSTCTF-2022-新生赛-——lattice"><a href="#题目来源-NUSTCTF-2022-新生赛-——lattice" class="headerlink" title="题目来源[NUSTCTF 2022 新生赛]——lattice"></a>题目来源[NUSTCTF 2022 新生赛]——lattice</h3><p>论文：<a target="_blank" rel="noopener" href="https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf">IJCSI-9-2-1-311-314.pdf</a></p>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import randint</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">d = getPrime(randint(370, 390))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def enc(i):</span><br><span class="line">    print()</span><br><span class="line">    p = getPrime(512)</span><br><span class="line">    q = getPrime(512)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    e = inverse(d, phi)</span><br><span class="line">    c = pow(flag, e, n)</span><br><span class="line">    print(f&#x27;e_&#123;i&#125; =&#x27;, e)</span><br><span class="line">    print(f&#x27;n_&#123;i&#125; =&#x27;, n)</span><br><span class="line">    print(f&#x27;c_&#123;i&#125; =&#x27;, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(3):</span><br><span class="line">        enc(i)</span><br><span class="line"></span><br><span class="line"># e_0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line"># n_0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line"># c_0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line"># e_1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line"># n_1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line"># c_1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line"># e_2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line"># n_2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line"># c_2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br></pre></td></tr></table></figure>



<p>令$M &#x3D; \sqrt{N_{max}}$，$M$是一组$N$中最大的$N$并且开根号。这组$N$满足：$N_1&lt;N_2&lt;\dots&lt;N_r &lt;2N_1$</p>
<p>又$\because e_id \equiv 1 (\mod \phi(N_i))$</p>
<p>这里把它写成$e_id &#x3D; 1+k_i\phi{N_i}$</p>
<p>假设$\phi(N_i)$可以写成$k_i(N_i-s_i)$的形式。其中$|s_i&lt;3N_i^{\frac{1}{2}}|$</p>
<p>则$e_id &#x3D; 1 + k_i(N_i-s_i)$</p>
<p>化简得$e_id-k_iN_i &#x3D; 1-k_is_i$</p>
<p>所以我们有$r+1$个等式:</p>
<p><img src="/../images/Lattice2/10.png"></p>
<p>写成矩阵相乘的形式</p>
<p><img src="/../images/Lattice2/11.png"></p>
<p>因为最后的目标向量满足LLL算法，所以我们可以得到$dM$</p>
<p>求得$dM$之后，我们可以求得$d$</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line">n0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line">c0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line">e1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line">n1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line">c1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line">e2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line">n2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line">c2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [n0,n1,n2]</span><br><span class="line">M = isqrt(max(n))</span><br><span class="line"></span><br><span class="line">ge = [[M,e0,e1,e2],</span><br><span class="line">    [0,-n0,0,0],</span><br><span class="line">    [0,0,-n1,0],</span><br><span class="line">    [0,0,0,-n2]]</span><br><span class="line">Ge = Matrix(ZZ,ge)</span><br><span class="line"></span><br><span class="line">dM = Ge.LLL()[0][0]</span><br><span class="line">d = abs(dM) // M</span><br><span class="line">m = pow(c0,d,n0)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h2 id="cve-of-RSA"><a href="#cve-of-RSA" class="headerlink" title="cve of RSA"></a>cve of RSA</h2><p>论文：<a target="_blank" rel="noopener" href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf">The Return of Coppersmith’s Attack:Practical Factorization of Widely Used RSA Moduli (muni.cz)</a></p>
<p>如果p,q是以$p &#x3D; k×M + 65537^a \mod M$的形式产生的，M是个光滑数</p>
<p>攻击脚本：<a target="_blank" rel="noopener" href="https://github.com/jvdsn/crypto-attacks">jvdsn&#x2F;crypto-attacks: Python implementations of cryptographic attacks and utilities. (github.com)</a></p>
<p>根据结论调参</p>
<p><img src="/../images/paper/1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kbits = <span class="number">37</span></span><br><span class="line">abit = <span class="number">62</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    k = getRandomNBitInteger(kbits)</span><br><span class="line">    a = getRandomNBitInteger(abit)</span><br><span class="line">    p = k * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, a, M)</span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    l = getRandomNBitInteger(kbits)</span><br><span class="line">    b = getRandomNBitInteger(abit)</span><br><span class="line">    q = l * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, b, M)</span><br><span class="line">    <span class="keyword">if</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="comment"># N = 10375505512698590697230540440656541719204263636911186773264796164624307537559854575146689396086897683887657357280574643827597720286007334491967184402911331</span></span><br><span class="line"><span class="comment"># c = 9452671754308991307639149928469686004498992794878178108851267184995226471125632100149955622693448809888842182351036616823747409631021412523576720606919605</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> Zmod</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> factor</span><br><span class="line"></span><br><span class="line">path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.realpath(os.path.abspath(__file__)))))</span><br><span class="line"><span class="keyword">if</span> sys.path[<span class="number">1</span>] != path:</span><br><span class="line">    sys.path.insert(<span class="number">1</span>, path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> shared.small_roots <span class="keyword">import</span> howgrave_graham</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_prime_power_divisors</span>(<span class="params">M</span>):</span><br><span class="line">    divisors = []</span><br><span class="line">    <span class="keyword">for</span> p, e <span class="keyword">in</span> factor(M):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e + <span class="number">1</span>):</span><br><span class="line">            divisors.append(p ** i)</span><br><span class="line"></span><br><span class="line">    divisors.sort()</span><br><span class="line">    <span class="keyword">return</span> divisors</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Algorithm 2.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_max_M_</span>(<span class="params">M, ord_</span>):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> _prime_power_divisors(M):</span><br><span class="line">        ordp = Zmod(p)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">        <span class="keyword">if</span> ord_ % ordp != <span class="number">0</span>:</span><br><span class="line">            M //= p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Section 2.7.2.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_greedy_find_M_</span>(<span class="params">n, M</span>):</span><br><span class="line">    <span class="built_in">ord</span> = Zmod(M)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        best_r = <span class="number">0</span></span><br><span class="line">        best_ord_ = <span class="built_in">ord</span></span><br><span class="line">        best_M_ = M</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> _prime_power_divisors(<span class="built_in">ord</span>):</span><br><span class="line">            ord_ = <span class="built_in">ord</span> // p</span><br><span class="line">            M_ = compute_max_M_(M, ord_)</span><br><span class="line">            r = (log2(<span class="built_in">ord</span>) - log2(ord_)) / (log2(M) - log2(M_))</span><br><span class="line">            <span class="keyword">if</span> r &gt; best_r:</span><br><span class="line">                best_r = r</span><br><span class="line">                best_ord_ = ord_</span><br><span class="line">                best_M_ = M_</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> log2(best_M_) &lt; log2(n) / <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line">        <span class="built_in">ord</span> = best_ord_</span><br><span class="line">        M = best_M_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, M, m, t, g=<span class="number">65537</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus using the ROCA method.</span></span><br><span class="line"><span class="string">    More information: Nemec M. et al., &quot;The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli&quot;</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param M: the primorial used to generate the primes</span></span><br><span class="line"><span class="string">    :param m: the m parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param t: the t parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param g: the generator value (default: 65537)</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    logging.info(<span class="string">&quot;Generating M&#x27;...&quot;</span>)</span><br><span class="line">    M_ = _greedy_find_M_(N, M)</span><br><span class="line">    zmodm_ = Zmod(M_)</span><br><span class="line">    g = zmodm_(g)</span><br><span class="line">    c_ = zmodm_(N).log(g)</span><br><span class="line">    ord_ = g.multiplicative_order()</span><br><span class="line"></span><br><span class="line">    x = Zmod(N)[<span class="string">&quot;x&quot;</span>].gen()</span><br><span class="line">    X = <span class="built_in">int</span>(<span class="number">2</span> * N ** <span class="number">0.5</span> // M_)</span><br><span class="line">    logging.info(<span class="string">&quot;Starting exhaustive a&#x27; search...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> a_ <span class="keyword">in</span> <span class="built_in">range</span>(c_ // <span class="number">2</span>, (c_ + ord_) // <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">        f = M_ * x + <span class="built_in">int</span>(g ** a_)</span><br><span class="line">        <span class="keyword">for</span> k_, <span class="keyword">in</span> howgrave_graham.modular_univariate(f, N, m, t, X):</span><br><span class="line">            p = <span class="built_in">int</span>(f(k_))</span><br><span class="line">            <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> p, N // p</span><br><span class="line">      </span><br><span class="line">N=<span class="number">10375505512698590697230540440656541719204263636911186773264796164624307537559854575146689396086897683887657357280574643827597720286007334491967184402911331</span></span><br><span class="line">M=<span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">m = <span class="number">5</span></span><br><span class="line">t = <span class="number">6</span></span><br><span class="line">p,q = factorize(N,M,m,t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个脚本我是在sagemath跑的</p>
<p>得到p,q后有手就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">85179386137518452231354185509698113331528483782580002217930594759662020757433</span></span><br><span class="line">q=<span class="number">121807704694511224555991770528701515984374557330058194205583818929517699002107</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">9452671754308991307639149928469686004498992794878178108851267184995226471125632100149955622693448809888842182351036616823747409631021412523576720606919605</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>











<h1 id="coppersmith"><a href="#coppersmith" class="headerlink" title="coppersmith"></a>coppersmith</h1><h2 id="comedy（先搁着）"><a href="#comedy（先搁着）" class="headerlink" title="comedy（先搁着）"></a>comedy（先搁着）</h2><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2, libnum</span><br><span class="line">from secret import flag1, flag2</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag1)</span><br><span class="line">assert m.bit_length() &lt; 200</span><br><span class="line">B = gmpy2.next_prime(libnum.s2n(flag2))</span><br><span class="line">A = (2022 - 2023 * m) % B</span><br><span class="line">leak = pow(2, 2023, B)</span><br><span class="line">print(A)</span><br><span class="line">print(leak)</span><br><span class="line"># 493275281479560936332761096886786925792234184811353209227551802099268192839677496844153534128991899414803550843408607188612593757622064753867565869035222715177143938385039508273050267347710495512806264863554858016145161165422812554800693811328453743229819656381224407015421235005940088439590887928051969351426291843586132741521121351667152673680122929827805479163871436776753859965413192837591532468372</span><br><span class="line"># 238829196127128263156194898141748280130190920343265228257398802867203846004703877952990524473329125233083096275276064071930416561616135910190674099345267027039386328203653489152769309498199556401574021633071022874689081585677578010276529507102304828451681000682208089162940529052283763507244593173690786957816545746540436261888398732172965945762569416702401859253725696471593023885944262561159982327952</span><br></pre></td></tr></table></figure>

<h2 id="高位攻击"><a href="#高位攻击" class="headerlink" title="高位攻击"></a>高位攻击</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from secrets import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n = p*q</span><br><span class="line">e = 65537</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&#x27;n =&#x27;, n)</span><br><span class="line">print(&#x27;c =&#x27;, c)</span><br><span class="line">print(&#x27;p0 =&#x27;, ((p&gt;&gt;128)&lt;&lt;128))</span><br><span class="line"># n = 12722276084782012506939748218137061976694333623308770803193278921311358642857520720238223717188895787376761058057320570031791633540549052360890626849683959794619430207976509336964838302913532815872846936103400538093765972176693960613553754981804951861018999147210521057815783304998144581807982126753283124281516688846477783545704858051397854514128591265938874177108889498151756070102637171159497913559176230984485047937009449456335164657258487948113487961895079102836099947427765851897399603733885367848305266219390271858890481731238036781050541110612526113637880146841891893392904381138771618976655066294938275191591</span><br><span class="line"># c = 7016802271682704586027412586496213357494728781654536670879262263911645812024904159932204545849316301445405237966933240237035426118442003499546014556123485534516682277683392394418823209992176414301314576069643211825678886511259850322068086838470004809816539278374905405029448429356654864943156018053547494263664714952593505357117355251742922245508277007069593675629222770814317602710615647062020095140444497647478051326857816298790397174877223117345612840890905447851689835046066164443064435495141117872095457539285213399905708851752673701650986197704683439495235659865937503527178246189185724246027890778434827868479</span><br><span class="line"># p0 = 121612618057439377491893234820394610861816815559052233952438700644930219565204914707604533201740057532331014637555250302342831261394993528125583478630623993361944114671033382653887624385660705353904988324932092635052885387222723368916634052933090217574600695084708857274271614116870074627080278200070403260416</span><br></pre></td></tr></table></figure>

<p><strong>p高位泄露，未知位是128bit</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">12722276084782012506939748218137061976694333623308770803193278921311358642857520720238223717188895787376761058057320570031791633540549052360890626849683959794619430207976509336964838302913532815872846936103400538093765972176693960613553754981804951861018999147210521057815783304998144581807982126753283124281516688846477783545704858051397854514128591265938874177108889498151756070102637171159497913559176230984485047937009449456335164657258487948113487961895079102836099947427765851897399603733885367848305266219390271858890481731238036781050541110612526113637880146841891893392904381138771618976655066294938275191591</span></span><br><span class="line">c = <span class="number">7016802271682704586027412586496213357494728781654536670879262263911645812024904159932204545849316301445405237966933240237035426118442003499546014556123485534516682277683392394418823209992176414301314576069643211825678886511259850322068086838470004809816539278374905405029448429356654864943156018053547494263664714952593505357117355251742922245508277007069593675629222770814317602710615647062020095140444497647478051326857816298790397174877223117345612840890905447851689835046066164443064435495141117872095457539285213399905708851752673701650986197704683439495235659865937503527178246189185724246027890778434827868479</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">high_p = <span class="number">121612618057439377491893234820394610861816815559052233952438700644930219565204914707604533201740057532331014637555250302342831261394993528125583478630623993361944114671033382653887624385660705353904988324932092635052885387222723368916634052933090217574600695084708857274271614116870074627080278200070403260416</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = high_p + x</span><br><span class="line">x = f.small_roots(X = <span class="number">2</span>^<span class="number">128</span>,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> x:</span><br><span class="line">    p = high_p + <span class="built_in">int</span>(x[<span class="number">0</span>])</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;W0W_y0u_rea1ly_go0d_at_us3_s4g3!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="在异或基础上夹杂移位"><a href="#在异或基础上夹杂移位" class="headerlink" title="在异或基础上夹杂移位"></a>在异或基础上夹杂移位</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = getPrime(1024), getPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">p0 = p ^ (bytes_to_long(flag)&lt;&lt;444)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m, 65537, N)</span><br><span class="line">print(len(flag))</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line">print(&#x27;N=&#x27;,N)</span><br><span class="line">print(&#x27;p0=&#x27;,p0)</span><br><span class="line"></span><br><span class="line"># 54</span><br><span class="line"># c= 6187845844052645335477666563187579997555293403110620879123121166924703361821847984760733842049752886698011561451715570810292323756091403783920480396052120046379755571530451812078574368413924390017994278703794257118954968480994077586245800902748815905644287545189605031883291488844527496906890127546594960138582150272568163575590734246290813150131949296550974206595456421136190026954855755623761557179760444906148376433584795779131477110538212742401420633087881506416368853221110426491868881029814841479615979710066371796507692025126150957315754738584387325388998533227577023142894876376702128870643448600352603905149</span><br><span class="line"># N= 14195810221536708489210274086946022255792382922322850338983263099316341767896809249586174293795778082892237356582757544364274847341220303582304283372889068290282580493623042441421715338444710303281638639785784613434328659529884972238348336971186339482788748316527376410510261228354155806341136524162787121212184386900663470590652770503564816948407257603737938414126069053610568675347826390537145556511048774030823322301932088595499671755944744816524811272617200683384649389274196659297432212847319503330409792704612575414010711158873031786577877685578976140462539734553598745329712188216200905451774357282278403189943</span><br><span class="line"># p0= 111984935426070810628244029907949697819351004665202173622240566580193974673163315128983603277856218378729883402496424467491406698035050254407170555432448523469880166015507303737468316933545613178461925283040643344197452758878116752692499745309765526523083790825015522124083482964296662782850606081657447935191</span><br></pre></td></tr></table></figure>

<p><strong>看到异或就想起LitCTF那道Babyxor，但这题不大一样，因为把m进行了左移操作</strong></p>
<p><strong>因为m左移444位，这样子m后面444位都是0，所以异或之后，不影响p低位444值</strong></p>
<p><strong>而且54长度的flag转成int型数据是432，左移444位后是876位，异或之后p高(1024-876)&#x3D;148位也是不变的</strong></p>
<p><strong>所以考点就是p部分高位和部分低位泄露</strong></p>
<p><strong>先取了444低位：<code>plow = p0 % 2^445</code></strong></p>
<p><strong>然后得到148高位：<code>phigh = (p0 &gt;&gt; 876) &lt;&lt; 876</code></strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p0 = 111984935426070810628244029907949697819351004665202173622240566580193974673163315128983603277856218378729883402496424467491406698035050254407170555432448523469880166015507303737468316933545613178461925283040643344197452758878116752692499745309765526523083790825015522124083482964296662782850606081657447935191</span><br><span class="line">c = 6187845844052645335477666563187579997555293403110620879123121166924703361821847984760733842049752886698011561451715570810292323756091403783920480396052120046379755571530451812078574368413924390017994278703794257118954968480994077586245800902748815905644287545189605031883291488844527496906890127546594960138582150272568163575590734246290813150131949296550974206595456421136190026954855755623761557179760444906148376433584795779131477110538212742401420633087881506416368853221110426491868881029814841479615979710066371796507692025126150957315754738584387325388998533227577023142894876376702128870643448600352603905149</span><br><span class="line">n = 14195810221536708489210274086946022255792382922322850338983263099316341767896809249586174293795778082892237356582757544364274847341220303582304283372889068290282580493623042441421715338444710303281638639785784613434328659529884972238348336971186339482788748316527376410510261228354155806341136524162787121212184386900663470590652770503564816948407257603737938414126069053610568675347826390537145556511048774030823322301932088595499671755944744816524811272617200683384649389274196659297432212847319503330409792704612575414010711158873031786577877685578976140462539734553598745329712188216200905451774357282278403189943</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">phigh = (p0&gt;&gt;876)&lt;&lt;876</span><br><span class="line">plow = p0 % 2**444</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = phigh + x*2**444 + plow</span><br><span class="line">f = f.monic()</span><br><span class="line">root = f.small_roots(X=2^432,beta=0.4)</span><br><span class="line">if root:</span><br><span class="line">    p = int(phigh + root[0]*2**444+plow)</span><br><span class="line">    print(&quot;p=&quot;,p)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    print(long_to_bytes(int(m)))</span><br><span class="line">else:</span><br><span class="line">    print(0)</span><br></pre></td></tr></table></figure>

<h2 id="高位攻击结合加法"><a href="#高位攻击结合加法" class="headerlink" title="高位攻击结合加法"></a>高位攻击结合加法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    flag = f.read().encode()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_Prime(nbits):</span><br><span class="line">    cnt = random.randint(1, 50)</span><br><span class="line">    a = 678649776854118956235519899207445775941738710575390362283588104409625449204123832879</span><br><span class="line">    b = 782005138760169933127526591821947364276106050094468540051784488164681554419515591399</span><br><span class="line">    n = 959495185099860764003383321572335140174084694495020493292570101529012627928646710561</span><br><span class="line">    if nbits &gt; n.bit_length():</span><br><span class="line">        n = n &lt;&lt; (nbits - n.bit_length())</span><br><span class="line">    seed = m</span><br><span class="line"></span><br><span class="line">    while cnt != 0:</span><br><span class="line">        while not isPrime(seed % pow(2, nbits)):</span><br><span class="line">            seed = (a * seed + b) % n</span><br><span class="line">        cnt -= 1</span><br><span class="line"></span><br><span class="line">    return seed % pow(2, nbits)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = get_Prime(1024)</span><br><span class="line">r = get_Prime(256)</span><br><span class="line"></span><br><span class="line">leak1 = p * q</span><br><span class="line">leak2 = p + r</span><br><span class="line">print(&#x27;leak1 =&#x27;, leak1)</span><br><span class="line">print(&quot;leak2 =&quot;, leak2)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">leak1 = 1726975620674482360213233806170947389541096108697994658733084655845389659114785301178576637466986314063371421235058595065888582231342820140568936192868977804603369486433318090941058139588565791324218134357184323086216185739954390473991279905043631888896016473122377727070109213645260572190927015695514811455255973089661406134295506499664743661249339253830939615669712520262820531049038976606781161641581457130675569478698323490748401496084828842168678572095280512663203781775164764035921218962082539851900388875197643683923415508978600441502826319004922595635629466742721341100368916333951643193549875170423774879551</span><br><span class="line">leak2 = 112318855182255283836167471766806168213410186797367822915324918687801558224308427598350852972681526722686984900181855405532137931103674353513321543274324576313279396633244245181304978516377298223713109442863413211695328144733089915971055510790022499917701465412122183985372344800810303472010586670294890532292</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>先从p,r入手，因为p(1024bit)的比特远大于r(256bit)的比特，即p的前768位(并不一定是这么多)并不受到r的影响，可用coppersmith恢复p</strong></p>
<p><strong>得到p后，看定义的函数，就是一个不知道多少次的lcg加密过程</strong></p>
<p><code> n = n &lt;&lt; (nbits - n.bit_length())</code><strong>这里保证了模数n足够大，因为再加密过程中，如果n不够大的话，会导致明文的数据丢失一些</strong></p>
<p><strong>再用q解密，需要注意的是用q解密的时候，这个n已经是移位过后的n</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">a = 678649776854118956235519899207445775941738710575390362283588104409625449204123832879</span><br><span class="line">b = 782005138760169933127526591821947364276106050094468540051784488164681554419515591399</span><br><span class="line">n = 959495185099860764003383321572335140174084694495020493292570101529012627928646710561</span><br><span class="line">leak1 = 1726975620674482360213233806170947389541096108697994658733084655845389659114785301178576637466986314063371421235058595065888582231342820140568936192868977804603369486433318090941058139588565791324218134357184323086216185739954390473991279905043631888896016473122377727070109213645260572190927015695514811455255973089661406134295506499664743661249339253830939615669712520262820531049038976606781161641581457130675569478698323490748401496084828842168678572095280512663203781775164764035921218962082539851900388875197643683923415508978600441502826319004922595635629466742721341100368916333951643193549875170423774879551</span><br><span class="line">leak2 = 112318855182255283836167471766806168213410186797367822915324918687801558224308427598350852972681526722686984900181855405532137931103674353513321543274324576313279396633244245181304978516377298223713109442863413211695328144733089915971055510790022499917701465412122183985372344800810303472010586670294890532292</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(leak1))</span><br><span class="line"></span><br><span class="line">high = (leak2&gt;&gt;256)&lt;&lt;256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = high + x</span><br><span class="line">x = f.small_roots(X=2^256,beta=0.4)</span><br><span class="line">if x:</span><br><span class="line">    p = high + x[0]</span><br><span class="line">    print(p)</span><br><span class="line">    q = leak1 // int(p)</span><br><span class="line">    seed = q</span><br><span class="line">    n = n &lt;&lt; (1024 - 729)</span><br><span class="line">    while 1:</span><br><span class="line">        ani = gmpy2.invert(a,n)</span><br><span class="line">        seed = ani*(seed - b) % n</span><br><span class="line">        flag = long_to_bytes(seed)</span><br><span class="line">        if b&#x27;flag&#x27; in flag:</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Dexter
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/" title="题目收集">https://dexterjie.github.io/2023/07/17/题目收集/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/07/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NKCTF/" rel="prev" title="NKCTF">
                  <i class="fa fa-chevron-left"></i> NKCTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/07/23/AES/" rel="next" title="AES">
                  AES <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Dexter</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">61k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:42</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->

<!-- <br /> -->
<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<!-- <span id="times">载入时分秒...</span> -->
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("11/17/2022 8:00:00");//此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); 
        if(String(snum).length ==1 ){snum = "0" + snum;}
        // var times = document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 "+hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
    }
setInterval("createtime()",250);
</script>
<span id="busuanzi_container_site_uv">
  本站访问次数：<span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>



  
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
