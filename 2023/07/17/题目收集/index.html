<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="记录一些长知识的题目">
<meta property="og:type" content="article">
<meta property="og:title" content="题目收集">
<meta property="og:url" content="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="记录一些长知识的题目">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/paper/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/Lattice2/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/Lattice2/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/paper/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/51.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/49.png">
<meta property="og:image" content="https://dexterjie.github.io/images/RSA/50.png">
<meta property="article:published_time" content="2023-07-17T12:12:24.000Z">
<meta property="article:modified_time" content="2023-09-06T10:54:55.794Z">
<meta property="article:author" content="DexterJie">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/paper/0.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/","path":"2023/07/17/题目收集/","title":"题目收集"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>题目收集 | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">诗酒趁年华</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#easyrandom"><span class="nav-number">1.</span> <span class="nav-text">easyrandom</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CTF2022%E2%80%94%E2%80%94ezRSA"><span class="nav-number">2.</span> <span class="nav-text">*CTF2022——ezRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98124%E4%BD%8D"><span class="nav-number">2.1.</span> <span class="nav-text">高124位</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF1"><span class="nav-number">2.1.1.</span> <span class="nav-text">思路1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF2"><span class="nav-number">2.1.2.</span> <span class="nav-text">思路2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4600%E4%BD%8D"><span class="nav-number">2.2.</span> <span class="nav-text">中间600位</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF1-1"><span class="nav-number">2.2.1.</span> <span class="nav-text">思路1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF2-1"><span class="nav-number">2.2.2.</span> <span class="nav-text">思路2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%8E%E4%BD%8D"><span class="nav-number">2.3.</span> <span class="nav-text">低位</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0"><span class="nav-number">3.</span> <span class="nav-text">三胞胎素数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="nav-number">3.1.</span> <span class="nav-text">一些定义：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%AA%E7%94%9F%E7%B4%A0%E6%95%B0"><span class="nav-number">3.1.1.</span> <span class="nav-text">孪生素数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0-1"><span class="nav-number">3.1.2.</span> <span class="nav-text">三胞胎素数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A2%98%E8%A7%A3"><span class="nav-number">3.2.</span> <span class="nav-text">题解</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A5%E4%B8%8B%E6%98%AF%E6%9C%89%E5%85%B3%E8%AE%BA%E6%96%87%E7%9A%84%E9%A2%98%E7%9B%AE"><span class="nav-number">4.</span> <span class="nav-text">以下是有关论文的题目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#N-ma-2-nb-2-mc-2-nd-2"><span class="nav-number">4.1.</span> <span class="nav-text">N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%A5%E6%BA%90-NSSCTF-Round11%E2%80%94%E2%80%94-ez-fac"><span class="nav-number">4.1.1.</span> <span class="nav-text">题目来源 NSSCTF#Round11——[ez_fac]</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#n-p-r%C3%97q"><span class="nav-number">4.2.</span> <span class="nav-text">n &#x3D; p^r×q</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%A5%E6%BA%90-D-3CTF-2022-%E2%80%94%E2%80%94d3factor"><span class="nav-number">4.2.1.</span> <span class="nav-text">题目来源[D^3CTF 2022] ——d3factor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BA%E6%96%87%E5%86%85%E5%AE%B9%E5%8F%8A%E8%AF%81%E6%98%8E%E8%BF%87%E7%A8%8B"><span class="nav-number">4.2.2.</span> <span class="nav-text">论文内容及证明过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E9%A2%98%E8%A7%A3%E7%AD%94"><span class="nav-number">4.2.3.</span> <span class="nav-text">本题解答</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%E4%B8%8E%E6%A0%BC%E7%BB%93%E5%90%88%EF%BC%8C%E4%B8%94%E5%A4%9A%E7%BB%84n-e-c"><span class="nav-number">4.3.</span> <span class="nav-text">RSA与格结合，且多组n,e,c</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%9D%A5%E6%BA%90-NUSTCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-%E2%80%94%E2%80%94lattice"><span class="nav-number">4.3.1.</span> <span class="nav-text">题目来源[NUSTCTF 2022 新生赛]——lattice</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#cve-of-RSA"><span class="nav-number">4.4.</span> <span class="nav-text">cve of RSA</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%89%E9%99%90%E5%9F%9F%E4%B8%8A%E7%9A%84%E4%B8%8D%E5%8F%AF%E7%BA%A6%E5%A4%9A%E9%A1%B9%E5%BC%8FRSA%E4%BD%93%E5%88%B6"><span class="nav-number">5.</span> <span class="nav-text">有限域上的不可约多项式RSA体制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#TCTF2019%E2%80%94%E2%80%94babyrsa"><span class="nav-number">5.1.</span> <span class="nav-text">TCTF2019——babyrsa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#watevrCTF-2019%E2%80%94%E2%80%94Swedish-RSA"><span class="nav-number">5.2.</span> <span class="nav-text">watevrCTF 2019——Swedish RSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2021%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81%E2%80%94%E2%80%94OnlyRSA"><span class="nav-number">5.3.</span> <span class="nav-text">2021强网拟态——OnlyRSA</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#coppersmith"><span class="nav-number">6.</span> <span class="nav-text">coppersmith</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%81%A2%E5%A4%8DOAEP%E7%A7%81%E9%92%A5"><span class="nav-number">6.1.</span> <span class="nav-text">恢复OAEP私钥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#comedy%EF%BC%88%E5%85%88%E6%90%81%E7%9D%80%EF%BC%89"><span class="nav-number">6.2.</span> <span class="nav-text">comedy（先搁着）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB"><span class="nav-number">6.3.</span> <span class="nav-text">高位攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9C%A8%E5%BC%82%E6%88%96%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%A4%B9%E6%9D%82%E7%A7%BB%E4%BD%8D"><span class="nav-number">6.4.</span> <span class="nav-text">在异或基础上夹杂移位</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E4%BD%8D%E6%94%BB%E5%87%BB%E7%BB%93%E5%90%88%E5%8A%A0%E6%B3%95"><span class="nav-number">6.5.</span> <span class="nav-text">高位攻击结合加法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E5%85%83copper"><span class="nav-number">7.</span> <span class="nav-text">二元copper</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#CISCN-2021%E5%8D%8E%E5%8D%97-small"><span class="nav-number">7.1.</span> <span class="nav-text">[CISCN 2021华南]small</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#P%EF%BC%8CQ%E4%BA%A7%E7%94%9F%E6%96%B9%E5%BC%8F%E7%94%B1%E6%8B%BC%E6%8E%A5%E8%80%8C%E6%88%90"><span class="nav-number">8.</span> <span class="nav-text">P，Q产生方式由拼接而成</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Hamul"><span class="nav-number">8.1.</span> <span class="nav-text">Hamul</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HamburgerRSA"><span class="nav-number">8.2.</span> <span class="nav-text">HamburgerRSA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%BB%91%E7%9B%BE%E6%9D%AF2020-Change"><span class="nav-number">8.3.</span> <span class="nav-text">黑盾杯2020 Change</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚Crypto新手</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">61</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚Crypto新手">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="题目收集 | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          题目收集
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-07-17 20:12:24" itemprop="dateCreated datePublished" datetime="2023-07-17T20:12:24+08:00">2023-07-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-09-06 18:54:55" itemprop="dateModified" datetime="2023-09-06T18:54:55+08:00">2023-09-06</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>13k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>46 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>记录一些长知识的题目</p>
<span id="more"></span>

<h1 id="easyrandom"><a href="#easyrandom" class="headerlink" title="easyrandom"></a>easyrandom</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">rng = Random()</span><br><span class="line">leak = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1250</span>):</span><br><span class="line">    leak.append(rng.getrandbits(<span class="number">16</span>))</span><br><span class="line">m = rng.getrandbits(<span class="number">64</span>)</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span>+<span class="built_in">str</span>(m)+<span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">flag_md5 = md5(flag.encode()).hexdigest()</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;leak = <span class="subst">&#123;leak&#125;</span>\n&quot;</span>)</span><br><span class="line">f.write(<span class="string">f&quot;flag_md5 = <span class="subst">&#123;flag_md5&#125;</span>\n&quot;</span>)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">leak = [<span class="number">47945</span>, <span class="number">50431</span>, <span class="number">10861</span>, <span class="number">5794</span>, <span class="number">26338</span>, <span class="number">2641</span>, <span class="number">58647</span>, <span class="number">52422</span>, <span class="number">35384</span>, <span class="number">50426</span>, <span class="number">58144</span>, <span class="number">2744</span>, <span class="number">7864</span>, <span class="number">25333</span>, <span class="number">3500</span>, <span class="number">59273</span>, <span class="number">38075</span>, <span class="number">38630</span>, <span class="number">18760</span>, <span class="number">19660</span>, <span class="number">54418</span>, <span class="number">53538</span>, <span class="number">20251</span>, <span class="number">25758</span>, <span class="number">4500</span>, <span class="number">14384</span>, <span class="number">40765</span>, <span class="number">43841</span>, <span class="number">62662</span>, <span class="number">64548</span>, <span class="number">6468</span>, <span class="number">8997</span>, <span class="number">20572</span>, <span class="number">9920</span>, <span class="number">64146</span>, <span class="number">49443</span>, <span class="number">32054</span>, <span class="number">56082</span>, <span class="number">21773</span>, <span class="number">38390</span>, <span class="number">14905</span>, <span class="number">47230</span>, <span class="number">43126</span>, <span class="number">37449</span>, <span class="number">1016</span>, <span class="number">23685</span>, <span class="number">48461</span>, <span class="number">13070</span>, <span class="number">58381</span>, <span class="number">51813</span>, <span class="number">48909</span>, <span class="number">10953</span>, <span class="number">31195</span>, <span class="number">1703</span>, <span class="number">33439</span>, <span class="number">54463</span>, <span class="number">63977</span>, <span class="number">29188</span>, <span class="number">44901</span>, <span class="number">53588</span>, <span class="number">32843</span>, <span class="number">9923</span>, <span class="number">2188</span>, <span class="number">42503</span>, <span class="number">53555</span>, <span class="number">44818</span>, <span class="number">55094</span>, <span class="number">40544</span>, <span class="number">25787</span>, <span class="number">34965</span>, <span class="number">65151</span>, <span class="number">37069</span>, <span class="number">6342</span>, <span class="number">36889</span>, <span class="number">51214</span>, <span class="number">58386</span>, <span class="number">34925</span>, <span class="number">9558</span>, <span class="number">33552</span>, <span class="number">29554</span>, <span class="number">30350</span>, <span class="number">20166</span>, <span class="number">4221</span>, <span class="number">61353</span>, <span class="number">50656</span>, <span class="number">7337</span>, <span class="number">1001</span>, <span class="number">18279</span>, <span class="number">27268</span>, <span class="number">49581</span>, <span class="number">37870</span>, <span class="number">54591</span>, <span class="number">12438</span>, <span class="number">13649</span>, <span class="number">42007</span>, <span class="number">33542</span>, <span class="number">18118</span>, <span class="number">48407</span>, <span class="number">34338</span>, <span class="number">12147</span>, <span class="number">19178</span>, <span class="number">8925</span>, <span class="number">31109</span>, <span class="number">12296</span>, <span class="number">52419</span>, <span class="number">392</span>, <span class="number">9296</span>, <span class="number">16055</span>, <span class="number">64775</span>, <span class="number">46394</span>, <span class="number">58494</span>, <span class="number">24157</span>, <span class="number">62237</span>, <span class="number">16211</span>, <span class="number">23935</span>, <span class="number">10368</span>, <span class="number">48440</span>, <span class="number">60061</span>, <span class="number">47813</span>, <span class="number">49032</span>, <span class="number">50836</span>, <span class="number">18404</span>, <span class="number">30552</span>, <span class="number">7142</span>, <span class="number">44142</span>, <span class="number">44549</span>, <span class="number">36078</span>, <span class="number">63112</span>, <span class="number">28345</span>, <span class="number">39821</span>, <span class="number">10004</span>, <span class="number">32221</span>, <span class="number">16021</span>, <span class="number">32152</span>, <span class="number">53113</span>, <span class="number">13857</span>, <span class="number">49328</span>, <span class="number">11817</span>, <span class="number">27777</span>, <span class="number">43088</span>, <span class="number">43453</span>, <span class="number">29962</span>, <span class="number">16338</span>, <span class="number">44353</span>, <span class="number">27974</span>, <span class="number">25145</span>, <span class="number">56050</span>, <span class="number">34129</span>, <span class="number">39236</span>, <span class="number">46167</span>, <span class="number">64639</span>, <span class="number">54581</span>, <span class="number">33004</span>, <span class="number">35652</span>, <span class="number">16294</span>, <span class="number">11109</span>, <span class="number">19396</span>, <span class="number">51476</span>, <span class="number">30332</span>, <span class="number">24701</span>, <span class="number">43628</span>, <span class="number">44507</span>, <span class="number">27688</span>, <span class="number">37172</span>, <span class="number">61339</span>, <span class="number">9893</span>, <span class="number">45217</span>, <span class="number">7969</span>, <span class="number">33523</span>, <span class="number">2495</span>, <span class="number">15578</span>, <span class="number">55444</span>, <span class="number">48564</span>, <span class="number">5055</span>, <span class="number">16048</span>, <span class="number">8512</span>, <span class="number">1819</span>, <span class="number">19702</span>, <span class="number">13388</span>, <span class="number">41099</span>, <span class="number">30256</span>, <span class="number">10592</span>, <span class="number">46063</span>, <span class="number">30881</span>, <span class="number">8338</span>, <span class="number">41214</span>, <span class="number">55255</span>, <span class="number">50060</span>, <span class="number">65028</span>, <span class="number">9114</span>, <span class="number">8417</span>, <span class="number">43767</span>, <span class="number">62760</span>, <span class="number">49830</span>, <span class="number">50660</span>, <span class="number">19358</span>, <span class="number">22142</span>, <span class="number">53025</span>, <span class="number">37930</span>, <span class="number">49155</span>, <span class="number">2150</span>, <span class="number">56194</span>, <span class="number">36251</span>, <span class="number">49654</span>, <span class="number">32395</span>, <span class="number">33677</span>, <span class="number">48743</span>, <span class="number">12627</span>, <span class="number">30575</span>, <span class="number">64001</span>, <span class="number">60220</span>, <span class="number">26908</span>, <span class="number">44207</span>, <span class="number">23532</span>, <span class="number">18430</span>, <span class="number">45511</span>, <span class="number">33553</span>, <span class="number">62631</span>, <span class="number">55155</span>, <span class="number">58715</span>, <span class="number">59152</span>, <span class="number">20864</span>, <span class="number">14790</span>, <span class="number">32774</span>, <span class="number">48679</span>, <span class="number">24325</span>, <span class="number">54109</span>, <span class="number">2747</span>, <span class="number">17046</span>, <span class="number">19083</span>, <span class="number">60413</span>, <span class="number">11773</span>, <span class="number">42188</span>, <span class="number">17011</span>, <span class="number">13361</span>, <span class="number">2105</span>, <span class="number">23067</span>, <span class="number">45439</span>, <span class="number">1122</span>, <span class="number">54117</span>, <span class="number">31435</span>, <span class="number">49692</span>, <span class="number">59556</span>, <span class="number">51893</span>, <span class="number">24342</span>, <span class="number">11073</span>, <span class="number">52326</span>, <span class="number">23237</span>, <span class="number">22930</span>, <span class="number">12691</span>, <span class="number">38125</span>, <span class="number">36714</span>, <span class="number">54043</span>, <span class="number">34880</span>, <span class="number">53599</span>, <span class="number">18609</span>, <span class="number">36631</span>, <span class="number">24367</span>, <span class="number">49135</span>, <span class="number">26821</span>, <span class="number">64486</span>, <span class="number">12154</span>, <span class="number">37534</span>, <span class="number">14100</span>, <span class="number">33744</span>, <span class="number">37183</span>, <span class="number">7652</span>, <span class="number">26403</span>, <span class="number">42166</span>, <span class="number">12290</span>, <span class="number">32315</span>, <span class="number">19153</span>, <span class="number">55490</span>, <span class="number">4558</span>, <span class="number">60768</span>, <span class="number">44149</span>, <span class="number">26258</span>, <span class="number">38676</span>, <span class="number">31228</span>, <span class="number">43610</span>, <span class="number">39357</span>, <span class="number">36475</span>, <span class="number">29434</span>, <span class="number">41437</span>, <span class="number">64762</span>, <span class="number">5251</span>, <span class="number">33641</span>, <span class="number">43819</span>, <span class="number">29769</span>, <span class="number">38136</span>, <span class="number">8348</span>, <span class="number">33123</span>, <span class="number">17571</span>, <span class="number">18343</span>, <span class="number">50569</span>, <span class="number">55502</span>, <span class="number">7371</span>, <span class="number">14515</span>, <span class="number">41553</span>, <span class="number">12979</span>, <span class="number">1276</span>, <span class="number">45454</span>, <span class="number">56057</span>, <span class="number">51518</span>, <span class="number">30382</span>, <span class="number">30678</span>, <span class="number">60443</span>, <span class="number">58274</span>, <span class="number">50882</span>, <span class="number">64918</span>, <span class="number">34569</span>, <span class="number">58195</span>, <span class="number">34410</span>, <span class="number">47490</span>, <span class="number">13676</span>, <span class="number">37502</span>, <span class="number">61987</span>, <span class="number">7616</span>, <span class="number">11528</span>, <span class="number">13577</span>, <span class="number">51098</span>, <span class="number">5435</span>, <span class="number">51972</span>, <span class="number">63061</span>, <span class="number">55995</span>, <span class="number">21627</span>, <span class="number">2439</span>, <span class="number">47554</span>, <span class="number">6891</span>, <span class="number">53790</span>, <span class="number">62563</span>, <span class="number">38921</span>, <span class="number">30600</span>, <span class="number">49498</span>, <span class="number">49671</span>, <span class="number">38844</span>, <span class="number">42840</span>, <span class="number">49982</span>, <span class="number">16503</span>, <span class="number">13854</span>, <span class="number">63825</span>, <span class="number">25195</span>, <span class="number">41078</span>, <span class="number">36872</span>, <span class="number">36288</span>, <span class="number">63461</span>, <span class="number">29293</span>, <span class="number">28630</span>, <span class="number">23547</span>, <span class="number">57332</span>, <span class="number">43051</span>, <span class="number">49205</span>, <span class="number">14579</span>, <span class="number">23897</span>, <span class="number">944</span>, <span class="number">47223</span>, <span class="number">6819</span>, <span class="number">61851</span>, <span class="number">57886</span>, <span class="number">10858</span>, <span class="number">14380</span>, <span class="number">35796</span>, <span class="number">4509</span>, <span class="number">52576</span>, <span class="number">47112</span>, <span class="number">44349</span>, <span class="number">56553</span>, <span class="number">45075</span>, <span class="number">31505</span>, <span class="number">2779</span>, <span class="number">17216</span>, <span class="number">47395</span>, <span class="number">15024</span>, <span class="number">26498</span>, <span class="number">25299</span>, <span class="number">26548</span>, <span class="number">39954</span>, <span class="number">33242</span>, <span class="number">65187</span>, <span class="number">33291</span>, <span class="number">38861</span>, <span class="number">6956</span>, <span class="number">4371</span>, <span class="number">11762</span>, <span class="number">41126</span>, <span class="number">54447</span>, <span class="number">56384</span>, <span class="number">34835</span>, <span class="number">595</span>, <span class="number">52198</span>, <span class="number">13324</span>, <span class="number">38653</span>, <span class="number">21103</span>, <span class="number">34301</span>, <span class="number">20781</span>, <span class="number">64650</span>, <span class="number">17773</span>, <span class="number">1921</span>, <span class="number">46490</span>, <span class="number">37683</span>, <span class="number">27720</span>, <span class="number">7812</span>, <span class="number">49737</span>, <span class="number">20423</span>, <span class="number">16452</span>, <span class="number">52475</span>, <span class="number">27896</span>, <span class="number">49613</span>, <span class="number">60121</span>, <span class="number">54986</span>, <span class="number">30680</span>, <span class="number">37740</span>, <span class="number">8407</span>, <span class="number">30833</span>, <span class="number">29431</span>, <span class="number">62841</span>, <span class="number">27957</span>, <span class="number">57755</span>, <span class="number">59153</span>, <span class="number">44802</span>, <span class="number">42423</span>, <span class="number">28202</span>, <span class="number">54075</span>, <span class="number">3879</span>, <span class="number">25261</span>, <span class="number">57958</span>, <span class="number">53266</span>, <span class="number">22806</span>, <span class="number">64334</span>, <span class="number">34962</span>, <span class="number">57708</span>, <span class="number">20653</span>, <span class="number">17925</span>, <span class="number">59244</span>, <span class="number">38640</span>, <span class="number">31264</span>, <span class="number">7962</span>, <span class="number">5234</span>, <span class="number">16995</span>, <span class="number">35712</span>, <span class="number">39263</span>, <span class="number">33764</span>, <span class="number">9168</span>, <span class="number">59263</span>, <span class="number">6297</span>, <span class="number">28879</span>, <span class="number">54753</span>, <span class="number">31041</span>, <span class="number">42448</span>, <span class="number">57238</span>, <span class="number">52395</span>, <span class="number">61412</span>, <span class="number">29370</span>, <span class="number">52297</span>, <span class="number">21906</span>, <span class="number">36837</span>, <span class="number">62511</span>, <span class="number">13185</span>, <span class="number">53251</span>, <span class="number">47459</span>, <span class="number">47320</span>, <span class="number">24874</span>, <span class="number">5152</span>, <span class="number">63178</span>, <span class="number">20614</span>, <span class="number">808</span>, <span class="number">6789</span>, <span class="number">37043</span>, <span class="number">9713</span>, <span class="number">31692</span>, <span class="number">18319</span>, <span class="number">60295</span>, <span class="number">9628</span>, <span class="number">1053</span>, <span class="number">54874</span>, <span class="number">26808</span>, <span class="number">28046</span>, <span class="number">27964</span>, <span class="number">7534</span>, <span class="number">43316</span>, <span class="number">51573</span>, <span class="number">51143</span>, <span class="number">41954</span>, <span class="number">16366</span>, <span class="number">19618</span>, <span class="number">23676</span>, <span class="number">63245</span>, <span class="number">28329</span>, <span class="number">25170</span>, <span class="number">55118</span>, <span class="number">49376</span>, <span class="number">22296</span>, <span class="number">41638</span>, <span class="number">42595</span>, <span class="number">49291</span>, <span class="number">51001</span>, <span class="number">21173</span>, <span class="number">17098</span>, <span class="number">11956</span>, <span class="number">33292</span>, <span class="number">28909</span>, <span class="number">63160</span>, <span class="number">63480</span>, <span class="number">32649</span>, <span class="number">49809</span>, <span class="number">24112</span>, <span class="number">59503</span>, <span class="number">38840</span>, <span class="number">22914</span>, <span class="number">17473</span>, <span class="number">51978</span>, <span class="number">25420</span>, <span class="number">64060</span>, <span class="number">58894</span>, <span class="number">35793</span>, <span class="number">57163</span>, <span class="number">59038</span>, <span class="number">58787</span>, <span class="number">64067</span>, <span class="number">55780</span>, <span class="number">61906</span>, <span class="number">1696</span>, <span class="number">156</span>, <span class="number">25499</span>, <span class="number">57706</span>, <span class="number">47842</span>, <span class="number">47243</span>, <span class="number">14668</span>, <span class="number">17052</span>, <span class="number">57195</span>, <span class="number">53288</span>, <span class="number">49178</span>, <span class="number">2557</span>, <span class="number">31221</span>, <span class="number">17492</span>, <span class="number">11560</span>, <span class="number">23012</span>, <span class="number">9147</span>, <span class="number">44260</span>, <span class="number">22094</span>, <span class="number">53197</span>, <span class="number">40404</span>, <span class="number">21209</span>, <span class="number">30940</span>, <span class="number">18586</span>, <span class="number">48011</span>, <span class="number">60631</span>, <span class="number">8838</span>, <span class="number">13044</span>, <span class="number">5480</span>, <span class="number">19584</span>, <span class="number">20231</span>, <span class="number">15078</span>, <span class="number">58154</span>, <span class="number">8305</span>, <span class="number">55680</span>, <span class="number">49974</span>, <span class="number">2861</span>, <span class="number">58626</span>, <span class="number">61041</span>, <span class="number">47937</span>, <span class="number">42776</span>, <span class="number">35207</span>, <span class="number">39418</span>, <span class="number">12989</span>, <span class="number">1507</span>, <span class="number">5082</span>, <span class="number">23278</span>, <span class="number">26969</span>, <span class="number">10328</span>, <span class="number">18480</span>, <span class="number">34160</span>, <span class="number">55965</span>, <span class="number">59869</span>, <span class="number">197</span>, <span class="number">38066</span>, <span class="number">17097</span>, <span class="number">49306</span>, <span class="number">12749</span>, <span class="number">21846</span>, <span class="number">9946</span>, <span class="number">12323</span>, <span class="number">39813</span>, <span class="number">19141</span>, <span class="number">14950</span>, <span class="number">15987</span>, <span class="number">33630</span>, <span class="number">14715</span>, <span class="number">52499</span>, <span class="number">15978</span>, <span class="number">24078</span>, <span class="number">60217</span>, <span class="number">32262</span>, <span class="number">11645</span>, <span class="number">1649</span>, <span class="number">50062</span>, <span class="number">21979</span>, <span class="number">30545</span>, <span class="number">1450</span>, <span class="number">48657</span>, <span class="number">41697</span>, <span class="number">23357</span>, <span class="number">17880</span>, <span class="number">27613</span>, <span class="number">38277</span>, <span class="number">54988</span>, <span class="number">11074</span>, <span class="number">57591</span>, <span class="number">183</span>, <span class="number">62803</span>, <span class="number">8532</span>, <span class="number">61133</span>, <span class="number">26944</span>, <span class="number">63400</span>, <span class="number">53095</span>, <span class="number">8663</span>, <span class="number">59702</span>, <span class="number">19325</span>, <span class="number">24726</span>, <span class="number">51297</span>, <span class="number">21286</span>, <span class="number">2373</span>, <span class="number">38774</span>, <span class="number">20677</span>, <span class="number">29443</span>, <span class="number">24693</span>, <span class="number">20621</span>, <span class="number">14031</span>, <span class="number">45485</span>, <span class="number">34645</span>, <span class="number">9926</span>, <span class="number">12620</span>, <span class="number">1406</span>, <span class="number">41462</span>, <span class="number">50338</span>, <span class="number">25841</span>, <span class="number">61724</span>, <span class="number">41722</span>, <span class="number">11520</span>, <span class="number">48377</span>, <span class="number">34111</span>, <span class="number">50805</span>, <span class="number">23351</span>, <span class="number">64363</span>, <span class="number">50091</span>, <span class="number">35487</span>, <span class="number">49978</span>, <span class="number">41001</span>, <span class="number">37117</span>, <span class="number">17133</span>, <span class="number">54868</span>, <span class="number">58918</span>, <span class="number">17295</span>, <span class="number">16857</span>, <span class="number">45165</span>, <span class="number">5732</span>, <span class="number">46277</span>, <span class="number">54359</span>, <span class="number">64982</span>, <span class="number">2336</span>, <span class="number">61929</span>, <span class="number">40501</span>, <span class="number">18901</span>, <span class="number">39938</span>, <span class="number">949</span>, <span class="number">45839</span>, <span class="number">7519</span>, <span class="number">36935</span>, <span class="number">55287</span>, <span class="number">21096</span>, <span class="number">44443</span>, <span class="number">12240</span>, <span class="number">16160</span>, <span class="number">28355</span>, <span class="number">42275</span>, <span class="number">27747</span>, <span class="number">13398</span>, <span class="number">12395</span>, <span class="number">33973</span>, <span class="number">17137</span>, <span class="number">60697</span>, <span class="number">37064</span>, <span class="number">27782</span>, <span class="number">45671</span>, <span class="number">22264</span>, <span class="number">505</span>, <span class="number">20989</span>, <span class="number">57585</span>, <span class="number">4283</span>, <span class="number">43110</span>, <span class="number">28497</span>, <span class="number">25900</span>, <span class="number">16383</span>, <span class="number">13961</span>, <span class="number">24192</span>, <span class="number">29296</span>, <span class="number">34776</span>, <span class="number">36286</span>, <span class="number">18398</span>, <span class="number">55882</span>, <span class="number">28748</span>, <span class="number">54021</span>, <span class="number">673</span>, <span class="number">22723</span>, <span class="number">23699</span>, <span class="number">48463</span>, <span class="number">17316</span>, <span class="number">55309</span>, <span class="number">54229</span>, <span class="number">28342</span>, <span class="number">11147</span>, <span class="number">16132</span>, <span class="number">24344</span>, <span class="number">53367</span>, <span class="number">45597</span>, <span class="number">42843</span>, <span class="number">27078</span>, <span class="number">4034</span>, <span class="number">16975</span>, <span class="number">18534</span>, <span class="number">29674</span>, <span class="number">36962</span>, <span class="number">60773</span>, <span class="number">8030</span>, <span class="number">17118</span>, <span class="number">7392</span>, <span class="number">41627</span>, <span class="number">44768</span>, <span class="number">51104</span>, <span class="number">10876</span>, <span class="number">16293</span>, <span class="number">54589</span>, <span class="number">65082</span>, <span class="number">62573</span>, <span class="number">2679</span>, <span class="number">23869</span>, <span class="number">61905</span>, <span class="number">52526</span>, <span class="number">51584</span>, <span class="number">57063</span>, <span class="number">27294</span>, <span class="number">51821</span>, <span class="number">9070</span>, <span class="number">30961</span>, <span class="number">38741</span>, <span class="number">36309</span>, <span class="number">57422</span>, <span class="number">58231</span>, <span class="number">32775</span>, <span class="number">57469</span>, <span class="number">2306</span>, <span class="number">43632</span>, <span class="number">6110</span>, <span class="number">17478</span>, <span class="number">3399</span>, <span class="number">60718</span>, <span class="number">23947</span>, <span class="number">21488</span>, <span class="number">41712</span>, <span class="number">43552</span>, <span class="number">34154</span>, <span class="number">35374</span>, <span class="number">17522</span>, <span class="number">16603</span>, <span class="number">53459</span>, <span class="number">52136</span>, <span class="number">49823</span>, <span class="number">21443</span>, <span class="number">35049</span>, <span class="number">4854</span>, <span class="number">25769</span>, <span class="number">63782</span>, <span class="number">21355</span>, <span class="number">11189</span>, <span class="number">17330</span>, <span class="number">41173</span>, <span class="number">6620</span>, <span class="number">24475</span>, <span class="number">40910</span>, <span class="number">26100</span>, <span class="number">34752</span>, <span class="number">10491</span>, <span class="number">39327</span>, <span class="number">561</span>, <span class="number">24612</span>, <span class="number">36253</span>, <span class="number">41875</span>, <span class="number">1589</span>, <span class="number">44536</span>, <span class="number">64133</span>, <span class="number">37260</span>, <span class="number">24719</span>, <span class="number">21955</span>, <span class="number">40847</span>, <span class="number">8529</span>, <span class="number">12294</span>, <span class="number">22158</span>, <span class="number">31784</span>, <span class="number">32185</span>, <span class="number">18438</span>, <span class="number">9983</span>, <span class="number">9362</span>, <span class="number">46554</span>, <span class="number">8294</span>, <span class="number">11447</span>, <span class="number">38253</span>, <span class="number">32008</span>, <span class="number">44252</span>, <span class="number">14392</span>, <span class="number">36259</span>, <span class="number">40422</span>, <span class="number">53018</span>, <span class="number">41387</span>, <span class="number">61549</span>, <span class="number">43601</span>, <span class="number">24082</span>, <span class="number">64942</span>, <span class="number">50817</span>, <span class="number">18470</span>, <span class="number">52024</span>, <span class="number">19769</span>, <span class="number">38618</span>, <span class="number">54451</span>, <span class="number">44579</span>, <span class="number">48552</span>, <span class="number">52967</span>, <span class="number">3546</span>, <span class="number">13047</span>, <span class="number">19986</span>, <span class="number">752</span>, <span class="number">25560</span>, <span class="number">33608</span>, <span class="number">55220</span>, <span class="number">35170</span>, <span class="number">17378</span>, <span class="number">3632</span>, <span class="number">7932</span>, <span class="number">12764</span>, <span class="number">28016</span>, <span class="number">51153</span>, <span class="number">42067</span>, <span class="number">22380</span>, <span class="number">11170</span>, <span class="number">35549</span>, <span class="number">14546</span>, <span class="number">6725</span>, <span class="number">50718</span>, <span class="number">40157</span>, <span class="number">54482</span>, <span class="number">45086</span>, <span class="number">50180</span>, <span class="number">44396</span>, <span class="number">19469</span>, <span class="number">48734</span>, <span class="number">9003</span>, <span class="number">32234</span>, <span class="number">4973</span>, <span class="number">19031</span>, <span class="number">32744</span>, <span class="number">15216</span>, <span class="number">11167</span>, <span class="number">31666</span>, <span class="number">50585</span>, <span class="number">28017</span>, <span class="number">56213</span>, <span class="number">23276</span>, <span class="number">62789</span>, <span class="number">19240</span>, <span class="number">52247</span>, <span class="number">51360</span>, <span class="number">23933</span>, <span class="number">2117</span>, <span class="number">23909</span>, <span class="number">20136</span>, <span class="number">11108</span>, <span class="number">55792</span>, <span class="number">10848</span>, <span class="number">42772</span>, <span class="number">52949</span>, <span class="number">20973</span>, <span class="number">49997</span>, <span class="number">20027</span>, <span class="number">26803</span>, <span class="number">34251</span>, <span class="number">18768</span>, <span class="number">1273</span>, <span class="number">21372</span>, <span class="number">57638</span>, <span class="number">43004</span>, <span class="number">27339</span>, <span class="number">51671</span>, <span class="number">4505</span>, <span class="number">7193</span>, <span class="number">64268</span>, <span class="number">15856</span>, <span class="number">9038</span>, <span class="number">63520</span>, <span class="number">62076</span>, <span class="number">41936</span>, <span class="number">27929</span>, <span class="number">23469</span>, <span class="number">55533</span>, <span class="number">25007</span>, <span class="number">31555</span>, <span class="number">15349</span>, <span class="number">11603</span>, <span class="number">51345</span>, <span class="number">44304</span>, <span class="number">49007</span>, <span class="number">35765</span>, <span class="number">50361</span>, <span class="number">48434</span>, <span class="number">41407</span>, <span class="number">41415</span>, <span class="number">27322</span>, <span class="number">45767</span>, <span class="number">56009</span>, <span class="number">17808</span>, <span class="number">36797</span>, <span class="number">55785</span>, <span class="number">18842</span>, <span class="number">27904</span>, <span class="number">55984</span>, <span class="number">54213</span>, <span class="number">25742</span>, <span class="number">30451</span>, <span class="number">13819</span>, <span class="number">37675</span>, <span class="number">23224</span>, <span class="number">18337</span>, <span class="number">63137</span>, <span class="number">40370</span>, <span class="number">39116</span>, <span class="number">53931</span>, <span class="number">7352</span>, <span class="number">5724</span>, <span class="number">14040</span>, <span class="number">13609</span>, <span class="number">34023</span>, <span class="number">39058</span>, <span class="number">59660</span>, <span class="number">20699</span>, <span class="number">5752</span>, <span class="number">594</span>, <span class="number">53440</span>, <span class="number">58700</span>, <span class="number">58977</span>, <span class="number">11902</span>, <span class="number">11358</span>, <span class="number">54271</span>, <span class="number">52581</span>, <span class="number">63883</span>, <span class="number">4496</span>, <span class="number">65446</span>, <span class="number">8092</span>, <span class="number">32955</span>, <span class="number">1788</span>, <span class="number">7547</span>, <span class="number">30827</span>, <span class="number">42738</span>, <span class="number">51248</span>, <span class="number">13433</span>, <span class="number">52570</span>, <span class="number">45277</span>, <span class="number">4811</span>, <span class="number">59546</span>, <span class="number">17021</span>, <span class="number">32981</span>, <span class="number">6168</span>, <span class="number">45440</span>, <span class="number">41446</span>, <span class="number">43907</span>, <span class="number">44327</span>, <span class="number">22960</span>, <span class="number">48214</span>, <span class="number">53682</span>, <span class="number">39618</span>, <span class="number">65392</span>, <span class="number">31131</span>, <span class="number">36083</span>, <span class="number">31230</span>, <span class="number">15227</span>, <span class="number">1530</span>, <span class="number">21222</span>, <span class="number">11049</span>, <span class="number">27763</span>, <span class="number">5251</span>, <span class="number">56978</span>, <span class="number">12249</span>, <span class="number">55352</span>, <span class="number">54216</span>, <span class="number">24824</span>, <span class="number">65111</span>, <span class="number">21374</span>, <span class="number">42945</span>, <span class="number">57027</span>, <span class="number">3920</span>, <span class="number">32541</span>, <span class="number">65155</span>, <span class="number">12251</span>, <span class="number">19929</span>, <span class="number">19866</span>, <span class="number">58236</span>, <span class="number">22788</span>, <span class="number">54575</span>, <span class="number">53449</span>, <span class="number">16521</span>, <span class="number">55829</span>, <span class="number">14990</span>, <span class="number">8653</span>, <span class="number">55846</span>, <span class="number">6198</span>, <span class="number">24332</span>, <span class="number">28673</span>, <span class="number">50260</span>, <span class="number">60726</span>, <span class="number">55293</span>, <span class="number">35325</span>, <span class="number">4142</span>, <span class="number">28883</span>, <span class="number">19302</span>, <span class="number">31711</span>, <span class="number">10833</span>, <span class="number">62836</span>, <span class="number">27199</span>, <span class="number">14853</span>, <span class="number">21172</span>, <span class="number">61281</span>, <span class="number">43290</span>, <span class="number">23364</span>, <span class="number">62192</span>, <span class="number">58280</span>, <span class="number">64481</span>, <span class="number">40708</span>, <span class="number">17966</span>, <span class="number">54004</span>, <span class="number">1651</span>, <span class="number">1008</span>, <span class="number">12674</span>, <span class="number">54156</span>, <span class="number">48976</span>, <span class="number">60163</span>, <span class="number">47799</span>, <span class="number">14781</span>, <span class="number">37556</span>, <span class="number">58786</span>, <span class="number">14677</span>, <span class="number">16666</span>, <span class="number">22398</span>, <span class="number">41273</span>, <span class="number">22312</span>, <span class="number">49859</span>, <span class="number">4327</span>, <span class="number">54222</span>, <span class="number">52527</span>, <span class="number">35043</span>, <span class="number">35462</span>, <span class="number">33939</span>, <span class="number">30396</span>, <span class="number">17371</span>, <span class="number">10883</span>, <span class="number">42056</span>, <span class="number">31285</span>, <span class="number">7486</span>, <span class="number">33758</span>, <span class="number">62824</span>, <span class="number">58144</span>, <span class="number">19003</span>, <span class="number">17210</span>, <span class="number">28590</span>, <span class="number">39138</span>, <span class="number">20818</span>, <span class="number">58339</span>, <span class="number">7397</span>, <span class="number">30592</span>, <span class="number">54635</span>, <span class="number">33004</span>, <span class="number">6524</span>, <span class="number">54578</span>, <span class="number">21592</span>, <span class="number">33877</span>, <span class="number">37330</span>, <span class="number">51484</span>, <span class="number">18861</span>, <span class="number">26317</span>, <span class="number">426</span>, <span class="number">6365</span>, <span class="number">34363</span>, <span class="number">21922</span>, <span class="number">33037</span>, <span class="number">22209</span>, <span class="number">63283</span>, <span class="number">6463</span>, <span class="number">22503</span>, <span class="number">32397</span>, <span class="number">54053</span>, <span class="number">8538</span>, <span class="number">37449</span>, <span class="number">39658</span>, <span class="number">34111</span>, <span class="number">49684</span>, <span class="number">27364</span>, <span class="number">55762</span>, <span class="number">2892</span>, <span class="number">64875</span>, <span class="number">17558</span>, <span class="number">45202</span>, <span class="number">37747</span>, <span class="number">61781</span>, <span class="number">39006</span>, <span class="number">5</span>, <span class="number">55444</span>, <span class="number">4965</span>, <span class="number">65360</span>, <span class="number">45810</span>, <span class="number">23739</span>, <span class="number">51172</span>, <span class="number">37274</span>, <span class="number">39909</span>, <span class="number">58863</span>, <span class="number">28111</span>, <span class="number">449</span>, <span class="number">14406</span>, <span class="number">62190</span>, <span class="number">13688</span>, <span class="number">57145</span>, <span class="number">23653</span>, <span class="number">56791</span>, <span class="number">4065</span>, <span class="number">13079</span>, <span class="number">59309</span>, <span class="number">57940</span>, <span class="number">59317</span>, <span class="number">17968</span>, <span class="number">28037</span>, <span class="number">27233</span>, <span class="number">53242</span>, <span class="number">30901</span>, <span class="number">10758</span>, <span class="number">57188</span>, <span class="number">9100</span>, <span class="number">51760</span>, <span class="number">16566</span>, <span class="number">20555</span>, <span class="number">50514</span>, <span class="number">35271</span>, <span class="number">59680</span>, <span class="number">24646</span>, <span class="number">14768</span>, <span class="number">13335</span>, <span class="number">30246</span>, <span class="number">39364</span>, <span class="number">51795</span>, <span class="number">5031</span>, <span class="number">38107</span>, <span class="number">32158</span>, <span class="number">443</span>, <span class="number">10384</span>, <span class="number">6774</span>, <span class="number">47929</span>, <span class="number">15499</span>, <span class="number">50368</span>, <span class="number">51827</span>, <span class="number">54022</span>, <span class="number">18908</span>, <span class="number">2157</span>, <span class="number">9827</span>, <span class="number">14658</span>, <span class="number">16901</span>, <span class="number">40891</span>, <span class="number">5884</span>, <span class="number">51302</span>, <span class="number">10387</span>, <span class="number">10960</span>, <span class="number">16761</span>, <span class="number">26793</span>, <span class="number">55085</span>, <span class="number">35673</span>, <span class="number">35137</span>, <span class="number">13497</span>, <span class="number">28211</span>, <span class="number">60579</span>, <span class="number">60497</span>, <span class="number">47403</span>, <span class="number">9106</span>, <span class="number">59526</span>, <span class="number">10327</span>, <span class="number">8063</span>, <span class="number">41945</span>, <span class="number">5754</span>, <span class="number">57621</span>, <span class="number">26709</span>, <span class="number">22739</span>, <span class="number">25547</span>, <span class="number">24703</span>, <span class="number">20746</span>, <span class="number">3895</span>, <span class="number">44111</span>, <span class="number">51320</span>, <span class="number">42212</span>, <span class="number">59781</span>, <span class="number">29064</span>, <span class="number">44610</span>, <span class="number">16431</span>, <span class="number">39515</span>, <span class="number">18156</span>, <span class="number">14210</span>, <span class="number">27507</span>, <span class="number">47206</span>, <span class="number">41530</span>, <span class="number">44123</span>, <span class="number">29499</span>, <span class="number">47242</span>, <span class="number">50363</span>, <span class="number">3339</span>, <span class="number">57490</span>, <span class="number">36566</span>, <span class="number">48636</span>, <span class="number">49784</span>, <span class="number">10942</span>, <span class="number">64447</span>, <span class="number">26791</span>, <span class="number">52829</span>, <span class="number">53204</span>, <span class="number">55163</span>, <span class="number">32261</span>, <span class="number">32157</span>, <span class="number">58261</span>, <span class="number">41129</span>, <span class="number">60614</span>, <span class="number">30034</span>, <span class="number">55489</span>, <span class="number">55576</span>, <span class="number">25052</span>, <span class="number">4263</span>, <span class="number">32514</span>, <span class="number">1419</span>, <span class="number">22605</span>, <span class="number">56589</span>, <span class="number">48192</span>, <span class="number">44655</span>, <span class="number">61295</span>, <span class="number">8855</span>, <span class="number">42987</span>, <span class="number">26448</span>, <span class="number">33214</span>, <span class="number">46651</span>, <span class="number">56194</span>, <span class="number">28472</span>, <span class="number">12965</span>]</span><br><span class="line">flag_md5 = f5accae4111e6f6db6d4342a7662b970</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line">prng = Random()</span><br><span class="line">length = <span class="number">19968</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myState</span>():</span><br><span class="line">    state = [<span class="number">0</span>]*<span class="number">624</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> i&lt;length:</span><br><span class="line">        ind = i//<span class="number">32</span></span><br><span class="line">        expont = i%<span class="number">32</span></span><br><span class="line">        state[ind] = <span class="number">1</span>&lt;&lt;(<span class="number">31</span>-expont)</span><br><span class="line">        s = (<span class="number">3</span>,<span class="built_in">tuple</span>(state+[<span class="number">0</span>]),<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">yield</span> s</span><br><span class="line">        state[ind] = <span class="number">0</span></span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getRow</span>():</span><br><span class="line">    rng = Random()</span><br><span class="line">    gs = myState()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        s = <span class="built_in">next</span>(gs)</span><br><span class="line">        rng.setstate(s)</span><br><span class="line"><span class="comment">#         print(s[1][0])</span></span><br><span class="line">        data=[]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">16</span>):</span><br><span class="line">            data.extend(<span class="built_in">list</span>(<span class="built_in">bin</span>(rng.getrandbits(<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">16</span>)))</span><br><span class="line">        data=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> data]</span><br><span class="line">        row = vector(GF(<span class="number">2</span>),data)</span><br><span class="line">        <span class="keyword">yield</span> row</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildBox</span>():</span><br><span class="line">    b = matrix(GF(<span class="number">2</span>),length,length)</span><br><span class="line">    rg = getRow()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(length)):</span><br><span class="line">        b[i] = <span class="built_in">next</span>(rg)</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    prng = Random()</span><br><span class="line">    originState = prng.getstate()</span><br><span class="line">    <span class="comment"># 这里都是用的MSB,如果采用不同的二进制位(如LSB)最后的矩阵T 也会不同</span></span><br><span class="line">    leak=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">16</span>):</span><br><span class="line">        leak.extend(<span class="built_in">list</span>(<span class="built_in">bin</span>(prng.getrandbits(<span class="number">16</span>))[<span class="number">2</span>:].zfill(<span class="number">16</span>)))</span><br><span class="line">    leak=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> leak]</span><br><span class="line">    leak = vector(GF(<span class="number">2</span>),leak)</span><br><span class="line">    T = buildBox()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Matirx&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> trange(T.nrows()):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(T.ncols()):</span><br><span class="line">                f.write(<span class="built_in">str</span>(T[i,j])+<span class="string">&#x27;n&#x27;</span>)</span><br><span class="line">    x = T.solve_left(leak)</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x.<span class="built_in">list</span>()])</span><br><span class="line">    state = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        tmp = <span class="built_in">int</span>(x[i*<span class="number">32</span>:(i+<span class="number">1</span>)*<span class="number">32</span>],<span class="number">2</span>)</span><br><span class="line">        state.append(tmp)</span><br><span class="line">    prng.setstate(originState)</span><br><span class="line">    prng.getrandbits(<span class="number">16</span>)</span><br><span class="line">    originState = [x <span class="keyword">for</span> x <span class="keyword">in</span> prng.getstate()[<span class="number">1</span>][:-<span class="number">1</span>]]</span><br><span class="line">    <span class="built_in">print</span>(originState[<span class="number">1</span>:] == state[<span class="number">1</span>:])</span><br><span class="line"><span class="comment">#     print(state)</span></span><br><span class="line">    <span class="keyword">return</span> state,T</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> build_matrix <span class="keyword">import</span> test</span><br><span class="line"><span class="comment"># 根据文件中的信息，构造矩阵</span></span><br><span class="line">length = <span class="number">19968</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildMatrix</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;Matrix&quot;</span>,<span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> f.read().split(<span class="string">&#x27;n&#x27;</span>)]</span><br><span class="line">    m=matrix(GF(<span class="number">2</span>),length,length,data)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># X = Z*(T^-1)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recoverState</span>(<span class="params">T,leak</span>):</span><br><span class="line">    x = T.solve_left(leak)</span><br><span class="line">    x = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x.<span class="built_in">list</span>()])</span><br><span class="line">    state = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">        tmp = <span class="built_in">int</span>(x[i * <span class="number">32</span>:(i + <span class="number">1</span>) * <span class="number">32</span>], <span class="number">2</span>)</span><br><span class="line">        state.append(tmp)</span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据题型2,还原state,有两种可能,这时候可以用暴破</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backfirst</span>(<span class="params">state</span>):</span><br><span class="line">    high = <span class="number">0x80000000</span></span><br><span class="line">    low = <span class="number">0x7fffffff</span></span><br><span class="line">    mask = <span class="number">0x9908b0df</span></span><br><span class="line">    tmp = state[<span class="number">623</span>] ^ state[<span class="number">396</span>]</span><br><span class="line">    <span class="keyword">if</span> tmp &amp; high == high:</span><br><span class="line">        tmp ^= mask</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">        tmp |= <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        tmp &lt;&lt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> &lt;&lt; <span class="number">32</span> - <span class="number">1</span>) | tmp &amp; low, tmp &amp; low</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    _, T = test()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;构建完成&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;T完成&quot;</span>)</span><br><span class="line">    prng = Random()</span><br><span class="line">    originState = prng.getstate()</span><br><span class="line">    leak=[<span class="number">47945</span>, <span class="number">50431</span>, <span class="number">10861</span>, <span class="number">5794</span>, <span class="number">26338</span>, <span class="number">2641</span>, <span class="number">58647</span>, <span class="number">52422</span>, <span class="number">35384</span>, <span class="number">50426</span>, <span class="number">58144</span>, <span class="number">2744</span>, <span class="number">7864</span>, <span class="number">25333</span>, <span class="number">3500</span>, <span class="number">59273</span>, <span class="number">38075</span>, <span class="number">38630</span>, <span class="number">18760</span>, <span class="number">19660</span>, <span class="number">54418</span>, <span class="number">53538</span>, <span class="number">20251</span>, <span class="number">25758</span>, <span class="number">4500</span>, <span class="number">14384</span>, <span class="number">40765</span>, <span class="number">43841</span>, <span class="number">62662</span>, <span class="number">64548</span>, <span class="number">6468</span>, <span class="number">8997</span>, <span class="number">20572</span>, <span class="number">9920</span>, <span class="number">64146</span>, <span class="number">49443</span>, <span class="number">32054</span>, <span class="number">56082</span>, <span class="number">21773</span>, <span class="number">38390</span>, <span class="number">14905</span>, <span class="number">47230</span>, <span class="number">43126</span>, <span class="number">37449</span>, <span class="number">1016</span>, <span class="number">23685</span>, <span class="number">48461</span>, <span class="number">13070</span>, <span class="number">58381</span>, <span class="number">51813</span>, <span class="number">48909</span>, <span class="number">10953</span>, <span class="number">31195</span>, <span class="number">1703</span>, <span class="number">33439</span>, <span class="number">54463</span>, <span class="number">63977</span>, <span class="number">29188</span>, <span class="number">44901</span>, <span class="number">53588</span>, <span class="number">32843</span>, <span class="number">9923</span>, <span class="number">2188</span>, <span class="number">42503</span>, <span class="number">53555</span>, <span class="number">44818</span>, <span class="number">55094</span>, <span class="number">40544</span>, <span class="number">25787</span>, <span class="number">34965</span>, <span class="number">65151</span>, <span class="number">37069</span>, <span class="number">6342</span>, <span class="number">36889</span>, <span class="number">51214</span>, <span class="number">58386</span>, <span class="number">34925</span>, <span class="number">9558</span>, <span class="number">33552</span>, <span class="number">29554</span>, <span class="number">30350</span>, <span class="number">20166</span>, <span class="number">4221</span>, <span class="number">61353</span>, <span class="number">50656</span>, <span class="number">7337</span>, <span class="number">1001</span>, <span class="number">18279</span>, <span class="number">27268</span>, <span class="number">49581</span>, <span class="number">37870</span>, <span class="number">54591</span>, <span class="number">12438</span>, <span class="number">13649</span>, <span class="number">42007</span>, <span class="number">33542</span>, <span class="number">18118</span>, <span class="number">48407</span>, <span class="number">34338</span>, <span class="number">12147</span>, <span class="number">19178</span>, <span class="number">8925</span>, <span class="number">31109</span>, <span class="number">12296</span>, <span class="number">52419</span>, <span class="number">392</span>, <span class="number">9296</span>, <span class="number">16055</span>, <span class="number">64775</span>, <span class="number">46394</span>, <span class="number">58494</span>, <span class="number">24157</span>, <span class="number">62237</span>, <span class="number">16211</span>, <span class="number">23935</span>, <span class="number">10368</span>, <span class="number">48440</span>, <span class="number">60061</span>, <span class="number">47813</span>, <span class="number">49032</span>, <span class="number">50836</span>, <span class="number">18404</span>, <span class="number">30552</span>, <span class="number">7142</span>, <span class="number">44142</span>, <span class="number">44549</span>, <span class="number">36078</span>, <span class="number">63112</span>, <span class="number">28345</span>, <span class="number">39821</span>, <span class="number">10004</span>, <span class="number">32221</span>, <span class="number">16021</span>, <span class="number">32152</span>, <span class="number">53113</span>, <span class="number">13857</span>, <span class="number">49328</span>, <span class="number">11817</span>, <span class="number">27777</span>, <span class="number">43088</span>, <span class="number">43453</span>, <span class="number">29962</span>, <span class="number">16338</span>, <span class="number">44353</span>, <span class="number">27974</span>, <span class="number">25145</span>, <span class="number">56050</span>, <span class="number">34129</span>, <span class="number">39236</span>, <span class="number">46167</span>, <span class="number">64639</span>, <span class="number">54581</span>, <span class="number">33004</span>, <span class="number">35652</span>, <span class="number">16294</span>, <span class="number">11109</span>, <span class="number">19396</span>, <span class="number">51476</span>, <span class="number">30332</span>, <span class="number">24701</span>, <span class="number">43628</span>, <span class="number">44507</span>, <span class="number">27688</span>, <span class="number">37172</span>, <span class="number">61339</span>, <span class="number">9893</span>, <span class="number">45217</span>, <span class="number">7969</span>, <span class="number">33523</span>, <span class="number">2495</span>, <span class="number">15578</span>, <span class="number">55444</span>, <span class="number">48564</span>, <span class="number">5055</span>, <span class="number">16048</span>, <span class="number">8512</span>, <span class="number">1819</span>, <span class="number">19702</span>, <span class="number">13388</span>, <span class="number">41099</span>, <span class="number">30256</span>, <span class="number">10592</span>, <span class="number">46063</span>, <span class="number">30881</span>, <span class="number">8338</span>, <span class="number">41214</span>, <span class="number">55255</span>, <span class="number">50060</span>, <span class="number">65028</span>, <span class="number">9114</span>, <span class="number">8417</span>, <span class="number">43767</span>, <span class="number">62760</span>, <span class="number">49830</span>, <span class="number">50660</span>, <span class="number">19358</span>, <span class="number">22142</span>, <span class="number">53025</span>, <span class="number">37930</span>, <span class="number">49155</span>, <span class="number">2150</span>, <span class="number">56194</span>, <span class="number">36251</span>, <span class="number">49654</span>, <span class="number">32395</span>, <span class="number">33677</span>, <span class="number">48743</span>, <span class="number">12627</span>, <span class="number">30575</span>, <span class="number">64001</span>, <span class="number">60220</span>, <span class="number">26908</span>, <span class="number">44207</span>, <span class="number">23532</span>, <span class="number">18430</span>, <span class="number">45511</span>, <span class="number">33553</span>, <span class="number">62631</span>, <span class="number">55155</span>, <span class="number">58715</span>, <span class="number">59152</span>, <span class="number">20864</span>, <span class="number">14790</span>, <span class="number">32774</span>, <span class="number">48679</span>, <span class="number">24325</span>, <span class="number">54109</span>, <span class="number">2747</span>, <span class="number">17046</span>, <span class="number">19083</span>, <span class="number">60413</span>, <span class="number">11773</span>, <span class="number">42188</span>, <span class="number">17011</span>, <span class="number">13361</span>, <span class="number">2105</span>, <span class="number">23067</span>, <span class="number">45439</span>, <span class="number">1122</span>, <span class="number">54117</span>, <span class="number">31435</span>, <span class="number">49692</span>, <span class="number">59556</span>, <span class="number">51893</span>, <span class="number">24342</span>, <span class="number">11073</span>, <span class="number">52326</span>, <span class="number">23237</span>, <span class="number">22930</span>, <span class="number">12691</span>, <span class="number">38125</span>, <span class="number">36714</span>, <span class="number">54043</span>, <span class="number">34880</span>, <span class="number">53599</span>, <span class="number">18609</span>, <span class="number">36631</span>, <span class="number">24367</span>, <span class="number">49135</span>, <span class="number">26821</span>, <span class="number">64486</span>, <span class="number">12154</span>, <span class="number">37534</span>, <span class="number">14100</span>, <span class="number">33744</span>, <span class="number">37183</span>, <span class="number">7652</span>, <span class="number">26403</span>, <span class="number">42166</span>, <span class="number">12290</span>, <span class="number">32315</span>, <span class="number">19153</span>, <span class="number">55490</span>, <span class="number">4558</span>, <span class="number">60768</span>, <span class="number">44149</span>, <span class="number">26258</span>, <span class="number">38676</span>, <span class="number">31228</span>, <span class="number">43610</span>, <span class="number">39357</span>, <span class="number">36475</span>, <span class="number">29434</span>, <span class="number">41437</span>, <span class="number">64762</span>, <span class="number">5251</span>, <span class="number">33641</span>, <span class="number">43819</span>, <span class="number">29769</span>, <span class="number">38136</span>, <span class="number">8348</span>, <span class="number">33123</span>, <span class="number">17571</span>, <span class="number">18343</span>, <span class="number">50569</span>, <span class="number">55502</span>, <span class="number">7371</span>, <span class="number">14515</span>, <span class="number">41553</span>, <span class="number">12979</span>, <span class="number">1276</span>, <span class="number">45454</span>, <span class="number">56057</span>, <span class="number">51518</span>, <span class="number">30382</span>, <span class="number">30678</span>, <span class="number">60443</span>, <span class="number">58274</span>, <span class="number">50882</span>, <span class="number">64918</span>, <span class="number">34569</span>, <span class="number">58195</span>, <span class="number">34410</span>, <span class="number">47490</span>, <span class="number">13676</span>, <span class="number">37502</span>, <span class="number">61987</span>, <span class="number">7616</span>, <span class="number">11528</span>, <span class="number">13577</span>, <span class="number">51098</span>, <span class="number">5435</span>, <span class="number">51972</span>, <span class="number">63061</span>, <span class="number">55995</span>, <span class="number">21627</span>, <span class="number">2439</span>, <span class="number">47554</span>, <span class="number">6891</span>, <span class="number">53790</span>, <span class="number">62563</span>, <span class="number">38921</span>, <span class="number">30600</span>, <span class="number">49498</span>, <span class="number">49671</span>, <span class="number">38844</span>, <span class="number">42840</span>, <span class="number">49982</span>, <span class="number">16503</span>, <span class="number">13854</span>, <span class="number">63825</span>, <span class="number">25195</span>, <span class="number">41078</span>, <span class="number">36872</span>, <span class="number">36288</span>, <span class="number">63461</span>, <span class="number">29293</span>, <span class="number">28630</span>, <span class="number">23547</span>, <span class="number">57332</span>, <span class="number">43051</span>, <span class="number">49205</span>, <span class="number">14579</span>, <span class="number">23897</span>, <span class="number">944</span>, <span class="number">47223</span>, <span class="number">6819</span>, <span class="number">61851</span>, <span class="number">57886</span>, <span class="number">10858</span>, <span class="number">14380</span>, <span class="number">35796</span>, <span class="number">4509</span>, <span class="number">52576</span>, <span class="number">47112</span>, <span class="number">44349</span>, <span class="number">56553</span>, <span class="number">45075</span>, <span class="number">31505</span>, <span class="number">2779</span>, <span class="number">17216</span>, <span class="number">47395</span>, <span class="number">15024</span>, <span class="number">26498</span>, <span class="number">25299</span>, <span class="number">26548</span>, <span class="number">39954</span>, <span class="number">33242</span>, <span class="number">65187</span>, <span class="number">33291</span>, <span class="number">38861</span>, <span class="number">6956</span>, <span class="number">4371</span>, <span class="number">11762</span>, <span class="number">41126</span>, <span class="number">54447</span>, <span class="number">56384</span>, <span class="number">34835</span>, <span class="number">595</span>, <span class="number">52198</span>, <span class="number">13324</span>, <span class="number">38653</span>, <span class="number">21103</span>, <span class="number">34301</span>, <span class="number">20781</span>, <span class="number">64650</span>, <span class="number">17773</span>, <span class="number">1921</span>, <span class="number">46490</span>, <span class="number">37683</span>, <span class="number">27720</span>, <span class="number">7812</span>, <span class="number">49737</span>, <span class="number">20423</span>, <span class="number">16452</span>, <span class="number">52475</span>, <span class="number">27896</span>, <span class="number">49613</span>, <span class="number">60121</span>, <span class="number">54986</span>, <span class="number">30680</span>, <span class="number">37740</span>, <span class="number">8407</span>, <span class="number">30833</span>, <span class="number">29431</span>, <span class="number">62841</span>, <span class="number">27957</span>, <span class="number">57755</span>, <span class="number">59153</span>, <span class="number">44802</span>, <span class="number">42423</span>, <span class="number">28202</span>, <span class="number">54075</span>, <span class="number">3879</span>, <span class="number">25261</span>, <span class="number">57958</span>, <span class="number">53266</span>, <span class="number">22806</span>, <span class="number">64334</span>, <span class="number">34962</span>, <span class="number">57708</span>, <span class="number">20653</span>, <span class="number">17925</span>, <span class="number">59244</span>, <span class="number">38640</span>, <span class="number">31264</span>, <span class="number">7962</span>, <span class="number">5234</span>, <span class="number">16995</span>, <span class="number">35712</span>, <span class="number">39263</span>, <span class="number">33764</span>, <span class="number">9168</span>, <span class="number">59263</span>, <span class="number">6297</span>, <span class="number">28879</span>, <span class="number">54753</span>, <span class="number">31041</span>, <span class="number">42448</span>, <span class="number">57238</span>, <span class="number">52395</span>, <span class="number">61412</span>, <span class="number">29370</span>, <span class="number">52297</span>, <span class="number">21906</span>, <span class="number">36837</span>, <span class="number">62511</span>, <span class="number">13185</span>, <span class="number">53251</span>, <span class="number">47459</span>, <span class="number">47320</span>, <span class="number">24874</span>, <span class="number">5152</span>, <span class="number">63178</span>, <span class="number">20614</span>, <span class="number">808</span>, <span class="number">6789</span>, <span class="number">37043</span>, <span class="number">9713</span>, <span class="number">31692</span>, <span class="number">18319</span>, <span class="number">60295</span>, <span class="number">9628</span>, <span class="number">1053</span>, <span class="number">54874</span>, <span class="number">26808</span>, <span class="number">28046</span>, <span class="number">27964</span>, <span class="number">7534</span>, <span class="number">43316</span>, <span class="number">51573</span>, <span class="number">51143</span>, <span class="number">41954</span>, <span class="number">16366</span>, <span class="number">19618</span>, <span class="number">23676</span>, <span class="number">63245</span>, <span class="number">28329</span>, <span class="number">25170</span>, <span class="number">55118</span>, <span class="number">49376</span>, <span class="number">22296</span>, <span class="number">41638</span>, <span class="number">42595</span>, <span class="number">49291</span>, <span class="number">51001</span>, <span class="number">21173</span>, <span class="number">17098</span>, <span class="number">11956</span>, <span class="number">33292</span>, <span class="number">28909</span>, <span class="number">63160</span>, <span class="number">63480</span>, <span class="number">32649</span>, <span class="number">49809</span>, <span class="number">24112</span>, <span class="number">59503</span>, <span class="number">38840</span>, <span class="number">22914</span>, <span class="number">17473</span>, <span class="number">51978</span>, <span class="number">25420</span>, <span class="number">64060</span>, <span class="number">58894</span>, <span class="number">35793</span>, <span class="number">57163</span>, <span class="number">59038</span>, <span class="number">58787</span>, <span class="number">64067</span>, <span class="number">55780</span>, <span class="number">61906</span>, <span class="number">1696</span>, <span class="number">156</span>, <span class="number">25499</span>, <span class="number">57706</span>, <span class="number">47842</span>, <span class="number">47243</span>, <span class="number">14668</span>, <span class="number">17052</span>, <span class="number">57195</span>, <span class="number">53288</span>, <span class="number">49178</span>, <span class="number">2557</span>, <span class="number">31221</span>, <span class="number">17492</span>, <span class="number">11560</span>, <span class="number">23012</span>, <span class="number">9147</span>, <span class="number">44260</span>, <span class="number">22094</span>, <span class="number">53197</span>, <span class="number">40404</span>, <span class="number">21209</span>, <span class="number">30940</span>, <span class="number">18586</span>, <span class="number">48011</span>, <span class="number">60631</span>, <span class="number">8838</span>, <span class="number">13044</span>, <span class="number">5480</span>, <span class="number">19584</span>, <span class="number">20231</span>, <span class="number">15078</span>, <span class="number">58154</span>, <span class="number">8305</span>, <span class="number">55680</span>, <span class="number">49974</span>, <span class="number">2861</span>, <span class="number">58626</span>, <span class="number">61041</span>, <span class="number">47937</span>, <span class="number">42776</span>, <span class="number">35207</span>, <span class="number">39418</span>, <span class="number">12989</span>, <span class="number">1507</span>, <span class="number">5082</span>, <span class="number">23278</span>, <span class="number">26969</span>, <span class="number">10328</span>, <span class="number">18480</span>, <span class="number">34160</span>, <span class="number">55965</span>, <span class="number">59869</span>, <span class="number">197</span>, <span class="number">38066</span>, <span class="number">17097</span>, <span class="number">49306</span>, <span class="number">12749</span>, <span class="number">21846</span>, <span class="number">9946</span>, <span class="number">12323</span>, <span class="number">39813</span>, <span class="number">19141</span>, <span class="number">14950</span>, <span class="number">15987</span>, <span class="number">33630</span>, <span class="number">14715</span>, <span class="number">52499</span>, <span class="number">15978</span>, <span class="number">24078</span>, <span class="number">60217</span>, <span class="number">32262</span>, <span class="number">11645</span>, <span class="number">1649</span>, <span class="number">50062</span>, <span class="number">21979</span>, <span class="number">30545</span>, <span class="number">1450</span>, <span class="number">48657</span>, <span class="number">41697</span>, <span class="number">23357</span>, <span class="number">17880</span>, <span class="number">27613</span>, <span class="number">38277</span>, <span class="number">54988</span>, <span class="number">11074</span>, <span class="number">57591</span>, <span class="number">183</span>, <span class="number">62803</span>, <span class="number">8532</span>, <span class="number">61133</span>, <span class="number">26944</span>, <span class="number">63400</span>, <span class="number">53095</span>, <span class="number">8663</span>, <span class="number">59702</span>, <span class="number">19325</span>, <span class="number">24726</span>, <span class="number">51297</span>, <span class="number">21286</span>, <span class="number">2373</span>, <span class="number">38774</span>, <span class="number">20677</span>, <span class="number">29443</span>, <span class="number">24693</span>, <span class="number">20621</span>, <span class="number">14031</span>, <span class="number">45485</span>, <span class="number">34645</span>, <span class="number">9926</span>, <span class="number">12620</span>, <span class="number">1406</span>, <span class="number">41462</span>, <span class="number">50338</span>, <span class="number">25841</span>, <span class="number">61724</span>, <span class="number">41722</span>, <span class="number">11520</span>, <span class="number">48377</span>, <span class="number">34111</span>, <span class="number">50805</span>, <span class="number">23351</span>, <span class="number">64363</span>, <span class="number">50091</span>, <span class="number">35487</span>, <span class="number">49978</span>, <span class="number">41001</span>, <span class="number">37117</span>, <span class="number">17133</span>, <span class="number">54868</span>, <span class="number">58918</span>, <span class="number">17295</span>, <span class="number">16857</span>, <span class="number">45165</span>, <span class="number">5732</span>, <span class="number">46277</span>, <span class="number">54359</span>, <span class="number">64982</span>, <span class="number">2336</span>, <span class="number">61929</span>, <span class="number">40501</span>, <span class="number">18901</span>, <span class="number">39938</span>, <span class="number">949</span>, <span class="number">45839</span>, <span class="number">7519</span>, <span class="number">36935</span>, <span class="number">55287</span>, <span class="number">21096</span>, <span class="number">44443</span>, <span class="number">12240</span>, <span class="number">16160</span>, <span class="number">28355</span>, <span class="number">42275</span>, <span class="number">27747</span>, <span class="number">13398</span>, <span class="number">12395</span>, <span class="number">33973</span>, <span class="number">17137</span>, <span class="number">60697</span>, <span class="number">37064</span>, <span class="number">27782</span>, <span class="number">45671</span>, <span class="number">22264</span>, <span class="number">505</span>, <span class="number">20989</span>, <span class="number">57585</span>, <span class="number">4283</span>, <span class="number">43110</span>, <span class="number">28497</span>, <span class="number">25900</span>, <span class="number">16383</span>, <span class="number">13961</span>, <span class="number">24192</span>, <span class="number">29296</span>, <span class="number">34776</span>, <span class="number">36286</span>, <span class="number">18398</span>, <span class="number">55882</span>, <span class="number">28748</span>, <span class="number">54021</span>, <span class="number">673</span>, <span class="number">22723</span>, <span class="number">23699</span>, <span class="number">48463</span>, <span class="number">17316</span>, <span class="number">55309</span>, <span class="number">54229</span>, <span class="number">28342</span>, <span class="number">11147</span>, <span class="number">16132</span>, <span class="number">24344</span>, <span class="number">53367</span>, <span class="number">45597</span>, <span class="number">42843</span>, <span class="number">27078</span>, <span class="number">4034</span>, <span class="number">16975</span>, <span class="number">18534</span>, <span class="number">29674</span>, <span class="number">36962</span>, <span class="number">60773</span>, <span class="number">8030</span>, <span class="number">17118</span>, <span class="number">7392</span>, <span class="number">41627</span>, <span class="number">44768</span>, <span class="number">51104</span>, <span class="number">10876</span>, <span class="number">16293</span>, <span class="number">54589</span>, <span class="number">65082</span>, <span class="number">62573</span>, <span class="number">2679</span>, <span class="number">23869</span>, <span class="number">61905</span>, <span class="number">52526</span>, <span class="number">51584</span>, <span class="number">57063</span>, <span class="number">27294</span>, <span class="number">51821</span>, <span class="number">9070</span>, <span class="number">30961</span>, <span class="number">38741</span>, <span class="number">36309</span>, <span class="number">57422</span>, <span class="number">58231</span>, <span class="number">32775</span>, <span class="number">57469</span>, <span class="number">2306</span>, <span class="number">43632</span>, <span class="number">6110</span>, <span class="number">17478</span>, <span class="number">3399</span>, <span class="number">60718</span>, <span class="number">23947</span>, <span class="number">21488</span>, <span class="number">41712</span>, <span class="number">43552</span>, <span class="number">34154</span>, <span class="number">35374</span>, <span class="number">17522</span>, <span class="number">16603</span>, <span class="number">53459</span>, <span class="number">52136</span>, <span class="number">49823</span>, <span class="number">21443</span>, <span class="number">35049</span>, <span class="number">4854</span>, <span class="number">25769</span>, <span class="number">63782</span>, <span class="number">21355</span>, <span class="number">11189</span>, <span class="number">17330</span>, <span class="number">41173</span>, <span class="number">6620</span>, <span class="number">24475</span>, <span class="number">40910</span>, <span class="number">26100</span>, <span class="number">34752</span>, <span class="number">10491</span>, <span class="number">39327</span>, <span class="number">561</span>, <span class="number">24612</span>, <span class="number">36253</span>, <span class="number">41875</span>, <span class="number">1589</span>, <span class="number">44536</span>, <span class="number">64133</span>, <span class="number">37260</span>, <span class="number">24719</span>, <span class="number">21955</span>, <span class="number">40847</span>, <span class="number">8529</span>, <span class="number">12294</span>, <span class="number">22158</span>, <span class="number">31784</span>, <span class="number">32185</span>, <span class="number">18438</span>, <span class="number">9983</span>, <span class="number">9362</span>, <span class="number">46554</span>, <span class="number">8294</span>, <span class="number">11447</span>, <span class="number">38253</span>, <span class="number">32008</span>, <span class="number">44252</span>, <span class="number">14392</span>, <span class="number">36259</span>, <span class="number">40422</span>, <span class="number">53018</span>, <span class="number">41387</span>, <span class="number">61549</span>, <span class="number">43601</span>, <span class="number">24082</span>, <span class="number">64942</span>, <span class="number">50817</span>, <span class="number">18470</span>, <span class="number">52024</span>, <span class="number">19769</span>, <span class="number">38618</span>, <span class="number">54451</span>, <span class="number">44579</span>, <span class="number">48552</span>, <span class="number">52967</span>, <span class="number">3546</span>, <span class="number">13047</span>, <span class="number">19986</span>, <span class="number">752</span>, <span class="number">25560</span>, <span class="number">33608</span>, <span class="number">55220</span>, <span class="number">35170</span>, <span class="number">17378</span>, <span class="number">3632</span>, <span class="number">7932</span>, <span class="number">12764</span>, <span class="number">28016</span>, <span class="number">51153</span>, <span class="number">42067</span>, <span class="number">22380</span>, <span class="number">11170</span>, <span class="number">35549</span>, <span class="number">14546</span>, <span class="number">6725</span>, <span class="number">50718</span>, <span class="number">40157</span>, <span class="number">54482</span>, <span class="number">45086</span>, <span class="number">50180</span>, <span class="number">44396</span>, <span class="number">19469</span>, <span class="number">48734</span>, <span class="number">9003</span>, <span class="number">32234</span>, <span class="number">4973</span>, <span class="number">19031</span>, <span class="number">32744</span>, <span class="number">15216</span>, <span class="number">11167</span>, <span class="number">31666</span>, <span class="number">50585</span>, <span class="number">28017</span>, <span class="number">56213</span>, <span class="number">23276</span>, <span class="number">62789</span>, <span class="number">19240</span>, <span class="number">52247</span>, <span class="number">51360</span>, <span class="number">23933</span>, <span class="number">2117</span>, <span class="number">23909</span>, <span class="number">20136</span>, <span class="number">11108</span>, <span class="number">55792</span>, <span class="number">10848</span>, <span class="number">42772</span>, <span class="number">52949</span>, <span class="number">20973</span>, <span class="number">49997</span>, <span class="number">20027</span>, <span class="number">26803</span>, <span class="number">34251</span>, <span class="number">18768</span>, <span class="number">1273</span>, <span class="number">21372</span>, <span class="number">57638</span>, <span class="number">43004</span>, <span class="number">27339</span>, <span class="number">51671</span>, <span class="number">4505</span>, <span class="number">7193</span>, <span class="number">64268</span>, <span class="number">15856</span>, <span class="number">9038</span>, <span class="number">63520</span>, <span class="number">62076</span>, <span class="number">41936</span>, <span class="number">27929</span>, <span class="number">23469</span>, <span class="number">55533</span>, <span class="number">25007</span>, <span class="number">31555</span>, <span class="number">15349</span>, <span class="number">11603</span>, <span class="number">51345</span>, <span class="number">44304</span>, <span class="number">49007</span>, <span class="number">35765</span>, <span class="number">50361</span>, <span class="number">48434</span>, <span class="number">41407</span>, <span class="number">41415</span>, <span class="number">27322</span>, <span class="number">45767</span>, <span class="number">56009</span>, <span class="number">17808</span>, <span class="number">36797</span>, <span class="number">55785</span>, <span class="number">18842</span>, <span class="number">27904</span>, <span class="number">55984</span>, <span class="number">54213</span>, <span class="number">25742</span>, <span class="number">30451</span>, <span class="number">13819</span>, <span class="number">37675</span>, <span class="number">23224</span>, <span class="number">18337</span>, <span class="number">63137</span>, <span class="number">40370</span>, <span class="number">39116</span>, <span class="number">53931</span>, <span class="number">7352</span>, <span class="number">5724</span>, <span class="number">14040</span>, <span class="number">13609</span>, <span class="number">34023</span>, <span class="number">39058</span>, <span class="number">59660</span>, <span class="number">20699</span>, <span class="number">5752</span>, <span class="number">594</span>, <span class="number">53440</span>, <span class="number">58700</span>, <span class="number">58977</span>, <span class="number">11902</span>, <span class="number">11358</span>, <span class="number">54271</span>, <span class="number">52581</span>, <span class="number">63883</span>, <span class="number">4496</span>, <span class="number">65446</span>, <span class="number">8092</span>, <span class="number">32955</span>, <span class="number">1788</span>, <span class="number">7547</span>, <span class="number">30827</span>, <span class="number">42738</span>, <span class="number">51248</span>, <span class="number">13433</span>, <span class="number">52570</span>, <span class="number">45277</span>, <span class="number">4811</span>, <span class="number">59546</span>, <span class="number">17021</span>, <span class="number">32981</span>, <span class="number">6168</span>, <span class="number">45440</span>, <span class="number">41446</span>, <span class="number">43907</span>, <span class="number">44327</span>, <span class="number">22960</span>, <span class="number">48214</span>, <span class="number">53682</span>, <span class="number">39618</span>, <span class="number">65392</span>, <span class="number">31131</span>, <span class="number">36083</span>, <span class="number">31230</span>, <span class="number">15227</span>, <span class="number">1530</span>, <span class="number">21222</span>, <span class="number">11049</span>, <span class="number">27763</span>, <span class="number">5251</span>, <span class="number">56978</span>, <span class="number">12249</span>, <span class="number">55352</span>, <span class="number">54216</span>, <span class="number">24824</span>, <span class="number">65111</span>, <span class="number">21374</span>, <span class="number">42945</span>, <span class="number">57027</span>, <span class="number">3920</span>, <span class="number">32541</span>, <span class="number">65155</span>, <span class="number">12251</span>, <span class="number">19929</span>, <span class="number">19866</span>, <span class="number">58236</span>, <span class="number">22788</span>, <span class="number">54575</span>, <span class="number">53449</span>, <span class="number">16521</span>, <span class="number">55829</span>, <span class="number">14990</span>, <span class="number">8653</span>, <span class="number">55846</span>, <span class="number">6198</span>, <span class="number">24332</span>, <span class="number">28673</span>, <span class="number">50260</span>, <span class="number">60726</span>, <span class="number">55293</span>, <span class="number">35325</span>, <span class="number">4142</span>, <span class="number">28883</span>, <span class="number">19302</span>, <span class="number">31711</span>, <span class="number">10833</span>, <span class="number">62836</span>, <span class="number">27199</span>, <span class="number">14853</span>, <span class="number">21172</span>, <span class="number">61281</span>, <span class="number">43290</span>, <span class="number">23364</span>, <span class="number">62192</span>, <span class="number">58280</span>, <span class="number">64481</span>, <span class="number">40708</span>, <span class="number">17966</span>, <span class="number">54004</span>, <span class="number">1651</span>, <span class="number">1008</span>, <span class="number">12674</span>, <span class="number">54156</span>, <span class="number">48976</span>, <span class="number">60163</span>, <span class="number">47799</span>, <span class="number">14781</span>, <span class="number">37556</span>, <span class="number">58786</span>, <span class="number">14677</span>, <span class="number">16666</span>, <span class="number">22398</span>, <span class="number">41273</span>, <span class="number">22312</span>, <span class="number">49859</span>, <span class="number">4327</span>, <span class="number">54222</span>, <span class="number">52527</span>, <span class="number">35043</span>, <span class="number">35462</span>, <span class="number">33939</span>, <span class="number">30396</span>, <span class="number">17371</span>, <span class="number">10883</span>, <span class="number">42056</span>, <span class="number">31285</span>, <span class="number">7486</span>, <span class="number">33758</span>, <span class="number">62824</span>, <span class="number">58144</span>, <span class="number">19003</span>, <span class="number">17210</span>, <span class="number">28590</span>, <span class="number">39138</span>, <span class="number">20818</span>, <span class="number">58339</span>, <span class="number">7397</span>, <span class="number">30592</span>, <span class="number">54635</span>, <span class="number">33004</span>, <span class="number">6524</span>, <span class="number">54578</span>, <span class="number">21592</span>, <span class="number">33877</span>, <span class="number">37330</span>, <span class="number">51484</span>, <span class="number">18861</span>, <span class="number">26317</span>, <span class="number">426</span>, <span class="number">6365</span>, <span class="number">34363</span>, <span class="number">21922</span>, <span class="number">33037</span>, <span class="number">22209</span>, <span class="number">63283</span>, <span class="number">6463</span>, <span class="number">22503</span>, <span class="number">32397</span>, <span class="number">54053</span>, <span class="number">8538</span>, <span class="number">37449</span>, <span class="number">39658</span>, <span class="number">34111</span>, <span class="number">49684</span>, <span class="number">27364</span>, <span class="number">55762</span>, <span class="number">2892</span>, <span class="number">64875</span>, <span class="number">17558</span>, <span class="number">45202</span>, <span class="number">37747</span>, <span class="number">61781</span>, <span class="number">39006</span>, <span class="number">5</span>, <span class="number">55444</span>, <span class="number">4965</span>, <span class="number">65360</span>, <span class="number">45810</span>, <span class="number">23739</span>, <span class="number">51172</span>, <span class="number">37274</span>, <span class="number">39909</span>, <span class="number">58863</span>, <span class="number">28111</span>, <span class="number">449</span>, <span class="number">14406</span>, <span class="number">62190</span>, <span class="number">13688</span>, <span class="number">57145</span>, <span class="number">23653</span>, <span class="number">56791</span>, <span class="number">4065</span>, <span class="number">13079</span>, <span class="number">59309</span>, <span class="number">57940</span>, <span class="number">59317</span>, <span class="number">17968</span>, <span class="number">28037</span>, <span class="number">27233</span>, <span class="number">53242</span>, <span class="number">30901</span>, <span class="number">10758</span>, <span class="number">57188</span>, <span class="number">9100</span>, <span class="number">51760</span>, <span class="number">16566</span>, <span class="number">20555</span>, <span class="number">50514</span>, <span class="number">35271</span>, <span class="number">59680</span>, <span class="number">24646</span>, <span class="number">14768</span>, <span class="number">13335</span>, <span class="number">30246</span>, <span class="number">39364</span>, <span class="number">51795</span>, <span class="number">5031</span>, <span class="number">38107</span>, <span class="number">32158</span>, <span class="number">443</span>, <span class="number">10384</span>, <span class="number">6774</span>, <span class="number">47929</span>, <span class="number">15499</span>, <span class="number">50368</span>, <span class="number">51827</span>, <span class="number">54022</span>, <span class="number">18908</span>, <span class="number">2157</span>, <span class="number">9827</span>, <span class="number">14658</span>, <span class="number">16901</span>, <span class="number">40891</span>, <span class="number">5884</span>, <span class="number">51302</span>, <span class="number">10387</span>, <span class="number">10960</span>, <span class="number">16761</span>, <span class="number">26793</span>, <span class="number">55085</span>, <span class="number">35673</span>, <span class="number">35137</span>, <span class="number">13497</span>, <span class="number">28211</span>, <span class="number">60579</span>, <span class="number">60497</span>, <span class="number">47403</span>, <span class="number">9106</span>, <span class="number">59526</span>, <span class="number">10327</span>, <span class="number">8063</span>, <span class="number">41945</span>, <span class="number">5754</span>, <span class="number">57621</span>, <span class="number">26709</span>, <span class="number">22739</span>, <span class="number">25547</span>, <span class="number">24703</span>, <span class="number">20746</span>, <span class="number">3895</span>, <span class="number">44111</span>, <span class="number">51320</span>, <span class="number">42212</span>, <span class="number">59781</span>, <span class="number">29064</span>, <span class="number">44610</span>, <span class="number">16431</span>, <span class="number">39515</span>, <span class="number">18156</span>, <span class="number">14210</span>, <span class="number">27507</span>, <span class="number">47206</span>, <span class="number">41530</span>, <span class="number">44123</span>, <span class="number">29499</span>, <span class="number">47242</span>, <span class="number">50363</span>, <span class="number">3339</span>, <span class="number">57490</span>, <span class="number">36566</span>, <span class="number">48636</span>, <span class="number">49784</span>, <span class="number">10942</span>, <span class="number">64447</span>, <span class="number">26791</span>, <span class="number">52829</span>, <span class="number">53204</span>, <span class="number">55163</span>, <span class="number">32261</span>, <span class="number">32157</span>, <span class="number">58261</span>, <span class="number">41129</span>, <span class="number">60614</span>, <span class="number">30034</span>, <span class="number">55489</span>, <span class="number">55576</span>, <span class="number">25052</span>, <span class="number">4263</span>, <span class="number">32514</span>, <span class="number">1419</span>, <span class="number">22605</span>, <span class="number">56589</span>, <span class="number">48192</span>, <span class="number">44655</span>, <span class="number">61295</span>, <span class="number">8855</span>, <span class="number">42987</span>, <span class="number">26448</span>, <span class="number">33214</span>, <span class="number">46651</span>, <span class="number">56194</span>, <span class="number">28472</span>, <span class="number">12965</span>]</span><br><span class="line">    leak1=[<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&quot;&quot;</span>.join([<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> leak[:<span class="number">19968</span>//<span class="number">16</span>]])]</span><br><span class="line">    leak1 = matrix(GF(<span class="number">2</span>), leak1)</span><br><span class="line">    <span class="comment"># 恢复state</span></span><br><span class="line">    state = recoverState(T,leak1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;state恢复完成&quot;</span>)</span><br><span class="line">    <span class="comment"># 两种可能</span></span><br><span class="line">    guess1, guess2 = backfirst(state)</span><br><span class="line">    <span class="built_in">print</span>(guess1, guess2)</span><br><span class="line">    state[<span class="number">0</span>] = guess1</span><br><span class="line">    s = state</span><br><span class="line">    prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;first&quot;</span>)</span><br><span class="line">        prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        now =  [prng.getrandbits(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1250</span>)]</span><br><span class="line">        <span class="keyword">if</span> now == leak:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(prng.getrandbits(<span class="number">64</span>))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    state[<span class="number">0</span>] = guess2</span><br><span class="line">    s = state</span><br><span class="line">    prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;second&quot;</span>)</span><br><span class="line">        prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(s + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">        now =  [prng.getrandbits(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1250</span>)]</span><br><span class="line">        <span class="keyword">if</span> now == leak:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;true&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(prng.getrandbits(<span class="number">64</span>))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>







<h1 id="CTF2022——ezRSA"><a href="#CTF2022——ezRSA" class="headerlink" title="*CTF2022——ezRSA"></a>*CTF2022——ezRSA</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime</span><br><span class="line"><span class="keyword">from</span> gmpy <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">q=next_prime(p^((<span class="number">1</span>&lt;&lt;<span class="number">900</span>)-<span class="number">1</span>)^getrandbits(<span class="number">300</span>))</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m=<span class="built_in">int</span>(flag.encode(<span class="string">&#x27;hex&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">assert</span> m&lt;n</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(n))</span><br><span class="line"><span class="comment">#0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(c))</span><br><span class="line"><span class="comment">#0xd7f6c90512bc9494370c3955ff3136bb245a6d1095e43d8636f66f11db525f2063b14b2a4363a96e6eb1bea1e9b2cc62b0cae7659f18f2b8e41fca557281a1e859e8e6b35bd114655b6bf5e454753653309a794fa52ff2e79433ca4bbeb1ab9a78ec49f49ebee2636abd9dd9b80306ae1b87a86c8012211bda88e6e14c58805feb6721a01481d1a7031eb3333375a81858ff3b58d8837c188ffcb982a631e1a7a603b947a6984bd78516c71cfc737aaba479688d56df2c0952deaf496a4eb3f603a46a90efbe9e82a6aef8cfb23e5fcb938c9049b227b7f15c878bd99b61b6c56db7dfff43cd457429d5dcdb5fe314f1cdf317d0c5202bad6a9770076e9b25b1</span></span><br></pre></td></tr></table></figure>

<p> 考点是高位攻击，不过没那么明显</p>
<h2 id="高124位"><a href="#高124位" class="headerlink" title="高124位"></a>高124位</h2><p>因为<code>q=next_prime(p^((1&lt;&lt;900)-1)^getrandbits(300))</code>，异或并不影响高124位，所以$p$和$q$的高124位一样</p>
<h3 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h3><p>第一种方法是把$n$的前248位进行开根号得到$p,q$的高位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line">x = <span class="built_in">int</span>(gmpy2.iroot(n&gt;&gt;(<span class="number">2048</span>-<span class="number">248</span>),<span class="number">2</span>)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h3 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h3><p>第二种方法是解方程</p>
<p>先是令$p &#x3D; p_{h} + p_l$，$q &#x3D; q_h+q_l$，$p_h &#x3D; q_h &#x3D; x$</p>
<p>于是$n &#x3D; pq &#x3D; 2^{1800}x^2+2^{900}x×(2^{900}-1+c) + p_lq_l\longrightarrow n &#x3D; 2^{1800}x^2+2^{1800}x + t$</p>
<p>$t$相对来说比较小，可以忽略，解$n &#x3D; 2^{1800}x^2 + 2^{1800}x$就可以得到高位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">n = <span class="number">0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line"></span><br><span class="line">var(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f = x^<span class="number">2</span> + x - n//<span class="number">2</span>^<span class="number">1800</span>					</span><br><span class="line"><span class="built_in">print</span>(solve([f],[x]))</span><br><span class="line"><span class="comment"># x = 20226195070633070235386534147535171929</span></span><br></pre></td></tr></table></figure>

<h2 id="中间600位"><a href="#中间600位" class="headerlink" title="中间600位"></a>中间600位</h2><h3 id="思路1-1"><a href="#思路1-1" class="headerlink" title="思路1"></a>思路1</h3><p>对于中间300~900共600位，是不受后面一个异或影响的，p和q每位都是相反的</p>
<p>于是$p+q \approx 2(x&lt;&lt;900) + \color{red}2^{900}-2^{300}$</p>
<p>根据费马分解$n &#x3D; \frac{(p+q)^2}{4}-\frac{(p-q)^2}{4}$</p>
<p>所以有$\because p-q &#x3D; \sqrt{4n - (p+q)^2}$，</p>
<p>$\therefore p &#x3D; \frac{(p+q)+(p-q)}{2} &#x3D; \frac{2(x&lt;&lt;900)+2^{900}-2^{300}+\sqrt{4n-(p+q)^2}}{2}$</p>
<h3 id="思路2-1"><a href="#思路2-1" class="headerlink" title="思路2"></a>思路2</h3><p>已知p,q的300~900位是相反的，将这一段设为极端情况——p全为1，q全为0。</p>
<p>根据基本不等式，p、q的差值越大，积就越大</p>
<p>当$pq&lt;n$时，表示这个位置的数正确</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">0xe78ab40c343d4985c1de167e80ba2657c7ee8c2e26d88e0026b68fe400224a3bd7e2a7103c3b01ea4d171f5cf68c8f00a64304630e07341cde0bc74ef5c88dcbb9822765df53182e3f57153b5f93ff857d496c6561c3ddbe0ce6ff64ba11d4edfc18a0350c3d0e1f8bd11b3560a111d3a3178ed4a28579c4f1e0dc17cb02c3ac38a66a230ba9a2f741f9168641c8ce28a3a8c33d523553864f014752a04737e555213f253a72f158893f80e631de2f55d1d0b2b654fc7fa4d5b3d95617e8253573967de68f6178f78bb7c4788a3a1e9778cbfc7c7fa8beffe24276b9ad85b11eed01b872b74cdc44959059c67c18b0b7a1d57512319a5e84a9a0735fa536f1b3</span></span><br><span class="line">x = <span class="built_in">int</span>(gmpy2.iroot(n&gt;&gt;(<span class="number">2048</span>-<span class="number">248</span>),<span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">p = x&lt;&lt;<span class="number">900</span> | (<span class="number">2</span>**<span class="number">900</span> - <span class="number">1</span>)		<span class="comment">#低900位全是1</span></span><br><span class="line">q = x&lt;&lt;<span class="number">900</span>						<span class="comment">#低900位全是0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">899</span>, <span class="number">300</span>, -<span class="number">1</span>):</span><br><span class="line">    cur = <span class="number">1</span>&lt;&lt;i</span><br><span class="line">    <span class="comment"># 下面的操作是把p的1变成0,q的0变成1</span></span><br><span class="line">    <span class="comment"># 如果改变后的pq小于n，说明是对的</span></span><br><span class="line">    <span class="keyword">if</span> (p^cur) * (q^cur) &lt; n:</span><br><span class="line">        p ^= cur</span><br><span class="line">        q ^= cur</span><br></pre></td></tr></table></figure>

<h2 id="低位"><a href="#低位" class="headerlink" title="低位"></a>低位</h2><p>最后就是用copper</p>
<p><strong>疑惑点就是这里，两种思路求出这个近似的p之后，不是只差低300位不知道了吗？</strong></p>
<p>为什么<code>small_roots(X)</code>的X上限不是$2^{300}$</p>
<p>最后我觉得的可能应该<code>small_roots()</code>的应用前提是已知576位，然后差了(1024-576 &#x3D; 448)位，所以把上限定在了</p>
<p>$2^{450}$</p>
<h1 id="三胞胎素数"><a href="#三胞胎素数" class="headerlink" title="三胞胎素数"></a>三胞胎素数</h1><p>题目来源[TSGCTF 2021]Beginner’s Crypto 2021</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">from secret import e</span><br><span class="line">from Crypto.Util.number import getStrongPrime, isPrime</span><br><span class="line"></span><br><span class="line">p = getStrongPrime(1024)</span><br><span class="line">q = getStrongPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - 1) * (q - 1)</span><br><span class="line"></span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    flag = int.from_bytes(f.read(), &#x27;big&#x27;)</span><br><span class="line"></span><br><span class="line">assert(isPrime(e))</span><br><span class="line">assert(isPrime(e + 2))</span><br><span class="line">assert(isPrime(e + 4))</span><br><span class="line"></span><br><span class="line">e1 = pow(e, 0x10001, phi)</span><br><span class="line">e2 = pow(e + 2, 0x10001, phi)</span><br><span class="line">e3 = pow(e + 4, 0x10001, phi)</span><br><span class="line"></span><br><span class="line">c1 = pow(flag, e1, N)</span><br><span class="line">c2 = pow(flag, e2, N)</span><br><span class="line">c3 = pow(flag, e3, N)</span><br><span class="line"></span><br><span class="line">print(f&#x27;p = &#123;p&#125;&#x27;)</span><br><span class="line">print(f&#x27;q = &#123;q&#125;&#x27;)</span><br><span class="line">print(f&#x27;c1 = &#123;c1&#125;&#x27;)</span><br><span class="line">print(f&#x27;c2 = &#123;c2&#125;&#x27;)</span><br><span class="line">print(f&#x27;c3 = &#123;c3&#125;&#x27;)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">p = 167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span><br><span class="line">q = 130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span><br><span class="line">c1 = 2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span><br><span class="line">c2 = 9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span><br><span class="line">c3 = 3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">assert(isPrime(e))</span><br><span class="line">assert(isPrime(e + 2))</span><br><span class="line">assert(isPrime(e + 4))</span><br></pre></td></tr></table></figure>

<p>满足这样条件的$e$只有$e&#x3D;3$</p>
<h2 id="一些定义："><a href="#一些定义：" class="headerlink" title="一些定义："></a>一些定义：</h2><h3 id="孪生素数"><a href="#孪生素数" class="headerlink" title="孪生素数"></a>孪生素数</h3><p><strong>指差等于2的两个素数。</strong></p>
<h3 id="三胞胎素数-1"><a href="#三胞胎素数-1" class="headerlink" title="三胞胎素数"></a>三胞胎素数</h3><p><strong>指三个连续素数，使得其中最大的一个减去最小一个的差不超过6</strong>。</p>
<p>事实上，除了最小的两组三胞胎素数：$(2, 3, 5)$ 和 $(3, 5, 7)$，其它的三胞胎素数都是相差达到<strong>6</strong>的三元数组。除了以上两个特例以外，三胞胎素数分为两类：</p>
<p>A类三胞胎素数，构成为$p$，$p+2$，$p+6$，相差2的两个孪生素数在前面，例如：$(5，7，11)$；$(11，13，17)$； $(17，19，23)$；等等。</p>
<p>B类三胞胎素数，构成为$p$，$p+4$，$p+6$，相差2的两个孪生素数在后面，例如：(7，11，13)；(13，17，19)；(37，41，43)；等等。</p>
<p>当素数p 大于3时，可以证明形同$p$，$p+2$，$p+4$的数组不可能是三胞胎素数。事实上，这三个数对3的模两两不同，所以必然有一个能被3整除。然而这三个数都比3要大，因此一定有一个是3的倍数，从而这个数不是素数。</p>
<p>详见：<a target="_blank" rel="noopener" href="https://zh.wikibooks.org/wiki/%E4%B8%89%E8%83%9E%E8%83%8E%E7%B4%A0%E6%95%B0">三胞胎素数 - 维基教科书，自由的教学读本 (wikibooks.org)</a></p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>知道$e&#x3D;3$之后就已知$e_1,e_2,e_3$，然后共模攻击</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">p = <span class="number">167710954518007348037383082265231465648795974011761905177264545864288011527333715495850532989338171489309608848431113452814709692343039027970312735521415071265608660628968391884287240987858607818275329135585153511665148279408708087727501421558738163577629329044315775019460018956186674179846621352371150072281</span></span><br><span class="line">q = <span class="number">130354329753344570838569091064852072757046774566775609047544069941246798511317343102715733555464772099991834579660053860799207243561908291522943696711982657846373844514551117658179060004064010647453939332217996817580433587341521331941287365948919907797478197717562721233289937471168288241937022054501586986443</span></span><br><span class="line">c1 = <span class="number">2560344169447809042170685026483682125499025654554670516499742981486615082413150123244985585751880264831112089324011804397189638172356179296987581738515619297036118472798499254785110885662931526277474101787493114656242031264678448394380651657330967744585361662315313462698221954777506355498445242300193032704972074020068699180111637362566860530694807230108024167631423062629721393506643291591971626450262144814424411172618188943774725105690851574922374544865628890948773274109561622040022136970632948166009941425683576381155722191980954262373394704682297682490061906408535261437100820855976015526295573831744458528440</span></span><br><span class="line">c2 = <span class="number">9041231631916227099296501948589424780380702196870972231114747229225732542137483840187783630590878594711315671224997985975031038623195921968945234067183003568830416719957054703139219879265482072634572699299971785171441858501409377942183918216246312330291820452436486171483461790388518159980027140392750222843449604265528929311978655519463562520038992870162220913137870017065557254099767583925177889051326144499369420594398043223307161794788085369471538477803421726790780799629276012701406231535048423554314287152404245482928538931953627397633165453319078105028671410039195670727134471011040601278722143504641171853743</span></span><br><span class="line">c3 = <span class="number">3193069356811106774640161554961405075257002069448498144279061282023129342916422283816661697787316681475161942522570615456264481238277711114193792510286127129056376618422336477707825009085263623755329815306483253646072909132096678270667136193038337386976289222105363398033633185639402128949635525665502328717781718263894690234837016959581149138917064108193064639981137359869717065147934752707676203651598070046066514316196771853484143158367616177332902152347890310640338106015356361617700741042461419248117687350565094928451141103632305400493998164788411031832078388030194992306440474662871408938796429927990102583837</span></span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">e1 = <span class="built_in">pow</span>(e, <span class="number">0x10001</span>, phi)</span><br><span class="line">e2 = <span class="built_in">pow</span>(e + <span class="number">2</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line">e3 = <span class="built_in">pow</span>(e + <span class="number">4</span>, <span class="number">0x10001</span>, phi)</span><br><span class="line"></span><br><span class="line">ee = [e1,e2,e3]</span><br><span class="line">cc = [c1,c2,c3]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ee)):</span><br><span class="line">        <span class="keyword">if</span> i != j:</span><br><span class="line">            s,x,y = gmpy2.gcdext(ee[i],ee[j])</span><br><span class="line">            m = <span class="built_in">pow</span>(cc[i],x,N) * <span class="built_in">pow</span>(cc[j],y,N) % N</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">           </span><br></pre></td></tr></table></figure>

<h1 id="以下是有关论文的题目"><a href="#以下是有关论文的题目" class="headerlink" title="以下是有关论文的题目"></a>以下是有关论文的题目</h1><h2 id="N-ma-2-nb-2-mc-2-nd-2"><a href="#N-ma-2-nb-2-mc-2-nd-2" class="headerlink" title="N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2"></a>N &#x3D; ma^2 + nb^2 &#x3D; mc^2 + nd^2</h2><p>论文：<a target="_blank" rel="noopener" href="https://www.jstor.org/stable/0b4b4e65-c7fc-3c15-b716-723b58ec2b20?read-now=1&seq=1">A Note on Euler’s Factoring Problem on JSTOR</a></p>
<p>另外一个链接：[elementary number theory - A generalization of Euler Factorization with $N &#x3D; m a^2 + n b^2 &#x3D; m c^2 + n d^2$ - Mathematics Stack Exchange](<a target="_blank" rel="noopener" href="https://math.stackexchange.com/questions/4712807/a-generalization-of-euler-factorization-with-n-m-a2-n-b2-m-c2-n-d2#:~:text=John">https://math.stackexchange.com/questions/4712807/a-generalization-of-euler-factorization-with-n-m-a2-n-b2-m-c2-n-d2#:~:text=John</a> Brillhart discusses a generalization of this method,%3D ma2 %2B nb2 %3D mc2 %2B nd2%2C)</p>
<h3 id="题目来源-NSSCTF-Round11——-ez-fac"><a href="#题目来源-NSSCTF-Round11——-ez-fac" class="headerlink" title="题目来源 NSSCTF#Round11——[ez_fac]"></a>题目来源 NSSCTF#Round11——[ez_fac]</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,a0,a1,b0,b1</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">e = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a0,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b0,<span class="number">2</span>) == n</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(a1,<span class="number">2</span>) + e * <span class="built_in">pow</span>(b1,<span class="number">2</span>) == n</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a0=&quot;</span>,a0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a1=&quot;</span>,a1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b0=&quot;</span>,b0)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b1=&quot;</span>,b1)</span><br></pre></td></tr></table></figure>

<p>论文大体内容就是：</p>
<p>如果$N &#x3D; ma^2 + nb^2$，且$N&#x3D;mc^2+nd^2$</p>
<p>$N$即可分解为$N&#x3D; (N,ad-bc)×\frac{n}{(N,ad-bc)}$，括号就是最大公因数</p>
<p>所以$p &#x3D; gcd(N,ad-bc)$</p>
<p>本题还需要推导一下e</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c= <span class="number">34007465638566836660852768374211870538357285529060206826620688555044780516477877596651414637089490522614456532732711803500304737160162560168303462221485961593760966240770414498297915175227814336224871400766371471776600674705757656616409870237891336752248110367865552469248343708419900511716030176178698949179</span></span><br><span class="line">n= <span class="number">70043427687738872803871163276488213173780425282753969243938124727004843810522473265066937344440899712569316720945145873584064860810161865485251816597432836666987134938760506657782143983431621481190009008491725207321741725979791393566155990005404328775785526238494554357279069151540867533082875900530405903003</span></span><br><span class="line">a0= <span class="number">8369195163678456889416121467476480674288621867182572824570660596055739410903686466334448920102666056798356927389728982948229326705483052970212882852055482</span></span><br><span class="line">a1= <span class="number">8369195163678456889416121462308686152524805984209312455308229689034789710117101859597220211456125364647704791637845189120538925088375209397006380815921158</span></span><br><span class="line">b0= <span class="number">25500181489306553053743739056022091355379036380919737553326529889338409847082228856006303427136881468093863020843230477979</span></span><br><span class="line">b1= <span class="number">31448594528370020763962343185054872105044827103889010592635556324009793301024988530934510929565983517651356856506719032859</span></span><br><span class="line"></span><br><span class="line">tmp = a0*b1 - a1*b0</span><br><span class="line">e = (n - <span class="built_in">pow</span>(a0,<span class="number">2</span>)) // <span class="built_in">pow</span>(b0,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">p = gmpy2.gcd(tmp,n)</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h2 id="n-p-r×q"><a href="#n-p-r×q" class="headerlink" title="n &#x3D; p^r×q"></a>n &#x3D; p^r×q</h2><h3 id="题目来源-D-3CTF-2022-——d3factor"><a href="#题目来源-D-3CTF-2022-——d3factor" class="headerlink" title="题目来源[D^3CTF 2022] ——d3factor"></a>题目来源[D^3CTF 2022] ——d3factor</h3><p>论文：<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2015/399.pdf">399.pdf (iacr.org)</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import bytes_to_long, getPrime</span><br><span class="line">from secret import msg</span><br><span class="line">from sympy import nextprime</span><br><span class="line">from gmpy2 import invert</span><br><span class="line">from hashlib import md5</span><br><span class="line"></span><br><span class="line">flag = &#x27;d3ctf&#123;&#x27;+md5(msg).hexdigest()+&#x27;&#125;&#x27;</span><br><span class="line">p = getPrime(256)</span><br><span class="line">q = getPrime(256)</span><br><span class="line">assert p &gt; q</span><br><span class="line">n = p * q</span><br><span class="line">e = 0x10001</span><br><span class="line">m = bytes_to_long(msg)</span><br><span class="line">c = pow(m, e, n)</span><br><span class="line"></span><br><span class="line">N = pow(p, 7) * q</span><br><span class="line">phi = pow(p, 6) * (p - 1) * (q - 1)</span><br><span class="line">d1 = getPrime(2000)</span><br><span class="line">d2 = nextprime(d1 + getPrime(1000))</span><br><span class="line">e1 = invert(d1, phi)</span><br><span class="line">e2 = invert(d2, phi)</span><br><span class="line"></span><br><span class="line">print(f&#x27;c = &#123;c&#125;&#x27;)</span><br><span class="line">print(f&#x27;N = &#123;N&#125;&#x27;)</span><br><span class="line">print(f&#x27;e1 = &#123;e1&#125;&#x27;)</span><br><span class="line">print(f&#x27;e2 = &#123;e2&#125;&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">c = </span><br><span class="line">N = </span><br><span class="line">e1 = </span><br><span class="line">e2 = </span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="论文内容及证明过程"><a href="#论文内容及证明过程" class="headerlink" title="论文内容及证明过程"></a>论文内容及证明过程</h3><p><img src="/../images/paper/0.png"></p>
<p>论文大致内容就是<strong>对于</strong>$N &#x3D; p^rq$，<strong>当两个解密密钥</strong>$d_1$,$d_2$差值不超过$N^{\frac{r(r-1)}{(r+1)^2}}$</p>
<p>即$|d_1-d_2| &lt; N^{\frac{r(r-1)}{(r+1)^2}}$的时候，可以在多项式的时间内分解出$p$</p>
<p>其证明过程如下：</p>
<p>$\because N &#x3D;p^rq$，$\phi(N) &#x3D; p^{r-1}(p-1)(q-1)$</p>
<p>有<br>$$<br>\left{\begin{matrix}<br>e_1d_1 \equiv 1 \mod \phi(N) \quad ①\<br>e_2d_2 \equiv 1 \mod \phi(N) \quad ②\<br>\end{matrix}\right.\<br>$$<br>把①式乘$e_2$，②式乘$e_1$再相减得</p>
<p>$e_1e_2(d_1-d_2)-(e_2-e_1) \equiv 0 \mod \phi(N)$</p>
<p>根据论文，把$\phi(N)$用$p^{r-1}$替代掉</p>
<p>则有$e_1e_2(d_1-d_2)-(e_2-e_1) \equiv 0 \mod p^{r-1}$</p>
<p>$d_1-d_2$就是$e_1e_2x - (e_2-e_1) \equiv 0 \mod p^{r-1}$的根</p>
<p>可以用coppersmith求出$x$</p>
<p>然后计算$gcd(e_1e_2x - (e_2-e_1),N) &#x3D; gcd(k×p^{r-1}(p-1)(q-1),p^rq) &#x3D; g$</p>
<p>利用这个g<br>$$<br>p &#x3D;<br>\left{\begin{matrix}<br>g^{\frac{1}{r-1}},\quad if\quad  g &#x3D; p^{r-1}\<br>g^{\frac{1}{r}},\quad if \quad g &#x3D; p^r\<br>\frac{N}{g},\quad if\quad  g &#x3D; p^{r-1}q<br>\end{matrix}\right.<br>$$</p>
<h3 id="本题解答"><a href="#本题解答" class="headerlink" title="本题解答"></a>本题解答</h3><p>根据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="built_in">pow</span>(p, <span class="number">7</span>) * q</span><br><span class="line">phi = <span class="built_in">pow</span>(p, <span class="number">6</span>) * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d1 = getPrime(<span class="number">2000</span>)</span><br><span class="line">d2 = nextprime(d1 + getPrime(<span class="number">1000</span>))</span><br></pre></td></tr></table></figure>

<p>可以判断出$|d_1-d_2|\approx 1000bit$，$N&#x3D; 2048bbit$，所以$|d_1-d_2|&lt;N^{\frac{r(r-1)}{(r+1)^2}} \approx 1344bit $</p>
<p>满足论文条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">2420624631315473673388732074340410215657378096737020976722603529598864338532404224879219059105950005655100728361198499550862405660043591919681568611707967</span></span><br><span class="line">N = <span class="number">1476751427633071977599571983301151063258376731102955975364111147037204614220376883752032253407881568290520059515340434632858734689439268479399482315506043425541162646523388437842149125178447800616137044219916586942207838674001004007237861470176454543718752182312318068466051713087927370670177514666860822341380494154077020472814706123209865769048722380888175401791873273850281384147394075054950169002165357490796510950852631287689747360436384163758289159710264469722036320819123313773301072777844457895388797742631541101152819089150281489897683508400098693808473542212963868834485233858128220055727804326451310080791</span></span><br><span class="line">e1 = <span class="number">425735006018518321920113858371691046233291394270779139216531379266829453665704656868245884309574741300746121946724344532456337490492263690989727904837374279175606623404025598533405400677329916633307585813849635071097268989906426771864410852556381279117588496262787146588414873723983855041415476840445850171457530977221981125006107741100779529209163446405585696682186452013669643507275620439492021019544922913941472624874102604249376990616323884331293660116156782891935217575308895791623826306100692059131945495084654854521834016181452508329430102813663713333608459898915361745215871305547069325129687311358338082029</span></span><br><span class="line">e2 = <span class="number">1004512650658647383814190582513307789549094672255033373245432814519573537648997991452158231923692387604945039180687417026069655569594454408690445879849410118502279459189421806132654131287284719070037134752526923855821229397612868419416851456578505341237256609343187666849045678291935806441844686439591365338539029504178066823886051731466788474438373839803448380498800384597878814991008672054436093542513518012957106825842251155935855375353004898840663429274565622024673235081082222394015174831078190299524112112571718817712276118850981261489528540025810396786605197437842655180663611669918785635193552649262904644919</span></span><br><span class="line"></span><br><span class="line">a = e1 * e2</span><br><span class="line">b = (e2 - e1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(N))			</span><br><span class="line">f = a*x - b</span><br><span class="line">f = f.monic()</span><br><span class="line">res =  f.small_roots(<span class="number">2</span>^<span class="number">1000</span>,beta = <span class="number">0.4</span>)		<span class="comment">#根据d1-d2大概的范围确定上限</span></span><br><span class="line"></span><br><span class="line">ans = <span class="built_in">int</span>(res[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">g = gcd(a*ans - b,N)</span><br><span class="line"><span class="comment">#print(g.nbits())</span></span><br><span class="line"><span class="comment">#g = 1534bit</span></span><br><span class="line"></span><br><span class="line">p = gmpy2.iroot(g,<span class="number">6</span>)[<span class="number">0</span>]</span><br><span class="line">q = N // (p^<span class="number">7</span>)</span><br><span class="line">n = p*q</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">msg = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;d3ctf&#123;&quot;</span> + md5(msg).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>$\because g &#x3D; 1534bit$，$\therefore p &#x3D; g^{\frac{1}{6}}$</p>
<h2 id="RSA与格结合，且多组n-e-c"><a href="#RSA与格结合，且多组n-e-c" class="headerlink" title="RSA与格结合，且多组n,e,c"></a>RSA与格结合，且多组n,e,c</h2><h3 id="题目来源-NUSTCTF-2022-新生赛-——lattice"><a href="#题目来源-NUSTCTF-2022-新生赛-——lattice" class="headerlink" title="题目来源[NUSTCTF 2022 新生赛]——lattice"></a>题目来源[NUSTCTF 2022 新生赛]——lattice</h3><p>论文：<a target="_blank" rel="noopener" href="https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf">IJCSI-9-2-1-311-314.pdf</a></p>
<p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from random import randint</span><br><span class="line">from secret import flag</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">d = getPrime(randint(370, 390))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def enc(i):</span><br><span class="line">    print()</span><br><span class="line">    p = getPrime(512)</span><br><span class="line">    q = getPrime(512)</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p - 1) * (q - 1)</span><br><span class="line">    e = inverse(d, phi)</span><br><span class="line">    c = pow(flag, e, n)</span><br><span class="line">    print(f&#x27;e_&#123;i&#125; =&#x27;, e)</span><br><span class="line">    print(f&#x27;n_&#123;i&#125; =&#x27;, n)</span><br><span class="line">    print(f&#x27;c_&#123;i&#125; =&#x27;, c)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    for i in range(3):</span><br><span class="line">        enc(i)</span><br><span class="line"></span><br><span class="line"># e_0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line"># n_0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line"># c_0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line"># e_1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line"># n_1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line"># c_1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line"># e_2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line"># n_2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line"># c_2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br></pre></td></tr></table></figure>



<p>令$M &#x3D; \sqrt{N_{max}}$，$M$是一组$N$中最大的$N$并且开根号。这组$N$满足：$N_1&lt;N_2&lt;\dots&lt;N_r &lt;2N_1$</p>
<p>又$\because e_id \equiv 1 (\mod \phi(N_i))$</p>
<p>这里把它写成$e_id &#x3D; 1+k_i\phi{N_i}$</p>
<p>假设$\phi(N_i)$可以写成$k_i(N_i-s_i)$的形式。其中$|s_i&lt;3N_i^{\frac{1}{2}}|$</p>
<p>则$e_id &#x3D; 1 + k_i(N_i-s_i)$</p>
<p>化简得$e_id-k_iN_i &#x3D; 1-k_is_i$</p>
<p>所以我们有$r+1$个等式:</p>
<p><img src="/../images/Lattice2/10.png"></p>
<p>写成矩阵相乘的形式</p>
<p><img src="/../images/Lattice2/11.png"></p>
<p>因为最后的目标向量满足LLL算法，所以我们可以得到$dM$</p>
<p>求得$dM$之后，我们可以求得$d$</p>
<p>exp:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line">import gmpy2</span><br><span class="line"></span><br><span class="line">e0 = 37389635736858807810703086504264263440188928763651776502954117173983775626039037008534821321761858567723984257427640816113325770208734640385635663643682102780255726244659849205653007212192504491177021176624605722718152646889627480051142935241036578957272339153039961711802753021931124235464986935316295647379</span><br><span class="line">n0 = 87704526707772151782606625126900349506318713860335977395824997219721333991491994027303721441548488339412359519408127174109547119019245873976917916080340858937125736650376514406944094998893225164676363063781400756374403299951466867573215964360920244878373810391250391475087527409213204756990192602517961590163</span><br><span class="line">c0 = 78656123855003406993963573497876652287109947684890741747390020445306861422604130132525802389554149844489256622057009394678814584233565675702142297935509191018145970589418173328145004732595569847696022333024124469320873194195223535859964387627938665526123562969554622541694399263934496631337485091067073489148</span><br><span class="line"></span><br><span class="line">e1 = 28535169211141109871379321582501492434722235009040085167442370469971731780018594508141105234950857774463438226249819106596920677559656398153362076685288045484306156454558741088396794170762527953573082734587618137075161676392362016474076363311708889307420903699720319611668580377903356783222664068961626803615</span><br><span class="line">n1 = 134298877057487865189085342936485527664167450453080897084604607959501054859295769447683135156167266222961308751016451904929475702646252122360203167489936020076488657815646993920082535307414536854323149177250531362615850689341066360635074886835720438532107976530111551202845697404444502476862934946146194420313</span><br><span class="line">c1 = 3208711484494445700905074340207543865325589037128163311082565190422756093807236786011349707275838139469873445326457948489588753029946395247710197747538418278782966047404435385208682596795152082296050804126524129644617710791433973098499266439604632728957505961744280687343384601998774018570047292904007768763</span><br><span class="line"></span><br><span class="line">e2 = 27653153186459366670449283776658896188717513017934031993526241644501850206894800647711159987946276669184047769965182746812351757618147642060630769822810070480507035319320426666128599562714143342910248758055424582501972900763786232170145957578683616604737178839977216709381529813768748145393798635858691196687</span><br><span class="line">n2 = 82113192811251631639012300385672674439485256963081847790431181633372052788107703751257606763043873164706839243919206719171536710944060815484051324239120708906418093409305166299531826404505861042666985630956832163750255358332156122245372899824101210233079028706971698312018388678352739819636695333269309456613</span><br><span class="line">c2 = 79145689398302968140315554300835109898158799236562716569497147385375487041207363302776833573990584370222316102267792795080448018216133931915984139305260191001847394275311719986838969706049641052337337102739487620502723651258075501409442088938776353037366614208693030741599888985069155346722608948495955447606</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = [n0,n1,n2]</span><br><span class="line">M = isqrt(max(n))</span><br><span class="line"></span><br><span class="line">ge = [[M,e0,e1,e2],</span><br><span class="line">    [0,-n0,0,0],</span><br><span class="line">    [0,0,-n1,0],</span><br><span class="line">    [0,0,0,-n2]]</span><br><span class="line">Ge = Matrix(ZZ,ge)</span><br><span class="line"></span><br><span class="line">dM = Ge.LLL()[0][0]</span><br><span class="line">d = abs(dM) // M</span><br><span class="line">m = pow(c0,d,n0)</span><br><span class="line">print(libnum.n2s(int(m)))</span><br></pre></td></tr></table></figure>

<h2 id="cve-of-RSA"><a href="#cve-of-RSA" class="headerlink" title="cve of RSA"></a>cve of RSA</h2><p>论文：<a target="_blank" rel="noopener" href="https://crocs.fi.muni.cz/_media/public/papers/nemec_roca_ccs17_preprint.pdf">The Return of Coppersmith’s Attack:Practical Factorization of Widely Used RSA Moduli (muni.cz)</a></p>
<p>如果p,q是以$p &#x3D; k×M + 65537^a \mod M$的形式产生的，M是个光滑数</p>
<p>攻击脚本：<a target="_blank" rel="noopener" href="https://github.com/jvdsn/crypto-attacks">jvdsn&#x2F;crypto-attacks: Python implementations of cryptographic attacks and utilities. (github.com)</a></p>
<p>根据结论调参</p>
<p><img src="/../images/paper/1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kbits = <span class="number">37</span></span><br><span class="line">abit = <span class="number">62</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">M = <span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    k = getRandomNBitInteger(kbits)</span><br><span class="line">    a = getRandomNBitInteger(abit)</span><br><span class="line">    p = k * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, a, M)</span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    l = getRandomNBitInteger(kbits)</span><br><span class="line">    b = getRandomNBitInteger(abit)</span><br><span class="line">    q = l * M + <span class="built_in">pow</span>(<span class="number">0x10001</span>, b, M)</span><br><span class="line">    <span class="keyword">if</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;N =&#x27;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="comment"># N = 10375505512698590697230540440656541719204263636911186773264796164624307537559854575146689396086897683887657357280574643827597720286007334491967184402911331</span></span><br><span class="line"><span class="comment"># c = 9452671754308991307639149928469686004498992794878178108851267184995226471125632100149955622693448809888842182351036616823747409631021412523576720606919605</span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log2</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> Zmod</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> factor</span><br><span class="line"></span><br><span class="line">path = os.path.dirname(os.path.dirname(os.path.dirname(os.path.realpath(os.path.abspath(__file__)))))</span><br><span class="line"><span class="keyword">if</span> sys.path[<span class="number">1</span>] != path:</span><br><span class="line">    sys.path.insert(<span class="number">1</span>, path)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> shared.small_roots <span class="keyword">import</span> howgrave_graham</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_prime_power_divisors</span>(<span class="params">M</span>):</span><br><span class="line">    divisors = []</span><br><span class="line">    <span class="keyword">for</span> p, e <span class="keyword">in</span> factor(M):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e + <span class="number">1</span>):</span><br><span class="line">            divisors.append(p ** i)</span><br><span class="line"></span><br><span class="line">    divisors.sort()</span><br><span class="line">    <span class="keyword">return</span> divisors</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Algorithm 2.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_max_M_</span>(<span class="params">M, ord_</span>):</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> _prime_power_divisors(M):</span><br><span class="line">        ordp = Zmod(p)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">        <span class="keyword">if</span> ord_ % ordp != <span class="number">0</span>:</span><br><span class="line">            M //= p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Section 2.7.2.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_greedy_find_M_</span>(<span class="params">n, M</span>):</span><br><span class="line">    <span class="built_in">ord</span> = Zmod(M)(<span class="number">65537</span>).multiplicative_order()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        best_r = <span class="number">0</span></span><br><span class="line">        best_ord_ = <span class="built_in">ord</span></span><br><span class="line">        best_M_ = M</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> _prime_power_divisors(<span class="built_in">ord</span>):</span><br><span class="line">            ord_ = <span class="built_in">ord</span> // p</span><br><span class="line">            M_ = compute_max_M_(M, ord_)</span><br><span class="line">            r = (log2(<span class="built_in">ord</span>) - log2(ord_)) / (log2(M) - log2(M_))</span><br><span class="line">            <span class="keyword">if</span> r &gt; best_r:</span><br><span class="line">                best_r = r</span><br><span class="line">                best_ord_ = ord_</span><br><span class="line">                best_M_ = M_</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> log2(best_M_) &lt; log2(n) / <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line">        <span class="built_in">ord</span> = best_ord_</span><br><span class="line">        M = best_M_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, M, m, t, g=<span class="number">65537</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus using the ROCA method.</span></span><br><span class="line"><span class="string">    More information: Nemec M. et al., &quot;The Return of Coppersmith’s Attack: Practical Factorization of Widely Used RSA Moduli&quot;</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param M: the primorial used to generate the primes</span></span><br><span class="line"><span class="string">    :param m: the m parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param t: the t parameter for Coppersmith&#x27;s method</span></span><br><span class="line"><span class="string">    :param g: the generator value (default: 65537)</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    logging.info(<span class="string">&quot;Generating M&#x27;...&quot;</span>)</span><br><span class="line">    M_ = _greedy_find_M_(N, M)</span><br><span class="line">    zmodm_ = Zmod(M_)</span><br><span class="line">    g = zmodm_(g)</span><br><span class="line">    c_ = zmodm_(N).log(g)</span><br><span class="line">    ord_ = g.multiplicative_order()</span><br><span class="line"></span><br><span class="line">    x = Zmod(N)[<span class="string">&quot;x&quot;</span>].gen()</span><br><span class="line">    X = <span class="built_in">int</span>(<span class="number">2</span> * N ** <span class="number">0.5</span> // M_)</span><br><span class="line">    logging.info(<span class="string">&quot;Starting exhaustive a&#x27; search...&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> a_ <span class="keyword">in</span> <span class="built_in">range</span>(c_ // <span class="number">2</span>, (c_ + ord_) // <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">        f = M_ * x + <span class="built_in">int</span>(g ** a_)</span><br><span class="line">        <span class="keyword">for</span> k_, <span class="keyword">in</span> howgrave_graham.modular_univariate(f, N, m, t, X):</span><br><span class="line">            p = <span class="built_in">int</span>(f(k_))</span><br><span class="line">            <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> p, N // p</span><br><span class="line">      </span><br><span class="line">N=<span class="number">10375505512698590697230540440656541719204263636911186773264796164624307537559854575146689396086897683887657357280574643827597720286007334491967184402911331</span></span><br><span class="line">M=<span class="number">962947420735983927056946215901134429196419130606213075415963491270</span></span><br><span class="line">m = <span class="number">5</span></span><br><span class="line">t = <span class="number">6</span></span><br><span class="line">p,q = factorize(N,M,m,t)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个脚本我是在sagemath跑的</p>
<p>得到p,q后有手就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p=<span class="number">85179386137518452231354185509698113331528483782580002217930594759662020757433</span></span><br><span class="line">q=<span class="number">121807704694511224555991770528701515984374557330058194205583818929517699002107</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">9452671754308991307639149928469686004498992794878178108851267184995226471125632100149955622693448809888842182351036616823747409631021412523576720606919605</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>



<h1 id="有限域上的不可约多项式RSA体制"><a href="#有限域上的不可约多项式RSA体制" class="headerlink" title="有限域上的不可约多项式RSA体制"></a>有限域上的不可约多项式RSA体制</h1><h2 id="TCTF2019——babyrsa"><a href="#TCTF2019——babyrsa" class="headerlink" title="TCTF2019——babyrsa"></a>TCTF2019——babyrsa</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pubkey <span class="keyword">import</span> P, n, e</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = GF(<span class="number">2</span>^<span class="number">2049</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">global</span> n</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(m) &lt;= <span class="number">256</span></span><br><span class="line">    m_int = Integer(m.encode(<span class="string">&#x27;hex&#x27;</span>), <span class="number">16</span>)</span><br><span class="line">    m_poly = P(R.fetch_int(m_int))</span><br><span class="line">    c_poly = <span class="built_in">pow</span>(m_poly, e, n)</span><br><span class="line">    c_int = R(c_poly).integer_representation()</span><br><span class="line">    c = <span class="built_in">format</span>(c_int, <span class="string">&#x27;0256x&#x27;</span>).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ptext = flag + os.urandom(<span class="number">256</span>-<span class="built_in">len</span>(flag))</span><br><span class="line">    ctext = encrypt(ptext)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(ctext)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> GF, PolynomialRing</span><br><span class="line"></span><br><span class="line">P=PolynomialRing(GF(<span class="number">2</span>),<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line">n = P(省略)</span><br></pre></td></tr></table></figure>

<p><code>R.fetch_int(m_int)</code>：把整型数据转化成环<code>R</code>上的元素</p>
<p><code>R(c_poly).integer_representation()</code>：把环<code>R</code>上的元素变成整型数据</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">R.&lt;a&gt; = GF(<span class="number">2</span>^<span class="number">2049</span>)</span><br><span class="line">P = PolynomialRing(GF(<span class="number">2</span>),<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line"></span><br><span class="line">n = P(<span class="string">&#x27;x^2048 + x^2046 + x^2043 + x^2040 + x^2036 + x^2035 + x^2034 + x^2033 + x^2031 + x^2029 + x^2025 + x^2024 + x^2022 + x^2019 + x^2018 + x^2017 + x^2012 + x^2007 + x^2006 + x^2004 + x^2000 + x^1999 + x^1998 + x^1997 + x^1993 + x^1992 + x^1991 + x^1986 + x^1982 + x^1981 + x^1979 + x^1978 + x^1977 + x^1975 + x^1970 + x^1964 + x^1963 + x^1962 + x^1961 + x^1960 + x^1959 + x^1958 + x^1955 + x^1954 + x^1952 + x^1951 + x^1949 + x^1947 + x^1942 + x^1939 + x^1938 + x^1936 + x^1934 + x^1933 + x^1932 + x^1930 + x^1928 + x^1927 + x^1923 + x^1922 + x^1919 + x^1918 + x^1915 + x^1914 + x^1913 + x^1912 + x^1911 + x^1910 + x^1908 + x^1903 + x^1902 + x^1900 + x^1899 + x^1897 + x^1893 + x^1891 + x^1890 + x^1886 + x^1881 + x^1880 + x^1879 + x^1878 + x^1875 + x^1874 + x^1873 + x^1872 + x^1871 + x^1870 + x^1869 + x^1865 + x^1863 + x^1862 + x^1860 + x^1856 + x^1855 + x^1853 + x^1852 + x^1845 + x^1841 + x^1839 + x^1837 + x^1836 + x^1835 + x^1833 + x^1832 + x^1829 + x^1828 + x^1827 + x^1826 + x^1824 + x^1823 + x^1822 + x^1821 + x^1820 + x^1819 + x^1818 + x^1817 + x^1813 + x^1812 + x^1810 + x^1809 + x^1808 + x^1807 + x^1803 + x^1799 + x^1797 + x^1796 + x^1794 + x^1792 + x^1790 + x^1786 + x^1783 + x^1782 + x^1779 + x^1778 + x^1776 + x^1775 + x^1774 + x^1772 + x^1767 + x^1766 + x^1765 + x^1764 + x^1763 + x^1762 + x^1759 + x^1757 + x^1756 + x^1754 + x^1753 + x^1752 + x^1750 + x^1749 + x^1741 + x^1734 + x^1730 + x^1729 + x^1726 + x^1725 + x^1723 + x^1722 + x^1721 + x^1716 + x^1714 + x^1713 + x^1712 + x^1710 + x^1709 + x^1706 + x^1705 + x^1703 + x^1702 + x^1700 + x^1698 + x^1693 + x^1692 + x^1691 + x^1690 + x^1683 + x^1682 + x^1681 + x^1680 + x^1679 + x^1677 + x^1672 + x^1670 + x^1669 + x^1666 + x^1663 + x^1662 + x^1661 + x^1659 + x^1655 + x^1653 + x^1651 + x^1649 + x^1648 + x^1647 + x^1646 + x^1644 + x^1643 + x^1642 + x^1640 + x^1639 + x^1638 + x^1634 + x^1633 + x^1628 + x^1620 + x^1619 + x^1618 + x^1616 + x^1614 + x^1611 + x^1610 + x^1608 + x^1605 + x^1604 + x^1603 + x^1599 + x^1597 + x^1595 + x^1594 + x^1590 + x^1588 + x^1587 + x^1585 + x^1583 + x^1580 + x^1579 + x^1577 + x^1574 + x^1573 + x^1572 + x^1568 + x^1566 + x^1565 + x^1563 + x^1562 + x^1560 + x^1555 + x^1554 + x^1552 + x^1550 + x^1549 + x^1548 + x^1545 + x^1544 + x^1542 + x^1540 + x^1538 + x^1537 + x^1536 + x^1535 + x^1534 + x^1533 + x^1532 + x^1531 + x^1528 + x^1526 + x^1525 + x^1523 + x^1522 + x^1521 + x^1519 + x^1517 + x^1515 + x^1510 + x^1509 + x^1506 + x^1504 + x^1502 + x^1499 + x^1498 + x^1497 + x^1488 + x^1483 + x^1480 + x^1477 + x^1472 + x^1471 + x^1469 + x^1468 + x^1467 + x^1466 + x^1464 + x^1462 + x^1457 + x^1456 + x^1455 + x^1454 + x^1453 + x^1452 + x^1448 + x^1446 + x^1444 + x^1443 + x^1442 + x^1441 + x^1440 + x^1436 + x^1435 + x^1431 + x^1428 + x^1425 + x^1424 + x^1422 + x^1420 + x^1415 + x^1414 + x^1411 + x^1410 + x^1408 + x^1406 + x^1405 + x^1403 + x^1402 + x^1399 + x^1397 + x^1396 + x^1395 + x^1394 + x^1393 + x^1391 + x^1388 + x^1385 + x^1377 + x^1376 + x^1372 + x^1371 + x^1370 + x^1369 + x^1367 + x^1363 + x^1361 + x^1357 + x^1355 + x^1354 + x^1349 + x^1343 + x^1339 + x^1338 + x^1337 + x^1336 + x^1335 + x^1332 + x^1329 + x^1327 + x^1326 + x^1324 + x^1321 + x^1315 + x^1314 + x^1312 + x^1310 + x^1309 + x^1305 + x^1304 + x^1303 + x^1302 + x^1299 + x^1298 + x^1296 + x^1295 + x^1293 + x^1291 + x^1290 + x^1289 + x^1284 + x^1283 + x^1282 + x^1281 + x^1280 + x^1278 + x^1277 + x^1276 + x^1275 + x^1272 + x^1270 + x^1269 + x^1268 + x^1267 + x^1259 + x^1257 + x^1254 + x^1252 + x^1251 + x^1249 + x^1247 + x^1246 + x^1244 + x^1240 + x^1238 + x^1233 + x^1232 + x^1229 + x^1222 + x^1219 + x^1217 + x^1211 + x^1209 + x^1208 + x^1205 + x^1204 + x^1203 + x^1202 + x^1200 + x^1197 + x^1196 + x^1195 + x^1193 + x^1192 + x^1189 + x^1187 + x^1186 + x^1185 + x^1184 + x^1183 + x^1182 + x^1181 + x^1177 + x^1176 + x^1173 + x^1170 + x^1167 + x^1166 + x^1162 + x^1161 + x^1160 + x^1159 + x^1158 + x^1156 + x^1155 + x^1154 + x^1153 + x^1151 + x^1146 + x^1143 + x^1141 + x^1139 + x^1138 + x^1137 + x^1135 + x^1131 + x^1129 + x^1128 + x^1125 + x^1124 + x^1122 + x^1116 + x^1115 + x^1114 + x^1112 + x^1111 + x^1107 + x^1106 + x^1105 + x^1104 + x^1103 + x^1102 + x^1098 + x^1097 + x^1095 + x^1094 + x^1092 + x^1088 + x^1087 + x^1085 + x^1077 + x^1076 + x^1075 + x^1072 + x^1069 + x^1068 + x^1061 + x^1060 + x^1059 + x^1057 + x^1055 + x^1054 + x^1053 + x^1050 + x^1047 + x^1046 + x^1044 + x^1043 + x^1042 + x^1036 + x^1029 + x^1025 + x^1024 + x^1023 + x^1022 + x^1019 + x^1016 + x^1013 + x^1012 + x^1010 + x^1008 + x^1007 + x^1006 + x^1004 + x^1000 + x^996 + x^995 + x^993 + x^992 + x^989 + x^985 + x^983 + x^978 + x^977 + x^975 + x^972 + x^971 + x^970 + x^969 + x^967 + x^963 + x^957 + x^956 + x^952 + x^950 + x^948 + x^945 + x^942 + x^941 + x^940 + x^938 + x^937 + x^936 + x^935 + x^932 + x^931 + x^930 + x^928 + x^927 + x^926 + x^923 + x^921 + x^918 + x^916 + x^914 + x^913 + x^909 + x^906 + x^905 + x^904 + x^902 + x^897 + x^895 + x^892 + x^889 + x^888 + x^887 + x^886 + x^885 + x^884 + x^882 + x^881 + x^879 + x^876 + x^870 + x^868 + x^867 + x^865 + x^862 + x^861 + x^859 + x^858 + x^856 + x^854 + x^848 + x^847 + x^846 + x^843 + x^839 + x^837 + x^836 + x^832 + x^831 + x^830 + x^829 + x^826 + x^823 + x^821 + x^820 + x^817 + x^815 + x^812 + x^809 + x^808 + x^805 + x^803 + x^802 + x^800 + x^799 + x^797 + x^795 + x^793 + x^792 + x^788 + x^786 + x^784 + x^780 + x^775 + x^774 + x^770 + x^768 + x^766 + x^764 + x^761 + x^760 + x^753 + x^752 + x^751 + x^750 + x^747 + x^744 + x^742 + x^741 + x^737 + x^734 + x^732 + x^728 + x^727 + x^724 + x^722 + x^721 + x^719 + x^717 + x^715 + x^714 + x^713 + x^710 + x^709 + x^705 + x^703 + x^701 + x^698 + x^697 + x^695 + x^690 + x^687 + x^685 + x^684 + x^682 + x^681 + x^680 + x^677 + x^676 + x^674 + x^673 + x^672 + x^671 + x^670 + x^669 + x^665 + x^663 + x^659 + x^652 + x^651 + x^650 + x^649 + x^648 + x^647 + x^646 + x^645 + x^642 + x^640 + x^638 + x^632 + x^631 + x^630 + x^629 + x^627 + x^626 + x^623 + x^622 + x^621 + x^620 + x^616 + x^615 + x^610 + x^605 + x^602 + x^601 + x^600 + x^599 + x^598 + x^596 + x^594 + x^593 + x^591 + x^583 + x^581 + x^579 + x^578 + x^577 + x^576 + x^575 + x^573 + x^572 + x^571 + x^570 + x^569 + x^565 + x^563 + x^562 + x^561 + x^559 + x^557 + x^555 + x^552 + x^551 + x^546 + x^544 + x^542 + x^541 + x^540 + x^539 + x^538 + x^537 + x^535 + x^533 + x^530 + x^527 + x^523 + x^522 + x^520 + x^519 + x^515 + x^513 + x^511 + x^509 + x^507 + x^505 + x^504 + x^503 + x^499 + x^497 + x^496 + x^495 + x^493 + x^492 + x^488 + x^486 + x^481 + x^480 + x^479 + x^478 + x^477 + x^472 + x^470 + x^468 + x^467 + x^464 + x^463 + x^460 + x^459 + x^455 + x^454 + x^453 + x^446 + x^445 + x^444 + x^443 + x^440 + x^438 + x^437 + x^432 + x^431 + x^428 + x^427 + x^426 + x^420 + x^419 + x^416 + x^415 + x^414 + x^413 + x^412 + x^411 + x^405 + x^404 + x^401 + x^396 + x^393 + x^392 + x^391 + x^388 + x^387 + x^383 + x^381 + x^380 + x^377 + x^376 + x^369 + x^364 + x^362 + x^358 + x^357 + x^356 + x^355 + x^353 + x^351 + x^349 + x^340 + x^339 + x^338 + x^337 + x^336 + x^335 + x^334 + x^332 + x^330 + x^328 + x^327 + x^326 + x^324 + x^320 + x^318 + x^316 + x^315 + x^309 + x^302 + x^298 + x^292 + x^291 + x^290 + x^289 + x^287 + x^286 + x^285 + x^284 + x^281 + x^279 + x^278 + x^276 + x^274 + x^273 + x^272 + x^271 + x^267 + x^266 + x^264 + x^263 + x^262 + x^260 + x^259 + x^256 + x^254 + x^253 + x^252 + x^251 + x^249 + x^248 + x^247 + x^245 + x^244 + x^241 + x^239 + x^235 + x^234 + x^233 + x^232 + x^231 + x^230 + x^226 + x^224 + x^221 + x^219 + x^218 + x^216 + x^215 + x^214 + x^209 + x^207 + x^206 + x^202 + x^201 + x^198 + x^197 + x^194 + x^193 + x^192 + x^191 + x^189 + x^188 + x^183 + x^182 + x^181 + x^180 + x^179 + x^178 + x^177 + x^175 + x^172 + x^169 + x^168 + x^166 + x^165 + x^164 + x^163 + x^158 + x^157 + x^153 + x^152 + x^149 + x^147 + x^146 + x^144 + x^140 + x^139 + x^136 + x^128 + x^127 + x^126 + x^124 + x^123 + x^122 + x^121 + x^116 + x^115 + x^113 + x^112 + x^109 + x^108 + x^107 + x^106 + x^104 + x^103 + x^102 + x^101 + x^100 + x^99 + x^97 + x^95 + x^94 + x^93 + x^92 + x^87 + x^84 + x^83 + x^82 + x^80 + x^79 + x^78 + x^76 + x^73 + x^70 + x^69 + x^68 + x^67 + x^66 + x^65 + x^63 + x^60 + x^59 + x^57 + x^55 + x^52 + x^51 + x^47 + x^46 + x^45 + x^43 + x^42 + x^40 + x^36 + x^35 + x^30 + x^29 + x^28 + x^27 + x^23 + x^20 + x^17 + x^14 + x^9 + x^7 + x^3 + 1&#x27;</span>)</span><br><span class="line">c = <span class="number">23931938409134006846469410550487073743925192650755116938225541794524723083910240603620279453298714584321800170326063144616472531553643627071552202613402950579120189960424183462876292590831564884347025119938858471788053191321980663696621632084753893732784657023312407591768406322125753947265987815937165961039424015628319982913336402297718720925447102042668906173729998301139577468193468132305331072754842771657432484688590927575895743853584931297836925498250475231655832566787366689988158399203844420168837827423836936015638932385609040452870954522482255864355639427304567768665723098741671323173831781775755570779256</span></span><br><span class="line">c_poly = P(R.fetch_int(c))</span><br><span class="line"></span><br><span class="line">p,q = factor(n)[<span class="number">0</span>][<span class="number">0</span>],factor(n)[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">phi = (<span class="number">2</span>^p.degree()-<span class="number">1</span>)*(<span class="number">2</span>^q.degree()-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line"></span><br><span class="line">m_poly = <span class="built_in">pow</span>(c_poly, d, n)</span><br><span class="line">m_int = R(m_poly).integer_representation()</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m_int))</span><br></pre></td></tr></table></figure>



<h2 id="watevrCTF-2019——Swedish-RSA"><a href="#watevrCTF-2019——Swedish-RSA" class="headerlink" title="watevrCTF 2019——Swedish RSA"></a>watevrCTF 2019——Swedish RSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="built_in">bytearray</span>(raw_input())</span><br><span class="line">flag = <span class="built_in">list</span>(flag)</span><br><span class="line">length = <span class="built_in">len</span>(flag)</span><br><span class="line">bits = <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Prime for Finite Field.</span></span><br><span class="line">p = random_prime(<span class="number">2</span>^bits-<span class="number">1</span>, <span class="literal">False</span>, <span class="number">2</span>^(bits-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">file_out = <span class="built_in">open</span>(<span class="string">&quot;downloads/polynomial_rsa.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">file_out.write(<span class="string">&quot;Prime: &quot;</span> + <span class="built_in">str</span>(p) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Univariate Polynomial Ring in y over Finite Field of size p</span></span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(p))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Analogous to the primes in Z</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_irreducable_poly</span>(<span class="params">deg</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        out = R.random_element(degree=deg)</span><br><span class="line">        <span class="keyword">if</span> out.is_irreducible():</span><br><span class="line">            <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## Polynomial &quot;primes&quot;</span></span><br><span class="line">P = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span>*length))</span><br><span class="line">Q = gen_irreducable_poly(ZZ.random_element(length, <span class="number">2</span>*length))</span><br><span class="line"></span><br><span class="line"><span class="comment">## Public exponent key</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Modulus</span></span><br><span class="line">N = P*Q</span><br><span class="line">file_out.write(<span class="string">&quot;Modulus: &quot;</span> + <span class="built_in">str</span>(N) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Univariate Quotient Polynomial Ring in x over Finite Field of size 659 with modulus N(x)</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line"></span><br><span class="line"><span class="comment">## Encrypt</span></span><br><span class="line">m = S(flag)</span><br><span class="line">c = m^e</span><br><span class="line"></span><br><span class="line">file_out.write(<span class="string">&quot;Ciphertext: &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line">file_out.close()</span><br></pre></td></tr></table></figure>

<p><code>out = R.random_element(degree=deg)</code>，作用是从一个给定的环或域 <code>R</code> 中生成一个随机元素，并限定该随机元素的次数（degree）。就是会生成一个环R中次数不超过deg的多项式</p>
<p><code>is_irreducible()</code>：作用是判断一个多项式是不是不可约的，如果是不可约的就返回<code>True</code></p>
<p><code>R.quotient</code> ，用于计算环或域 <code>R</code> 的商环或商域</p>
<p>先把N分解了，得到一个65次的多项式和一个112次的多项式。</p>
<p>然后重点是计算$\phi(N)&#x3D;\phi(p)×\phi(q)$</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">对于整数n来讲，欧拉函数<span class="built_in">phi</span>(n)表示所有小于或等于n的正整数中与n互质的数的数目。</span><br><span class="line">对于多项式<span class="selector-tag">P</span>(y)来讲，欧拉函数<span class="built_in">phi</span>(P(y))表示所有不高于<span class="selector-tag">P</span>(y)幂级的环内所有多项式中，与<span class="selector-tag">P</span>(y)无除<span class="number">1</span>以外的公因式的其他多项式的个数。</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.diva-portal.se/smash/get/diva2:823505/FULLTEXT01.pdf">这篇论文</a>指出了欧拉函数的计算方法</p>
<p><img src="/../images/RSA/51.png"></p>
<p>本题中，$p$，$q$都是环R上的多项式，而且$p$，$q$都不可约</p>
<p>$\therefore \phi(N) &#x3D; (p^{65}-1)×(p^{112}-1)$</p>
<p>然后就是常规RSA解法(我表示很震惊)，而且最后 flag的提取也很奇怪</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">P = <span class="number">43753</span></span><br><span class="line">R.&lt;y&gt; = PolynomialRing(GF(P))</span><br><span class="line">N = <span class="number">34036</span>*y^<span class="number">177</span> + <span class="number">23068</span>*y^<span class="number">176</span> + <span class="number">13147</span>*y^<span class="number">175</span> + <span class="number">36344</span>*y^<span class="number">174</span> + <span class="number">10045</span>*y^<span class="number">173</span> + <span class="number">41049</span>*y^<span class="number">172</span> + <span class="number">17786</span>*y^<span class="number">171</span> + <span class="number">16601</span>*y^<span class="number">170</span> + <span class="number">7929</span>*y^<span class="number">169</span> + <span class="number">37570</span>*y^<span class="number">168</span> + <span class="number">990</span>*y^<span class="number">167</span> + <span class="number">9622</span>*y^<span class="number">166</span> + <span class="number">39273</span>*y^<span class="number">165</span> + <span class="number">35284</span>*y^<span class="number">164</span> + <span class="number">15632</span>*y^<span class="number">163</span> + <span class="number">18850</span>*y^<span class="number">162</span> + <span class="number">8800</span>*y^<span class="number">161</span> + <span class="number">33148</span>*y^<span class="number">160</span> + <span class="number">12147</span>*y^<span class="number">159</span> + <span class="number">40487</span>*y^<span class="number">158</span> + <span class="number">6407</span>*y^<span class="number">157</span> + <span class="number">34111</span>*y^<span class="number">156</span> + <span class="number">8446</span>*y^<span class="number">155</span> + <span class="number">21908</span>*y^<span class="number">154</span> + <span class="number">16812</span>*y^<span class="number">153</span> + <span class="number">40624</span>*y^<span class="number">152</span> + <span class="number">43506</span>*y^<span class="number">151</span> + <span class="number">39116</span>*y^<span class="number">150</span> + <span class="number">33011</span>*y^<span class="number">149</span> + <span class="number">23914</span>*y^<span class="number">148</span> + <span class="number">2210</span>*y^<span class="number">147</span> + <span class="number">23196</span>*y^<span class="number">146</span> + <span class="number">43359</span>*y^<span class="number">145</span> + <span class="number">34455</span>*y^<span class="number">144</span> + <span class="number">17684</span>*y^<span class="number">143</span> + <span class="number">25262</span>*y^<span class="number">142</span> + <span class="number">982</span>*y^<span class="number">141</span> + <span class="number">24015</span>*y^<span class="number">140</span> + <span class="number">27968</span>*y^<span class="number">139</span> + <span class="number">37463</span>*y^<span class="number">138</span> + <span class="number">10667</span>*y^<span class="number">137</span> + <span class="number">39519</span>*y^<span class="number">136</span> + <span class="number">31176</span>*y^<span class="number">135</span> + <span class="number">27520</span>*y^<span class="number">134</span> + <span class="number">32118</span>*y^<span class="number">133</span> + <span class="number">8333</span>*y^<span class="number">132</span> + <span class="number">38945</span>*y^<span class="number">131</span> + <span class="number">34713</span>*y^<span class="number">130</span> + <span class="number">1107</span>*y^<span class="number">129</span> + <span class="number">43604</span>*y^<span class="number">128</span> + <span class="number">4433</span>*y^<span class="number">127</span> + <span class="number">18110</span>*y^<span class="number">126</span> + <span class="number">17658</span>*y^<span class="number">125</span> + <span class="number">32354</span>*y^<span class="number">124</span> + <span class="number">3219</span>*y^<span class="number">123</span> + <span class="number">40238</span>*y^<span class="number">122</span> + <span class="number">10439</span>*y^<span class="number">121</span> + <span class="number">3669</span>*y^<span class="number">120</span> + <span class="number">8713</span>*y^<span class="number">119</span> + <span class="number">21027</span>*y^<span class="number">118</span> + <span class="number">29480</span>*y^<span class="number">117</span> + <span class="number">5477</span>*y^<span class="number">116</span> + <span class="number">24332</span>*y^<span class="number">115</span> + <span class="number">43480</span>*y^<span class="number">114</span> + <span class="number">33406</span>*y^<span class="number">113</span> + <span class="number">43121</span>*y^<span class="number">112</span> + <span class="number">1114</span>*y^<span class="number">111</span> + <span class="number">17198</span>*y^<span class="number">110</span> + <span class="number">22829</span>*y^<span class="number">109</span> + <span class="number">24424</span>*y^<span class="number">108</span> + <span class="number">16523</span>*y^<span class="number">107</span> + <span class="number">20424</span>*y^<span class="number">106</span> + <span class="number">36206</span>*y^<span class="number">105</span> + <span class="number">41849</span>*y^<span class="number">104</span> + <span class="number">3584</span>*y^<span class="number">103</span> + <span class="number">26500</span>*y^<span class="number">102</span> + <span class="number">31897</span>*y^<span class="number">101</span> + <span class="number">34640</span>*y^<span class="number">100</span> + <span class="number">27449</span>*y^<span class="number">99</span> + <span class="number">30962</span>*y^<span class="number">98</span> + <span class="number">41434</span>*y^<span class="number">97</span> + <span class="number">22125</span>*y^<span class="number">96</span> + <span class="number">24314</span>*y^<span class="number">95</span> + <span class="number">3944</span>*y^<span class="number">94</span> + <span class="number">18400</span>*y^<span class="number">93</span> + <span class="number">38476</span>*y^<span class="number">92</span> + <span class="number">28904</span>*y^<span class="number">91</span> + <span class="number">27936</span>*y^<span class="number">90</span> + <span class="number">41867</span>*y^<span class="number">89</span> + <span class="number">25573</span>*y^<span class="number">88</span> + <span class="number">25659</span>*y^<span class="number">87</span> + <span class="number">33443</span>*y^<span class="number">86</span> + <span class="number">18435</span>*y^<span class="number">85</span> + <span class="number">5934</span>*y^<span class="number">84</span> + <span class="number">38030</span>*y^<span class="number">83</span> + <span class="number">17563</span>*y^<span class="number">82</span> + <span class="number">24086</span>*y^<span class="number">81</span> + <span class="number">36782</span>*y^<span class="number">80</span> + <span class="number">20922</span>*y^<span class="number">79</span> + <span class="number">38933</span>*y^<span class="number">78</span> + <span class="number">23448</span>*y^<span class="number">77</span> + <span class="number">10599</span>*y^<span class="number">76</span> + <span class="number">7156</span>*y^<span class="number">75</span> + <span class="number">29044</span>*y^<span class="number">74</span> + <span class="number">23605</span>*y^<span class="number">73</span> + <span class="number">7657</span>*y^<span class="number">72</span> + <span class="number">28200</span>*y^<span class="number">71</span> + <span class="number">2431</span>*y^<span class="number">70</span> + <span class="number">3860</span>*y^<span class="number">69</span> + <span class="number">23259</span>*y^<span class="number">68</span> + <span class="number">14590</span>*y^<span class="number">67</span> + <span class="number">33631</span>*y^<span class="number">66</span> + <span class="number">15673</span>*y^<span class="number">65</span> + <span class="number">36049</span>*y^<span class="number">64</span> + <span class="number">29728</span>*y^<span class="number">63</span> + <span class="number">22413</span>*y^<span class="number">62</span> + <span class="number">18602</span>*y^<span class="number">61</span> + <span class="number">18557</span>*y^<span class="number">60</span> + <span class="number">23505</span>*y^<span class="number">59</span> + <span class="number">17642</span>*y^<span class="number">58</span> + <span class="number">12595</span>*y^<span class="number">57</span> + <span class="number">17255</span>*y^<span class="number">56</span> + <span class="number">15316</span>*y^<span class="number">55</span> + <span class="number">8948</span>*y^<span class="number">54</span> + <span class="number">38</span>*y^<span class="number">53</span> + <span class="number">40329</span>*y^<span class="number">52</span> + <span class="number">9823</span>*y^<span class="number">51</span> + <span class="number">5798</span>*y^<span class="number">50</span> + <span class="number">6379</span>*y^<span class="number">49</span> + <span class="number">8662</span>*y^<span class="number">48</span> + <span class="number">34640</span>*y^<span class="number">47</span> + <span class="number">38321</span>*y^<span class="number">46</span> + <span class="number">18760</span>*y^<span class="number">45</span> + <span class="number">13135</span>*y^<span class="number">44</span> + <span class="number">15926</span>*y^<span class="number">43</span> + <span class="number">34952</span>*y^<span class="number">42</span> + <span class="number">28940</span>*y^<span class="number">41</span> + <span class="number">13558</span>*y^<span class="number">40</span> + <span class="number">42579</span>*y^<span class="number">39</span> + <span class="number">38015</span>*y^<span class="number">38</span> + <span class="number">33788</span>*y^<span class="number">37</span> + <span class="number">12381</span>*y^<span class="number">36</span> + <span class="number">195</span>*y^<span class="number">35</span> + <span class="number">13709</span>*y^<span class="number">34</span> + <span class="number">31500</span>*y^<span class="number">33</span> + <span class="number">32994</span>*y^<span class="number">32</span> + <span class="number">30486</span>*y^<span class="number">31</span> + <span class="number">40414</span>*y^<span class="number">30</span> + <span class="number">2578</span>*y^<span class="number">29</span> + <span class="number">30525</span>*y^<span class="number">28</span> + <span class="number">43067</span>*y^<span class="number">27</span> + <span class="number">6195</span>*y^<span class="number">26</span> + <span class="number">36288</span>*y^<span class="number">25</span> + <span class="number">23236</span>*y^<span class="number">24</span> + <span class="number">21493</span>*y^<span class="number">23</span> + <span class="number">15808</span>*y^<span class="number">22</span> + <span class="number">34500</span>*y^<span class="number">21</span> + <span class="number">6390</span>*y^<span class="number">20</span> + <span class="number">42994</span>*y^<span class="number">19</span> + <span class="number">42151</span>*y^<span class="number">18</span> + <span class="number">19248</span>*y^<span class="number">17</span> + <span class="number">19291</span>*y^<span class="number">16</span> + <span class="number">8124</span>*y^<span class="number">15</span> + <span class="number">40161</span>*y^<span class="number">14</span> + <span class="number">24726</span>*y^<span class="number">13</span> + <span class="number">31874</span>*y^<span class="number">12</span> + <span class="number">30272</span>*y^<span class="number">11</span> + <span class="number">30761</span>*y^<span class="number">10</span> + <span class="number">2296</span>*y^<span class="number">9</span> + <span class="number">11017</span>*y^<span class="number">8</span> + <span class="number">16559</span>*y^<span class="number">7</span> + <span class="number">28949</span>*y^<span class="number">6</span> + <span class="number">40499</span>*y^<span class="number">5</span> + <span class="number">22377</span>*y^<span class="number">4</span> + <span class="number">33628</span>*y^<span class="number">3</span> + <span class="number">30598</span>*y^<span class="number">2</span> + <span class="number">4386</span>*y + <span class="number">23814</span></span><br><span class="line">S.&lt;x&gt; = R.quotient(N)</span><br><span class="line">C = <span class="number">5209</span>*x^<span class="number">176</span> + <span class="number">10881</span>*x^<span class="number">175</span> + <span class="number">31096</span>*x^<span class="number">174</span> + <span class="number">23354</span>*x^<span class="number">173</span> + <span class="number">28337</span>*x^<span class="number">172</span> + <span class="number">15982</span>*x^<span class="number">171</span> + <span class="number">13515</span>*x^<span class="number">170</span> + <span class="number">21641</span>*x^<span class="number">169</span> + <span class="number">10254</span>*x^<span class="number">168</span> + <span class="number">34588</span>*x^<span class="number">167</span> + <span class="number">27434</span>*x^<span class="number">166</span> + <span class="number">29552</span>*x^<span class="number">165</span> + <span class="number">7105</span>*x^<span class="number">164</span> + <span class="number">22604</span>*x^<span class="number">163</span> + <span class="number">41253</span>*x^<span class="number">162</span> + <span class="number">42675</span>*x^<span class="number">161</span> + <span class="number">21153</span>*x^<span class="number">160</span> + <span class="number">32838</span>*x^<span class="number">159</span> + <span class="number">34391</span>*x^<span class="number">158</span> + <span class="number">832</span>*x^<span class="number">157</span> + <span class="number">720</span>*x^<span class="number">156</span> + <span class="number">22883</span>*x^<span class="number">155</span> + <span class="number">19236</span>*x^<span class="number">154</span> + <span class="number">33772</span>*x^<span class="number">153</span> + <span class="number">5020</span>*x^<span class="number">152</span> + <span class="number">17943</span>*x^<span class="number">151</span> + <span class="number">26967</span>*x^<span class="number">150</span> + <span class="number">30847</span>*x^<span class="number">149</span> + <span class="number">10306</span>*x^<span class="number">148</span> + <span class="number">33966</span>*x^<span class="number">147</span> + <span class="number">43255</span>*x^<span class="number">146</span> + <span class="number">20342</span>*x^<span class="number">145</span> + <span class="number">4474</span>*x^<span class="number">144</span> + <span class="number">3490</span>*x^<span class="number">143</span> + <span class="number">38033</span>*x^<span class="number">142</span> + <span class="number">11224</span>*x^<span class="number">141</span> + <span class="number">30565</span>*x^<span class="number">140</span> + <span class="number">31967</span>*x^<span class="number">139</span> + <span class="number">32382</span>*x^<span class="number">138</span> + <span class="number">9759</span>*x^<span class="number">137</span> + <span class="number">1030</span>*x^<span class="number">136</span> + <span class="number">32122</span>*x^<span class="number">135</span> + <span class="number">42614</span>*x^<span class="number">134</span> + <span class="number">14280</span>*x^<span class="number">133</span> + <span class="number">16533</span>*x^<span class="number">132</span> + <span class="number">32676</span>*x^<span class="number">131</span> + <span class="number">43070</span>*x^<span class="number">130</span> + <span class="number">36009</span>*x^<span class="number">129</span> + <span class="number">28497</span>*x^<span class="number">128</span> + <span class="number">2940</span>*x^<span class="number">127</span> + <span class="number">9747</span>*x^<span class="number">126</span> + <span class="number">22758</span>*x^<span class="number">125</span> + <span class="number">16615</span>*x^<span class="number">124</span> + <span class="number">14086</span>*x^<span class="number">123</span> + <span class="number">13038</span>*x^<span class="number">122</span> + <span class="number">39603</span>*x^<span class="number">121</span> + <span class="number">36260</span>*x^<span class="number">120</span> + <span class="number">32502</span>*x^<span class="number">119</span> + <span class="number">17619</span>*x^<span class="number">118</span> + <span class="number">17700</span>*x^<span class="number">117</span> + <span class="number">15083</span>*x^<span class="number">116</span> + <span class="number">11311</span>*x^<span class="number">115</span> + <span class="number">36496</span>*x^<span class="number">114</span> + <span class="number">1300</span>*x^<span class="number">113</span> + <span class="number">13601</span>*x^<span class="number">112</span> + <span class="number">43425</span>*x^<span class="number">111</span> + <span class="number">10376</span>*x^<span class="number">110</span> + <span class="number">11551</span>*x^<span class="number">109</span> + <span class="number">13684</span>*x^<span class="number">108</span> + <span class="number">14955</span>*x^<span class="number">107</span> + <span class="number">6661</span>*x^<span class="number">106</span> + <span class="number">12674</span>*x^<span class="number">105</span> + <span class="number">21534</span>*x^<span class="number">104</span> + <span class="number">32132</span>*x^<span class="number">103</span> + <span class="number">34135</span>*x^<span class="number">102</span> + <span class="number">43684</span>*x^<span class="number">101</span> + <span class="number">837</span>*x^<span class="number">100</span> + <span class="number">29311</span>*x^<span class="number">99</span> + <span class="number">4849</span>*x^<span class="number">98</span> + <span class="number">26632</span>*x^<span class="number">97</span> + <span class="number">26662</span>*x^<span class="number">96</span> + <span class="number">10159</span>*x^<span class="number">95</span> + <span class="number">32657</span>*x^<span class="number">94</span> + <span class="number">12149</span>*x^<span class="number">93</span> + <span class="number">17858</span>*x^<span class="number">92</span> + <span class="number">35805</span>*x^<span class="number">91</span> + <span class="number">19391</span>*x^<span class="number">90</span> + <span class="number">30884</span>*x^<span class="number">89</span> + <span class="number">42039</span>*x^<span class="number">88</span> + <span class="number">17292</span>*x^<span class="number">87</span> + <span class="number">4694</span>*x^<span class="number">86</span> + <span class="number">1497</span>*x^<span class="number">85</span> + <span class="number">1744</span>*x^<span class="number">84</span> + <span class="number">31071</span>*x^<span class="number">83</span> + <span class="number">26246</span>*x^<span class="number">82</span> + <span class="number">24402</span>*x^<span class="number">81</span> + <span class="number">22068</span>*x^<span class="number">80</span> + <span class="number">39263</span>*x^<span class="number">79</span> + <span class="number">23703</span>*x^<span class="number">78</span> + <span class="number">21484</span>*x^<span class="number">77</span> + <span class="number">12241</span>*x^<span class="number">76</span> + <span class="number">28821</span>*x^<span class="number">75</span> + <span class="number">32886</span>*x^<span class="number">74</span> + <span class="number">43075</span>*x^<span class="number">73</span> + <span class="number">35741</span>*x^<span class="number">72</span> + <span class="number">19936</span>*x^<span class="number">71</span> + <span class="number">37219</span>*x^<span class="number">70</span> + <span class="number">33411</span>*x^<span class="number">69</span> + <span class="number">8301</span>*x^<span class="number">68</span> + <span class="number">12949</span>*x^<span class="number">67</span> + <span class="number">28611</span>*x^<span class="number">66</span> + <span class="number">42654</span>*x^<span class="number">65</span> + <span class="number">6910</span>*x^<span class="number">64</span> + <span class="number">18523</span>*x^<span class="number">63</span> + <span class="number">31144</span>*x^<span class="number">62</span> + <span class="number">21398</span>*x^<span class="number">61</span> + <span class="number">36298</span>*x^<span class="number">60</span> + <span class="number">27158</span>*x^<span class="number">59</span> + <span class="number">918</span>*x^<span class="number">58</span> + <span class="number">38601</span>*x^<span class="number">57</span> + <span class="number">4269</span>*x^<span class="number">56</span> + <span class="number">5699</span>*x^<span class="number">55</span> + <span class="number">36444</span>*x^<span class="number">54</span> + <span class="number">34791</span>*x^<span class="number">53</span> + <span class="number">37978</span>*x^<span class="number">52</span> + <span class="number">32481</span>*x^<span class="number">51</span> + <span class="number">8039</span>*x^<span class="number">50</span> + <span class="number">11012</span>*x^<span class="number">49</span> + <span class="number">11454</span>*x^<span class="number">48</span> + <span class="number">30450</span>*x^<span class="number">47</span> + <span class="number">1381</span>*x^<span class="number">46</span> + <span class="number">32403</span>*x^<span class="number">45</span> + <span class="number">8202</span>*x^<span class="number">44</span> + <span class="number">8404</span>*x^<span class="number">43</span> + <span class="number">37648</span>*x^<span class="number">42</span> + <span class="number">43696</span>*x^<span class="number">41</span> + <span class="number">34237</span>*x^<span class="number">40</span> + <span class="number">36490</span>*x^<span class="number">39</span> + <span class="number">41423</span>*x^<span class="number">38</span> + <span class="number">35792</span>*x^<span class="number">37</span> + <span class="number">36950</span>*x^<span class="number">36</span> + <span class="number">31086</span>*x^<span class="number">35</span> + <span class="number">38970</span>*x^<span class="number">34</span> + <span class="number">12439</span>*x^<span class="number">33</span> + <span class="number">7963</span>*x^<span class="number">32</span> + <span class="number">16150</span>*x^<span class="number">31</span> + <span class="number">11382</span>*x^<span class="number">30</span> + <span class="number">3038</span>*x^<span class="number">29</span> + <span class="number">20157</span>*x^<span class="number">28</span> + <span class="number">23531</span>*x^<span class="number">27</span> + <span class="number">32866</span>*x^<span class="number">26</span> + <span class="number">5428</span>*x^<span class="number">25</span> + <span class="number">21132</span>*x^<span class="number">24</span> + <span class="number">13443</span>*x^<span class="number">23</span> + <span class="number">28909</span>*x^<span class="number">22</span> + <span class="number">42716</span>*x^<span class="number">21</span> + <span class="number">6567</span>*x^<span class="number">20</span> + <span class="number">24744</span>*x^<span class="number">19</span> + <span class="number">8727</span>*x^<span class="number">18</span> + <span class="number">14895</span>*x^<span class="number">17</span> + <span class="number">28172</span>*x^<span class="number">16</span> + <span class="number">30903</span>*x^<span class="number">15</span> + <span class="number">26608</span>*x^<span class="number">14</span> + <span class="number">27314</span>*x^<span class="number">13</span> + <span class="number">42224</span>*x^<span class="number">12</span> + <span class="number">42551</span>*x^<span class="number">11</span> + <span class="number">37726</span>*x^<span class="number">10</span> + <span class="number">11203</span>*x^<span class="number">9</span> + <span class="number">36816</span>*x^<span class="number">8</span> + <span class="number">5537</span>*x^<span class="number">7</span> + <span class="number">20301</span>*x^<span class="number">6</span> + <span class="number">17591</span>*x^<span class="number">5</span> + <span class="number">41279</span>*x^<span class="number">4</span> + <span class="number">7999</span>*x^<span class="number">3</span> + <span class="number">33753</span>*x^<span class="number">2</span> + <span class="number">34551</span>*x + <span class="number">9659</span></span><br><span class="line"></span><br><span class="line">p,q = factor(N)</span><br><span class="line">p,q = p[<span class="number">0</span>],q[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">phi = (P^p.degree() - <span class="number">1</span>)*(P^q.degree()-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi)</span><br><span class="line">m = C^d</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(m.<span class="built_in">list</span>())</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> m.<span class="built_in">list</span>()])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p><code>m.list()</code>是把m这个多项式中每一项的系数按照次幂上升的顺序进行排列</p>
<h2 id="2021强网拟态——OnlyRSA"><a href="#2021强网拟态——OnlyRSA" class="headerlink" title="2021强网拟态——OnlyRSA"></a>2021强网拟态——OnlyRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># c = </span></span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">n = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">digits = n.digits(<span class="number">11</span>)</span><br><span class="line">f = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i, each <span class="keyword">in</span> <span class="built_in">enumerate</span>(digits):</span><br><span class="line">    f += each * x ^ i</span><br><span class="line"></span><br><span class="line">factors = f.factor_list()</span><br><span class="line"></span><br><span class="line">p = factors[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">q = factors[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">p = p(x=<span class="number">11</span>)</span><br><span class="line">q = q(x=<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line">d = inverse_mod(<span class="number">65537</span>,(p-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>







<h1 id="coppersmith"><a href="#coppersmith" class="headerlink" title="coppersmith"></a>coppersmith</h1><h2 id="恢复OAEP私钥"><a href="#恢复OAEP私钥" class="headerlink" title="恢复OAEP私钥"></a>恢复OAEP私钥</h2><p>题目来源：[蓝帽杯 2022 初赛]corrupted_key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">key = RSA.generate(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&#x27;wb&#x27;</span>).write(PKCS1_OAEP.new(key.publickey()).encrypt(flag))</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;priv.pem&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>).write(key.exportKey(<span class="string">&#x27;PEM&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>priv.pem:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXgIBAAKBgQDXFSUGqpzsBeUzXWtG9UkUB8MZn9UQkfH2Aw03YrngP0nJ3NwH</span><br><span class="line">UFTgzBSLl0tBhUvZO07haiqHbuYgBegO+Aa3qjtksb+bH6dz41PQzbn/l4Pd1fXm</span><br><span class="line">dJmtEPNh6TjQC4KmpMQqBTXF52cheY6GtFzUuNA7DX51wr6HZqHoQ73GQQIDAQAB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">yQvOzxy6szWFheigQdGxAkEA4wFss2CcHWQ8FnQ5w7k4uIH0I38khg07HLhaYm1c</span><br><span class="line">zUcmlk4PgnDWxN+ev+vMU45O5eGntzaO3lHsaukX9461mA==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>私钥文件缺失信息</p>
<p>上网找pem文件的解析</p>
<p>PKCS#1的私钥文件包含以下信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">RSAPrivateKey ::= SEQUENCE &#123;</span><br><span class="line"> version Version,</span><br><span class="line"> modulus INTEGER, -- n</span><br><span class="line"> publicExponent INTEGER, -- e</span><br><span class="line"> privateExponent INTEGER, -- d</span><br><span class="line"> prime1 INTEGER, -- p</span><br><span class="line"> prime2 INTEGER, -- q</span><br><span class="line"> exponent1 INTEGER, -- d mod (p-<span class="number">1</span>)</span><br><span class="line"> exponent2 INTEGER, -- d mod (q-<span class="number">1</span>)</span><br><span class="line"> coefficient INTEGER -- (inverse of q) mod p </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>标签头：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">3082025C# 标签头</span><br><span class="line">020100 # 整型</span><br><span class="line">028181 # 整型 长度 为 129 字节 (0x81)，内容：模数 n (modulus)</span><br><span class="line">0203 # 整型 长度 为 3 字节(0x03)，内容：e (公钥指数)</span><br><span class="line">028180 # 整型 长度 为 128 字节(0x80)，内容：d (私钥指数)</span><br><span class="line">0241 # 整型 长度 为 65 字节(0x41)，内容：p (素数)</span><br><span class="line">0241 # 整型 长度 为 65 字节(0x41)，内容：q (素数)</span><br><span class="line">0240 # 整型 长度 为 64 字节(0x40)，内容：d mod(p-1)</span><br><span class="line">0240 # 整型 长度 为 64 字节(0x40)，内容：d mod(q-1)</span><br><span class="line">0241 # 整型 长度 为 65 字节(0x41)，内容：(1/q)mod p &lt;即 invert(q,p)&gt;</span><br></pre></td></tr></table></figure>



<p><img src="/../images/RSA/49.png"></p>
<p><img src="/../images/RSA/50.png"></p>
<p>把priv的内容base64解码，再转16进制，并且根据标签头提取信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">0xd7152506aa9cec05e5335d6b46f5491407c3199fd51091f1f6030d3762b9e03f49c9dcdc075054e0cc148b974b41854bd93b4ee16a2a876ee62005e80ef806b7aa3b64b1bf9b1fa773e353d0cdb9ff9783ddd5f5e67499ad10f361e938d00b82a6a4c42a0535c5e76721798e86b45cd4b8d03b0d7e75c2be8766a1e843bdc641</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">dq = <span class="number">0xc90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line">inv = <span class="number">0xe3016cb3609c1d643c167439c3b938b881f4237f24860d3b1cb85a626d5ccd4726964e0f8270d6c4df9ebfebcc538e4ee5e1a7b7368ede51ec6ae917f78eb598</span></span><br></pre></td></tr></table></figure>

<p>即已知$dq \equiv d \mod (q-1)$，$q^{-1} \mod p$，需要注意的是这里的dq不是完整的dq，而是低120位</p>
<p>$\because dq \equiv d \mod (q-1)$，$dq &#x3D; d+k(q-1)$</p>
<p>$\therefore dq × e &#x3D; ed + kd(q-1)$即$dq ×e &#x3D; k_1(p-1)(q-1) + 1 + kd(q-1)$，可以写成$dq ×e &#x3D; k(q-1) + 1$</p>
<p>$\therefore dq ×e + k-1 &#x3D; kq$</p>
<p>两边同模$2^{120}$得$dq×e+k-1 \equiv kq \mod 2^{120}$</p>
<p>$\therefore q \equiv k^{-1}(dq×e +k-1) \mod 2^{120}$</p>
<p>$\because dq &lt; q-1 ,\therefore e &gt; k$</p>
<p>于是我们便能求出$q$的低120位的可能取值</p>
<p>$\because inv ×q \equiv 1 \mod p $，即$inv×q -1 &#x3D; kp$，两边同乘q得$inv×q×q -q &#x3D; kn$</p>
<p>即$inv × q×q -q \equiv 0 \mod (n)$</p>
<p>于是可以用coppersmith恢复求得q</p>
<p>区别于$inv×q-1 \equiv 0 \mod p$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">0xd7152506aa9cec05e5335d6b46f5491407c3199fd51091f1f6030d3762b9e03f49c9dcdc075054e0cc148b974b41854bd93b4ee16a2a876ee62005e80ef806b7aa3b64b1bf9b1fa773e353d0cdb9ff9783ddd5f5e67499ad10f361e938d00b82a6a4c42a0535c5e76721798e86b45cd4b8d03b0d7e75c2be8766a1e843bdc641</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">inv = <span class="number">0xe3016cb3609c1d643c167439c3b938b881f4237f24860d3b1cb85a626d5ccd4726964e0f8270d6c4df9ebfebcc538e4ee5e1a7b7368ede51ec6ae917f78eb598</span></span><br><span class="line">d_low = <span class="number">0xc90bcecf1cbab3358585e8a041d1b1</span></span><br><span class="line">q_low = []</span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>,<span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1</span>,e):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        q0 = invert(i, <span class="number">2</span> ** <span class="number">120</span>) * (e * d_low + i - <span class="number">1</span>) % <span class="number">2</span> ^ <span class="number">120</span></span><br><span class="line">        q_low.append(q0)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(q_low)-<span class="number">1</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    f = inv * (<span class="number">2</span>^<span class="number">120</span>*x + <span class="built_in">int</span>(q_low[i]))^<span class="number">2</span> - (<span class="number">2</span>^<span class="number">120</span>*x + <span class="built_in">int</span>(q_low[i]))</span><br><span class="line">    f = f.monic()</span><br><span class="line">    root = f.small_roots(X = <span class="number">2</span>^(<span class="number">512</span>-<span class="number">120</span>))</span><br><span class="line">    <span class="keyword">if</span> root:</span><br><span class="line">        q = <span class="number">2</span>^<span class="number">120</span> * <span class="built_in">int</span>(root[<span class="number">0</span>]) + <span class="built_in">int</span>(q_low[i])</span><br><span class="line">        p = n // q</span><br><span class="line">        <span class="keyword">if</span> p * q == n:</span><br><span class="line">            d = gmpy2.invert(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>,p)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;q = &quot;</span>,q)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;d = &quot;</span>,d)</span><br><span class="line">            key = RSA.construct((<span class="built_in">int</span>(n),<span class="built_in">int</span>(e),<span class="built_in">int</span>(d),<span class="built_in">int</span>(p),<span class="built_in">int</span>(q)))</span><br><span class="line">            newkey = PKCS1_OAEP.new(key)</span><br><span class="line">            flag = newkey.decrypt(c)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>参考：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/461349946">(PKCS1) RSA 公私钥 pem 文件解析 - 知乎 (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/c93a993f8997">RSA密钥格式解析 - 简书 (jianshu.com)</a></p>
<h2 id="comedy（先搁着）"><a href="#comedy（先搁着）" class="headerlink" title="comedy（先搁着）"></a>comedy（先搁着）</h2><p>题目</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2, libnum</span><br><span class="line">from secret import flag1, flag2</span><br><span class="line"></span><br><span class="line">m = libnum.s2n(flag1)</span><br><span class="line">assert m.bit_length() &lt; 200</span><br><span class="line">B = gmpy2.next_prime(libnum.s2n(flag2))</span><br><span class="line">A = (2022 - 2023 * m) % B</span><br><span class="line">leak = pow(2, 2023, B)</span><br><span class="line">print(A)</span><br><span class="line">print(leak)</span><br><span class="line"># 493275281479560936332761096886786925792234184811353209227551802099268192839677496844153534128991899414803550843408607188612593757622064753867565869035222715177143938385039508273050267347710495512806264863554858016145161165422812554800693811328453743229819656381224407015421235005940088439590887928051969351426291843586132741521121351667152673680122929827805479163871436776753859965413192837591532468372</span><br><span class="line"># 238829196127128263156194898141748280130190920343265228257398802867203846004703877952990524473329125233083096275276064071930416561616135910190674099345267027039386328203653489152769309498199556401574021633071022874689081585677578010276529507102304828451681000682208089162940529052283763507244593173690786957816545746540436261888398732172965945762569416702401859253725696471593023885944262561159982327952</span><br></pre></td></tr></table></figure>

<h2 id="高位攻击"><a href="#高位攻击" class="headerlink" title="高位攻击"></a>高位攻击</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from secrets import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = getPrime(1024)</span><br><span class="line">n = p*q</span><br><span class="line">e = 65537</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m,e,n)</span><br><span class="line">print(&#x27;n =&#x27;, n)</span><br><span class="line">print(&#x27;c =&#x27;, c)</span><br><span class="line">print(&#x27;p0 =&#x27;, ((p&gt;&gt;128)&lt;&lt;128))</span><br><span class="line"># n = 12722276084782012506939748218137061976694333623308770803193278921311358642857520720238223717188895787376761058057320570031791633540549052360890626849683959794619430207976509336964838302913532815872846936103400538093765972176693960613553754981804951861018999147210521057815783304998144581807982126753283124281516688846477783545704858051397854514128591265938874177108889498151756070102637171159497913559176230984485047937009449456335164657258487948113487961895079102836099947427765851897399603733885367848305266219390271858890481731238036781050541110612526113637880146841891893392904381138771618976655066294938275191591</span><br><span class="line"># c = 7016802271682704586027412586496213357494728781654536670879262263911645812024904159932204545849316301445405237966933240237035426118442003499546014556123485534516682277683392394418823209992176414301314576069643211825678886511259850322068086838470004809816539278374905405029448429356654864943156018053547494263664714952593505357117355251742922245508277007069593675629222770814317602710615647062020095140444497647478051326857816298790397174877223117345612840890905447851689835046066164443064435495141117872095457539285213399905708851752673701650986197704683439495235659865937503527178246189185724246027890778434827868479</span><br><span class="line"># p0 = 121612618057439377491893234820394610861816815559052233952438700644930219565204914707604533201740057532331014637555250302342831261394993528125583478630623993361944114671033382653887624385660705353904988324932092635052885387222723368916634052933090217574600695084708857274271614116870074627080278200070403260416</span><br></pre></td></tr></table></figure>

<p><strong>p高位泄露，未知位是128bit</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">12722276084782012506939748218137061976694333623308770803193278921311358642857520720238223717188895787376761058057320570031791633540549052360890626849683959794619430207976509336964838302913532815872846936103400538093765972176693960613553754981804951861018999147210521057815783304998144581807982126753283124281516688846477783545704858051397854514128591265938874177108889498151756070102637171159497913559176230984485047937009449456335164657258487948113487961895079102836099947427765851897399603733885367848305266219390271858890481731238036781050541110612526113637880146841891893392904381138771618976655066294938275191591</span></span><br><span class="line">c = <span class="number">7016802271682704586027412586496213357494728781654536670879262263911645812024904159932204545849316301445405237966933240237035426118442003499546014556123485534516682277683392394418823209992176414301314576069643211825678886511259850322068086838470004809816539278374905405029448429356654864943156018053547494263664714952593505357117355251742922245508277007069593675629222770814317602710615647062020095140444497647478051326857816298790397174877223117345612840890905447851689835046066164443064435495141117872095457539285213399905708851752673701650986197704683439495235659865937503527178246189185724246027890778434827868479</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">high_p = <span class="number">121612618057439377491893234820394610861816815559052233952438700644930219565204914707604533201740057532331014637555250302342831261394993528125583478630623993361944114671033382653887624385660705353904988324932092635052885387222723368916634052933090217574600695084708857274271614116870074627080278200070403260416</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = high_p + x</span><br><span class="line">x = f.small_roots(X = <span class="number">2</span>^<span class="number">128</span>,beta = <span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> x:</span><br><span class="line">    p = high_p + <span class="built_in">int</span>(x[<span class="number">0</span>])</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;W0W_y0u_rea1ly_go0d_at_us3_s4g3!&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="在异或基础上夹杂移位"><a href="#在异或基础上夹杂移位" class="headerlink" title="在异或基础上夹杂移位"></a>在异或基础上夹杂移位</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from secret import flag</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = getPrime(1024), getPrime(1024)</span><br><span class="line">N = p * q</span><br><span class="line">p0 = p ^ (bytes_to_long(flag)&lt;&lt;444)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = pow(m, 65537, N)</span><br><span class="line">print(len(flag))</span><br><span class="line">print(&#x27;c=&#x27;,c)</span><br><span class="line">print(&#x27;N=&#x27;,N)</span><br><span class="line">print(&#x27;p0=&#x27;,p0)</span><br><span class="line"></span><br><span class="line"># 54</span><br><span class="line"># c= 6187845844052645335477666563187579997555293403110620879123121166924703361821847984760733842049752886698011561451715570810292323756091403783920480396052120046379755571530451812078574368413924390017994278703794257118954968480994077586245800902748815905644287545189605031883291488844527496906890127546594960138582150272568163575590734246290813150131949296550974206595456421136190026954855755623761557179760444906148376433584795779131477110538212742401420633087881506416368853221110426491868881029814841479615979710066371796507692025126150957315754738584387325388998533227577023142894876376702128870643448600352603905149</span><br><span class="line"># N= 14195810221536708489210274086946022255792382922322850338983263099316341767896809249586174293795778082892237356582757544364274847341220303582304283372889068290282580493623042441421715338444710303281638639785784613434328659529884972238348336971186339482788748316527376410510261228354155806341136524162787121212184386900663470590652770503564816948407257603737938414126069053610568675347826390537145556511048774030823322301932088595499671755944744816524811272617200683384649389274196659297432212847319503330409792704612575414010711158873031786577877685578976140462539734553598745329712188216200905451774357282278403189943</span><br><span class="line"># p0= 111984935426070810628244029907949697819351004665202173622240566580193974673163315128983603277856218378729883402496424467491406698035050254407170555432448523469880166015507303737468316933545613178461925283040643344197452758878116752692499745309765526523083790825015522124083482964296662782850606081657447935191</span><br></pre></td></tr></table></figure>

<p><strong>看到异或就想起LitCTF那道Babyxor，但这题不大一样，因为把m进行了左移操作</strong></p>
<p><strong>因为m左移444位，这样子m后面444位都是0，所以异或之后，不影响p低位444值</strong></p>
<p><strong>而且54长度的flag转成int型数据是432，左移444位后是876位，异或之后p高(1024-876)&#x3D;148位也是不变的</strong></p>
<p><strong>所以考点就是p部分高位和部分低位泄露</strong></p>
<p><strong>先取了444低位：<code>plow = p0 % 2^445</code></strong></p>
<p><strong>然后得到148高位：<code>phigh = (p0 &gt;&gt; 876) &lt;&lt; 876</code></strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p0 = 111984935426070810628244029907949697819351004665202173622240566580193974673163315128983603277856218378729883402496424467491406698035050254407170555432448523469880166015507303737468316933545613178461925283040643344197452758878116752692499745309765526523083790825015522124083482964296662782850606081657447935191</span><br><span class="line">c = 6187845844052645335477666563187579997555293403110620879123121166924703361821847984760733842049752886698011561451715570810292323756091403783920480396052120046379755571530451812078574368413924390017994278703794257118954968480994077586245800902748815905644287545189605031883291488844527496906890127546594960138582150272568163575590734246290813150131949296550974206595456421136190026954855755623761557179760444906148376433584795779131477110538212742401420633087881506416368853221110426491868881029814841479615979710066371796507692025126150957315754738584387325388998533227577023142894876376702128870643448600352603905149</span><br><span class="line">n = 14195810221536708489210274086946022255792382922322850338983263099316341767896809249586174293795778082892237356582757544364274847341220303582304283372889068290282580493623042441421715338444710303281638639785784613434328659529884972238348336971186339482788748316527376410510261228354155806341136524162787121212184386900663470590652770503564816948407257603737938414126069053610568675347826390537145556511048774030823322301932088595499671755944744816524811272617200683384649389274196659297432212847319503330409792704612575414010711158873031786577877685578976140462539734553598745329712188216200905451774357282278403189943</span><br><span class="line">e = 65537</span><br><span class="line"></span><br><span class="line">phigh = (p0&gt;&gt;876)&lt;&lt;876</span><br><span class="line">plow = p0 % 2**444</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">f = phigh + x*2**444 + plow</span><br><span class="line">f = f.monic()</span><br><span class="line">root = f.small_roots(X=2^432,beta=0.4)</span><br><span class="line">if root:</span><br><span class="line">    p = int(phigh + root[0]*2**444+plow)</span><br><span class="line">    print(&quot;p=&quot;,p)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-1)*(q-1))</span><br><span class="line">    m = pow(c,d,n)</span><br><span class="line">    print(long_to_bytes(int(m)))</span><br><span class="line">else:</span><br><span class="line">    print(0)</span><br></pre></td></tr></table></figure>

<h2 id="高位攻击结合加法"><a href="#高位攻击结合加法" class="headerlink" title="高位攻击结合加法"></a>高位攻击结合加法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">import random</span><br><span class="line">with open(&#x27;flag.txt&#x27;, &#x27;r&#x27;) as f:</span><br><span class="line">    flag = f.read().encode()</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_Prime(nbits):</span><br><span class="line">    cnt = random.randint(1, 50)</span><br><span class="line">    a = 678649776854118956235519899207445775941738710575390362283588104409625449204123832879</span><br><span class="line">    b = 782005138760169933127526591821947364276106050094468540051784488164681554419515591399</span><br><span class="line">    n = 959495185099860764003383321572335140174084694495020493292570101529012627928646710561</span><br><span class="line">    if nbits &gt; n.bit_length():</span><br><span class="line">        n = n &lt;&lt; (nbits - n.bit_length())</span><br><span class="line">    seed = m</span><br><span class="line"></span><br><span class="line">    while cnt != 0:</span><br><span class="line">        while not isPrime(seed % pow(2, nbits)):</span><br><span class="line">            seed = (a * seed + b) % n</span><br><span class="line">        cnt -= 1</span><br><span class="line"></span><br><span class="line">    return seed % pow(2, nbits)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(1024)</span><br><span class="line">q = get_Prime(1024)</span><br><span class="line">r = get_Prime(256)</span><br><span class="line"></span><br><span class="line">leak1 = p * q</span><br><span class="line">leak2 = p + r</span><br><span class="line">print(&#x27;leak1 =&#x27;, leak1)</span><br><span class="line">print(&quot;leak2 =&quot;, leak2)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">leak1 = 1726975620674482360213233806170947389541096108697994658733084655845389659114785301178576637466986314063371421235058595065888582231342820140568936192868977804603369486433318090941058139588565791324218134357184323086216185739954390473991279905043631888896016473122377727070109213645260572190927015695514811455255973089661406134295506499664743661249339253830939615669712520262820531049038976606781161641581457130675569478698323490748401496084828842168678572095280512663203781775164764035921218962082539851900388875197643683923415508978600441502826319004922595635629466742721341100368916333951643193549875170423774879551</span><br><span class="line">leak2 = 112318855182255283836167471766806168213410186797367822915324918687801558224308427598350852972681526722686984900181855405532137931103674353513321543274324576313279396633244245181304978516377298223713109442863413211695328144733089915971055510790022499917701465412122183985372344800810303472010586670294890532292</span><br><span class="line">&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

<p><strong>先从p,r入手，因为p(1024bit)的比特远大于r(256bit)的比特，即p的前768位(并不一定是这么多)并不受到r的影响，可用coppersmith恢复p</strong></p>
<p><strong>得到p后，看定义的函数，就是一个不知道多少次的lcg加密过程</strong></p>
<p><code> n = n &lt;&lt; (nbits - n.bit_length())</code><strong>这里保证了模数n足够大，因为再加密过程中，如果n不够大的话，会导致明文的数据丢失一些</strong></p>
<p><strong>再用q解密，需要注意的是用q解密的时候，这个n已经是移位过后的n</strong></p>
<p><strong>exp:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">a = 678649776854118956235519899207445775941738710575390362283588104409625449204123832879</span><br><span class="line">b = 782005138760169933127526591821947364276106050094468540051784488164681554419515591399</span><br><span class="line">n = 959495185099860764003383321572335140174084694495020493292570101529012627928646710561</span><br><span class="line">leak1 = 1726975620674482360213233806170947389541096108697994658733084655845389659114785301178576637466986314063371421235058595065888582231342820140568936192868977804603369486433318090941058139588565791324218134357184323086216185739954390473991279905043631888896016473122377727070109213645260572190927015695514811455255973089661406134295506499664743661249339253830939615669712520262820531049038976606781161641581457130675569478698323490748401496084828842168678572095280512663203781775164764035921218962082539851900388875197643683923415508978600441502826319004922595635629466742721341100368916333951643193549875170423774879551</span><br><span class="line">leak2 = 112318855182255283836167471766806168213410186797367822915324918687801558224308427598350852972681526722686984900181855405532137931103674353513321543274324576313279396633244245181304978516377298223713109442863413211695328144733089915971055510790022499917701465412122183985372344800810303472010586670294890532292</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(leak1))</span><br><span class="line"></span><br><span class="line">high = (leak2&gt;&gt;256)&lt;&lt;256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = high + x</span><br><span class="line">x = f.small_roots(X=2^256,beta=0.4)</span><br><span class="line">if x:</span><br><span class="line">    p = high + x[0]</span><br><span class="line">    print(p)</span><br><span class="line">    q = leak1 // int(p)</span><br><span class="line">    seed = q</span><br><span class="line">    n = n &lt;&lt; (1024 - 729)</span><br><span class="line">    while 1:</span><br><span class="line">        ani = gmpy2.invert(a,n)</span><br><span class="line">        seed = ani*(seed - b) % n</span><br><span class="line">        flag = long_to_bytes(seed)</span><br><span class="line">        if b&#x27;flag&#x27; in flag:</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>



<h1 id="二元copper"><a href="#二元copper" class="headerlink" title="二元copper"></a>二元copper</h1><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/11YEAGER11/p/17269139.html">二元coppersmith - 顶真珍珠 - 博客园 (cnblogs.com)</a></p>
<p>代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br></pre></td></tr></table></figure>

<p>其中m为移位（shifts），d 为多项式中的最高幂。</p>
<h2 id="CISCN-2021华南-small"><a href="#CISCN-2021华南-small" class="headerlink" title="[CISCN 2021华南]small"></a>[CISCN 2021华南]small</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import random, hashlib</span><br><span class="line">from Crypto.Util.number import getPrime</span><br><span class="line">from secret import x, y, flag</span><br><span class="line"></span><br><span class="line">BITS = 70</span><br><span class="line"></span><br><span class="line">assert(2**BITS &lt; x &lt; 2**(BITS+1))</span><br><span class="line">assert(2**BITS &lt; y &lt; 2**(BITS+1))</span><br><span class="line"></span><br><span class="line">m = str(x) + str(y)</span><br><span class="line">h = hashlib.sha256()</span><br><span class="line">h.update(m.encode())</span><br><span class="line">assert(flag == &quot;flag&#123;&quot; + h.hexdigest() + &quot;&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = getPrime(512)</span><br><span class="line">a = getPrime(510)</span><br><span class="line">b = getPrime(510)</span><br><span class="line">c = (1 + a * x * y ** 2 + b * x ** 2 * y) % p</span><br><span class="line">print(&quot;p = &quot; + str(p))</span><br><span class="line">print(&quot;a = &quot; + str(a))</span><br><span class="line">print(&quot;b = &quot; + str(b))</span><br><span class="line">print(&quot;c = &quot; + str(c))</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">p = </span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line">c = </span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>题目给出$x,y$都介于$2^{70}$和$2^{71}$之间</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">p = <span class="number">8813834626918693034209829623386418111935369643440896703895290043343199520112218432639643684400534953548489779045914955504743423765099014797611981422650409</span></span><br><span class="line">a = <span class="number">2817275225516767613658440250260394873529274896419346861054126128919212362519165468003171950475070788320195398302803745633617864408366174315471102773073469</span></span><br><span class="line">b = <span class="number">1763620527779958060718182646420541623477856799630691559360944374374235694750950917040727594731391703184965719358552775151767735359739899063298735788999711</span></span><br><span class="line">c = <span class="number">2298790980294663527827702586525963981886518365072523836572440106026473419042192180086308154346777239817235315513418426401278994450805667292449334757693881</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">R.&lt;x,y&gt;=PolynomialRing(Zmod(p))</span><br><span class="line"></span><br><span class="line">f = (<span class="number">1</span> + a * x * y ** <span class="number">2</span> + b * x ** <span class="number">2</span> * y) - c</span><br><span class="line"><span class="comment">#print(small_roots(f,bounds=(2^70,2^71)))</span></span><br><span class="line">x,y = small_roots(f,bounds=(<span class="number">2</span>^<span class="number">70</span>,<span class="number">2</span>^<span class="number">71</span>))[<span class="number">0</span>]</span><br><span class="line">m = <span class="built_in">str</span>(x) + <span class="built_in">str</span>(y)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;NSSCTF&#123;&quot;</span> + hashlib.sha256(m.encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>





<h1 id="P，Q产生方式由拼接而成"><a href="#P，Q产生方式由拼接而成" class="headerlink" title="P，Q产生方式由拼接而成"></a>P，Q产生方式由拼接而成</h1><p>这里只是做个记录</p>
<p>原文：<a target="_blank" rel="noopener" href="https://ctftime.org/writeup/29693">CTFtime.org &#x2F; Crypto CTF 2021 &#x2F; Hamul &#x2F; Writeup</a></p>
<h2 id="Hamul"><a href="#Hamul" class="headerlink" title="Hamul"></a>Hamul</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">nbit = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p, q = getPrime(nbit), getPrime(nbit)</span><br><span class="line">    P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(q))</span><br><span class="line">    Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(p))</span><br><span class="line">    PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">    QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">    <span class="keyword">if</span> isPrime(PP) <span class="keyword">and</span> isPrime(QQ):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = PP * QQ</span><br><span class="line">m = bytes_to_long(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> m &lt; n:</span><br><span class="line">    c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 98027132963374134222724984677805364225505454302688777506193468362969111927940238887522916586024601699661401871147674624868439577416387122924526713690754043</span></span><br><span class="line"><span class="comment"># c = 42066148309824022259115963832631631482979698275547113127526245628391950322648581438233116362337008919903556068981108710136599590349195987128718867420453399</span></span><br></pre></td></tr></table></figure>

<p>注意到，PP,QQ的产生方式：</p>
<p>令$x&#x3D;str(P),y&#x3D;str(Q)$，于是能把P,Q写成这样的形式：$P&#x3D;10^xp + q$，$Q&#x3D;10^yq+p$</p>
<p>再令$x’ &#x3D; str(PP),y’&#x3D;str(QQ)$，于是$PP &#x3D; 10^{x’}P+Q$，$Q&#x3D;10^{y’}Q+P$</p>
<p>$\because N &#x3D; PP×QQ$，这个N可以写成$10^{x+x’+y+y’}pq+…+pq$，每一项都含有pq。</p>
<p>因为$x+x’+y+y’$很大，所以存在$str(N)[:?]&#x3D;str(pq)[:?]$，$str(N)[?:]&#x3D;str(pq)[?:]$</p>
<p>测试发现$str(N)[:18]&#x3D;str(pq)[:18]$,$str(N)[-18:]&#x3D;str(pq)[-18:]$</p>
<p>也有出现前18位，后19位一样，前19位，后18位一样的情况</p>
<p>因为$len(str(pq))&#x3D;38或39$，可以爆破两位的方式求得pq</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_RSA</span>(<span class="params">c, e, p, q</span>):</span><br><span class="line">    phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line">low = <span class="built_in">str</span>(n)[-<span class="number">18</span>:]</span><br><span class="line">high = <span class="built_in">str</span>(n)[:<span class="number">18</span>]</span><br><span class="line">pq_prob = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i) + <span class="built_in">str</span>(j)+ low))</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">    f = factor(x)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">        p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(q))</span><br><span class="line">Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(p))</span><br><span class="line">PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">N = PP * QQ</span><br><span class="line"><span class="built_in">print</span>(N == n)</span><br><span class="line">decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br></pre></td></tr></table></figure>

<h2 id="HamburgerRSA"><a href="#HamburgerRSA" class="headerlink" title="HamburgerRSA"></a>HamburgerRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>).read()</span><br><span class="line">nbit = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p, q = getPrime(nbit), getPrime(nbit)</span><br><span class="line">    PP = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p) + <span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">    QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q) + <span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">    <span class="keyword">if</span> isPrime(PP) <span class="keyword">and</span> isPrime(QQ):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">n = PP * QQ</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">65537</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br></pre></td></tr></table></figure>

<p>类似上面那道题</p>
<p>不同的是爆破位数变成了1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_RSA</span>(<span class="params">c, e, p, q</span>):</span><br><span class="line">    phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br><span class="line">n = <span class="number">177269125756508652546242326065138402971542751112423326033880862868822164234452280738170245589798474033047460920552550018968571267978283756742722231922451193</span></span><br><span class="line">c = <span class="number">47718022601324543399078395957095083753201631332808949406927091589044837556469300807728484035581447960954603540348152501053100067139486887367207461593404096</span></span><br><span class="line"></span><br><span class="line">low = <span class="built_in">str</span>(n)[-<span class="number">18</span>:]</span><br><span class="line">high = <span class="built_in">str</span>(n)[:<span class="number">18</span>]</span><br><span class="line">pq_prob = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boom1</span>(<span class="params">low,high</span>):    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i)+ low))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">        f = factor(x)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">            p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">            Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">            PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">            QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">            N = PP * QQ</span><br><span class="line">            <span class="keyword">if</span> (N == n):</span><br><span class="line">                decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boom2</span>(<span class="params">low,high</span>):    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i)+ <span class="built_in">str</span>(j)+low))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">        f = factor(x)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">            p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">            Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">            PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">            QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">            N = PP * QQ</span><br><span class="line">            <span class="keyword">if</span> (N == n):</span><br><span class="line">                decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boom3</span>(<span class="params">low,high</span>):    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">                pq_prob.append(<span class="built_in">int</span>(high + <span class="built_in">str</span>(i) + <span class="built_in">str</span>(j) + <span class="built_in">str</span>(k)+ low))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tqdm(pq_prob):</span><br><span class="line">        f = factor(x)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">len</span>(f) == <span class="number">2</span> <span class="keyword">and</span> f[<span class="number">0</span>][<span class="number">0</span>].nbits() == <span class="number">64</span>):</span><br><span class="line">            p, q = f[<span class="number">0</span>][<span class="number">0</span>], f[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            P = <span class="built_in">int</span>(<span class="built_in">str</span>(p) + <span class="built_in">str</span>(p))</span><br><span class="line">            Q = <span class="built_in">int</span>(<span class="built_in">str</span>(q) + <span class="built_in">str</span>(q))</span><br><span class="line">            PP = <span class="built_in">int</span>(<span class="built_in">str</span>(P) + <span class="built_in">str</span>(Q))</span><br><span class="line">            QQ = <span class="built_in">int</span>(<span class="built_in">str</span>(Q) + <span class="built_in">str</span>(P))</span><br><span class="line">            N = PP * QQ</span><br><span class="line">            <span class="keyword">if</span> (N == n):</span><br><span class="line">                decrypt_RSA(c, <span class="number">65537</span>, PP, QQ)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">boom1(low,high)</span><br><span class="line">boom2(low,high)</span><br><span class="line">boom3(low,high)</span><br></pre></td></tr></table></figure>

<p>根据题目改点东西</p>
<h2 id="黑盾杯2020-Change"><a href="#黑盾杯2020-Change" class="headerlink" title="黑盾杯2020 Change"></a>黑盾杯2020 Change</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = <span class="built_in">int</span>(gmpy2.next_prime(random.randint(<span class="number">10</span>**<span class="number">399</span>, <span class="number">10</span>**<span class="number">400</span>-<span class="number">1</span>)))</span><br><span class="line">    q = <span class="built_in">int</span>(<span class="built_in">str</span>(p)[<span class="number">200</span>:]+<span class="built_in">str</span>(p)[:<span class="number">200</span>])</span><br><span class="line">    <span class="keyword">if</span> gmpy2.is_prime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(c))</span><br><span class="line">    f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="built_in">str</span>(n))</span><br></pre></td></tr></table></figure>

<p>记$p$的高位为$ph$，低位为$pl$，易知$ph$,$pl$都是$10^{200}$左右的数</p>
<p>则$p &#x3D; ph×10^{200}+pl$，$q &#x3D; pl×10^{200}+ph$</p>
<p>于是$n &#x3D; (ph×pl)×10^{400}+ph^2×10^{200}+pl^2×10^{200}+ph×pl$</p>
<p>因为$n$大概是$10^{800}$大小的数</p>
<p>记$ph×pl$的高位为$pph$，低位为$ppl$，都是$10^{200}$左右的数</p>
<p>$pph &#x3D; \frac{n}{10^{600}}$，$ppl &#x3D; n % 10^{200}$</p>
<p>求出$pph$和$ppl$后，即可求得$ph×pl$</p>
<p>再联立$n &#x3D; (ph×pl)×10^{400}+ph^2×10^{200}+pl^2×10^{200}+ph×pl$</p>
<p>求解$pl和ph$</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = </span><br><span class="line">n = </span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">pph = n // <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">600</span>)</span><br><span class="line">ppl = n % <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">200</span>)</span><br><span class="line">phpl = pph*<span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">200</span>) + ppl</span><br><span class="line"></span><br><span class="line">n -= <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">400</span>)*phpl + phpl</span><br><span class="line"></span><br><span class="line">tmp = <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">ph = symbols(<span class="string">&#x27;ph&#x27;</span>)</span><br><span class="line">pl = symbols(<span class="string">&#x27;pl&#x27;</span>)</span><br><span class="line">s = solve([ph*pl-phpl, tmp*ph*ph + tmp*pl*pl - n], [ph, pl])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    ph,pl = <span class="built_in">int</span>(i[<span class="number">0</span>]), <span class="built_in">int</span>(i[<span class="number">1</span>])</span><br><span class="line">    p = ph*tmp + pl</span><br><span class="line">    q = pl*tmp + ph</span><br><span class="line">    <span class="keyword">if</span> p &gt; <span class="number">0</span> <span class="keyword">and</span> q &gt; <span class="number">0</span> <span class="keyword">and</span> gmpy2.is_prime(p) <span class="keyword">and</span> gmpy2.is_prime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, p*q)))</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/" title="题目收集">https://dexterjie.github.io/2023/07/17/题目收集/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/07/14/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NKCTF/" rel="prev" title="NKCTF">
                  <i class="fa fa-chevron-left"></i> NKCTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/07/23/%E5%9D%97%E5%AF%86%E7%A0%81/AES/" rel="next" title="AES">
                  AES <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">189k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">11:28</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2023/07/17/%E9%A2%98%E7%9B%AE%E6%94%B6%E9%9B%86/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
