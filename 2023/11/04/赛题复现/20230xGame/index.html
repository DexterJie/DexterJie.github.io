<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/0.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/0.jpg">
  <link rel="mask-icon" href="/images/0.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"dexterjie.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.17.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="20230xGame——Crypto——Wp ！！！看看密码题的解答就好，其他方向是瞎做的">
<meta property="og:type" content="article">
<meta property="og:title" content="20230xGame">
<meta property="og:url" content="https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/index.html">
<meta property="og:site_name" content="DexterJie&#39;Blog">
<meta property="og:description" content="20230xGame——Crypto——Wp ！！！看看密码题的解答就好，其他方向是瞎做的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/3.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/0.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/1.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/2.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/4.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/7.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/5.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/6.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/10.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/11.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/16.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/17.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/8.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/9.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/12.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/13.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/14.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/15.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/18.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/19.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/20.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/22.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/23.png">
<meta property="og:image" content="https://dexterjie.github.io/images/20230xGame/21.png">
<meta property="article:published_time" content="2023-11-04T07:41:31.000Z">
<meta property="article:modified_time" content="2023-11-05T06:06:40.319Z">
<meta property="article:author" content="DexterJie">
<meta property="article:tag" content="Wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dexterjie.github.io/images/20230xGame/3.png">


<link rel="canonical" href="https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/","path":"2023/11/04/赛题复现/20230xGame/","title":"20230xGame"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>20230xGame | DexterJie'Blog</title>
  







<link rel="dns-prefetch" href="waline-five-mocha.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">DexterJie'Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Never Mind the Scandal and Liber!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=1456890009&auto=1&height=66"></iframe>
    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Week1"><span class="nav-number">1.</span> <span class="nav-text">Week1</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">1.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#BabyRSA"><span class="nav-number">1.1.1.</span> <span class="nav-text">BabyRSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Take-my-bag"><span class="nav-number">1.1.2.</span> <span class="nav-text">Take my bag!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%86%E7%A0%81%EF%BC%8C%E8%A7%85%E7%A0%81%EF%BC%8C%E5%85%88%E6%9C%89-%E5%86%8D%E5%AF%86"><span class="nav-number">1.1.3.</span> <span class="nav-text">密码，觅码，先有*再密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What%E2%80%99s-CBC"><span class="nav-number">1.1.4.</span> <span class="nav-text">What’s CBC?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8C%9C%E8%B0%9C"><span class="nav-number">1.1.5.</span> <span class="nav-text">猜谜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vigenere"><span class="nav-number">1.1.6.</span> <span class="nav-text">Vigenere</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-number">1.2.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E7%AD%91%E5%9F%BA"><span class="nav-number">1.2.1.</span> <span class="nav-text">数字筑基</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E9%87%91%E4%B8%B9"><span class="nav-number">1.2.2.</span> <span class="nav-text">代码金丹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%85%83%E5%A9%B4"><span class="nav-number">1.2.3.</span> <span class="nav-text">网络元婴</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E5%8C%96%E7%A5%9E"><span class="nav-number">1.2.4.</span> <span class="nav-text">虚拟化神</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%9B%E5%8D%9A%E5%A4%A9%E5%B0%8A"><span class="nav-number">1.2.5.</span> <span class="nav-text">赛博天尊</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week2"><span class="nav-number">2.</span> <span class="nav-text">Week2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-1"><span class="nav-number">2.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#What%E2%80%99s-CRT"><span class="nav-number">2.1.1.</span> <span class="nav-text">What’s CRT?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E7%9A%84%E9%82%A3%E4%B8%AA%E4%BA%BA"><span class="nav-number">2.1.2.</span> <span class="nav-text">中间的那个人</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fault-Fault"><span class="nav-number">2.1.3.</span> <span class="nav-text">Fault!Fault!</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EzLFSR"><span class="nav-number">2.1.4.</span> <span class="nav-text">EzLFSR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EzRSA"><span class="nav-number">2.1.5.</span> <span class="nav-text">EzRSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#challenge1"><span class="nav-number">2.1.5.1.</span> <span class="nav-text">challenge1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#challenge2"><span class="nav-number">2.1.5.2.</span> <span class="nav-text">challenge2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#challenge3"><span class="nav-number">2.1.5.3.</span> <span class="nav-text">challenge3</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re"><span class="nav-number">2.2.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%A6%E6%96%87%E8%A7%A3%E5%AF%86%E5%B8%88"><span class="nav-number">2.2.1.</span> <span class="nav-text">符文解密师</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E9%80%86%E6%97%85%E8%80%85"><span class="nav-number">2.2.2.</span> <span class="nav-text">编码逆旅者</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A0%81%E6%B5%B7%E8%88%B5%E5%B8%88"><span class="nav-number">2.2.3.</span> <span class="nav-text">码海舵师</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E4%BE%A6%E6%8E%A2%E2%80%94%E2%80%94%E5%A4%8D%E7%8E%B0"><span class="nav-number">2.2.4.</span> <span class="nav-text">注册侦探——复现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn"><span class="nav-number">2.3.</span> <span class="nav-text">pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cal"><span class="nav-number">2.3.1.</span> <span class="nav-text">cal</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week3"><span class="nav-number">3.</span> <span class="nav-text">Week3</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-2"><span class="nav-number">3.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EzECC"><span class="nav-number">3.1.1.</span> <span class="nav-text">EzECC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LLL-FirstBlood"><span class="nav-number">3.1.2.</span> <span class="nav-text">LLL-FirstBlood</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LLL-SecondBlood"><span class="nav-number">3.1.3.</span> <span class="nav-text">LLL-SecondBlood</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EzMartix"><span class="nav-number">3.1.4.</span> <span class="nav-text">EzMartix</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EzOverflow"><span class="nav-number">3.1.5.</span> <span class="nav-text">EzOverflow</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re-1"><span class="nav-number">3.2.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%90%AF%E7%A4%BA%E5%BD%95"><span class="nav-number">3.2.1.</span> <span class="nav-text">代码启示录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%8B%E8%BD%AC%E5%AF%86%E7%A0%81%E5%9F%8E"><span class="nav-number">3.2.2.</span> <span class="nav-text">旋转密码城</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%AD%97%E5%B9%BD%E7%81%B5%E5%9F%8E"><span class="nav-number">3.2.3.</span> <span class="nav-text">数字幽灵城</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E8%BF%B7%E5%9F%8E"><span class="nav-number">3.2.4.</span> <span class="nav-text">变量迷城</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%9E%84%E6%A0%B8%E5%BF%83"><span class="nav-number">3.2.5.</span> <span class="nav-text">虚构核心</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Week4"><span class="nav-number">4.</span> <span class="nav-text">Week4</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-3"><span class="nav-number">4.1.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LLL-Third-Blood"><span class="nav-number">4.1.1.</span> <span class="nav-text">LLL-Third Blood</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Danger-Leak"><span class="nav-number">4.1.2.</span> <span class="nav-text">Danger Leak</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Normal-ECC"><span class="nav-number">4.1.3.</span> <span class="nav-text">Normal ECC</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Re-2"><span class="nav-number">4.2.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%979-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AD%A6%E5%BE%92"><span class="nav-number">4.2.1.</span> <span class="nav-text">序列9-二进制学徒</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%978-%E4%BB%A3%E7%A0%81%E6%82%9F%E9%81%93%E8%80%85"><span class="nav-number">4.2.2.</span> <span class="nav-text">序列8-代码悟道者</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="DexterJie"
      src="/images/0.jpg">
  <p class="site-author-name" itemprop="name">DexterJie</p>
  <div class="site-description" itemprop="description">一枚只会Crypto的菜鸡</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">75</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/0.jpg">
      <meta itemprop="name" content="DexterJie">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="DexterJie'Blog">
      <meta itemprop="description" content="一枚只会Crypto的菜鸡">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="20230xGame | DexterJie'Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          20230xGame
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-11-04 15:41:31" itemprop="dateCreated datePublished" datetime="2023-11-04T15:41:31+08:00">2023-11-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-11-05 14:06:40" itemprop="dateModified" datetime="2023-11-05T14:06:40+08:00">2023-11-05</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.3k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>34 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>20230xGame——Crypto——Wp</p>
<p>！！！看看密码题的解答就好，其他方向是瞎做的</p>
<span id="more"></span>

<h1 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h1><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="BabyRSA"><a href="#BabyRSA" class="headerlink" title="BabyRSA"></a>BabyRSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getN</span>():</span><br><span class="line">	N = <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">		tmp = getPrime(<span class="number">32</span>)</span><br><span class="line">		N *= tmp</span><br><span class="line">	<span class="keyword">return</span> N</span><br><span class="line"></span><br><span class="line">mask = getrandbits(<span class="number">256</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = getN()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m*mask,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mask = <span class="subst">&#123;mask&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 93099494899964317992000886585964221136368777219322402558083737546844067074234332564205970300159140111778084916162471993849233358306940868232157447540597</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 54352122428332145724828674757308827564883974087400720449151348825082737474080849774814293027988784740602148317713402758353653028988960687525211635107801</span></span><br><span class="line"><span class="string">mask = 54257528450885974256117108479579183871895740052660152544049844968621224899247</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>主要利用sagemath的factor函数，然后最后记得除<code>mask</code></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">93099494899964317992000886585964221136368777219322402558083737546844067074234332564205970300159140111778084916162471993849233358306940868232157447540597</span></span><br><span class="line">c = <span class="number">54352122428332145724828674757308827564883974087400720449151348825082737474080849774814293027988784740602148317713402758353653028988960687525211635107801</span></span><br><span class="line">mask = <span class="number">54257528450885974256117108479579183871895740052660152544049844968621224899247</span></span><br><span class="line"></span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> factor(n):</span><br><span class="line">    phi *= i[<span class="number">0</span>] - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">d = gmpy2.invert(<span class="number">65537</span>,phi)</span><br><span class="line">m1 = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="comment">#m = m1 // mask</span></span><br><span class="line">m = <span class="number">334526535497992378634036751902245187892235112866317344720327978830278781</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#0xGame&#123;Magic_M@th_Make_Crypt0&#125;</span></span><br></pre></td></tr></table></figure>

<p>有个店很怪，不能直接把<code>m // mask</code>，我的解决方法是把m打印出来，用数值进行相除</p>
<p>最后<code>m =334526535497992378634036751902245187892235112866317344720327978830278781 </code></p>
<h3 id="Take-my-bag"><a href="#Take-my-bag" class="headerlink" title="Take my bag!"></a>Take my bag!</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">	m = <span class="built_in">str</span>(<span class="built_in">bin</span>(m))[<span class="number">2</span>:][::-<span class="number">1</span>]</span><br><span class="line">	enc = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m)):</span><br><span class="line">		enc += init[i] * <span class="built_in">int</span>(m[i]) % n</span><br><span class="line">	<span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line">w = getPrime(<span class="number">64</span>)</span><br><span class="line">n = getPrime(<span class="number">512</span>)</span><br><span class="line">init = [w*<span class="built_in">pow</span>(<span class="number">3</span>, i) % n <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)]</span><br><span class="line"></span><br><span class="line">c = encrypt(bytes_to_long(flag))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;w=<span class="subst">&#123;w&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n=<span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">w=16221818045491479713</span></span><br><span class="line"><span class="string">n=9702074289348763131102174377899883904548584105641045150269763589431293826913348632496775173099776917930517270317586740686008539085898910110442820776001061</span></span><br><span class="line"><span class="string">c=4795969289572314590787467990865205548430190921556722879891721107719262822789483863742356553249935437004378475661668768893462652103739250038700528111</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>w</code>已经给出，说明<code>init</code>已知</p>
<p>有$enc \equiv Init_1 \times m_1 + Init_2 \times m_2 + … + Init_n \times m_n \mod n$</p>
<p>构造格</p>
<p><img src="/../../images/20230xGame/3.png"></p>
<p>最后记得逆序</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">w = </span><br><span class="line">mod = </span><br><span class="line">pubkey = [w*<span class="built_in">pow</span>(<span class="number">3</span>, i) % mod <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">512</span>)]</span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(pubkey)</span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Ge[i,i] = <span class="number">1</span></span><br><span class="line">    Ge[i,-<span class="number">1</span>] = pubkey[i]</span><br><span class="line"></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">1</span>] = c</span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = mod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        tmp = i[:-<span class="number">2</span>]</span><br><span class="line">        ans = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> tmp:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(j) == <span class="number">0</span>:</span><br><span class="line">                ans += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(j) == <span class="number">1</span>:</span><br><span class="line">                ans += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        </span><br><span class="line">        e = <span class="built_in">int</span>(ans[::-<span class="number">1</span>],<span class="number">2</span>)</span><br><span class="line">        flag = long_to_bytes(e)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;0xGame&quot;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="comment">#0xGame&#123;Welc0me_2_Crypt0_G@me!#$&amp;%&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="密码，觅码，先有-再密"><a href="#密码，觅码，先有-再密" class="headerlink" title="密码，觅码，先有*再密"></a>密码，觅码，先有*再密</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag <span class="comment">#从中导入秘密的flag，这是我们要破解的信息</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long <span class="comment">#从函数库导入一些编码函数</span></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">flag = flag.encode()</span><br><span class="line">lent = <span class="built_in">len</span>(flag)</span><br><span class="line">flag = [flag[i*(lent//<span class="number">4</span>):(i+<span class="number">1</span>)*(lent//<span class="number">4</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">c1 = bytes_to_long(flag[<span class="number">0</span>])</span><br><span class="line">c2 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(<span class="built_in">bin</span>(i))[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> flag[<span class="number">1</span>]])</span><br><span class="line">c3 = b64encode(flag[<span class="number">2</span>])</span><br><span class="line">c4 = flag[<span class="number">3</span>].<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1?= <span class="subst">&#123;<span class="built_in">pow</span>(c1,<span class="number">5</span>)&#125;</span>\nc2 = <span class="subst">&#123;c2&#125;</span>\nc3 = <span class="subst">&#123;c3&#125;</span>\nc4 = <span class="subst">&#123;c4&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1?= 2607076237872456265701394408859286660368327415582106508683648834772020887801353062171214554351749058553609022833985773083200356284531601339221590756213276590896143894954053902973407638214851164171968630602313844022016135428560081844499356672695981757804756591891049233334352061975924028218309004551</span></span><br><span class="line"><span class="string">c2 = 10010000100001101110100010100111101000111110010010111010100001101110010010111111101000011110011010000001101011111110011010011000101011111110010110100110100000101110010010111101100101011110011110111100</span></span><br><span class="line"><span class="string">c3 = b&#x27;lueggeeahO+8jOmCo+S5iOW8gOWni+aIkQ==&#x27;</span></span><br><span class="line"><span class="string">c4 = e4bbace79a8443727970746fe68c91e68898e590a72121217d</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#全是乱码，那咋办嘛？</span></span><br></pre></td></tr></table></figure>

<p>根据加密写解回去就行</p>
<p>最后会得到</p>
<p><code>0xGame&#123; \xe6\x81\xad\xe5\x96\x9c\xe4\xbd\xa0,\xe5\xb7\xb2\xe7\xbb\x8f\xe7\x90\x86\xe8\xa7\xa3\xe4\xba\x86\xe4\xbf\xa1\xe6\x81\xaf\xe6\x98\xaf\xe5\xa6\x82\xe4\xbd\x95\xe7\xbc\x96\xe7\xa0\x81\xe7\x9a\x84\xef\xbc\x8c\xe9\x82\xa3\xe4\xb9\x88\xe5\xbc\x80\xe5\xa7\x8b\xe6\x88\x91\xe4\xbb\xac\xe7\x9a\x84Crypto\xe6\x8c\x91\xe6\x88\x98\xe5\x90\xa7!!!&#125;</code></p>
<p>加上一步<code>decode()</code>即可（一直以为flag是英文字母加数字，忘记了flag的内容可能是中文，中文进行<code>encode()</code>就会出现乱码），题目并不难，容易把他想难了。</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c15 = <span class="number">2607076237872456265701394408859286660368327415582106508683648834772020887801353062171214554351749058553609022833985773083200356284531601339221590756213276590896143894954053902973407638214851164171968630602313844022016135428560081844499356672695981757804756591891049233334352061975924028218309004551</span></span><br><span class="line">m1 = gmpy2.iroot(c15,<span class="number">5</span>)</span><br><span class="line">c2 = <span class="string">&quot;10010000100001101110100010100111101000111110010010111010100001101110010010111111101000011110011010000001101011111110011010011000101011111110010110100110100000101110010010111101100101011110011110111100&quot;</span></span><br><span class="line">m2 = <span class="built_in">int</span>(c2,<span class="number">2</span>)</span><br><span class="line">c3 = <span class="string">b&#x27;lueggeeahO+8jOmCo+S5iOW8gOWni+aIkQ==&#x27;</span></span><br><span class="line">m3 = b64decode(c3)</span><br><span class="line">c4 = <span class="string">&quot;e4bbace79a8443727970746fe68c91e68898e590a72121217d&quot;</span></span><br><span class="line">m4 = <span class="built_in">bytes</span>.fromhex(c4)</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(m1[<span class="number">0</span>]) + long_to_bytes(m2) + m3 + m4</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="comment">#0xGame&#123; 恭喜你,已经理解了信息是如何编码的，那么开始我们的Crypto挑战吧!!!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="What’s-CBC"><a href="#What’s-CBC" class="headerlink" title="What’s CBC?"></a>What’s CBC?</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_xor</span>(<span class="params">a,b</span>):</span><br><span class="line">	a,b=bytes_to_long(a),bytes_to_long(b)</span><br><span class="line">	<span class="keyword">return</span> long_to_bytes(a^b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">text</span>):</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(text)%<span class="number">8</span>:</span><br><span class="line">		<span class="keyword">return</span> text</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		pad = <span class="number">8</span>-(<span class="built_in">len</span>(text)%<span class="number">8</span>)</span><br><span class="line">		text += pad.to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)*pad</span><br><span class="line">		<span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Encrypt_CBC</span>(<span class="params">text,iv,key</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	text = pad(text)</span><br><span class="line">	block=[text[_*<span class="number">8</span>:(_+<span class="number">1</span>)*<span class="number">8</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text)//<span class="number">8</span>)]</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> block:</span><br><span class="line">		tmp = bytes_xor(iv,i)</span><br><span class="line">		iv = encrypt(tmp,key)</span><br><span class="line">		result += iv</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text,key</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">		result += ((i^key)).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&#x27;11111111&#x27;</span></span><br><span class="line">enc = (Encrypt_CBC(flag,iv,key))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc = <span class="subst">&#123;enc&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#enc = b&quot;\x8e\xc6\xf9\xdf\xd3\xdb\xc5\x8e8q\x10f&gt;7.5\x81\xcc\xae\x8d\x82\x8f\x92\xd9o&#x27;D6h8.d\xd6\x9a\xfc\xdb\xd3\xd1\x97\x96Q\x1d&#123;\\TV\x10\x11&quot;</span></span><br></pre></td></tr></table></figure>

<p>已知flag前7位是<code>0xGame&#123;</code>，爆破1位求得tmp，再与密文前8位异或得到<code>key = 143</code>（可以加以检验）</p>
<p>得到<code>key</code>以后根据CBC的特点，用后一段密文和前一段密文异或即可得到明文</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_xor</span>(<span class="params">a,b</span>):</span><br><span class="line">	a,b=bytes_to_long(a),bytes_to_long(b)</span><br><span class="line">	<span class="keyword">return</span> long_to_bytes(a^b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">text,key</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">		result += ((i^key)).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&#x27;11111111&#x27;</span></span><br><span class="line">c = <span class="string">b&quot;\x8e\xc6\xf9\xdf\xd3\xdb\xc5\x8e8q\x10f&gt;7.5\x81\xcc\xae\x8d\x82\x8f\x92\xd9o&#x27;D6h8.d\xd6\x9a\xfc\xdb\xd3\xd1\x97\x96Q\x1d&#123;\\TV\x10\x11&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># for i in range(256):</span></span><br><span class="line"><span class="comment">#     m = b&quot;0xGame&#123;&quot; + long_to_bytes(i)</span></span><br><span class="line"><span class="comment">#     tmp = bytes_xor(iv,m)</span></span><br><span class="line"><span class="comment">#     key = tmp[0] ^ c[0]</span></span><br><span class="line"><span class="comment">#     cc = encrypt(tmp,key)</span></span><br><span class="line"><span class="comment">#     if cc == c[:8]:</span></span><br><span class="line"><span class="comment">#         print(m)		#0xGame&#123;0</span></span><br><span class="line"><span class="comment">#         print(key)	#143</span></span><br><span class="line"></span><br><span class="line">key = <span class="number">143</span></span><br><span class="line"></span><br><span class="line">block=[c[_*<span class="number">8</span>:(_+<span class="number">1</span>)*<span class="number">8</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">8</span>)]</span><br><span class="line">block = block[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(block)-<span class="number">1</span>):    </span><br><span class="line">    tmp = encrypt(block[i],key)</span><br><span class="line">    mm = bytes_xor(tmp,block[i+<span class="number">1</span>])</span><br><span class="line">    m.append(mm)</span><br><span class="line">    </span><br><span class="line">m = m[::-<span class="number">1</span>]</span><br><span class="line">flag = <span class="string">b&quot;0xGame&#123;0&quot;</span> + <span class="string">b&quot;&quot;</span>.join(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;098f6bcd4621d373cade4e832627b4f6&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="猜谜"><a href="#猜谜" class="headerlink" title="猜谜"></a>猜谜</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">text</span>):</span><br><span class="line">	code = <span class="string">&#x27;AP3IXYxn4DmwqOlT0Q/JbKFecN8isvE6gWrto+yf7M5d2pjBuk1Hh9aCRZGUVzLS&#x27;</span></span><br><span class="line">	text = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">str</span>(<span class="built_in">bin</span>(i))[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> text])</span><br><span class="line">	length = <span class="built_in">len</span>(text)</span><br><span class="line">	pad = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">if</span> length%<span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">		text += <span class="string">&#x27;00&#x27;</span></span><br><span class="line">		pad = <span class="string">b&#x27;==&#x27;</span></span><br><span class="line">	<span class="keyword">elif</span> length%<span class="number">3</span> == <span class="number">2</span>:</span><br><span class="line">		text += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">		pad = <span class="string">b&#x27;=&#x27;</span></span><br><span class="line">	result = [code[<span class="built_in">int</span>(text[<span class="number">3</span>*i:<span class="number">3</span>*(i+<span class="number">1</span>)],<span class="number">2</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(text)//<span class="number">3</span>)]</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result).encode()+pad</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">flag</span>):</span><br><span class="line">	result = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">		result += (key[i%<span class="number">7</span>]^(flag[i]+i)).to_bytes(<span class="number">1</span>,<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = enc(encrypt(flag))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = b&#x27;IPxYIYPYXPAn3nXX3IXA3YIAPn3xAYnYnPIIPAYYIA3nxxInXAYnIPAIxnXYYYIXIIPAXn3XYXIYAA3AXnx=&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>仔细阅读代码，注意一些细节</strong></p>
<p>先通过<code>c</code>恢复出<code>encrypt(flag)</code>，再通过部分<code>encrypt(flag)</code>和已知明文<code>0xGame&#123;</code>求得<code>key</code></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="string">&#x27;IPxYIYPYXPAn3nXX3IXA3YIAPn3xAYnYnPIIPAYYIA3nxxInXAYnIPAIxnXYYYIXIIPAXn3XYXIYAA3AXnx&#x27;</span></span><br><span class="line">code = <span class="string">&#x27;AP3IXYxn4DmwqOlT0Q/JbKFecN8isvE6gWrto+yf7M5d2pjBuk1Hh9aCRZGUVzLS&#x27;</span></span><br><span class="line"></span><br><span class="line">enc = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    enc.append(<span class="built_in">bin</span>(code.index(i))[<span class="number">2</span>:].zfill(<span class="number">3</span>))</span><br><span class="line">    </span><br><span class="line">text = <span class="string">&#x27;&#x27;</span>.join(enc)</span><br><span class="line"></span><br><span class="line">block = [text[<span class="number">8</span>*i:<span class="number">8</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(text) // <span class="number">8</span>)]</span><br><span class="line"><span class="built_in">print</span>(block)</span><br><span class="line"></span><br><span class="line">m = <span class="string">b&quot;0xGame&#123;&quot;</span></span><br><span class="line">key = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    kk = <span class="built_in">int</span>(block[i],<span class="number">2</span>) ^ (m[i] + i)</span><br><span class="line">    key.append(kk)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line">flag  = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(block)):</span><br><span class="line">    mm = (key[i%<span class="number">7</span>] ^ (<span class="built_in">int</span>(block[i],<span class="number">2</span>))) - i</span><br><span class="line">    flag += <span class="built_in">chr</span>(mm)</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;Kn0wn_pl@intext_Att@ck!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Vigenere"><a href="#Vigenere" class="headerlink" title="Vigenere"></a>Vigenere</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：0dGmqk&#123;79ap4i0522g0a67m6i196he52357q60f&#125; 古老而神秘的加密方式？</span><br></pre></td></tr></table></figure>

<p>根据<code>0xGame</code>对应<code>0dGmqk</code>，获得<code>key=GAMEG</code>，解密后发现不对，于是猜<code>key=GAMEGAME</code></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="数字筑基"><a href="#数字筑基" class="headerlink" title="数字筑基"></a>数字筑基</h3><p>丢到ida，<code>shift+F12</code>，得到flag:<code>0xGame&#123;5f4812eb-6dee-46ab-9910-92af643cd911&#125;</code></p>
<h3 id="代码金丹"><a href="#代码金丹" class="headerlink" title="代码金丹"></a>代码金丹</h3><p>同上，<code>0xGame&#123;620bbfcb-e56f-4e6d-8069-9587e066130a&#125;</code></p>
<h3 id="网络元婴"><a href="#网络元婴" class="headerlink" title="网络元婴"></a>网络元婴</h3><p>打开ida，发现很多数字，而且数值基本都在ASCII码表中，所以直接转ASCII拼接即可</p>
<p><img src="/../../images/20230xGame/0.png"></p>
<p>解释一下<code>v3 = 0i64;</code>的作用：将变量 <code>v3 </code>设置为一个 64 位整数类型的复数，值为 0。</p>
<p>程序根本看不懂</p>
<h3 id="虚拟化神"><a href="#虚拟化神" class="headerlink" title="虚拟化神"></a>虚拟化神</h3><p><img src="/../../images/20230xGame/1.png"></p>
<p>55行打个断点进行动调</p>
<p><img src="/../../images/20230xGame/2.png"></p>
<p>发现v11里就是flag</p>
<h3 id="赛博天尊"><a href="#赛博天尊" class="headerlink" title="赛博天尊"></a>赛博天尊</h3><p><img src="/../../images/20230xGame/4.png"></p>
<p>用z3解这个方程组，然后转16进制拼接</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">v7,v8,v9,v10,v11=BitVec(<span class="string">&#x27;v7&#x27;</span>,<span class="number">64</span>),BitVec(<span class="string">&#x27;v8&#x27;</span>,<span class="number">64</span>),BitVec(<span class="string">&#x27;v9&#x27;</span>,<span class="number">64</span>),BitVec(<span class="string">&#x27;v10&#x27;</span>,<span class="number">64</span>),BitVec(<span class="string">&#x27;v11&#x27;</span>,<span class="number">64</span>)</span><br><span class="line">ans = Solver()</span><br><span class="line">ans.add(<span class="number">7</span> * v9 + <span class="number">5</span> * (v8 + v11) + <span class="number">2</span> * (v10 + <span class="number">4</span> * v7) == <span class="number">0x12021DE669FC2</span>)</span><br><span class="line">v4 = v9 + v10 + <span class="number">2</span> * v10 + <span class="number">2</span> * (v11 + v7)</span><br><span class="line">ans.add(v10 + v9 + v11 + <span class="number">2</span> * v9 + <span class="number">2</span> * (v9 + v11 + <span class="number">2</span> * v9) + <span class="number">2</span> * (v8 + <span class="number">4</span> * v7) == <span class="number">0xACE320D1250</span>)</span><br><span class="line">ans.add(v8 + <span class="number">2</span> * (v7 + v11 + v9 + <span class="number">2</span> * v10) == <span class="number">0x733FFEB3A4FA</span>)</span><br><span class="line">ans.add(v8 + <span class="number">7</span> * v11 + <span class="number">8</span> * (v9 + v10) + <span class="number">5</span> * v7 == <span class="number">0x1935EBA54EB28</span>)</span><br><span class="line">ans.add(v8 + <span class="number">2</span> * v4 + v4 == <span class="number">0x159BFFC17D045</span>)</span><br><span class="line"><span class="keyword">if</span> ans.check()==sat:</span><br><span class="line">    data=ans.model()</span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    </span><br><span class="line">v8 = <span class="number">14810</span></span><br><span class="line">v11 = <span class="number">63356652901730</span></span><br><span class="line">v9 = <span class="number">16488</span></span><br><span class="line">v7 = <span class="number">2693650760</span></span><br><span class="line">v10 = <span class="number">41791</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;0xGame&#123;&#x27;</span>+<span class="built_in">hex</span>(v7)[<span class="number">2</span>:]+<span class="string">&#x27;-&#x27;</span>+<span class="built_in">hex</span>(v8)[<span class="number">2</span>:]+<span class="string">&#x27;-&#x27;</span>+<span class="built_in">hex</span>(v9)[<span class="number">2</span>:]+<span class="string">&#x27;-&#x27;</span>+<span class="built_in">hex</span>(v10)[<span class="number">2</span>:]+<span class="string">&#x27;-&#x27;</span>+<span class="built_in">hex</span>(v11)[<span class="number">2</span>:]+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment">#0xGame&#123;a08dd948-39da-4068-a33f-399f5eca5562&#125;</span></span><br></pre></td></tr></table></figure>

<p>因为v7,v8,v9,v10,v11是64bit的，所以用<code>BitVec(&#39;v7&#39;,64)</code></p>
<h1 id="Week2"><a href="#Week2" class="headerlink" title="Week2"></a>Week2</h1><h2 id="Crypto-1"><a href="#Crypto-1" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="What’s-CRT"><a href="#What’s-CRT" class="headerlink" title="What’s CRT?"></a>What’s CRT?</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secert <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">260792700</span></span><br><span class="line">q,p,q_,p_ = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">gift = [q+p,q_+p_]</span><br><span class="line">n,n_ = q*p,q_*p_</span><br><span class="line">mq_ = <span class="built_in">pow</span>(m,<span class="number">4</span>,q_)</span><br><span class="line">mp_ = <span class="built_in">pow</span>(m,<span class="number">4</span>,p_)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;mygift=<span class="subst">&#123;gift&#125;</span>\nmq_=<span class="subst">&#123;mq_&#125;</span>\nmp_=<span class="subst">&#123;mp_&#125;</span>\nn=<span class="subst">&#123;n&#125;</span>\nn_=<span class="subst">&#123;n_&#125;</span>\nc=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mygift=[15925416640901708561793293991573474917595642805739825596593339102414328214313430010166125066639132916608736569443045051644173933089503934675628814467277922, 18342424676996843423829480445042578097182127446865571536445030052846412665700132683433441858073625594933132038175200824257774638419166516796318527302903098]</span></span><br><span class="line"><span class="string">mq_=6229615098788722664392369146712291169948485951371133086154028832805750551655072946170332335458186479565263371985534601035559229403357396564568667218817197</span></span><br><span class="line"><span class="string">mp_=7514598449361191486799480225087938913945061715845128006069296876457814528347371315493644046029376830166983645570092100320566196227210502897068206073043718</span></span><br><span class="line"><span class="string">n=63329068473206068067147844002844348796575899624395867391964805451897110448983910133293450006821779608031734813916287079551030950968978400757306879502402868643716591624454744334316879241573399993026873598478532467624301968439714860262264449471888606538913071413634346381428901358109273203087030763779091664797</span></span><br><span class="line"><span class="string">n_=84078907800136966150486965612788894868587998005459927216462899940718213455112139441858657865215211843183780436155474431592540465189966648565764225210091190218976417210291521208716206733270743675534820816685370480170120230334766919110311980614082807421812749491464201740954627794429460268010183163151688591417</span></span><br><span class="line"><span class="string">c=12623780002384219022772693100787925315981488689172490837413686188416255911213044332780064192900824150269364486747430892667624289724721692959334462348218416297309304391635919115701692314532111050955120844126517392040880404049818026059951326039894605004852370344012563287210613795011783419126458214779488303552</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>通过两组$p+q &#x3D; gift$和$p \times q &#x3D; n$，解方程把p,q求出</p>
<p>这样有4组等式</p>
<p>$m_p \equiv m^e \mod p$</p>
<p>$m_p \equiv m^e \mod p$</p>
<p>$m_{p’} \equiv m^e \mod p’$</p>
<p>$m_{q’} \equiv m^e \mod q’$</p>
<p>解中国剩余定理就行</p>
<p>在求解过程会发现<code>e = 260792700</code> 和<code>p-1</code>以及<code>q-1</code>分别存在公因数4</p>
<p>处理一下$\because c \equiv m^e \mod n$,$ed \equiv 1 \mod \phi(n)$</p>
<p>因为$e$和$\phi(n)$存在公因数，设为$t$，把$e$除去$t$，即$e’ &#x3D; \frac{t}{e}$，所以上式可化为$c \equiv (m^t)^{e’} \mod n$，这样$e’$和$\phi(n)$就可以求逆元了</p>
<p>对于上式，我们就可以得到$c \equiv (m^4)^{e’} \mod p$，模$q$同理</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"></span><br><span class="line">p = <span class="number">8237763448327424871950828228273863325587732991938648753016149761004918521337676972763871570006722552014080958105888713975090350689060892327170546305946879</span></span><br><span class="line">q = <span class="number">7687653192574283689842465763299611592007909813801176843577189341409409692975753037402253496632410364594655611337156337669083582400443042348458268161331043</span></span><br><span class="line">c = <span class="number">12623780002384219022772693100787925315981488689172490837413686188416255911213044332780064192900824150269364486747430892667624289724721692959334462348218416297309304391635919115701692314532111050955120844126517392040880404049818026059951326039894605004852370344012563287210613795011783419126458214779488303552</span></span><br><span class="line">e = <span class="number">260792700</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,e,phi,n</span>):</span><br><span class="line">    t = gmpy2.gcd(e,phi)</span><br><span class="line">    <span class="keyword">if</span> t != <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(t)</span><br><span class="line">        e1 = e // t</span><br><span class="line">        d = gmpy2.invert(e1,phi)</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        d = gmpy2.invert(e,phi)</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">        <span class="keyword">return</span> m</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">mp = decrypt(c,e//<span class="number">4</span>,p-<span class="number">1</span>,p)</span><br><span class="line">mq = decrypt(c,e//<span class="number">4</span>,q-<span class="number">1</span>,q)</span><br><span class="line"></span><br><span class="line">p_ = <span class="number">8991690869897246321907509983425307437365288417861457732721314572165773880898701105065818281248373676758405021157703190132511219384704650086565345885727777</span></span><br><span class="line">q_ = <span class="number">9350733807099597101921970461617270659816839029004113803723715480680638784801431578367623576825251918174727017017497634125263419034461866709753181417175321</span></span><br><span class="line">mq_ = <span class="number">6229615098788722664392369146712291169948485951371133086154028832805750551655072946170332335458186479565263371985534601035559229403357396564568667218817197</span></span><br><span class="line">mp_ = <span class="number">7514598449361191486799480225087938913945061715845128006069296876457814528347371315493644046029376830166983645570092100320566196227210502897068206073043718</span></span><br><span class="line"></span><br><span class="line">N = [p,q,p_,q_]</span><br><span class="line">C = [mp,mq,mp_,mq_]</span><br><span class="line">M4 = crt(N,C)[<span class="number">0</span>]</span><br><span class="line">flag = long_to_bytes(gmpy2.iroot(M4,<span class="number">4</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;7881ed67088e9f72b860f8c376599785&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="中间的那个人"><a href="#中间的那个人" class="headerlink" title="中间的那个人"></a>中间的那个人</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">A = getrandbits(<span class="number">32</span>)</span><br><span class="line">B = getrandbits(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">Alice = <span class="built_in">pow</span>(g,A,p)</span><br><span class="line">Bob = <span class="built_in">pow</span>(g,B,p)</span><br><span class="line">key = <span class="built_in">pow</span>(Alice,B,p)</span><br><span class="line">key = sha256(long_to_bytes(key)).digest()</span><br><span class="line"></span><br><span class="line">iv = <span class="string">b&quot;0xGame0xGameGAME&quot;</span></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">enc = aes.encrypt(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g=<span class="subst">&#123;g&#125;</span>\np=<span class="subst">&#123;p&#125;</span>&#x27;</span>)  <span class="comment">#we tell</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Bob=<span class="subst">&#123;Bob&#125;</span>&#x27;</span>)     <span class="comment">#Bob tell</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Alice=<span class="subst">&#123;Alice&#125;</span>&#x27;</span>) <span class="comment">#Alice tell</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc=<span class="subst">&#123;enc&#125;</span>&#x27;</span>)<span class="comment">#Here is they secret</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g=2</span></span><br><span class="line"><span class="string">p=250858685680234165065801734515633434653</span></span><br><span class="line"><span class="string">Bob=33067794433420687511728239091450927373</span></span><br><span class="line"><span class="string">Alice=235866450680721760403251513646370485539</span></span><br><span class="line"><span class="string">enc=b&#x27;s\x04\xbc\x8bT6\x846\xd9\xd6\x83 y\xaah\xde@\xc9\x17\xdc\x04v\x18\xef\xcf\xef\xc5\xfd|\x0e\xca\n\xbd#\x94&#123;\x8e[.\xe8\xe1GU\xfa?\xda\x11w&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>因为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Alice = <span class="built_in">pow</span>(g,A,p)</span><br><span class="line">Bob = <span class="built_in">pow</span>(g,B,p)</span><br><span class="line">key = <span class="built_in">pow</span>(Alice,B,p)</span><br></pre></td></tr></table></figure>

<p>发现$p-1$光滑，而且不大，直接解离散对数$Bob \equiv g^B \mod p$</p>
<p>然后通过key和iv解AES</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Hellman</span>(<span class="params">h, g, N, p, qi</span>):</span><br><span class="line">    h = <span class="built_in">pow</span>(h, N//qi, p)</span><br><span class="line">    g = <span class="built_in">pow</span>(g, N//qi, p)</span><br><span class="line">    ai = discrete_log(mod(h,p), mod(g,p))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(ai)</span><br><span class="line"></span><br><span class="line">g = <span class="number">2</span></span><br><span class="line">p = <span class="number">250858685680234165065801734515633434653</span></span><br><span class="line">B = <span class="number">33067794433420687511728239091450927373</span></span><br><span class="line">A = <span class="number">235866450680721760403251513646370485539</span></span><br><span class="line">enc=<span class="string">b&#x27;s\x04\xbc\x8bT6\x846\xd9\xd6\x83 y\xaah\xde@\xc9\x17\xdc\x04v\x18\xef\xcf\xef\xc5\xfd|\x0e\xca\n\xbd#\x94&#123;\x8e[.\xe8\xe1GU\xfa?\xda\x11w&#x27;</span></span><br><span class="line">iv = <span class="string">b&quot;0xGame0xGameGAME&quot;</span></span><br><span class="line"></span><br><span class="line">x = discrete_log(mod(B,p),mod(g,p))</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(B == <span class="built_in">pow</span>(g,x,p))</span><br><span class="line"><span class="comment"># x = 1620639479</span></span><br><span class="line"><span class="comment"># True</span></span><br><span class="line">key = <span class="built_in">pow</span>(A,x,p)</span><br><span class="line">key = sha256(long_to_bytes(<span class="built_in">int</span>(key))).digest()</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = aes.decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;51393fe1fd5fc2df1bf018d06f0fa11d&#125;\x08\x08\x08\x08\x08\x08\x08\x08</span></span><br></pre></td></tr></table></figure>

<h3 id="Fault-Fault"><a href="#Fault-Fault" class="headerlink" title="Fault!Fault!"></a>Fault!Fault!</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle,choice,randint</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = q*p</span><br><span class="line">phi = (q-<span class="number">1</span>)*(p-<span class="number">1</span>)</span><br><span class="line">d = inverse(e,phi)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c,d,n,index</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;something go wrong&quot;&quot;&quot;</span></span><br><span class="line">    d_ = d^(<span class="number">1</span>&lt;&lt;(index))</span><br><span class="line">    m_ = <span class="built_in">pow</span>(c,d_,n)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(m_)</span><br><span class="line"></span><br><span class="line">MEMU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Welc0me_2_0xGame2023!</span></span><br><span class="line"><span class="string">/----------------------------\\</span></span><br><span class="line"><span class="string">|          options           |</span></span><br><span class="line"><span class="string">| [S]ign                     |</span></span><br><span class="line"><span class="string">| [F]ault injection          |</span></span><br><span class="line"><span class="string">| [C]heck answer             |</span></span><br><span class="line"><span class="string">\\---------------------------/</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;验证函数&#x27;&#x27;&#x27;</span></span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;以上是交互部分&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;题干&#x27;&#x27;&#x27;</span></span><br><span class="line">        signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">300</span>)</span><br><span class="line">        self.send(MEMU)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        self.send(MEMU.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            code = self.recv()</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">b&#x27;S&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;What you want to sign?:&#x27;</span>)</span><br><span class="line">                m = bytes_to_long(self.recv())</span><br><span class="line">                c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">                self.send(<span class="string">f&#x27;<span class="subst">&#123;n&#125;</span>\n<span class="subst">&#123;e&#125;</span>\n<span class="subst">&#123;c&#125;</span>&#x27;</span>.encode())</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;F&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Give me the Signatrue:&#x27;</span>)</span><br><span class="line">                Signatrue = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                self.send(<span class="string">b&#x27;Where you want to interfere?&#x27;</span>)</span><br><span class="line">                index = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                self.send(<span class="string">b&#x27;The decrypt text:&#x27;</span>)</span><br><span class="line">                self.send(decrypt(Signatrue,d,n,index).encode())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;C&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;Give me the private key:&#x27;</span>)</span><br><span class="line">                ans = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                <span class="keyword">if</span> ans == d:</span><br><span class="line">                    self.send(<span class="string">b&#x27;Here is your flag:&#x27;</span>)</span><br><span class="line">                    self.send(flag)</span><br><span class="line">                    </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;invaild input&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10005</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<blockquote>
<p> Fault Injection</p>
</blockquote>
<p>因为<code>decrypt()</code>返回$m{’} &#x3D; c^{d’} \mod n$，<code>d_ = d^(1&lt;&lt;(index))</code>，说明$d$只有第$index$位受到影响，$0 \le index \le 1024$</p>
<p>如果$d$的第$index$位本来是<code>1</code>，那么，异或之后，$d’ &#x3D; d - 2^{index}$</p>
<p>如果$d$的第$index$位本来是<code>0</code>，那么，异或之后，$d’ &#x3D; d + 2^{index}$</p>
<p>因为，$m \equiv c^d \mod n$,如果用$d’$解密的话</p>
<p>$m’ \equiv c^{d’} &#x3D; c^{d + 2^{index}} &#x3D; c^{d} \times c^{2^{index}} \equiv m \times c^{2^{index}}\mod n$</p>
<p>或者$m’ \equiv c^{d’} &#x3D; c^{d - 2^{index}} &#x3D; c^{d} \times c^{-2^{index}} \equiv m \times c^{-2^{index}}\mod n$</p>
<p>对于上面式子，左右同乘$m$模$n$的逆元得到</p>
<p>$m’\times m^{-1} \equiv c^{2^{index}} \mod n$，或者$m’\times m^{-1} \equiv c^{-2^{index}} \mod n$</p>
<p>所以，我们可以通过$m’ \times m^{-1}$的值与$c^{2^{index}}$对比，来判断d的每一位是1还是0</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;43.139.107.237&#x27;</span>                 </span><br><span class="line">port =  <span class="number">10005</span>                              </span><br><span class="line"></span><br><span class="line">GeShi = <span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>  </span><br><span class="line">sh = remote(host,port)                    </span><br><span class="line"></span><br><span class="line">data = sh.recvuntil(GeShi).decode()</span><br><span class="line"></span><br><span class="line">proof = data.split(<span class="string">&#x27;sha256&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Xnum = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">0</span>].upper().count(<span class="string">&quot;X&quot;</span>)           </span><br><span class="line">tail = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">hash</span> = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;==&#x27;</span>)[-<span class="number">1</span>].split(<span class="string">&#x27;[&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;未知数:&quot;</span>,Xnum)</span><br><span class="line"><span class="built_in">print</span>(tail)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hash</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始爆破&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=Xnum):</span><br><span class="line">    head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> t == <span class="built_in">hash</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        sh.send(head.encode())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;以下是提交完XXXX之后的流程\n&quot;</span>)</span><br><span class="line">data = sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&quot;S&quot;</span>)</span><br><span class="line">message = <span class="string">b&quot;flag&#123;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#125;&quot;</span></span><br><span class="line">m = bytes_to_long(message)</span><br><span class="line">sh.sendline(message)</span><br><span class="line">sh.recvline()</span><br><span class="line">n = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line">e = sh.recvline().decode().split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>,e)</span><br><span class="line">c = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>,c)</span><br><span class="line">d = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">1024</span>):</span><br><span class="line">    sh.sendline(<span class="string">b&quot;F&quot;</span>)</span><br><span class="line">    sh.recvline()</span><br><span class="line">    <span class="comment"># print(sh.recvline().decode().split(&#x27;\n&#x27;)[0])</span></span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(c).encode())</span><br><span class="line">    sh.recvline()</span><br><span class="line">    <span class="comment"># print(sh.recvline().decode().split(&#x27;\n&#x27;)[0])</span></span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(i).encode())</span><br><span class="line">    sh.recvline()</span><br><span class="line">    m_ = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">0</span>])</span><br><span class="line">    <span class="comment"># print(m_)</span></span><br><span class="line">    C = m_ * gmpy2.invert(m,n) % n</span><br><span class="line">    <span class="keyword">if</span> C == <span class="built_in">pow</span>(c,<span class="number">2</span>**i,n):</span><br><span class="line">        d += <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        d += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;d = &quot;</span>,d)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">pow</span>(c,<span class="built_in">int</span>(d[::-<span class="number">1</span>],<span class="number">2</span>),n) == m):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">sh.sendline(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(<span class="built_in">int</span>(d[::-<span class="number">1</span>],<span class="number">2</span>)).encode())</span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="comment">#0xGame&#123;F@ult_Milest0ne!!&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="EzLFSR"><a href="#EzLFSR" class="headerlink" title="EzLFSR"></a>EzLFSR</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;0xGame&#123;&#x27;</span>+secret+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">make_mask</span>(<span class="params">m</span>):</span><br><span class="line">    tmp = <span class="built_in">str</span>(<span class="built_in">bin</span>(bytes_to_long(m)))[<span class="number">2</span>:].zfill(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string2bits</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits2string</span>(<span class="params">bs</span>):</span><br><span class="line">    s = [<span class="built_in">str</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> bs]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lfsr</span>(<span class="params">state, mask</span>):</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(state) == <span class="number">128</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(mask)  == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    output = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">        output = output ^ (state[i] &amp; mask[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    initState = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    secret = make_mask(secret)</span><br><span class="line">    mask = string2bits(secret)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> secret: <span class="keyword">assert</span>(b == <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> b == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(secret) == <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        state = initState[i:]</span><br><span class="line">        output = lfsr(state, mask)</span><br><span class="line">        initState += [output]</span><br><span class="line"></span><br><span class="line">    outputState = bits2string(initState[<span class="number">128</span>:])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;outputState =&#x27;</span>, outputState)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">outputState = 1101111111011101100001000011111101001000111000110100010011110111010011100110100100111001101010110110101110000011110101000110010010000011111111001111000110111001100111101110010100100001101001111110001010000100111101011011100010000000100000100000100111010110</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>^</code>可以当作是模2下的加法运算，<code>&amp;</code>当作乘法运算</p>
<p>假设每次输出作为$R_i$，$S_0$表示<code>state[i]</code>，$m_i$表示二进制<code>secret</code>的每一位</p>
<p>则$R_1 &#x3D; S_0 \times m_0 + … +S_{127}\times m_{127} \mod 2$，$R_2 &#x3D; S_1 \times m_0 +… +R_{1} \times m_{127} \mod 2$</p>
<p>…</p>
<p>$R_{128} &#x3D; S_{127}\times m_0 + … + R_{127}\times m_{127} \mod 2$</p>
<p>写成矩阵形式：</p>
<p><img src="/../../images/20230xGame/7.png"></p>
<p>左边矩阵已知，右边向量已知，用sagemath解矩阵方程即可</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line">R = <span class="string">&quot;1101111111011101100001000011111101001000111000110100010011110111010011100110100100111001101010110110101110000011110101000110010010000011111111001111000110111001100111101110010100100001101001111110001010000100111101011011100010000000100000100000100111010110&quot;</span></span><br><span class="line">S = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">R = [i <span class="keyword">for</span> i <span class="keyword">in</span> R]</span><br><span class="line">S = S + R</span><br><span class="line"></span><br><span class="line">A = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    s = S[i:i+<span class="number">128</span>]</span><br><span class="line">    A.append(s)</span><br><span class="line">    </span><br><span class="line">A = Matrix(Zmod(<span class="number">2</span>),A)</span><br><span class="line">B = vector(Zmod(<span class="number">2</span>),R[:<span class="number">128</span>])</span><br><span class="line">M = A.solve_right(B)</span><br><span class="line"><span class="built_in">print</span>(M)</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M:</span><br><span class="line">    m += <span class="built_in">str</span>(i)</span><br><span class="line">    </span><br><span class="line">flag = <span class="string">b&quot;0xGame&#123;&quot;</span> + <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(m,<span class="number">2</span>))[<span class="number">2</span>:]) + <span class="string">b&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;Rec0ver_the_M@sk&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="EzRSA"><a href="#EzRSA" class="headerlink" title="EzRSA"></a>EzRSA</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> challenges.challenge1 <span class="keyword">import</span> RSAServe <span class="keyword">as</span> challenge1</span><br><span class="line"><span class="keyword">from</span> challenges.challenge2 <span class="keyword">import</span> RSAServe <span class="keyword">as</span> challenge2</span><br><span class="line"><span class="keyword">from</span> challenges.challenge3 <span class="keyword">import</span> RSAServe <span class="keyword">as</span> challenge3</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle,choice,randint</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SCORE = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">BANNER = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> ____  ____    _    </span></span><br><span class="line"><span class="string">|  _ \/ ___|  / \   </span></span><br><span class="line"><span class="string">| |_) \___ \ / _ \  </span></span><br><span class="line"><span class="string">|  _ &lt; ___) / ___ \ </span></span><br><span class="line"><span class="string">|_| \_\____/_/   \_\</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Here are four challenges(1, 2, 3), solve them all then you can get flag.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">MEMU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">/----------------------------\\</span></span><br><span class="line"><span class="string">|          options           |</span></span><br><span class="line"><span class="string">| 1. get public key          |</span></span><br><span class="line"><span class="string">| 2. get cipher text         |</span></span><br><span class="line"><span class="string">| 3. check                   |</span></span><br><span class="line"><span class="string">\\---------------------------/</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;验证函数&#x27;&#x27;&#x27;</span></span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Serve</span>(<span class="params">self, S</span>):</span><br><span class="line">        self.send(MEMU.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            option = self.recv()</span><br><span class="line">            <span class="keyword">if</span> option == <span class="string">b&#x27;1&#x27;</span>:</span><br><span class="line">                pubkey = S.pubkey()</span><br><span class="line">                <span class="keyword">for</span> s <span class="keyword">in</span> pubkey:</span><br><span class="line">                    self.send(<span class="built_in">str</span>(s).encode())</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="string">b&#x27;2&#x27;</span>:</span><br><span class="line">                c = S.encrypt()</span><br><span class="line">                self.send(c.encode())</span><br><span class="line">            <span class="keyword">elif</span> option == <span class="string">b&#x27;3&#x27;</span>:</span><br><span class="line">                usr_answer = self.recv(<span class="string">b&quot;input your answer: &quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> S.check(usr_answer)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&quot;invaild option&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">300</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.send(BANNER.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.send(<span class="string">f&#x27;your score <span class="subst">&#123;<span class="built_in">sum</span>(SCORE)&#125;</span>&#x27;</span>.encode())</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">sum</span>(SCORE) == <span class="number">3</span>:</span><br><span class="line">                self.send(<span class="string">f&quot;here are flag:<span class="subst">&#123;flag&#125;</span>&quot;</span>.encode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            self.send(<span class="string">b&#x27;select challange&#123;1,2,3&#125;&#x27;</span>)<span class="comment">#</span></span><br><span class="line">            code = self.recv()</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">b&#x27;1&#x27;</span>:</span><br><span class="line">                S = challenge1()</span><br><span class="line">                res = self.Serve(S)</span><br><span class="line">                <span class="keyword">if</span> res == <span class="literal">True</span>:</span><br><span class="line">                    SCORE[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">                    self.send(<span class="string">b&#x27;Conguration!You are right!&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;2&#x27;</span>:</span><br><span class="line">                S = challenge2()</span><br><span class="line">                res = self.Serve(S)</span><br><span class="line">                <span class="keyword">if</span> res == <span class="literal">True</span>:</span><br><span class="line">                    SCORE[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">                    self.send(<span class="string">b&#x27;Conguration!You are right!&#x27;</span>)</span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;3&#x27;</span>:</span><br><span class="line">                S = challenge3()</span><br><span class="line">                res = self.Serve(S)</span><br><span class="line">                <span class="keyword">if</span> res == <span class="literal">True</span>:</span><br><span class="line">                    SCORE[<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">                    self.send(<span class="string">b&#x27;Conguration!You are right!&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;invaild input&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10006</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<h4 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.p = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        self.n = self.q*self.p</span><br><span class="line">        self.g, self.r1 = [random.randint(<span class="number">1</span>, self.q*self.p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">        self.gift = <span class="built_in">pow</span>(self.g, self.r1 * (self.p - <span class="number">1</span>), self.n)</span><br><span class="line">        self.m = <span class="string">b&quot;Fermat&#x27;s little theorem&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure>

<p>费马定理</p>
<p>$\because gift \equiv g^{r_1(p-1)} \mod n \longrightarrow gift \equiv 1 \mod p$</p>
<p>$\therefore gift - 1 &#x3D; kp$</p>
<p>求<code>gift - 1</code>和<code>n</code>的公因数得到p</p>
<h4 id="challenge2"><a href="#challenge2" class="headerlink" title="challenge2"></a>challenge2</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = <span class="string">b&#x27;EzFactor&#x27;</span></span><br><span class="line">        self.p = self.GetMyPrime(<span class="number">1024</span>)</span><br><span class="line">        self.q = self.GetMyPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GetMyPrime</span>(<span class="params">self,bits</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            n = <span class="number">2</span></span><br><span class="line">            <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">                a = choice(sieve_base)</span><br><span class="line">                n *= a</span><br><span class="line">            <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.p*self.q, self.e</span><br></pre></td></tr></table></figure>

<p>由<code>GetMyPrime</code>函数知道，$p-1$和$q-1$都很光滑</p>
<h4 id="challenge3"><a href="#challenge3" class="headerlink" title="challenge3"></a>challenge3</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAServe</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.e = <span class="number">65537</span></span><br><span class="line">        self.m = <span class="string">b&#x27;Continued fraction&#x27;</span></span><br><span class="line">        self.p = getPrime(<span class="number">896</span>)</span><br><span class="line">        self.n1 = self.getN()</span><br><span class="line">        self.n2 = self.getN()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getN</span>(<span class="params">self</span>):</span><br><span class="line">        q = getPrime(<span class="number">128</span>)</span><br><span class="line">        self.p = nextprime(self.p)</span><br><span class="line">        <span class="keyword">return</span> q*self.p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self</span>):</span><br><span class="line">        m_ = bytes_to_long(self.m)</span><br><span class="line">        c = <span class="built_in">pow</span>(m_, self.e, self.n2)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hex</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">return</span> msg == self.m</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pubkey</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.n1, self.n2 , self.e</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>$\because p_1 &lt; p_2$且$p_1 \approx p_2$，$\therefore \frac{n_1}{n_2} \approx \frac{q_1}{q_2}$</p>
<p>连分数展开就有可能得到$q_2$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">smooth</span>(<span class="params">N</span>):</span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    n = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">pow</span>(a, n, N)</span><br><span class="line">        res = gmpy2.gcd(a - <span class="number">1</span>, N)</span><br><span class="line">        <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#展开为连分数列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cF = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cF += [x // y]</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cF</span><br><span class="line"><span class="comment">#将当前连分数列表计算成有理分数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Simplify</span>(<span class="params">ctnf</span>):</span><br><span class="line">    numerator = <span class="number">0</span></span><br><span class="line">    denominator = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> ctnf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> (numerator, denominator)</span><br><span class="line"><span class="comment">#将连分数列表变成不同的有理数逼近列表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getit</span>(<span class="params">c</span>):</span><br><span class="line">    cf=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(c)):</span><br><span class="line">        cf.append(Simplify(c[:i]))</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt3</span>(<span class="params">n1, n2,c</span>):</span><br><span class="line">    cf = continuedFra(n1, n2)</span><br><span class="line">    <span class="keyword">for</span> (q2,q1) <span class="keyword">in</span> getit(cf):                   <span class="comment">#前面一个参数是分母 </span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> n2 % q2 == <span class="number">0</span> <span class="keyword">and</span> q2 != <span class="number">1</span>:</span><br><span class="line">                p2 = n2 // q2</span><br><span class="line">                d = gmpy2.invert(<span class="number">65537</span>,(p2-<span class="number">1</span>)*(q2-<span class="number">1</span>))</span><br><span class="line">                m = <span class="built_in">pow</span>(c,d,n2)</span><br><span class="line">                message = long_to_bytes(m)</span><br><span class="line">                <span class="keyword">return</span> message</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag1</span>():</span><br><span class="line">    sh.send(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>).decode()</span><br><span class="line">    sh.send(<span class="string">b&quot;1&quot;</span>)  </span><br><span class="line">    n = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    e = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    gift = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    p = gmpy2.gcd(n,gift - <span class="number">1</span>)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    message = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m1 =&quot;</span>,message)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    sh.send(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    sh.send(message)</span><br><span class="line">    <span class="comment">#Fermat&#x27;s little theorem?</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag2</span>():</span><br><span class="line">    sh.send(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>).decode()</span><br><span class="line">    sh.send(<span class="string">b&quot;1&quot;</span>)  </span><br><span class="line">    n = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    e = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    p = smooth(n)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">    message = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m2 =&quot;</span>,message)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    sh.send(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    sh.send(message)</span><br><span class="line">    <span class="comment">#EzFactor!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getflag3</span>():</span><br><span class="line">    sh.send(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>).decode()</span><br><span class="line">    sh.send(<span class="string">b&quot;1&quot;</span>)  </span><br><span class="line">    n1 = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    n2 = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    e = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line">    message = decrypt3(n1,n2,c)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;m3 =&quot;</span>,message)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    sh.send(<span class="string">b&quot;3&quot;</span>)</span><br><span class="line">    sh.send(message)</span><br><span class="line">    <span class="comment">#Continued fractionnnn</span></span><br><span class="line">    </span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;43.139.107.237&#x27;</span>                  <span class="comment">#ip地址</span></span><br><span class="line">port =  <span class="number">10006</span>                              <span class="comment">#端口</span></span><br><span class="line"></span><br><span class="line">GeShi = <span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>  <span class="comment"># 改格式！</span></span><br><span class="line">sh = remote(host,port)                  <span class="comment">#建立连接  </span></span><br><span class="line"></span><br><span class="line">data = sh.recvuntil(GeShi).decode()</span><br><span class="line"></span><br><span class="line">proof = data.split(<span class="string">&#x27;sha256&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">Xnum = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">0</span>].upper().count(<span class="string">&quot;X&quot;</span>)           <span class="comment">#要爆破的数量</span></span><br><span class="line">tail = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">hash</span> = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;==&#x27;</span>)[-<span class="number">1</span>].split(<span class="string">&#x27;[&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;未知数:&quot;</span>,Xnum)</span><br><span class="line"><span class="built_in">print</span>(tail)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hash</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始爆破&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=Xnum):</span><br><span class="line">    head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> t == <span class="built_in">hash</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        sh.send(head.encode())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;以下是提交完XXXX之后的流程\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">getflag1()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;challenge1完成!&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">getflag2()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;challenge2完成!&quot;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">getflag3()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;challenge3完成!&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="comment">#0xGame&#123;a1425c9ce44989ffd64968130ee2f9fd&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h2><h3 id="符文解密师"><a href="#符文解密师" class="headerlink" title="符文解密师"></a>符文解密师</h3><p><code>shift + F12</code>秒了</p>
<p><img src="/../../images/20230xGame/5.png"></p>
<h3 id="编码逆旅者"><a href="#编码逆旅者" class="headerlink" title="编码逆旅者"></a>编码逆旅者</h3><p>网站反编译得到</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    flag = binascii.unhexlify(<span class="built_in">hex</span>(<span class="number">0x307847616D657B63646539646331372D356133312D356330612D646633342D3663373562373634366334627D</span>)[<span class="number">2</span>:].encode())</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&#x27;请输入一个秘密的数字：&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">len</span>(user_input) != <span class="number">13</span> <span class="keyword">or</span> user_input.isdigit():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;无效输入。必须是13位数字。&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">None</span> == <span class="string">&#x27;1145141919810&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;&#x27;&#x27;真理的旗帜：<span class="subst">&#123;flag&#125;</span>&#x27;&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="literal">None</span>(<span class="string">&#x27;秘密的数字错误！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<p>运行得到<code>0xGame&#123;cde9dc17-5a31-5c0a-df34-6c75b7646c4b&#125;</code></p>
<h3 id="码海舵师"><a href="#码海舵师" class="headerlink" title="码海舵师"></a>码海舵师</h3><p><img src="/../../images/20230xGame/6.png"></p>
<p>密文<code>MHhHYW1le2ZjYmVlZWM3LTc3NTgtYmEyZi1jMDU5LTJmNWNhOWEzODc5YX0=</code></p>
<p>base64解码<code>0xGame&#123;fcbeeec7-7758-ba2f-c059-2f5ca9a3879a&#125;</code></p>
<h3 id="注册侦探——复现"><a href="#注册侦探——复现" class="headerlink" title="注册侦探——复现"></a>注册侦探——复现</h3><p><code>win + R</code> 进入<code>regedit</code>，创建注册表</p>
<p><img src="/../../images/20230xGame/10.png"></p>
<p>然后运行程序即可获得flag</p>
<p><img src="/../../images/20230xGame/11.png"></p>
<p><strong>有个问题想问大佬们，为什么我的ida无法把中文反编译出来</strong></p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="cal"><a href="#cal" class="headerlink" title="cal"></a>cal</h3><p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;8.130.35.16&quot;</span></span><br><span class="line">port = <span class="number">55001</span></span><br><span class="line"></span><br><span class="line">sh = remote(host,port)</span><br><span class="line"></span><br><span class="line">sh.recvline()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    sh.recvline()</span><br><span class="line">    data = sh.recvuntil(<span class="string">b&quot;=&quot;</span>).decode().strip(<span class="string">&#x27;=&#x27;</span>).split(<span class="string">&quot;+&quot;</span>)</span><br><span class="line">    a = <span class="built_in">int</span>(data[<span class="number">0</span>])</span><br><span class="line">    b = <span class="built_in">int</span>(data[<span class="number">1</span>])</span><br><span class="line">    message = a+b</span><br><span class="line">    sh.sendline(<span class="built_in">str</span>(message).encode())</span><br><span class="line">    sh.recvline()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sh.recvline().decode())</span><br><span class="line">sh.sendline(<span class="string">b&quot;cat flag&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(sh.recvline().decode())</span><br><span class="line"><span class="comment">#0xGame&#123;edf1f8de-66cc-43d5-9a30-9067371ca77a&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="Week3"><a href="#Week3" class="headerlink" title="Week3"></a>Week3</h1><h2 id="Crypto-2"><a href="#Crypto-2" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="EzECC"><a href="#EzECC" class="headerlink" title="EzECC"></a>EzECC</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> msg</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;0xGame&#123;&#x27;</span> + msg + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">80</span>)</span><br><span class="line">a,b= [random.randrange(<span class="number">1</span>,q-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P,Q</span>):</span><br><span class="line">	<span class="keyword">if</span> P[<span class="number">0</span>] != Q[<span class="number">0</span>] <span class="keyword">and</span> P[<span class="number">1</span>] != Q[<span class="number">1</span>]:</span><br><span class="line">		t = ((Q[<span class="number">1</span>]-P[<span class="number">1</span>]) * inverse(Q[<span class="number">0</span>]-P[<span class="number">0</span>],q)) %q</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		t = ((<span class="number">3</span>*P[<span class="number">0</span>]*P[<span class="number">0</span>]+a) * inverse(<span class="number">2</span>*P[<span class="number">1</span>],q))%q</span><br><span class="line"></span><br><span class="line">	x3 = t*t - P[<span class="number">0</span>] - Q[<span class="number">0</span>]</span><br><span class="line">	y3 = t*(P[<span class="number">0</span>] - x3) - P[<span class="number">1</span>]</span><br><span class="line">	<span class="keyword">return</span> (x3%q, y3%q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">t, A, B=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> t: <span class="keyword">return</span> B</span><br><span class="line">    <span class="keyword">return</span> mul(t//<span class="number">2</span>, add(A,A), B <span class="keyword">if</span> <span class="keyword">not</span> t&amp;<span class="number">1</span> <span class="keyword">else</span> add(B,A) <span class="keyword">if</span> B <span class="keyword">else</span> A)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(msg)%<span class="number">2</span>==<span class="number">0</span></span><br><span class="line">m1=bytes_to_long(msg[:<span class="built_in">len</span>(msg)//<span class="number">2</span>])</span><br><span class="line">m2=bytes_to_long(msg[<span class="built_in">len</span>(msg)//<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">k = random.getrandbits(<span class="number">64</span>)</span><br><span class="line">G = (<span class="number">641322496020493855620384</span> , <span class="number">437819621961768591577606</span>)</span><br><span class="line">K = mul(k,G)</span><br><span class="line"></span><br><span class="line">M = (m1,m2)</span><br><span class="line">r = random.getrandbits(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">C_1 = add(M,mul(r,K))</span><br><span class="line">C_2 = mul(r,G)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q=<span class="subst">&#123;q&#125;</span>\na=<span class="subst">&#123;a&#125;</span>\nb=<span class="subst">&#123;b&#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;G = <span class="subst">&#123;G&#125;</span>\nK = <span class="subst">&#123;K&#125;</span>\nC_1=<span class="subst">&#123;C_1&#125;</span>\nC_2=<span class="subst">&#123;C_2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">q=1139075593950729137191297</span></span><br><span class="line"><span class="string">a=930515656721155210883162</span></span><br><span class="line"><span class="string">b=631258792856205568553568</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">G = (641322496020493855620384, 437819621961768591577606)</span></span><br><span class="line"><span class="string">K = (781988559490437792081406, 76709224526706154630278)</span></span><br><span class="line"><span class="string">C_1=(55568609433135042994738, 626496338010773913984218)</span></span><br><span class="line"><span class="string">C_2=(508425841918584868754821, 816040882076938893064041)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>出题人用python实现了椭圆曲线的加法和乘法</p>
<p>$\because C_2 &#x3D; r\times G$，$C_1 &#x3D; M + rK$</p>
<p>$\therefore M &#x3D; C_1 - rK$</p>
<p>所以我们先求出$r$，然后用减法求$M$，<strong>这里需要注意的是利用题目给的</strong><code>add(P,Q)</code>函数，传入<code>add(C_1,-rK)</code>即可实现减法</p>
<p>而$-rK$和$rK$的关系是$x_{-rK} &#x3D; x_{rK}$,$y_{-rK} &#x3D; -y_{rK} \mod q$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">q = <span class="number">1139075593950729137191297</span></span><br><span class="line">a = <span class="number">930515656721155210883162</span></span><br><span class="line">b = <span class="number">631258792856205568553568</span></span><br><span class="line">E = EllipticCurve(GF(q),[a,b])</span><br><span class="line"></span><br><span class="line">G = E(<span class="number">641322496020493855620384</span>, <span class="number">437819621961768591577606</span>)</span><br><span class="line">K = E(<span class="number">781988559490437792081406</span>, <span class="number">76709224526706154630278</span>)</span><br><span class="line">C_2 = E(<span class="number">508425841918584868754821</span>, <span class="number">816040882076938893064041</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P,Q</span>):</span><br><span class="line">    <span class="keyword">if</span> P[<span class="number">0</span>] != Q[<span class="number">0</span>] <span class="keyword">and</span> P[<span class="number">1</span>] != Q[<span class="number">1</span>]:</span><br><span class="line">        t = ((Q[<span class="number">1</span>]-P[<span class="number">1</span>]) * inverse(Q[<span class="number">0</span>]-P[<span class="number">0</span>],q)) %q</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        t = ((<span class="number">3</span>*P[<span class="number">0</span>]*P[<span class="number">0</span>]+a) * inverse(<span class="number">2</span>*P[<span class="number">1</span>],q))%q</span><br><span class="line"></span><br><span class="line">    x3 = t*t - P[<span class="number">0</span>] - Q[<span class="number">0</span>]</span><br><span class="line">    y3 = t*(P[<span class="number">0</span>] - x3) - P[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> (x3%q, y3%q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>^<span class="number">16</span>):</span><br><span class="line">    <span class="keyword">if</span> C_2 == i*G:</span><br><span class="line">        r = i</span><br><span class="line">        <span class="built_in">print</span>(r)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">r = <span class="number">10077</span></span><br><span class="line">_rK = -r * K</span><br><span class="line"><span class="built_in">print</span>(_rK)</span><br><span class="line"></span><br><span class="line">_rK = (<span class="number">550786064209051189742959</span>,<span class="number">986834966171230458412423</span>)</span><br><span class="line">C_1=(<span class="number">55568609433135042994738</span>, <span class="number">626496338010773913984218</span>)</span><br><span class="line"></span><br><span class="line">M = add(C_1,_rK)</span><br><span class="line">mx = M[<span class="number">0</span>]</span><br><span class="line">my = M[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&quot;0xGame&#123;&quot;</span> + long_to_bytes(<span class="built_in">int</span>(mx)) + long_to_bytes(<span class="built_in">int</span>(my)) + <span class="string">b&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 0xGame&#123;Al1ce_L0ve_B0b&#125;</span></span><br></pre></td></tr></table></figure>

<p>这里求解r选择用爆破的方式，因为通过sagemath求得的$r &#x3D; 900793232925355612586660$不符合题意（不明白）</p>
<h3 id="LLL-FirstBlood"><a href="#LLL-FirstBlood" class="headerlink" title="LLL-FirstBlood"></a>LLL-FirstBlood</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) % <span class="number">4</span> == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">length = <span class="built_in">len</span>(flag)//<span class="number">4</span></span><br><span class="line">m = [bytes_to_long(flag[i*length:(i+<span class="number">1</span>)*length]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">p = getPrime(<span class="built_in">int</span>(<span class="number">128</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MakeMask</span>(<span class="params">n,p</span>):</span><br><span class="line">    upper = identity_matrix(n)</span><br><span class="line">    low = identity_matrix(n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>, n):    </span><br><span class="line">            upper[i, j] = randrange(<span class="number">1</span>, p)</span><br><span class="line">            low[j, i] = randrange(<span class="number">1</span>, p)</span><br><span class="line">    result = upper * low</span><br><span class="line">    <span class="keyword">assert</span> det(result) == <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Matrix2List</span>(<span class="params">x</span>):<span class="keyword">return</span> [<span class="built_in">list</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"></span><br><span class="line">noise = [[randrange(<span class="number">1</span>, p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">noise[<span class="number">0</span>] = m</span><br><span class="line">M = matrix(noise)</span><br><span class="line">A = MakeMask(<span class="number">4</span>,p)</span><br><span class="line">C = A*M</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C=<span class="subst">&#123;Matrix2List(C)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p=198880159035681668071031460916089145469</span></span><br><span class="line"><span class="string">C=[[1528140902799730745476264672501768332416990282355490479242339131918301176698899635154781328839496210200676497333428, 2081687444435007467807250373278513114045272585243815458840083487459795021302180077490134099644993120009567147202772, 3080873409460299046339495750746632185307246572817534784703936044874106809413620470006445984962733721029566440253675, 3491734341995174183626991907292607070252197520631412767989879432598743851171175369180080355977574296558734415823458], [2359409535809048127331244699867147546817134802610067329431135227991488324148374065940238308147500809599395748756798, 3191196199160821446351036460385791985682645040446022512790815348810555748825420237291839170774872264097466183208742, 4665346530155386457242345394284286198347336281451530670818113876767736288089400119492317775648206643242839430899283, 5369350746042850276067380638571565496087948799720968959426256192923852197959381101839484196445995828389461004495917], [1641407111066265429602929560264443103285908072677065498760570514577412905392260182334706635555256537745902283191251, 2190536173399177167068153351271988931232272884028569669242062395087922275021628334797729266560930040116807133977244, 3127556759140845426132305699421707182108351516931881411928719802847628408656887897596425133523782526561471050447359, 3707239956529200159380870618471703921011276020439315706352183576289925263316580408968092016782483770373121972835410], [9883814543195849013523934427451407019514807606993414569626142656857168165339, 13190422499129347541373922929251088892868361241120937213742340947017395215646, 18832738552342488056498211782604832513006649329982003661701684946590064734701, 22323329751908690611034666068697427811613727429398087082295754189068333861152]]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>假设</p>
<p><img src="/../../images/20230xGame/16.png"></p>
<p>$\because C &#x3D; AM$</p>
<p>直接对C用LLL算法就能得到$m_1,m_2,m_3,m_4$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">C = </span><br><span class="line">C = Matrix(ZZ,C)</span><br><span class="line"></span><br><span class="line">M = C.LLL()[<span class="number">0</span>]</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> M:</span><br><span class="line">    m = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">abs</span>(i)))</span><br><span class="line">    flag += m</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;8e4d5924dc4cd78f11c1eeb99e991ab3&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="LLL-SecondBlood"><a href="#LLL-SecondBlood" class="headerlink" title="LLL-SecondBlood"></a>LLL-SecondBlood</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() == <span class="number">318</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m</span>):</span><br><span class="line">	mask,noise = getPrime(<span class="number">511</span>),getPrime(<span class="number">50</span>)</span><br><span class="line">	mask_.append(mask)</span><br><span class="line">	noise_.append(noise)</span><br><span class="line">	c = (mask*m + noise)%q</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">noise_,mask_  =[[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">c_ = [encrypt(m) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>\nmask = <span class="subst">&#123;mask_&#125;</span>\nc_ = <span class="subst">&#123;c_&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">q = 9342426601783650861020119568565656404715236059903009041977149778244153930435908024696666887269890479558473622355346816236972767736577737332173213722012253</span></span><br><span class="line"><span class="string">mask = [6237128445236992920577225644858662677575951126467888858782461334057970069468925833844231116647406833999142659751374620280213290736114576089069396331226747, 6368031389213953889417545256750169233725975229197446803885029159767701479445576860704561593200907482372690851152126782391126462547524526631934408981070841, 5106473460982791188578285397420642137630347289252852045044021197988607082777231839839730169682158507822078412449827976663385282021916120837408192506341443, 6318090842950331228033349517542810123596316850353637421587264886413877142612686177796023049304908696413386218992511112752788640732410845589679820003047667]</span></span><br><span class="line"><span class="string">c_ = [3823539664720029027586933152478492780438595004453489251844133830947165342839393878831914879334660250621422877333022321117120398528430519794109624186204492, 1721659645750224819953244995460589691120672649732560768435214608167861246790136217219349234604724148039910656573436663379375048145045443527267790379816425, 668633520079344839648950502380059311916108468801009386138810324259146523323704014491547148973835774917331333581475920804677395949854411894556705238578896, 497860586379981076499130281851986010889356253371192266267220334713415782402939318483926418213877341511996918189750595755372560345085899109305344338944066]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>$\because C_i \equiv a_im + b_i \mod p$</p>
<p>$\therefore \therefore b_i &#x3D; C_i - a_im +kp$</p>
<p>构造格</p>
<p><img src="/../../images/20230xGame/17.png"></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">q = </span><br><span class="line">mask = </span><br><span class="line">c_ = </span><br><span class="line"></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [q,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">0</span>,q,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,q,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,q,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [-mask[<span class="number">0</span>],-mask[<span class="number">1</span>],-mask[<span class="number">2</span>],-mask[<span class="number">3</span>],<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [c_[<span class="number">0</span>],c_[<span class="number">1</span>],c_[<span class="number">2</span>],c_[<span class="number">3</span>],<span class="number">0</span>,<span class="number">2</span>^<span class="number">318</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(i[-<span class="number">1</span>]) == <span class="number">2</span>^<span class="number">318</span>:</span><br><span class="line">        m = <span class="built_in">abs</span>(i[-<span class="number">2</span>])</span><br><span class="line">        flag = <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="comment">#0xGame&#123;19255b5c7b19c790e28d87c8a8bb1d33&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="EzMartix"><a href="#EzMartix" class="headerlink" title="EzMartix"></a>EzMartix</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secert <span class="keyword">import</span> secert,flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">n2b</span>(<span class="params">n</span>):<span class="keyword">return</span> md5(<span class="built_in">str</span>(n).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> secert &lt; <span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">64</span>)</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">&#x27;0xGame&#123;&#x27;</span>+n2b(secert)+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Martix2list</span>(<span class="params">Martix</span>):</span><br><span class="line">    result = []</span><br><span class="line">    Martix = <span class="built_in">list</span>(Martix)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> Martix:</span><br><span class="line">        result.append(<span class="built_in">list</span>(i))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">A =</span><br><span class="line"><span class="comment"># 12 * 12的矩阵</span></span><br><span class="line">p = </span><br><span class="line">A = Matrix(GF(p),A)</span><br><span class="line">enc = A**secert</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Martix2list</span>(<span class="params">Martix</span>):</span><br><span class="line">    result = []</span><br><span class="line">    Martix = <span class="built_in">list</span>(Martix)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> Martix:</span><br><span class="line">        result.append(<span class="built_in">list</span>(i))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">str</span>(Martix2list(enc)))</span><br></pre></td></tr></table></figure>

<p>由$A^m &#x3D; C$，结合线代知识知道</p>
<p>存在矩阵$P$,使得$P^{-1}AP &#x3D; B$（B是对角矩阵）</p>
<p>$\therefore B^m &#x3D; P^{-1}A^mP$</p>
<p>即$B^m &#x3D; P^{-1}CP$</p>
<p>根据对角矩阵相乘的性质（主对角线上的元素自乘），这样就把矩阵的乘法转为求解$b^m \equiv c \mod p$这样的离散对数问题，其中$b$是矩阵$B$主对角线上任意一个元素，$c$是右边矩阵$P^{-1}CP$主对角线上任意一个元素</p>
<p>关于求解，利用了sagemath自带的函数<code>diagonalization()</code></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">A=</span><br><span class="line">p = </span><br><span class="line">C = </span><br><span class="line"></span><br><span class="line">A = Matrix(GF(p),A)</span><br><span class="line">C = Matrix(GF(p),C)</span><br><span class="line">A,P = A.diagonalization()</span><br><span class="line"><span class="comment"># print(A)</span></span><br><span class="line"></span><br><span class="line">P_ = P.inverse()</span><br><span class="line">C = P_ * C * P</span><br><span class="line"></span><br><span class="line">a = A[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">c = C[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">m = discrete_log(mod(c,p),mod(a,p))</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#6208835615336459559</span></span><br><span class="line">flag = <span class="string">&quot;0xGame&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(m).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#0xGame&#123;06450201eb6171d40151563d967e59ea&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="EzOverflow"><a href="#EzOverflow" class="headerlink" title="EzOverflow"></a>EzOverflow</h3><p>ElGamal.py</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,GCD,inverse,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getKey</span>(<span class="params">bits</span>):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    g = getPrime(bits//<span class="number">2</span>)</span><br><span class="line">    d = random.randint(<span class="number">1</span>,p-<span class="number">2</span>)</span><br><span class="line">    y = <span class="built_in">pow</span>(g,d,p)</span><br><span class="line">    public,private = (p,g,y),d</span><br><span class="line">    <span class="keyword">return</span> public,private</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">m,public,private</span>):</span><br><span class="line">    m = bytes_to_long(m)</span><br><span class="line">    p,g,y = public</span><br><span class="line">    d = private</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = random.randint(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> GCD(k,p-<span class="number">1</span>)==<span class="number">1</span>:<span class="keyword">break</span></span><br><span class="line">    r = <span class="built_in">pow</span>(g,k,p)</span><br><span class="line">    s = ((m-d*r)*inverse(k,p-<span class="number">1</span>)) % (p-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> (r,s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verity</span>(<span class="params">m,sign,public</span>):</span><br><span class="line">    m = bytes_to_long(m)</span><br><span class="line">    p,g,y = public</span><br><span class="line">    r,s = sign</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(g,m,p) == (<span class="built_in">pow</span>(y,r,p)*<span class="built_in">pow</span>(r,s,p)) % p:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>task.py</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ElGamal <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> secert <span class="keyword">import</span> flag</span><br><span class="line">pub,pri = getKey(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">300</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        self.send(<span class="string">b&#x27;Here are your public key:&#x27;</span>)</span><br><span class="line">        self.send(<span class="built_in">str</span>(pub).encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment">#sign</span></span><br><span class="line">            self.send(<span class="string">b&#x27;Pz tell me what you want to sign?&#x27;</span>)</span><br><span class="line">            message = self.recv()</span><br><span class="line">            <span class="keyword">if</span> message == <span class="string">b&#x27;0xGame&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&quot;Permission denied!&quot;</span>)</span><br><span class="line">                quit()</span><br><span class="line">            self.send(<span class="string">b&#x27;Here are your sign:&#x27;</span>)</span><br><span class="line">            r,s = sign(message,pub,pri)</span><br><span class="line">            self.send(<span class="string">f&#x27;r=<span class="subst">&#123;r&#125;</span>\ns=<span class="subst">&#123;s&#125;</span>&#x27;</span>.encode())</span><br><span class="line">            <span class="comment">#ver</span></span><br><span class="line">            self.send(<span class="string">b&#x27;Tell me your signature,if you want to get the flag.&#x27;</span>)</span><br><span class="line">            r = <span class="built_in">int</span>(self.recv())</span><br><span class="line">            s = <span class="built_in">int</span>(self.recv())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> verity(<span class="string">b&#x27;0xGame&#x27;</span>,(r,s),pub):</span><br><span class="line">                self.send(<span class="string">b&#x27;Here you are:&#x27;</span>+flag)</span><br><span class="line">                self.send(<span class="string">b&#x27;bye~&#x27;</span>)</span><br><span class="line">                quit()</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&quot;sorry~you can&#x27;t get it.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10007</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<p>验证过程：</p>
<p>$g^m \equiv y^rr^s \mod p$，根据题目意思，我们能够控制$m,r,s$</p>
<p>如果$m’ &#x3D; m +k(p-1)$，也能满足$g^{m’} &#x3D; g^{m + k(p-1)} \equiv g^m \times (g^{p-1})^k \equiv g^m \equiv y^rr^s \mod p$</p>
<p>或者$m’ &#x3D; m\times p$，则$g^{m’} &#x3D; g^{mp} \equiv (g^m)^p \equiv g^m \mod p$</p>
<p>所以传入一个$m’$ &#x3D; <code>long_to_bytes(bytes_to_long(b&quot;0xGame&quot;) + (p-1))</code>，或者$m’$ &#x3D; <code>long_to_bytes(bytes_to_long(b&quot;0xGame&quot;)*p)</code> 得到签名$r,s$</p>
<p>随后可用$m$ &#x3D; <code>0xGame</code>完成验证</p>
<p>可用下面代码进行验证：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,GCD,inverse,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getKey</span>(<span class="params">bits</span>):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    g = getPrime(bits//<span class="number">2</span>)</span><br><span class="line">    d = random.randint(<span class="number">1</span>,p-<span class="number">2</span>)</span><br><span class="line">    y = <span class="built_in">pow</span>(g,d,p)</span><br><span class="line">    public,private = (p,g,y),d</span><br><span class="line">    <span class="keyword">return</span> public,private</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">m,public,private</span>):</span><br><span class="line">    m = bytes_to_long(m)</span><br><span class="line">    p,g,y = public</span><br><span class="line">    d = private</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = random.randint(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> GCD(k,p-<span class="number">1</span>)==<span class="number">1</span>:<span class="keyword">break</span></span><br><span class="line">    r = <span class="built_in">pow</span>(g,k,p)</span><br><span class="line">    s = ((m-d*r)*inverse(k,p-<span class="number">1</span>)) % (p-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> (r,s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verity</span>(<span class="params">m,sign,public</span>):</span><br><span class="line">    m = bytes_to_long(m)</span><br><span class="line">    p,g,y = public</span><br><span class="line">    r,s = sign</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(g,m,p) == (<span class="built_in">pow</span>(y,r,p)*<span class="built_in">pow</span>(r,s,p)) % p:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">pub,pri = getKey(<span class="number">512</span>)</span><br><span class="line">p,g,y = pub</span><br><span class="line">flag = <span class="string">b&quot;0xGame&quot;</span></span><br><span class="line">m = long_to_bytes(bytes_to_long(flag)*p)</span><br><span class="line">(r,s) = sign(m,pub,pri)</span><br><span class="line"></span><br><span class="line">tt = verity(flag,(r,s),pub)</span><br><span class="line"><span class="built_in">print</span>(tt)</span><br></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;43.139.107.237&#x27;</span>                  <span class="comment">#ip地址</span></span><br><span class="line">port =  <span class="number">10007</span>                              <span class="comment">#端口</span></span><br><span class="line"></span><br><span class="line">GeShi = <span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>  <span class="comment"># 改格式！</span></span><br><span class="line">sh = remote(host,port)                  <span class="comment">#建立连接  </span></span><br><span class="line"></span><br><span class="line">data = sh.recvuntil(GeShi).decode()</span><br><span class="line"></span><br><span class="line">proof = data.split(<span class="string">&#x27;sha256&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Xnum = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">0</span>].upper().count(<span class="string">&quot;X&quot;</span>)           <span class="comment">#要爆破的数量</span></span><br><span class="line">tail = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">hash</span> = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;==&#x27;</span>)[-<span class="number">1</span>].split(<span class="string">&#x27;[&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;未知数:&quot;</span>,Xnum)</span><br><span class="line"><span class="built_in">print</span>(tail)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hash</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始爆破&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=Xnum):</span><br><span class="line">    head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> t == <span class="built_in">hash</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        sh.send(head.encode())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;以下是提交完XXXX之后的流程\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Here are your public key:\n&quot;</span>)</span><br><span class="line">sign = <span class="built_in">eval</span>(sh.recvline().decode())</span><br><span class="line">p,g,y = sign</span><br><span class="line">m = <span class="string">b&quot;0xGame&quot;</span></span><br><span class="line">message = long_to_bytes(bytes_to_long(m) + (p-<span class="number">1</span>))</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">sh.sendline(message)</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Here are your sign:\n&quot;</span>)</span><br><span class="line">r = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27;=&#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">s = <span class="built_in">int</span>(sh.recvline().decode().split(<span class="string">&#x27;=&#x27;</span>)[-<span class="number">1</span>])</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(r).encode())</span><br><span class="line">sh.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">sh.sendline(<span class="built_in">str</span>(s).encode())</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment">#0xGame&#123;24b6edfdc07d71311774ed15248f434e&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Re-1"><a href="#Re-1" class="headerlink" title="Re"></a>Re</h2><h3 id="代码启示录"><a href="#代码启示录" class="headerlink" title="代码启示录"></a>代码启示录</h3><p><img src="/../../images/20230xGame/8.png"></p>
<p><code>0xGame&#123;038e8685-0a59-a868-ed44-979261e99faf&#125;</code></p>
<h3 id="旋转密码城"><a href="#旋转密码城" class="headerlink" title="旋转密码城"></a>旋转密码城</h3><p><img src="/../../images/20230xGame/9.png"></p>
<p>把上面脚本跑一下即可</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">exp</span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">cipher</span> <span class="operator">=</span> <span class="string">&quot;_Iv2&gt;6L424c_4c2\\f__5\\7fec\\da32\\3ef2`cgd4b46N&quot;</span>;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">char</span> c : cipher.toCharArray()) &#123;</span><br><span class="line">      <span class="keyword">if</span> (c &gt;= <span class="string">&#x27;!&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;~&#x27;</span>) &#123;</span><br><span class="line">        flag.append((<span class="type">char</span>)((c - <span class="number">33</span> + <span class="number">47</span>) % <span class="number">94</span> + <span class="number">33</span>));</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        flag.append(c);</span><br><span class="line">      &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    System.out.println(flag);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"># 0xGame&#123;cac40c4a-<span class="number">700d</span>-f764-52ba-b67a1485c3ce&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数字幽灵城"><a href="#数字幽灵城" class="headerlink" title="数字幽灵城"></a>数字幽灵城</h3><p><img src="/../../images/20230xGame/12.png"></p>
<p>反编译找到base58的密文<code>RmC442S4tDMzc3CvzoCx8toKodL8SE8GRQSmz8M84k6g9jG1vVrf3c5TECZR</code></p>
<p><img src="/../../images/20230xGame/13.png"></p>
<p>反编译base58的加密函数，找到码表<code>ABCDEFGHJKLMNPQRSTUVWXYZ123456789abcdefghijkmnopqrstuvwxyz</code></p>
<p>解密得到<code>0xGame&#123;5f7dc2d9-5243-f706-cdbf-12e34dd3970c&#125;</code></p>
<h3 id="变量迷城"><a href="#变量迷城" class="headerlink" title="变量迷城"></a>变量迷城</h3><p>首先反编译</p>
<p><img src="/../../images/20230xGame/14.png"></p>
<p>发现密文和等式</p>
<p>$x^2 + 2y^2 + 3x + 4y - 7384462351178 &#x3D; 0$，$5x^2 + 6y^2 + 7x + 8y - 22179606057658$</p>
<p>解得<code>x = 114514,y = 1919810</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> BiPredicate&lt;BigInteger, BigInteger&gt; equationCheck;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">static</span> &#123;</span><br><span class="line">    equationCheck = ((x, y) -&gt; &#123;</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">eq1</span> <span class="operator">=</span> x.pow(<span class="number">2</span>).add(y.pow(<span class="number">2</span>).multiply(BigInteger.valueOf(<span class="number">2L</span>))).add(x.multiply(BigInteger.valueOf(<span class="number">3L</span>))).add(y.multiply(BigInteger.valueOf(<span class="number">4L</span>))).subtract(<span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="string">&quot;7384462351178&quot;</span>));</span><br><span class="line">        <span class="type">BigInteger</span> <span class="variable">eq2</span> <span class="operator">=</span> x.pow(<span class="number">2</span>).multiply(BigInteger.valueOf(<span class="number">5L</span>)).add(y.pow(<span class="number">2</span>).multiply(BigInteger.valueOf(<span class="number">6L</span>))).add(x.multiply(BigInteger.valueOf(<span class="number">7L</span>))).add(y.multiply(BigInteger.valueOf(<span class="number">8L</span>))).subtract(<span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="string">&quot;22179606057658&quot;</span>));</span><br><span class="line">        <span class="keyword">return</span> (eq1.equals(BigInteger.ZERO) &amp;&amp; eq2.equals(BigInteger.ZERO));</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../../images/20230xGame/15.png"></p>
<p>找到关键，发现<code>key = &quot;1145140xGame&quot;</code></p>
<p>再进行异或即<code>flag[i] = c[i] ^ key(i % len(key))</code></p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">encrypted_flag = [</span><br><span class="line">    <span class="number">1</span>, <span class="number">73</span>, <span class="number">115</span>, <span class="number">84</span>, <span class="number">92</span>, <span class="number">81</span>, <span class="number">75</span>, <span class="number">65</span>, <span class="number">116</span>, <span class="number">84</span>,</span><br><span class="line">    <span class="number">90</span>, <span class="number">93</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">87</span>, <span class="number">24</span>, <span class="number">83</span>, <span class="number">87</span>, <span class="number">84</span>, <span class="number">64</span>,</span><br><span class="line">    <span class="number">106</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">86</span>, <span class="number">84</span>, <span class="number">28</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">82</span>,</span><br><span class="line">    <span class="number">29</span>, <span class="number">74</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">93</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">84</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">key = <span class="string">&quot;1145140xGame&quot;</span></span><br><span class="line"></span><br><span class="line">decrypted_flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted_flag):</span><br><span class="line">    decrypted_byte = byte ^ <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])</span><br><span class="line">    decrypted_flag += <span class="built_in">chr</span>(decrypted_byte)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_flag)</span><br><span class="line"><span class="comment">#0xGame&#123;9357863c-bcd8-ed3e-008f-2040d2e45043&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="虚构核心"><a href="#虚构核心" class="headerlink" title="虚构核心"></a>虚构核心</h3><p><img src="/../../images/20230xGame/18.png"></p>
<p>解密过程和<code>key</code>已经给出，差了密文</p>
<p><img src="/../../images/20230xGame/19.png"></p>
<p>把密文文件导出</p>
<p>放cipherchef解密</p>
<p><img src="/../../images/20230xGame/20.png"></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0xGame&#123;. 69b4fa3be19bdf400df34e41b93636a4. 76b662c5c3d6d98035190115d89ef42f. 87fff610a9c97ebbe5a16a6d4865c0e4..&lt;init&gt;..B..FlagChecker.java..I..L..LI..LII..LL..LLL..Lcom/ctf/a0xgame_5/FlagChecker;..Ljava/lang/Integer;..Ljava/lang/Object;..Ljava/lang/RuntimeException;..Ljava/lang/String;..Ljava/lang/StringBuilder;..Ljava/security/MessageDigest;.(Ljava/security/NoSuchAlgorithmException;..MD5.	MD5å. å¯.å.ºç.°é..è¯¯..V..VL..Z..ZL..[B..[Ljava/lang/Object;..[Ljava/lang/String;..append..b.	checkFlag..content..digest..e..endsWith..equals..f3eddaccb39f..f5bf50a3..format..getBytes..getInstance..i..input..length..md..md5.</span><br><span class="line">md5Strings.</span><br><span class="line">messageDigest..parts..sb..split.</span><br><span class="line">startsWith.	substring..toString..valueOf..&#125;</span><br></pre></td></tr></table></figure>

<p>根据提示，把前面三串密文放<a target="_blank" rel="noopener" href="https://www.cmd5.org/">网站</a>破解md5，分别得到<code>9988</code>,<code>61ee</code>,<code>8c00</code></p>
<p>再拼接成uuid的形式:8-4-4-4-12</p>
<p>flag:<code>0xGame&#123;f5bf50a3-9988-61ee-8c00-f3eddaccb39f&#125;</code></p>
<h1 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h1><h2 id="Crypto-3"><a href="#Crypto-3" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="LLL-Third-Blood"><a href="#LLL-Third-Blood" class="headerlink" title="LLL-Third Blood"></a>LLL-Third Blood</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle,choice,randint</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> DSA <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">GAME = DSA()</span><br><span class="line"></span><br><span class="line">MENU = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  Welcome_to_Final_Chanllange!</span></span><br><span class="line"><span class="string">/----------------------------\\</span></span><br><span class="line"><span class="string">|          options           |</span></span><br><span class="line"><span class="string">| [S]ign                     |</span></span><br><span class="line"><span class="string">| [V]erify                   |</span></span><br><span class="line"><span class="string">| [C]heck answer             |</span></span><br><span class="line"><span class="string">\\---------------------------/</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;&gt; &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">timeout_handler</span>(<span class="params">self, signum, frame</span>):</span><br><span class="line">        <span class="keyword">raise</span> TimeoutError</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.signal(signal.SIGALRM, self.timeout_handler)</span><br><span class="line">        signal.alarm(<span class="number">300</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.send(MENU.encode())</span><br><span class="line">        self.send(<span class="string">b&#x27;Here are your public key:&#x27;</span>)</span><br><span class="line">        self.send(<span class="string">f&#x27;q=<span class="subst">&#123;GAME.q&#125;</span>\np=<span class="subst">&#123;GAME.p&#125;</span>\ng=<span class="subst">&#123;GAME.g&#125;</span>\ny=<span class="subst">&#123;GAME.y&#125;</span>&#x27;</span>.encode())</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.send(<span class="string">b&#x27;What you want to choice?&#x27;</span>)</span><br><span class="line">            code = self.recv()</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">b&#x27;S&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;What you want to sign?&#x27;</span>)</span><br><span class="line">                msg = self.recv()</span><br><span class="line">                <span class="keyword">if</span> msg == <span class="string">b&#x27;admin&#x27;</span>:</span><br><span class="line">                    self.send(<span class="string">b&#x27;Permission denied!&#x27;</span>)</span><br><span class="line">                    self.send(<span class="string">b&#x27;Are you trying hack me?No way!&#x27;</span>)</span><br><span class="line">                    quit()</span><br><span class="line">                self.send(<span class="string">b&#x27;Here are your signature:&#x27;</span>)</span><br><span class="line">                s,r = GAME.sign(msg)</span><br><span class="line">                self.send(<span class="string">f&#x27;s = <span class="subst">&#123;s&#125;</span>&#x27;</span>.encode())</span><br><span class="line">                self.send(<span class="string">f&#x27;r = <span class="subst">&#123;r&#125;</span>&#x27;</span>.encode())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;V&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&quot;Let&#x27;s check your signature.&quot;</span>)</span><br><span class="line">                self.send(<span class="string">b&#x27;Tell me your message:&#x27;</span>)</span><br><span class="line">                msg = self.recv()</span><br><span class="line">                self.send(<span class="string">b&#x27;Tell me the signature (s,r):&#x27;</span>)</span><br><span class="line">                s = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                r = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                <span class="keyword">if</span> GAME.verify(msg,s,r):</span><br><span class="line">                    self.send(<span class="string">b&#x27;OK,it work&#x27;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.send(<span class="string">b&#x27;Something wrong?&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> code == <span class="string">b&#x27;C&#x27;</span>:</span><br><span class="line">                self.send(<span class="string">b&quot;Tell me the signature of &#x27;admin&#x27;&quot;</span>)</span><br><span class="line">                s = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                r = <span class="built_in">int</span>(self.recv())</span><br><span class="line">                <span class="keyword">if</span> GAME.verify(<span class="string">b&#x27;admin&#x27;</span>,s,r):</span><br><span class="line">                    self.send(<span class="string">b&#x27;Congratulations!You are Master of Cryptography!&#x27;</span>)</span><br><span class="line">                    self.send(<span class="string">b&#x27;Here are your flag:&#x27;</span>)</span><br><span class="line">                    self.send(flag)</span><br><span class="line">                    quit()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    self.send(<span class="string">b&#x27;It seems Something wrong?&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;invaild input&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST, PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">10004</span></span><br><span class="line">    server = ForkedServer((HOST, PORT), Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>

<p>考察DSA签名，本题思路是求得私钥d，再用<code>admin</code>构造签名完成验证</p>
<p>DSA签名中</p>
<p>$s \equiv k^{-1}(h + dr) \mod q$</p>
<p>$\therefore k \equiv s^{-1}h + s^{-1}dr \mod q$</p>
<p>令$A &#x3D; s^{-1}r$，$B &#x3D; s^{-1}h$</p>
<p>$k_i \equiv A_id + B_i \mod q$，即$k_i &#x3D; A_id + B_i +t_iq$</p>
<p>转化成了HNP问题</p>
<p>构造格</p>
<p><img src="/../../images/20230xGame/22.png"></p>
<p>i可以取多组数据，我取了20组</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Pwn4Sage.pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;43.139.107.237&#x27;</span>                  <span class="comment">#ip地址</span></span><br><span class="line">port =  <span class="number">10004</span>                              <span class="comment">#端口</span></span><br><span class="line"></span><br><span class="line">GeShi = <span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>  <span class="comment"># 改格式！</span></span><br><span class="line">sh = remote(host,port)                  <span class="comment">#建立连接  </span></span><br><span class="line"></span><br><span class="line">data = sh.recvuntil(GeShi).decode()</span><br><span class="line"></span><br><span class="line">proof = data.split(<span class="string">&#x27;sha256&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Xnum = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">0</span>].upper().count(<span class="string">&quot;X&quot;</span>)           <span class="comment">#要爆破的数量</span></span><br><span class="line">tail = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"><span class="built_in">hash</span> = proof.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;)&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;==&#x27;</span>)[-<span class="number">1</span>].split(<span class="string">&#x27;[&#x27;</span>)[<span class="number">0</span>].strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;未知数:&quot;</span>,Xnum)</span><br><span class="line"><span class="built_in">print</span>(tail)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hash</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;开始爆破&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> product(table,repeat=Xnum):</span><br><span class="line">    head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">    t = hashlib.sha256((head + tail).encode()).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> t == <span class="built_in">hash</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;爆破成功！结果是：&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(head)</span><br><span class="line">        sh.send(head.encode())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;以下是提交完XXXX之后的流程\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;Here are your public key:\n&quot;</span>)</span><br><span class="line">q = <span class="built_in">eval</span>(sh.recvline().decode().split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">p = <span class="built_in">eval</span>(sh.recvline().decode().split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">g = <span class="built_in">eval</span>(sh.recvline().decode().split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">y = <span class="built_in">eval</span>(sh.recvline().decode().split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">R = []</span><br><span class="line">S = []</span><br><span class="line">H = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;What you want to choice?&quot;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&quot;S&quot;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;What you want to sign?&quot;</span>)</span><br><span class="line">    m = getPrime(<span class="number">128</span>)</span><br><span class="line">    msg = long_to_bytes(m)</span><br><span class="line">    h = bytes_to_long(sha1(msg).digest())</span><br><span class="line">    sh.sendline(msg)</span><br><span class="line">    sh.recvuntil(<span class="string">b&quot;Here are your signature:\n&quot;</span>)</span><br><span class="line">    s = <span class="built_in">eval</span>(sh.recvline().decode().split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    r = <span class="built_in">eval</span>(sh.recvline().decode().split(<span class="string">&quot;=&quot;</span>)[<span class="number">1</span>])</span><br><span class="line">    S.append(s)</span><br><span class="line">    R.append(r)</span><br><span class="line">    H.append(h)</span><br><span class="line">    </span><br><span class="line">n = <span class="built_in">len</span>(S)</span><br><span class="line">Ge = Matrix(ZZ,n+<span class="number">2</span>,n+<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    Ge[i,i] = q</span><br><span class="line">    Ge[-<span class="number">2</span>,i] = gmpy2.invert(S[i],q) * R[i]</span><br><span class="line">    Ge[-<span class="number">1</span>,i] = gmpy2.invert(S[i],q) * H[i]</span><br><span class="line">K = <span class="number">2</span>^<span class="number">128</span></span><br><span class="line">Ge[-<span class="number">1</span>,-<span class="number">1</span>] = K</span><br><span class="line">Ge[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">m,k,x</span>):</span><br><span class="line">    H = bytes_to_long(sha1(m).digest())</span><br><span class="line">    r = <span class="built_in">pow</span>(g,k,p)%q</span><br><span class="line">    s = (inverse(k,q)*(H+r*x))%q</span><br><span class="line">    <span class="keyword">return</span> r,s</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> Ge.LLL():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(line[-<span class="number">1</span>]) == K:</span><br><span class="line">        k1 = <span class="built_in">abs</span>(line[<span class="number">0</span>])</span><br><span class="line">        d = <span class="built_in">abs</span>(line[-<span class="number">2</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;d =&quot;</span>,d)</span><br><span class="line">        r,s = sign(<span class="string">b&quot;admin&quot;</span>,<span class="built_in">int</span>(k1),<span class="built_in">int</span>(d))</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;What you want to choice?&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="string">b&quot;C&quot;</span>)</span><br><span class="line">        sh.recvuntil(<span class="string">b&quot;&gt; Tell me the signature of &#x27;admin&#x27;&quot;</span>)</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(s).encode())</span><br><span class="line">        sh.sendline(<span class="built_in">str</span>(r).encode())</span><br><span class="line">        sh.interactive()</span><br><span class="line">        <span class="comment"># 0xGame&#123;31260c7522632a69031d07133aedebfe&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Danger-Leak"><a href="#Danger-Leak" class="headerlink" title="Danger Leak"></a>Danger Leak</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    M = getrandbits(<span class="number">954</span>)</span><br><span class="line">    d0 = getrandbits(<span class="number">70</span>)</span><br><span class="line">    d1 = getrandbits(<span class="number">60</span>)</span><br><span class="line">    d = M * d1 + d0</span><br><span class="line">    e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">if</span> GCD(d,phi) == <span class="number">1</span>:</span><br><span class="line">    	<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>, )</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak=<span class="subst">&#123;M&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 20890649807098098590988367504589884104169882461137822700915421138825243082401073285651688396365119177048314378342335630003758801918471770067256781032441408755600222443136442802834673033726750262792591713729454359321085776245901507024843351032181392621160709321235730377105858928038429561563451212831555362084799868396816620900530821649927143675042508754145300235707164480595867159183020730488244523890377494200551982732673420463610420046405496222143863293721127847196315699011480407859245602878759192763358027712666490436877309958694930300881154144262012786388678170041827603485103596258722151867033618346180314221757</span></span><br><span class="line"><span class="string">e = 18495624691004329345494739768139119654869294781001439503228375675656780205533832088551925603457913375965236666248560110824522816405784593622489392063569693980307711273262046178522155150057918004670062638133229511441378857067441808814663979656329118576174389773223672078570346056569568769586136333878585184495900769610485682523713035338815180355226296627023856218662677851691200400870086661825318662718172322697239597148304400050201201957491047654347222946693457784950694119128957010938708457194638164370689969395914866589468077447411160531995194740413950928085824985317114393591961698215667749937880023984967171867149</span></span><br><span class="line"><span class="string">c = 7268748311489430996649583334296342239120976535969890151640528281264037345919563247744198340847622671332165540273927079037288463501586895675652397791211130033797562320858177249657627485568147343368981852295435358970875375601525013288259717232106253656041724174637307915021524904526849025976062174351360431089505898256673035060020871892556020429754849084448428394307414301376699983203262072041951835713075509402291301281337658567437075609144913905526625759374465018684092236818174282777215336979886495053619105951835282087487201593981164477120073864259644978940192351781270609702595767362731320959397657161384681459323</span></span><br><span class="line"><span class="string">leak=136607909840146555806361156873618892240715868885574369629522914036807393164542930308166609104735002945881388216362007941213298888307579692272865700211608126496105057113506756857793463197250909161173116422723246662094695586716106972298428164926993995948528941241037242367190042120886133717</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>参考论文：<a target="_blank" rel="noopener" href="https://eprint.iacr.org/2014/035.pdf">035.pdf (iacr.org)</a></p>
<p><img src="/../../images/20230xGame/23.png"></p>
<p>在模$Me$的域中构造多项式$f(x,y,z) &#x3D; ex - Ny + yz - 1$，然后用多元copper解出小根</p>
<p>$x_0,y_0,z_0$分别对应，$d_0,k,p+q-1$</p>
<p>所以用多元copper的时候，以$d_0,k,p+q-1$作为$x,y,z$的上限</p>
<p>求得$p+q-1$后，联立$n &#x3D; pq$解得$p,q$</p>
<p>$p &#x3D; \frac{(p+q) + \sqrt{(p+q)^2 - 4n}}{2}$ </p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = </span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">M =</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">R.&lt;x,y,z&gt;=PolynomialRing(Zmod(M*e))</span><br><span class="line"></span><br><span class="line">f = e*x - N*y + y*z - <span class="number">1</span></span><br><span class="line">solves = small_roots(f,bounds=(<span class="number">2</span>^<span class="number">71</span>,<span class="number">2</span>^<span class="number">1013</span>,<span class="number">2</span>^<span class="number">1026</span>),m=<span class="number">3</span>, d=<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(solves)</span><br><span class="line"></span><br><span class="line">add = <span class="built_in">int</span>(solves[<span class="number">0</span>][<span class="number">2</span>]) + <span class="number">1</span>                <span class="comment"># p+q</span></span><br><span class="line">sub = gmpy2.iroot(add^<span class="number">2</span> - <span class="number">4</span>*N,<span class="number">2</span>)[<span class="number">0</span>]        <span class="comment"># p-q</span></span><br><span class="line">p = (add + sub)//<span class="number">2</span></span><br><span class="line">q = N//p</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># 0xGame&#123;a9e1f260f845be84f56ff06b165deb80&#125;</span></span><br></pre></td></tr></table></figure>

<p>本地测试几组数据发现，$k$大概在1013bit以下，$p+q-1$的大小在1025bit左右，所以<code>bound</code>设置为<code>(2^71,2^1013,2^1026)</code></p>
<p>$d&#x3D;3$表示变量个数或者说是最高次幂？<code>m</code>从1试到了3</p>
<h3 id="Normal-ECC"><a href="#Normal-ECC" class="headerlink" title="Normal ECC"></a>Normal ECC</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag,M</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MD5</span>(<span class="params">m</span>):<span class="keyword">return</span> md5(<span class="built_in">str</span>(m).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">p = <span class="number">11093300438765357787693823122068501933326829181518693650897090781749379503427651954028543076247583697669597230934286751428880673539155279232304301123931419</span></span><br><span class="line">a = getPrime(<span class="built_in">int</span>(<span class="number">512</span>))</span><br><span class="line">b = getPrime(<span class="built_in">int</span>(<span class="number">512</span>))</span><br><span class="line"><span class="keyword">assert</span> p&gt;a</span><br><span class="line"><span class="keyword">assert</span> p&gt;b</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = getPrime(<span class="built_in">int</span>(<span class="number">512</span>))</span><br><span class="line">K = k*G</span><br><span class="line">r = getrandbits(<span class="number">64</span>)</span><br><span class="line">M = E(M)</span><br><span class="line"></span><br><span class="line">C1 = M + r*K</span><br><span class="line">C2 = r*G</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="string">&#x27;0xGame&#123;&#x27;</span>+MD5( M.xy()[<span class="number">0</span>] )+<span class="string">&#x27;&#125;&#x27;</span> == flag</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>\na=<span class="subst">&#123;a&#125;</span>\nb=<span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;G=<span class="subst">&#123;G.xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;K=<span class="subst">&#123;K.xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C1=<span class="subst">&#123;C1.xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C2=<span class="subst">&#123;C2.xy()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p=11093300438765357787693823122068501933326829181518693650897090781749379503427651954028543076247583697669597230934286751428880673539155279232304301123931419</span></span><br><span class="line"><span class="string">a=7150069360142473220874778371025253986400531606173784255855621272842352949822722345927984117158003009207785424116052251585892319431674211713978446093533949</span></span><br><span class="line"><span class="string">b=8963713118505064052475299691180792684131316295319527298757291586802733177771327455119311985236802185776962863601191772056992397979199759282886953573897623</span></span><br><span class="line"><span class="string">G=(4070512847946293053993474472718195445326650730220767223671483350865356914474371813956296088808339388116138119830978356761203350661975684819340687599188773, 7919267117945460629179349735575165185291048599591225961407006624231142667171694867758723087028969163792156367031144131919207578182780960301059191834343484)</span></span><br><span class="line"><span class="string">K=(3429071535068496391288385908059514112858019444898682888326563488381066866765760330150826456161675891783443971423132174003430225228636705672269386133448242, 10156980123178962109303543933598555000559941757051056925651640103802811004794287116521872896690665760105638977618361662092227807698111279640177447796532347)</span></span><br><span class="line"><span class="string">C1=(4139336890213227868613795086096336512836348527349045673681270821212710038308856344020383776363498787598928112315425033118240925101586130966715819924212989, 8496671787567254905958613320810855596994019625894595967770545586397682431545287861458500877647243710691962626334781301359445519608668358210417703062746989)</span></span><br><span class="line"><span class="string">C2=(2151204832133866138854176239337864259798539350706680161553247616590123485482950549170787112029461554837485268534053338274459614702685163614673775491725035, 612484077350471488714018386040340578068868389564012902083181785403536097453280569723896780143638704225018931513080350876551883282131207177391746460216488)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>发现曲线的阶和p一样，用SmartAttack求出$r$</p>
<p>exp:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line">p = </span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line"></span><br><span class="line">G=(, )</span><br><span class="line">K=(, )</span><br><span class="line">C1=(, )</span><br><span class="line">C2=(, )</span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">G = E(G)</span><br><span class="line">K = E(K)</span><br><span class="line">C1 = E(C1)</span><br><span class="line">C2 = E(C2)</span><br><span class="line"></span><br><span class="line">order = E.order()</span><br><span class="line"><span class="built_in">print</span>(order)</span><br><span class="line"><span class="built_in">print</span>(order == p)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MD5</span>(<span class="params">m</span>):<span class="keyword">return</span> md5(<span class="built_in">str</span>(m).encode()).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SmartAttack</span>(<span class="params">P,Q,p</span>):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ ZZ(t) + randint(<span class="number">0</span>,p)*p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants() ])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P,y_P = p_times_P.xy()</span><br><span class="line">    x_Q,y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line">r = SmartAttack(G,C2,p)</span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line"></span><br><span class="line">M = C1 - r*K</span><br><span class="line">flag = <span class="string">&#x27;0xGame&#123;&#x27;</span>+MD5(M[<span class="number">0</span>])+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 0xGame&#123;6f2b3accf11a8cb7a9d3c7b159bc6c6c&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Re-2"><a href="#Re-2" class="headerlink" title="Re"></a>Re</h2><h3 id="序列9-二进制学徒"><a href="#序列9-二进制学徒" class="headerlink" title="序列9-二进制学徒"></a>序列9-二进制学徒</h3><p>反编译python得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.11</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0xGame&#123;15cf69f6-69f9-6b18-1464-7785f106b0d3&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;我的flag去哪儿了？&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="序列8-代码悟道者"><a href="#序列8-代码悟道者" class="headerlink" title="序列8-代码悟道者"></a>序列8-代码悟道者</h3><p><img src="/../../images/20230xGame/21.png"></p>
<p>拿到base64的密文和码表，解就行</p>
<p>exp：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&quot;MH7HYWrb4p2oYpYtMcEvLTb8Np2jOD2mMoqqYTauLTatYTarMWYvMp7bMdq=&quot;</span></span><br><span class="line">table1 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line">table2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz-_&quot;</span></span><br><span class="line">flag = base64.b64decode(cipher.translate(<span class="built_in">str</span>.maketrans(table2,table1)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 0xGame&#123;72c672a9-9b77-8703-4a98-97a951f938e2&#125;</span></span><br></pre></td></tr></table></figure>


    </div>

    
    
    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------已经到底啦！<i class="fa fa-paw"></i>-------------</div>
    
</div>

  
</div>

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>DexterJie
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/" title="20230xGame">https://dexterjie.github.io/2023/11/04/赛题复现/20230xGame/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Wp/" rel="tag"># Wp</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/10/30/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2023ACTF/" rel="prev" title="2023ACTF">
                  <i class="fa fa-chevron-left"></i> 2023ACTF
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NewStarCTF2023/" rel="next" title="2023NewStarCTF">
                  2023NewStarCTF <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">DexterJie</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">251k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">15:12</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>-->


    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  
<div class="busuanzi-count">
  <script async src="/js/busuanzi.pure.mini.js"></script>
  
  <span class="site-uv" title="总访客量">
    访客量<span id="busuanzi_value_site_uv"></span>
  </span>

  <span class="site-pv" title="总访问量">
    经过<span id="busuanzi_value_site_pv"></span>次回眸与你相遇
  </span>
</div>



  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-five-mocha.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"locale":null,"placeholder":"请文明评论呀","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/20230xGame/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right"},"mobile":{"show":true}});</script></body>

</html>
